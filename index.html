<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.2/font/bootstrap-icons.css">

    <title>op-geth - go-ethereum fork diff overview</title>

    <link rel="icon" type="image/x-icon" href="">

    <style>
        .line-stat {
            width: 14rem;
            float: right;
        }
        .line-stat div {
            width: 50%;
        }
        .text-add-ignored {
            color: #93ad93;
            font-style: italic;
        }
        .text-delete-ignored {
            color: #c47777;
            font-style: italic;
        }
        .toplevelstat {
            margin-left: 0 !important;
            width: 15rem;
        }
    </style>

    
<style>
    .term-container {
        background: #171717;
        border-radius: 5px;
        color: white;
        word-break: break-word;
        overflow-wrap: break-word;
        font-family: "SFMono-Regular", Monaco, Menlo, Consolas, "Liberation Mono", Courier, monospace;
        font-size: 12px;
        line-height: 20px;
        padding: 14px 18px;
        white-space: pre-wrap;
    }

    .term-container img { max-width: 100%; }

    .term a { color: inherit; text-decoration: underline; text-decoration-style: dashed; }
    .term a:hover { color: #2882F9 }

    @keyframes blink-animation {
        to {
            visibility: hidden;
        }
    }

    .term-fg1 { } /* don't bold beccause it looks weird */
    .term-fg2 { color: #838887; } /* faint (decreased intensity) - same as gray really */
    .term-fg3 { font-style: italic; } /* italic */
    .term-fg4 { text-decoration: underline; } /* underline */
    .term-fg5 { animation: blink-animation 1s steps(3, start) infinite; } /* blink */
    .term-fg9 { text-decoration: line-through; } /* crossed-out */

    .term-fg30 { color: #666666; } /* black (but we can't use black, so a diff color) */
    .term-fg31 { color: #ff7070; } /* red */
    .term-fg32 { color: #b0f986; } /* green */
    .term-fg33 { color: #c6c502; } /* yellow */
    .term-fg34 { color: #8db7e0; } /* blue */
    .term-fg35 { color: #f271fb; } /* magenta */
    .term-fg36 { color: #6bf7ff; } /* cyan */

    /* high intense colors */
    .term-fgi1 { color: #5ef765; }
    .term-fgi90 { color: #838887; } /* grey */
    .term-fgi91 { color: #ff3333; } /* red */
    .term-fgi92 { color: #00FF00; } /* green */
    .term-fgi93 { color: #fffc67; } /* yellow */
    .term-fgi94 { color: #6871ff; } /* blue */
    .term-fgi95 { color: #ff76ff; } /* magenta */
    .term-fgi96 { color: #60fcff; } /* cyan */

    /* background colors */
    .term-bg40 { background: #676767; } /* grey */
    .term-bg41 { background: #ff4343; } /* red */
    .term-bg42 { background: #99ff5f; } /* green */

    /* custom foreground/background combos for readability */
    .term-fg31.term-bg40 { color: #F8A39F; }

    /* xterm colors */
    .term-fgx16 { color: #000000; }
    .term-fgx17 { color: #00005f; }
    .term-fgx18 { color: #000087; }
    .term-fgx19 { color: #0000af; }
    .term-fgx20 { color: #0000d7; }
    .term-fgx21 { color: #0000ff; }
    .term-fgx22 { color: #005f00; }
    .term-fgx23 { color: #005f5f; }
    .term-fgx24 { color: #005f87; }
    .term-fgx25 { color: #005faf; }
    .term-fgx26 { color: #005fd7; }
    .term-fgx27 { color: #005fff; }
    .term-fgx28 { color: #008700; }
    .term-fgx29 { color: #00875f; }
    .term-fgx30 { color: #008787; }
    .term-fgx31 { color: #0087af; }
    .term-fgx32 { color: #0087d7; }
    .term-fgx33 { color: #0087ff; }
    .term-fgx34 { color: #00af00; }
    .term-fgx35 { color: #00af5f; }
    .term-fgx36 { color: #00af87; }
    .term-fgx37 { color: #00afaf; }
    .term-fgx38 { color: #00afd7; }
    .term-fgx39 { color: #00afff; }
    .term-fgx40 { color: #00d700; }
    .term-fgx41 { color: #00d75f; }
    .term-fgx42 { color: #00d787; }
    .term-fgx43 { color: #00d7af; }
    .term-fgx44 { color: #00d7d7; }
    .term-fgx45 { color: #00d7ff; }
    .term-fgx46 { color: #00ff00; }
    .term-fgx47 { color: #00ff5f; }
    .term-fgx48 { color: #00ff87; }
    .term-fgx49 { color: #00ffaf; }
    .term-fgx50 { color: #00ffd7; }
    .term-fgx51 { color: #00ffff; }
    .term-fgx52 { color: #5f0000; }
    .term-fgx53 { color: #5f005f; }
    .term-fgx54 { color: #5f0087; }
    .term-fgx55 { color: #5f00af; }
    .term-fgx56 { color: #5f00d7; }
    .term-fgx57 { color: #5f00ff; }
    .term-fgx58 { color: #5f5f00; }
    .term-fgx59 { color: #5f5f5f; }
    .term-fgx60 { color: #5f5f87; }
    .term-fgx61 { color: #5f5faf; }
    .term-fgx62 { color: #5f5fd7; }
    .term-fgx63 { color: #5f5fff; }
    .term-fgx64 { color: #5f8700; }
    .term-fgx65 { color: #5f875f; }
    .term-fgx66 { color: #5f8787; }
    .term-fgx67 { color: #5f87af; }
    .term-fgx68 { color: #5f87d7; }
    .term-fgx69 { color: #5f87ff; }
    .term-fgx70 { color: #5faf00; }
    .term-fgx71 { color: #5faf5f; }
    .term-fgx72 { color: #5faf87; }
    .term-fgx73 { color: #5fafaf; }
    .term-fgx74 { color: #5fafd7; }
    .term-fgx75 { color: #5fafff; }
    .term-fgx76 { color: #5fd700; }
    .term-fgx77 { color: #5fd75f; }
    .term-fgx78 { color: #5fd787; }
    .term-fgx79 { color: #5fd7af; }
    .term-fgx80 { color: #5fd7d7; }
    .term-fgx81 { color: #5fd7ff; }
    .term-fgx82 { color: #5fff00; }
    .term-fgx83 { color: #5fff5f; }
    .term-fgx84 { color: #5fff87; }
    .term-fgx85 { color: #5fffaf; }
    .term-fgx86 { color: #5fffd7; }
    .term-fgx87 { color: #5fffff; }
    .term-fgx88 { color: #870000; }
    .term-fgx89 { color: #87005f; }
    .term-fgx90 { color: #870087; }
    .term-fgx91 { color: #8700af; }
    .term-fgx92 { color: #8700d7; }
    .term-fgx93 { color: #8700ff; }
    .term-fgx94 { color: #875f00; }
    .term-fgx95 { color: #875f5f; }
    .term-fgx96 { color: #875f87; }
    .term-fgx97 { color: #875faf; }
    .term-fgx98 { color: #875fd7; }
    .term-fgx99 { color: #875fff; }
    .term-fgx100 { color: #878700; }
    .term-fgx101 { color: #87875f; }
    .term-fgx102 { color: #878787; }
    .term-fgx103 { color: #8787af; }
    .term-fgx104 { color: #8787d7; }
    .term-fgx105 { color: #8787ff; }
    .term-fgx106 { color: #87af00; }
    .term-fgx107 { color: #87af5f; }
    .term-fgx108 { color: #87af87; }
    .term-fgx109 { color: #87afaf; }
    .term-fgx110 { color: #87afd7; }
    .term-fgx111 { color: #87afff; }
    .term-fgx112 { color: #87d700; }
    .term-fgx113 { color: #87d75f; }
    .term-fgx114 { color: #87d787; }
    .term-fgx115 { color: #87d7af; }
    .term-fgx116 { color: #87d7d7; }
    .term-fgx117 { color: #87d7ff; }
    .term-fgx118 { color: #87ff00; }
    .term-fgx119 { color: #87ff5f; }
    .term-fgx120 { color: #87ff87; }
    .term-fgx121 { color: #87ffaf; }
    .term-fgx122 { color: #87ffd7; }
    .term-fgx123 { color: #87ffff; }
    .term-fgx124 { color: #af0000; }
    .term-fgx125 { color: #af005f; }
    .term-fgx126 { color: #af0087; }
    .term-fgx127 { color: #af00af; }
    .term-fgx128 { color: #af00d7; }
    .term-fgx129 { color: #af00ff; }
    .term-fgx130 { color: #af5f00; }
    .term-fgx131 { color: #af5f5f; }
    .term-fgx132 { color: #af5f87; }
    .term-fgx133 { color: #af5faf; }
    .term-fgx134 { color: #af5fd7; }
    .term-fgx135 { color: #af5fff; }
    .term-fgx136 { color: #af8700; }
    .term-fgx137 { color: #af875f; }
    .term-fgx138 { color: #af8787; }
    .term-fgx139 { color: #af87af; }
    .term-fgx140 { color: #af87d7; }
    .term-fgx141 { color: #af87ff; }
    .term-fgx142 { color: #afaf00; }
    .term-fgx143 { color: #afaf5f; }
    .term-fgx144 { color: #afaf87; }
    .term-fgx145 { color: #afafaf; }
    .term-fgx146 { color: #afafd7; }
    .term-fgx147 { color: #afafff; }
    .term-fgx148 { color: #afd700; }
    .term-fgx149 { color: #afd75f; }
    .term-fgx150 { color: #afd787; }
    .term-fgx151 { color: #afd7af; }
    .term-fgx152 { color: #afd7d7; }
    .term-fgx153 { color: #afd7ff; }
    .term-fgx154 { color: #afff00; }
    .term-fgx155 { color: #afff5f; }
    .term-fgx156 { color: #afff87; }
    .term-fgx157 { color: #afffaf; }
    .term-fgx158 { color: #afffd7; }
    .term-fgx159 { color: #afffff; }
    .term-fgx160 { color: #d70000; }
    .term-fgx161 { color: #d7005f; }
    .term-fgx162 { color: #d70087; }
    .term-fgx163 { color: #d700af; }
    .term-fgx164 { color: #d700d7; }
    .term-fgx165 { color: #d700ff; }
    .term-fgx166 { color: #d75f00; }
    .term-fgx167 { color: #d75f5f; }
    .term-fgx168 { color: #d75f87; }
    .term-fgx169 { color: #d75faf; }
    .term-fgx170 { color: #d75fd7; }
    .term-fgx171 { color: #d75fff; }
    .term-fgx172 { color: #d78700; }
    .term-fgx173 { color: #d7875f; }
    .term-fgx174 { color: #d78787; }
    .term-fgx175 { color: #d787af; }
    .term-fgx176 { color: #d787d7; }
    .term-fgx177 { color: #d787ff; }
    .term-fgx178 { color: #d7af00; }
    .term-fgx179 { color: #d7af5f; }
    .term-fgx180 { color: #d7af87; }
    .term-fgx181 { color: #d7afaf; }
    .term-fgx182 { color: #d7afd7; }
    .term-fgx183 { color: #d7afff; }
    .term-fgx184 { color: #d7d700; }
    .term-fgx185 { color: #d7d75f; }
    .term-fgx186 { color: #d7d787; }
    .term-fgx187 { color: #d7d7af; }
    .term-fgx188 { color: #d7d7d7; }
    .term-fgx189 { color: #d7d7ff; }
    .term-fgx190 { color: #d7ff00; }
    .term-fgx191 { color: #d7ff5f; }
    .term-fgx192 { color: #d7ff87; }
    .term-fgx193 { color: #d7ffaf; }
    .term-fgx194 { color: #d7ffd7; }
    .term-fgx195 { color: #d7ffff; }
    .term-fgx196 { color: #ff0000; }
    .term-fgx197 { color: #ff005f; }
    .term-fgx198 { color: #ff0087; }
    .term-fgx199 { color: #ff00af; }
    .term-fgx200 { color: #ff00d7; }
    .term-fgx201 { color: #ff00ff; }
    .term-fgx202 { color: #ff5f00; }
    .term-fgx203 { color: #ff5f5f; }
    .term-fgx204 { color: #ff5f87; }
    .term-fgx205 { color: #ff5faf; }
    .term-fgx206 { color: #ff5fd7; }
    .term-fgx207 { color: #ff5fff; }
    .term-fgx208 { color: #ff8700; }
    .term-fgx209 { color: #ff875f; }
    .term-fgx210 { color: #ff8787; }
    .term-fgx211 { color: #ff87af; }
    .term-fgx212 { color: #ff87d7; }
    .term-fgx213 { color: #ff87ff; }
    .term-fgx214 { color: #ffaf00; }
    .term-fgx215 { color: #ffaf5f; }
    .term-fgx216 { color: #ffaf87; }
    .term-fgx217 { color: #ffafaf; }
    .term-fgx218 { color: #ffafd7; }
    .term-fgx219 { color: #ffafff; }
    .term-fgx220 { color: #ffd700; }
    .term-fgx221 { color: #ffd75f; }
    .term-fgx222 { color: #ffd787; }
    .term-fgx223 { color: #ffd7af; }
    .term-fgx224 { color: #ffd7d7; }
    .term-fgx225 { color: #ffd7ff; }
    .term-fgx226 { color: #ffff00; }
    .term-fgx227 { color: #ffff5f; }
    .term-fgx228 { color: #ffff87; }
    .term-fgx229 { color: #ffffaf; }
    .term-fgx230 { color: #ffffd7; }
    .term-fgx231 { color: #ffffff; }
    .term-fgx232 { color: #080808; }
    .term-fgx233 { color: #121212; }
    .term-fgx234 { color: #1c1c1c; }
    .term-fgx235 { color: #262626; }
    .term-fgx236 { color: #303030; }
    .term-fgx237 { color: #3a3a3a; }
    .term-fgx238 { color: #444444; }
    .term-fgx239 { color: #4e4e4e; }
    .term-fgx240 { color: #585858; }
    .term-fgx241 { color: #626262; }
    .term-fgx242 { color: #6c6c6c; }
    .term-fgx243 { color: #767676; }
    .term-fgx244 { color: #808080; }
    .term-fgx245 { color: #8a8a8a; }
    .term-fgx246 { color: #949494; }
    .term-fgx247 { color: #9e9e9e; }
    .term-fgx248 { color: #a8a8a8; }
    .term-fgx249 { color: #b2b2b2; }
    .term-fgx250 { color: #bcbcbc; }
    .term-fgx251 { color: #c6c6c6; }
    .term-fgx252 { color: #d0d0d0; }
    .term-fgx253 { color: #dadada; }
    .term-fgx254 { color: #e4e4e4; }
    .term-fgx255 { color: #eeeeee; }
</style>

</head>
<body>
    <div class="col-xl-10 col-xxl-8 mx-auto px-3 py-1 py-md-3">
        <main class="container-fluid">
            <div class="row">
                <div>
                    <div class="float-end">
                        <div class="form-check form-switch">
                            <i class="bi bi-brightness-low" id="dark-mode-icon"></i>
                            <input class="form-check-input" type="checkbox" role="switch" id="dark-mode-toggle" data-bs-toggle="tooltip"
                                   data-bs-placement="bottom" data-bs-title="Toggle Dark Mode"/>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"role="button" aria-expanded="true" aria-controls="id-df309a2ce8f932dc7b102a36">
        
            <div class="col-12 col-md-12 col-lg-6 col-xl-6 text-start"><h1>op-geth</h1></div>
        

        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2">
            <div class="row line-stat">
                
                    <span class="text-end">diff:</span>
                
                
                    <span class="text-end">ignored:</span>
                
            </div>
        </div>
        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2 toplevelstat">
            <div class="row line-stat">
                
                    <div class="text-end"><span class="text-success">+4388</span></div>
                    <div class="text-start"><span class="text-danger">-22384</span></div>
                
                
                    <div class="text-end"><span class="text-add-ignored">+9006</span></div>
                    <div class="text-start"><span class="text-delete-ignored">-419</span></div>
                
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse show border-1 ps-3 my-3" id="id-df309a2ce8f932dc7b102a36">
        <div><p>This is an overview of the changes in <a href="https://github.com/ethereum-optimism/op-geth"><code>op-geth</code></a>,
a fork of <a href="https://github.com/ethereum/go-ethereum"><code>go-ethereum</code></a>, part of the OP-stack.</p>

<p>The OP-stack architecture is modular, following the Consensus/Execution split of post-Merge Ethereum L1:</p>

<ul>
<li><a href="https://github.com/ethereum-optimism/optimism/tree/develop/op-node"><code>op-node</code></a> implements most rollup-specific functionality as Consensus-Layer, similar to a L1 beacon-node.</li>
<li><a href="https://github.com/ethereum-optimism/op-geth"><code>op-geth</code></a> implements the Execution-Layer, with <strong>minimal changes</strong> for a secure Ethereum-equivalent application environment.</li>
</ul>

<p>Related <a href="https://github.com/ethereum-optimism/optimism/tree/develop/specs">op-stack specifications</a>:</p>

<ul>
<li><a href="https://github.com/ethereum-optimism/optimism/blob/develop/specs/exec-engine.md">L2 Execution Engine spec</a></li>
<li><a href="https://github.com/ethereum-optimism/optimism/blob/develop/specs/deposits.md">Deposit Transaction spec</a></li>
</ul>
</div>
        <div>
            
            
        </div>
        <div>
            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-c39786bf15c977c9063b64ea"role="button" aria-expanded="false" aria-controls="id-c39786bf15c977c9063b64ea">
        
            <div class="col-12 col-md-12 col-lg-6 col-xl-6 text-start"><h2>Core modifications</h2></div>
        

        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2">
            <div class="row line-stat">
                
                
            </div>
        </div>
        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2 ">
            <div class="row line-stat">
                
                    <div class="text-end"><span class="text-success">+1809</span></div>
                    <div class="text-start"><span class="text-danger">-125</span></div>
                
                
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-c39786bf15c977c9063b64ea">
        <div></div>
        <div>
            
            
        </div>
        <div>
            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-59c929c5474be321d1e8b896"role="button" aria-expanded="false" aria-controls="id-59c929c5474be321d1e8b896">
        
            <div class="col-12 col-md-12 col-lg-6 col-xl-6 text-start"><h3>State-transition modifications</h3></div>
        

        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2">
            <div class="row line-stat">
                
                
            </div>
        </div>
        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2 ">
            <div class="row line-stat">
                
                    <div class="text-end"><span class="text-success">+1060</span></div>
                    <div class="text-start"><span class="text-danger">-25</span></div>
                
                
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-59c929c5474be321d1e8b896">
        <div></div>
        <div>
            
            
        </div>
        <div>
            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-8505372f2eee1c1ca633fe09"role="button" aria-expanded="false" aria-controls="id-8505372f2eee1c1ca633fe09">
        
            <div class="col-12 col-md-12 col-lg-6 col-xl-6 text-start"><h4>Deposit Transaction type</h4></div>
        

        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2">
            <div class="row line-stat">
                
                
            </div>
        </div>
        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2 ">
            <div class="row line-stat">
                
                    <div class="text-end"><span class="text-success">+202</span></div>
                    <div class="text-start"><span class="text-danger">-4</span></div>
                
                
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-8505372f2eee1c1ca633fe09">
        <div><p>The Bedrock upgrade introduces a <code>Deposit</code> transaction-type (<code>0x7E</code>) to enable both users and the
rollup system itself to change the L2 state based on L1 events and system rules as
<a href="https://github.com/ethereum-optimism/optimism/blob/develop/specs/deposits.md">specified</a>.</p>
</div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-362454278d50a2631a75bf13" role="button"
                       aria-expanded="false" aria-controls="id-362454278d50a2631a75bf13">
                        <code>core/types/deposit_tx.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/core/types/deposit_tx.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+103</span></div>
                            <div class="text-start"><span class="text-danger">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-362454278d50a2631a75bf13"><span class="term-fg1">diff --git go-ethereum&#47;core&#47;types&#47;deposit_tx.go op-geth&#47;core&#47;types&#47;deposit_tx.go</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..4131ee7af037275dcacd795baab4e0d55a1acb07</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ op-geth&#47;core&#47;types&#47;deposit_tx.go</span>
<span class="term-fg36">@@ -0,0 +1,103 @@</span>
<span class="term-fg32">+&#47;&#47; Copyright 2021 The go-ethereum Authors</span>
<span class="term-fg32">+&#47;&#47; This file is part of the go-ethereum library.</span>
<span class="term-fg32">+&#47;&#47;</span>
<span class="term-fg32">+&#47;&#47; The go-ethereum library is free software: you can redistribute it and&#47;or modify</span>
<span class="term-fg32">+&#47;&#47; it under the terms of the GNU Lesser General Public License as published by</span>
<span class="term-fg32">+&#47;&#47; the Free Software Foundation, either version 3 of the License, or</span>
<span class="term-fg32">+&#47;&#47; (at your option) any later version.</span>
<span class="term-fg32">+&#47;&#47;</span>
<span class="term-fg32">+&#47;&#47; The go-ethereum library is distributed in the hope that it will be useful,</span>
<span class="term-fg32">+&#47;&#47; but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="term-fg32">+&#47;&#47; MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the</span>
<span class="term-fg32">+&#47;&#47; GNU Lesser General Public License for more details.</span>
<span class="term-fg32">+&#47;&#47;</span>
<span class="term-fg32">+&#47;&#47; You should have received a copy of the GNU Lesser General Public License</span>
<span class="term-fg32">+&#47;&#47; along with the go-ethereum library. If not, see &lt;http:&#47;&#47;www.gnu.org&#47;licenses&#47;&gt;.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+package types</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+import (</span>
<span class="term-fg32">+	&quot;bytes&quot;</span>
<span class="term-fg32">+	&quot;math&#47;big&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;rlp&quot;</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+const DepositTxType = 0x7E</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+type DepositTx struct {</span>
<span class="term-fg32">+	&#47;&#47; SourceHash uniquely identifies the source of the deposit</span>
<span class="term-fg32">+	SourceHash common.Hash</span>
<span class="term-fg32">+	&#47;&#47; From is exposed through the types.Signer, not through TxData</span>
<span class="term-fg32">+	From common.Address</span>
<span class="term-fg32">+	&#47;&#47; nil means contract creation</span>
<span class="term-fg32">+	To *common.Address `rlp:&quot;nil&quot;`</span>
<span class="term-fg32">+	&#47;&#47; Mint is minted on L2, locked on L1, nil if no minting.</span>
<span class="term-fg32">+	Mint *big.Int `rlp:&quot;nil&quot;`</span>
<span class="term-fg32">+	&#47;&#47; Value is transferred from L2 balance, executed after Mint (if any)</span>
<span class="term-fg32">+	Value *big.Int</span>
<span class="term-fg32">+	&#47;&#47; gas limit</span>
<span class="term-fg32">+	Gas uint64</span>
<span class="term-fg32">+	&#47;&#47; Field indicating if this transaction is exempt from the L2 gas limit.</span>
<span class="term-fg32">+	IsSystemTransaction bool</span>
<span class="term-fg32">+	&#47;&#47; Normal Tx data</span>
<span class="term-fg32">+	Data []byte</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; copy creates a deep copy of the transaction data and initializes all fields.</span>
<span class="term-fg32">+func (tx *DepositTx) copy() TxData {</span>
<span class="term-fg32">+	cpy := &amp;DepositTx{</span>
<span class="term-fg32">+		SourceHash:          tx.SourceHash,</span>
<span class="term-fg32">+		From:                tx.From,</span>
<span class="term-fg32">+		To:                  copyAddressPtr(tx.To),</span>
<span class="term-fg32">+		Mint:                nil,</span>
<span class="term-fg32">+		Value:               new(big.Int),</span>
<span class="term-fg32">+		Gas:                 tx.Gas,</span>
<span class="term-fg32">+		IsSystemTransaction: tx.IsSystemTransaction,</span>
<span class="term-fg32">+		Data:                common.CopyBytes(tx.Data),</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if tx.Mint != nil {</span>
<span class="term-fg32">+		cpy.Mint = new(big.Int).Set(tx.Mint)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if tx.Value != nil {</span>
<span class="term-fg32">+		cpy.Value.Set(tx.Value)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	return cpy</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; accessors for innerTx.</span>
<span class="term-fg32">+func (tx *DepositTx) txType() byte           { return DepositTxType }</span>
<span class="term-fg32">+func (tx *DepositTx) chainID() *big.Int      { return common.Big0 }</span>
<span class="term-fg32">+func (tx *DepositTx) accessList() AccessList { return nil }</span>
<span class="term-fg32">+func (tx *DepositTx) data() []byte           { return tx.Data }</span>
<span class="term-fg32">+func (tx *DepositTx) gas() uint64            { return tx.Gas }</span>
<span class="term-fg32">+func (tx *DepositTx) gasFeeCap() *big.Int    { return new(big.Int) }</span>
<span class="term-fg32">+func (tx *DepositTx) gasTipCap() *big.Int    { return new(big.Int) }</span>
<span class="term-fg32">+func (tx *DepositTx) gasPrice() *big.Int     { return new(big.Int) }</span>
<span class="term-fg32">+func (tx *DepositTx) value() *big.Int        { return tx.Value }</span>
<span class="term-fg32">+func (tx *DepositTx) nonce() uint64          { return 0 }</span>
<span class="term-fg32">+func (tx *DepositTx) to() *common.Address    { return tx.To }</span>
<span class="term-fg32">+func (tx *DepositTx) isSystemTx() bool       { return tx.IsSystemTransaction }</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (tx *DepositTx) effectiveGasPrice(dst *big.Int, baseFee *big.Int) *big.Int {</span>
<span class="term-fg32">+	return dst.Set(new(big.Int))</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (tx *DepositTx) effectiveNonce() *uint64 { return nil }</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (tx *DepositTx) rawSignatureValues() (v, r, s *big.Int) {</span>
<span class="term-fg32">+	return common.Big0, common.Big0, common.Big0</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (tx *DepositTx) setSignatureValues(chainID, v, r, s *big.Int) {</span>
<span class="term-fg32">+	&#47;&#47; this is a noop for deposit transactions</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (tx *DepositTx) encode(b *bytes.Buffer) error {</span>
<span class="term-fg32">+	return rlp.Encode(b, tx)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (tx *DepositTx) decode(input []byte) error {</span>
<span class="term-fg32">+	return rlp.DecodeBytes(input, tx)</span>
<span class="term-fg32">+}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-45fd3b7a3fb6ffc21141a8eb" role="button"
                       aria-expanded="false" aria-controls="id-45fd3b7a3fb6ffc21141a8eb">
                        <code>core/types/transaction_marshalling.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/core/types/transaction_marshalling.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/core/types/transaction_marshalling.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+81</span></div>
                            <div class="text-start"><span class="text-danger">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-45fd3b7a3fb6ffc21141a8eb"><span class="term-fg1">diff --git go-ethereum&#47;core&#47;types&#47;transaction_marshalling.go op-geth&#47;core&#47;types&#47;transaction_marshalling.go</span>
<span class="term-fg1">index 4d5b2bcdd4ce375d6c9896cbd321ff7949b071fb..253e4f03de82c53bfe2b48037a728d6397e1a6ec 100644</span>
<span class="term-fg1">--- go-ethereum&#47;core&#47;types&#47;transaction_marshalling.go</span>
<span class="term-fg1">+++ op-geth&#47;core&#47;types&#47;transaction_marshalling.go</span>
<span class="term-fg36">@@ -19,11 +19,13 @@</span>
 import (
 	&quot;encoding&#47;json&quot;
 	&quot;errors&quot;
<span class="term-fg32">+	&quot;io&quot;</span>
 	&quot;math&#47;big&quot;
&nbsp;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&#47;hexutil&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;crypto&#47;kzg4844&quot;
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;rlp&quot;</span>
 	&quot;github.com&#47;holiman&#47;uint256&quot;
 )
&nbsp;
<span class="term-fg36">@@ -47,6 +49,12 @@</span> 	V                    *hexutil.Big    `json:&quot;v&quot;`
 	R                    *hexutil.Big    `json:&quot;r&quot;`
 	S                    *hexutil.Big    `json:&quot;s&quot;`
 	YParity              *hexutil.Uint64 `json:&quot;yParity,omitempty&quot;`
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Deposit transaction fields</span>
<span class="term-fg32">+	SourceHash *common.Hash    `json:&quot;sourceHash,omitempty&quot;`</span>
<span class="term-fg32">+	From       *common.Address `json:&quot;from,omitempty&quot;`</span>
<span class="term-fg32">+	Mint       *hexutil.Big    `json:&quot;mint,omitempty&quot;`</span>
<span class="term-fg32">+	IsSystemTx *bool           `json:&quot;isSystemTx,omitempty&quot;`</span>
&nbsp;
 	&#47;&#47; Blob transaction sidecar encoding:
 	Blobs       []kzg4844.Blob       `json:&quot;blobs,omitempty&quot;`
<span class="term-fg36">@@ -153,6 +161,19 @@</span> 			enc.Blobs = itx.Sidecar.Blobs
 			enc.Commitments = itx.Sidecar.Commitments
 			enc.Proofs = itx.Sidecar.Proofs
 		}
<span class="term-fg32">+</span>
<span class="term-fg32">+	case *DepositTx:</span>
<span class="term-fg32">+		enc.Gas = (*hexutil.Uint64)(&amp;itx.Gas)</span>
<span class="term-fg32">+		enc.Value = (*hexutil.Big)(itx.Value)</span>
<span class="term-fg32">+		enc.Input = (*hexutil.Bytes)(&amp;itx.Data)</span>
<span class="term-fg32">+		enc.To = tx.To()</span>
<span class="term-fg32">+		enc.SourceHash = &amp;itx.SourceHash</span>
<span class="term-fg32">+		enc.From = &amp;itx.From</span>
<span class="term-fg32">+		if itx.Mint != nil {</span>
<span class="term-fg32">+			enc.Mint = (*hexutil.Big)(itx.Mint)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		enc.IsSystemTx = &amp;itx.IsSystemTransaction</span>
<span class="term-fg32">+		&#47;&#47; other fields will show up as null.</span>
 	}
 	return json.Marshal(&amp;enc)
 }
<span class="term-fg36">@@ -409,6 +430,54 @@</span> 				return err
 			}
 		}
&nbsp;
<span class="term-fg32">+	case DepositTxType:</span>
<span class="term-fg32">+		if dec.AccessList != nil || dec.MaxFeePerGas != nil ||</span>
<span class="term-fg32">+			dec.MaxPriorityFeePerGas != nil {</span>
<span class="term-fg32">+			return errors.New(&quot;unexpected field(s) in deposit transaction&quot;)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		if dec.GasPrice != nil &amp;&amp; dec.GasPrice.ToInt().Cmp(common.Big0) != 0 {</span>
<span class="term-fg32">+			return errors.New(&quot;deposit transaction GasPrice must be 0&quot;)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		if (dec.V != nil &amp;&amp; dec.V.ToInt().Cmp(common.Big0) != 0) ||</span>
<span class="term-fg32">+			(dec.R != nil &amp;&amp; dec.R.ToInt().Cmp(common.Big0) != 0) ||</span>
<span class="term-fg32">+			(dec.S != nil &amp;&amp; dec.S.ToInt().Cmp(common.Big0) != 0) {</span>
<span class="term-fg32">+			return errors.New(&quot;deposit transaction signature must be 0 or unset&quot;)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		var itx DepositTx</span>
<span class="term-fg32">+		inner = &amp;itx</span>
<span class="term-fg32">+		if dec.To != nil {</span>
<span class="term-fg32">+			itx.To = dec.To</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		if dec.Gas == nil {</span>
<span class="term-fg32">+			return errors.New(&quot;missing required field &#39;gas&#39; for txdata&quot;)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		itx.Gas = uint64(*dec.Gas)</span>
<span class="term-fg32">+		if dec.Value == nil {</span>
<span class="term-fg32">+			return errors.New(&quot;missing required field &#39;value&#39; in transaction&quot;)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		itx.Value = (*big.Int)(dec.Value)</span>
<span class="term-fg32">+		&#47;&#47; mint may be omitted or nil if there is nothing to mint.</span>
<span class="term-fg32">+		itx.Mint = (*big.Int)(dec.Mint)</span>
<span class="term-fg32">+		if dec.Input == nil {</span>
<span class="term-fg32">+			return errors.New(&quot;missing required field &#39;input&#39; in transaction&quot;)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		itx.Data = *dec.Input</span>
<span class="term-fg32">+		if dec.From == nil {</span>
<span class="term-fg32">+			return errors.New(&quot;missing required field &#39;from&#39; in transaction&quot;)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		itx.From = *dec.From</span>
<span class="term-fg32">+		if dec.SourceHash == nil {</span>
<span class="term-fg32">+			return errors.New(&quot;missing required field &#39;sourceHash&#39; in transaction&quot;)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		itx.SourceHash = *dec.SourceHash</span>
<span class="term-fg32">+		&#47;&#47; IsSystemTx may be omitted. Defaults to false.</span>
<span class="term-fg32">+		if dec.IsSystemTx != nil {</span>
<span class="term-fg32">+			itx.IsSystemTransaction = *dec.IsSystemTx</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		if dec.Nonce != nil {</span>
<span class="term-fg32">+			inner = &amp;depositTxWithNonce{DepositTx: itx, EffectiveNonce: uint64(*dec.Nonce)}</span>
<span class="term-fg32">+		}</span>
 	default:
 		return ErrTxTypeNotSupported
 	}
<span class="term-fg36">@@ -419,3 +488,15 @@</span>
 	&#47;&#47; TODO: check hash here?
 	return nil
 }
<span class="term-fg32">+</span>
<span class="term-fg32">+type depositTxWithNonce struct {</span>
<span class="term-fg32">+	DepositTx</span>
<span class="term-fg32">+	EffectiveNonce uint64</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; EncodeRLP ensures that RLP encoding this transaction excludes the nonce. Otherwise, the tx Hash would change</span>
<span class="term-fg32">+func (tx *depositTxWithNonce) EncodeRLP(w io.Writer) error {</span>
<span class="term-fg32">+	return rlp.Encode(w, tx.DepositTx)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (tx *depositTxWithNonce) effectiveNonce() *uint64 { return &amp;tx.EffectiveNonce }</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-546e395332ab82231a006c7e" role="button"
                       aria-expanded="false" aria-controls="id-546e395332ab82231a006c7e">
                        <code>core/types/transaction_signing.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/core/types/transaction_signing.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/core/types/transaction_signing.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+18</span></div>
                            <div class="text-start"><span class="text-danger">-4</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-546e395332ab82231a006c7e"><span class="term-fg1">diff --git go-ethereum&#47;core&#47;types&#47;transaction_signing.go op-geth&#47;core&#47;types&#47;transaction_signing.go</span>
<span class="term-fg1">index 339fee6f97378a070ff7b120889d3dad9e12f6ca..4bf41bf0af264b82bf4a51d0351e3f33bd39f318 100644</span>
<span class="term-fg1">--- go-ethereum&#47;core&#47;types&#47;transaction_signing.go</span>
<span class="term-fg1">+++ op-geth&#47;core&#47;types&#47;transaction_signing.go</span>
<span class="term-fg36">@@ -40,7 +40,7 @@</span> &#47;&#47; MakeSigner returns a Signer based on the given chain config and block number.
 func MakeSigner(config *params.ChainConfig, blockNumber *big.Int, blockTime uint64) Signer {
 	var signer Signer
 	switch {
<span class="term-fg31">-	case config.IsCancun(blockNumber, blockTime):</span>
<span class="term-fg32">+	case config.IsCancun(blockNumber, blockTime) &amp;&amp; !config.IsOptimism():</span>
 		signer = NewCancunSigner(config.ChainID)
 	case config.IsLondon(blockNumber):
 		signer = NewLondonSigner(config.ChainID)
<span class="term-fg36">@@ -65,7 +65,7 @@</span> &#47;&#47; Use this in transaction-handling code where the current block number is unknown. If you
 &#47;&#47; have the current block number available, use MakeSigner instead.
 func LatestSigner(config *params.ChainConfig) Signer {
 	if config.ChainID != nil {
<span class="term-fg31">-		if config.CancunTime != nil {</span>
<span class="term-fg32">+		if config.CancunTime != nil &amp;&amp; !config.IsOptimism() {</span>
 			return NewCancunSigner(config.ChainID)
 		}
 		if config.LondonBlock != nil {
<span class="term-fg36">@@ -249,6 +249,14 @@</span> 	return londonSigner{eip2930Signer{NewEIP155Signer(chainId)}}
 }
&nbsp;
 func (s londonSigner) Sender(tx *Transaction) (common.Address, error) {
<span class="term-fg32">+	if tx.Type() == DepositTxType {</span>
<span class="term-fg32">+		switch tx.inner.(type) {</span>
<span class="term-fg32">+		case *DepositTx:</span>
<span class="term-fg32">+			return tx.inner.(*DepositTx).From, nil</span>
<span class="term-fg32">+		case *depositTxWithNonce:</span>
<span class="term-fg32">+			return tx.inner.(*depositTxWithNonce).From, nil</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
 	if tx.Type() != DynamicFeeTxType {
 		return s.eip2930Signer.Sender(tx)
 	}
<span class="term-fg36">@@ -268,6 +276,9 @@</span> 	return ok &amp;&amp; x.chainId.Cmp(s.chainId) == 0
 }
&nbsp;
 func (s londonSigner) SignatureValues(tx *Transaction, sig []byte) (R, S, V *big.Int, err error) {
<span class="term-fg32">+	if tx.Type() == DepositTxType {</span>
<span class="term-fg32">+		return nil, nil, nil, fmt.Errorf(&quot;deposits do not have a signature&quot;)</span>
<span class="term-fg32">+	}</span>
 	txdata, ok := tx.inner.(*DynamicFeeTx)
 	if !ok {
 		return s.eip2930Signer.SignatureValues(tx, sig)
<span class="term-fg36">@@ -285,6 +296,9 @@</span>
 &#47;&#47; Hash returns the hash to be signed by the sender.
 &#47;&#47; It does not uniquely identify the transaction.
 func (s londonSigner) Hash(tx *Transaction) common.Hash {
<span class="term-fg32">+	if tx.Type() == DepositTxType {</span>
<span class="term-fg32">+		panic(&quot;deposits cannot be signed and do not have a signing hash&quot;)</span>
<span class="term-fg32">+	}</span>
 	if tx.Type() != DynamicFeeTxType {
 		return s.eip2930Signer.Hash(tx)
 	}
<span class="term-fg36">@@ -572,6 +586,6 @@</span> 			return new(big.Int)
 		}
 		return new(big.Int).SetUint64((v - 35) &#47; 2)
 	}
<span class="term-fg31">-	v.Sub(v, big.NewInt(35))</span>
<span class="term-fg31">-	return v.Rsh(v, 1)</span>
<span class="term-fg32">+	vCopy := new(big.Int).Sub(v, big.NewInt(35))</span>
<span class="term-fg32">+	return vCopy.Rsh(vCopy, 1)</span>
 }</div>
    </div>

            
            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-1292e13c9bebc24ec8f87f5a"role="button" aria-expanded="false" aria-controls="id-1292e13c9bebc24ec8f87f5a">
        
            <div class="col-12 col-md-12 col-lg-6 col-xl-6 text-start"><h4>Transaction properties</h4></div>
        

        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2">
            <div class="row line-stat">
                
                
            </div>
        </div>
        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2 ">
            <div class="row line-stat">
                
                    <div class="text-end"><span class="text-success">+87</span></div>
                    <div class="text-start"><span class="text-danger">-0</span></div>
                
                
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-1292e13c9bebc24ec8f87f5a">
        <div><p>The <code>Transaction</code> type now exposes the deposit-transaction and L1-cost properties required for the rollup.</p>
</div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-3aa30a1e50ae2c299a89a78e" role="button"
                       aria-expanded="false" aria-controls="id-3aa30a1e50ae2c299a89a78e">
                        <code>core/types/transaction.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/core/types/transaction.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/core/types/transaction.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+83</span></div>
                            <div class="text-start"><span class="text-danger">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-3aa30a1e50ae2c299a89a78e"><span class="term-fg1">diff --git go-ethereum&#47;core&#47;types&#47;transaction.go op-geth&#47;core&#47;types&#47;transaction.go</span>
<span class="term-fg1">index 4ac9187bdbfedef2b83edc5293b91a637afd8c14..d0fa5308f0cbd1088287a197a65a67b18b48ca0d 100644</span>
<span class="term-fg1">--- go-ethereum&#47;core&#47;types&#47;transaction.go</span>
<span class="term-fg1">+++ op-geth&#47;core&#47;types&#47;transaction.go</span>
<span class="term-fg36">@@ -28,6 +28,7 @@</span>
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&#47;math&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;crypto&quot;
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;log&quot;</span>
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;rlp&quot;
 )
&nbsp;
<span class="term-fg36">@@ -60,6 +61,9 @@</span> 	&#47;&#47; caches
 	hash atomic.Pointer[common.Hash]
 	size atomic.Uint64
 	from atomic.Pointer[sigCache]
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; cache of details to compute the data availability fee</span>
<span class="term-fg32">+	rollupCostData atomic.Value</span>
 }
&nbsp;
 &#47;&#47; NewTx creates a new transaction.
<span class="term-fg36">@@ -86,6 +90,7 @@</span> 	gasFeeCap() *big.Int
 	value() *big.Int
 	nonce() uint64
 	to() *common.Address
<span class="term-fg32">+	isSystemTx() bool</span>
&nbsp;
 	rawSignatureValues() (v, r, s *big.Int)
 	setSignatureValues(chainID, v, r, s *big.Int)
<span class="term-fg36">@@ -206,6 +211,8 @@</span> 	case DynamicFeeTxType:
 		inner = new(DynamicFeeTx)
 	case BlobTxType:
 		inner = new(BlobTx)
<span class="term-fg32">+	case DepositTxType:</span>
<span class="term-fg32">+		inner = new(DepositTx)</span>
 	default:
 		return nil, ErrTxTypeNotSupported
 	}
<span class="term-fg36">@@ -302,6 +309,20 @@</span> func (tx *Transaction) Value() *big.Int { return new(big.Int).Set(tx.inner.value()) }
&nbsp;
 &#47;&#47; Nonce returns the sender account nonce of the transaction.
 func (tx *Transaction) Nonce() uint64 { return tx.inner.nonce() }
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; EffectiveNonce returns the nonce that was actually used as part of transaction execution</span>
<span class="term-fg32">+&#47;&#47; Returns nil if the effective nonce is not known</span>
<span class="term-fg32">+func (tx *Transaction) EffectiveNonce() *uint64 {</span>
<span class="term-fg32">+	type txWithEffectiveNonce interface {</span>
<span class="term-fg32">+		effectiveNonce() *uint64</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	if itx, ok := tx.inner.(txWithEffectiveNonce); ok {</span>
<span class="term-fg32">+		return itx.effectiveNonce()</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	nonce := tx.inner.nonce()</span>
<span class="term-fg32">+	return &amp;nonce</span>
<span class="term-fg32">+}</span>
&nbsp;
 &#47;&#47; To returns the recipient address of the transaction.
 &#47;&#47; For contract-creation transactions, To returns nil.
<span class="term-fg36">@@ -309,6 +330,36 @@</span> func (tx *Transaction) To() *common.Address {
 	return copyAddressPtr(tx.inner.to())
 }
&nbsp;
<span class="term-fg32">+&#47;&#47; SourceHash returns the hash that uniquely identifies the source of the deposit tx,</span>
<span class="term-fg32">+&#47;&#47; e.g. a user deposit event, or a L1 info deposit included in a specific L2 block height.</span>
<span class="term-fg32">+&#47;&#47; Non-deposit transactions return a zeroed hash.</span>
<span class="term-fg32">+func (tx *Transaction) SourceHash() common.Hash {</span>
<span class="term-fg32">+	if dep, ok := tx.inner.(*DepositTx); ok {</span>
<span class="term-fg32">+		return dep.SourceHash</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	return common.Hash{}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; Mint returns the ETH to mint in the deposit tx.</span>
<span class="term-fg32">+&#47;&#47; This returns nil if there is nothing to mint, or if this is not a deposit tx.</span>
<span class="term-fg32">+func (tx *Transaction) Mint() *big.Int {</span>
<span class="term-fg32">+	if dep, ok := tx.inner.(*DepositTx); ok {</span>
<span class="term-fg32">+		return dep.Mint</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	return nil</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; IsDepositTx returns true if the transaction is a deposit tx type.</span>
<span class="term-fg32">+func (tx *Transaction) IsDepositTx() bool {</span>
<span class="term-fg32">+	return tx.Type() == DepositTxType</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; IsSystemTx returns true for deposits that are system transactions. These transactions</span>
<span class="term-fg32">+&#47;&#47; are executed in an unmetered environment &amp; do not contribute to the block gas limit.</span>
<span class="term-fg32">+func (tx *Transaction) IsSystemTx() bool {</span>
<span class="term-fg32">+	return tx.inner.isSystemTx()</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
 &#47;&#47; Cost returns (gas * gasPrice) + (blobGas * blobGasPrice) + value.
 func (tx *Transaction) Cost() *big.Int {
 	total := new(big.Int).Mul(tx.GasPrice(), new(big.Int).SetUint64(tx.Gas()))
<span class="term-fg36">@@ -319,6 +370,23 @@</span> 	total.Add(total, tx.Value())
 	return total
 }
&nbsp;
<span class="term-fg32">+&#47;&#47; RollupCostData caches the information needed to efficiently compute the data availability fee</span>
<span class="term-fg32">+func (tx *Transaction) RollupCostData() RollupCostData {</span>
<span class="term-fg32">+	if tx.Type() == DepositTxType {</span>
<span class="term-fg32">+		return RollupCostData{}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if v := tx.rollupCostData.Load(); v != nil {</span>
<span class="term-fg32">+		return v.(RollupCostData)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	data, err := tx.MarshalBinary()</span>
<span class="term-fg32">+	if err != nil { &#47;&#47; Silent error, invalid txs will not be marshalled&#47;unmarshalled for batch submission anyway.</span>
<span class="term-fg32">+		log.Error(&quot;failed to encode tx for L1 cost computation&quot;, &quot;err&quot;, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	out := NewRollupCostData(data)</span>
<span class="term-fg32">+	tx.rollupCostData.Store(out)</span>
<span class="term-fg32">+	return out</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
 &#47;&#47; RawSignatureValues returns the V, R, S signature values of the transaction.
 &#47;&#47; The return values should not be modified by the caller.
 &#47;&#47; The return values may be nil or zero, if the transaction is unsigned.
<span class="term-fg36">@@ -350,6 +418,9 @@</span> &#47;&#47; EffectiveGasTip returns the effective miner gasTipCap for the given base fee.
 &#47;&#47; Note: if the effective gasTipCap is negative, this method returns both error
 &#47;&#47; the actual negative value, _and_ ErrGasFeeCapTooLow
 func (tx *Transaction) EffectiveGasTip(baseFee *big.Int) (*big.Int, error) {
<span class="term-fg32">+	if tx.Type() == DepositTxType {</span>
<span class="term-fg32">+		return new(big.Int), nil</span>
<span class="term-fg32">+	}</span>
 	if baseFee == nil {
 		return tx.GasTipCap(), nil
 	}
<span class="term-fg36">@@ -413,6 +484,18 @@</span> func (tx *Transaction) BlobTxSidecar() *BlobTxSidecar {
 	if blobtx, ok := tx.inner.(*BlobTx); ok {
 		return blobtx.Sidecar
 	}
<span class="term-fg32">+	return nil</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; SetBlobTxSidecar sets the sidecar of a transaction.</span>
<span class="term-fg32">+&#47;&#47; The sidecar should match the blob-tx versioned hashes, or the transaction will be invalid.</span>
<span class="term-fg32">+&#47;&#47; This allows tools to easily re-attach blob sidecars to signed transactions that omit the sidecar.</span>
<span class="term-fg32">+func (tx *Transaction) SetBlobTxSidecar(sidecar *BlobTxSidecar) error {</span>
<span class="term-fg32">+	blobtx, ok := tx.inner.(*BlobTx)</span>
<span class="term-fg32">+	if !ok {</span>
<span class="term-fg32">+		return fmt.Errorf(&quot;not a blob tx, type = %d&quot;, tx.Type())</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	blobtx.Sidecar = sidecar</span>
 	return nil
 }
</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-d50f5d6d75eb7c2690cd5af2" role="button"
                       aria-expanded="false" aria-controls="id-d50f5d6d75eb7c2690cd5af2">
                        <code>core/types/tx_access_list.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/core/types/tx_access_list.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/core/types/tx_access_list.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+1</span></div>
                            <div class="text-start"><span class="text-danger">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-d50f5d6d75eb7c2690cd5af2"><span class="term-fg1">diff --git go-ethereum&#47;core&#47;types&#47;tx_access_list.go op-geth&#47;core&#47;types&#47;tx_access_list.go</span>
<span class="term-fg1">index 730a77b752866afb5e6ba3d7ea8f4a5af6456d00..59880b0eabb182cd889a27b58d6c449187f4701a 100644</span>
<span class="term-fg1">--- go-ethereum&#47;core&#47;types&#47;tx_access_list.go</span>
<span class="term-fg1">+++ op-geth&#47;core&#47;types&#47;tx_access_list.go</span>
<span class="term-fg36">@@ -107,6 +107,7 @@</span> func (tx *AccessListTx) gasFeeCap() *big.Int    { return tx.GasPrice }
 func (tx *AccessListTx) value() *big.Int        { return tx.Value }
 func (tx *AccessListTx) nonce() uint64          { return tx.Nonce }
 func (tx *AccessListTx) to() *common.Address    { return tx.To }
<span class="term-fg32">+func (tx *AccessListTx) isSystemTx() bool       { return false }</span>
&nbsp;
 func (tx *AccessListTx) effectiveGasPrice(dst *big.Int, baseFee *big.Int) *big.Int {
 	return dst.Set(tx.GasPrice)</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-bfb5c43169585dbf29666ead" role="button"
                       aria-expanded="false" aria-controls="id-bfb5c43169585dbf29666ead">
                        <code>core/types/tx_blob.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/core/types/tx_blob.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/core/types/tx_blob.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+1</span></div>
                            <div class="text-start"><span class="text-danger">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-bfb5c43169585dbf29666ead"><span class="term-fg1">diff --git go-ethereum&#47;core&#47;types&#47;tx_blob.go op-geth&#47;core&#47;types&#47;tx_blob.go</span>
<span class="term-fg1">index ce1f287caaf826cef8513e001437c263fd48f490..d85e3c879ab38a05a1d679f4c805d860eefd8e18 100644</span>
<span class="term-fg1">--- go-ethereum&#47;core&#47;types&#47;tx_blob.go</span>
<span class="term-fg1">+++ op-geth&#47;core&#47;types&#47;tx_blob.go</span>
<span class="term-fg36">@@ -162,6 +162,7 @@</span> func (tx *BlobTx) value() *big.Int        { return tx.Value.ToBig() }
 func (tx *BlobTx) nonce() uint64          { return tx.Nonce }
 func (tx *BlobTx) to() *common.Address    { tmp := tx.To; return &amp;tmp }
 func (tx *BlobTx) blobGas() uint64        { return params.BlobTxBlobGasPerBlob * uint64(len(tx.BlobHashes)) }
<span class="term-fg32">+func (tx *BlobTx) isSystemTx() bool       { return false }</span>
&nbsp;
 func (tx *BlobTx) effectiveGasPrice(dst *big.Int, baseFee *big.Int) *big.Int {
 	if baseFee == nil {</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-d1c9e0396e18549d62cdb608" role="button"
                       aria-expanded="false" aria-controls="id-d1c9e0396e18549d62cdb608">
                        <code>core/types/tx_dynamic_fee.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/core/types/tx_dynamic_fee.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/core/types/tx_dynamic_fee.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+1</span></div>
                            <div class="text-start"><span class="text-danger">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-d1c9e0396e18549d62cdb608"><span class="term-fg1">diff --git go-ethereum&#47;core&#47;types&#47;tx_dynamic_fee.go op-geth&#47;core&#47;types&#47;tx_dynamic_fee.go</span>
<span class="term-fg1">index 8b5b514fdec5b58fc8058e582a0a7c355e0ccba8..9c52cde57754d4826e6d673f297238ce02212657 100644</span>
<span class="term-fg1">--- go-ethereum&#47;core&#47;types&#47;tx_dynamic_fee.go</span>
<span class="term-fg1">+++ op-geth&#47;core&#47;types&#47;tx_dynamic_fee.go</span>
<span class="term-fg36">@@ -96,6 +96,7 @@</span> func (tx *DynamicFeeTx) gasPrice() *big.Int     { return tx.GasFeeCap }
 func (tx *DynamicFeeTx) value() *big.Int        { return tx.Value }
 func (tx *DynamicFeeTx) nonce() uint64          { return tx.Nonce }
 func (tx *DynamicFeeTx) to() *common.Address    { return tx.To }
<span class="term-fg32">+func (tx *DynamicFeeTx) isSystemTx() bool       { return false }</span>
&nbsp;
 func (tx *DynamicFeeTx) effectiveGasPrice(dst *big.Int, baseFee *big.Int) *big.Int {
 	if baseFee == nil {</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-f20119d9108cf4e894378b41" role="button"
                       aria-expanded="false" aria-controls="id-f20119d9108cf4e894378b41">
                        <code>core/types/tx_legacy.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/core/types/tx_legacy.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/core/types/tx_legacy.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+1</span></div>
                            <div class="text-start"><span class="text-danger">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-f20119d9108cf4e894378b41"><span class="term-fg1">diff --git go-ethereum&#47;core&#47;types&#47;tx_legacy.go op-geth&#47;core&#47;types&#47;tx_legacy.go</span>
<span class="term-fg1">index 71025b78fc060692c1d034f84b59b4cdc8e6cf65..bcb65c39349a3a1bef78948af48a30a1e14c71ba 100644</span>
<span class="term-fg1">--- go-ethereum&#47;core&#47;types&#47;tx_legacy.go</span>
<span class="term-fg1">+++ op-geth&#47;core&#47;types&#47;tx_legacy.go</span>
<span class="term-fg36">@@ -103,6 +103,7 @@</span> func (tx *LegacyTx) gasFeeCap() *big.Int    { return tx.GasPrice }
 func (tx *LegacyTx) value() *big.Int        { return tx.Value }
 func (tx *LegacyTx) nonce() uint64          { return tx.Nonce }
 func (tx *LegacyTx) to() *common.Address    { return tx.To }
<span class="term-fg32">+func (tx *LegacyTx) isSystemTx() bool       { return false }</span>
&nbsp;
 func (tx *LegacyTx) effectiveGasPrice(dst *big.Int, baseFee *big.Int) *big.Int {
 	return dst.Set(tx.GasPrice)</div>
    </div>

            
            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-e690e5f0746c6e8b0ecec412"role="button" aria-expanded="false" aria-controls="id-e690e5f0746c6e8b0ecec412">
        
            <div class="col-12 col-md-12 col-lg-6 col-xl-6 text-start"><h4>L1 cost computation</h4></div>
        

        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2">
            <div class="row line-stat">
                
                
            </div>
        </div>
        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2 ">
            <div class="row line-stat">
                
                    <div class="text-end"><span class="text-success">+507</span></div>
                    <div class="text-start"><span class="text-danger">-5</span></div>
                
                
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-e690e5f0746c6e8b0ecec412">
        <div><p>Transactions must pay an additional L1 cost based on the amount of rollup-data-gas they consume,
estimated based on gas-price-oracle information and encoded tx size.&rdquo;</p>
</div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-daf1cbf8458f8e2796d4bec0" role="button"
                       aria-expanded="false" aria-controls="id-daf1cbf8458f8e2796d4bec0">
                        <code>core/evm.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/core/evm.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/core/evm.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+3</span></div>
                            <div class="text-start"><span class="text-danger">-1</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-daf1cbf8458f8e2796d4bec0"><span class="term-fg1">diff --git go-ethereum&#47;core&#47;evm.go op-geth&#47;core&#47;evm.go</span>
<span class="term-fg1">index 5d3c454d7c472839edd8b84c7a20a8a9a3f1fd02..e8016fbb782145ac28fdf78e02e59f0e2b9784be 100644</span>
<span class="term-fg1">--- go-ethereum&#47;core&#47;evm.go</span>
<span class="term-fg1">+++ op-geth&#47;core&#47;evm.go</span>
<span class="term-fg36">@@ -25,6 +25,7 @@</span> 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;consensus&#47;misc&#47;eip4844&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&#47;tracing&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&#47;types&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&#47;vm&quot;
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;params&quot;</span>
 	&quot;github.com&#47;holiman&#47;uint256&quot;
 )
&nbsp;
<span class="term-fg36">@@ -39,7 +40,7 @@</span> 	GetHeader(common.Hash, uint64) *types.Header
 }
&nbsp;
 &#47;&#47; NewEVMBlockContext creates a new context for use in the EVM.
<span class="term-fg31">-func NewEVMBlockContext(header *types.Header, chain ChainContext, author *common.Address) vm.BlockContext {</span>
<span class="term-fg32">+func NewEVMBlockContext(header *types.Header, chain ChainContext, author *common.Address, config *params.ChainConfig, statedb types.StateGetter) vm.BlockContext {</span>
 	var (
 		beneficiary common.Address
 		baseFee     *big.Int
<span class="term-fg36">@@ -74,6 +75,7 @@</span> 		BaseFee:     baseFee,
 		BlobBaseFee: blobBaseFee,
 		GasLimit:    header.GasLimit,
 		Random:      random,
<span class="term-fg32">+		L1CostFunc:  types.NewL1CostFunc(config, statedb),</span>
 	}
 }
</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-14abc114bb5c6338be2877d1" role="button"
                       aria-expanded="false" aria-controls="id-14abc114bb5c6338be2877d1">
                        <code>core/state_prefetcher.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/core/state_prefetcher.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/core/state_prefetcher.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+1</span></div>
                            <div class="text-start"><span class="text-danger">-1</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-14abc114bb5c6338be2877d1"><span class="term-fg1">diff --git go-ethereum&#47;core&#47;state_prefetcher.go op-geth&#47;core&#47;state_prefetcher.go</span>
<span class="term-fg1">index 31405fa078bb2819660a3f71f93aaf241f2599fc..3a8fab85e3c9a01ff3df89b2f51f670d89d148db 100644</span>
<span class="term-fg1">--- go-ethereum&#47;core&#47;state_prefetcher.go</span>
<span class="term-fg1">+++ op-geth&#47;core&#47;state_prefetcher.go</span>
<span class="term-fg36">@@ -48,7 +48,7 @@</span> func (p *statePrefetcher) Prefetch(block *types.Block, statedb *state.StateDB, cfg vm.Config, interrupt *atomic.Bool) {
 	var (
 		header       = block.Header()
 		gaspool      = new(GasPool).AddGas(block.GasLimit())
<span class="term-fg31">-		blockContext = NewEVMBlockContext(header, p.chain, nil)</span>
<span class="term-fg32">+		blockContext = NewEVMBlockContext(header, p.chain, nil, p.config, statedb)</span>
 		evm          = vm.NewEVM(blockContext, vm.TxContext{}, statedb, p.config, cfg)
 		signer       = types.MakeSigner(p.config, header.Number, header.Time)
 	)</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-5a63a82165ed124f9f0847eb" role="button"
                       aria-expanded="false" aria-controls="id-5a63a82165ed124f9f0847eb">
                        <code>core/state_processor.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/core/state_processor.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/core/state_processor.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+20</span></div>
                            <div class="text-start"><span class="text-danger">-3</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-5a63a82165ed124f9f0847eb"><span class="term-fg1">diff --git go-ethereum&#47;core&#47;state_processor.go op-geth&#47;core&#47;state_processor.go</span>
<span class="term-fg1">index c21f644f9851454e6d63a3b55ad5b58f3ca09970..ca54182641f29177121e4ba8333a5f36f11374f3 100644</span>
<span class="term-fg1">--- go-ethereum&#47;core&#47;state_processor.go</span>
<span class="term-fg1">+++ op-geth&#47;core&#47;state_processor.go</span>
<span class="term-fg36">@@ -69,11 +69,12 @@</span> 	&#47;&#47; Mutate the block and state according to any hard-fork specs
 	if p.config.DAOForkSupport &amp;&amp; p.config.DAOForkBlock != nil &amp;&amp; p.config.DAOForkBlock.Cmp(block.Number()) == 0 {
 		misc.ApplyDAOHardFork(statedb)
 	}
<span class="term-fg32">+	misc.EnsureCreate2Deployer(p.config, block.Time(), statedb)</span>
 	var (
 		context vm.BlockContext
 		signer  = types.MakeSigner(p.config, header.Number, header.Time)
 	)
<span class="term-fg31">-	context = NewEVMBlockContext(header, p.chain, nil)</span>
<span class="term-fg32">+	context = NewEVMBlockContext(header, p.chain, nil, p.config, statedb)</span>
 	vmenv := vm.NewEVM(context, vm.TxContext{}, statedb, p.config, cfg)
 	if beaconRoot := block.BeaconRoot(); beaconRoot != nil {
 		ProcessBeaconBlockRoot(*beaconRoot, vmenv, statedb)
<span class="term-fg36">@@ -120,6 +121,11 @@</span> 	&#47;&#47; Create a new context to be used in the EVM environment.
 	txContext := NewEVMTxContext(msg)
 	evm.Reset(txContext, statedb)
&nbsp;
<span class="term-fg32">+	nonce := tx.Nonce()</span>
<span class="term-fg32">+	if msg.IsDepositTx &amp;&amp; config.IsOptimismRegolith(evm.Context.Time) {</span>
<span class="term-fg32">+		nonce = statedb.GetNonce(msg.From)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
 	&#47;&#47; Apply the transaction to the current state (included in the env).
 	result, err := ApplyMessage(evm, msg, gp)
 	if err != nil {
<span class="term-fg36">@@ -146,6 +152,17 @@</span> 	}
 	receipt.TxHash = tx.Hash()
 	receipt.GasUsed = result.UsedGas
&nbsp;
<span class="term-fg32">+	if msg.IsDepositTx &amp;&amp; config.IsOptimismRegolith(evm.Context.Time) {</span>
<span class="term-fg32">+		&#47;&#47; The actual nonce for deposit transactions is only recorded from Regolith onwards and</span>
<span class="term-fg32">+		&#47;&#47; otherwise must be nil.</span>
<span class="term-fg32">+		receipt.DepositNonce = &amp;nonce</span>
<span class="term-fg32">+		&#47;&#47; The DepositReceiptVersion for deposit transactions is only recorded from Canyon onwards</span>
<span class="term-fg32">+		&#47;&#47; and otherwise must be nil.</span>
<span class="term-fg32">+		if config.IsOptimismCanyon(evm.Context.Time) {</span>
<span class="term-fg32">+			receipt.DepositReceiptVersion = new(uint64)</span>
<span class="term-fg32">+			*receipt.DepositReceiptVersion = types.CanyonDepositReceiptVersion</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
 	if tx.Type() == types.BlobTxType {
 		receipt.BlobGasUsed = uint64(len(tx.BlobHashes()) * params.BlobTxBlobGasPerBlob)
 		receipt.BlobGasPrice = evm.Context.BlobBaseFee
<span class="term-fg36">@@ -153,7 +170,7 @@</span> 	}
&nbsp;
 	&#47;&#47; If the transaction created a contract, store the creation address in the receipt.
 	if msg.To == nil {
<span class="term-fg31">-		receipt.ContractAddress = crypto.CreateAddress(evm.TxContext.Origin, tx.Nonce())</span>
<span class="term-fg32">+		receipt.ContractAddress = crypto.CreateAddress(evm.TxContext.Origin, nonce)</span>
 	}
&nbsp;
 	&#47;&#47; Set the receipt logs and create the bloom filter.
<span class="term-fg36">@@ -175,7 +192,7 @@</span> 	if err != nil {
 		return nil, err
 	}
 	&#47;&#47; Create a new context to be used in the EVM environment
<span class="term-fg31">-	blockContext := NewEVMBlockContext(header, bc, author)</span>
<span class="term-fg32">+	blockContext := NewEVMBlockContext(header, bc, author, config, statedb)</span>
 	txContext := NewEVMTxContext(msg)
 	vmenv := vm.NewEVM(blockContext, txContext, statedb, config, cfg)
 	return ApplyTransactionWithEVM(msg, config, gp, statedb, header.Number, header.Hash(), tx, usedGas, vmenv)</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-dd8ae3a87426b10564dc4037" role="button"
                       aria-expanded="false" aria-controls="id-dd8ae3a87426b10564dc4037">
                        <code>core/types/rollup_cost.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/core/types/rollup_cost.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+473</span></div>
                            <div class="text-start"><span class="text-danger">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-dd8ae3a87426b10564dc4037"><span class="term-fg1">diff --git go-ethereum&#47;core&#47;types&#47;rollup_cost.go op-geth&#47;core&#47;types&#47;rollup_cost.go</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..e0bc26d92f0e6c747787bfdd8b2e632af7ad4a1e</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ op-geth&#47;core&#47;types&#47;rollup_cost.go</span>
<span class="term-fg36">@@ -0,0 +1,473 @@</span>
<span class="term-fg32">+&#47;&#47; Copyright 2022 The go-ethereum Authors</span>
<span class="term-fg32">+&#47;&#47; This file is part of the go-ethereum library.</span>
<span class="term-fg32">+&#47;&#47;</span>
<span class="term-fg32">+&#47;&#47; The go-ethereum library is free software: you can redistribute it and&#47;or modify</span>
<span class="term-fg32">+&#47;&#47; it under the terms of the GNU Lesser General Public License as published by</span>
<span class="term-fg32">+&#47;&#47; the Free Software Foundation, either version 3 of the License, or</span>
<span class="term-fg32">+&#47;&#47; (at your option) any later version.</span>
<span class="term-fg32">+&#47;&#47;</span>
<span class="term-fg32">+&#47;&#47; The go-ethereum library is distributed in the hope that it will be useful,</span>
<span class="term-fg32">+&#47;&#47; but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="term-fg32">+&#47;&#47; MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the</span>
<span class="term-fg32">+&#47;&#47; GNU Lesser General Public License for more details.</span>
<span class="term-fg32">+&#47;&#47;</span>
<span class="term-fg32">+&#47;&#47; You should have received a copy of the GNU Lesser General Public License</span>
<span class="term-fg32">+&#47;&#47; along with the go-ethereum library. If not, see &lt;http:&#47;&#47;www.gnu.org&#47;licenses&#47;&gt;.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+package types</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+import (</span>
<span class="term-fg32">+	&quot;bytes&quot;</span>
<span class="term-fg32">+	&quot;encoding&#47;binary&quot;</span>
<span class="term-fg32">+	&quot;fmt&quot;</span>
<span class="term-fg32">+	&quot;math&#47;big&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;log&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;params&quot;</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+const (</span>
<span class="term-fg32">+	&#47;&#47; The two 4-byte Ecotone fee scalar values are packed into the same storage slot as the 8-byte</span>
<span class="term-fg32">+	&#47;&#47; sequence number and have the following Solidity offsets within the slot. Note that Solidity</span>
<span class="term-fg32">+	&#47;&#47; offsets correspond to the last byte of the value in the slot, counting backwards from the</span>
<span class="term-fg32">+	&#47;&#47; end of the slot. For example, The 8-byte sequence number has offset 0, and is therefore</span>
<span class="term-fg32">+	&#47;&#47; stored as big-endian format in bytes [24:32) of the slot.</span>
<span class="term-fg32">+	BaseFeeScalarSlotOffset     = 12 &#47;&#47; bytes [16:20) of the slot</span>
<span class="term-fg32">+	BlobBaseFeeScalarSlotOffset = 8  &#47;&#47; bytes [20:24) of the slot</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; scalarSectionStart is the beginning of the scalar values segment in the slot</span>
<span class="term-fg32">+	&#47;&#47; array. baseFeeScalar is in the first four bytes of the segment, blobBaseFeeScalar the next</span>
<span class="term-fg32">+	&#47;&#47; four.</span>
<span class="term-fg32">+	scalarSectionStart = 32 - BaseFeeScalarSlotOffset - 4</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func init() {</span>
<span class="term-fg32">+	if BlobBaseFeeScalarSlotOffset != BaseFeeScalarSlotOffset-4 {</span>
<span class="term-fg32">+		panic(&quot;this code assumes the scalars are at adjacent positions in the scalars slot&quot;)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+var (</span>
<span class="term-fg32">+	&#47;&#47; BedrockL1AttributesSelector is the function selector indicating Bedrock style L1 gas</span>
<span class="term-fg32">+	&#47;&#47; attributes.</span>
<span class="term-fg32">+	BedrockL1AttributesSelector = []byte{0x01, 0x5d, 0x8e, 0xb9}</span>
<span class="term-fg32">+	&#47;&#47; EcotoneL1AttributesSelector is the selector indicating Ecotone style L1 gas attributes.</span>
<span class="term-fg32">+	EcotoneL1AttributesSelector = []byte{0x44, 0x0a, 0x5e, 0x20}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; L1BlockAddr is the address of the L1Block contract which stores the L1 gas attributes.</span>
<span class="term-fg32">+	L1BlockAddr = common.HexToAddress(&quot;0x4200000000000000000000000000000000000015&quot;)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	L1BaseFeeSlot = common.BigToHash(big.NewInt(1))</span>
<span class="term-fg32">+	OverheadSlot  = common.BigToHash(big.NewInt(5))</span>
<span class="term-fg32">+	ScalarSlot    = common.BigToHash(big.NewInt(6))</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; L1BlobBaseFeeSlot was added with the Ecotone upgrade and stores the blobBaseFee L1 gas</span>
<span class="term-fg32">+	&#47;&#47; attribute.</span>
<span class="term-fg32">+	L1BlobBaseFeeSlot = common.BigToHash(big.NewInt(7))</span>
<span class="term-fg32">+	&#47;&#47; L1FeeScalarsSlot as of the Ecotone upgrade stores the 32-bit basefeeScalar and</span>
<span class="term-fg32">+	&#47;&#47; blobBaseFeeScalar L1 gas attributes at offsets `BaseFeeScalarSlotOffset` and</span>
<span class="term-fg32">+	&#47;&#47; `BlobBaseFeeScalarSlotOffset` respectively.</span>
<span class="term-fg32">+	L1FeeScalarsSlot = common.BigToHash(big.NewInt(3))</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	oneMillion     = big.NewInt(1_000_000)</span>
<span class="term-fg32">+	ecotoneDivisor = big.NewInt(1_000_000 * 16)</span>
<span class="term-fg32">+	fjordDivisor   = big.NewInt(1_000_000_000_000)</span>
<span class="term-fg32">+	sixteen        = big.NewInt(16)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	L1CostIntercept  = big.NewInt(-42_585_600)</span>
<span class="term-fg32">+	L1CostFastlzCoef = big.NewInt(836_500)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	MinTransactionSize       = big.NewInt(100)</span>
<span class="term-fg32">+	MinTransactionSizeScaled = new(big.Int).Mul(MinTransactionSize, big.NewInt(1e6))</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	emptyScalars = make([]byte, 8)</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; RollupCostData is a transaction structure that caches data for quickly computing the data</span>
<span class="term-fg32">+&#47;&#47; availability costs for the transaction.</span>
<span class="term-fg32">+type RollupCostData struct {</span>
<span class="term-fg32">+	Zeroes, Ones uint64</span>
<span class="term-fg32">+	FastLzSize   uint64</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+type StateGetter interface {</span>
<span class="term-fg32">+	GetState(common.Address, common.Hash) common.Hash</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; L1CostFunc is used in the state transition to determine the data availability fee charged to the</span>
<span class="term-fg32">+&#47;&#47; sender of non-Deposit transactions.  It returns nil if no data availability fee is charged.</span>
<span class="term-fg32">+type L1CostFunc func(rcd RollupCostData, blockTime uint64) *big.Int</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; l1CostFunc is an internal version of L1CostFunc that also returns the gasUsed for use in</span>
<span class="term-fg32">+&#47;&#47; receipts.</span>
<span class="term-fg32">+type l1CostFunc func(rcd RollupCostData) (fee, gasUsed *big.Int)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func NewRollupCostData(data []byte) (out RollupCostData) {</span>
<span class="term-fg32">+	for _, b := range data {</span>
<span class="term-fg32">+		if b == 0 {</span>
<span class="term-fg32">+			out.Zeroes++</span>
<span class="term-fg32">+		} else {</span>
<span class="term-fg32">+			out.Ones++</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	out.FastLzSize = uint64(FlzCompressLen(data))</span>
<span class="term-fg32">+	return out</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; NewL1CostFunc returns a function used for calculating data availability fees, or nil if this is</span>
<span class="term-fg32">+&#47;&#47; not an op-stack chain.</span>
<span class="term-fg32">+func NewL1CostFunc(config *params.ChainConfig, statedb StateGetter) L1CostFunc {</span>
<span class="term-fg32">+	if config.Optimism == nil {</span>
<span class="term-fg32">+		return nil</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	forBlock := ^uint64(0)</span>
<span class="term-fg32">+	var cachedFunc l1CostFunc</span>
<span class="term-fg32">+	selectFunc := func(blockTime uint64) l1CostFunc {</span>
<span class="term-fg32">+		if !config.IsOptimismEcotone(blockTime) {</span>
<span class="term-fg32">+			return newL1CostFuncBedrock(config, statedb, blockTime)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		&#47;&#47; Note: the various state variables below are not initialized from the DB until this</span>
<span class="term-fg32">+		&#47;&#47; point to allow deposit transactions from the block to be processed first by state</span>
<span class="term-fg32">+		&#47;&#47; transition.  This behavior is consensus critical!</span>
<span class="term-fg32">+		l1FeeScalars := statedb.GetState(L1BlockAddr, L1FeeScalarsSlot).Bytes()</span>
<span class="term-fg32">+		l1BlobBaseFee := statedb.GetState(L1BlockAddr, L1BlobBaseFeeSlot).Big()</span>
<span class="term-fg32">+		l1BaseFee := statedb.GetState(L1BlockAddr, L1BaseFeeSlot).Big()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		&#47;&#47; Edge case: the very first Ecotone block requires we use the Bedrock cost</span>
<span class="term-fg32">+		&#47;&#47; function. We detect this scenario by checking if the Ecotone parameters are</span>
<span class="term-fg32">+		&#47;&#47; unset. Note here we rely on assumption that the scalar parameters are adjacent</span>
<span class="term-fg32">+		&#47;&#47; in the buffer and l1BaseFeeScalar comes first. We need to check this prior to</span>
<span class="term-fg32">+		&#47;&#47; other forks, as the first block of Fjord and Ecotone could be the same block.</span>
<span class="term-fg32">+		firstEcotoneBlock := l1BlobBaseFee.BitLen() == 0 &amp;&amp;</span>
<span class="term-fg32">+			bytes.Equal(emptyScalars, l1FeeScalars[scalarSectionStart:scalarSectionStart+8])</span>
<span class="term-fg32">+		if firstEcotoneBlock {</span>
<span class="term-fg32">+			log.Info(&quot;using bedrock l1 cost func for first Ecotone block&quot;, &quot;time&quot;, blockTime)</span>
<span class="term-fg32">+			return newL1CostFuncBedrock(config, statedb, blockTime)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		l1BaseFeeScalar, l1BlobBaseFeeScalar := extractEcotoneFeeParams(l1FeeScalars)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		if config.IsOptimismFjord(blockTime) {</span>
<span class="term-fg32">+			return NewL1CostFuncFjord(</span>
<span class="term-fg32">+				l1BaseFee,</span>
<span class="term-fg32">+				l1BlobBaseFee,</span>
<span class="term-fg32">+				l1BaseFeeScalar,</span>
<span class="term-fg32">+				l1BlobBaseFeeScalar,</span>
<span class="term-fg32">+			)</span>
<span class="term-fg32">+		} else {</span>
<span class="term-fg32">+			return newL1CostFuncEcotone(l1BaseFee, l1BlobBaseFee, l1BaseFeeScalar, l1BlobBaseFeeScalar)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	return func(rollupCostData RollupCostData, blockTime uint64) *big.Int {</span>
<span class="term-fg32">+		if rollupCostData == (RollupCostData{}) {</span>
<span class="term-fg32">+			return nil &#47;&#47; Do not charge if there is no rollup cost-data (e.g. RPC call or deposit).</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		if forBlock != blockTime {</span>
<span class="term-fg32">+			if forBlock != ^uint64(0) {</span>
<span class="term-fg32">+				&#47;&#47; best practice is not to re-use l1 cost funcs across different blocks, but we</span>
<span class="term-fg32">+				&#47;&#47; make it work just in case.</span>
<span class="term-fg32">+				log.Info(&quot;l1 cost func re-used for different L1 block&quot;, &quot;oldTime&quot;, forBlock, &quot;newTime&quot;, blockTime)</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+			forBlock = blockTime</span>
<span class="term-fg32">+			cachedFunc = selectFunc(blockTime)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		fee, _ := cachedFunc(rollupCostData)</span>
<span class="term-fg32">+		return fee</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; newL1CostFuncBedrock returns an L1 cost function suitable for Bedrock, Regolith, and the first</span>
<span class="term-fg32">+&#47;&#47; block only of the Ecotone upgrade.</span>
<span class="term-fg32">+func newL1CostFuncBedrock(config *params.ChainConfig, statedb StateGetter, blockTime uint64) l1CostFunc {</span>
<span class="term-fg32">+	l1BaseFee := statedb.GetState(L1BlockAddr, L1BaseFeeSlot).Big()</span>
<span class="term-fg32">+	overhead := statedb.GetState(L1BlockAddr, OverheadSlot).Big()</span>
<span class="term-fg32">+	scalar := statedb.GetState(L1BlockAddr, ScalarSlot).Big()</span>
<span class="term-fg32">+	isRegolith := config.IsRegolith(blockTime)</span>
<span class="term-fg32">+	return newL1CostFuncBedrockHelper(l1BaseFee, overhead, scalar, isRegolith)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; newL1CostFuncBedrockHelper is lower level version of newL1CostFuncBedrock that expects already</span>
<span class="term-fg32">+&#47;&#47; extracted parameters</span>
<span class="term-fg32">+func newL1CostFuncBedrockHelper(l1BaseFee, overhead, scalar *big.Int, isRegolith bool) l1CostFunc {</span>
<span class="term-fg32">+	return func(rollupCostData RollupCostData) (fee, gasUsed *big.Int) {</span>
<span class="term-fg32">+		if rollupCostData == (RollupCostData{}) {</span>
<span class="term-fg32">+			return nil, nil &#47;&#47; Do not charge if there is no rollup cost-data (e.g. RPC call or deposit)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		gas := rollupCostData.Zeroes * params.TxDataZeroGas</span>
<span class="term-fg32">+		if isRegolith {</span>
<span class="term-fg32">+			gas += rollupCostData.Ones * params.TxDataNonZeroGasEIP2028</span>
<span class="term-fg32">+		} else {</span>
<span class="term-fg32">+			gas += (rollupCostData.Ones + 68) * params.TxDataNonZeroGasEIP2028</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		gasWithOverhead := new(big.Int).SetUint64(gas)</span>
<span class="term-fg32">+		gasWithOverhead.Add(gasWithOverhead, overhead)</span>
<span class="term-fg32">+		l1Cost := l1CostHelper(gasWithOverhead, l1BaseFee, scalar)</span>
<span class="term-fg32">+		return l1Cost, gasWithOverhead</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; newL1CostFuncEcotone returns an l1 cost function suitable for the Ecotone upgrade except for the</span>
<span class="term-fg32">+&#47;&#47; very first block of the upgrade.</span>
<span class="term-fg32">+func newL1CostFuncEcotone(l1BaseFee, l1BlobBaseFee, l1BaseFeeScalar, l1BlobBaseFeeScalar *big.Int) l1CostFunc {</span>
<span class="term-fg32">+	return func(costData RollupCostData) (fee, calldataGasUsed *big.Int) {</span>
<span class="term-fg32">+		calldataGasUsed = bedrockCalldataGasUsed(costData)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		&#47;&#47; Ecotone L1 cost function:</span>
<span class="term-fg32">+		&#47;&#47;</span>
<span class="term-fg32">+		&#47;&#47;   (calldataGas&#47;16)*(l1BaseFee*16*l1BaseFeeScalar + l1BlobBaseFee*l1BlobBaseFeeScalar)&#47;1e6</span>
<span class="term-fg32">+		&#47;&#47;</span>
<span class="term-fg32">+		&#47;&#47; We divide &quot;calldataGas&quot; by 16 to change from units of calldata gas to &quot;estimated # of bytes when</span>
<span class="term-fg32">+		&#47;&#47; compressed&quot;. Known as &quot;compressedTxSize&quot; in the spec.</span>
<span class="term-fg32">+		&#47;&#47;</span>
<span class="term-fg32">+		&#47;&#47; Function is actually computed as follows for better precision under integer arithmetic:</span>
<span class="term-fg32">+		&#47;&#47;</span>
<span class="term-fg32">+		&#47;&#47;   calldataGas*(l1BaseFee*16*l1BaseFeeScalar + l1BlobBaseFee*l1BlobBaseFeeScalar)&#47;16e6</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		calldataCostPerByte := new(big.Int).Set(l1BaseFee)</span>
<span class="term-fg32">+		calldataCostPerByte = calldataCostPerByte.Mul(calldataCostPerByte, sixteen)</span>
<span class="term-fg32">+		calldataCostPerByte = calldataCostPerByte.Mul(calldataCostPerByte, l1BaseFeeScalar)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		blobCostPerByte := new(big.Int).Set(l1BlobBaseFee)</span>
<span class="term-fg32">+		blobCostPerByte = blobCostPerByte.Mul(blobCostPerByte, l1BlobBaseFeeScalar)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		fee = new(big.Int).Add(calldataCostPerByte, blobCostPerByte)</span>
<span class="term-fg32">+		fee = fee.Mul(fee, calldataGasUsed)</span>
<span class="term-fg32">+		fee = fee.Div(fee, ecotoneDivisor)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		return fee, calldataGasUsed</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+type gasParams struct {</span>
<span class="term-fg32">+	l1BaseFee           *big.Int</span>
<span class="term-fg32">+	l1BlobBaseFee       *big.Int</span>
<span class="term-fg32">+	costFunc            l1CostFunc</span>
<span class="term-fg32">+	feeScalar           *big.Float &#47;&#47; pre-ecotone</span>
<span class="term-fg32">+	l1BaseFeeScalar     *uint32    &#47;&#47; post-ecotone</span>
<span class="term-fg32">+	l1BlobBaseFeeScalar *uint32    &#47;&#47; post-ecotone</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; intToScaledFloat returns scalar&#47;10e6 as a float</span>
<span class="term-fg32">+func intToScaledFloat(scalar *big.Int) *big.Float {</span>
<span class="term-fg32">+	fscalar := new(big.Float).SetInt(scalar)</span>
<span class="term-fg32">+	fdivisor := new(big.Float).SetUint64(1_000_000) &#47;&#47; 10**6, i.e. 6 decimals</span>
<span class="term-fg32">+	return new(big.Float).Quo(fscalar, fdivisor)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; extractL1GasParams extracts the gas parameters necessary to compute gas costs from L1 block info</span>
<span class="term-fg32">+func extractL1GasParams(config *params.ChainConfig, time uint64, data []byte) (gasParams, error) {</span>
<span class="term-fg32">+	&#47;&#47; edge case: for the very first Ecotone block we still need to use the Bedrock</span>
<span class="term-fg32">+	&#47;&#47; function. We detect this edge case by seeing if the function selector is the old one</span>
<span class="term-fg32">+	&#47;&#47; If so, fall through to the pre-ecotone format</span>
<span class="term-fg32">+	&#47;&#47; Both Ecotone and Fjord use the same function selector</span>
<span class="term-fg32">+	if config.IsEcotone(time) &amp;&amp; len(data) &gt;= 4 &amp;&amp; !bytes.Equal(data[0:4], BedrockL1AttributesSelector) {</span>
<span class="term-fg32">+		p, err := extractL1GasParamsPostEcotone(data)</span>
<span class="term-fg32">+		if err != nil {</span>
<span class="term-fg32">+			return gasParams{}, err</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		if config.IsFjord(time) {</span>
<span class="term-fg32">+			p.costFunc = NewL1CostFuncFjord(</span>
<span class="term-fg32">+				p.l1BaseFee,</span>
<span class="term-fg32">+				p.l1BlobBaseFee,</span>
<span class="term-fg32">+				big.NewInt(int64(*p.l1BaseFeeScalar)),</span>
<span class="term-fg32">+				big.NewInt(int64(*p.l1BlobBaseFeeScalar)),</span>
<span class="term-fg32">+			)</span>
<span class="term-fg32">+		} else {</span>
<span class="term-fg32">+			p.costFunc = newL1CostFuncEcotone(</span>
<span class="term-fg32">+				p.l1BaseFee,</span>
<span class="term-fg32">+				p.l1BlobBaseFee,</span>
<span class="term-fg32">+				big.NewInt(int64(*p.l1BaseFeeScalar)),</span>
<span class="term-fg32">+				big.NewInt(int64(*p.l1BlobBaseFeeScalar)),</span>
<span class="term-fg32">+			)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		return p, nil</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	return extractL1GasParamsPreEcotone(config, time, data)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func extractL1GasParamsPreEcotone(config *params.ChainConfig, time uint64, data []byte) (gasParams, error) {</span>
<span class="term-fg32">+	&#47;&#47; data consists of func selector followed by 7 ABI-encoded parameters (32 bytes each)</span>
<span class="term-fg32">+	if len(data) &lt; 4+32*8 {</span>
<span class="term-fg32">+		return gasParams{}, fmt.Errorf(&quot;expected at least %d L1 info bytes, got %d&quot;, 4+32*8, len(data))</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	data = data[4:]                                       &#47;&#47; trim function selector</span>
<span class="term-fg32">+	l1BaseFee := new(big.Int).SetBytes(data[32*2 : 32*3]) &#47;&#47; arg index 2</span>
<span class="term-fg32">+	overhead := new(big.Int).SetBytes(data[32*6 : 32*7])  &#47;&#47; arg index 6</span>
<span class="term-fg32">+	scalar := new(big.Int).SetBytes(data[32*7 : 32*8])    &#47;&#47; arg index 7</span>
<span class="term-fg32">+	feeScalar := intToScaledFloat(scalar)                 &#47;&#47; legacy: format fee scalar as big Float</span>
<span class="term-fg32">+	costFunc := newL1CostFuncBedrockHelper(l1BaseFee, overhead, scalar, config.IsRegolith(time))</span>
<span class="term-fg32">+	return gasParams{</span>
<span class="term-fg32">+		l1BaseFee: l1BaseFee,</span>
<span class="term-fg32">+		costFunc:  costFunc,</span>
<span class="term-fg32">+		feeScalar: feeScalar,</span>
<span class="term-fg32">+	}, nil</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; extractL1GasParamsPostEcotone extracts the gas parameters necessary to compute gas from L1 attribute</span>
<span class="term-fg32">+&#47;&#47; info calldata after the Ecotone upgrade, but not for the very first Ecotone block.</span>
<span class="term-fg32">+func extractL1GasParamsPostEcotone(data []byte) (gasParams, error) {</span>
<span class="term-fg32">+	if len(data) != 164 {</span>
<span class="term-fg32">+		return gasParams{}, fmt.Errorf(&quot;expected 164 L1 info bytes, got %d&quot;, len(data))</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	&#47;&#47; data layout assumed for Ecotone:</span>
<span class="term-fg32">+	&#47;&#47; offset type varname</span>
<span class="term-fg32">+	&#47;&#47; 0     &lt;selector&gt;</span>
<span class="term-fg32">+	&#47;&#47; 4     uint32 _basefeeScalar</span>
<span class="term-fg32">+	&#47;&#47; 8     uint32 _blobBaseFeeScalar</span>
<span class="term-fg32">+	&#47;&#47; 12    uint64 _sequenceNumber,</span>
<span class="term-fg32">+	&#47;&#47; 20    uint64 _timestamp,</span>
<span class="term-fg32">+	&#47;&#47; 28    uint64 _l1BlockNumber</span>
<span class="term-fg32">+	&#47;&#47; 36    uint256 _basefee,</span>
<span class="term-fg32">+	&#47;&#47; 68    uint256 _blobBaseFee,</span>
<span class="term-fg32">+	&#47;&#47; 100   bytes32 _hash,</span>
<span class="term-fg32">+	&#47;&#47; 132   bytes32 _batcherHash,</span>
<span class="term-fg32">+	l1BaseFee := new(big.Int).SetBytes(data[36:68])</span>
<span class="term-fg32">+	l1BlobBaseFee := new(big.Int).SetBytes(data[68:100])</span>
<span class="term-fg32">+	l1BaseFeeScalar := binary.BigEndian.Uint32(data[4:8])</span>
<span class="term-fg32">+	l1BlobBaseFeeScalar := binary.BigEndian.Uint32(data[8:12])</span>
<span class="term-fg32">+	return gasParams{</span>
<span class="term-fg32">+		l1BaseFee:           l1BaseFee,</span>
<span class="term-fg32">+		l1BlobBaseFee:       l1BlobBaseFee,</span>
<span class="term-fg32">+		l1BaseFeeScalar:     &amp;l1BaseFeeScalar,</span>
<span class="term-fg32">+		l1BlobBaseFeeScalar: &amp;l1BlobBaseFeeScalar,</span>
<span class="term-fg32">+	}, nil</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; L1Cost computes the the data availability fee for transactions in blocks prior to the Ecotone</span>
<span class="term-fg32">+&#47;&#47; upgrade. It is used by e2e tests so must remain exported.</span>
<span class="term-fg32">+func L1Cost(rollupDataGas uint64, l1BaseFee, overhead, scalar *big.Int) *big.Int {</span>
<span class="term-fg32">+	l1GasUsed := new(big.Int).SetUint64(rollupDataGas)</span>
<span class="term-fg32">+	l1GasUsed.Add(l1GasUsed, overhead)</span>
<span class="term-fg32">+	return l1CostHelper(l1GasUsed, l1BaseFee, scalar)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func l1CostHelper(gasWithOverhead, l1BaseFee, scalar *big.Int) *big.Int {</span>
<span class="term-fg32">+	fee := new(big.Int).Set(gasWithOverhead)</span>
<span class="term-fg32">+	fee.Mul(fee, l1BaseFee).Mul(fee, scalar).Div(fee, oneMillion)</span>
<span class="term-fg32">+	return fee</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; NewL1CostFuncFjord returns an l1 cost function suitable for the Fjord upgrade</span>
<span class="term-fg32">+func NewL1CostFuncFjord(l1BaseFee, l1BlobBaseFee, baseFeeScalar, blobFeeScalar *big.Int) l1CostFunc {</span>
<span class="term-fg32">+	return func(costData RollupCostData) (fee, calldataGasUsed *big.Int) {</span>
<span class="term-fg32">+		&#47;&#47; Fjord L1 cost function:</span>
<span class="term-fg32">+		&#47;&#47;l1FeeScaled = baseFeeScalar*l1BaseFee*16 + blobFeeScalar*l1BlobBaseFee</span>
<span class="term-fg32">+		&#47;&#47;estimatedSize = max(minTransactionSize, intercept + fastlzCoef*fastlzSize)</span>
<span class="term-fg32">+		&#47;&#47;l1Cost = estimatedSize * l1FeeScaled &#47; 1e12</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		scaledL1BaseFee := new(big.Int).Mul(baseFeeScalar, l1BaseFee)</span>
<span class="term-fg32">+		calldataCostPerByte := new(big.Int).Mul(scaledL1BaseFee, sixteen)</span>
<span class="term-fg32">+		blobCostPerByte := new(big.Int).Mul(blobFeeScalar, l1BlobBaseFee)</span>
<span class="term-fg32">+		l1FeeScaled := new(big.Int).Add(calldataCostPerByte, blobCostPerByte)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		fastLzSize := new(big.Int).SetUint64(costData.FastLzSize)</span>
<span class="term-fg32">+		estimatedSize := new(big.Int).Add(L1CostIntercept, new(big.Int).Mul(L1CostFastlzCoef, fastLzSize))</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		if estimatedSize.Cmp(MinTransactionSizeScaled) &lt; 0 {</span>
<span class="term-fg32">+			estimatedSize.Set(MinTransactionSizeScaled)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		l1CostScaled := new(big.Int).Mul(estimatedSize, l1FeeScaled)</span>
<span class="term-fg32">+		l1Cost := new(big.Int).Div(l1CostScaled, fjordDivisor)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		calldataGasUsed = new(big.Int).Mul(estimatedSize, new(big.Int).SetUint64(params.TxDataNonZeroGasEIP2028))</span>
<span class="term-fg32">+		calldataGasUsed.Div(calldataGasUsed, big.NewInt(1e6))</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		return l1Cost, calldataGasUsed</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func extractEcotoneFeeParams(l1FeeParams []byte) (l1BaseFeeScalar, l1BlobBaseFeeScalar *big.Int) {</span>
<span class="term-fg32">+	offset := scalarSectionStart</span>
<span class="term-fg32">+	l1BaseFeeScalar = new(big.Int).SetBytes(l1FeeParams[offset : offset+4])</span>
<span class="term-fg32">+	l1BlobBaseFeeScalar = new(big.Int).SetBytes(l1FeeParams[offset+4 : offset+8])</span>
<span class="term-fg32">+	return</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func bedrockCalldataGasUsed(costData RollupCostData) (calldataGasUsed *big.Int) {</span>
<span class="term-fg32">+	calldataGas := (costData.Zeroes * params.TxDataZeroGas) + (costData.Ones * params.TxDataNonZeroGasEIP2028)</span>
<span class="term-fg32">+	return new(big.Int).SetUint64(calldataGas)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; FlzCompressLen returns the length of the data after compression through FastLZ, based on</span>
<span class="term-fg32">+&#47;&#47; https:&#47;&#47;github.com&#47;Vectorized&#47;solady&#47;blob&#47;5315d937d79b335c668896d7533ac603adac5315&#47;js&#47;solady.js</span>
<span class="term-fg32">+func FlzCompressLen(ib []byte) uint32 {</span>
<span class="term-fg32">+	n := uint32(0)</span>
<span class="term-fg32">+	ht := make([]uint32, 8192)</span>
<span class="term-fg32">+	u24 := func(i uint32) uint32 {</span>
<span class="term-fg32">+		return uint32(ib[i]) | (uint32(ib[i+1]) &lt;&lt; 8) | (uint32(ib[i+2]) &lt;&lt; 16)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	cmp := func(p uint32, q uint32, e uint32) uint32 {</span>
<span class="term-fg32">+		l := uint32(0)</span>
<span class="term-fg32">+		for e -= q; l &lt; e; l++ {</span>
<span class="term-fg32">+			if ib[p+l] != ib[q+l] {</span>
<span class="term-fg32">+				e = 0</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		return l</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	literals := func(r uint32) {</span>
<span class="term-fg32">+		n += 0x21 * (r &#47; 0x20)</span>
<span class="term-fg32">+		r %= 0x20</span>
<span class="term-fg32">+		if r != 0 {</span>
<span class="term-fg32">+			n += r + 1</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	match := func(l uint32) {</span>
<span class="term-fg32">+		l--</span>
<span class="term-fg32">+		n += 3 * (l &#47; 262)</span>
<span class="term-fg32">+		if l%262 &gt;= 6 {</span>
<span class="term-fg32">+			n += 3</span>
<span class="term-fg32">+		} else {</span>
<span class="term-fg32">+			n += 2</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	hash := func(v uint32) uint32 {</span>
<span class="term-fg32">+		return ((2654435769 * v) &gt;&gt; 19) &amp; 0x1fff</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	setNextHash := func(ip uint32) uint32 {</span>
<span class="term-fg32">+		ht[hash(u24(ip))] = ip</span>
<span class="term-fg32">+		return ip + 1</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	a := uint32(0)</span>
<span class="term-fg32">+	ipLimit := uint32(len(ib)) - 13</span>
<span class="term-fg32">+	if len(ib) &lt; 13 {</span>
<span class="term-fg32">+		ipLimit = 0</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	for ip := a + 2; ip &lt; ipLimit; {</span>
<span class="term-fg32">+		r := uint32(0)</span>
<span class="term-fg32">+		d := uint32(0)</span>
<span class="term-fg32">+		for {</span>
<span class="term-fg32">+			s := u24(ip)</span>
<span class="term-fg32">+			h := hash(s)</span>
<span class="term-fg32">+			r = ht[h]</span>
<span class="term-fg32">+			ht[h] = ip</span>
<span class="term-fg32">+			d = ip - r</span>
<span class="term-fg32">+			if ip &gt;= ipLimit {</span>
<span class="term-fg32">+				break</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+			ip++</span>
<span class="term-fg32">+			if d &lt;= 0x1fff &amp;&amp; s == u24(r) {</span>
<span class="term-fg32">+				break</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		if ip &gt;= ipLimit {</span>
<span class="term-fg32">+			break</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		ip--</span>
<span class="term-fg32">+		if ip &gt; a {</span>
<span class="term-fg32">+			literals(ip - a)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		l := cmp(r+3, ip+3, ipLimit+9)</span>
<span class="term-fg32">+		match(l)</span>
<span class="term-fg32">+		ip = setNextHash(setNextHash(ip + l))</span>
<span class="term-fg32">+		a = ip</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	literals(uint32(len(ib)) - a)</span>
<span class="term-fg32">+	return n</span>
<span class="term-fg32">+}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-4eeafac6b23d1b984bfb7d0f" role="button"
                       aria-expanded="false" aria-controls="id-4eeafac6b23d1b984bfb7d0f">
                        <code>core/vm/evm.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/core/vm/evm.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/core/vm/evm.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+10</span></div>
                            <div class="text-start"><span class="text-danger">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-4eeafac6b23d1b984bfb7d0f"><span class="term-fg1">diff --git go-ethereum&#47;core&#47;vm&#47;evm.go op-geth&#47;core&#47;vm&#47;evm.go</span>
<span class="term-fg1">index 1944189b5da247031cc8fb6fb828ab1c422a19f1..3f8b1dc1e3e14b9cce3abea74fc513c4bb8a6c98 100644</span>
<span class="term-fg1">--- go-ethereum&#47;core&#47;vm&#47;evm.go</span>
<span class="term-fg1">+++ op-geth&#47;core&#47;vm&#47;evm.go</span>
<span class="term-fg36">@@ -43,6 +43,10 @@</span>
 func (evm *EVM) precompile(addr common.Address) (PrecompiledContract, bool) {
 	var precompiles map[common.Address]PrecompiledContract
 	switch {
<span class="term-fg32">+	case evm.chainRules.IsOptimismGranite:</span>
<span class="term-fg32">+		precompiles = PrecompiledContractsGranite</span>
<span class="term-fg32">+	case evm.chainRules.IsOptimismFjord:</span>
<span class="term-fg32">+		precompiles = PrecompiledContractsFjord</span>
 	case evm.chainRules.IsVerkle:
 		precompiles = PrecompiledContractsVerkle
 	case evm.chainRules.IsPrague:
<span class="term-fg36">@@ -59,6 +63,10 @@</span> 	default:
 		precompiles = PrecompiledContractsHomestead
 	}
 	p, ok := precompiles[addr]
<span class="term-fg32">+	if evm.Config.PrecompileOverrides != nil {</span>
<span class="term-fg32">+		override := evm.Config.PrecompileOverrides(evm.chainRules, p, addr)</span>
<span class="term-fg32">+		return override, override != nil</span>
<span class="term-fg32">+	}</span>
 	return p, ok
 }
&nbsp;
<span class="term-fg36">@@ -72,6 +80,8 @@</span> 	&#47;&#47; Transfer transfers ether from one account to the other
 	Transfer TransferFunc
 	&#47;&#47; GetHash returns the hash corresponding to n
 	GetHash GetHashFunc
<span class="term-fg32">+	&#47;&#47; L1CostFunc returns the L1 cost of the rollup message, the function may be nil, or return nil</span>
<span class="term-fg32">+	L1CostFunc types.L1CostFunc</span>
&nbsp;
 	&#47;&#47; Block information
 	Coinbase    common.Address &#47;&#47; Provides information for COINBASE</div>
    </div>

            
            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-a592fe0b6a5a6e0c9327fb57"role="button" aria-expanded="false" aria-controls="id-a592fe0b6a5a6e0c9327fb57">
        
            <div class="col-12 col-md-12 col-lg-6 col-xl-6 text-start"><h4>Transaction processing</h4></div>
        

        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2">
            <div class="row line-stat">
                
                
            </div>
        </div>
        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2 ">
            <div class="row line-stat">
                
                    <div class="text-end"><span class="text-success">+133</span></div>
                    <div class="text-start"><span class="text-danger">-10</span></div>
                
                
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-a592fe0b6a5a6e0c9327fb57">
        <div><p>Deposit transactions have special processing rules: gas is pre-paid on L1,
and deposits with EVM-failure are included with rolled back changes (except mint).
For regular transactions, at the end of the transition, the 1559 burn and L1 cost are routed to vaults.</p>
</div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-d8952df30cb7af7ecde6c98c" role="button"
                       aria-expanded="false" aria-controls="id-d8952df30cb7af7ecde6c98c">
                        <code>core/state_transition.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/core/state_transition.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/core/state_transition.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+133</span></div>
                            <div class="text-start"><span class="text-danger">-10</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-d8952df30cb7af7ecde6c98c"><span class="term-fg1">diff --git go-ethereum&#47;core&#47;state_transition.go op-geth&#47;core&#47;state_transition.go</span>
<span class="term-fg1">index 1a6a66a2fc14fece543242f1d558d45924ee7453..af53eae272ce92c3cfdbfd5d822a20f4114c41f2 100644</span>
<span class="term-fg1">--- go-ethereum&#47;core&#47;state_transition.go</span>
<span class="term-fg1">+++ op-geth&#47;core&#47;state_transition.go</span>
<span class="term-fg36">@@ -146,20 +146,30 @@</span> 	&#47;&#47; When SkipAccountChecks is true, the message nonce is not checked against the
 	&#47;&#47; account nonce in state. It also disables checking that the sender is an EOA.
 	&#47;&#47; This field will be set to true for operations like RPC eth_call.
 	SkipAccountChecks bool
<span class="term-fg32">+</span>
<span class="term-fg32">+	IsSystemTx     bool                 &#47;&#47; IsSystemTx indicates the message, if also a deposit, does not emit gas usage.</span>
<span class="term-fg32">+	IsDepositTx    bool                 &#47;&#47; IsDepositTx indicates the message is force-included and can persist a mint.</span>
<span class="term-fg32">+	Mint           *big.Int             &#47;&#47; Mint is the amount to mint before EVM processing, or nil if there is no minting.</span>
<span class="term-fg32">+	RollupCostData types.RollupCostData &#47;&#47; RollupCostData caches data to compute the fee we charge for data availability</span>
 }
&nbsp;
 &#47;&#47; TransactionToMessage converts a transaction into a Message.
 func TransactionToMessage(tx *types.Transaction, s types.Signer, baseFee *big.Int) (*Message, error) {
 	msg := &amp;Message{
<span class="term-fg31">-		Nonce:             tx.Nonce(),</span>
<span class="term-fg31">-		GasLimit:          tx.Gas(),</span>
<span class="term-fg31">-		GasPrice:          new(big.Int).Set(tx.GasPrice()),</span>
<span class="term-fg31">-		GasFeeCap:         new(big.Int).Set(tx.GasFeeCap()),</span>
<span class="term-fg31">-		GasTipCap:         new(big.Int).Set(tx.GasTipCap()),</span>
<span class="term-fg31">-		To:                tx.To(),</span>
<span class="term-fg31">-		Value:             tx.Value(),</span>
<span class="term-fg31">-		Data:              tx.Data(),</span>
<span class="term-fg31">-		AccessList:        tx.AccessList(),</span>
<span class="term-fg32">+		Nonce:          tx.Nonce(),</span>
<span class="term-fg32">+		GasLimit:       tx.Gas(),</span>
<span class="term-fg32">+		GasPrice:       new(big.Int).Set(tx.GasPrice()),</span>
<span class="term-fg32">+		GasFeeCap:      new(big.Int).Set(tx.GasFeeCap()),</span>
<span class="term-fg32">+		GasTipCap:      new(big.Int).Set(tx.GasTipCap()),</span>
<span class="term-fg32">+		To:             tx.To(),</span>
<span class="term-fg32">+		Value:          tx.Value(),</span>
<span class="term-fg32">+		Data:           tx.Data(),</span>
<span class="term-fg32">+		AccessList:     tx.AccessList(),</span>
<span class="term-fg32">+		IsSystemTx:     tx.IsSystemTx(),</span>
<span class="term-fg32">+		IsDepositTx:    tx.IsDepositTx(),</span>
<span class="term-fg32">+		Mint:           tx.Mint(),</span>
<span class="term-fg32">+		RollupCostData: tx.RollupCostData(),</span>
<span class="term-fg32">+</span>
 		SkipAccountChecks: false,
 		BlobHashes:        tx.BlobHashes(),
 		BlobGasFeeCap:     tx.BlobGasFeeCap(),
<span class="term-fg36">@@ -236,12 +246,22 @@</span>
 func (st *StateTransition) buyGas() error {
 	mgval := new(big.Int).SetUint64(st.msg.GasLimit)
 	mgval.Mul(mgval, st.msg.GasPrice)
<span class="term-fg32">+	var l1Cost *big.Int</span>
<span class="term-fg32">+	if st.evm.Context.L1CostFunc != nil &amp;&amp; !st.msg.SkipAccountChecks {</span>
<span class="term-fg32">+		l1Cost = st.evm.Context.L1CostFunc(st.msg.RollupCostData, st.evm.Context.Time)</span>
<span class="term-fg32">+		if l1Cost != nil {</span>
<span class="term-fg32">+			mgval = mgval.Add(mgval, l1Cost)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
 	balanceCheck := new(big.Int).Set(mgval)
 	if st.msg.GasFeeCap != nil {
 		balanceCheck.SetUint64(st.msg.GasLimit)
 		balanceCheck = balanceCheck.Mul(balanceCheck, st.msg.GasFeeCap)
 	}
 	balanceCheck.Add(balanceCheck, st.msg.Value)
<span class="term-fg32">+	if l1Cost != nil {</span>
<span class="term-fg32">+		balanceCheck.Add(balanceCheck, l1Cost)</span>
<span class="term-fg32">+	}</span>
&nbsp;
 	if st.evm.ChainConfig().IsCancun(st.evm.Context.BlockNumber, st.evm.Context.Time) {
 		if blobGas := st.blobGasUsed(); blobGas &gt; 0 {
<span class="term-fg36">@@ -278,6 +298,21 @@</span> 	return nil
 }
&nbsp;
 func (st *StateTransition) preCheck() error {
<span class="term-fg32">+	if st.msg.IsDepositTx {</span>
<span class="term-fg32">+		&#47;&#47; No fee fields to check, no nonce to check, and no need to check if EOA (L1 already verified it for us)</span>
<span class="term-fg32">+		&#47;&#47; Gas is free, but no refunds!</span>
<span class="term-fg32">+		st.initialGas = st.msg.GasLimit</span>
<span class="term-fg32">+		st.gasRemaining += st.msg.GasLimit &#47;&#47; Add gas here in order to be able to execute calls.</span>
<span class="term-fg32">+		&#47;&#47; Don&#39;t touch the gas pool for system transactions</span>
<span class="term-fg32">+		if st.msg.IsSystemTx {</span>
<span class="term-fg32">+			if st.evm.ChainConfig().IsOptimismRegolith(st.evm.Context.Time) {</span>
<span class="term-fg32">+				return fmt.Errorf(&quot;%w: address %v&quot;, ErrSystemTxNotSupported,</span>
<span class="term-fg32">+					st.msg.From.Hex())</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+			return nil</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		return st.gp.SubGas(st.msg.GasLimit) &#47;&#47; gas used by deposits may not be used by other txs</span>
<span class="term-fg32">+	}</span>
 	&#47;&#47; Only check transactions that are not fake
 	msg := st.msg
 	if !msg.SkipAccountChecks {
<span class="term-fg36">@@ -371,6 +406,45 @@</span> &#47;&#47;
 &#47;&#47; However if any consensus issue encountered, return the error directly with
 &#47;&#47; nil evm execution result.
 func (st *StateTransition) TransitionDb() (*ExecutionResult, error) {
<span class="term-fg32">+	if mint := st.msg.Mint; mint != nil {</span>
<span class="term-fg32">+		mintU256, overflow := uint256.FromBig(mint)</span>
<span class="term-fg32">+		if overflow {</span>
<span class="term-fg32">+			return nil, fmt.Errorf(&quot;mint value exceeds uint256: %d&quot;, mintU256)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		st.state.AddBalance(st.msg.From, mintU256, tracing.BalanceMint)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	snap := st.state.Snapshot()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	result, err := st.innerTransitionDb()</span>
<span class="term-fg32">+	&#47;&#47; Failed deposits must still be included. Unless we cannot produce the block at all due to the gas limit.</span>
<span class="term-fg32">+	&#47;&#47; On deposit failure, we rewind any state changes from after the minting, and increment the nonce.</span>
<span class="term-fg32">+	if err != nil &amp;&amp; err != ErrGasLimitReached &amp;&amp; st.msg.IsDepositTx {</span>
<span class="term-fg32">+		if st.evm.Config.Tracer != nil &amp;&amp; st.evm.Config.Tracer.OnEnter != nil {</span>
<span class="term-fg32">+			st.evm.Config.Tracer.OnEnter(0, byte(vm.STOP), common.Address{}, common.Address{}, nil, 0, nil)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		st.state.RevertToSnapshot(snap)</span>
<span class="term-fg32">+		&#47;&#47; Even though we revert the state changes, always increment the nonce for the next deposit transaction</span>
<span class="term-fg32">+		st.state.SetNonce(st.msg.From, st.state.GetNonce(st.msg.From)+1)</span>
<span class="term-fg32">+		&#47;&#47; Record deposits as using all their gas (matches the gas pool)</span>
<span class="term-fg32">+		&#47;&#47; System Transactions are special &amp; are not recorded as using any gas (anywhere)</span>
<span class="term-fg32">+		&#47;&#47; Regolith changes this behaviour so the actual gas used is reported.</span>
<span class="term-fg32">+		&#47;&#47; In this case the tx is invalid so is recorded as using all gas.</span>
<span class="term-fg32">+		gasUsed := st.msg.GasLimit</span>
<span class="term-fg32">+		if st.msg.IsSystemTx &amp;&amp; !st.evm.ChainConfig().IsRegolith(st.evm.Context.Time) {</span>
<span class="term-fg32">+			gasUsed = 0</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		result = &amp;ExecutionResult{</span>
<span class="term-fg32">+			UsedGas:    gasUsed,</span>
<span class="term-fg32">+			Err:        fmt.Errorf(&quot;failed deposit: %w&quot;, err),</span>
<span class="term-fg32">+			ReturnData: nil,</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		err = nil</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	return result, err</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (st *StateTransition) innerTransitionDb() (*ExecutionResult, error) {</span>
 	&#47;&#47; First check this message satisfies all consensus rules before
 	&#47;&#47; applying the message. The rules include these clauses
 	&#47;&#47;
<span class="term-fg36">@@ -402,7 +476,11 @@</span> 	if st.gasRemaining &lt; gas {
 		return nil, fmt.Errorf(&quot;%w: have %d, want %d&quot;, ErrIntrinsicGas, st.gasRemaining, gas)
 	}
 	if t := st.evm.Config.Tracer; t != nil &amp;&amp; t.OnGasChange != nil {
<span class="term-fg31">-		t.OnGasChange(st.gasRemaining, st.gasRemaining-gas, tracing.GasChangeTxIntrinsicGas)</span>
<span class="term-fg32">+		if st.msg.IsDepositTx {</span>
<span class="term-fg32">+			t.OnGasChange(st.gasRemaining, 0, tracing.GasChangeTxIntrinsicGas)</span>
<span class="term-fg32">+		} else {</span>
<span class="term-fg32">+			t.OnGasChange(st.gasRemaining, st.gasRemaining-gas, tracing.GasChangeTxIntrinsicGas)</span>
<span class="term-fg32">+		}</span>
 	}
 	st.gasRemaining -= gas
&nbsp;
<span class="term-fg36">@@ -445,6 +523,24 @@</span> 		st.state.SetNonce(msg.From, st.state.GetNonce(sender.Address())+1)
 		ret, st.gasRemaining, vmerr = st.evm.Call(sender, st.to(), msg.Data, st.gasRemaining, value)
 	}
&nbsp;
<span class="term-fg32">+	&#47;&#47; if deposit: skip refunds, skip tipping coinbase</span>
<span class="term-fg32">+	&#47;&#47; Regolith changes this behaviour to report the actual gasUsed instead of always reporting all gas used.</span>
<span class="term-fg32">+	if st.msg.IsDepositTx &amp;&amp; !rules.IsOptimismRegolith {</span>
<span class="term-fg32">+		&#47;&#47; Record deposits as using all their gas (matches the gas pool)</span>
<span class="term-fg32">+		&#47;&#47; System Transactions are special &amp; are not recorded as using any gas (anywhere)</span>
<span class="term-fg32">+		gasUsed := st.msg.GasLimit</span>
<span class="term-fg32">+		if st.msg.IsSystemTx {</span>
<span class="term-fg32">+			gasUsed = 0</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		return &amp;ExecutionResult{</span>
<span class="term-fg32">+			UsedGas:    gasUsed,</span>
<span class="term-fg32">+			Err:        vmerr,</span>
<span class="term-fg32">+			ReturnData: ret,</span>
<span class="term-fg32">+		}, nil</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	&#47;&#47; Note for deposit tx there is no ETH refunded for unused gas, but that&#39;s taken care of by the fact that gasPrice</span>
<span class="term-fg32">+	&#47;&#47; is always 0 for deposit tx. So calling refundGas will ensure the gasUsed accounting is correct without actually</span>
<span class="term-fg32">+	&#47;&#47; changing the sender&#39;s balance</span>
 	var gasRefund uint64
 	if !rules.IsLondon {
 		&#47;&#47; Before EIP-3529: refunds were capped to gasUsed &#47; 2
<span class="term-fg36">@@ -453,6 +549,15 @@</span> 	} else {
 		&#47;&#47; After EIP-3529: refunds are capped to gasUsed &#47; 5
 		gasRefund = st.refundGas(params.RefundQuotientEIP3529)
 	}
<span class="term-fg32">+	if st.msg.IsDepositTx &amp;&amp; rules.IsOptimismRegolith {</span>
<span class="term-fg32">+		&#47;&#47; Skip coinbase payments for deposit tx in Regolith</span>
<span class="term-fg32">+		return &amp;ExecutionResult{</span>
<span class="term-fg32">+			UsedGas:     st.gasUsed(),</span>
<span class="term-fg32">+			RefundedGas: gasRefund,</span>
<span class="term-fg32">+			Err:         vmerr,</span>
<span class="term-fg32">+			ReturnData:  ret,</span>
<span class="term-fg32">+		}, nil</span>
<span class="term-fg32">+	}</span>
 	effectiveTip := msg.GasPrice
 	if rules.IsLondon {
 		effectiveTip = cmath.BigMin(msg.GasTipCap, new(big.Int).Sub(msg.GasFeeCap, st.evm.Context.BaseFee))
<span class="term-fg36">@@ -471,6 +576,24 @@</span>
 		&#47;&#47; add the coinbase to the witness iff the fee is greater than 0
 		if rules.IsEIP4762 &amp;&amp; fee.Sign() != 0 {
 			st.evm.AccessEvents.BalanceGas(st.evm.Context.Coinbase, true)
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Check that we are post bedrock to enable op-geth to be able to create pseudo pre-bedrock blocks (these are pre-bedrock, but don&#39;t follow l2 geth rules)</span>
<span class="term-fg32">+	&#47;&#47; Note optimismConfig will not be nil if rules.IsOptimismBedrock is true</span>
<span class="term-fg32">+	if optimismConfig := st.evm.ChainConfig().Optimism; optimismConfig != nil &amp;&amp; rules.IsOptimismBedrock &amp;&amp; !st.msg.IsDepositTx {</span>
<span class="term-fg32">+		gasCost := new(big.Int).Mul(new(big.Int).SetUint64(st.gasUsed()), st.evm.Context.BaseFee)</span>
<span class="term-fg32">+		amtU256, overflow := uint256.FromBig(gasCost)</span>
<span class="term-fg32">+		if overflow {</span>
<span class="term-fg32">+			return nil, fmt.Errorf(&quot;optimism gas cost overflows U256: %d&quot;, gasCost)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		st.state.AddBalance(params.OptimismBaseFeeRecipient, amtU256, tracing.BalanceIncreaseRewardTransactionFee)</span>
<span class="term-fg32">+		if l1Cost := st.evm.Context.L1CostFunc(st.msg.RollupCostData, st.evm.Context.Time); l1Cost != nil {</span>
<span class="term-fg32">+			amtU256, overflow = uint256.FromBig(l1Cost)</span>
<span class="term-fg32">+			if overflow {</span>
<span class="term-fg32">+				return nil, fmt.Errorf(&quot;optimism l1 cost overflows U256: %d&quot;, l1Cost)</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+			st.state.AddBalance(params.OptimismL1FeeRecipient, amtU256, tracing.BalanceIncreaseRewardTransactionFee)</span>
 		}
 	}
</div>
    </div>

            
            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-9d3f89d3868017d51a131740"role="button" aria-expanded="false" aria-controls="id-9d3f89d3868017d51a131740">
        
            <div class="col-12 col-md-12 col-lg-6 col-xl-6 text-start"><h4>Core Error definitions</h4></div>
        

        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2">
            <div class="row line-stat">
                
                
            </div>
        </div>
        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2 ">
            <div class="row line-stat">
                
                    <div class="text-end"><span class="text-success">+3</span></div>
                    <div class="text-start"><span class="text-danger">-0</span></div>
                
                
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-9d3f89d3868017d51a131740">
        <div></div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-e626b22d3029fe4af898edb1" role="button"
                       aria-expanded="false" aria-controls="id-e626b22d3029fe4af898edb1">
                        <code>core/error.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/core/error.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/core/error.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+3</span></div>
                            <div class="text-start"><span class="text-danger">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-e626b22d3029fe4af898edb1"><span class="term-fg1">diff --git go-ethereum&#47;core&#47;error.go op-geth&#47;core&#47;error.go</span>
<span class="term-fg1">index 161538fe4323d2ffeeb69f778cfbe0e119c24157..e6ad999bdd58115becdd6b464ce81f21990e1ed6 100644</span>
<span class="term-fg1">--- go-ethereum&#47;core&#47;error.go</span>
<span class="term-fg1">+++ op-geth&#47;core&#47;error.go</span>
<span class="term-fg36">@@ -112,4 +112,7 @@</span> 	ErrMissingBlobHashes = errors.New(&quot;blob transaction missing blob hashes&quot;)
&nbsp;
 	&#47;&#47; ErrBlobTxCreate is returned if a blob transaction has no explicit to field.
 	ErrBlobTxCreate = errors.New(&quot;blob transaction of type create&quot;)
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; ErrSystemTxNotSupported is returned for any deposit tx with IsSystemTx=true after the Regolith fork</span>
<span class="term-fg32">+	ErrSystemTxNotSupported = errors.New(&quot;system tx not supported&quot;)</span>
 )</div>
    </div>

            
            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-7c79ba4e6752276a93b04ea0"role="button" aria-expanded="false" aria-controls="id-7c79ba4e6752276a93b04ea0">
        
            <div class="col-12 col-md-12 col-lg-6 col-xl-6 text-start"><h4>Gaslimit</h4></div>
        

        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2">
            <div class="row line-stat">
                
                
            </div>
        </div>
        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2 ">
            <div class="row line-stat">
                
                    <div class="text-end"><span class="text-success">+9</span></div>
                    <div class="text-start"><span class="text-danger">-6</span></div>
                
                
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-7c79ba4e6752276a93b04ea0">
        <div><p>The gaslimit is free to be set by the Engine API caller, instead of enforcing adjustments of the
gaslimit in increments of <sup>1</sup>&frasl;<sub>1024</sub> of the previous gaslimit.
The gaslimit is changed (and limited) through the <code>SystemConfig</code> contract.</p>
</div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-128c8cdb9858c64d114cd4b7" role="button"
                       aria-expanded="false" aria-controls="id-128c8cdb9858c64d114cd4b7">
                        <code>consensus/misc/eip1559/eip1559.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/consensus/misc/eip1559/eip1559.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/consensus/misc/eip1559/eip1559.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+9</span></div>
                            <div class="text-start"><span class="text-danger">-6</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-128c8cdb9858c64d114cd4b7"><span class="term-fg1">diff --git go-ethereum&#47;consensus&#47;misc&#47;eip1559&#47;eip1559.go op-geth&#47;consensus&#47;misc&#47;eip1559&#47;eip1559.go</span>
<span class="term-fg1">index 84b82c4c492ec1351da2129b51b99fc50d3c6b28..a66298af692fbb7bb477847452aff5937af55c83 100644</span>
<span class="term-fg1">--- go-ethereum&#47;consensus&#47;misc&#47;eip1559&#47;eip1559.go</span>
<span class="term-fg1">+++ op-geth&#47;consensus&#47;misc&#47;eip1559&#47;eip1559.go</span>
<span class="term-fg36">@@ -37,15 +37,17 @@</span> 	parentGasLimit := parent.GasLimit
 	if !config.IsLondon(parent.Number) {
 		parentGasLimit = parent.GasLimit * config.ElasticityMultiplier()
 	}
<span class="term-fg31">-	if err := misc.VerifyGaslimit(parentGasLimit, header.GasLimit); err != nil {</span>
<span class="term-fg31">-		return err</span>
<span class="term-fg32">+	if config.Optimism == nil { &#47;&#47; gasLimit can adjust instantly in optimism</span>
<span class="term-fg32">+		if err := misc.VerifyGaslimit(parentGasLimit, header.GasLimit); err != nil {</span>
<span class="term-fg32">+			return err</span>
<span class="term-fg32">+		}</span>
 	}
 	&#47;&#47; Verify the header is not malformed
 	if header.BaseFee == nil {
 		return errors.New(&quot;header is missing baseFee&quot;)
 	}
 	&#47;&#47; Verify the baseFee is correct based on the parent header.
<span class="term-fg31">-	expectedBaseFee := CalcBaseFee(config, parent)</span>
<span class="term-fg32">+	expectedBaseFee := CalcBaseFee(config, parent, header.Time)</span>
 	if header.BaseFee.Cmp(expectedBaseFee) != 0 {
 		return fmt.Errorf(&quot;invalid baseFee: have %s, want %s, parentBaseFee %s, parentGasUsed %d&quot;,
 			header.BaseFee, expectedBaseFee, parent.BaseFee, parent.GasUsed)
<span class="term-fg36">@@ -54,7 +56,8 @@</span> 	return nil
 }
&nbsp;
 &#47;&#47; CalcBaseFee calculates the basefee of the header.
<span class="term-fg31">-func CalcBaseFee(config *params.ChainConfig, parent *types.Header) *big.Int {</span>
<span class="term-fg32">+&#47;&#47; The time belongs to the new block to check if Canyon is activted or not</span>
<span class="term-fg32">+func CalcBaseFee(config *params.ChainConfig, parent *types.Header, time uint64) *big.Int {</span>
 	&#47;&#47; If the current block is the first EIP-1559 block, return the InitialBaseFee.
 	if !config.IsLondon(parent.Number) {
 		return new(big.Int).SetUint64(params.InitialBaseFee)
<span class="term-fg36">@@ -77,7 +80,7 @@</span> 		&#47;&#47; max(1, parentBaseFee * gasUsedDelta &#47; parentGasTarget &#47; baseFeeChangeDenominator)
 		num.SetUint64(parent.GasUsed - parentGasTarget)
 		num.Mul(num, parent.BaseFee)
 		num.Div(num, denom.SetUint64(parentGasTarget))
<span class="term-fg31">-		num.Div(num, denom.SetUint64(config.BaseFeeChangeDenominator()))</span>
<span class="term-fg32">+		num.Div(num, denom.SetUint64(config.BaseFeeChangeDenominator(time)))</span>
 		baseFeeDelta := math.BigMax(num, common.Big1)
&nbsp;
 		return num.Add(parent.BaseFee, baseFeeDelta)
<span class="term-fg36">@@ -87,7 +90,7 @@</span> 		&#47;&#47; max(0, parentBaseFee * gasUsedDelta &#47; parentGasTarget &#47; baseFeeChangeDenominator)
 		num.SetUint64(parentGasTarget - parent.GasUsed)
 		num.Mul(num, parent.BaseFee)
 		num.Div(num, denom.SetUint64(parentGasTarget))
<span class="term-fg31">-		num.Div(num, denom.SetUint64(config.BaseFeeChangeDenominator()))</span>
<span class="term-fg32">+		num.Div(num, denom.SetUint64(config.BaseFeeChangeDenominator(time)))</span>
 		baseFee := num.Sub(parent.BaseFee, num)
&nbsp;
 		return math.BigMax(baseFee, common.Big0)</div>
    </div>

            
            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-05bf9d781aa4c18f84cdcbb0"role="button" aria-expanded="false" aria-controls="id-05bf9d781aa4c18f84cdcbb0">
        
            <div class="col-12 col-md-12 col-lg-6 col-xl-6 text-start"><h4>Consensus tweaks</h4></div>
        

        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2">
            <div class="row line-stat">
                
                
            </div>
        </div>
        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2 ">
            <div class="row line-stat">
                
                    <div class="text-end"><span class="text-success">+28</span></div>
                    <div class="text-start"><span class="text-danger">-0</span></div>
                
                
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-05bf9d781aa4c18f84cdcbb0">
        <div><p>The Engine API is activated at the Merge transition, with a Total Terminal Difficulty (TTD).
The rollup starts post-merge, and thus sets the TTD to 0.
The TTD is always &ldquo;reached&rdquo; starting at the bedrock block.</p>
</div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-52ae58e5769c2f05b707bd76" role="button"
                       aria-expanded="false" aria-controls="id-52ae58e5769c2f05b707bd76">
                        <code>consensus/beacon/consensus.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/consensus/beacon/consensus.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/consensus/beacon/consensus.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+28</span></div>
                            <div class="text-start"><span class="text-danger">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-52ae58e5769c2f05b707bd76"><span class="term-fg1">diff --git go-ethereum&#47;consensus&#47;beacon&#47;consensus.go op-geth&#47;consensus&#47;beacon&#47;consensus.go</span>
<span class="term-fg1">index b8946e0c710988fb85f12a1604222c02630c1029..18f915807347764b83d4a15aabc3045cd2437c92 100644</span>
<span class="term-fg1">--- go-ethereum&#47;consensus&#47;beacon&#47;consensus.go</span>
<span class="term-fg1">+++ op-geth&#47;consensus&#47;beacon&#47;consensus.go</span>
<span class="term-fg36">@@ -60,6 +60,7 @@</span> &#47;&#47; The beacon here is a half-functional consensus engine with partial functions which
 &#47;&#47; is only used for necessary consensus checks. The legacy consensus engine can be any
 &#47;&#47; engine implements the consensus interface (except the beacon itself).
 type Beacon struct {
<span class="term-fg32">+	&#47;&#47; For migrated OP chains (OP mainnet, OP Goerli), ethone is a dummy legacy pre-Bedrock consensus</span>
 	ethone consensus.Engine &#47;&#47; Original consensus engine used in eth1, e.g. ethash or clique
 }
&nbsp;
<span class="term-fg36">@@ -107,12 +108,27 @@</span> 	}
 	return errs
 }
&nbsp;
<span class="term-fg32">+&#47;&#47; OP-Stack Bedrock variant of splitHeaders: the total-terminal difficulty is terminated at bedrock transition, but also reset to 0.</span>
<span class="term-fg32">+&#47;&#47; So just use the bedrock fork check to split the headers, to simplify the splitting.</span>
<span class="term-fg32">+&#47;&#47; The returned slices are slices over the input. The input must be sorted.</span>
<span class="term-fg32">+func (beacon *Beacon) splitBedrockHeaders(chain consensus.ChainHeaderReader, headers []*types.Header) ([]*types.Header, []*types.Header, error) {</span>
<span class="term-fg32">+	for i, h := range headers {</span>
<span class="term-fg32">+		if chain.Config().IsBedrock(h.Number) {</span>
<span class="term-fg32">+			return headers[:i], headers[i:], nil</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	return headers, nil, nil</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
 &#47;&#47; splitHeaders splits the provided header batch into two parts according to
 &#47;&#47; the configured ttd. It requires the parent of header batch along with its
 &#47;&#47; td are stored correctly in chain. If ttd is not configured yet, all headers
 &#47;&#47; will be treated legacy PoW headers.
 &#47;&#47; Note, this function will not verify the header validity but just split them.
 func (beacon *Beacon) splitHeaders(chain consensus.ChainHeaderReader, headers []*types.Header) ([]*types.Header, []*types.Header, error) {
<span class="term-fg32">+	if chain.Config().Optimism != nil {</span>
<span class="term-fg32">+		return beacon.splitBedrockHeaders(chain, headers)</span>
<span class="term-fg32">+	}</span>
 	&#47;&#47; TTD is not defined yet, all headers should be in legacy format.
 	ttd := chain.Config().TerminalTotalDifficulty
 	if ttd == nil {
<span class="term-fg36">@@ -448,6 +464,10 @@</span> func (beacon *Beacon) InnerEngine() consensus.Engine {
 	return beacon.ethone
 }
&nbsp;
<span class="term-fg32">+func (beacon *Beacon) SwapInner(inner consensus.Engine) {</span>
<span class="term-fg32">+	beacon.ethone = inner</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
 &#47;&#47; SetThreads updates the mining threads. Delegate the call
 &#47;&#47; to the eth1 engine if it&#39;s threaded.
 func (beacon *Beacon) SetThreads(threads int) {
<span class="term-fg36">@@ -463,8 +483,16 @@</span> &#47;&#47; IsTTDReached checks if the TotalTerminalDifficulty has been surpassed on the `parentHash` block.
 &#47;&#47; It depends on the parentHash already being stored in the database.
 &#47;&#47; If the parentHash is not stored in the database a UnknownAncestor error is returned.
 func IsTTDReached(chain consensus.ChainHeaderReader, parentHash common.Hash, parentNumber uint64) (bool, error) {
<span class="term-fg32">+	if cfg := chain.Config(); cfg.Optimism != nil {</span>
<span class="term-fg32">+		&#47;&#47; If OP-Stack then bedrock activation number determines when TTD (eth Merge) has been reached.</span>
<span class="term-fg32">+		&#47;&#47; Note: some tests&#47;utils will set parentNumber == max_uint64 as &quot;parent&quot; of the genesis block, this is fine.</span>
<span class="term-fg32">+		return cfg.IsBedrock(new(big.Int).SetUint64(parentNumber + 1)), nil</span>
<span class="term-fg32">+	}</span>
 	if chain.Config().TerminalTotalDifficulty == nil {
 		return false, nil
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if common.Big0.Cmp(chain.Config().TerminalTotalDifficulty) == 0 { &#47;&#47; in case TTD is reached at genesis.</span>
<span class="term-fg32">+		return true, nil</span>
 	}
 	td := chain.GetTd(parentHash, parentNumber)
 	if td == nil {</div>
    </div>

            
            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-3afb14126d9e17f9dac67a0b"role="button" aria-expanded="false" aria-controls="id-3afb14126d9e17f9dac67a0b">
        
            <div class="col-12 col-md-12 col-lg-6 col-xl-6 text-start"><h4>Legacy OP-mainnet / OP-goerli header-verification support</h4></div>
        

        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2">
            <div class="row line-stat">
                
                
            </div>
        </div>
        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2 ">
            <div class="row line-stat">
                
                    <div class="text-end"><span class="text-success">+91</span></div>
                    <div class="text-start"><span class="text-danger">-0</span></div>
                
                
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-3afb14126d9e17f9dac67a0b">
        <div><p>Pre-Bedrock OP-mainnet and OP-Goerli had differently formatted block-headers, loosely compatible with the geth types (since it was based on Clique).
However, due to differences like the extra-data length (97+ bytes), these legacy block-headers need special verification.
The pre-merge &ldquo;consensus&rdquo; fallback is set to this custom but basic verifier, to accept these headers when syncing a pre-bedrock part of the chain,
independent of any clique code or configuration (which may be removed from geth at a later point).
All the custom verifier has to do is accept the headers, as the headers are already verified by block-hash through the reverse-header-sync.</p>
</div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-3541d343e7996b5e18113b57" role="button"
                       aria-expanded="false" aria-controls="id-3541d343e7996b5e18113b57">
                        <code>consensus/beacon/oplegacy.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/consensus/beacon/oplegacy.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+91</span></div>
                            <div class="text-start"><span class="text-danger">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-3541d343e7996b5e18113b57"><span class="term-fg1">diff --git go-ethereum&#47;consensus&#47;beacon&#47;oplegacy.go op-geth&#47;consensus&#47;beacon&#47;oplegacy.go</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..8e94cfa60087a70abf8bc7a65b01043d6d0ac99e</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ op-geth&#47;consensus&#47;beacon&#47;oplegacy.go</span>
<span class="term-fg36">@@ -0,0 +1,91 @@</span>
<span class="term-fg32">+package beacon</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+import (</span>
<span class="term-fg32">+	&quot;fmt&quot;</span>
<span class="term-fg32">+	&quot;math&#47;big&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;consensus&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&#47;state&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&#47;types&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;rpc&quot;</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+type OpLegacy struct{}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (o *OpLegacy) Author(header *types.Header) (common.Address, error) {</span>
<span class="term-fg32">+	return header.Coinbase, nil</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (o *OpLegacy) VerifyHeader(chain consensus.ChainHeaderReader, header *types.Header) error {</span>
<span class="term-fg32">+	&#47;&#47; Short circuit if the header is known, or its parent not</span>
<span class="term-fg32">+	number := header.Number.Uint64()</span>
<span class="term-fg32">+	if chain.GetHeader(header.Hash(), number) != nil {</span>
<span class="term-fg32">+		return nil</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	parent := chain.GetHeader(header.ParentHash, number-1)</span>
<span class="term-fg32">+	if parent == nil {</span>
<span class="term-fg32">+		return consensus.ErrUnknownAncestor</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	&#47;&#47; legacy chain is verified by block-hash reverse sync otherwise</span>
<span class="term-fg32">+	return nil</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (o *OpLegacy) VerifyHeaders(chain consensus.ChainHeaderReader, headers []*types.Header) (chan&lt;- struct{}, &lt;-chan error) {</span>
<span class="term-fg32">+	abort := make(chan struct{})</span>
<span class="term-fg32">+	results := make(chan error, len(headers))</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	for i := range headers {</span>
<span class="term-fg32">+		&#47;&#47; legacy chain is verified by block-hash reverse sync</span>
<span class="term-fg32">+		var parent *types.Header</span>
<span class="term-fg32">+		if i == 0 {</span>
<span class="term-fg32">+			parent = chain.GetHeader(headers[0].ParentHash, headers[0].Number.Uint64()-1)</span>
<span class="term-fg32">+		} else if headers[i-1].Hash() == headers[i].ParentHash {</span>
<span class="term-fg32">+			parent = headers[i-1]</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		var err error</span>
<span class="term-fg32">+		if parent == nil {</span>
<span class="term-fg32">+			err = consensus.ErrUnknownAncestor</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		results &lt;- err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	return abort, results</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (o *OpLegacy) VerifyUncles(chain consensus.ChainReader, block *types.Block) error {</span>
<span class="term-fg32">+	return nil</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (o *OpLegacy) Prepare(chain consensus.ChainHeaderReader, header *types.Header) error {</span>
<span class="term-fg32">+	return fmt.Errorf(&quot;cannot prepare for legacy block header: %s (num %d)&quot;, header.Hash(), header.Number)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (o *OpLegacy) Finalize(chain consensus.ChainHeaderReader, header *types.Header, state *state.StateDB, body *types.Body) {</span>
<span class="term-fg32">+	panic(fmt.Errorf(&quot;cannot finalize legacy block header: %s (num %d)&quot;, header.Hash(), header.Number))</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (o *OpLegacy) FinalizeAndAssemble(chain consensus.ChainHeaderReader, header *types.Header, state *state.StateDB, body *types.Body, receipts []*types.Receipt) (*types.Block, error) {</span>
<span class="term-fg32">+	return nil, fmt.Errorf(&quot;cannot finalize and assemble for legacy block header: %s (num %d)&quot;, header.Hash(), header.Number)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (o *OpLegacy) Seal(chain consensus.ChainHeaderReader, block *types.Block, results chan&lt;- *types.Block, stop &lt;-chan struct{}) error {</span>
<span class="term-fg32">+	return fmt.Errorf(&quot;cannot seal legacy block header: %s (num %d)&quot;, block.Hash(), block.Number())</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (o *OpLegacy) SealHash(header *types.Header) common.Hash {</span>
<span class="term-fg32">+	panic(fmt.Errorf(&quot;cannot compute pow&#47;poa seal-hash for legacy block header: %s (num %d)&quot;, header.Hash(), header.Number))</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (o *OpLegacy) CalcDifficulty(chain consensus.ChainHeaderReader, time uint64, parent *types.Header) *big.Int {</span>
<span class="term-fg32">+	return big.NewInt(0)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (o *OpLegacy) APIs(chain consensus.ChainHeaderReader) []rpc.API {</span>
<span class="term-fg32">+	return nil</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (o *OpLegacy) Close() error {</span>
<span class="term-fg32">+	return nil</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+var _ consensus.Engine = (*OpLegacy)(nil)</span></div>
    </div>

            
            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
        </div>
    </div>
</div>

            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-7b9ad7e7f7890365b50470ca"role="button" aria-expanded="false" aria-controls="id-7b9ad7e7f7890365b50470ca">
        
            <div class="col-12 col-md-12 col-lg-6 col-xl-6 text-start"><h3>Engine API modifications</h3></div>
        

        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2">
            <div class="row line-stat">
                
                
            </div>
        </div>
        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2 ">
            <div class="row line-stat">
                
                    <div class="text-end"><span class="text-success">+65</span></div>
                    <div class="text-start"><span class="text-danger">-2</span></div>
                
                
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-7b9ad7e7f7890365b50470ca">
        <div><p>The Engine API is extended to insert transactions into the block and optionally exclude the tx-pool,
to reproduce the exact block of the sequencer from just the inputs, as derived from L1 by the rollup-node.
See <a href="https://github.com/ethereum-optimism/optimism/blob/develop/specs/exec-engine.md">L2 execution engine specs</a>.</p>
</div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-b6d30c276fb53d7f1b216f14" role="button"
                       aria-expanded="false" aria-controls="id-b6d30c276fb53d7f1b216f14">
                        <code>beacon/engine/gen_blockparams.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/beacon/engine/gen_blockparams.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/beacon/engine/gen_blockparams.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+26</span></div>
                            <div class="text-start"><span class="text-danger">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-b6d30c276fb53d7f1b216f14"><span class="term-fg1">diff --git go-ethereum&#47;beacon&#47;engine&#47;gen_blockparams.go op-geth&#47;beacon&#47;engine&#47;gen_blockparams.go</span>
<span class="term-fg1">index b1f01b50ff8e3b1adf0454ff989356a6f612a337..c343e5890668558738a5f31b287a89a427888f66 100644</span>
<span class="term-fg1">--- go-ethereum&#47;beacon&#47;engine&#47;gen_blockparams.go</span>
<span class="term-fg1">+++ op-geth&#47;beacon&#47;engine&#47;gen_blockparams.go</span>
<span class="term-fg36">@@ -21,6 +21,9 @@</span> 		Random                common.Hash         `json:&quot;prevRandao&quot;            gencodec:&quot;required&quot;`
 		SuggestedFeeRecipient common.Address      `json:&quot;suggestedFeeRecipient&quot; gencodec:&quot;required&quot;`
 		Withdrawals           []*types.Withdrawal `json:&quot;withdrawals&quot;`
 		BeaconRoot            *common.Hash        `json:&quot;parentBeaconBlockRoot&quot;`
<span class="term-fg32">+		Transactions          []hexutil.Bytes     `json:&quot;transactions,omitempty&quot;  gencodec:&quot;optional&quot;`</span>
<span class="term-fg32">+		NoTxPool              bool                `json:&quot;noTxPool,omitempty&quot; gencodec:&quot;optional&quot;`</span>
<span class="term-fg32">+		GasLimit              *hexutil.Uint64     `json:&quot;gasLimit,omitempty&quot; gencodec:&quot;optional&quot;`</span>
 	}
 	var enc PayloadAttributes
 	enc.Timestamp = hexutil.Uint64(p.Timestamp)
<span class="term-fg36">@@ -28,6 +31,14 @@</span> 	enc.Random = p.Random
 	enc.SuggestedFeeRecipient = p.SuggestedFeeRecipient
 	enc.Withdrawals = p.Withdrawals
 	enc.BeaconRoot = p.BeaconRoot
<span class="term-fg32">+	if p.Transactions != nil {</span>
<span class="term-fg32">+		enc.Transactions = make([]hexutil.Bytes, len(p.Transactions))</span>
<span class="term-fg32">+		for k, v := range p.Transactions {</span>
<span class="term-fg32">+			enc.Transactions[k] = v</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	enc.NoTxPool = p.NoTxPool</span>
<span class="term-fg32">+	enc.GasLimit = (*hexutil.Uint64)(p.GasLimit)</span>
 	return json.Marshal(&amp;enc)
 }
&nbsp;
<span class="term-fg36">@@ -39,6 +50,9 @@</span> 		Random                *common.Hash        `json:&quot;prevRandao&quot;            gencodec:&quot;required&quot;`
 		SuggestedFeeRecipient *common.Address     `json:&quot;suggestedFeeRecipient&quot; gencodec:&quot;required&quot;`
 		Withdrawals           []*types.Withdrawal `json:&quot;withdrawals&quot;`
 		BeaconRoot            *common.Hash        `json:&quot;parentBeaconBlockRoot&quot;`
<span class="term-fg32">+		Transactions          []hexutil.Bytes     `json:&quot;transactions,omitempty&quot;  gencodec:&quot;optional&quot;`</span>
<span class="term-fg32">+		NoTxPool              *bool               `json:&quot;noTxPool,omitempty&quot; gencodec:&quot;optional&quot;`</span>
<span class="term-fg32">+		GasLimit              *hexutil.Uint64     `json:&quot;gasLimit,omitempty&quot; gencodec:&quot;optional&quot;`</span>
 	}
 	var dec PayloadAttributes
 	if err := json.Unmarshal(input, &amp;dec); err != nil {
<span class="term-fg36">@@ -61,6 +75,18 @@</span> 		p.Withdrawals = dec.Withdrawals
 	}
 	if dec.BeaconRoot != nil {
 		p.BeaconRoot = dec.BeaconRoot
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if dec.Transactions != nil {</span>
<span class="term-fg32">+		p.Transactions = make([][]byte, len(dec.Transactions))</span>
<span class="term-fg32">+		for k, v := range dec.Transactions {</span>
<span class="term-fg32">+			p.Transactions[k] = v</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if dec.NoTxPool != nil {</span>
<span class="term-fg32">+		p.NoTxPool = *dec.NoTxPool</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if dec.GasLimit != nil {</span>
<span class="term-fg32">+		p.GasLimit = (*uint64)(dec.GasLimit)</span>
 	}
 	return nil
 }</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-f41232654388d119c15bfed8" role="button"
                       aria-expanded="false" aria-controls="id-f41232654388d119c15bfed8">
                        <code>beacon/engine/types.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/beacon/engine/types.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/beacon/engine/types.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+21</span></div>
                            <div class="text-start"><span class="text-danger">-1</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-f41232654388d119c15bfed8"><span class="term-fg1">diff --git go-ethereum&#47;beacon&#47;engine&#47;types.go op-geth&#47;beacon&#47;engine&#47;types.go</span>
<span class="term-fg1">index 1dfcf5b71a0e24073d178b4b0779766b880d260a..1145abbe35179c76526bdf8d0388c18b301a5625 100644</span>
<span class="term-fg1">--- go-ethereum&#47;beacon&#47;engine&#47;types.go</span>
<span class="term-fg1">+++ op-geth&#47;beacon&#47;engine&#47;types.go</span>
<span class="term-fg36">@@ -47,11 +47,22 @@</span> 	Random                common.Hash         `json:&quot;prevRandao&quot;            gencodec:&quot;required&quot;`
 	SuggestedFeeRecipient common.Address      `json:&quot;suggestedFeeRecipient&quot; gencodec:&quot;required&quot;`
 	Withdrawals           []*types.Withdrawal `json:&quot;withdrawals&quot;`
 	BeaconRoot            *common.Hash        `json:&quot;parentBeaconBlockRoot&quot;`
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Transactions is a field for rollups: the transactions list is forced into the block</span>
<span class="term-fg32">+	Transactions [][]byte `json:&quot;transactions,omitempty&quot;  gencodec:&quot;optional&quot;`</span>
<span class="term-fg32">+	&#47;&#47; NoTxPool is a field for rollups: if true, the no transactions are taken out of the tx-pool,</span>
<span class="term-fg32">+	&#47;&#47; only transactions from the above Transactions list will be included.</span>
<span class="term-fg32">+	NoTxPool bool `json:&quot;noTxPool,omitempty&quot; gencodec:&quot;optional&quot;`</span>
<span class="term-fg32">+	&#47;&#47; GasLimit is a field for rollups: if set, this sets the exact gas limit the block produced with.</span>
<span class="term-fg32">+	GasLimit *uint64 `json:&quot;gasLimit,omitempty&quot; gencodec:&quot;optional&quot;`</span>
 }
&nbsp;
 &#47;&#47; JSON type overrides for PayloadAttributes.
 type payloadAttributesMarshaling struct {
 	Timestamp hexutil.Uint64
<span class="term-fg32">+</span>
<span class="term-fg32">+	Transactions []hexutil.Bytes</span>
<span class="term-fg32">+	GasLimit     *hexutil.Uint64</span>
 }
&nbsp;
 &#47;&#47;go:generate go run github.com&#47;fjl&#47;gencodec -type ExecutableData -field-override executableDataMarshaling -out gen_ed.go
<span class="term-fg36">@@ -98,6 +109,9 @@</span> 	ExecutionPayload *ExecutableData `json:&quot;executionPayload&quot;  gencodec:&quot;required&quot;`
 	BlockValue       *big.Int        `json:&quot;blockValue&quot;  gencodec:&quot;required&quot;`
 	BlobsBundle      *BlobsBundleV1  `json:&quot;blobsBundle&quot;`
 	Override         bool            `json:&quot;shouldOverrideBuilder&quot;`
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; OP-Stack: Ecotone specific fields</span>
<span class="term-fg32">+	ParentBeaconBlockRoot *common.Hash `json:&quot;parentBeaconBlockRoot,omitempty&quot;`</span>
 }
&nbsp;
 type BlobsBundleV1 struct {
<span class="term-fg36">@@ -291,7 +305,13 @@</span> 			bundle.Commitments = append(bundle.Commitments, hexutil.Bytes(sidecar.Commitments[j][:]))
 			bundle.Proofs = append(bundle.Proofs, hexutil.Bytes(sidecar.Proofs[j][:]))
 		}
 	}
<span class="term-fg31">-	return &amp;ExecutionPayloadEnvelope{ExecutionPayload: data, BlockValue: fees, BlobsBundle: &amp;bundle, Override: false}</span>
<span class="term-fg32">+	return &amp;ExecutionPayloadEnvelope{</span>
<span class="term-fg32">+		ExecutionPayload:      data,</span>
<span class="term-fg32">+		BlockValue:            fees,</span>
<span class="term-fg32">+		BlobsBundle:           &amp;bundle,</span>
<span class="term-fg32">+		Override:              false,</span>
<span class="term-fg32">+		ParentBeaconBlockRoot: block.BeaconRoot(),</span>
<span class="term-fg32">+	}</span>
 }
&nbsp;
 &#47;&#47; ExecutionPayloadBodyV1 is used in the response to GetPayloadBodiesByHashV1 and GetPayloadBodiesByRangeV1</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-d367d971b14a4ff94cad38bb" role="button"
                       aria-expanded="false" aria-controls="id-d367d971b14a4ff94cad38bb">
                        <code>eth/catalyst/api.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/eth/catalyst/api.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/eth/catalyst/api.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+18</span></div>
                            <div class="text-start"><span class="text-danger">-1</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-d367d971b14a4ff94cad38bb"><span class="term-fg1">diff --git go-ethereum&#47;eth&#47;catalyst&#47;api.go op-geth&#47;eth&#47;catalyst&#47;api.go</span>
<span class="term-fg1">index 00cce259c861e8c248effe292c25ef7a12f8fc43..11466b5057e9287ac26475cde4f0115121318695 100644</span>
<span class="term-fg1">--- go-ethereum&#47;eth&#47;catalyst&#47;api.go</span>
<span class="term-fg1">+++ op-geth&#47;eth&#47;catalyst&#47;api.go</span>
<span class="term-fg36">@@ -318,7 +318,7 @@</span> 	} else if api.eth.BlockChain().CurrentBlock().Hash() == update.HeadBlockHash {
 		&#47;&#47; If the specified head matches with our local head, do nothing and keep
 		&#47;&#47; generating the payload. It&#39;s a special corner case that a few slots are
 		&#47;&#47; missing and we are requested to generate the payload in slot.
<span class="term-fg31">-	} else {</span>
<span class="term-fg32">+	} else if api.eth.BlockChain().Config().Optimism == nil { &#47;&#47; minor Engine API divergence: allow proposers to reorg their own chain</span>
 		&#47;&#47; If the head block is already in our canonical chain, the beacon client is
 		&#47;&#47; probably resyncing. Ignore the update.
 		log.Info(&quot;Ignoring beacon update to old head&quot;, &quot;number&quot;, block.NumberU64(), &quot;hash&quot;, update.HeadBlockHash, &quot;age&quot;, common.PrettyAge(time.Unix(int64(block.Time()), 0)), &quot;have&quot;, api.eth.BlockChain().CurrentBlock().Number)
<span class="term-fg36">@@ -359,6 +359,17 @@</span> 	&#47;&#47; If payload generation was requested, create a new block to be potentially
 	&#47;&#47; sealed by the beacon client. The payload will be requested later, and we
 	&#47;&#47; will replace it arbitrarily many times in between.
 	if payloadAttributes != nil {
<span class="term-fg32">+		if api.eth.BlockChain().Config().Optimism != nil &amp;&amp; payloadAttributes.GasLimit == nil {</span>
<span class="term-fg32">+			return engine.STATUS_INVALID, engine.InvalidPayloadAttributes.With(errors.New(&quot;gasLimit parameter is required&quot;))</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		transactions := make(types.Transactions, 0, len(payloadAttributes.Transactions))</span>
<span class="term-fg32">+		for i, otx := range payloadAttributes.Transactions {</span>
<span class="term-fg32">+			var tx types.Transaction</span>
<span class="term-fg32">+			if err := tx.UnmarshalBinary(otx); err != nil {</span>
<span class="term-fg32">+				return engine.STATUS_INVALID, fmt.Errorf(&quot;transaction %d is not valid: %v&quot;, i, err)</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+			transactions = append(transactions, &amp;tx)</span>
<span class="term-fg32">+		}</span>
 		args := &amp;miner.BuildPayloadArgs{
 			Parent:       update.HeadBlockHash,
 			Timestamp:    payloadAttributes.Timestamp,
<span class="term-fg36">@@ -366,6 +377,9 @@</span> 			FeeRecipient: payloadAttributes.SuggestedFeeRecipient,
 			Random:       payloadAttributes.Random,
 			Withdrawals:  payloadAttributes.Withdrawals,
 			BeaconRoot:   payloadAttributes.BeaconRoot,
<span class="term-fg32">+			NoTxPool:     payloadAttributes.NoTxPool,</span>
<span class="term-fg32">+			Transactions: transactions,</span>
<span class="term-fg32">+			GasLimit:     payloadAttributes.GasLimit,</span>
 			Version:      payloadVersion,
 		}
 		id := args.Id()
<span class="term-fg36">@@ -766,6 +780,9 @@</span> &#47;&#47; user that something might be off with their consensus node.
 &#47;&#47;
 &#47;&#47; TODO(karalabe): Spin this goroutine down somehow
 func (api *ConsensusAPI) heartbeat() {
<span class="term-fg32">+	if api.eth.BlockChain().Config().Optimism != nil { &#47;&#47; don&#39;t start the api heartbeat, there is no transition</span>
<span class="term-fg32">+		return</span>
<span class="term-fg32">+	}</span>
 	&#47;&#47; Sleep a bit on startup since there&#39;s obviously no beacon client yet
 	&#47;&#47; attached, so no need to print scary warnings to the user.
 	time.Sleep(beaconUpdateStartupTimeout)</div>
    </div>

            
            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-af21693db1b372400392967f"role="button" aria-expanded="false" aria-controls="id-af21693db1b372400392967f">
        
            <div class="col-12 col-md-12 col-lg-6 col-xl-6 text-start"><h3>Block-building modifications</h3></div>
        

        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2">
            <div class="row line-stat">
                
                
            </div>
        </div>
        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2 ">
            <div class="row line-stat">
                
                    <div class="text-end"><span class="text-success">+370</span></div>
                    <div class="text-start"><span class="text-danger">-65</span></div>
                
                
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-af21693db1b372400392967f">
        <div><p>The block-building code (in the &ldquo;miner&rdquo; package because of Proof-Of-Work legacy of ethereum) implements the
changes to support the transaction-inclusion, tx-pool toggle and gaslimit parameters of the Engine API.</p>
</div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-8e489a0c0b1a7b455216e8c0" role="button"
                       aria-expanded="false" aria-controls="id-8e489a0c0b1a7b455216e8c0">
                        <code>miner/miner.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/miner/miner.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/miner/miner.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+26</span></div>
                            <div class="text-start"><span class="text-danger">-1</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-8e489a0c0b1a7b455216e8c0"><span class="term-fg1">diff --git go-ethereum&#47;miner&#47;miner.go op-geth&#47;miner&#47;miner.go</span>
<span class="term-fg1">index ff81d0e8f5c8ee60b66a59a6aaf2833fbeed88a2..8368b96e151ed1f1c669922fa798388b43c988d4 100644</span>
<span class="term-fg1">--- go-ethereum&#47;miner&#47;miner.go</span>
<span class="term-fg1">+++ op-geth&#47;miner&#47;miner.go</span>
<span class="term-fg36">@@ -18,6 +18,7 @@</span> &#47;&#47; Package miner implements Ethereum block creation and mining.
 package miner
&nbsp;
 import (
<span class="term-fg32">+	&quot;context&quot;</span>
 	&quot;fmt&quot;
 	&quot;math&#47;big&quot;
 	&quot;sync&quot;
<span class="term-fg36">@@ -30,6 +31,7 @@</span> 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&#47;state&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&#47;txpool&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&#47;types&quot;
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;eth&#47;tracers&quot;</span>
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;params&quot;
 )
&nbsp;
<span class="term-fg36">@@ -40,6 +42,10 @@</span> 	BlockChain() *core.BlockChain
 	TxPool() *txpool.TxPool
 }
&nbsp;
<span class="term-fg32">+type BackendWithHistoricalState interface {</span>
<span class="term-fg32">+	StateAtBlock(ctx context.Context, block *types.Block, reexec uint64, base *state.StateDB, readOnly bool, preferDisk bool) (*state.StateDB, tracers.StateReleaseFunc, error)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
 &#47;&#47; Config is the configuration parameters of mining.
 type Config struct {
 	Etherbase           common.Address `toml:&quot;-&quot;`          &#47;&#47; Deprecated
<span class="term-fg36">@@ -48,12 +54,15 @@</span> 	ExtraData           hexutil.Bytes  `toml:&quot;,omitempty&quot;` &#47;&#47; Block extra data set by the miner
 	GasCeil             uint64         &#47;&#47; Target gas ceiling for mined blocks.
 	GasPrice            *big.Int       &#47;&#47; Minimum gas price for mining a transaction
 	Recommit            time.Duration  &#47;&#47; The time interval for miner to re-create mining work.
<span class="term-fg32">+</span>
<span class="term-fg32">+	RollupComputePendingBlock bool   &#47;&#47; Compute the pending block from tx-pool, instead of copying the latest-block</span>
<span class="term-fg32">+	EffectiveGasCeil          uint64 &#47;&#47; if non-zero, a gas ceiling to apply independent of the header&#39;s gaslimit value</span>
 }
&nbsp;
 &#47;&#47; DefaultConfig contains default settings for miner.
 var DefaultConfig = Config{
 	GasCeil:  30_000_000,
<span class="term-fg31">-	GasPrice: big.NewInt(params.GWei &#47; 1000),</span>
<span class="term-fg32">+	GasPrice: big.NewInt(params.Wei),</span>
&nbsp;
 	&#47;&#47; The default recommit time is chosen as two seconds since
 	&#47;&#47; consensus-layer usually will wait a half slot of time(6s)
<span class="term-fg36">@@ -73,11 +82,14 @@</span> 	txpool      *txpool.TxPool
 	chain       *core.BlockChain
 	pending     *pending
 	pendingMu   sync.Mutex &#47;&#47; Lock protects the pending block
<span class="term-fg32">+</span>
<span class="term-fg32">+	backend Backend</span>
 }
&nbsp;
 &#47;&#47; New creates a new miner with provided config.
 func New(eth Backend, config Config, engine consensus.Engine) *Miner {
 	return &amp;Miner{
<span class="term-fg32">+		backend:     eth,</span>
 		config:      &amp;config,
 		chainConfig: eth.BlockChain().Config(),
 		engine:      engine,
<span class="term-fg36">@@ -91,6 +103,19 @@</span> &#47;&#47; Pending returns the currently pending block and associated receipts, logs
 &#47;&#47; and statedb. The returned values can be nil in case the pending block is
 &#47;&#47; not initialized.
 func (miner *Miner) Pending() (*types.Block, types.Receipts, *state.StateDB) {
<span class="term-fg32">+	if miner.chainConfig.Optimism != nil &amp;&amp; !miner.config.RollupComputePendingBlock {</span>
<span class="term-fg32">+		&#47;&#47; For compatibility when not computing a pending block, we serve the latest block as &quot;pending&quot;</span>
<span class="term-fg32">+		headHeader := miner.chain.CurrentHeader()</span>
<span class="term-fg32">+		headBlock := miner.chain.GetBlock(headHeader.Hash(), headHeader.Number.Uint64())</span>
<span class="term-fg32">+		headReceipts := miner.chain.GetReceiptsByHash(headHeader.Hash())</span>
<span class="term-fg32">+		stateDB, err := miner.chain.StateAt(headHeader.Root)</span>
<span class="term-fg32">+		if err != nil {</span>
<span class="term-fg32">+			return nil, nil, nil</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		return headBlock, headReceipts, stateDB.Copy()</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
 	pending := miner.getPending()
 	if pending == nil {
 		return nil, nil, nil</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-670309177c9d542189994f0a" role="button"
                       aria-expanded="false" aria-controls="id-670309177c9d542189994f0a">
                        <code>miner/payload_building.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/miner/payload_building.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/miner/payload_building.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+182</span></div>
                            <div class="text-start"><span class="text-danger">-52</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-670309177c9d542189994f0a"><span class="term-fg1">diff --git go-ethereum&#47;miner&#47;payload_building.go op-geth&#47;miner&#47;payload_building.go</span>
<span class="term-fg1">index d027cd1e1f3a82feb3af39de84451d991dd8071f..1577acc6ae9316b7ea72244ae7fd04cbc6ac34e1 100644</span>
<span class="term-fg1">--- go-ethereum&#47;miner&#47;payload_building.go</span>
<span class="term-fg1">+++ op-geth&#47;miner&#47;payload_building.go</span>
<span class="term-fg36">@@ -19,8 +19,10 @@</span>
 import (
 	&quot;crypto&#47;sha256&quot;
 	&quot;encoding&#47;binary&quot;
<span class="term-fg32">+	&quot;errors&quot;</span>
 	&quot;math&#47;big&quot;
 	&quot;sync&quot;
<span class="term-fg32">+	&quot;sync&#47;atomic&quot;</span>
 	&quot;time&quot;
&nbsp;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;beacon&#47;engine&quot;
<span class="term-fg36">@@ -42,6 +44,10 @@</span> 	Random       common.Hash           &#47;&#47; The provided randomness value
 	Withdrawals  types.Withdrawals     &#47;&#47; The provided withdrawals
 	BeaconRoot   *common.Hash          &#47;&#47; The provided beaconRoot (Cancun)
 	Version      engine.PayloadVersion &#47;&#47; Versioning byte for payload id calculation.
<span class="term-fg32">+</span>
<span class="term-fg32">+	NoTxPool     bool                 &#47;&#47; Optimism addition: option to disable tx pool contents from being included</span>
<span class="term-fg32">+	Transactions []*types.Transaction &#47;&#47; Optimism addition: txs forced into the block via engine API</span>
<span class="term-fg32">+	GasLimit     *uint64              &#47;&#47; Optimism addition: override gas limit of the block to build</span>
 }
&nbsp;
 &#47;&#47; Id computes an 8-byte identifier by hashing the components of the payload arguments.
<span class="term-fg36">@@ -55,6 +61,19 @@</span> 	rlp.Encode(hasher, args.Withdrawals)
 	if args.BeaconRoot != nil {
 		hasher.Write(args.BeaconRoot[:])
 	}
<span class="term-fg32">+</span>
<span class="term-fg32">+	if args.NoTxPool || len(args.Transactions) &gt; 0 { &#47;&#47; extend if extra payload attributes are used</span>
<span class="term-fg32">+		binary.Write(hasher, binary.BigEndian, args.NoTxPool)</span>
<span class="term-fg32">+		binary.Write(hasher, binary.BigEndian, uint64(len(args.Transactions)))</span>
<span class="term-fg32">+		for _, tx := range args.Transactions {</span>
<span class="term-fg32">+			h := tx.Hash()</span>
<span class="term-fg32">+			hasher.Write(h[:])</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if args.GasLimit != nil {</span>
<span class="term-fg32">+		binary.Write(hasher, binary.BigEndian, *args.GasLimit)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
 	var out engine.PayloadID
 	copy(out[:], hasher.Sum(nil)[:8])
 	out[0] = byte(args.Version)
<span class="term-fg36">@@ -75,6 +94,10 @@</span> 	fullFees *big.Int
 	stop     chan struct{}
 	lock     sync.Mutex
 	cond     *sync.Cond
<span class="term-fg32">+</span>
<span class="term-fg32">+	err       error</span>
<span class="term-fg32">+	stopOnce  sync.Once</span>
<span class="term-fg32">+	interrupt *atomic.Int32 &#47;&#47; interrupt signal shared with worker</span>
 }
&nbsp;
 &#47;&#47; newPayload initializes the payload object.
<span class="term-fg36">@@ -83,11 +106,15 @@</span> 	payload := &amp;Payload{
 		id:    id,
 		empty: empty,
 		stop:  make(chan struct{}),
<span class="term-fg32">+</span>
<span class="term-fg32">+		interrupt: new(atomic.Int32),</span>
 	}
 	log.Info(&quot;Starting work on payload&quot;, &quot;id&quot;, payload.id)
 	payload.cond = sync.NewCond(&amp;payload.lock)
 	return payload
 }
<span class="term-fg32">+</span>
<span class="term-fg32">+var errInterruptedUpdate = errors.New(&quot;interrupted payload update&quot;)</span>
&nbsp;
 &#47;&#47; update updates the full-block with latest built version.
 func (payload *Payload) update(r *newPayloadResult, elapsed time.Duration) {
<span class="term-fg36">@@ -99,6 +126,19 @@</span> 	case &lt;-payload.stop:
 		return &#47;&#47; reject stale update
 	default:
 	}
<span class="term-fg32">+</span>
<span class="term-fg32">+	defer payload.cond.Broadcast() &#47;&#47; fire signal for notifying any full block result</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	if errors.Is(r.err, errInterruptedUpdate) {</span>
<span class="term-fg32">+		log.Debug(&quot;Ignoring interrupted payload update&quot;, &quot;id&quot;, payload.id)</span>
<span class="term-fg32">+		return</span>
<span class="term-fg32">+	} else if r.err != nil {</span>
<span class="term-fg32">+		log.Warn(&quot;Error building payload update&quot;, &quot;id&quot;, payload.id, &quot;err&quot;, r.err)</span>
<span class="term-fg32">+		payload.err = r.err &#47;&#47; record latest error</span>
<span class="term-fg32">+		return</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	log.Debug(&quot;New payload update&quot;, &quot;id&quot;, payload.id, &quot;elapsed&quot;, common.PrettyDuration(elapsed))</span>
<span class="term-fg32">+</span>
 	&#47;&#47; Ensure the newly provided full block has a higher transaction fee.
 	&#47;&#47; In post-merge stage, there is no uncle reward anymore and transaction
 	&#47;&#47; fee(apart from the mev revenue) is the only indicator for comparison.
<span class="term-fg36">@@ -120,24 +160,12 @@</span> 			&quot;root&quot;, r.block.Root(),
 			&quot;elapsed&quot;, common.PrettyDuration(elapsed),
 		)
 	}
<span class="term-fg31">-	payload.cond.Broadcast() &#47;&#47; fire signal for notifying full block</span>
 }
&nbsp;
 &#47;&#47; Resolve returns the latest built payload and also terminates the background
 &#47;&#47; thread for updating payload. It&#39;s safe to be called multiple times.
 func (payload *Payload) Resolve() *engine.ExecutionPayloadEnvelope {
<span class="term-fg31">-	payload.lock.Lock()</span>
<span class="term-fg31">-	defer payload.lock.Unlock()</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	select {</span>
<span class="term-fg31">-	case &lt;-payload.stop:</span>
<span class="term-fg31">-	default:</span>
<span class="term-fg31">-		close(payload.stop)</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-	if payload.full != nil {</span>
<span class="term-fg31">-		return engine.BlockToExecutableData(payload.full, payload.fullFees, payload.sidecars)</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-	return engine.BlockToExecutableData(payload.empty, big.NewInt(0), nil)</span>
<span class="term-fg32">+	return payload.resolve(false)</span>
 }
&nbsp;
 &#47;&#47; ResolveEmpty is basically identical to Resolve, but it expects empty block only.
<span class="term-fg36">@@ -152,10 +180,24 @@</span>
 &#47;&#47; ResolveFull is basically identical to Resolve, but it expects full block only.
 &#47;&#47; Don&#39;t call Resolve until ResolveFull returns, otherwise it might block forever.
 func (payload *Payload) ResolveFull() *engine.ExecutionPayloadEnvelope {
<span class="term-fg32">+	return payload.resolve(true)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (payload *Payload) WaitFull() {</span>
 	payload.lock.Lock()
 	defer payload.lock.Unlock()
<span class="term-fg32">+	payload.cond.Wait()</span>
<span class="term-fg32">+}</span>
&nbsp;
<span class="term-fg31">-	if payload.full == nil {</span>
<span class="term-fg32">+func (payload *Payload) resolve(onlyFull bool) *engine.ExecutionPayloadEnvelope {</span>
<span class="term-fg32">+	payload.lock.Lock()</span>
<span class="term-fg32">+	defer payload.lock.Unlock()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; We interrupt any active building block to prevent it from adding more transactions,</span>
<span class="term-fg32">+	&#47;&#47; and if it is an update, don&#39;t attempt to seal the block.</span>
<span class="term-fg32">+	payload.interruptBuilding()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	if payload.full == nil &amp;&amp; (onlyFull || payload.empty == nil) {</span>
 		select {
 		case &lt;-payload.stop:
 			return nil
<span class="term-fg36">@@ -166,21 +208,82 @@</span> 		&#47;&#47; forever if Resolve is called in the meantime which
 		&#47;&#47; terminates the background construction process.
 		payload.cond.Wait()
 	}
<span class="term-fg31">-	&#47;&#47; Terminate the background payload construction</span>
<span class="term-fg31">-	select {</span>
<span class="term-fg31">-	case &lt;-payload.stop:</span>
<span class="term-fg31">-	default:</span>
<span class="term-fg31">-		close(payload.stop)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Now we can signal the building routine to stop.</span>
<span class="term-fg32">+	payload.stopBuilding()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	if payload.full != nil {</span>
<span class="term-fg32">+		return engine.BlockToExecutableData(payload.full, payload.fullFees, payload.sidecars)</span>
<span class="term-fg32">+	} else if !onlyFull &amp;&amp; payload.empty != nil {</span>
<span class="term-fg32">+		return engine.BlockToExecutableData(payload.empty, big.NewInt(0), nil)</span>
<span class="term-fg32">+	} else if err := payload.err; err != nil {</span>
<span class="term-fg32">+		log.Error(&quot;Error building any payload&quot;, &quot;id&quot;, payload.id, &quot;err&quot;, err)</span>
 	}
<span class="term-fg31">-	return engine.BlockToExecutableData(payload.full, payload.fullFees, payload.sidecars)</span>
<span class="term-fg32">+	return nil</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; interruptBuilding sets an interrupt for a potentially ongoing</span>
<span class="term-fg32">+&#47;&#47; block building process.</span>
<span class="term-fg32">+&#47;&#47; This will prevent it from adding new transactions to the block, and if it is</span>
<span class="term-fg32">+&#47;&#47; building an update, the block will also not be sealed, as we would discard</span>
<span class="term-fg32">+&#47;&#47; the update anyways.</span>
<span class="term-fg32">+&#47;&#47; interruptBuilding is safe to be called concurrently.</span>
<span class="term-fg32">+func (payload *Payload) interruptBuilding() {</span>
<span class="term-fg32">+	&#47;&#47; Set the interrupt if not interrupted already.</span>
<span class="term-fg32">+	&#47;&#47; It&#39;s ok if it has either already been interrupted by payload resolution earlier,</span>
<span class="term-fg32">+	&#47;&#47; or by the timeout timer set to commitInterruptTimeout.</span>
<span class="term-fg32">+	if payload.interrupt.CompareAndSwap(commitInterruptNone, commitInterruptResolve) {</span>
<span class="term-fg32">+		log.Debug(&quot;Interrupted payload building.&quot;, &quot;id&quot;, payload.id)</span>
<span class="term-fg32">+	} else {</span>
<span class="term-fg32">+		log.Debug(&quot;Payload building already interrupted.&quot;,</span>
<span class="term-fg32">+			&quot;id&quot;, payload.id, &quot;interrupt&quot;, payload.interrupt.Load())</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; stopBuilding signals to the block updating routine to stop. An ongoing payload</span>
<span class="term-fg32">+&#47;&#47; building job will still complete. It can be interrupted to stop filling new</span>
<span class="term-fg32">+&#47;&#47; transactions with interruptBuilding.</span>
<span class="term-fg32">+&#47;&#47; stopBuilding is safe to be called concurrently.</span>
<span class="term-fg32">+func (payload *Payload) stopBuilding() {</span>
<span class="term-fg32">+	&#47;&#47; Concurrent Resolve calls should only stop once.</span>
<span class="term-fg32">+	payload.stopOnce.Do(func() {</span>
<span class="term-fg32">+		log.Debug(&quot;Stop payload building.&quot;, &quot;id&quot;, payload.id)</span>
<span class="term-fg32">+		close(payload.stop)</span>
<span class="term-fg32">+	})</span>
 }
&nbsp;
 &#47;&#47; buildPayload builds the payload according to the provided parameters.
 func (miner *Miner) buildPayload(args *BuildPayloadArgs) (*Payload, error) {
<span class="term-fg31">-	&#47;&#47; Build the initial version with no transaction included. It should be fast</span>
<span class="term-fg31">-	&#47;&#47; enough to run. The empty payload can at least make sure there is something</span>
<span class="term-fg31">-	&#47;&#47; to deliver for not missing slot.</span>
<span class="term-fg31">-	emptyParams := &amp;generateParams{</span>
<span class="term-fg32">+	if args.NoTxPool { &#47;&#47; don&#39;t start the background payload updating job if there is no tx pool to pull from</span>
<span class="term-fg32">+		&#47;&#47; Build the initial version with no transaction included. It should be fast</span>
<span class="term-fg32">+		&#47;&#47; enough to run. The empty payload can at least make sure there is something</span>
<span class="term-fg32">+		&#47;&#47; to deliver for not missing slot.</span>
<span class="term-fg32">+		&#47;&#47; In OP-Stack, the &quot;empty&quot; block is constructed from provided txs only, i.e. no tx-pool usage.</span>
<span class="term-fg32">+		emptyParams := &amp;generateParams{</span>
<span class="term-fg32">+			timestamp:   args.Timestamp,</span>
<span class="term-fg32">+			forceTime:   true,</span>
<span class="term-fg32">+			parentHash:  args.Parent,</span>
<span class="term-fg32">+			coinbase:    args.FeeRecipient,</span>
<span class="term-fg32">+			random:      args.Random,</span>
<span class="term-fg32">+			withdrawals: args.Withdrawals,</span>
<span class="term-fg32">+			beaconRoot:  args.BeaconRoot,</span>
<span class="term-fg32">+			noTxs:       true,</span>
<span class="term-fg32">+			txs:         args.Transactions,</span>
<span class="term-fg32">+			gasLimit:    args.GasLimit,</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		empty := miner.generateWork(emptyParams)</span>
<span class="term-fg32">+		if empty.err != nil {</span>
<span class="term-fg32">+			return nil, empty.err</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		payload := newPayload(empty.block, args.Id())</span>
<span class="term-fg32">+		&#47;&#47; make sure to make it appear as full, otherwise it will wait indefinitely for payload building to complete.</span>
<span class="term-fg32">+		payload.full = empty.block</span>
<span class="term-fg32">+		payload.fullFees = empty.fees</span>
<span class="term-fg32">+		payload.cond.Broadcast() &#47;&#47; unblocks Resolve</span>
<span class="term-fg32">+		return payload, nil</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	fullParams := &amp;generateParams{</span>
 		timestamp:   args.Timestamp,
 		forceTime:   true,
 		parentHash:  args.Parent,
<span class="term-fg36">@@ -188,15 +291,21 @@</span> 		coinbase:    args.FeeRecipient,
 		random:      args.Random,
 		withdrawals: args.Withdrawals,
 		beaconRoot:  args.BeaconRoot,
<span class="term-fg31">-		noTxs:       true,</span>
<span class="term-fg32">+		noTxs:       false,</span>
<span class="term-fg32">+		txs:         args.Transactions,</span>
<span class="term-fg32">+		gasLimit:    args.GasLimit,</span>
 	}
<span class="term-fg31">-	empty := miner.generateWork(emptyParams)</span>
<span class="term-fg31">-	if empty.err != nil {</span>
<span class="term-fg31">-		return nil, empty.err</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Since we skip building the empty block when using the tx pool, we need to explicitly</span>
<span class="term-fg32">+	&#47;&#47; validate the BuildPayloadArgs here.</span>
<span class="term-fg32">+	blockTime, err := miner.validateParams(fullParams)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return nil, err</span>
 	}
&nbsp;
<span class="term-fg31">-	&#47;&#47; Construct a payload object for return.</span>
<span class="term-fg31">-	payload := newPayload(empty.block, args.Id())</span>
<span class="term-fg32">+	payload := newPayload(nil, args.Id())</span>
<span class="term-fg32">+	&#47;&#47; set shared interrupt</span>
<span class="term-fg32">+	fullParams.interrupt = payload.interrupt</span>
&nbsp;
 	&#47;&#47; Spin up a routine for updating the payload in background. This strategy
 	&#47;&#47; can maximum the revenue for including transactions with highest fee.
<span class="term-fg36">@@ -206,38 +315,59 @@</span> 		&#47;&#47; for triggering process immediately.
 		timer := time.NewTimer(0)
 		defer timer.Stop()
&nbsp;
<span class="term-fg31">-		&#47;&#47; Setup the timer for terminating the process if SECONDS_PER_SLOT (12s in</span>
<span class="term-fg31">-		&#47;&#47; the Mainnet configuration) have passed since the point in time identified</span>
<span class="term-fg31">-		&#47;&#47; by the timestamp parameter.</span>
<span class="term-fg31">-		endTimer := time.NewTimer(time.Second * 12)</span>
<span class="term-fg32">+		start := time.Now()</span>
<span class="term-fg32">+		&#47;&#47; Setup the timer for terminating the payload building process as determined</span>
<span class="term-fg32">+		&#47;&#47; by validateParams.</span>
<span class="term-fg32">+		endTimer := time.NewTimer(blockTime)</span>
<span class="term-fg32">+		defer endTimer.Stop()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		timeout := time.Now().Add(blockTime)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		stopReason := &quot;delivery&quot;</span>
<span class="term-fg32">+		defer func() {</span>
<span class="term-fg32">+			log.Info(&quot;Stopping work on payload&quot;,</span>
<span class="term-fg32">+				&quot;id&quot;, payload.id,</span>
<span class="term-fg32">+				&quot;reason&quot;, stopReason,</span>
<span class="term-fg32">+				&quot;elapsed&quot;, common.PrettyDuration(time.Since(start)))</span>
<span class="term-fg32">+		}()</span>
&nbsp;
<span class="term-fg31">-		fullParams := &amp;generateParams{</span>
<span class="term-fg31">-			timestamp:   args.Timestamp,</span>
<span class="term-fg31">-			forceTime:   true,</span>
<span class="term-fg31">-			parentHash:  args.Parent,</span>
<span class="term-fg31">-			coinbase:    args.FeeRecipient,</span>
<span class="term-fg31">-			random:      args.Random,</span>
<span class="term-fg31">-			withdrawals: args.Withdrawals,</span>
<span class="term-fg31">-			beaconRoot:  args.BeaconRoot,</span>
<span class="term-fg31">-			noTxs:       false,</span>
<span class="term-fg32">+		updatePayload := func() time.Duration {</span>
<span class="term-fg32">+			start := time.Now()</span>
<span class="term-fg32">+			&#47;&#47; getSealingBlock is interrupted by shared interrupt</span>
<span class="term-fg32">+			r := miner.generateWork(fullParams)</span>
<span class="term-fg32">+			dur := time.Since(start)</span>
<span class="term-fg32">+			&#47;&#47; update handles error case</span>
<span class="term-fg32">+			payload.update(r, dur)</span>
<span class="term-fg32">+			if r.err == nil {</span>
<span class="term-fg32">+				&#47;&#47; after first successful pass, we&#39;re updating</span>
<span class="term-fg32">+				fullParams.isUpdate = true</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+			timer.Reset(miner.config.Recommit)</span>
<span class="term-fg32">+			return dur</span>
 		}
&nbsp;
<span class="term-fg32">+		var lastDuration time.Duration</span>
 		for {
 			select {
 			case &lt;-timer.C:
<span class="term-fg31">-				start := time.Now()</span>
<span class="term-fg31">-				r := miner.generateWork(fullParams)</span>
<span class="term-fg31">-				if r.err == nil {</span>
<span class="term-fg31">-					payload.update(r, time.Since(start))</span>
<span class="term-fg31">-				} else {</span>
<span class="term-fg31">-					log.Info(&quot;Error while generating work&quot;, &quot;id&quot;, payload.id, &quot;err&quot;, r.err)</span>
<span class="term-fg32">+				&#47;&#47; We have to prioritize the stop signal because the recommit timer</span>
<span class="term-fg32">+				&#47;&#47; might have fired while stop also got closed.</span>
<span class="term-fg32">+				select {</span>
<span class="term-fg32">+				case &lt;-payload.stop:</span>
<span class="term-fg32">+					return</span>
<span class="term-fg32">+				default:</span>
<span class="term-fg32">+				}</span>
<span class="term-fg32">+				&#47;&#47; Assuming last payload building duration as lower bound for next one,</span>
<span class="term-fg32">+				&#47;&#47; skip new update if we&#39;re too close to the timeout anyways.</span>
<span class="term-fg32">+				if lastDuration &gt; 0 &amp;&amp; time.Now().Add(lastDuration).After(timeout) {</span>
<span class="term-fg32">+					stopReason = &quot;near-timeout&quot;</span>
<span class="term-fg32">+					return</span>
 				}
<span class="term-fg31">-				timer.Reset(miner.config.Recommit)</span>
<span class="term-fg32">+				lastDuration = updatePayload()</span>
 			case &lt;-payload.stop:
<span class="term-fg31">-				log.Info(&quot;Stopping work on payload&quot;, &quot;id&quot;, payload.id, &quot;reason&quot;, &quot;delivery&quot;)</span>
 				return
 			case &lt;-endTimer.C:
<span class="term-fg31">-				log.Info(&quot;Stopping work on payload&quot;, &quot;id&quot;, payload.id, &quot;reason&quot;, &quot;timeout&quot;)</span>
<span class="term-fg32">+				stopReason = &quot;timeout&quot;</span>
 				return
 			}
 		}</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-cf5d2d9209ac525ce6193d67" role="button"
                       aria-expanded="false" aria-controls="id-cf5d2d9209ac525ce6193d67">
                        <code>miner/payload_building_test.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/miner/payload_building_test.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/miner/payload_building_test.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+58</span></div>
                            <div class="text-start"><span class="text-danger">-6</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-cf5d2d9209ac525ce6193d67"><span class="term-fg1">diff --git go-ethereum&#47;miner&#47;payload_building_test.go op-geth&#47;miner&#47;payload_building_test.go</span>
<span class="term-fg1">index ac9b2ab704bac96adb9db7e3edb23702775a22fc..316ca93fcf4376b8581c225a3712cce6a59a55c1 100644</span>
<span class="term-fg1">--- go-ethereum&#47;miner&#47;payload_building_test.go</span>
<span class="term-fg1">+++ op-geth&#47;miner&#47;payload_building_test.go</span>
<span class="term-fg36">@@ -147,24 +147,48 @@</span> 	return w, backend
 }
&nbsp;
 func TestBuildPayload(t *testing.T) {
<span class="term-fg32">+	t.Run(&quot;no-tx-pool&quot;, func(t *testing.T) { testBuildPayload(t, true, false) })</span>
<span class="term-fg32">+	&#47;&#47; no-tx-pool case with interrupt not interesting because no-tx-pool doesn&#39;t run</span>
<span class="term-fg32">+	&#47;&#47; the builder routine</span>
<span class="term-fg32">+	t.Run(&quot;with-tx-pool&quot;, func(t *testing.T) { testBuildPayload(t, false, false) })</span>
<span class="term-fg32">+	t.Run(&quot;with-tx-pool-interrupt&quot;, func(t *testing.T) { testBuildPayload(t, false, true) })</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func testBuildPayload(t *testing.T, noTxPool, interrupt bool) {</span>
<span class="term-fg32">+	t.Parallel()</span>
 	var (
 		db        = rawdb.NewMemoryDatabase()
 		recipient = common.HexToAddress(&quot;0xdeadbeef&quot;)
 	)
 	w, b := newTestWorker(t, params.TestChainConfig, ethash.NewFaker(), db, 0)
&nbsp;
<span class="term-fg32">+	const numInterruptTxs = 256</span>
<span class="term-fg32">+	if interrupt {</span>
<span class="term-fg32">+		&#47;&#47; when doing interrupt testing, create a large pool so interruption will</span>
<span class="term-fg32">+		&#47;&#47; definitely be visible.</span>
<span class="term-fg32">+		txs := genTxs(1, numInterruptTxs)</span>
<span class="term-fg32">+		b.txPool.Add(txs, true, false)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
 	timestamp := uint64(time.Now().Unix())
 	args := &amp;BuildPayloadArgs{
 		Parent:       b.chain.CurrentBlock().Hash(),
 		Timestamp:    timestamp,
 		Random:       common.Hash{},
 		FeeRecipient: recipient,
<span class="term-fg32">+		NoTxPool:     noTxPool,</span>
 	}
<span class="term-fg32">+	&#47;&#47; payload resolution now interrupts block building, so we have to</span>
<span class="term-fg32">+	&#47;&#47; wait for the payloading building process to build its first block</span>
 	payload, err := w.buildPayload(args)
 	if err != nil {
 		t.Fatalf(&quot;Failed to build payload %v&quot;, err)
 	}
 	verify := func(outer *engine.ExecutionPayloadEnvelope, txs int) {
<span class="term-fg32">+		t.Helper()</span>
<span class="term-fg32">+		if outer == nil {</span>
<span class="term-fg32">+			t.Fatal(&quot;ExecutionPayloadEnvelope is nil&quot;)</span>
<span class="term-fg32">+		}</span>
 		payload := outer.ExecutionPayload
 		if payload.ParentHash != b.chain.CurrentBlock().Hash() {
 			t.Fatal(&quot;Unexpected parent hash&quot;)
<span class="term-fg36">@@ -178,15 +202,27 @@</span> 		}
 		if payload.FeeRecipient != recipient {
 			t.Fatal(&quot;Unexpected fee recipient&quot;)
 		}
<span class="term-fg31">-		if len(payload.Transactions) != txs {</span>
<span class="term-fg31">-			t.Fatal(&quot;Unexpected transaction set&quot;)</span>
<span class="term-fg32">+		if !interrupt &amp;&amp; len(payload.Transactions) != txs {</span>
<span class="term-fg32">+			t.Fatalf(&quot;Unexpect transaction set: got %d, expected %d&quot;, len(payload.Transactions), txs)</span>
<span class="term-fg32">+		} else if interrupt &amp;&amp; len(payload.Transactions) &gt;= txs {</span>
<span class="term-fg32">+			t.Fatalf(&quot;Unexpect transaction set: got %d, expected less than %d&quot;, len(payload.Transactions), txs)</span>
 		}
 	}
<span class="term-fg31">-	empty := payload.ResolveEmpty()</span>
<span class="term-fg31">-	verify(empty, 0)</span>
&nbsp;
<span class="term-fg31">-	full := payload.ResolveFull()</span>
<span class="term-fg31">-	verify(full, len(pendingTxs))</span>
<span class="term-fg32">+	if noTxPool {</span>
<span class="term-fg32">+		&#47;&#47; we only build the empty block when ignoring the tx pool</span>
<span class="term-fg32">+		empty := payload.ResolveEmpty()</span>
<span class="term-fg32">+		verify(empty, 0)</span>
<span class="term-fg32">+		full := payload.ResolveFull()</span>
<span class="term-fg32">+		verify(full, 0)</span>
<span class="term-fg32">+	} else if interrupt {</span>
<span class="term-fg32">+		full := payload.ResolveFull()</span>
<span class="term-fg32">+		verify(full, len(pendingTxs)+numInterruptTxs)</span>
<span class="term-fg32">+	} else { &#47;&#47; tx-pool and no interrupt</span>
<span class="term-fg32">+		payload.WaitFull()</span>
<span class="term-fg32">+		full := payload.ResolveFull()</span>
<span class="term-fg32">+		verify(full, len(pendingTxs))</span>
<span class="term-fg32">+	}</span>
&nbsp;
 	&#47;&#47; Ensure resolve can be called multiple times and the
 	&#47;&#47; result should be unchanged
<span class="term-fg36">@@ -195,6 +231,22 @@</span> 	dataTwo := payload.Resolve()
 	if !reflect.DeepEqual(dataOne, dataTwo) {
 		t.Fatal(&quot;Unexpected payload data&quot;)
 	}
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func genTxs(startNonce, count uint64) types.Transactions {</span>
<span class="term-fg32">+	txs := make(types.Transactions, 0, count)</span>
<span class="term-fg32">+	signer := types.LatestSigner(params.TestChainConfig)</span>
<span class="term-fg32">+	for nonce := startNonce; nonce &lt; startNonce+count; nonce++ {</span>
<span class="term-fg32">+		txs = append(txs, types.MustSignNewTx(testBankKey, signer, &amp;types.AccessListTx{</span>
<span class="term-fg32">+			ChainID:  params.TestChainConfig.ChainID,</span>
<span class="term-fg32">+			Nonce:    nonce,</span>
<span class="term-fg32">+			To:       &amp;testUserAddress,</span>
<span class="term-fg32">+			Value:    big.NewInt(1000),</span>
<span class="term-fg32">+			Gas:      params.TxGas,</span>
<span class="term-fg32">+			GasPrice: big.NewInt(params.InitialBaseFee),</span>
<span class="term-fg32">+		}))</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	return txs</span>
 }
&nbsp;
 func TestPayloadId(t *testing.T) {</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-601ac635db619b27016571ba" role="button"
                       aria-expanded="false" aria-controls="id-601ac635db619b27016571ba">
                        <code>miner/worker.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/miner/worker.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/miner/worker.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+104</span></div>
                            <div class="text-start"><span class="text-danger">-6</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-601ac635db619b27016571ba"><span class="term-fg1">diff --git go-ethereum&#47;miner&#47;worker.go op-geth&#47;miner&#47;worker.go</span>
<span class="term-fg1">index 5dc3e2056b81b4bf3f58e7c70578d3d3e8729d44..5ade0093854d06cce1653690baab0c6be2149758 100644</span>
<span class="term-fg1">--- go-ethereum&#47;miner&#47;worker.go</span>
<span class="term-fg1">+++ op-geth&#47;miner&#47;worker.go</span>
<span class="term-fg36">@@ -17,6 +17,7 @@</span>
 package miner
&nbsp;
 import (
<span class="term-fg32">+	&quot;context&quot;</span>
 	&quot;errors&quot;
 	&quot;fmt&quot;
 	&quot;math&#47;big&quot;
<span class="term-fg36">@@ -24,6 +25,7 @@</span> 	&quot;sync&#47;atomic&quot;
 	&quot;time&quot;
&nbsp;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&quot;
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;consensus&#47;misc&quot;</span>
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;consensus&#47;misc&#47;eip1559&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;consensus&#47;misc&#47;eip4844&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&quot;
<span class="term-fg36">@@ -31,15 +33,23 @@</span> 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&#47;state&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&#47;txpool&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&#47;types&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&#47;vm&quot;
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;eth&#47;tracers&quot;</span>
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;log&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;params&quot;
 	&quot;github.com&#47;holiman&#47;uint256&quot;
 )
&nbsp;
<span class="term-fg32">+const (</span>
<span class="term-fg32">+	&#47;&#47; minRecommitInterruptInterval is the minimum time interval used to interrupt filling a</span>
<span class="term-fg32">+	&#47;&#47; sealing block with pending transactions from the mempool</span>
<span class="term-fg32">+	minRecommitInterruptInterval = 2 * time.Second</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
 var (
 	errBlockInterruptedByNewHead  = errors.New(&quot;new head arrived while building block&quot;)
 	errBlockInterruptedByRecommit = errors.New(&quot;recommit interrupt while building block&quot;)
 	errBlockInterruptedByTimeout  = errors.New(&quot;timeout while building block&quot;)
<span class="term-fg32">+	errBlockInterruptedByResolve  = errors.New(&quot;payload resolution while building block&quot;)</span>
 )
&nbsp;
 &#47;&#47; environment is the worker&#39;s current environment and holds all
<span class="term-fg36">@@ -63,6 +73,7 @@</span> 	commitInterruptNone int32 = iota
 	commitInterruptNewHead
 	commitInterruptResubmit
 	commitInterruptTimeout
<span class="term-fg32">+	commitInterruptResolve</span>
 )
&nbsp;
 &#47;&#47; newPayloadResult is the result of payload generation.
<span class="term-fg36">@@ -85,6 +96,11 @@</span> 	random      common.Hash       &#47;&#47; The randomness generated by beacon chain, empty before the merge
 	withdrawals types.Withdrawals &#47;&#47; List of withdrawals to include in block (shanghai field)
 	beaconRoot  *common.Hash      &#47;&#47; The beacon root (cancun field).
 	noTxs       bool              &#47;&#47; Flag whether an empty block without any transaction is expected
<span class="term-fg32">+</span>
<span class="term-fg32">+	txs       types.Transactions &#47;&#47; Deposit transactions to include at the start of the block</span>
<span class="term-fg32">+	gasLimit  *uint64            &#47;&#47; Optional gas limit override</span>
<span class="term-fg32">+	interrupt *atomic.Int32      &#47;&#47; Optional interruption signal to pass down to worker.generateWork</span>
<span class="term-fg32">+	isUpdate  bool               &#47;&#47; Optional flag indicating that this is building a discardable update</span>
 }
&nbsp;
 &#47;&#47; generateWork generates a sealing block based on the given parameters.
<span class="term-fg36">@@ -93,18 +109,47 @@</span> 	work, err := miner.prepareWork(params)
 	if err != nil {
 		return &amp;newPayloadResult{err: err}
 	}
<span class="term-fg32">+	if work.gasPool == nil {</span>
<span class="term-fg32">+		gasLimit := miner.config.EffectiveGasCeil</span>
<span class="term-fg32">+		if gasLimit == 0 || gasLimit &gt; work.header.GasLimit {</span>
<span class="term-fg32">+			gasLimit = work.header.GasLimit</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		work.gasPool = new(core.GasPool).AddGas(gasLimit)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	misc.EnsureCreate2Deployer(miner.chainConfig, work.header.Time, work.state)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	for _, tx := range params.txs {</span>
<span class="term-fg32">+		from, _ := types.Sender(work.signer, tx)</span>
<span class="term-fg32">+		work.state.SetTxContext(tx.Hash(), work.tcount)</span>
<span class="term-fg32">+		err = miner.commitTransaction(work, tx)</span>
<span class="term-fg32">+		if err != nil {</span>
<span class="term-fg32">+			return &amp;newPayloadResult{err: fmt.Errorf(&quot;failed to force-include tx: %s type: %d sender: %s nonce: %d, err: %w&quot;, tx.Hash(), tx.Type(), from, tx.Nonce(), err)}</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		work.tcount++</span>
<span class="term-fg32">+	}</span>
 	if !params.noTxs {
<span class="term-fg31">-		interrupt := new(atomic.Int32)</span>
<span class="term-fg31">-		timer := time.AfterFunc(miner.config.Recommit, func() {</span>
<span class="term-fg32">+		&#47;&#47; use shared interrupt if present</span>
<span class="term-fg32">+		interrupt := params.interrupt</span>
<span class="term-fg32">+		if interrupt == nil {</span>
<span class="term-fg32">+			interrupt = new(atomic.Int32)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		timer := time.AfterFunc(max(minRecommitInterruptInterval, miner.config.Recommit), func() {</span>
 			interrupt.Store(commitInterruptTimeout)
 		})
<span class="term-fg31">-		defer timer.Stop()</span>
&nbsp;
 		err := miner.fillTransactions(interrupt, work)
<span class="term-fg32">+		timer.Stop() &#47;&#47; don&#39;t need timeout interruption any more</span>
 		if errors.Is(err, errBlockInterruptedByTimeout) {
 			log.Warn(&quot;Block building is interrupted&quot;, &quot;allowance&quot;, common.PrettyDuration(miner.config.Recommit))
<span class="term-fg32">+		} else if errors.Is(err, errBlockInterruptedByResolve) {</span>
<span class="term-fg32">+			log.Info(&quot;Block building got interrupted by payload resolution&quot;)</span>
 		}
 	}
<span class="term-fg32">+	if intr := params.interrupt; intr != nil &amp;&amp; params.isUpdate &amp;&amp; intr.Load() != commitInterruptNone {</span>
<span class="term-fg32">+		return &amp;newPayloadResult{err: errInterruptedUpdate}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
 	body := types.Body{Transactions: work.txs, Withdrawals: params.withdrawals}
 	block, err := miner.engine.FinalizeAndAssemble(miner.chain, work.header, work.state, &amp;body, work.receipts)
 	if err != nil {
<span class="term-fg36">@@ -153,7 +198,7 @@</span> 		Time:       timestamp,
 		Coinbase:   genParams.coinbase,
 	}
 	&#47;&#47; Set the extra field.
<span class="term-fg31">-	if len(miner.config.ExtraData) != 0 {</span>
<span class="term-fg32">+	if len(miner.config.ExtraData) != 0 &amp;&amp; miner.chainConfig.Optimism == nil { &#47;&#47; Optimism chains must not set any extra data.</span>
 		header.Extra = miner.config.ExtraData
 	}
 	&#47;&#47; Set the randomness field from the beacon chain if it&#39;s available.
<span class="term-fg36">@@ -162,12 +207,18 @@</span> 		header.MixDigest = genParams.random
 	}
 	&#47;&#47; Set baseFee and GasLimit if we are on an EIP-1559 chain
 	if miner.chainConfig.IsLondon(header.Number) {
<span class="term-fg31">-		header.BaseFee = eip1559.CalcBaseFee(miner.chainConfig, parent)</span>
<span class="term-fg32">+		header.BaseFee = eip1559.CalcBaseFee(miner.chainConfig, parent, header.Time)</span>
 		if !miner.chainConfig.IsLondon(parent.Number) {
 			parentGasLimit := parent.GasLimit * miner.chainConfig.ElasticityMultiplier()
 			header.GasLimit = core.CalcGasLimit(parentGasLimit, miner.config.GasCeil)
 		}
 	}
<span class="term-fg32">+	if genParams.gasLimit != nil { &#47;&#47; override gas limit if specified</span>
<span class="term-fg32">+		header.GasLimit = *genParams.gasLimit</span>
<span class="term-fg32">+	} else if miner.chain.Config().Optimism != nil &amp;&amp; miner.config.GasCeil != 0 {</span>
<span class="term-fg32">+		&#47;&#47; configure the gas limit of pending blocks with the miner gas limit config when using optimism</span>
<span class="term-fg32">+		header.GasLimit = miner.config.GasCeil</span>
<span class="term-fg32">+	}</span>
 	&#47;&#47; Run the consensus preparation with the default or customized consensus engine.
 	&#47;&#47; Note that the `header.Time` may be changed.
 	if err := miner.engine.Prepare(miner.chain, header); err != nil {
<span class="term-fg36">@@ -196,7 +247,7 @@</span> 		log.Error(&quot;Failed to create sealing context&quot;, &quot;err&quot;, err)
 		return nil, err
 	}
 	if header.ParentBeaconRoot != nil {
<span class="term-fg31">-		context := core.NewEVMBlockContext(header, miner.chain, nil)</span>
<span class="term-fg32">+		context := core.NewEVMBlockContext(header, miner.chain, nil, miner.chainConfig, env.state)</span>
 		vmenv := vm.NewEVM(context, vm.TxContext{}, env.state, miner.chainConfig, vm.Config{})
 		core.ProcessBeaconBlockRoot(*header.ParentBeaconRoot, vmenv, env.state)
 	}
<span class="term-fg36">@@ -211,6 +262,19 @@</span> 	state, err := miner.chain.StateAt(parent.Root)
 	if err != nil {
 		return nil, err
 	}
<span class="term-fg32">+	if miner.chainConfig.Optimism != nil { &#47;&#47; Allow the miner to reorg its own chain arbitrarily deep</span>
<span class="term-fg32">+		if historicalBackend, ok := miner.backend.(BackendWithHistoricalState); ok {</span>
<span class="term-fg32">+			var release tracers.StateReleaseFunc</span>
<span class="term-fg32">+			parentBlock := miner.backend.BlockChain().GetBlockByHash(parent.Hash())</span>
<span class="term-fg32">+			state, release, err = historicalBackend.StateAtBlock(context.Background(), parentBlock, ^uint64(0), nil, false, false)</span>
<span class="term-fg32">+			if err != nil {</span>
<span class="term-fg32">+				return nil, err</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+			state = state.Copy()</span>
<span class="term-fg32">+			release()</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
 	&#47;&#47; Note the passed coinbase may be different with header.Coinbase.
 	return &amp;environment{
 		signer:   types.MakeSigner(miner.chainConfig, header.Number, header.Time),
<span class="term-fg36">@@ -451,7 +515,41 @@</span> 	case commitInterruptResubmit:
 		return errBlockInterruptedByRecommit
 	case commitInterruptTimeout:
 		return errBlockInterruptedByTimeout
<span class="term-fg32">+	case commitInterruptResolve:</span>
<span class="term-fg32">+		return errBlockInterruptedByResolve</span>
 	default:
 		panic(fmt.Errorf(&quot;undefined signal %d&quot;, signal))
 	}
 }
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; validateParams validates the given parameters.</span>
<span class="term-fg32">+&#47;&#47; It currently checks that the parent block is known and that the timestamp is valid,</span>
<span class="term-fg32">+&#47;&#47; i.e., after the parent block&#39;s timestamp.</span>
<span class="term-fg32">+&#47;&#47; It returns an upper bound of the payload building duration as computed</span>
<span class="term-fg32">+&#47;&#47; by the difference in block timestamps between the parent and genParams.</span>
<span class="term-fg32">+func (miner *Miner) validateParams(genParams *generateParams) (time.Duration, error) {</span>
<span class="term-fg32">+	miner.confMu.RLock()</span>
<span class="term-fg32">+	defer miner.confMu.RUnlock()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Find the parent block for sealing task</span>
<span class="term-fg32">+	parent := miner.chain.CurrentBlock()</span>
<span class="term-fg32">+	if genParams.parentHash != (common.Hash{}) {</span>
<span class="term-fg32">+		block := miner.chain.GetBlockByHash(genParams.parentHash)</span>
<span class="term-fg32">+		if block == nil {</span>
<span class="term-fg32">+			return 0, fmt.Errorf(&quot;missing parent %v&quot;, genParams.parentHash)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		parent = block.Header()</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Sanity check the timestamp correctness</span>
<span class="term-fg32">+	blockTime := int64(genParams.timestamp) - int64(parent.Time)</span>
<span class="term-fg32">+	if blockTime &lt;= 0 &amp;&amp; genParams.forceTime {</span>
<span class="term-fg32">+		return 0, fmt.Errorf(&quot;invalid timestamp, parent %d given %d&quot;, parent.Time, genParams.timestamp)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; minimum payload build time of 2s</span>
<span class="term-fg32">+	if blockTime &lt; 2 {</span>
<span class="term-fg32">+		blockTime = 2</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	return time.Duration(blockTime) * time.Second, nil</span>
<span class="term-fg32">+}</span></div>
    </div>

            
            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-7cd933d2e94780645b030189"role="button" aria-expanded="false" aria-controls="id-7cd933d2e94780645b030189">
        
            <div class="col-12 col-md-12 col-lg-6 col-xl-6 text-start"><h3>Tx-pool tx cost updates</h3></div>
        

        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2">
            <div class="row line-stat">
                
                
            </div>
        </div>
        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2 ">
            <div class="row line-stat">
                
                    <div class="text-end"><span class="text-success">+166</span></div>
                    <div class="text-start"><span class="text-danger">-33</span></div>
                
                
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-7cd933d2e94780645b030189">
        <div><p>Transaction queueing and inclusion needs to account for the L1 cost component.</p>
</div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-98f6d8eeb26fff69ddcdc12d" role="button"
                       aria-expanded="false" aria-controls="id-98f6d8eeb26fff69ddcdc12d">
                        <code>core/txpool/blobpool/blobpool.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/core/txpool/blobpool/blobpool.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/core/txpool/blobpool/blobpool.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+2</span></div>
                            <div class="text-start"><span class="text-danger">-2</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-98f6d8eeb26fff69ddcdc12d"><span class="term-fg1">diff --git go-ethereum&#47;core&#47;txpool&#47;blobpool&#47;blobpool.go op-geth&#47;core&#47;txpool&#47;blobpool&#47;blobpool.go</span>
<span class="term-fg1">index 6ff8847a7662aa3f4f7318d79aa22085ae5daea5..30893f217b92cf21f5c8f4b4d44f804133b194ea 100644</span>
<span class="term-fg1">--- go-ethereum&#47;core&#47;txpool&#47;blobpool&#47;blobpool.go</span>
<span class="term-fg1">+++ op-geth&#47;core&#47;txpool&#47;blobpool&#47;blobpool.go</span>
<span class="term-fg36">@@ -401,7 +401,7 @@</span> 	for addr := range p.index {
 		p.recheck(addr, nil)
 	}
 	var (
<span class="term-fg31">-		basefee = uint256.MustFromBig(eip1559.CalcBaseFee(p.chain.Config(), p.head))</span>
<span class="term-fg32">+		basefee = uint256.MustFromBig(eip1559.CalcBaseFee(p.chain.Config(), p.head, p.head.Time+1))</span>
 		blobfee = uint256.NewInt(params.BlobTxMinBlobGasprice)
 	)
 	if p.head.ExcessBlobGas != nil {
<span class="term-fg36">@@ -822,7 +822,7 @@</span> 		p.limbo.finalize(p.chain.CurrentFinalBlock())
 	}
 	&#47;&#47; Reset the price heap for the new set of basefee&#47;blobfee pairs
 	var (
<span class="term-fg31">-		basefee = uint256.MustFromBig(eip1559.CalcBaseFee(p.chain.Config(), newHead))</span>
<span class="term-fg32">+		basefee = uint256.MustFromBig(eip1559.CalcBaseFee(p.chain.Config(), newHead, newHead.Time+1))</span>
 		blobfee = uint256.MustFromBig(big.NewInt(params.BlobTxMinBlobGasprice))
 	)
 	if newHead.ExcessBlobGas != nil {</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-0a8efdf91c81f885bf208252" role="button"
                       aria-expanded="false" aria-controls="id-0a8efdf91c81f885bf208252">
                        <code>core/txpool/blobpool/blobpool_test.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/core/txpool/blobpool/blobpool_test.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/core/txpool/blobpool/blobpool_test.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+1</span></div>
                            <div class="text-start"><span class="text-danger">-1</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-0a8efdf91c81f885bf208252"><span class="term-fg1">diff --git go-ethereum&#47;core&#47;txpool&#47;blobpool&#47;blobpool_test.go op-geth&#47;core&#47;txpool&#47;blobpool&#47;blobpool_test.go</span>
<span class="term-fg1">index d658a6daf44a2de550cae58cf6932346a7ea5914..f8deeca2ce37288fd4001c11f4cc5d3d22ead18a 100644</span>
<span class="term-fg1">--- go-ethereum&#47;core&#47;txpool&#47;blobpool&#47;blobpool_test.go</span>
<span class="term-fg1">+++ op-geth&#47;core&#47;txpool&#47;blobpool&#47;blobpool_test.go</span>
<span class="term-fg36">@@ -103,7 +103,7 @@</span> 			Number:   blockNumber,
 			GasLimit: gasLimit,
 			GasUsed:  0,
 			BaseFee:  mid,
<span class="term-fg31">-		}).Cmp(bc.basefee.ToBig()) &gt; 0 {</span>
<span class="term-fg32">+		}, blockTime).Cmp(bc.basefee.ToBig()) &gt; 0 {</span>
 			hi = mid
 		} else {
 			lo = mid</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-d4df97becc384b807b5721c6" role="button"
                       aria-expanded="false" aria-controls="id-d4df97becc384b807b5721c6">
                        <code>core/txpool/legacypool/legacypool.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/core/txpool/legacypool/legacypool.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/core/txpool/legacypool/legacypool.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+81</span></div>
                            <div class="text-start"><span class="text-danger">-16</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-d4df97becc384b807b5721c6"><span class="term-fg1">diff --git go-ethereum&#47;core&#47;txpool&#47;legacypool&#47;legacypool.go op-geth&#47;core&#47;txpool&#47;legacypool&#47;legacypool.go</span>
<span class="term-fg1">index 4e1d26acf4056712a3a4bff2f8bc796fc81f8759..161e3e84018f3a0ffd8e8fc32fb025d7bffb7a37 100644</span>
<span class="term-fg1">--- go-ethereum&#47;core&#47;txpool&#47;legacypool&#47;legacypool.go</span>
<span class="term-fg1">+++ op-geth&#47;core&#47;txpool&#47;legacypool&#47;legacypool.go</span>
<span class="term-fg36">@@ -126,6 +126,10 @@</span> 	NoLocals  bool             &#47;&#47; Whether local transaction handling should be disabled
 	Journal   string           &#47;&#47; Journal of local transactions to survive node restarts
 	Rejournal time.Duration    &#47;&#47; Time interval to regenerate the local transaction journal
&nbsp;
<span class="term-fg32">+	&#47;&#47; JournalRemote controls whether journaling includes remote transactions or not.</span>
<span class="term-fg32">+	&#47;&#47; When true, all transactions loaded from the journal are treated as remote.</span>
<span class="term-fg32">+	JournalRemote bool</span>
<span class="term-fg32">+</span>
 	PriceLimit uint64 &#47;&#47; Minimum gas price to enforce for acceptance into the pool
 	PriceBump  uint64 &#47;&#47; Minimum price bump percentage to replace an already existing transaction (nonce)
&nbsp;
<span class="term-fg36">@@ -135,6 +139,8 @@</span> 	AccountQueue uint64 &#47;&#47; Maximum number of non-executable transaction slots permitted per account
 	GlobalQueue  uint64 &#47;&#47; Maximum number of non-executable transaction slots for all accounts
&nbsp;
 	Lifetime time.Duration &#47;&#47; Maximum amount of time non-executable transaction are queued
<span class="term-fg32">+</span>
<span class="term-fg32">+	EffectiveGasCeil uint64 &#47;&#47; if non-zero, a gas ceiling to enforce independent of the header&#39;s gaslimit value</span>
 }
&nbsp;
 &#47;&#47; DefaultConfig contains the default configurations for the transaction pool.
<span class="term-fg36">@@ -231,6 +237,8 @@</span> 	wg              sync.WaitGroup &#47;&#47; tracks loop, scheduleReorgLoop
 	initDoneCh      chan struct{}  &#47;&#47; is closed once the pool is initialized (for tests)
&nbsp;
 	changesSinceReorg int &#47;&#47; A counter for how many drops we&#39;ve performed in-between reorg.
<span class="term-fg32">+</span>
<span class="term-fg32">+	l1CostFn txpool.L1CostFunc &#47;&#47; To apply L1 costs as rollup, optional field, may be nil.</span>
 }
&nbsp;
 type txpoolResetRequest struct {
<span class="term-fg36">@@ -267,7 +275,7 @@</span> 		pool.locals.add(addr)
 	}
 	pool.priced = newPricedList(pool.all)
&nbsp;
<span class="term-fg31">-	if !config.NoLocals &amp;&amp; config.Journal != &quot;&quot; {</span>
<span class="term-fg32">+	if (!config.NoLocals || config.JournalRemote) &amp;&amp; config.Journal != &quot;&quot; {</span>
 		pool.journal = newTxJournal(config.Journal)
 	}
 	return pool
<span class="term-fg36">@@ -316,10 +324,14 @@</span> 	go pool.scheduleReorgLoop()
&nbsp;
 	&#47;&#47; If local transactions and journaling is enabled, load from disk
 	if pool.journal != nil {
<span class="term-fg31">-		if err := pool.journal.load(pool.addLocals); err != nil {</span>
<span class="term-fg32">+		add := pool.addLocals</span>
<span class="term-fg32">+		if pool.config.JournalRemote {</span>
<span class="term-fg32">+			add = pool.addRemotesSync &#47;&#47; Use sync version to match pool.AddLocals</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		if err := pool.journal.load(add); err != nil {</span>
 			log.Warn(&quot;Failed to load transaction journal&quot;, &quot;err&quot;, err)
 		}
<span class="term-fg31">-		if err := pool.journal.rotate(pool.local()); err != nil {</span>
<span class="term-fg32">+		if err := pool.journal.rotate(pool.toJournal()); err != nil {</span>
 			log.Warn(&quot;Failed to rotate transaction journal&quot;, &quot;err&quot;, err)
 		}
 	}
<span class="term-fg36">@@ -389,7 +401,7 @@</span> 		&#47;&#47; Handle local transaction journal rotation
 		case &lt;-journal.C:
 			if pool.journal != nil {
 				pool.mu.Lock()
<span class="term-fg31">-				if err := pool.journal.rotate(pool.local()); err != nil {</span>
<span class="term-fg32">+				if err := pool.journal.rotate(pool.toJournal()); err != nil {</span>
 					log.Warn(&quot;Failed to rotate local tx journal&quot;, &quot;err&quot;, err)
 				}
 				pool.mu.Unlock()
<span class="term-fg36">@@ -583,6 +595,23 @@</span>
 	return pool.locals.flatten()
 }
&nbsp;
<span class="term-fg32">+&#47;&#47; toJournal retrieves all transactions that should be included in the journal,</span>
<span class="term-fg32">+&#47;&#47; grouped by origin account and sorted by nonce.</span>
<span class="term-fg32">+&#47;&#47; The returned transaction set is a copy and can be freely modified by calling code.</span>
<span class="term-fg32">+func (pool *LegacyPool) toJournal() map[common.Address]types.Transactions {</span>
<span class="term-fg32">+	if !pool.config.JournalRemote {</span>
<span class="term-fg32">+		return pool.local()</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	txs := make(map[common.Address]types.Transactions)</span>
<span class="term-fg32">+	for addr, pending := range pool.pending {</span>
<span class="term-fg32">+		txs[addr] = append(txs[addr], pending.Flatten()...)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	for addr, queued := range pool.queue {</span>
<span class="term-fg32">+		txs[addr] = append(txs[addr], queued.Flatten()...)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	return txs</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
 &#47;&#47; local retrieves all currently known local transactions, grouped by origin
 &#47;&#47; account and sorted by nonce. The returned transaction set is a copy and can be
 &#47;&#47; freely modified by calling code.
<span class="term-fg36">@@ -610,8 +639,9 @@</span> 		Accept: 0 |
 			1&lt;&lt;types.LegacyTxType |
 			1&lt;&lt;types.AccessListTxType |
 			1&lt;&lt;types.DynamicFeeTxType,
<span class="term-fg31">-		MaxSize: txMaxSize,</span>
<span class="term-fg31">-		MinTip:  pool.gasTip.Load().ToBig(),</span>
<span class="term-fg32">+		MaxSize:          txMaxSize,</span>
<span class="term-fg32">+		MinTip:           pool.gasTip.Load().ToBig(),</span>
<span class="term-fg32">+		EffectiveGasCeil: pool.config.EffectiveGasCeil,</span>
 	}
 	if local {
 		opts.MinTip = new(big.Int)
<span class="term-fg36">@@ -648,11 +678,18 @@</span> 		},
 		ExistingCost: func(addr common.Address, nonce uint64) *big.Int {
 			if list := pool.pending[addr]; list != nil {
 				if tx := list.txs.Get(nonce); tx != nil {
<span class="term-fg31">-					return tx.Cost()</span>
<span class="term-fg32">+					cost := tx.Cost()</span>
<span class="term-fg32">+					if pool.l1CostFn != nil {</span>
<span class="term-fg32">+						if l1Cost := pool.l1CostFn(tx.RollupCostData()); l1Cost != nil { &#47;&#47; add rollup cost</span>
<span class="term-fg32">+							cost = cost.Add(cost, l1Cost)</span>
<span class="term-fg32">+						}</span>
<span class="term-fg32">+					}</span>
<span class="term-fg32">+					return cost</span>
 				}
 			}
 			return nil
 		},
<span class="term-fg32">+		L1CostFn: pool.l1CostFn,</span>
 	}
 	if err := txpool.ValidateTransactionWithState(tx, pool.signer, opts); err != nil {
 		return err
<span class="term-fg36">@@ -775,7 +812,7 @@</span>
 	&#47;&#47; Try to replace an existing transaction in the pending pool
 	if list := pool.pending[from]; list != nil &amp;&amp; list.Contains(tx.Nonce()) {
 		&#47;&#47; Nonce already pending, check if required price bump is met
<span class="term-fg31">-		inserted, old := list.Add(tx, pool.config.PriceBump)</span>
<span class="term-fg32">+		inserted, old := list.Add(tx, pool.config.PriceBump, pool.l1CostFn)</span>
 		if !inserted {
 			pendingDiscardMeter.Mark(1)
 			return false, txpool.ErrReplaceUnderpriced
<span class="term-fg36">@@ -849,7 +886,7 @@</span> 	from, _ := types.Sender(pool.signer, tx) &#47;&#47; already validated
 	if pool.queue[from] == nil {
 		pool.queue[from] = newList(false)
 	}
<span class="term-fg31">-	inserted, old := pool.queue[from].Add(tx, pool.config.PriceBump)</span>
<span class="term-fg32">+	inserted, old := pool.queue[from].Add(tx, pool.config.PriceBump, pool.l1CostFn)</span>
 	if !inserted {
 		&#47;&#47; An older transaction was better, discard this
 		queuedDiscardMeter.Mark(1)
<span class="term-fg36">@@ -884,7 +921,7 @@</span> &#47;&#47; journalTx adds the specified transaction to the local disk journal if it is
 &#47;&#47; deemed to have been sent from a local account.
 func (pool *LegacyPool) journalTx(from common.Address, tx *types.Transaction) {
 	&#47;&#47; Only journal if it&#39;s enabled and the transaction is local
<span class="term-fg31">-	if pool.journal == nil || !pool.locals.contains(from) {</span>
<span class="term-fg32">+	if pool.journal == nil || (!pool.config.JournalRemote &amp;&amp; !pool.locals.contains(from)) {</span>
 		return
 	}
 	if err := pool.journal.insert(tx); err != nil {
<span class="term-fg36">@@ -903,7 +940,7 @@</span> 		pool.pending[addr] = newList(true)
 	}
 	list := pool.pending[addr]
&nbsp;
<span class="term-fg31">-	inserted, old := list.Add(tx, pool.config.PriceBump)</span>
<span class="term-fg32">+	inserted, old := list.Add(tx, pool.config.PriceBump, pool.l1CostFn)</span>
 	if !inserted {
 		&#47;&#47; An older transaction was better, discard this
 		pool.all.Remove(hash)
<span class="term-fg36">@@ -1298,7 +1335,7 @@</span> 	if reset != nil {
 		pool.demoteUnexecutables()
 		if reset.newHead != nil {
 			if pool.chainconfig.IsLondon(new(big.Int).Add(reset.newHead.Number, big.NewInt(1))) {
<span class="term-fg31">-				pendingBaseFee := eip1559.CalcBaseFee(pool.chainconfig, reset.newHead)</span>
<span class="term-fg32">+				pendingBaseFee := eip1559.CalcBaseFee(pool.chainconfig, reset.newHead, reset.newHead.Time+1)</span>
 				pool.priced.SetBaseFee(pendingBaseFee)
 			} else {
 				pool.priced.Reheap()
<span class="term-fg36">@@ -1430,12 +1467,36 @@</span> 	pool.currentHead.Store(newHead)
 	pool.currentState = statedb
 	pool.pendingNonces = newNoncer(statedb)
&nbsp;
<span class="term-fg32">+	if costFn := types.NewL1CostFunc(pool.chainconfig, statedb); costFn != nil {</span>
<span class="term-fg32">+		pool.l1CostFn = func(rollupCostData types.RollupCostData) *big.Int {</span>
<span class="term-fg32">+			return costFn(rollupCostData, newHead.Time)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
 	&#47;&#47; Inject any transactions discarded due to reorgs
 	log.Debug(&quot;Reinjecting stale transactions&quot;, &quot;count&quot;, len(reinject))
 	core.SenderCacher.Recover(pool.signer, reinject)
 	pool.addTxsLocked(reinject, false)
 }
&nbsp;
<span class="term-fg32">+&#47;&#47; reduceBalanceByL1Cost returns the given balance, reduced by the L1Cost of the first transaction in list if applicable</span>
<span class="term-fg32">+&#47;&#47; Other txs will get filtered out necessary.</span>
<span class="term-fg32">+func (pool *LegacyPool) reduceBalanceByL1Cost(list *list, balance *uint256.Int) *uint256.Int {</span>
<span class="term-fg32">+	if !list.Empty() &amp;&amp; pool.l1CostFn != nil {</span>
<span class="term-fg32">+		el := list.txs.FirstElement()</span>
<span class="term-fg32">+		if l1Cost := pool.l1CostFn(el.RollupCostData()); l1Cost != nil {</span>
<span class="term-fg32">+			l1Cost256 := uint256.MustFromBig(l1Cost)</span>
<span class="term-fg32">+			if l1Cost256.Cmp(balance) &gt;= 0 {</span>
<span class="term-fg32">+				&#47;&#47; Avoid underflow</span>
<span class="term-fg32">+				balance = uint256.NewInt(0)</span>
<span class="term-fg32">+			} else {</span>
<span class="term-fg32">+				balance = new(uint256.Int).Sub(balance, l1Cost256)</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	return balance</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
 &#47;&#47; promoteExecutables moves transactions that have become processable from the
 &#47;&#47; future queue to the set of pending transactions. During this process, all
 &#47;&#47; invalidated transactions (low nonce, low balance) are deleted.
<span class="term-fg36">@@ -1444,7 +1505,7 @@</span> 	&#47;&#47; Track the promoted transactions to broadcast them at once
 	var promoted []*types.Transaction
&nbsp;
 	&#47;&#47; Iterate over all accounts and promote any executable transactions
<span class="term-fg31">-	gasLimit := pool.currentHead.Load().GasLimit</span>
<span class="term-fg32">+	gasLimit := txpool.EffectiveGasLimit(pool.chainconfig, pool.currentHead.Load().GasLimit, pool.config.EffectiveGasCeil)</span>
 	for _, addr := range accounts {
 		list := pool.queue[addr]
 		if list == nil {
<span class="term-fg36">@@ -1457,8 +1518,10 @@</span> 			hash := tx.Hash()
 			pool.all.Remove(hash)
 		}
 		log.Trace(&quot;Removed old queued transactions&quot;, &quot;count&quot;, len(forwards))
<span class="term-fg32">+		balance := pool.currentState.GetBalance(addr)</span>
<span class="term-fg32">+		balance = pool.reduceBalanceByL1Cost(list, balance)</span>
 		&#47;&#47; Drop all transactions that are too costly (low balance or out of gas)
<span class="term-fg31">-		drops, _ := list.Filter(pool.currentState.GetBalance(addr), gasLimit)</span>
<span class="term-fg32">+		drops, _ := list.Filter(balance, gasLimit)</span>
 		for _, tx := range drops {
 			hash := tx.Hash()
 			pool.all.Remove(hash)
<span class="term-fg36">@@ -1647,7 +1710,7 @@</span> &#47;&#47; is always explicitly triggered by SetBaseFee and it would be unnecessary and wasteful
 &#47;&#47; to trigger a re-heap is this function
 func (pool *LegacyPool) demoteUnexecutables() {
 	&#47;&#47; Iterate over all accounts and demote any non-executable transactions
<span class="term-fg31">-	gasLimit := pool.currentHead.Load().GasLimit</span>
<span class="term-fg32">+	gasLimit := txpool.EffectiveGasLimit(pool.chainconfig, pool.currentHead.Load().GasLimit, pool.config.EffectiveGasCeil)</span>
 	for addr, list := range pool.pending {
 		nonce := pool.currentState.GetNonce(addr)
&nbsp;
<span class="term-fg36">@@ -1658,8 +1721,10 @@</span> 			hash := tx.Hash()
 			pool.all.Remove(hash)
 			log.Trace(&quot;Removed old pending transaction&quot;, &quot;hash&quot;, hash)
 		}
<span class="term-fg32">+		balance := pool.currentState.GetBalance(addr)</span>
<span class="term-fg32">+		balance = pool.reduceBalanceByL1Cost(list, balance)</span>
 		&#47;&#47; Drop all transactions that are too costly (low balance or out of gas), and queue any invalids back for later
<span class="term-fg31">-		drops, invalids := list.Filter(pool.currentState.GetBalance(addr), gasLimit)</span>
<span class="term-fg32">+		drops, invalids := list.Filter(balance, gasLimit)</span>
 		for _, tx := range drops {
 			hash := tx.Hash()
 			log.Trace(&quot;Removed unpayable pending transaction&quot;, &quot;hash&quot;, hash)</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-8b7ec7ece8ecf55fecc924b4" role="button"
                       aria-expanded="false" aria-controls="id-8b7ec7ece8ecf55fecc924b4">
                        <code>core/txpool/legacypool/legacypool_test.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/core/txpool/legacypool/legacypool_test.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/core/txpool/legacypool/legacypool_test.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+21</span></div>
                            <div class="text-start"><span class="text-danger">-7</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-8b7ec7ece8ecf55fecc924b4"><span class="term-fg1">diff --git go-ethereum&#47;core&#47;txpool&#47;legacypool&#47;legacypool_test.go op-geth&#47;core&#47;txpool&#47;legacypool&#47;legacypool_test.go</span>
<span class="term-fg1">index c86991c942da8d3a84af7e527f06d5f37f9064f2..c71544b48cd80152306c33dd63864258646e5c65 100644</span>
<span class="term-fg1">--- go-ethereum&#47;core&#47;txpool&#47;legacypool&#47;legacypool_test.go</span>
<span class="term-fg1">+++ op-geth&#47;core&#47;txpool&#47;legacypool&#47;legacypool_test.go</span>
<span class="term-fg36">@@ -2344,10 +2344,13 @@</span> }
&nbsp;
 &#47;&#47; Tests that local transactions are journaled to disk, but remote transactions
 &#47;&#47; get discarded between restarts.
<span class="term-fg31">-func TestJournaling(t *testing.T)         { testJournaling(t, false) }</span>
<span class="term-fg31">-func TestJournalingNoLocals(t *testing.T) { testJournaling(t, true) }</span>
<span class="term-fg32">+func TestJournaling(t *testing.T)         { testJournaling(t, false, false) }</span>
<span class="term-fg32">+func TestJournalingNoLocals(t *testing.T) { testJournaling(t, true, false) }</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func TestJournalingRemotes(t *testing.T)         { testJournaling(t, false, true) }</span>
<span class="term-fg32">+func TestJournalingRemotesNoLocals(t *testing.T) { testJournaling(t, true, true) }</span>
&nbsp;
<span class="term-fg31">-func testJournaling(t *testing.T, nolocals bool) {</span>
<span class="term-fg32">+func testJournaling(t *testing.T, nolocals bool, journalRemotes bool) {</span>
 	t.Parallel()
&nbsp;
 	&#47;&#47; Create a temporary file for the journal
<span class="term-fg36">@@ -2368,6 +2371,7 @@</span> 	blockchain := newTestBlockChain(params.TestChainConfig, 1000000, statedb, new(event.Feed))
&nbsp;
 	config := testTxPoolConfig
 	config.NoLocals = nolocals
<span class="term-fg32">+	config.JournalRemote = journalRemotes</span>
 	config.Journal = journal
 	config.Rejournal = time.Second
&nbsp;
<span class="term-fg36">@@ -2416,10 +2420,14 @@</span> 	pending, queued = pool.Stats()
 	if queued != 0 {
 		t.Fatalf(&quot;queued transactions mismatched: have %d, want %d&quot;, queued, 0)
 	}
<span class="term-fg31">-	if nolocals {</span>
<span class="term-fg32">+	if nolocals &amp;&amp; !journalRemotes {</span>
 		if pending != 0 {
 			t.Fatalf(&quot;pending transactions mismatched: have %d, want %d&quot;, pending, 0)
 		}
<span class="term-fg32">+	} else if journalRemotes {</span>
<span class="term-fg32">+		if pending != 3 {</span>
<span class="term-fg32">+			t.Fatalf(&quot;pending transactions mismatched: have %d, want %d&quot;, pending, 3)</span>
<span class="term-fg32">+		}</span>
 	} else {
 		if pending != 2 {
 			t.Fatalf(&quot;pending transactions mismatched: have %d, want %d&quot;, pending, 2)
<span class="term-fg36">@@ -2440,10 +2448,16 @@</span> 	pool = New(config, blockchain)
 	pool.Init(config.PriceLimit, blockchain.CurrentBlock(), makeAddressReserver())
&nbsp;
 	pending, queued = pool.Stats()
<span class="term-fg31">-	if pending != 0 {</span>
<span class="term-fg31">-		t.Fatalf(&quot;pending transactions mismatched: have %d, want %d&quot;, pending, 0)</span>
<span class="term-fg32">+	if journalRemotes {</span>
<span class="term-fg32">+		if pending != 1 { &#47;&#47; Remove the 2 replaced local transactions, but preserve the remote</span>
<span class="term-fg32">+			t.Fatalf(&quot;pending transactions mismatched: have %d, want %d&quot;, pending, 1)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	} else {</span>
<span class="term-fg32">+		if pending != 0 {</span>
<span class="term-fg32">+			t.Fatalf(&quot;pending transactions mismatched: have %d, want %d&quot;, pending, 0)</span>
<span class="term-fg32">+		}</span>
 	}
<span class="term-fg31">-	if nolocals {</span>
<span class="term-fg32">+	if nolocals &amp;&amp; !journalRemotes {</span>
 		if queued != 0 {
 			t.Fatalf(&quot;queued transactions mismatched: have %d, want %d&quot;, queued, 0)
 		}</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-65339f26be08386cc17aa0f6" role="button"
                       aria-expanded="false" aria-controls="id-65339f26be08386cc17aa0f6">
                        <code>core/txpool/legacypool/list.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/core/txpool/legacypool/list.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/core/txpool/legacypool/list.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+16</span></div>
                            <div class="text-start"><span class="text-danger">-2</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-65339f26be08386cc17aa0f6"><span class="term-fg1">diff --git go-ethereum&#47;core&#47;txpool&#47;legacypool&#47;list.go op-geth&#47;core&#47;txpool&#47;legacypool&#47;list.go</span>
<span class="term-fg1">index b749db44d45e74b389f671e69dd5c9e3df3a6123..24b18d2273252af4115825c94aaf6f9d8904dd1f 100644</span>
<span class="term-fg1">--- go-ethereum&#47;core&#47;txpool&#47;legacypool&#47;list.go</span>
<span class="term-fg1">+++ op-geth&#47;core&#47;txpool&#47;legacypool&#47;list.go</span>
<span class="term-fg36">@@ -27,6 +27,7 @@</span> 	&quot;sync&#47;atomic&quot;
 	&quot;time&quot;
&nbsp;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&quot;
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&#47;txpool&quot;</span>
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&#47;types&quot;
 	&quot;github.com&#47;holiman&#47;uint256&quot;
 )
<span class="term-fg36">@@ -265,6 +266,15 @@</span> 	cache := m.flatten()
 	return cache[len(cache)-1]
 }
&nbsp;
<span class="term-fg32">+&#47;&#47; FirstElement returns the first element from the heap (guaranteed to be lowest), thus, the</span>
<span class="term-fg32">+&#47;&#47; transaction with the lowest nonce. Returns nil if there are no elements.</span>
<span class="term-fg32">+func (m *sortedMap) FirstElement() *types.Transaction {</span>
<span class="term-fg32">+	if m.Len() == 0 {</span>
<span class="term-fg32">+		return nil</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	return m.Get((*m.index)[0])</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
 &#47;&#47; list is a &quot;list&quot; of transactions belonging to an account, sorted by account
 &#47;&#47; nonce. The same type can be used both for storing contiguous transactions for
 &#47;&#47; the executable&#47;pending queue; and for storing gapped transactions for the non-
<span class="term-fg36">@@ -300,7 +310,7 @@</span> &#47;&#47; transaction was accepted, and if yes, any previous transaction it replaced.
 &#47;&#47;
 &#47;&#47; If the new transaction is accepted into the list, the lists&#39; cost and gas
 &#47;&#47; thresholds are also potentially updated.
<span class="term-fg31">-func (l *list) Add(tx *types.Transaction, priceBump uint64) (bool, *types.Transaction) {</span>
<span class="term-fg32">+func (l *list) Add(tx *types.Transaction, priceBump uint64, l1CostFn txpool.L1CostFunc) (bool, *types.Transaction) {</span>
 	&#47;&#47; If there&#39;s an older better transaction, abort
 	old := l.txs.Get(tx.Nonce())
 	if old != nil {
<span class="term-fg36">@@ -332,7 +342,11 @@</span> 	if overflow {
 		return false, nil
 	}
 	l.totalcost.Add(l.totalcost, cost)
<span class="term-fg31">-</span>
<span class="term-fg32">+	if l1CostFn != nil {</span>
<span class="term-fg32">+		if l1Cost := l1CostFn(tx.RollupCostData()); l1Cost != nil { &#47;&#47; add rollup cost</span>
<span class="term-fg32">+			l.totalcost.Add(l.totalcost, cost)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
 	&#47;&#47; Otherwise overwrite the old transaction with the current one
 	l.txs.Put(tx)
 	if l.costcap.Cmp(cost) &lt; 0 {</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-77d4dc4eec15c6454e347489" role="button"
                       aria-expanded="false" aria-controls="id-77d4dc4eec15c6454e347489">
                        <code>core/txpool/legacypool/list_test.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/core/txpool/legacypool/list_test.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/core/txpool/legacypool/list_test.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+4</span></div>
                            <div class="text-start"><span class="text-danger">-4</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-77d4dc4eec15c6454e347489"><span class="term-fg1">diff --git go-ethereum&#47;core&#47;txpool&#47;legacypool&#47;list_test.go op-geth&#47;core&#47;txpool&#47;legacypool&#47;list_test.go</span>
<span class="term-fg1">index 8587c66f7d22a07f5776d7e25f90499eddc239cc..9f341a7f2026a9ef79944f542fbde08d558c21e2 100644</span>
<span class="term-fg1">--- go-ethereum&#47;core&#47;txpool&#47;legacypool&#47;list_test.go</span>
<span class="term-fg1">+++ op-geth&#47;core&#47;txpool&#47;legacypool&#47;list_test.go</span>
<span class="term-fg36">@@ -40,7 +40,7 @@</span> 	}
 	&#47;&#47; Insert the transactions in a random order
 	list := newList(true)
 	for _, v := range rand.Perm(len(txs)) {
<span class="term-fg31">-		list.Add(txs[v], DefaultConfig.PriceBump)</span>
<span class="term-fg32">+		list.Add(txs[v], DefaultConfig.PriceBump, nil)</span>
 	}
 	&#47;&#47; Verify internal state
 	if len(list.txs.items) != len(txs) {
<span class="term-fg36">@@ -64,7 +64,7 @@</span> 		gasprice, _ := new(big.Int).SetString(&quot;0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff&quot;, 0)
 		gaslimit := uint64(i)
 		tx, _ := types.SignTx(types.NewTransaction(uint64(i), common.Address{}, value, gaslimit, gasprice, nil), types.HomesteadSigner{}, key)
 		t.Logf(&quot;cost: %x bitlen: %d\n&quot;, tx.Cost(), tx.Cost().BitLen())
<span class="term-fg31">-		list.Add(tx, DefaultConfig.PriceBump)</span>
<span class="term-fg32">+		list.Add(tx, DefaultConfig.PriceBump, nil)</span>
 	}
 }
&nbsp;
<span class="term-fg36">@@ -82,7 +82,7 @@</span> 	b.ResetTimer()
 	for i := 0; i &lt; b.N; i++ {
 		list := newList(true)
 		for _, v := range rand.Perm(len(txs)) {
<span class="term-fg31">-			list.Add(txs[v], DefaultConfig.PriceBump)</span>
<span class="term-fg32">+			list.Add(txs[v], DefaultConfig.PriceBump, nil)</span>
 			list.Filter(priceLimit, DefaultConfig.PriceBump)
 		}
 	}
<span class="term-fg36">@@ -102,7 +102,7 @@</span> 	for i := 0; i &lt; b.N; i++ {
 		list := newList(true)
 		&#47;&#47; Insert the transactions in a random order
 		for _, v := range rand.Perm(len(txs)) {
<span class="term-fg31">-			list.Add(txs[v], DefaultConfig.PriceBump)</span>
<span class="term-fg32">+			list.Add(txs[v], DefaultConfig.PriceBump, nil)</span>
 		}
 		b.StartTimer()
 		list.Cap(list.Len() - 1)</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-8c386abbce7f52d368f78aa7" role="button"
                       aria-expanded="false" aria-controls="id-8c386abbce7f52d368f78aa7">
                        <code>core/txpool/txpool.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/core/txpool/txpool.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/core/txpool/txpool.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+2</span></div>
                            <div class="text-start"><span class="text-danger">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-8c386abbce7f52d368f78aa7"><span class="term-fg1">diff --git go-ethereum&#47;core&#47;txpool&#47;txpool.go op-geth&#47;core&#47;txpool&#47;txpool.go</span>
<span class="term-fg1">index be7435247d92749027ccbee4e92f0d44153b4a4b..ff31ffc200643fa203b16a4ce20321061fc7da90 100644</span>
<span class="term-fg1">--- go-ethereum&#47;core&#47;txpool&#47;txpool.go</span>
<span class="term-fg1">+++ op-geth&#47;core&#47;txpool&#47;txpool.go</span>
<span class="term-fg36">@@ -30,6 +30,8 @@</span> 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;log&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;metrics&quot;
 )
&nbsp;
<span class="term-fg32">+type L1CostFunc func(dataGas types.RollupCostData) *big.Int</span>
<span class="term-fg32">+</span>
 &#47;&#47; TxStatus is the current status of a transaction as seen by the pool.
 type TxStatus uint
</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-6d6c7c18f6b477629536b327" role="button"
                       aria-expanded="false" aria-controls="id-6d6c7c18f6b477629536b327">
                        <code>core/txpool/validation.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/core/txpool/validation.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/core/txpool/validation.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+39</span></div>
                            <div class="text-start"><span class="text-danger">-1</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-6d6c7c18f6b477629536b327"><span class="term-fg1">diff --git go-ethereum&#47;core&#47;txpool&#47;validation.go op-geth&#47;core&#47;txpool&#47;validation.go</span>
<span class="term-fg1">index 555b777505cf378555111fee11e76911f991ad8b..630bae3fcd55bba2a1cc094961723a6cd51128e8 100644</span>
<span class="term-fg1">--- go-ethereum&#47;core&#47;txpool&#47;validation.go</span>
<span class="term-fg1">+++ op-geth&#47;core&#47;txpool&#47;validation.go</span>
<span class="term-fg36">@@ -31,12 +31,31 @@</span> 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;log&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;params&quot;
 )
&nbsp;
<span class="term-fg32">+&#47;&#47; L1 Info Gas Overhead is the amount of gas the the L1 info deposit consumes.</span>
<span class="term-fg32">+&#47;&#47; It is removed from the tx pool max gas to better indicate that L2 transactions</span>
<span class="term-fg32">+&#47;&#47; are not able to consume all of the gas in a L2 block as the L1 info deposit is always present.</span>
<span class="term-fg32">+const l1InfoGasOverhead = uint64(70_000)</span>
<span class="term-fg32">+</span>
 var (
 	&#47;&#47; blobTxMinBlobGasPrice is the big.Int version of the configured protocol
 	&#47;&#47; parameter to avoid constructing a new big integer for every transaction.
 	blobTxMinBlobGasPrice = big.NewInt(params.BlobTxMinBlobGasprice)
 )
&nbsp;
<span class="term-fg32">+func EffectiveGasLimit(chainConfig *params.ChainConfig, gasLimit uint64, effectiveLimit uint64) uint64 {</span>
<span class="term-fg32">+	if effectiveLimit != 0 &amp;&amp; effectiveLimit &lt; gasLimit {</span>
<span class="term-fg32">+		gasLimit = effectiveLimit</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if chainConfig.Optimism != nil {</span>
<span class="term-fg32">+		if l1InfoGasOverhead &lt; gasLimit {</span>
<span class="term-fg32">+			gasLimit -= l1InfoGasOverhead</span>
<span class="term-fg32">+		} else {</span>
<span class="term-fg32">+			gasLimit = 0</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	return gasLimit</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
 &#47;&#47; ValidationOptions define certain differences between transaction validation
 &#47;&#47; across the different pools without having to duplicate those checks.
 type ValidationOptions struct {
<span class="term-fg36">@@ -45,6 +64,8 @@</span>
 	Accept  uint8    &#47;&#47; Bitmap of transaction types that should be accepted for the calling pool
 	MaxSize uint64   &#47;&#47; Maximum size of a transaction that the caller can meaningfully handle
 	MinTip  *big.Int &#47;&#47; Minimum gas tip needed to allow a transaction into the caller pool
<span class="term-fg32">+</span>
<span class="term-fg32">+	EffectiveGasCeil uint64 &#47;&#47; if non-zero, a gas ceiling to enforce independent of the header&#39;s gaslimit value</span>
 }
&nbsp;
 &#47;&#47; ValidateTransaction is a helper method to check whether a transaction is valid
<span class="term-fg36">@@ -54,6 +75,15 @@</span> &#47;&#47;
 &#47;&#47; This check is public to allow different transaction pools to check the basic
 &#47;&#47; rules without duplicating code and running the risk of missed updates.
 func ValidateTransaction(tx *types.Transaction, head *types.Header, signer types.Signer, opts *ValidationOptions) error {
<span class="term-fg32">+	&#47;&#47; No unauthenticated deposits allowed in the transaction pool.</span>
<span class="term-fg32">+	&#47;&#47; This is for spam protection, not consensus,</span>
<span class="term-fg32">+	&#47;&#47; as the external engine-API user authenticates deposits.</span>
<span class="term-fg32">+	if tx.Type() == types.DepositTxType {</span>
<span class="term-fg32">+		return core.ErrTxTypeNotSupported</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if opts.Config.IsOptimism() &amp;&amp; tx.Type() == types.BlobTxType {</span>
<span class="term-fg32">+		return core.ErrTxTypeNotSupported</span>
<span class="term-fg32">+	}</span>
 	&#47;&#47; Ensure transactions not implemented by the calling pool are rejected
 	if opts.Accept&amp;(1&lt;&lt;tx.Type()) == 0 {
 		return fmt.Errorf(&quot;%w: tx type %v not supported by this pool&quot;, core.ErrTxTypeNotSupported, tx.Type())
<span class="term-fg36">@@ -83,7 +113,7 @@</span> 	if tx.Value().Sign() &lt; 0 {
 		return ErrNegativeValue
 	}
 	&#47;&#47; Ensure the transaction doesn&#39;t exceed the current block limit gas
<span class="term-fg31">-	if head.GasLimit &lt; tx.Gas() {</span>
<span class="term-fg32">+	if EffectiveGasLimit(opts.Config, head.GasLimit, opts.EffectiveGasCeil) &lt; tx.Gas() {</span>
 		return ErrGasLimit
 	}
 	&#47;&#47; Sanity check for extremely large numbers (supported by RLP or RPC)
<span class="term-fg36">@@ -192,6 +222,9 @@</span>
 	&#47;&#47; ExistingCost is a mandatory callback to retrieve an already pooled
 	&#47;&#47; transaction&#39;s cost with the given nonce to check for overdrafts.
 	ExistingCost func(addr common.Address, nonce uint64) *big.Int
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; L1CostFn is an optional extension, to validate L1 rollup costs of a tx</span>
<span class="term-fg32">+	L1CostFn L1CostFunc</span>
 }
&nbsp;
 &#47;&#47; ValidateTransactionWithState is a helper method to check whether a transaction
<span class="term-fg36">@@ -222,6 +255,11 @@</span> 	var (
 		balance = opts.State.GetBalance(from).ToBig()
 		cost    = tx.Cost()
 	)
<span class="term-fg32">+	if opts.L1CostFn != nil {</span>
<span class="term-fg32">+		if l1Cost := opts.L1CostFn(tx.RollupCostData()); l1Cost != nil { &#47;&#47; add rollup cost</span>
<span class="term-fg32">+			cost = cost.Add(cost, l1Cost)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
 	if balance.Cmp(cost) &lt; 0 {
 		return fmt.Errorf(&quot;%w: balance %v, tx cost %v, overshot %v&quot;, core.ErrInsufficientFunds, balance, cost, new(big.Int).Sub(cost, balance))
 	}</div>
    </div>

            
            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-5da08df651f0c77f8d1f0390"role="button" aria-expanded="false" aria-controls="id-5da08df651f0c77f8d1f0390">
        
            <div class="col-12 col-md-12 col-lg-6 col-xl-6 text-start"><h3>RIP-7212</h3></div>
        

        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2">
            <div class="row line-stat">
                
                
            </div>
        </div>
        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2 ">
            <div class="row line-stat">
                
                    <div class="text-end"><span class="text-success">+148</span></div>
                    <div class="text-start"><span class="text-danger">-0</span></div>
                
                
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-5da08df651f0c77f8d1f0390">
        <div></div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-d1bd7173368777b9fb71fa69" role="button"
                       aria-expanded="false" aria-controls="id-d1bd7173368777b9fb71fa69">
                        <code>core/vm/contracts.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/core/vm/contracts.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/core/vm/contracts.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+98</span></div>
                            <div class="text-start"><span class="text-danger">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-d1bd7173368777b9fb71fa69"><span class="term-fg1">diff --git go-ethereum&#47;core&#47;vm&#47;contracts.go op-geth&#47;core&#47;vm&#47;contracts.go</span>
<span class="term-fg1">index dd71a9729f348156083907effb3f9e1bcf001dba..6f894790feaf2e29c5909be545f7dccb4e33aeb5 100644</span>
<span class="term-fg1">--- go-ethereum&#47;core&#47;vm&#47;contracts.go</span>
<span class="term-fg1">+++ op-geth&#47;core&#47;vm&#47;contracts.go</span>
<span class="term-fg36">@@ -34,6 +34,7 @@</span> 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;crypto&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;crypto&#47;blake2b&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;crypto&#47;bn256&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;crypto&#47;kzg4844&quot;
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;crypto&#47;secp256r1&quot;</span>
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;params&quot;
 	&quot;golang.org&#47;x&#47;crypto&#47;ripemd160&quot;
 )
<span class="term-fg36">@@ -139,7 +140,41 @@</span> var PrecompiledContractsBLS = PrecompiledContractsPrague
&nbsp;
 var PrecompiledContractsVerkle = PrecompiledContractsPrague
&nbsp;
<span class="term-fg32">+&#47;&#47; PrecompiledContractsFjord contains the default set of pre-compiled Ethereum</span>
<span class="term-fg32">+&#47;&#47; contracts used in the Fjord release.</span>
<span class="term-fg32">+var PrecompiledContractsFjord = map[common.Address]PrecompiledContract{</span>
<span class="term-fg32">+	common.BytesToAddress([]byte{1}):          &amp;ecrecover{},</span>
<span class="term-fg32">+	common.BytesToAddress([]byte{2}):          &amp;sha256hash{},</span>
<span class="term-fg32">+	common.BytesToAddress([]byte{3}):          &amp;ripemd160hash{},</span>
<span class="term-fg32">+	common.BytesToAddress([]byte{4}):          &amp;dataCopy{},</span>
<span class="term-fg32">+	common.BytesToAddress([]byte{5}):          &amp;bigModExp{eip2565: true},</span>
<span class="term-fg32">+	common.BytesToAddress([]byte{6}):          &amp;bn256AddIstanbul{},</span>
<span class="term-fg32">+	common.BytesToAddress([]byte{7}):          &amp;bn256ScalarMulIstanbul{},</span>
<span class="term-fg32">+	common.BytesToAddress([]byte{8}):          &amp;bn256PairingIstanbul{},</span>
<span class="term-fg32">+	common.BytesToAddress([]byte{9}):          &amp;blake2F{},</span>
<span class="term-fg32">+	common.BytesToAddress([]byte{0x0a}):       &amp;kzgPointEvaluation{},</span>
<span class="term-fg32">+	common.BytesToAddress([]byte{0x01, 0x00}): &amp;p256Verify{},</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; PrecompiledContractsGranite contains the default set of pre-compiled Ethereum</span>
<span class="term-fg32">+&#47;&#47; contracts used in the Granite release.</span>
<span class="term-fg32">+var PrecompiledContractsGranite = map[common.Address]PrecompiledContract{</span>
<span class="term-fg32">+	common.BytesToAddress([]byte{1}):          &amp;ecrecover{},</span>
<span class="term-fg32">+	common.BytesToAddress([]byte{2}):          &amp;sha256hash{},</span>
<span class="term-fg32">+	common.BytesToAddress([]byte{3}):          &amp;ripemd160hash{},</span>
<span class="term-fg32">+	common.BytesToAddress([]byte{4}):          &amp;dataCopy{},</span>
<span class="term-fg32">+	common.BytesToAddress([]byte{5}):          &amp;bigModExp{eip2565: true},</span>
<span class="term-fg32">+	common.BytesToAddress([]byte{6}):          &amp;bn256AddIstanbul{},</span>
<span class="term-fg32">+	common.BytesToAddress([]byte{7}):          &amp;bn256ScalarMulIstanbul{},</span>
<span class="term-fg32">+	common.BytesToAddress([]byte{8}):          &amp;bn256PairingGranite{},</span>
<span class="term-fg32">+	common.BytesToAddress([]byte{9}):          &amp;blake2F{},</span>
<span class="term-fg32">+	common.BytesToAddress([]byte{0x0a}):       &amp;kzgPointEvaluation{},</span>
<span class="term-fg32">+	common.BytesToAddress([]byte{0x01, 0x00}): &amp;p256Verify{},</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
 var (
<span class="term-fg32">+	PrecompiledAddressesGranite   []common.Address</span>
<span class="term-fg32">+	PrecompiledAddressesFjord     []common.Address</span>
 	PrecompiledAddressesPrague    []common.Address
 	PrecompiledAddressesCancun    []common.Address
 	PrecompiledAddressesBerlin    []common.Address
<span class="term-fg36">@@ -167,11 +202,21 @@</span> 	}
 	for k := range PrecompiledContractsPrague {
 		PrecompiledAddressesPrague = append(PrecompiledAddressesPrague, k)
 	}
<span class="term-fg32">+	for k := range PrecompiledContractsFjord {</span>
<span class="term-fg32">+		PrecompiledAddressesFjord = append(PrecompiledAddressesFjord, k)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	for k := range PrecompiledContractsGranite {</span>
<span class="term-fg32">+		PrecompiledAddressesGranite = append(PrecompiledAddressesGranite, k)</span>
<span class="term-fg32">+	}</span>
 }
&nbsp;
 &#47;&#47; ActivePrecompiles returns the precompiles enabled with the current configuration.
 func ActivePrecompiles(rules params.Rules) []common.Address {
 	switch {
<span class="term-fg32">+	case rules.IsOptimismGranite:</span>
<span class="term-fg32">+		return PrecompiledAddressesGranite</span>
<span class="term-fg32">+	case rules.IsOptimismFjord:</span>
<span class="term-fg32">+		return PrecompiledAddressesFjord</span>
 	case rules.IsPrague:
 		return PrecompiledAddressesPrague
 	case rules.IsCancun:
<span class="term-fg36">@@ -550,6 +595,9 @@</span> 	false32Byte = make([]byte, 32)
&nbsp;
 	&#47;&#47; errBadPairingInput is returned if the bn256 pairing input is invalid.
 	errBadPairingInput = errors.New(&quot;bad elliptic curve pairing size&quot;)
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; errBadPairingInputSize is returned if the bn256 pairing input size is invalid.</span>
<span class="term-fg32">+	errBadPairingInputSize = errors.New(&quot;bad elliptic curve pairing input size&quot;)</span>
 )
&nbsp;
 &#47;&#47; runBn256Pairing implements the Bn256Pairing precompile, referenced by both
<span class="term-fg36">@@ -583,6 +631,22 @@</span> 	}
 	return false32Byte, nil
 }
&nbsp;
<span class="term-fg32">+&#47;&#47; bn256PairingGranite implements a pairing pre-compile for the bn256 curve</span>
<span class="term-fg32">+&#47;&#47; conforming to Granite consensus rules.</span>
<span class="term-fg32">+type bn256PairingGranite struct{}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; RequiredGas returns the gas required to execute the pre-compiled contract.</span>
<span class="term-fg32">+func (c *bn256PairingGranite) RequiredGas(input []byte) uint64 {</span>
<span class="term-fg32">+	return new(bn256PairingIstanbul).RequiredGas(input)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (c *bn256PairingGranite) Run(input []byte) ([]byte, error) {</span>
<span class="term-fg32">+	if len(input) &gt; int(params.Bn256PairingMaxInputSizeGranite) {</span>
<span class="term-fg32">+		return nil, errBadPairingInputSize</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	return runBn256Pairing(input)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
 &#47;&#47; bn256PairingIstanbul implements a pairing pre-compile for the bn256 curve
 &#47;&#47; conforming to Istanbul consensus rules.
 type bn256PairingIstanbul struct{}
<span class="term-fg36">@@ -1223,3 +1287,37 @@</span> 	h[0] = blobCommitmentVersionKZG
&nbsp;
 	return h
 }
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; P256VERIFY (secp256r1 signature verification)</span>
<span class="term-fg32">+&#47;&#47; implemented as a native contract</span>
<span class="term-fg32">+type p256Verify struct{}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; RequiredGas returns the gas required to execute the precompiled contract</span>
<span class="term-fg32">+func (c *p256Verify) RequiredGas(input []byte) uint64 {</span>
<span class="term-fg32">+	return params.P256VerifyGas</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; Run executes the precompiled contract with given 160 bytes of param, returning the output and the used gas</span>
<span class="term-fg32">+func (c *p256Verify) Run(input []byte) ([]byte, error) {</span>
<span class="term-fg32">+	&#47;&#47; Required input length is 160 bytes</span>
<span class="term-fg32">+	const p256VerifyInputLength = 160</span>
<span class="term-fg32">+	&#47;&#47; Check the input length</span>
<span class="term-fg32">+	if len(input) != p256VerifyInputLength {</span>
<span class="term-fg32">+		&#47;&#47; Input length is invalid</span>
<span class="term-fg32">+		return nil, nil</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Extract the hash, r, s, x, y from the input</span>
<span class="term-fg32">+	hash := input[0:32]</span>
<span class="term-fg32">+	r, s := new(big.Int).SetBytes(input[32:64]), new(big.Int).SetBytes(input[64:96])</span>
<span class="term-fg32">+	x, y := new(big.Int).SetBytes(input[96:128]), new(big.Int).SetBytes(input[128:160])</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Verify the secp256r1 signature</span>
<span class="term-fg32">+	if secp256r1.Verify(hash, r, s, x, y) {</span>
<span class="term-fg32">+		&#47;&#47; Signature is valid</span>
<span class="term-fg32">+		return common.LeftPadBytes([]byte{1}, 32), nil</span>
<span class="term-fg32">+	} else {</span>
<span class="term-fg32">+		&#47;&#47; Signature is invalid</span>
<span class="term-fg32">+		return nil, nil</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-600aaf304720b1e23e9221b6" role="button"
                       aria-expanded="false" aria-controls="id-600aaf304720b1e23e9221b6">
                        <code>core/vm/interpreter.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/core/vm/interpreter.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/core/vm/interpreter.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+7</span></div>
                            <div class="text-start"><span class="text-danger">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-600aaf304720b1e23e9221b6"><span class="term-fg1">diff --git go-ethereum&#47;core&#47;vm&#47;interpreter.go op-geth&#47;core&#47;vm&#47;interpreter.go</span>
<span class="term-fg1">index 2b1ea384835298a30a9de1229f4818a875cd4080..8beaad99cec587dff8e358cc2e775fe7edbc7793 100644</span>
<span class="term-fg1">--- go-ethereum&#47;core&#47;vm&#47;interpreter.go</span>
<span class="term-fg1">+++ op-geth&#47;core&#47;vm&#47;interpreter.go</span>
<span class="term-fg36">@@ -24,9 +24,14 @@</span> 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&#47;math&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&#47;tracing&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;crypto&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;log&quot;
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;params&quot;</span>
 	&quot;github.com&#47;holiman&#47;uint256&quot;
 )
&nbsp;
<span class="term-fg32">+&#47;&#47; PrecompileOverrides is a function that can be used to override the default precompiled contracts</span>
<span class="term-fg32">+&#47;&#47; Nil is returned when there is no precompile. The original is returned if the existing precompile should run.</span>
<span class="term-fg32">+type PrecompileOverrides func(rules params.Rules, original PrecompiledContract, addr common.Address) PrecompiledContract</span>
<span class="term-fg32">+</span>
 &#47;&#47; Config are the configuration options for the Interpreter
 type Config struct {
 	Tracer                  *tracing.Hooks
<span class="term-fg36">@@ -34,6 +39,8 @@</span> 	NoBaseFee               bool  &#47;&#47; Forces the EIP-1559 baseFee to 0 (needed for 0 price calls)
 	EnablePreimageRecording bool  &#47;&#47; Enables recording of SHA3&#47;keccak preimages
 	ExtraEips               []int &#47;&#47; Additional EIPS that are to be enabled
 	EnableWitnessCollection bool  &#47;&#47; true if witness collection is enabled
<span class="term-fg32">+</span>
<span class="term-fg32">+	PrecompileOverrides PrecompileOverrides &#47;&#47; Precompiles can be swapped &#47; changed &#47; wrapped as needed</span>
 }
&nbsp;
 &#47;&#47; ScopeContext contains the things that are per-call, such as stack and memory,</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-ffb615af4e71e44e0095e8c7" role="button"
                       aria-expanded="false" aria-controls="id-ffb615af4e71e44e0095e8c7">
                        <code>crypto/secp256r1/publickey.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/crypto/secp256r1/publickey.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+21</span></div>
                            <div class="text-start"><span class="text-danger">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-ffb615af4e71e44e0095e8c7"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256r1&#47;publickey.go op-geth&#47;crypto&#47;secp256r1&#47;publickey.go</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..885a3e1a624b85310225913c44d294e402a50fcd</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ op-geth&#47;crypto&#47;secp256r1&#47;publickey.go</span>
<span class="term-fg36">@@ -0,0 +1,21 @@</span>
<span class="term-fg32">+package secp256r1</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+import (</span>
<span class="term-fg32">+	&quot;crypto&#47;ecdsa&quot;</span>
<span class="term-fg32">+	&quot;crypto&#47;elliptic&quot;</span>
<span class="term-fg32">+	&quot;math&#47;big&quot;</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; Generates appropriate public key format from given coordinates</span>
<span class="term-fg32">+func newPublicKey(x, y *big.Int) *ecdsa.PublicKey {</span>
<span class="term-fg32">+	&#47;&#47; Check if the given coordinates are valid</span>
<span class="term-fg32">+	if x == nil || y == nil || !elliptic.P256().IsOnCurve(x, y) {</span>
<span class="term-fg32">+		return nil</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	return &amp;ecdsa.PublicKey{</span>
<span class="term-fg32">+		Curve: elliptic.P256(),</span>
<span class="term-fg32">+		X:     x,</span>
<span class="term-fg32">+		Y:     y,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-f247e74471485ebe570e214a" role="button"
                       aria-expanded="false" aria-controls="id-f247e74471485ebe570e214a">
                        <code>crypto/secp256r1/verifier.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/crypto/secp256r1/verifier.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+22</span></div>
                            <div class="text-start"><span class="text-danger">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-f247e74471485ebe570e214a"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256r1&#47;verifier.go op-geth&#47;crypto&#47;secp256r1&#47;verifier.go</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..ffb4839d8d560a5892175c737bff136d73ee6e12</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ op-geth&#47;crypto&#47;secp256r1&#47;verifier.go</span>
<span class="term-fg36">@@ -0,0 +1,22 @@</span>
<span class="term-fg32">+package secp256r1</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+import (</span>
<span class="term-fg32">+	&quot;crypto&#47;ecdsa&quot;</span>
<span class="term-fg32">+	&quot;math&#47;big&quot;</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; Verify verifies the given signature (r, s) for the given hash and public key (x, y).</span>
<span class="term-fg32">+&#47;&#47; It returns true if the signature is valid, false otherwise.</span>
<span class="term-fg32">+func Verify(hash []byte, r, s, x, y *big.Int) bool {</span>
<span class="term-fg32">+	&#47;&#47; Create the public key format</span>
<span class="term-fg32">+	publicKey := newPublicKey(x, y)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Check if they are invalid public key coordinates</span>
<span class="term-fg32">+	if publicKey == nil {</span>
<span class="term-fg32">+		return false</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Verify the signature with the public key,</span>
<span class="term-fg32">+	&#47;&#47; then return true if it&#39;s valid, false otherwise</span>
<span class="term-fg32">+	return ecdsa.Verify(publicKey, hash, r, s)</span>
<span class="term-fg32">+}</span></div>
    </div>

            
            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
        </div>
    </div>
</div>

            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-454341792bcc6533d5139173"role="button" aria-expanded="false" aria-controls="id-454341792bcc6533d5139173">
        
            <div class="col-12 col-md-12 col-lg-6 col-xl-6 text-start"><h2>Chain Configuration</h2></div>
        

        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2">
            <div class="row line-stat">
                
                
            </div>
        </div>
        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2 ">
            <div class="row line-stat">
                
                    <div class="text-end"><span class="text-success">+707</span></div>
                    <div class="text-start"><span class="text-danger">-15</span></div>
                
                
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-454341792bcc6533d5139173">
        <div></div>
        <div>
            
            
        </div>
        <div>
            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-a41979033eab52d7753ebd69"role="button" aria-expanded="false" aria-controls="id-a41979033eab52d7753ebd69">
        
            <div class="col-12 col-md-12 col-lg-6 col-xl-6 text-start"><h3>Chain config</h3></div>
        

        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2">
            <div class="row line-stat">
                
                
            </div>
        </div>
        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2 ">
            <div class="row line-stat">
                
                    <div class="text-end"><span class="text-success">+317</span></div>
                    <div class="text-start"><span class="text-danger">-15</span></div>
                
                
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-a41979033eab52d7753ebd69">
        <div><p>The rollup functionality is enabled with the <code>optimism</code> field in the chain config.
The EIP-1559 parameters are configurable to adjust for faster more frequent and smaller blocks.
The parameters can be overriden for testing.</p>
</div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-2374a8bcd8f38a5575a82f4e" role="button"
                       aria-expanded="false" aria-controls="id-2374a8bcd8f38a5575a82f4e">
                        <code>core/genesis.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/core/genesis.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/core/genesis.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+84</span></div>
                            <div class="text-start"><span class="text-danger">-4</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-2374a8bcd8f38a5575a82f4e"><span class="term-fg1">diff --git go-ethereum&#47;core&#47;genesis.go op-geth&#47;core&#47;genesis.go</span>
<span class="term-fg1">index 4ca24807fccd0a319e627b78fce920ebd07bf9d0..a7dfef07f5e8a95c4dda985b9f781834884d3d37 100644</span>
<span class="term-fg1">--- go-ethereum&#47;core&#47;genesis.go</span>
<span class="term-fg1">+++ op-geth&#47;core&#47;genesis.go</span>
<span class="term-fg36">@@ -24,6 +24,8 @@</span> 	&quot;fmt&quot;
 	&quot;math&#47;big&quot;
 	&quot;strings&quot;
&nbsp;
<span class="term-fg32">+	&quot;github.com&#47;ethereum-optimism&#47;superchain-registry&#47;superchain&quot;</span>
<span class="term-fg32">+</span>
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&#47;hexutil&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&#47;math&quot;
<span class="term-fg36">@@ -73,6 +75,11 @@</span> 	ParentHash    common.Hash `json:&quot;parentHash&quot;`
 	BaseFee       *big.Int    `json:&quot;baseFeePerGas&quot;` &#47;&#47; EIP-1559
 	ExcessBlobGas *uint64     `json:&quot;excessBlobGas&quot;` &#47;&#47; EIP-4844
 	BlobGasUsed   *uint64     `json:&quot;blobGasUsed&quot;`   &#47;&#47; EIP-4844
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; StateHash represents the genesis state, to allow instantiation of a chain with missing initial state.</span>
<span class="term-fg32">+	&#47;&#47; Chains with history pruning, or extraordinarily large genesis allocation (e.g. after a regenesis event)</span>
<span class="term-fg32">+	&#47;&#47; may utilize this to get started, and then state-sync the latest state, while still verifying the header chain.</span>
<span class="term-fg32">+	StateHash *common.Hash `json:&quot;stateHash,omitempty&quot;`</span>
 }
&nbsp;
 func ReadGenesis(db ethdb.Database) (*Genesis, error) {
<span class="term-fg36">@@ -109,6 +116,10 @@</span> 	genesis.Coinbase = genesisHeader.Coinbase
 	genesis.BaseFee = genesisHeader.BaseFee
 	genesis.ExcessBlobGas = genesisHeader.ExcessBlobGas
 	genesis.BlobGasUsed = genesisHeader.BlobGasUsed
<span class="term-fg32">+	if genesis.Alloc == nil {</span>
<span class="term-fg32">+		h := genesisHeader.Hash()</span>
<span class="term-fg32">+		genesis.StateHash = &amp;h</span>
<span class="term-fg32">+	}</span>
&nbsp;
 	return &amp;genesis, nil
 }
<span class="term-fg36">@@ -246,6 +257,14 @@</span> &#47;&#47; ChainOverrides contains the changes to chain config.
 type ChainOverrides struct {
 	OverrideCancun *uint64
 	OverrideVerkle *uint64
<span class="term-fg32">+	&#47;&#47; optimism</span>
<span class="term-fg32">+	OverrideOptimismCanyon   *uint64</span>
<span class="term-fg32">+	OverrideOptimismEcotone  *uint64</span>
<span class="term-fg32">+	OverrideOptimismFjord    *uint64</span>
<span class="term-fg32">+	OverrideOptimismGranite  *uint64</span>
<span class="term-fg32">+	OverrideOptimismHolocene *uint64</span>
<span class="term-fg32">+	OverrideOptimismInterop  *uint64</span>
<span class="term-fg32">+	ApplySuperchainUpgrades  bool</span>
 }
&nbsp;
 &#47;&#47; SetupGenesisBlock writes or updates the genesis block in db.
<span class="term-fg36">@@ -271,12 +290,57 @@</span> 		return params.AllEthashProtocolChanges, common.Hash{}, errGenesisNoConfig
 	}
 	applyOverrides := func(config *params.ChainConfig) {
 		if config != nil {
<span class="term-fg32">+			&#47;&#47; If applying the superchain-registry to a known OP-Stack chain,</span>
<span class="term-fg32">+			&#47;&#47; then override the local chain-config with that from the registry.</span>
<span class="term-fg32">+			if overrides != nil &amp;&amp; overrides.ApplySuperchainUpgrades &amp;&amp; config.IsOptimism() &amp;&amp; config.ChainID != nil &amp;&amp; config.ChainID.IsUint64() {</span>
<span class="term-fg32">+				if _, ok := superchain.OPChains[config.ChainID.Uint64()]; ok {</span>
<span class="term-fg32">+					conf, err := params.LoadOPStackChainConfig(config.ChainID.Uint64())</span>
<span class="term-fg32">+					if err != nil {</span>
<span class="term-fg32">+						log.Warn(&quot;failed to load chain config from superchain-registry, skipping override&quot;, &quot;err&quot;, err, &quot;chain_id&quot;, config.ChainID)</span>
<span class="term-fg32">+					} else {</span>
<span class="term-fg32">+						*config = *conf</span>
<span class="term-fg32">+					}</span>
<span class="term-fg32">+				}</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+			if config.IsOptimism() &amp;&amp; config.ChainID != nil &amp;&amp; config.ChainID.Cmp(big.NewInt(params.OPGoerliChainID)) == 0 {</span>
<span class="term-fg32">+				&#47;&#47; Apply Optimism Goerli regolith time</span>
<span class="term-fg32">+				config.RegolithTime = &amp;params.OptimismGoerliRegolithTime</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+			if config.IsOptimism() &amp;&amp; config.ChainID != nil &amp;&amp; config.ChainID.Cmp(big.NewInt(params.BaseGoerliChainID)) == 0 {</span>
<span class="term-fg32">+				&#47;&#47; Apply Base Goerli regolith time</span>
<span class="term-fg32">+				config.RegolithTime = &amp;params.BaseGoerliRegolithTime</span>
<span class="term-fg32">+			}</span>
 			if overrides != nil &amp;&amp; overrides.OverrideCancun != nil {
 				config.CancunTime = overrides.OverrideCancun
 			}
 			if overrides != nil &amp;&amp; overrides.OverrideVerkle != nil {
 				config.VerkleTime = overrides.OverrideVerkle
 			}
<span class="term-fg32">+			if overrides != nil &amp;&amp; overrides.OverrideOptimismCanyon != nil {</span>
<span class="term-fg32">+				config.CanyonTime = overrides.OverrideOptimismCanyon</span>
<span class="term-fg32">+				config.ShanghaiTime = overrides.OverrideOptimismCanyon</span>
<span class="term-fg32">+				if config.Optimism != nil &amp;&amp; (config.Optimism.EIP1559DenominatorCanyon == nil || *config.Optimism.EIP1559DenominatorCanyon == 0) {</span>
<span class="term-fg32">+					eip1559DenominatorCanyon := uint64(250)</span>
<span class="term-fg32">+					config.Optimism.EIP1559DenominatorCanyon = &amp;eip1559DenominatorCanyon</span>
<span class="term-fg32">+				}</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+			if overrides != nil &amp;&amp; overrides.OverrideOptimismEcotone != nil {</span>
<span class="term-fg32">+				config.EcotoneTime = overrides.OverrideOptimismEcotone</span>
<span class="term-fg32">+				config.CancunTime = overrides.OverrideOptimismEcotone</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+			if overrides != nil &amp;&amp; overrides.OverrideOptimismFjord != nil {</span>
<span class="term-fg32">+				config.FjordTime = overrides.OverrideOptimismFjord</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+			if overrides != nil &amp;&amp; overrides.OverrideOptimismGranite != nil {</span>
<span class="term-fg32">+				config.GraniteTime = overrides.OverrideOptimismGranite</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+			if overrides != nil &amp;&amp; overrides.OverrideOptimismHolocene != nil {</span>
<span class="term-fg32">+				config.HoloceneTime = overrides.OverrideOptimismHolocene</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+			if overrides != nil &amp;&amp; overrides.OverrideOptimismInterop != nil {</span>
<span class="term-fg32">+				config.InteropTime = overrides.OverrideOptimismInterop</span>
<span class="term-fg32">+			}</span>
 		}
 	}
 	&#47;&#47; Just commit the new block if there is no stored genesis block.
<span class="term-fg36">@@ -300,8 +364,13 @@</span> 	&#47;&#47; The genesis block is present(perhaps in ancient database) while the
 	&#47;&#47; state database is not initialized yet. It can happen that the node
 	&#47;&#47; is initialized with an external ancient store. Commit genesis state
 	&#47;&#47; in this case.
<span class="term-fg32">+	&#47;&#47; If the bedrock block is not 0, that implies that the network was migrated at the bedrock block.</span>
<span class="term-fg32">+	&#47;&#47; In this case the genesis state may not be in the state database (e.g. op-geth is performing a snap</span>
<span class="term-fg32">+	&#47;&#47; sync without an existing datadir) &amp; even if it were, would not be useful as op-geth is not able to</span>
<span class="term-fg32">+	&#47;&#47; execute the pre-bedrock STF.</span>
 	header := rawdb.ReadHeader(db, stored, 0)
<span class="term-fg31">-	if header.Root != types.EmptyRootHash &amp;&amp; !triedb.Initialized(header.Root) {</span>
<span class="term-fg32">+	transitionedNetwork := genesis != nil &amp;&amp; genesis.Config != nil &amp;&amp; genesis.Config.BedrockBlock != nil &amp;&amp; genesis.Config.BedrockBlock.Uint64() != 0</span>
<span class="term-fg32">+	if header.Root != types.EmptyRootHash &amp;&amp; !triedb.Initialized(header.Root) &amp;&amp; !transitionedNetwork {</span>
 		if genesis == nil {
 			genesis = DefaultGenesisBlock()
 		}
<span class="term-fg36">@@ -353,7 +422,11 @@</span> 	head := rawdb.ReadHeadHeader(db)
 	if head == nil {
 		return newcfg, stored, errors.New(&quot;missing head header&quot;)
 	}
<span class="term-fg31">-	compatErr := storedcfg.CheckCompatible(newcfg, head.Number.Uint64(), head.Time)</span>
<span class="term-fg32">+	var genesisTimestamp *uint64</span>
<span class="term-fg32">+	if genesis != nil {</span>
<span class="term-fg32">+		genesisTimestamp = &amp;genesis.Timestamp</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	compatErr := storedcfg.CheckCompatible(newcfg, head.Number.Uint64(), head.Time, genesisTimestamp)</span>
 	if compatErr != nil &amp;&amp; ((head.Number.Uint64() != 0 &amp;&amp; compatErr.RewindToBlock != 0) || (head.Time != 0 &amp;&amp; compatErr.RewindToTime != 0)) {
 		return newcfg, stored, compatErr
 	}
<span class="term-fg36">@@ -422,8 +495,15 @@</span> }
&nbsp;
 &#47;&#47; ToBlock returns the genesis block according to genesis specification.
 func (g *Genesis) ToBlock() *types.Block {
<span class="term-fg31">-	root, err := hashAlloc(&amp;g.Alloc, g.IsVerkle())</span>
<span class="term-fg31">-	if err != nil {</span>
<span class="term-fg32">+	var root common.Hash</span>
<span class="term-fg32">+	var err error</span>
<span class="term-fg32">+	if g.StateHash != nil {</span>
<span class="term-fg32">+		if len(g.Alloc) &gt; 0 {</span>
<span class="term-fg32">+			panic(fmt.Errorf(&quot;cannot both have genesis hash %s &quot;+</span>
<span class="term-fg32">+				&quot;and non-empty state-allocation&quot;, *g.StateHash))</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		root = *g.StateHash</span>
<span class="term-fg32">+	} else if root, err = hashAlloc(&amp;g.Alloc, g.IsVerkle()); err != nil {</span>
 		panic(err)
 	}
 	head := &amp;types.Header{</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-f76f68e8e1fb974bdea94819" role="button"
                       aria-expanded="false" aria-controls="id-f76f68e8e1fb974bdea94819">
                        <code>params/config.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/params/config.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/params/config.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+222</span></div>
                            <div class="text-start"><span class="text-danger">-11</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-f76f68e8e1fb974bdea94819"><span class="term-fg1">diff --git go-ethereum&#47;params&#47;config.go op-geth&#47;params&#47;config.go</span>
<span class="term-fg1">index 871782399d14d337347a408d44d7d194ef11224a..e5ec0272f3a4e0c8f4bca155c8ee7980f91f7d2c 100644</span>
<span class="term-fg1">--- go-ethereum&#47;params&#47;config.go</span>
<span class="term-fg1">+++ op-geth&#47;params&#47;config.go</span>
<span class="term-fg36">@@ -32,6 +32,32 @@</span> 	SepoliaGenesisHash = common.HexToHash(&quot;0x25a5cc106eea7138acab33231d7160d69cb777ee0c2c553fcddf5138993e6dd9&quot;)
 	GoerliGenesisHash  = common.HexToHash(&quot;0xbf7e331f7f7c1dd2e05159666b3bf8bc7a8a3a9eb1d518969eab529dd9b88c1a&quot;)
 )
&nbsp;
<span class="term-fg32">+const (</span>
<span class="term-fg32">+	OPMainnetChainID        = 10</span>
<span class="term-fg32">+	OPGoerliChainID         = 420</span>
<span class="term-fg32">+	BaseMainnetChainID      = 8453</span>
<span class="term-fg32">+	BaseGoerliChainID       = 84531</span>
<span class="term-fg32">+	baseSepoliaChainID      = 84532</span>
<span class="term-fg32">+	baseGoerliDevnetChainID = 11763071</span>
<span class="term-fg32">+	pgnSepoliaChainID       = 58008</span>
<span class="term-fg32">+	devnetChainID           = 997</span>
<span class="term-fg32">+	chaosnetChainID         = 888</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; OP Stack chain config</span>
<span class="term-fg32">+var (</span>
<span class="term-fg32">+	&#47;&#47; March 17, 2023 @ 7:00:00 pm UTC</span>
<span class="term-fg32">+	OptimismGoerliRegolithTime = uint64(1679079600)</span>
<span class="term-fg32">+	&#47;&#47; May 4, 2023 @ 5:00:00 pm UTC</span>
<span class="term-fg32">+	BaseGoerliRegolithTime = uint64(1683219600)</span>
<span class="term-fg32">+	&#47;&#47; Apr 21, 2023 @ 6:30:00 pm UTC</span>
<span class="term-fg32">+	baseGoerliDevnetRegolithTime = uint64(1682101800)</span>
<span class="term-fg32">+	&#47;&#47; March 5, 2023 @ 2:48:00 am UTC</span>
<span class="term-fg32">+	devnetRegolithTime = uint64(1677984480)</span>
<span class="term-fg32">+	&#47;&#47; August 16, 2023 @ 3:34:22 am UTC</span>
<span class="term-fg32">+	chaosnetRegolithTime = uint64(1692156862)</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
 func newUint64(val uint64) *uint64 { return &amp;val }
&nbsp;
 var (
<span class="term-fg36">@@ -308,6 +334,16 @@</span> 		Ethash:                        new(EthashConfig),
 		Clique:                        nil,
 	}
 	TestRules = TestChainConfig.Rules(new(big.Int), false, 0)
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; This is an Optimism chain config with bedrock starting a block 5, introduced for historical endpoint testing, largely based on the clique config</span>
<span class="term-fg32">+	OptimismTestConfig = func() *ChainConfig {</span>
<span class="term-fg32">+		conf := *AllCliqueProtocolChanges &#47;&#47; copy the config</span>
<span class="term-fg32">+		conf.Clique = nil</span>
<span class="term-fg32">+		conf.TerminalTotalDifficultyPassed = true</span>
<span class="term-fg32">+		conf.BedrockBlock = big.NewInt(5)</span>
<span class="term-fg32">+		conf.Optimism = &amp;OptimismConfig{EIP1559Elasticity: 50, EIP1559Denominator: 10}</span>
<span class="term-fg32">+		return &amp;conf</span>
<span class="term-fg32">+	}()</span>
 )
&nbsp;
 &#47;&#47; NetworkNames are user friendly names to use in the chain spec banner.
<span class="term-fg36">@@ -354,6 +390,17 @@</span> 	CancunTime   *uint64 `json:&quot;cancunTime,omitempty&quot;`   &#47;&#47; Cancun switch time (nil = no fork, 0 = already on cancun)
 	PragueTime   *uint64 `json:&quot;pragueTime,omitempty&quot;`   &#47;&#47; Prague switch time (nil = no fork, 0 = already on prague)
 	VerkleTime   *uint64 `json:&quot;verkleTime,omitempty&quot;`   &#47;&#47; Verkle switch time (nil = no fork, 0 = already on verkle)
&nbsp;
<span class="term-fg32">+	BedrockBlock *big.Int `json:&quot;bedrockBlock,omitempty&quot;` &#47;&#47; Bedrock switch block (nil = no fork, 0 = already on optimism bedrock)</span>
<span class="term-fg32">+	RegolithTime *uint64  `json:&quot;regolithTime,omitempty&quot;` &#47;&#47; Regolith switch time (nil = no fork, 0 = already on optimism regolith)</span>
<span class="term-fg32">+	CanyonTime   *uint64  `json:&quot;canyonTime,omitempty&quot;`   &#47;&#47; Canyon switch time (nil = no fork, 0 = already on optimism canyon)</span>
<span class="term-fg32">+	&#47;&#47; Delta: the Delta upgrade does not affect the execution-layer, and is thus not configurable in the chain config.</span>
<span class="term-fg32">+	EcotoneTime  *uint64 `json:&quot;ecotoneTime,omitempty&quot;`  &#47;&#47; Ecotone switch time (nil = no fork, 0 = already on optimism ecotone)</span>
<span class="term-fg32">+	FjordTime    *uint64 `json:&quot;fjordTime,omitempty&quot;`    &#47;&#47; Fjord switch time (nil = no fork, 0 = already on Optimism Fjord)</span>
<span class="term-fg32">+	GraniteTime  *uint64 `json:&quot;graniteTime,omitempty&quot;`  &#47;&#47; Granite switch time (nil = no fork, 0 = already on Optimism Granite)</span>
<span class="term-fg32">+	HoloceneTime *uint64 `json:&quot;holoceneTime,omitempty&quot;` &#47;&#47; Holocene switch time (nil = no fork, 0 = already on Optimism Holocene)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	InteropTime *uint64 `json:&quot;interopTime,omitempty&quot;` &#47;&#47; Interop switch time (nil = no fork, 0 = already on optimism interop)</span>
<span class="term-fg32">+</span>
 	&#47;&#47; TerminalTotalDifficulty is the amount of total difficulty reached by
 	&#47;&#47; the network that triggers the consensus upgrade.
 	TerminalTotalDifficulty *big.Int `json:&quot;terminalTotalDifficulty,omitempty&quot;`
<span class="term-fg36">@@ -368,6 +415,9 @@</span>
 	&#47;&#47; Various consensus engines
 	Ethash *EthashConfig `json:&quot;ethash,omitempty&quot;`
 	Clique *CliqueConfig `json:&quot;clique,omitempty&quot;`
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Optimism config, nil if not active</span>
<span class="term-fg32">+	Optimism *OptimismConfig `json:&quot;optimism,omitempty&quot;`</span>
 }
&nbsp;
 &#47;&#47; EthashConfig is the consensus engine configs for proof-of-work based sealing.
<span class="term-fg36">@@ -389,6 +439,18 @@</span> func (c CliqueConfig) String() string {
 	return fmt.Sprintf(&quot;clique(period: %d, epoch: %d)&quot;, c.Period, c.Epoch)
 }
&nbsp;
<span class="term-fg32">+&#47;&#47; OptimismConfig is the optimism config.</span>
<span class="term-fg32">+type OptimismConfig struct {</span>
<span class="term-fg32">+	EIP1559Elasticity        uint64  `json:&quot;eip1559Elasticity&quot;`</span>
<span class="term-fg32">+	EIP1559Denominator       uint64  `json:&quot;eip1559Denominator&quot;`</span>
<span class="term-fg32">+	EIP1559DenominatorCanyon *uint64 `json:&quot;eip1559DenominatorCanyon,omitempty&quot;`</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; String implements the stringer interface, returning the optimism fee config details.</span>
<span class="term-fg32">+func (o *OptimismConfig) String() string {</span>
<span class="term-fg32">+	return &quot;optimism&quot;</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
 &#47;&#47; Description returns a human-readable description of ChainConfig.
 func (c *ChainConfig) Description() string {
 	var banner string
<span class="term-fg36">@@ -400,6 +462,8 @@</span> 		network = &quot;unknown&quot;
 	}
 	banner += fmt.Sprintf(&quot;Chain ID:  %v (%s)\n&quot;, c.ChainID, network)
 	switch {
<span class="term-fg32">+	case c.Optimism != nil:</span>
<span class="term-fg32">+		banner += &quot;Consensus: Optimism\n&quot;</span>
 	case c.Ethash != nil:
 		if c.TerminalTotalDifficulty == nil {
 			banner += &quot;Consensus: Ethash (proof-of-work)\n&quot;
<span class="term-fg36">@@ -478,6 +542,27 @@</span> 	}
 	if c.VerkleTime != nil {
 		banner += fmt.Sprintf(&quot; - Verkle:                      @%-10v\n&quot;, *c.VerkleTime)
 	}
<span class="term-fg32">+	if c.RegolithTime != nil {</span>
<span class="term-fg32">+		banner += fmt.Sprintf(&quot; - Regolith:                    @%-10v\n&quot;, *c.RegolithTime)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if c.CanyonTime != nil {</span>
<span class="term-fg32">+		banner += fmt.Sprintf(&quot; - Canyon:                      @%-10v\n&quot;, *c.CanyonTime)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if c.EcotoneTime != nil {</span>
<span class="term-fg32">+		banner += fmt.Sprintf(&quot; - Ecotone:                     @%-10v\n&quot;, *c.EcotoneTime)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if c.FjordTime != nil {</span>
<span class="term-fg32">+		banner += fmt.Sprintf(&quot; - Fjord:                       @%-10v\n&quot;, *c.FjordTime)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if c.GraniteTime != nil {</span>
<span class="term-fg32">+		banner += fmt.Sprintf(&quot; - Granite:                     @%-10v\n&quot;, *c.GraniteTime)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if c.HoloceneTime != nil {</span>
<span class="term-fg32">+		banner += fmt.Sprintf(&quot; - Holocene:                     @%-10v\n&quot;, *c.HoloceneTime)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if c.InteropTime != nil {</span>
<span class="term-fg32">+		banner += fmt.Sprintf(&quot; - Interop:                     @%-10v\n&quot;, *c.InteropTime)</span>
<span class="term-fg32">+	}</span>
 	return banner
 }
&nbsp;
<span class="term-fg36">@@ -586,9 +671,81 @@</span> func (c *ChainConfig) IsEIP4762(num *big.Int, time uint64) bool {
 	return c.IsVerkle(num, time)
 }
&nbsp;
<span class="term-fg32">+&#47;&#47; IsBedrock returns whether num is either equal to the Bedrock fork block or greater.</span>
<span class="term-fg32">+func (c *ChainConfig) IsBedrock(num *big.Int) bool {</span>
<span class="term-fg32">+	return isBlockForked(c.BedrockBlock, num)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (c *ChainConfig) IsRegolith(time uint64) bool {</span>
<span class="term-fg32">+	return isTimestampForked(c.RegolithTime, time)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (c *ChainConfig) IsCanyon(time uint64) bool {</span>
<span class="term-fg32">+	return isTimestampForked(c.CanyonTime, time)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (c *ChainConfig) IsEcotone(time uint64) bool {</span>
<span class="term-fg32">+	return isTimestampForked(c.EcotoneTime, time)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (c *ChainConfig) IsFjord(time uint64) bool {</span>
<span class="term-fg32">+	return isTimestampForked(c.FjordTime, time)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (c *ChainConfig) IsGranite(time uint64) bool {</span>
<span class="term-fg32">+	return isTimestampForked(c.GraniteTime, time)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (c *ChainConfig) IsHolocene(time uint64) bool {</span>
<span class="term-fg32">+	return isTimestampForked(c.HoloceneTime, time)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (c *ChainConfig) IsInterop(time uint64) bool {</span>
<span class="term-fg32">+	return isTimestampForked(c.InteropTime, time)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; IsOptimism returns whether the node is an optimism node or not.</span>
<span class="term-fg32">+func (c *ChainConfig) IsOptimism() bool {</span>
<span class="term-fg32">+	return c.Optimism != nil</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; IsOptimismBedrock returns true iff this is an optimism node &amp; bedrock is active</span>
<span class="term-fg32">+func (c *ChainConfig) IsOptimismBedrock(num *big.Int) bool {</span>
<span class="term-fg32">+	return c.IsOptimism() &amp;&amp; c.IsBedrock(num)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (c *ChainConfig) IsOptimismRegolith(time uint64) bool {</span>
<span class="term-fg32">+	return c.IsOptimism() &amp;&amp; c.IsRegolith(time)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (c *ChainConfig) IsOptimismCanyon(time uint64) bool {</span>
<span class="term-fg32">+	return c.IsOptimism() &amp;&amp; c.IsCanyon(time)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (c *ChainConfig) IsOptimismEcotone(time uint64) bool {</span>
<span class="term-fg32">+	return c.IsOptimism() &amp;&amp; c.IsEcotone(time)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (c *ChainConfig) IsOptimismFjord(time uint64) bool {</span>
<span class="term-fg32">+	return c.IsOptimism() &amp;&amp; c.IsFjord(time)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (c *ChainConfig) IsOptimismGranite(time uint64) bool {</span>
<span class="term-fg32">+	return c.IsOptimism() &amp;&amp; c.IsGranite(time)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (c *ChainConfig) IsOptimismHolocene(time uint64) bool {</span>
<span class="term-fg32">+	return c.IsOptimism() &amp;&amp; c.IsHolocene(time)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; IsOptimismPreBedrock returns true iff this is an optimism node &amp; bedrock is not yet active</span>
<span class="term-fg32">+func (c *ChainConfig) IsOptimismPreBedrock(num *big.Int) bool {</span>
<span class="term-fg32">+	return c.IsOptimism() &amp;&amp; !c.IsBedrock(num)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
 &#47;&#47; CheckCompatible checks whether scheduled fork transitions have been imported
 &#47;&#47; with a mismatching chain configuration.
<span class="term-fg31">-func (c *ChainConfig) CheckCompatible(newcfg *ChainConfig, height uint64, time uint64) *ConfigCompatError {</span>
<span class="term-fg32">+func (c *ChainConfig) CheckCompatible(newcfg *ChainConfig, height, time uint64, genesisTimestamp *uint64) *ConfigCompatError {</span>
 	var (
 		bhead = new(big.Int).SetUint64(height)
 		btime = time
<span class="term-fg36">@@ -596,7 +753,7 @@</span> 	)
 	&#47;&#47; Iterate checkCompatible to find the lowest conflict.
 	var lasterr *ConfigCompatError
 	for {
<span class="term-fg31">-		err := c.checkCompatible(newcfg, bhead, btime)</span>
<span class="term-fg32">+		err := c.checkCompatible(newcfg, bhead, btime, genesisTimestamp)</span>
 		if err == nil || (lasterr != nil &amp;&amp; err.RewindToBlock == lasterr.RewindToBlock &amp;&amp; err.RewindToTime == lasterr.RewindToTime) {
 			break
 		}
<span class="term-fg36">@@ -679,7 +836,7 @@</span> 	}
 	return nil
 }
&nbsp;
<span class="term-fg31">-func (c *ChainConfig) checkCompatible(newcfg *ChainConfig, headNumber *big.Int, headTimestamp uint64) *ConfigCompatError {</span>
<span class="term-fg32">+func (c *ChainConfig) checkCompatible(newcfg *ChainConfig, headNumber *big.Int, headTimestamp uint64, genesisTimestamp *uint64) *ConfigCompatError {</span>
 	if isForkBlockIncompatible(c.HomesteadBlock, newcfg.HomesteadBlock, headNumber) {
 		return newBlockCompatError(&quot;Homestead fork block&quot;, c.HomesteadBlock, newcfg.HomesteadBlock)
 	}
<span class="term-fg36">@@ -735,28 +892,65 @@</span> 	}
 	if isForkBlockIncompatible(c.MergeNetsplitBlock, newcfg.MergeNetsplitBlock, headNumber) {
 		return newBlockCompatError(&quot;Merge netsplit fork block&quot;, c.MergeNetsplitBlock, newcfg.MergeNetsplitBlock)
 	}
<span class="term-fg31">-	if isForkTimestampIncompatible(c.ShanghaiTime, newcfg.ShanghaiTime, headTimestamp) {</span>
<span class="term-fg32">+	if isForkTimestampIncompatible(c.ShanghaiTime, newcfg.ShanghaiTime, headTimestamp, genesisTimestamp) {</span>
 		return newTimestampCompatError(&quot;Shanghai fork timestamp&quot;, c.ShanghaiTime, newcfg.ShanghaiTime)
 	}
<span class="term-fg31">-	if isForkTimestampIncompatible(c.CancunTime, newcfg.CancunTime, headTimestamp) {</span>
<span class="term-fg32">+	if isForkTimestampIncompatible(c.CancunTime, newcfg.CancunTime, headTimestamp, genesisTimestamp) {</span>
 		return newTimestampCompatError(&quot;Cancun fork timestamp&quot;, c.CancunTime, newcfg.CancunTime)
 	}
<span class="term-fg31">-	if isForkTimestampIncompatible(c.PragueTime, newcfg.PragueTime, headTimestamp) {</span>
<span class="term-fg32">+	if isForkTimestampIncompatible(c.PragueTime, newcfg.PragueTime, headTimestamp, genesisTimestamp) {</span>
 		return newTimestampCompatError(&quot;Prague fork timestamp&quot;, c.PragueTime, newcfg.PragueTime)
 	}
<span class="term-fg31">-	if isForkTimestampIncompatible(c.VerkleTime, newcfg.VerkleTime, headTimestamp) {</span>
<span class="term-fg32">+	if isForkTimestampIncompatible(c.VerkleTime, newcfg.VerkleTime, headTimestamp, genesisTimestamp) {</span>
 		return newTimestampCompatError(&quot;Verkle fork timestamp&quot;, c.VerkleTime, newcfg.VerkleTime)
 	}
<span class="term-fg32">+	if isForkBlockIncompatible(c.BedrockBlock, newcfg.BedrockBlock, headNumber) {</span>
<span class="term-fg32">+		return newBlockCompatError(&quot;Bedrock fork block&quot;, c.BedrockBlock, newcfg.BedrockBlock)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if isForkTimestampIncompatible(c.RegolithTime, newcfg.RegolithTime, headTimestamp, genesisTimestamp) {</span>
<span class="term-fg32">+		return newTimestampCompatError(&quot;Regolith fork timestamp&quot;, c.RegolithTime, newcfg.RegolithTime)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if isForkTimestampIncompatible(c.CanyonTime, newcfg.CanyonTime, headTimestamp, genesisTimestamp) {</span>
<span class="term-fg32">+		return newTimestampCompatError(&quot;Canyon fork timestamp&quot;, c.CanyonTime, newcfg.CanyonTime)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if isForkTimestampIncompatible(c.EcotoneTime, newcfg.EcotoneTime, headTimestamp, genesisTimestamp) {</span>
<span class="term-fg32">+		return newTimestampCompatError(&quot;Ecotone fork timestamp&quot;, c.EcotoneTime, newcfg.EcotoneTime)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if isForkTimestampIncompatible(c.FjordTime, newcfg.FjordTime, headTimestamp, genesisTimestamp) {</span>
<span class="term-fg32">+		return newTimestampCompatError(&quot;Fjord fork timestamp&quot;, c.FjordTime, newcfg.FjordTime)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if isForkTimestampIncompatible(c.GraniteTime, newcfg.GraniteTime, headTimestamp, genesisTimestamp) {</span>
<span class="term-fg32">+		return newTimestampCompatError(&quot;Granite fork timestamp&quot;, c.GraniteTime, newcfg.GraniteTime)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if isForkTimestampIncompatible(c.HoloceneTime, newcfg.HoloceneTime, headTimestamp, genesisTimestamp) {</span>
<span class="term-fg32">+		return newTimestampCompatError(&quot;Holocene fork timestamp&quot;, c.HoloceneTime, newcfg.HoloceneTime)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if isForkTimestampIncompatible(c.InteropTime, newcfg.InteropTime, headTimestamp, genesisTimestamp) {</span>
<span class="term-fg32">+		return newTimestampCompatError(&quot;Interop fork timestamp&quot;, c.InteropTime, newcfg.InteropTime)</span>
<span class="term-fg32">+	}</span>
 	return nil
 }
&nbsp;
 &#47;&#47; BaseFeeChangeDenominator bounds the amount the base fee can change between blocks.
<span class="term-fg31">-func (c *ChainConfig) BaseFeeChangeDenominator() uint64 {</span>
<span class="term-fg32">+&#47;&#47; The time parameters is the timestamp of the block to determine if Canyon is active or not</span>
<span class="term-fg32">+func (c *ChainConfig) BaseFeeChangeDenominator(time uint64) uint64 {</span>
<span class="term-fg32">+	if c.Optimism != nil {</span>
<span class="term-fg32">+		if c.IsCanyon(time) {</span>
<span class="term-fg32">+			if c.Optimism.EIP1559DenominatorCanyon == nil || *c.Optimism.EIP1559DenominatorCanyon == 0 {</span>
<span class="term-fg32">+				panic(&quot;invalid ChainConfig.Optimism.EIP1559DenominatorCanyon value: &#39;0&#39; or &#39;nil&#39;&quot;)</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+			return *c.Optimism.EIP1559DenominatorCanyon</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		return c.Optimism.EIP1559Denominator</span>
<span class="term-fg32">+	}</span>
 	return DefaultBaseFeeChangeDenominator
 }
&nbsp;
 &#47;&#47; ElasticityMultiplier bounds the maximum gas limit an EIP-1559 block may have.
 func (c *ChainConfig) ElasticityMultiplier() uint64 {
<span class="term-fg32">+	if c.Optimism != nil {</span>
<span class="term-fg32">+		return c.Optimism.EIP1559Elasticity</span>
<span class="term-fg32">+	}</span>
 	return DefaultElasticityMultiplier
 }
&nbsp;
<span class="term-fg36">@@ -778,7 +972,7 @@</span> 	}
 }
&nbsp;
 &#47;&#47; isForkBlockIncompatible returns true if a fork scheduled at block s1 cannot be
<span class="term-fg31">-&#47;&#47; rescheduled to block s2 because head is already past the fork.</span>
<span class="term-fg32">+&#47;&#47; rescheduled to block s2 because head is already past the fork and the fork was scheduled after genesis</span>
 func isForkBlockIncompatible(s1, s2, head *big.Int) bool {
 	return (isBlockForked(s1, head) || isBlockForked(s2, head)) &amp;&amp; !configBlockEqual(s1, s2)
 }
<span class="term-fg36">@@ -805,8 +999,15 @@</span> }
&nbsp;
 &#47;&#47; isForkTimestampIncompatible returns true if a fork scheduled at timestamp s1
 &#47;&#47; cannot be rescheduled to timestamp s2 because head is already past the fork.
<span class="term-fg31">-func isForkTimestampIncompatible(s1, s2 *uint64, head uint64) bool {</span>
<span class="term-fg31">-	return (isTimestampForked(s1, head) || isTimestampForked(s2, head)) &amp;&amp; !configTimestampEqual(s1, s2)</span>
<span class="term-fg32">+func isForkTimestampIncompatible(s1, s2 *uint64, head uint64, genesis *uint64) bool {</span>
<span class="term-fg32">+	return (isTimestampForked(s1, head) || isTimestampForked(s2, head)) &amp;&amp; !configTimestampEqual(s1, s2) &amp;&amp; !isTimestampPreGenesis(s1, genesis) &amp;&amp; !isTimestampPreGenesis(s2, genesis)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func isTimestampPreGenesis(s, genesis *uint64) bool {</span>
<span class="term-fg32">+	if s == nil || genesis == nil {</span>
<span class="term-fg32">+		return false</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	return *s &lt; *genesis</span>
 }
&nbsp;
 &#47;&#47; isTimestampForked returns whether a fork scheduled at timestamp s is active
<span class="term-fg36">@@ -919,6 +1120,9 @@</span> 	IsByzantium, IsConstantinople, IsPetersburg, IsIstanbul bool
 	IsBerlin, IsLondon                                      bool
 	IsMerge, IsShanghai, IsCancun, IsPrague                 bool
 	IsVerkle                                                bool
<span class="term-fg32">+	IsOptimismBedrock, IsOptimismRegolith                   bool</span>
<span class="term-fg32">+	IsOptimismCanyon, IsOptimismFjord                       bool</span>
<span class="term-fg32">+	IsOptimismGranite, IsOptimismHolocene                   bool</span>
 }
&nbsp;
 &#47;&#47; Rules ensures c&#39;s ChainID is not nil.
<span class="term-fg36">@@ -949,5 +1153,12 @@</span> 		IsCancun:         isMerge &amp;&amp; c.IsCancun(num, timestamp),
 		IsPrague:         isMerge &amp;&amp; c.IsPrague(num, timestamp),
 		IsVerkle:         isVerkle,
 		IsEIP4762:        isVerkle,
<span class="term-fg32">+		&#47;&#47; Optimism</span>
<span class="term-fg32">+		IsOptimismBedrock:  isMerge &amp;&amp; c.IsOptimismBedrock(num),</span>
<span class="term-fg32">+		IsOptimismRegolith: isMerge &amp;&amp; c.IsOptimismRegolith(timestamp),</span>
<span class="term-fg32">+		IsOptimismCanyon:   isMerge &amp;&amp; c.IsOptimismCanyon(timestamp),</span>
<span class="term-fg32">+		IsOptimismFjord:    isMerge &amp;&amp; c.IsOptimismFjord(timestamp),</span>
<span class="term-fg32">+		IsOptimismGranite:  isMerge &amp;&amp; c.IsOptimismGranite(timestamp),</span>
<span class="term-fg32">+		IsOptimismHolocene: isMerge &amp;&amp; c.IsOptimismHolocene(timestamp),</span>
 	}
 }</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-0348d50bbba01f1d88cfa4c9" role="button"
                       aria-expanded="false" aria-controls="id-0348d50bbba01f1d88cfa4c9">
                        <code>params/protocol_params.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/params/protocol_params.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/params/protocol_params.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+11</span></div>
                            <div class="text-start"><span class="text-danger">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-0348d50bbba01f1d88cfa4c9"><span class="term-fg1">diff --git go-ethereum&#47;params&#47;protocol_params.go op-geth&#47;params&#47;protocol_params.go</span>
<span class="term-fg1">index 8ffe8ee75db1211aae0acfb5921385d5dceaed79..b07ab17dd93b3978f9e97f314f3a0f484afcdf82 100644</span>
<span class="term-fg1">--- go-ethereum&#47;params&#47;protocol_params.go</span>
<span class="term-fg1">+++ op-geth&#47;params&#47;protocol_params.go</span>
<span class="term-fg36">@@ -22,6 +22,13 @@</span>
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&quot;
 )
&nbsp;
<span class="term-fg32">+var (</span>
<span class="term-fg32">+	&#47;&#47; The base fee portion of the transaction fee accumulates at this predeploy</span>
<span class="term-fg32">+	OptimismBaseFeeRecipient = common.HexToAddress(&quot;0x4200000000000000000000000000000000000019&quot;)</span>
<span class="term-fg32">+	&#47;&#47; The L1 portion of the transaction fee accumulates at this predeploy</span>
<span class="term-fg32">+	OptimismL1FeeRecipient = common.HexToAddress(&quot;0x420000000000000000000000000000000000001A&quot;)</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
 const (
 	GasLimitBoundDivisor uint64 = 1024               &#47;&#47; The bound divisor of the gas limit, used in update calculations.
 	MinGasLimit          uint64 = 5000               &#47;&#47; Minimum the gas limit may ever be.
<span class="term-fg36">@@ -151,6 +158,8 @@</span> 	Bn256PairingBaseGasIstanbul      uint64 = 45000  &#47;&#47; Base price for an elliptic curve pairing check
 	Bn256PairingPerPointGasByzantium uint64 = 80000  &#47;&#47; Byzantium per-point price for an elliptic curve pairing check
 	Bn256PairingPerPointGasIstanbul  uint64 = 34000  &#47;&#47; Per-point price for an elliptic curve pairing check
&nbsp;
<span class="term-fg32">+	Bn256PairingMaxInputSizeGranite uint64 = 112687 &#47;&#47; Maximum input size for an elliptic curve pairing check</span>
<span class="term-fg32">+</span>
 	Bls12381G1AddGas          uint64 = 500   &#47;&#47; Price for BLS12-381 elliptic curve G1 point addition
 	Bls12381G1MulGas          uint64 = 12000 &#47;&#47; Price for BLS12-381 elliptic curve G1 point scalar multiplication
 	Bls12381G2AddGas          uint64 = 800   &#47;&#47; Price for BLS12-381 elliptic curve G2 point addition
<span class="term-fg36">@@ -159,6 +168,8 @@</span> 	Bls12381PairingBaseGas    uint64 = 65000 &#47;&#47; Base gas price for BLS12-381 elliptic curve pairing check
 	Bls12381PairingPerPairGas uint64 = 43000 &#47;&#47; Per-point pair gas price for BLS12-381 elliptic curve pairing check
 	Bls12381MapG1Gas          uint64 = 5500  &#47;&#47; Gas price for BLS12-381 mapping field element to G1 operation
 	Bls12381MapG2Gas          uint64 = 75000 &#47;&#47; Gas price for BLS12-381 mapping field element to G2 operation
<span class="term-fg32">+</span>
<span class="term-fg32">+	P256VerifyGas uint64 = 3450 &#47;&#47; secp256r1 elliptic curve signature verifier gas price</span>
&nbsp;
 	&#47;&#47; The Refund Quotient is the cap on how much of the used gas can be refunded. Before EIP-3529,
 	&#47;&#47; up to half the consumed gas could be refunded. Redefined as 1&#47;5th in EIP-3529</div>
    </div>

            
            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-7a2f5d0dc545b2cc92508387"role="button" aria-expanded="false" aria-controls="id-7a2f5d0dc545b2cc92508387">
        
            <div class="col-12 col-md-12 col-lg-6 col-xl-6 text-start"><h3>Chain config cleanup</h3></div>
        

        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2">
            <div class="row line-stat">
                
                
            </div>
        </div>
        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2 ">
            <div class="row line-stat">
                
                    <div class="text-end"><span class="text-success">+3</span></div>
                    <div class="text-start"><span class="text-danger">-0</span></div>
                
                
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-7a2f5d0dc545b2cc92508387">
        <div><p>The optimism Goerli testnet used clique-config data to make geth internals accept blocks.
Post-bedrock the beacon-consensus (i.e. follow Engine API) is now used, and the clique config is removed.</p>
</div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-20ba87d922fe97ae9a58c2db" role="button"
                       aria-expanded="false" aria-controls="id-20ba87d922fe97ae9a58c2db">
                        <code>core/rawdb/accessors_metadata.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/core/rawdb/accessors_metadata.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/core/rawdb/accessors_metadata.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+3</span></div>
                            <div class="text-start"><span class="text-danger">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-20ba87d922fe97ae9a58c2db"><span class="term-fg1">diff --git go-ethereum&#47;core&#47;rawdb&#47;accessors_metadata.go op-geth&#47;core&#47;rawdb&#47;accessors_metadata.go</span>
<span class="term-fg1">index 859566f722f5960b0ce417514d6f20ff35a5cbe9..7dae87a98f2f5383b3b14f0d04012eb64c98a91b 100644</span>
<span class="term-fg1">--- go-ethereum&#47;core&#47;rawdb&#47;accessors_metadata.go</span>
<span class="term-fg1">+++ op-geth&#47;core&#47;rawdb&#47;accessors_metadata.go</span>
<span class="term-fg36">@@ -64,6 +64,9 @@</span> 	if err := json.Unmarshal(data, &amp;config); err != nil {
 		log.Error(&quot;Invalid chain config JSON&quot;, &quot;hash&quot;, hash, &quot;err&quot;, err)
 		return nil
 	}
<span class="term-fg32">+	if config.Optimism != nil {</span>
<span class="term-fg32">+		config.Clique = nil &#47;&#47; get rid of legacy clique data in chain config (optimism goerli issue)</span>
<span class="term-fg32">+	}</span>
 	return &amp;config
 }
</div>
    </div>

            
            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-21701f398b67c2e595589114"role="button" aria-expanded="false" aria-controls="id-21701f398b67c2e595589114">
        
            <div class="col-12 col-md-12 col-lg-6 col-xl-6 text-start"><h3>Genesis loading</h3></div>
        

        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2">
            <div class="row line-stat">
                
                
            </div>
        </div>
        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2 ">
            <div class="row line-stat">
                
                    <div class="text-end"><span class="text-success">+6</span></div>
                    <div class="text-start"><span class="text-danger">-0</span></div>
                
                
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-21701f398b67c2e595589114">
        <div></div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-c7c5bc177bf54cd515a3b255" role="button"
                       aria-expanded="false" aria-controls="id-c7c5bc177bf54cd515a3b255">
                        <code>core/gen_genesis.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/core/gen_genesis.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/core/gen_genesis.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+6</span></div>
                            <div class="text-start"><span class="text-danger">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-c7c5bc177bf54cd515a3b255"><span class="term-fg1">diff --git go-ethereum&#47;core&#47;gen_genesis.go op-geth&#47;core&#47;gen_genesis.go</span>
<span class="term-fg1">index 2028f98edc0691b4dce10bbe0a8019f7931637f2..64840dec2d95080f15212107b7cb673ca1477489 100644</span>
<span class="term-fg1">--- go-ethereum&#47;core&#47;gen_genesis.go</span>
<span class="term-fg1">+++ op-geth&#47;core&#47;gen_genesis.go</span>
<span class="term-fg36">@@ -34,6 +34,7 @@</span> 		ParentHash    common.Hash                                `json:&quot;parentHash&quot;`
 		BaseFee       *math.HexOrDecimal256                      `json:&quot;baseFeePerGas&quot;`
 		ExcessBlobGas *math.HexOrDecimal64                       `json:&quot;excessBlobGas&quot;`
 		BlobGasUsed   *math.HexOrDecimal64                       `json:&quot;blobGasUsed&quot;`
<span class="term-fg32">+		StateHash     *common.Hash                               `json:&quot;stateHash,omitempty&quot;`</span>
 	}
 	var enc Genesis
 	enc.Config = g.Config
<span class="term-fg36">@@ -56,6 +57,7 @@</span> 	enc.ParentHash = g.ParentHash
 	enc.BaseFee = (*math.HexOrDecimal256)(g.BaseFee)
 	enc.ExcessBlobGas = (*math.HexOrDecimal64)(g.ExcessBlobGas)
 	enc.BlobGasUsed = (*math.HexOrDecimal64)(g.BlobGasUsed)
<span class="term-fg32">+	enc.StateHash = g.StateHash</span>
 	return json.Marshal(&amp;enc)
 }
&nbsp;
<span class="term-fg36">@@ -77,6 +79,7 @@</span> 		ParentHash    *common.Hash                               `json:&quot;parentHash&quot;`
 		BaseFee       *math.HexOrDecimal256                      `json:&quot;baseFeePerGas&quot;`
 		ExcessBlobGas *math.HexOrDecimal64                       `json:&quot;excessBlobGas&quot;`
 		BlobGasUsed   *math.HexOrDecimal64                       `json:&quot;blobGasUsed&quot;`
<span class="term-fg32">+		StateHash     *common.Hash                               `json:&quot;stateHash,omitempty&quot;`</span>
 	}
 	var dec Genesis
 	if err := json.Unmarshal(input, &amp;dec); err != nil {
<span class="term-fg36">@@ -132,6 +135,9 @@</span> 		g.ExcessBlobGas = (*uint64)(dec.ExcessBlobGas)
 	}
 	if dec.BlobGasUsed != nil {
 		g.BlobGasUsed = (*uint64)(dec.BlobGasUsed)
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if dec.StateHash != nil {</span>
<span class="term-fg32">+		g.StateHash = dec.StateHash</span>
 	}
 	return nil
 }</div>
    </div>

            
            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-40f6c18cea04dd541db3b905"role="button" aria-expanded="false" aria-controls="id-40f6c18cea04dd541db3b905">
        
            <div class="col-12 col-md-12 col-lg-6 col-xl-6 text-start"><h3>Superchain config</h3></div>
        

        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2">
            <div class="row line-stat">
                
                
            </div>
        </div>
        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2 ">
            <div class="row line-stat">
                
                    <div class="text-end"><span class="text-success">+381</span></div>
                    <div class="text-start"><span class="text-danger">-0</span></div>
                
                
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-40f6c18cea04dd541db3b905">
        <div><p>Testing of the superchain configuration</p>
</div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-88c73dbef0d0c81b7dc8cea8" role="button"
                       aria-expanded="false" aria-controls="id-88c73dbef0d0c81b7dc8cea8">
                        <code>core/superchain.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/core/superchain.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+101</span></div>
                            <div class="text-start"><span class="text-danger">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-88c73dbef0d0c81b7dc8cea8"><span class="term-fg1">diff --git go-ethereum&#47;core&#47;superchain.go op-geth&#47;core&#47;superchain.go</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..47b160c51964b97fd30b73e836b6533676c65a3b</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ op-geth&#47;core&#47;superchain.go</span>
<span class="term-fg36">@@ -0,0 +1,101 @@</span>
<span class="term-fg32">+package core</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+import (</span>
<span class="term-fg32">+	&quot;fmt&quot;</span>
<span class="term-fg32">+	&quot;math&#47;big&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum-optimism&#47;superchain-registry&#47;superchain&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;params&quot;</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func LoadOPStackGenesis(chainID uint64) (*Genesis, error) {</span>
<span class="term-fg32">+	chConfig, ok := superchain.OPChains[chainID]</span>
<span class="term-fg32">+	if !ok {</span>
<span class="term-fg32">+		return nil, fmt.Errorf(&quot;unknown chain ID: %d&quot;, chainID)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	cfg, err := params.LoadOPStackChainConfig(chainID)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return nil, fmt.Errorf(&quot;failed to load params.ChainConfig for chain %d: %w&quot;, chainID, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	gen, err := superchain.LoadGenesis(chainID)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return nil, fmt.Errorf(&quot;failed to load genesis definition for chain %d: %w&quot;, chainID, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	genesis := &amp;Genesis{</span>
<span class="term-fg32">+		Config:        cfg,</span>
<span class="term-fg32">+		Nonce:         gen.Nonce,</span>
<span class="term-fg32">+		Timestamp:     gen.Timestamp,</span>
<span class="term-fg32">+		ExtraData:     gen.ExtraData,</span>
<span class="term-fg32">+		GasLimit:      gen.GasLimit,</span>
<span class="term-fg32">+		Difficulty:    (*big.Int)(gen.Difficulty),</span>
<span class="term-fg32">+		Mixhash:       common.Hash(gen.Mixhash),</span>
<span class="term-fg32">+		Coinbase:      common.Address(gen.Coinbase),</span>
<span class="term-fg32">+		Alloc:         make(GenesisAlloc),</span>
<span class="term-fg32">+		Number:        gen.Number,</span>
<span class="term-fg32">+		GasUsed:       gen.GasUsed,</span>
<span class="term-fg32">+		ParentHash:    common.Hash(gen.ParentHash),</span>
<span class="term-fg32">+		BaseFee:       (*big.Int)(gen.BaseFee),</span>
<span class="term-fg32">+		ExcessBlobGas: gen.ExcessBlobGas,</span>
<span class="term-fg32">+		BlobGasUsed:   gen.BlobGasUsed,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	for addr, acc := range gen.Alloc {</span>
<span class="term-fg32">+		var code []byte</span>
<span class="term-fg32">+		if acc.CodeHash != ([32]byte{}) {</span>
<span class="term-fg32">+			dat, err := superchain.LoadContractBytecode(acc.CodeHash)</span>
<span class="term-fg32">+			if err != nil {</span>
<span class="term-fg32">+				return nil, fmt.Errorf(&quot;failed to load bytecode %s of address %s in chain %d: %w&quot;, acc.CodeHash, addr, chainID, err)</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+			code = dat</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		var storage map[common.Hash]common.Hash</span>
<span class="term-fg32">+		if len(acc.Storage) &gt; 0 {</span>
<span class="term-fg32">+			storage = make(map[common.Hash]common.Hash)</span>
<span class="term-fg32">+			for k, v := range acc.Storage {</span>
<span class="term-fg32">+				storage[common.Hash(k)] = common.Hash(v)</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		bal := common.Big0</span>
<span class="term-fg32">+		if acc.Balance != nil {</span>
<span class="term-fg32">+			bal = (*big.Int)(acc.Balance)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		genesis.Alloc[common.Address(addr)] = GenesisAccount{</span>
<span class="term-fg32">+			Code:    code,</span>
<span class="term-fg32">+			Storage: storage,</span>
<span class="term-fg32">+			Balance: bal,</span>
<span class="term-fg32">+			Nonce:   acc.Nonce,</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if gen.StateHash != nil {</span>
<span class="term-fg32">+		if len(gen.Alloc) &gt; 0 {</span>
<span class="term-fg32">+			return nil, fmt.Errorf(&quot;chain definition unexpectedly contains both allocation (%d) and state-hash %s&quot;, len(gen.Alloc), *gen.StateHash)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		genesis.StateHash = (*common.Hash)(gen.StateHash)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	genesisBlock := genesis.ToBlock()</span>
<span class="term-fg32">+	genesisBlockHash := genesisBlock.Hash()</span>
<span class="term-fg32">+	expectedHash := common.Hash([32]byte(chConfig.Genesis.L2.Hash))</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Verify we correctly produced the genesis config by recomputing the genesis-block-hash,</span>
<span class="term-fg32">+	&#47;&#47; and check the genesis matches the chain genesis definition.</span>
<span class="term-fg32">+	if chConfig.Genesis.L2.Number != genesisBlock.NumberU64() {</span>
<span class="term-fg32">+		switch chainID {</span>
<span class="term-fg32">+		case params.OPMainnetChainID:</span>
<span class="term-fg32">+			expectedHash = common.HexToHash(&quot;0x7ca38a1916c42007829c55e69d3e9a73265554b586a499015373241b8a3fa48b&quot;)</span>
<span class="term-fg32">+		case params.OPGoerliChainID:</span>
<span class="term-fg32">+			expectedHash = common.HexToHash(&quot;0xc1fc15cd51159b1f1e5cbc4b82e85c1447ddfa33c52cf1d98d14fba0d6354be1&quot;)</span>
<span class="term-fg32">+		default:</span>
<span class="term-fg32">+			return nil, fmt.Errorf(&quot;unknown stateless genesis definition for chain %d&quot;, chainID)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if expectedHash != genesisBlockHash {</span>
<span class="term-fg32">+		return nil, fmt.Errorf(&quot;chainID=%d: produced genesis with hash %s but expected %s&quot;, chainID, genesisBlockHash, expectedHash)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	return genesis, nil</span>
<span class="term-fg32">+}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-560b15d8bd61d75762fd0dfb" role="button"
                       aria-expanded="false" aria-controls="id-560b15d8bd61d75762fd0dfb">
                        <code>params/superchain.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/params/superchain.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+280</span></div>
                            <div class="text-start"><span class="text-danger">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-560b15d8bd61d75762fd0dfb"><span class="term-fg1">diff --git go-ethereum&#47;params&#47;superchain.go op-geth&#47;params&#47;superchain.go</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..bb54483c18d92116ee9797460345b23721c70d04</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ op-geth&#47;params&#47;superchain.go</span>
<span class="term-fg36">@@ -0,0 +1,280 @@</span>
<span class="term-fg32">+package params</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+import (</span>
<span class="term-fg32">+	&quot;encoding&#47;binary&quot;</span>
<span class="term-fg32">+	&quot;fmt&quot;</span>
<span class="term-fg32">+	&quot;math&#47;big&quot;</span>
<span class="term-fg32">+	&quot;sort&quot;</span>
<span class="term-fg32">+	&quot;strings&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum-optimism&#47;superchain-registry&#47;superchain&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&quot;</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+var OPStackSupport = ProtocolVersionV0{Build: [8]byte{}, Major: 8, Minor: 0, Patch: 0, PreRelease: 1}.Encode()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func init() {</span>
<span class="term-fg32">+	for id, ch := range superchain.OPChains {</span>
<span class="term-fg32">+		NetworkNames[fmt.Sprintf(&quot;%d&quot;, id)] = ch.Name</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func OPStackChainIDByName(name string) (uint64, error) {</span>
<span class="term-fg32">+	for id, ch := range superchain.OPChains {</span>
<span class="term-fg32">+		if ch.Chain+&quot;-&quot;+ch.Superchain == name {</span>
<span class="term-fg32">+			return id, nil</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	return 0, fmt.Errorf(&quot;unknown chain %q&quot;, name)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func OPStackChainNames() (out []string) {</span>
<span class="term-fg32">+	for _, ch := range superchain.OPChains {</span>
<span class="term-fg32">+		out = append(out, ch.Chain+&quot;-&quot;+ch.Superchain)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	sort.Strings(out)</span>
<span class="term-fg32">+	return</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func LoadOPStackChainConfig(chainID uint64) (*ChainConfig, error) {</span>
<span class="term-fg32">+	chConfig, ok := superchain.OPChains[chainID]</span>
<span class="term-fg32">+	if !ok {</span>
<span class="term-fg32">+		return nil, fmt.Errorf(&quot;unknown chain ID: %d&quot;, chainID)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	genesisActivation := uint64(0)</span>
<span class="term-fg32">+	out := &amp;ChainConfig{</span>
<span class="term-fg32">+		ChainID:                       new(big.Int).SetUint64(chainID),</span>
<span class="term-fg32">+		HomesteadBlock:                common.Big0,</span>
<span class="term-fg32">+		DAOForkBlock:                  nil,</span>
<span class="term-fg32">+		DAOForkSupport:                false,</span>
<span class="term-fg32">+		EIP150Block:                   common.Big0,</span>
<span class="term-fg32">+		EIP155Block:                   common.Big0,</span>
<span class="term-fg32">+		EIP158Block:                   common.Big0,</span>
<span class="term-fg32">+		ByzantiumBlock:                common.Big0,</span>
<span class="term-fg32">+		ConstantinopleBlock:           common.Big0,</span>
<span class="term-fg32">+		PetersburgBlock:               common.Big0,</span>
<span class="term-fg32">+		IstanbulBlock:                 common.Big0,</span>
<span class="term-fg32">+		MuirGlacierBlock:              common.Big0,</span>
<span class="term-fg32">+		BerlinBlock:                   common.Big0,</span>
<span class="term-fg32">+		LondonBlock:                   common.Big0,</span>
<span class="term-fg32">+		ArrowGlacierBlock:             common.Big0,</span>
<span class="term-fg32">+		GrayGlacierBlock:              common.Big0,</span>
<span class="term-fg32">+		MergeNetsplitBlock:            common.Big0,</span>
<span class="term-fg32">+		ShanghaiTime:                  chConfig.CanyonTime,  &#47;&#47; Shanghai activates with Canyon</span>
<span class="term-fg32">+		CancunTime:                    chConfig.EcotoneTime, &#47;&#47; Cancun activates with Ecotone</span>
<span class="term-fg32">+		PragueTime:                    nil,</span>
<span class="term-fg32">+		BedrockBlock:                  common.Big0,</span>
<span class="term-fg32">+		RegolithTime:                  &amp;genesisActivation,</span>
<span class="term-fg32">+		CanyonTime:                    chConfig.CanyonTime,</span>
<span class="term-fg32">+		EcotoneTime:                   chConfig.EcotoneTime,</span>
<span class="term-fg32">+		FjordTime:                     chConfig.FjordTime,</span>
<span class="term-fg32">+		GraniteTime:                   chConfig.GraniteTime,</span>
<span class="term-fg32">+		HoloceneTime:                  chConfig.HoloceneTime,</span>
<span class="term-fg32">+		TerminalTotalDifficulty:       common.Big0,</span>
<span class="term-fg32">+		TerminalTotalDifficultyPassed: true,</span>
<span class="term-fg32">+		Ethash:                        nil,</span>
<span class="term-fg32">+		Clique:                        nil,</span>
<span class="term-fg32">+		Optimism: &amp;OptimismConfig{</span>
<span class="term-fg32">+			EIP1559Elasticity:        6,</span>
<span class="term-fg32">+			EIP1559Denominator:       50,</span>
<span class="term-fg32">+			EIP1559DenominatorCanyon: newUint64(250),</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; special overrides for OP-Stack chains with pre-Regolith upgrade history</span>
<span class="term-fg32">+	switch chainID {</span>
<span class="term-fg32">+	case OPGoerliChainID:</span>
<span class="term-fg32">+		out.LondonBlock = big.NewInt(4061224)</span>
<span class="term-fg32">+		out.ArrowGlacierBlock = big.NewInt(4061224)</span>
<span class="term-fg32">+		out.GrayGlacierBlock = big.NewInt(4061224)</span>
<span class="term-fg32">+		out.MergeNetsplitBlock = big.NewInt(4061224)</span>
<span class="term-fg32">+		out.BedrockBlock = big.NewInt(4061224)</span>
<span class="term-fg32">+		out.RegolithTime = &amp;OptimismGoerliRegolithTime</span>
<span class="term-fg32">+		out.Optimism.EIP1559Elasticity = 10</span>
<span class="term-fg32">+	case OPMainnetChainID:</span>
<span class="term-fg32">+		out.BerlinBlock = big.NewInt(3950000)</span>
<span class="term-fg32">+		out.LondonBlock = big.NewInt(105235063)</span>
<span class="term-fg32">+		out.ArrowGlacierBlock = big.NewInt(105235063)</span>
<span class="term-fg32">+		out.GrayGlacierBlock = big.NewInt(105235063)</span>
<span class="term-fg32">+		out.MergeNetsplitBlock = big.NewInt(105235063)</span>
<span class="term-fg32">+		out.BedrockBlock = big.NewInt(105235063)</span>
<span class="term-fg32">+	case BaseGoerliChainID:</span>
<span class="term-fg32">+		out.RegolithTime = &amp;BaseGoerliRegolithTime</span>
<span class="term-fg32">+		out.Optimism.EIP1559Elasticity = 10</span>
<span class="term-fg32">+	case baseSepoliaChainID:</span>
<span class="term-fg32">+		out.Optimism.EIP1559Elasticity = 10</span>
<span class="term-fg32">+	case baseGoerliDevnetChainID:</span>
<span class="term-fg32">+		out.RegolithTime = &amp;baseGoerliDevnetRegolithTime</span>
<span class="term-fg32">+	case pgnSepoliaChainID:</span>
<span class="term-fg32">+		out.Optimism.EIP1559Elasticity = 2</span>
<span class="term-fg32">+		out.Optimism.EIP1559Denominator = 8</span>
<span class="term-fg32">+	case devnetChainID:</span>
<span class="term-fg32">+		out.RegolithTime = &amp;devnetRegolithTime</span>
<span class="term-fg32">+		out.Optimism.EIP1559Elasticity = 10</span>
<span class="term-fg32">+	case chaosnetChainID:</span>
<span class="term-fg32">+		out.RegolithTime = &amp;chaosnetRegolithTime</span>
<span class="term-fg32">+		out.Optimism.EIP1559Elasticity = 10</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	return out, nil</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; ProtocolVersion encodes the OP-Stack protocol version. See OP-Stack superchain-upgrade specification.</span>
<span class="term-fg32">+type ProtocolVersion [32]byte</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (p ProtocolVersion) MarshalText() ([]byte, error) {</span>
<span class="term-fg32">+	return common.Hash(p).MarshalText()</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (p *ProtocolVersion) UnmarshalText(input []byte) error {</span>
<span class="term-fg32">+	return (*common.Hash)(p).UnmarshalText(input)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (p ProtocolVersion) Parse() (versionType uint8, build [8]byte, major, minor, patch, preRelease uint32) {</span>
<span class="term-fg32">+	versionType = p[0]</span>
<span class="term-fg32">+	if versionType != 0 {</span>
<span class="term-fg32">+		return</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	&#47;&#47; bytes 1:8 reserved for future use</span>
<span class="term-fg32">+	copy(build[:], p[8:16])                        &#47;&#47; differentiates forks and custom-builds of standard protocol</span>
<span class="term-fg32">+	major = binary.BigEndian.Uint32(p[16:20])      &#47;&#47; incompatible API changes</span>
<span class="term-fg32">+	minor = binary.BigEndian.Uint32(p[20:24])      &#47;&#47; identifies additional functionality in backwards compatible manner</span>
<span class="term-fg32">+	patch = binary.BigEndian.Uint32(p[24:28])      &#47;&#47; identifies backward-compatible bug-fixes</span>
<span class="term-fg32">+	preRelease = binary.BigEndian.Uint32(p[28:32]) &#47;&#47; identifies unstable versions that may not satisfy the above</span>
<span class="term-fg32">+	return</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (p ProtocolVersion) String() string {</span>
<span class="term-fg32">+	versionType, build, major, minor, patch, preRelease := p.Parse()</span>
<span class="term-fg32">+	if versionType != 0 {</span>
<span class="term-fg32">+		return &quot;v0.0.0-unknown.&quot; + common.Hash(p).String()</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	ver := fmt.Sprintf(&quot;v%d.%d.%d&quot;, major, minor, patch)</span>
<span class="term-fg32">+	if preRelease != 0 {</span>
<span class="term-fg32">+		ver += fmt.Sprintf(&quot;-%d&quot;, preRelease)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if build != ([8]byte{}) {</span>
<span class="term-fg32">+		if humanBuildTag(build) {</span>
<span class="term-fg32">+			ver += fmt.Sprintf(&quot;+%s&quot;, strings.TrimRight(string(build[:]), &quot;\x00&quot;))</span>
<span class="term-fg32">+		} else {</span>
<span class="term-fg32">+			ver += fmt.Sprintf(&quot;+0x%x&quot;, build)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	return ver</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; humanBuildTag identifies which build tag we can stringify for human-readable versions</span>
<span class="term-fg32">+func humanBuildTag(v [8]byte) bool {</span>
<span class="term-fg32">+	for i, c := range v { &#47;&#47; following semver.org advertised regex, alphanumeric with &#39;-&#39; and &#39;.&#39;, except leading &#39;.&#39;.</span>
<span class="term-fg32">+		if c == 0 { &#47;&#47; trailing zeroed are allowed</span>
<span class="term-fg32">+			for _, d := range v[i:] {</span>
<span class="term-fg32">+				if d != 0 {</span>
<span class="term-fg32">+					return false</span>
<span class="term-fg32">+				}</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+			return true</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		if !((c &gt;= &#39;A&#39; &amp;&amp; c &lt;= &#39;Z&#39;) || (c &gt;= &#39;a&#39; &amp;&amp; c &lt;= &#39;z&#39;) || (c &gt;= &#39;0&#39; &amp;&amp; c &lt;= &#39;9&#39;) || c == &#39;-&#39; || (c == &#39;.&#39; &amp;&amp; i &gt; 0)) {</span>
<span class="term-fg32">+			return false</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	return true</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; ProtocolVersionComparison is used to identify how far ahead&#47;outdated a protocol version is relative to another.</span>
<span class="term-fg32">+&#47;&#47; This value is used in metrics and switch comparisons, to easily identify each type of version difference.</span>
<span class="term-fg32">+&#47;&#47; Negative values mean the version is outdated.</span>
<span class="term-fg32">+&#47;&#47; Positive values mean the version is up-to-date.</span>
<span class="term-fg32">+&#47;&#47; Matching versions have a 0.</span>
<span class="term-fg32">+type ProtocolVersionComparison int</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+const (</span>
<span class="term-fg32">+	AheadMajor         ProtocolVersionComparison = 4</span>
<span class="term-fg32">+	OutdatedMajor      ProtocolVersionComparison = -4</span>
<span class="term-fg32">+	AheadMinor         ProtocolVersionComparison = 3</span>
<span class="term-fg32">+	OutdatedMinor      ProtocolVersionComparison = -3</span>
<span class="term-fg32">+	AheadPatch         ProtocolVersionComparison = 2</span>
<span class="term-fg32">+	OutdatedPatch      ProtocolVersionComparison = -2</span>
<span class="term-fg32">+	AheadPrerelease    ProtocolVersionComparison = 1</span>
<span class="term-fg32">+	OutdatedPrerelease ProtocolVersionComparison = -1</span>
<span class="term-fg32">+	Matching           ProtocolVersionComparison = 0</span>
<span class="term-fg32">+	DiffVersionType    ProtocolVersionComparison = 100</span>
<span class="term-fg32">+	DiffBuild          ProtocolVersionComparison = 101</span>
<span class="term-fg32">+	EmptyVersion       ProtocolVersionComparison = 102</span>
<span class="term-fg32">+	InvalidVersion     ProtocolVersionComparison = 103</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (p ProtocolVersion) Compare(other ProtocolVersion) (cmp ProtocolVersionComparison) {</span>
<span class="term-fg32">+	if p == (ProtocolVersion{}) || (other == (ProtocolVersion{})) {</span>
<span class="term-fg32">+		return EmptyVersion</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	aVersionType, aBuild, aMajor, aMinor, aPatch, aPreRelease := p.Parse()</span>
<span class="term-fg32">+	bVersionType, bBuild, bMajor, bMinor, bPatch, bPreRelease := other.Parse()</span>
<span class="term-fg32">+	if aVersionType != bVersionType {</span>
<span class="term-fg32">+		return DiffVersionType</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if aBuild != bBuild {</span>
<span class="term-fg32">+		return DiffBuild</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	&#47;&#47; max values are reserved, consider versions with these values invalid</span>
<span class="term-fg32">+	if aMajor == ^uint32(0) || aMinor == ^uint32(0) || aPatch == ^uint32(0) || aPreRelease == ^uint32(0) ||</span>
<span class="term-fg32">+		bMajor == ^uint32(0) || bMinor == ^uint32(0) || bPatch == ^uint32(0) || bPreRelease == ^uint32(0) {</span>
<span class="term-fg32">+		return InvalidVersion</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	fn := func(a, b uint32, ahead, outdated ProtocolVersionComparison) ProtocolVersionComparison {</span>
<span class="term-fg32">+		if a == b {</span>
<span class="term-fg32">+			return Matching</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		if a &gt; b {</span>
<span class="term-fg32">+			return ahead</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		return outdated</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if aPreRelease != 0 { &#47;&#47; if A is a pre-release, then decrement the version before comparison</span>
<span class="term-fg32">+		if aPatch != 0 {</span>
<span class="term-fg32">+			aPatch -= 1</span>
<span class="term-fg32">+		} else if aMinor != 0 {</span>
<span class="term-fg32">+			aMinor -= 1</span>
<span class="term-fg32">+			aPatch = ^uint32(0) &#47;&#47; max value</span>
<span class="term-fg32">+		} else if aMajor != 0 {</span>
<span class="term-fg32">+			aMajor -= 1</span>
<span class="term-fg32">+			aMinor = ^uint32(0) &#47;&#47; max value</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if bPreRelease != 0 { &#47;&#47; if B is a pre-release, then decrement the version before comparison</span>
<span class="term-fg32">+		if bPatch != 0 {</span>
<span class="term-fg32">+			bPatch -= 1</span>
<span class="term-fg32">+		} else if bMinor != 0 {</span>
<span class="term-fg32">+			bMinor -= 1</span>
<span class="term-fg32">+			bPatch = ^uint32(0) &#47;&#47; max value</span>
<span class="term-fg32">+		} else if bMajor != 0 {</span>
<span class="term-fg32">+			bMajor -= 1</span>
<span class="term-fg32">+			bMinor = ^uint32(0) &#47;&#47; max value</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if c := fn(aMajor, bMajor, AheadMajor, OutdatedMajor); c != Matching {</span>
<span class="term-fg32">+		return c</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if c := fn(aMinor, bMinor, AheadMinor, OutdatedMinor); c != Matching {</span>
<span class="term-fg32">+		return c</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if c := fn(aPatch, bPatch, AheadPatch, OutdatedPatch); c != Matching {</span>
<span class="term-fg32">+		return c</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	return fn(aPreRelease, bPreRelease, AheadPrerelease, OutdatedPrerelease)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+type ProtocolVersionV0 struct {</span>
<span class="term-fg32">+	Build                           [8]byte</span>
<span class="term-fg32">+	Major, Minor, Patch, PreRelease uint32</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (v ProtocolVersionV0) Encode() (out ProtocolVersion) {</span>
<span class="term-fg32">+	copy(out[8:16], v.Build[:])</span>
<span class="term-fg32">+	binary.BigEndian.PutUint32(out[16:20], v.Major)</span>
<span class="term-fg32">+	binary.BigEndian.PutUint32(out[20:24], v.Minor)</span>
<span class="term-fg32">+	binary.BigEndian.PutUint32(out[24:28], v.Patch)</span>
<span class="term-fg32">+	binary.BigEndian.PutUint32(out[28:32], v.PreRelease)</span>
<span class="term-fg32">+	return</span>
<span class="term-fg32">+}</span></div>
    </div>

            
            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
        </div>
    </div>
</div>

            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-72fcb4c6b1cd271c48665f81"role="button" aria-expanded="false" aria-controls="id-72fcb4c6b1cd271c48665f81">
        
            <div class="col-12 col-md-12 col-lg-6 col-xl-6 text-start"><h2>Node modifications</h2></div>
        

        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2">
            <div class="row line-stat">
                
                
            </div>
        </div>
        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2 ">
            <div class="row line-stat">
                
                    <div class="text-end"><span class="text-success">+767</span></div>
                    <div class="text-start"><span class="text-danger">-112</span></div>
                
                
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-72fcb4c6b1cd271c48665f81">
        <div><p>Changes to the node configuration and services.</p>
</div>
        <div>
            
            
        </div>
        <div>
            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-41b54bf5215cee0dd14acc5b"role="button" aria-expanded="false" aria-controls="id-41b54bf5215cee0dd14acc5b">
        
            <div class="col-12 col-md-12 col-lg-6 col-xl-6 text-start"><h3>CLI</h3></div>
        

        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2">
            <div class="row line-stat">
                
                
            </div>
        </div>
        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2 ">
            <div class="row line-stat">
                
                    <div class="text-end"><span class="text-success">+288</span></div>
                    <div class="text-start"><span class="text-danger">-15</span></div>
                
                
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-41b54bf5215cee0dd14acc5b">
        <div></div>
        <div>
            
            
        </div>
        <div>
            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-0731b1c56b9766f9e2041652"role="button" aria-expanded="false" aria-controls="id-0731b1c56b9766f9e2041652">
        
            <div class="col-12 col-md-12 col-lg-6 col-xl-6 text-start"><h4>Flags</h4></div>
        

        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2">
            <div class="row line-stat">
                
                
            </div>
        </div>
        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2 ">
            <div class="row line-stat">
                
                    <div class="text-end"><span class="text-success">+228</span></div>
                    <div class="text-start"><span class="text-danger">-6</span></div>
                
                
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-0731b1c56b9766f9e2041652">
        <div><p>Flag changes:
  - Transactions can be forwarded to an RPC for sequencing.
  - Historical calls can be forwarded to a legacy node.
  - The tx pool propagation can be enabled/disabled.
  - The Optimism bedrock fork activation can be changed for testing.</p>
</div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-dddc4982c7ea2b92d4b0de40" role="button"
                       aria-expanded="false" aria-controls="id-dddc4982c7ea2b92d4b0de40">
                        <code>cmd/geth/config.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/cmd/geth/config.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/cmd/geth/config.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+31</span></div>
                            <div class="text-start"><span class="text-danger">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-dddc4982c7ea2b92d4b0de40"><span class="term-fg1">diff --git go-ethereum&#47;cmd&#47;geth&#47;config.go op-geth&#47;cmd&#47;geth&#47;config.go</span>
<span class="term-fg1">index 522e5e22f2a9f8675f8fdb6393391f203128fa60..c76db472bb420cedc999ca761d8ac6bb6a86d58a 100644</span>
<span class="term-fg1">--- go-ethereum&#47;cmd&#47;geth&#47;config.go</span>
<span class="term-fg1">+++ op-geth&#47;cmd&#47;geth&#47;config.go</span>
<span class="term-fg36">@@ -174,6 +174,37 @@</span> 	if ctx.IsSet(utils.OverrideCancun.Name) {
 		v := ctx.Uint64(utils.OverrideCancun.Name)
 		cfg.Eth.OverrideCancun = &amp;v
 	}
<span class="term-fg32">+</span>
<span class="term-fg32">+	if ctx.IsSet(utils.OverrideOptimismCanyon.Name) {</span>
<span class="term-fg32">+		v := ctx.Uint64(utils.OverrideOptimismCanyon.Name)</span>
<span class="term-fg32">+		cfg.Eth.OverrideOptimismCanyon = &amp;v</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	if ctx.IsSet(utils.OverrideOptimismEcotone.Name) {</span>
<span class="term-fg32">+		v := ctx.Uint64(utils.OverrideOptimismEcotone.Name)</span>
<span class="term-fg32">+		cfg.Eth.OverrideOptimismEcotone = &amp;v</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	if ctx.IsSet(utils.OverrideOptimismFjord.Name) {</span>
<span class="term-fg32">+		v := ctx.Uint64(utils.OverrideOptimismFjord.Name)</span>
<span class="term-fg32">+		cfg.Eth.OverrideOptimismFjord = &amp;v</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	if ctx.IsSet(utils.OverrideOptimismGranite.Name) {</span>
<span class="term-fg32">+		v := ctx.Uint64(utils.OverrideOptimismGranite.Name)</span>
<span class="term-fg32">+		cfg.Eth.OverrideOptimismGranite = &amp;v</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	if ctx.IsSet(utils.OverrideOptimismHolocene.Name) {</span>
<span class="term-fg32">+		v := ctx.Uint64(utils.OverrideOptimismHolocene.Name)</span>
<span class="term-fg32">+		cfg.Eth.OverrideOptimismHolocene = &amp;v</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	if ctx.IsSet(utils.OverrideOptimismInterop.Name) {</span>
<span class="term-fg32">+		v := ctx.Uint64(utils.OverrideOptimismInterop.Name)</span>
<span class="term-fg32">+		cfg.Eth.OverrideOptimismInterop = &amp;v</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
 	if ctx.IsSet(utils.OverrideVerkle.Name) {
 		v := ctx.Uint64(utils.OverrideVerkle.Name)
 		cfg.Eth.OverrideVerkle = &amp;v</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-5adba51716df2b63eaa699e0" role="button"
                       aria-expanded="false" aria-controls="id-5adba51716df2b63eaa699e0">
                        <code>cmd/geth/main.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/cmd/geth/main.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/cmd/geth/main.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+26</span></div>
                            <div class="text-start"><span class="text-danger">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-5adba51716df2b63eaa699e0"><span class="term-fg1">diff --git go-ethereum&#47;cmd&#47;geth&#47;main.go op-geth&#47;cmd&#47;geth&#47;main.go</span>
<span class="term-fg1">index f6bb09ee54a546d8e97d4d1d8c451e2d6cd4b8b2..fbb6210c3562ec4d74a2312be6b6124fd6bb34e7 100644</span>
<span class="term-fg1">--- go-ethereum&#47;cmd&#47;geth&#47;main.go</span>
<span class="term-fg1">+++ op-geth&#47;cmd&#47;geth&#47;main.go</span>
<span class="term-fg36">@@ -66,10 +66,17 @@</span> 		utils.USBFlag,
 		utils.SmartCardDaemonPathFlag,
 		utils.OverrideCancun,
 		utils.OverrideVerkle,
<span class="term-fg32">+		utils.OverrideOptimismCanyon,</span>
<span class="term-fg32">+		utils.OverrideOptimismEcotone,</span>
<span class="term-fg32">+		utils.OverrideOptimismFjord,</span>
<span class="term-fg32">+		utils.OverrideOptimismGranite,</span>
<span class="term-fg32">+		utils.OverrideOptimismHolocene,</span>
<span class="term-fg32">+		utils.OverrideOptimismInterop,</span>
 		utils.EnablePersonal,
 		utils.TxPoolLocalsFlag,
 		utils.TxPoolNoLocalsFlag,
 		utils.TxPoolJournalFlag,
<span class="term-fg32">+		utils.TxPoolJournalRemotesFlag,</span>
 		utils.TxPoolRejournalFlag,
 		utils.TxPoolPriceLimitFlag,
 		utils.TxPoolPriceBumpFlag,
<span class="term-fg36">@@ -117,6 +124,7 @@</span> 		utils.MaxPeersFlag,
 		utils.MaxPendingPeersFlag,
 		utils.MiningEnabledFlag, &#47;&#47; deprecated
 		utils.MinerGasLimitFlag,
<span class="term-fg32">+		utils.MinerEffectiveGasLimitFlag,</span>
 		utils.MinerGasPriceFlag,
 		utils.MinerEtherbaseFlag, &#47;&#47; deprecated
 		utils.MinerExtraDataFlag,
<span class="term-fg36">@@ -145,6 +153,14 @@</span> 		utils.GpoBlocksFlag,
 		utils.GpoPercentileFlag,
 		utils.GpoMaxGasPriceFlag,
 		utils.GpoIgnoreGasPriceFlag,
<span class="term-fg32">+		utils.GpoMinSuggestedPriorityFeeFlag,</span>
<span class="term-fg32">+		utils.RollupSequencerHTTPFlag,</span>
<span class="term-fg32">+		utils.RollupHistoricalRPCFlag,</span>
<span class="term-fg32">+		utils.RollupHistoricalRPCTimeoutFlag,</span>
<span class="term-fg32">+		utils.RollupDisableTxPoolGossipFlag,</span>
<span class="term-fg32">+		utils.RollupComputePendingBlock,</span>
<span class="term-fg32">+		utils.RollupHaltOnIncompatibleProtocolVersionFlag,</span>
<span class="term-fg32">+		utils.RollupSuperchainUpgradesFlag,</span>
 		configFileFlag,
 		utils.LogDebugFlag,
 		utils.LogBacktraceAtFlag,
<span class="term-fg36">@@ -316,6 +332,9 @@</span>   5. Networking is disabled; there is no listen-address, the maximum number of peers is set
      to 0, and discovery is disabled.
 `)
&nbsp;
<span class="term-fg32">+	case ctx.IsSet(utils.OPNetworkFlag.Name):</span>
<span class="term-fg32">+		log.Info(&quot;Starting geth on an OP network...&quot;, &quot;network&quot;, ctx.String(utils.OPNetworkFlag.Name))</span>
<span class="term-fg32">+</span>
 	case !ctx.IsSet(utils.NetworkIdFlag.Name):
 		log.Info(&quot;Starting Geth on Ethereum mainnet...&quot;)
 	}
<span class="term-fg36">@@ -327,7 +346,14 @@</span> 			!ctx.IsSet(utils.SepoliaFlag.Name) &amp;&amp;
 			!ctx.IsSet(utils.GoerliFlag.Name) &amp;&amp;
 			!ctx.IsSet(utils.DeveloperFlag.Name) {
 			&#47;&#47; Nope, we&#39;re really on mainnet. Bump that cache up!
<span class="term-fg32">+			&#47;&#47; Note: If we don&#39;t set the OPNetworkFlag and have already initialized the database, we may hit this case.</span>
 			log.Info(&quot;Bumping default cache on mainnet&quot;, &quot;provided&quot;, ctx.Int(utils.CacheFlag.Name), &quot;updated&quot;, 4096)
<span class="term-fg32">+			ctx.Set(utils.CacheFlag.Name, strconv.Itoa(4096))</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	} else if ctx.String(utils.SyncModeFlag.Name) != &quot;light&quot; &amp;&amp; !ctx.IsSet(utils.CacheFlag.Name) &amp;&amp; ctx.IsSet(utils.OPNetworkFlag.Name) {</span>
<span class="term-fg32">+		&#47;&#47; We haven&#39;t set the cache, but may used the OP network flag we may be on an OP stack mainnet.</span>
<span class="term-fg32">+		if strings.Contains(ctx.String(utils.OPNetworkFlag.Name), &quot;mainnet&quot;) {</span>
<span class="term-fg32">+			log.Info(&quot;Bumping default cache on mainnet&quot;, &quot;provided&quot;, ctx.Int(utils.CacheFlag.Name), &quot;updated&quot;, 4096, &quot;network&quot;, ctx.String(utils.OPNetworkFlag.Name))</span>
 			ctx.Set(utils.CacheFlag.Name, strconv.Itoa(4096))
 		}
 	}</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-ff6d005840b40b29d5b77ffd" role="button"
                       aria-expanded="false" aria-controls="id-ff6d005840b40b29d5b77ffd">
                        <code>cmd/utils/flags.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/cmd/utils/flags.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/cmd/utils/flags.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+170</span></div>
                            <div class="text-start"><span class="text-danger">-6</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-ff6d005840b40b29d5b77ffd"><span class="term-fg1">diff --git go-ethereum&#47;cmd&#47;utils&#47;flags.go op-geth&#47;cmd&#47;utils&#47;flags.go</span>
<span class="term-fg1">index 46d380b98499c58527ca8c6026ebbcf27581446f..201a4944a137fa5d4b04b17b358205a276e618dd 100644</span>
<span class="term-fg1">--- go-ethereum&#47;cmd&#47;utils&#47;flags.go</span>
<span class="term-fg1">+++ op-geth&#47;cmd&#47;utils&#47;flags.go</span>
<span class="term-fg36">@@ -157,6 +157,15 @@</span> 		Name:     &quot;holesky&quot;,
 		Usage:    &quot;Holesky network: pre-configured proof-of-stake test network&quot;,
 		Category: flags.EthCategory,
 	}
<span class="term-fg32">+</span>
<span class="term-fg32">+	OPNetworkFlag = &amp;cli.StringFlag{</span>
<span class="term-fg32">+		Name:    &quot;op-network&quot;,</span>
<span class="term-fg32">+		Aliases: []string{&quot;beta.op-network&quot;},</span>
<span class="term-fg32">+		Usage: &quot;Select a pre-configured OP-Stack network (warning: op-mainnet and op-goerli require special sync,&quot; +</span>
<span class="term-fg32">+			&quot; datadir is recommended), options: &quot; + strings.Join(params.OPStackChainNames(), &quot;, &quot;),</span>
<span class="term-fg32">+		Category: flags.EthCategory,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
 	&#47;&#47; Dev mode
 	DeveloperFlag = &amp;cli.BoolFlag{
 		Name:     &quot;dev&quot;,
<span class="term-fg36">@@ -254,6 +263,36 @@</span> 		Name:     &quot;override.verkle&quot;,
 		Usage:    &quot;Manually specify the Verkle fork timestamp, overriding the bundled setting&quot;,
 		Category: flags.EthCategory,
 	}
<span class="term-fg32">+	OverrideOptimismCanyon = &amp;cli.Uint64Flag{</span>
<span class="term-fg32">+		Name:     &quot;override.canyon&quot;,</span>
<span class="term-fg32">+		Usage:    &quot;Manually specify the Optimism Canyon fork timestamp, overriding the bundled setting&quot;,</span>
<span class="term-fg32">+		Category: flags.EthCategory,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	OverrideOptimismEcotone = &amp;cli.Uint64Flag{</span>
<span class="term-fg32">+		Name:     &quot;override.ecotone&quot;,</span>
<span class="term-fg32">+		Usage:    &quot;Manually specify the Optimism Ecotone fork timestamp, overriding the bundled setting&quot;,</span>
<span class="term-fg32">+		Category: flags.EthCategory,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	OverrideOptimismFjord = &amp;cli.Uint64Flag{</span>
<span class="term-fg32">+		Name:     &quot;override.fjord&quot;,</span>
<span class="term-fg32">+		Usage:    &quot;Manually specify the Optimism Fjord fork timestamp, overriding the bundled setting&quot;,</span>
<span class="term-fg32">+		Category: flags.EthCategory,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	OverrideOptimismGranite = &amp;cli.Uint64Flag{</span>
<span class="term-fg32">+		Name:     &quot;override.granite&quot;,</span>
<span class="term-fg32">+		Usage:    &quot;Manually specify the Optimism Granite fork timestamp, overriding the bundled setting&quot;,</span>
<span class="term-fg32">+		Category: flags.EthCategory,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	OverrideOptimismHolocene = &amp;cli.Uint64Flag{</span>
<span class="term-fg32">+		Name:     &quot;override.holocene&quot;,</span>
<span class="term-fg32">+		Usage:    &quot;Manually specify the Optimism Holocene fork timestamp, overriding the bundled setting&quot;,</span>
<span class="term-fg32">+		Category: flags.EthCategory,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	OverrideOptimismInterop = &amp;cli.Uint64Flag{</span>
<span class="term-fg32">+		Name:     &quot;override.interop&quot;,</span>
<span class="term-fg32">+		Usage:    &quot;Manually specify the Optimsim Interop feature-set fork timestamp, overriding the bundled setting&quot;,</span>
<span class="term-fg32">+		Category: flags.EthCategory,</span>
<span class="term-fg32">+	}</span>
 	SyncModeFlag = &amp;flags.TextMarshalerFlag{
 		Name:     &quot;syncmode&quot;,
 		Usage:    `Blockchain sync mode (&quot;snap&quot; or &quot;full&quot;)`,
<span class="term-fg36">@@ -350,6 +389,11 @@</span> 	TxPoolJournalFlag = &amp;cli.StringFlag{
 		Name:     &quot;txpool.journal&quot;,
 		Usage:    &quot;Disk journal for local transaction to survive node restarts&quot;,
 		Value:    ethconfig.Defaults.TxPool.Journal,
<span class="term-fg32">+		Category: flags.TxPoolCategory,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	TxPoolJournalRemotesFlag = &amp;cli.BoolFlag{</span>
<span class="term-fg32">+		Name:     &quot;txpool.journalremotes&quot;,</span>
<span class="term-fg32">+		Usage:    &quot;Includes remote transactions in the journal&quot;,</span>
 		Category: flags.TxPoolCategory,
 	}
 	TxPoolRejournalFlag = &amp;cli.DurationFlag{
<span class="term-fg36">@@ -485,6 +529,12 @@</span> 		Usage:    &quot;Target gas ceiling for mined blocks&quot;,
 		Value:    ethconfig.Defaults.Miner.GasCeil,
 		Category: flags.MinerCategory,
 	}
<span class="term-fg32">+	MinerEffectiveGasLimitFlag = &amp;cli.Uint64Flag{</span>
<span class="term-fg32">+		Name:     &quot;miner.effectivegaslimit&quot;,</span>
<span class="term-fg32">+		Usage:    &quot;If non-zero, an effective gas limit to apply in addition to the block header gaslimit.&quot;,</span>
<span class="term-fg32">+		Value:    0,</span>
<span class="term-fg32">+		Category: flags.MinerCategory,</span>
<span class="term-fg32">+	}</span>
 	MinerGasPriceFlag = &amp;flags.BigFlag{
 		Name:     &quot;miner.gasprice&quot;,
 		Usage:    &quot;Minimum gas price for mining a transaction&quot;,
<span class="term-fg36">@@ -806,13 +856,14 @@</span> 		Name:     &quot;discovery.v4&quot;,
 		Aliases:  []string{&quot;discv4&quot;},
 		Usage:    &quot;Enables the V4 discovery mechanism&quot;,
 		Category: flags.NetworkingCategory,
<span class="term-fg31">-		Value:    true,</span>
<span class="term-fg32">+		Value:    false,</span>
 	}
 	DiscoveryV5Flag = &amp;cli.BoolFlag{
 		Name:     &quot;discovery.v5&quot;,
 		Aliases:  []string{&quot;discv5&quot;},
 		Usage:    &quot;Enables the experimental RLPx V5 (Topic Discovery) mechanism&quot;,
 		Category: flags.NetworkingCategory,
<span class="term-fg32">+		Value:    true,</span>
 	}
 	NetrestrictFlag = &amp;cli.StringFlag{
 		Name:     &quot;netrestrict&quot;,
<span class="term-fg36">@@ -870,6 +921,60 @@</span> 		Usage:    &quot;Gas price below which gpo will ignore transactions&quot;,
 		Value:    ethconfig.Defaults.GPO.IgnorePrice.Int64(),
 		Category: flags.GasPriceCategory,
 	}
<span class="term-fg32">+	GpoMinSuggestedPriorityFeeFlag = &amp;cli.Int64Flag{</span>
<span class="term-fg32">+		Name:     &quot;gpo.minsuggestedpriorityfee&quot;,</span>
<span class="term-fg32">+		Usage:    &quot;Minimum transaction priority fee to suggest. Used on OP chains when blocks are not full.&quot;,</span>
<span class="term-fg32">+		Value:    ethconfig.Defaults.GPO.MinSuggestedPriorityFee.Int64(),</span>
<span class="term-fg32">+		Category: flags.GasPriceCategory,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Rollup Flags</span>
<span class="term-fg32">+	RollupSequencerHTTPFlag = &amp;cli.StringFlag{</span>
<span class="term-fg32">+		Name:     &quot;rollup.sequencerhttp&quot;,</span>
<span class="term-fg32">+		Usage:    &quot;HTTP endpoint for the sequencer mempool&quot;,</span>
<span class="term-fg32">+		Category: flags.RollupCategory,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	RollupHistoricalRPCFlag = &amp;cli.StringFlag{</span>
<span class="term-fg32">+		Name:     &quot;rollup.historicalrpc&quot;,</span>
<span class="term-fg32">+		Usage:    &quot;RPC endpoint for historical data.&quot;,</span>
<span class="term-fg32">+		Category: flags.RollupCategory,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	RollupHistoricalRPCTimeoutFlag = &amp;cli.StringFlag{</span>
<span class="term-fg32">+		Name:     &quot;rollup.historicalrpctimeout&quot;,</span>
<span class="term-fg32">+		Usage:    &quot;Timeout for historical RPC requests.&quot;,</span>
<span class="term-fg32">+		Value:    &quot;5s&quot;,</span>
<span class="term-fg32">+		Category: flags.RollupCategory,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	RollupDisableTxPoolGossipFlag = &amp;cli.BoolFlag{</span>
<span class="term-fg32">+		Name:     &quot;rollup.disabletxpoolgossip&quot;,</span>
<span class="term-fg32">+		Usage:    &quot;Disable transaction pool gossip.&quot;,</span>
<span class="term-fg32">+		Category: flags.RollupCategory,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	RollupEnableTxPoolAdmissionFlag = &amp;cli.BoolFlag{</span>
<span class="term-fg32">+		Name:     &quot;rollup.enabletxpooladmission&quot;,</span>
<span class="term-fg32">+		Usage:    &quot;Add RPC-submitted transactions to the txpool (on by default if --rollup.sequencerhttp is not set).&quot;,</span>
<span class="term-fg32">+		Category: flags.RollupCategory,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	RollupComputePendingBlock = &amp;cli.BoolFlag{</span>
<span class="term-fg32">+		Name:     &quot;rollup.computependingblock&quot;,</span>
<span class="term-fg32">+		Usage:    &quot;By default the pending block equals the latest block to save resources and not leak txs from the tx-pool, this flag enables computing of the pending block from the tx-pool instead.&quot;,</span>
<span class="term-fg32">+		Category: flags.RollupCategory,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	RollupHaltOnIncompatibleProtocolVersionFlag = &amp;cli.StringFlag{</span>
<span class="term-fg32">+		Name:     &quot;rollup.halt&quot;,</span>
<span class="term-fg32">+		Usage:    &quot;Opt-in option to halt on incompatible protocol version requirements of the given level (major&#47;minor&#47;patch&#47;none), as signaled through the Engine API by the rollup node&quot;,</span>
<span class="term-fg32">+		Category: flags.RollupCategory,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	RollupSuperchainUpgradesFlag = &amp;cli.BoolFlag{</span>
<span class="term-fg32">+		Name:     &quot;rollup.superchain-upgrades&quot;,</span>
<span class="term-fg32">+		Aliases:  []string{&quot;beta.rollup.superchain-upgrades&quot;},</span>
<span class="term-fg32">+		Usage:    &quot;Apply superchain-registry config changes to the local chain-configuration&quot;,</span>
<span class="term-fg32">+		Category: flags.RollupCategory,</span>
<span class="term-fg32">+		Value:    true,</span>
<span class="term-fg32">+	}</span>
&nbsp;
 	&#47;&#47; Metrics flags
 	MetricsEnabledFlag = &amp;cli.BoolFlag{
<span class="term-fg36">@@ -969,7 +1074,7 @@</span> 		SepoliaFlag,
 		HoleskyFlag,
 	}
 	&#47;&#47; NetworkFlags is the flag group of all built-in supported networks.
<span class="term-fg31">-	NetworkFlags = append([]cli.Flag{MainnetFlag}, TestnetFlags...)</span>
<span class="term-fg32">+	NetworkFlags = append([]cli.Flag{MainnetFlag, OPNetworkFlag}, TestnetFlags...)</span>
&nbsp;
 	&#47;&#47; DatabaseFlags is the flag group of all database flags.
 	DatabaseFlags = []cli.Flag{
<span class="term-fg36">@@ -995,6 +1100,9 @@</span> 			return filepath.Join(path, &quot;sepolia&quot;)
 		}
 		if ctx.Bool(HoleskyFlag.Name) {
 			return filepath.Join(path, &quot;holesky&quot;)
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		if ctx.IsSet(OPNetworkFlag.Name) {</span>
<span class="term-fg32">+			return filepath.Join(path, ctx.String(OPNetworkFlag.Name))</span>
 		}
 		return path
 	}
<span class="term-fg36">@@ -1087,6 +1195,13 @@</span> 	case ctx.IsSet(BootnodesFlag.Name):
 		urls = SplitAndTrim(ctx.String(BootnodesFlag.Name))
 	case cfg.BootstrapNodesV5 != nil:
 		return &#47;&#47; already set, don&#39;t apply defaults.
<span class="term-fg32">+	case ctx.IsSet(OPNetworkFlag.Name):</span>
<span class="term-fg32">+		network := ctx.String(OPNetworkFlag.Name)</span>
<span class="term-fg32">+		if strings.Contains(strings.ToLower(network), &quot;mainnet&quot;) {</span>
<span class="term-fg32">+			urls = params.V5OPBootnodes</span>
<span class="term-fg32">+		} else {</span>
<span class="term-fg32">+			urls = params.V5OPTestnetBootnodes</span>
<span class="term-fg32">+		}</span>
 	}
&nbsp;
 	cfg.BootstrapNodesV5 = make([]*enode.Node, 0, len(urls))
<span class="term-fg36">@@ -1489,6 +1604,8 @@</span> 	case ctx.Bool(SepoliaFlag.Name) &amp;&amp; cfg.DataDir == node.DefaultDataDir():
 		cfg.DataDir = filepath.Join(node.DefaultDataDir(), &quot;sepolia&quot;)
 	case ctx.Bool(HoleskyFlag.Name) &amp;&amp; cfg.DataDir == node.DefaultDataDir():
 		cfg.DataDir = filepath.Join(node.DefaultDataDir(), &quot;holesky&quot;)
<span class="term-fg32">+	case ctx.IsSet(OPNetworkFlag.Name) &amp;&amp; cfg.DataDir == node.DefaultDataDir():</span>
<span class="term-fg32">+		cfg.DataDir = filepath.Join(node.DefaultDataDir(), ctx.String(OPNetworkFlag.Name))</span>
 	}
 }
&nbsp;
<span class="term-fg36">@@ -1505,6 +1622,9 @@</span> 	}
 	if ctx.IsSet(GpoIgnoreGasPriceFlag.Name) {
 		cfg.IgnorePrice = big.NewInt(ctx.Int64(GpoIgnoreGasPriceFlag.Name))
 	}
<span class="term-fg32">+	if ctx.IsSet(GpoMinSuggestedPriorityFeeFlag.Name) {</span>
<span class="term-fg32">+		cfg.MinSuggestedPriorityFee = big.NewInt(ctx.Int64(GpoMinSuggestedPriorityFeeFlag.Name))</span>
<span class="term-fg32">+	}</span>
 }
&nbsp;
 func setTxPool(ctx *cli.Context, cfg *legacypool.Config) {
<span class="term-fg36">@@ -1524,6 +1644,9 @@</span> 	}
 	if ctx.IsSet(TxPoolJournalFlag.Name) {
 		cfg.Journal = ctx.String(TxPoolJournalFlag.Name)
 	}
<span class="term-fg32">+	if ctx.IsSet(TxPoolJournalRemotesFlag.Name) {</span>
<span class="term-fg32">+		cfg.JournalRemote = ctx.Bool(TxPoolJournalRemotesFlag.Name)</span>
<span class="term-fg32">+	}</span>
 	if ctx.IsSet(TxPoolRejournalFlag.Name) {
 		cfg.Rejournal = ctx.Duration(TxPoolRejournalFlag.Name)
 	}
<span class="term-fg36">@@ -1547,6 +1670,11 @@</span> 		cfg.GlobalQueue = ctx.Uint64(TxPoolGlobalQueueFlag.Name)
 	}
 	if ctx.IsSet(TxPoolLifetimeFlag.Name) {
 		cfg.Lifetime = ctx.Duration(TxPoolLifetimeFlag.Name)
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if ctx.IsSet(MinerEffectiveGasLimitFlag.Name) {</span>
<span class="term-fg32">+		&#47;&#47; While technically this is a miner config parameter, we also want the txpool to enforce</span>
<span class="term-fg32">+		&#47;&#47; it to avoid accepting transactions that can never be included in a block.</span>
<span class="term-fg32">+		cfg.EffectiveGasCeil = ctx.Uint64(MinerEffectiveGasLimitFlag.Name)</span>
 	}
 }
&nbsp;
<span class="term-fg36">@@ -1560,6 +1688,9 @@</span> 	}
 	if ctx.IsSet(MinerGasLimitFlag.Name) {
 		cfg.GasCeil = ctx.Uint64(MinerGasLimitFlag.Name)
 	}
<span class="term-fg32">+	if ctx.IsSet(MinerEffectiveGasLimitFlag.Name) {</span>
<span class="term-fg32">+		cfg.EffectiveGasCeil = ctx.Uint64(MinerEffectiveGasLimitFlag.Name)</span>
<span class="term-fg32">+	}</span>
 	if ctx.IsSet(MinerGasPriceFlag.Name) {
 		cfg.GasPrice = flags.GlobalBig(ctx, MinerGasPriceFlag.Name)
 	}
<span class="term-fg36">@@ -1569,6 +1700,9 @@</span> 	}
 	if ctx.IsSet(MinerNewPayloadTimeoutFlag.Name) {
 		log.Warn(&quot;The flag --miner.newpayload-timeout is deprecated and will be removed, please use --miner.recommit&quot;)
 		cfg.Recommit = ctx.Duration(MinerNewPayloadTimeoutFlag.Name)
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if ctx.IsSet(RollupComputePendingBlock.Name) {</span>
<span class="term-fg32">+		cfg.RollupComputePendingBlock = ctx.Bool(RollupComputePendingBlock.Name)</span>
 	}
 }
&nbsp;
<span class="term-fg36">@@ -1644,7 +1778,7 @@</span>
 &#47;&#47; SetEthConfig applies eth-related command line flags to the config.
 func SetEthConfig(ctx *cli.Context, stack *node.Node, cfg *ethconfig.Config) {
 	&#47;&#47; Avoid conflicting network flags
<span class="term-fg31">-	CheckExclusive(ctx, MainnetFlag, DeveloperFlag, GoerliFlag, SepoliaFlag, HoleskyFlag)</span>
<span class="term-fg32">+	CheckExclusive(ctx, MainnetFlag, DeveloperFlag, GoerliFlag, SepoliaFlag, HoleskyFlag, OPNetworkFlag)</span>
 	CheckExclusive(ctx, DeveloperFlag, ExternalSignerFlag) &#47;&#47; Can&#39;t use both ephemeral unlocked and external signer
&nbsp;
 	&#47;&#47; Set configurations from CLI flags
<span class="term-fg36">@@ -1793,6 +1927,20 @@</span> 		} else {
 			cfg.EthDiscoveryURLs = SplitAndTrim(urls)
 		}
 	}
<span class="term-fg32">+	&#47;&#47; Only configure sequencer http flag if we&#39;re running in verifier mode i.e. --mine is disabled.</span>
<span class="term-fg32">+	if ctx.IsSet(RollupSequencerHTTPFlag.Name) &amp;&amp; !ctx.IsSet(MiningEnabledFlag.Name) {</span>
<span class="term-fg32">+		cfg.RollupSequencerHTTP = ctx.String(RollupSequencerHTTPFlag.Name)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if ctx.IsSet(RollupHistoricalRPCFlag.Name) {</span>
<span class="term-fg32">+		cfg.RollupHistoricalRPC = ctx.String(RollupHistoricalRPCFlag.Name)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if ctx.IsSet(RollupHistoricalRPCTimeoutFlag.Name) {</span>
<span class="term-fg32">+		cfg.RollupHistoricalRPCTimeout = ctx.Duration(RollupHistoricalRPCTimeoutFlag.Name)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	cfg.RollupDisableTxPoolGossip = ctx.Bool(RollupDisableTxPoolGossipFlag.Name)</span>
<span class="term-fg32">+	cfg.RollupDisableTxPoolAdmission = cfg.RollupSequencerHTTP != &quot;&quot; &amp;&amp; !ctx.Bool(RollupEnableTxPoolAdmissionFlag.Name)</span>
<span class="term-fg32">+	cfg.RollupHaltOnIncompatibleProtocolVersion = ctx.String(RollupHaltOnIncompatibleProtocolVersionFlag.Name)</span>
<span class="term-fg32">+	cfg.ApplySuperchainUpgrades = ctx.Bool(RollupSuperchainUpgradesFlag.Name)</span>
 	&#47;&#47; Override any default configs for hard coded networks.
 	switch {
 	case ctx.Bool(MainnetFlag.Name):
<span class="term-fg36">@@ -1874,7 +2022,7 @@</span> 			chaindb := tryMakeReadOnlyDatabase(ctx, stack)
 			if rawdb.ReadCanonicalHash(chaindb, 0) != (common.Hash{}) {
 				cfg.Genesis = nil &#47;&#47; fallback to db content
&nbsp;
<span class="term-fg31">-				&#47;&#47;validate genesis has PoS enabled in block 0</span>
<span class="term-fg32">+				&#47;&#47; validate genesis has PoS enabled in block 0</span>
 				genesis, err := core.ReadGenesis(chaindb)
 				if err != nil {
 					Fatalf(&quot;Could not read genesis from database: %v&quot;, err)
<span class="term-fg36">@@ -1896,6 +2044,12 @@</span> 		}
 		if !ctx.IsSet(MinerGasPriceFlag.Name) {
 			cfg.Miner.GasPrice = big.NewInt(1)
 		}
<span class="term-fg32">+	case ctx.IsSet(OPNetworkFlag.Name):</span>
<span class="term-fg32">+		genesis := MakeGenesis(ctx)</span>
<span class="term-fg32">+		if !ctx.IsSet(NetworkIdFlag.Name) {</span>
<span class="term-fg32">+			cfg.NetworkId = genesis.Config.ChainID.Uint64()</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		cfg.Genesis = genesis</span>
 	default:
 		if cfg.NetworkId == 1 {
 			SetDNSDiscoveryDefaults(cfg, params.MainnetGenesisHash)
<span class="term-fg36">@@ -2099,8 +2253,7 @@</span> }
&nbsp;
 func IsNetworkPreset(ctx *cli.Context) bool {
 	for _, flag := range NetworkFlags {
<span class="term-fg31">-		bFlag, _ := flag.(*cli.BoolFlag)</span>
<span class="term-fg31">-		if ctx.IsSet(bFlag.Name) {</span>
<span class="term-fg32">+		if ctx.IsSet(flag.Names()[0]) {</span>
 			return true
 		}
 	}
<span class="term-fg36">@@ -2142,6 +2295,17 @@</span> 	case ctx.Bool(SepoliaFlag.Name):
 		genesis = core.DefaultSepoliaGenesisBlock()
 	case ctx.Bool(GoerliFlag.Name):
 		genesis = core.DefaultGoerliGenesisBlock()
<span class="term-fg32">+	case ctx.IsSet(OPNetworkFlag.Name):</span>
<span class="term-fg32">+		name := ctx.String(OPNetworkFlag.Name)</span>
<span class="term-fg32">+		ch, err := params.OPStackChainIDByName(name)</span>
<span class="term-fg32">+		if err != nil {</span>
<span class="term-fg32">+			Fatalf(&quot;failed to load OP-Stack chain %q: %v&quot;, name, err)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		genesis, err := core.LoadOPStackGenesis(ch)</span>
<span class="term-fg32">+		if err != nil {</span>
<span class="term-fg32">+			Fatalf(&quot;failed to load genesis for OP-Stack chain %q (%d): %v&quot;, name, ch, err)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		return genesis</span>
 	case ctx.Bool(DeveloperFlag.Name):
 		Fatalf(&quot;Developer chains are ephemeral&quot;)
 	}</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-5583a58cb87ede60ee474189" role="button"
                       aria-expanded="false" aria-controls="id-5583a58cb87ede60ee474189">
                        <code>internal/flags/categories.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/internal/flags/categories.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/internal/flags/categories.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+1</span></div>
                            <div class="text-start"><span class="text-danger">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-5583a58cb87ede60ee474189"><span class="term-fg1">diff --git go-ethereum&#47;internal&#47;flags&#47;categories.go op-geth&#47;internal&#47;flags&#47;categories.go</span>
<span class="term-fg1">index d426add55b10b62cc75ba4f294f9f2fd1b4ae06a..d9c2d9894afae2099988e8b2729454d77509ae11 100644</span>
<span class="term-fg1">--- go-ethereum&#47;internal&#47;flags&#47;categories.go</span>
<span class="term-fg1">+++ op-geth&#47;internal&#47;flags&#47;categories.go</span>
<span class="term-fg36">@@ -32,6 +32,7 @@</span> 	NetworkingCategory = &quot;NETWORKING&quot;
 	MinerCategory      = &quot;MINER&quot;
 	GasPriceCategory   = &quot;GAS PRICE ORACLE&quot;
 	VMCategory         = &quot;VIRTUAL MACHINE&quot;
<span class="term-fg32">+	RollupCategory     = &quot;ROLLUP NODE&quot;</span>
 	LoggingCategory    = &quot;LOGGING AND DEBUGGING&quot;
 	MetricsCategory    = &quot;METRICS AND STATS&quot;
 	MiscCategory       = &quot;MISC&quot;</div>
    </div>

            
            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-52887ec530b50d4c0de7eae8"role="button" aria-expanded="false" aria-controls="id-52887ec530b50d4c0de7eae8">
        
            <div class="col-12 col-md-12 col-lg-6 col-xl-6 text-start"><h4>Versioning</h4></div>
        

        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2">
            <div class="row line-stat">
                
                
            </div>
        </div>
        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2 ">
            <div class="row line-stat">
                
                    <div class="text-end"><span class="text-success">+60</span></div>
                    <div class="text-start"><span class="text-danger">-9</span></div>
                
                
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-52887ec530b50d4c0de7eae8">
        <div><p>List the op-geth and upstream go-ethereum versions.</p>
</div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-654ec51db81d9464f069822b" role="button"
                       aria-expanded="false" aria-controls="id-654ec51db81d9464f069822b">
                        <code>build/ci.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/build/ci.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/build/ci.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+7</span></div>
                            <div class="text-start"><span class="text-danger">-4</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-654ec51db81d9464f069822b"><span class="term-fg1">diff --git go-ethereum&#47;build&#47;ci.go op-geth&#47;build&#47;ci.go</span>
<span class="term-fg1">index db576337043139a4755baeb8838cb4396e0a4e75..e2d3f41162ce806ba66f47537202e2c4fd030427 100644</span>
<span class="term-fg1">--- go-ethereum&#47;build&#47;ci.go</span>
<span class="term-fg1">+++ op-geth&#47;build&#47;ci.go</span>
<span class="term-fg36">@@ -243,6 +243,9 @@</span> 	if env.Commit != &quot;&quot; {
 		ld = append(ld, &quot;-X&quot;, &quot;github.com&#47;ethereum&#47;go-ethereum&#47;internal&#47;version.gitCommit=&quot;+env.Commit)
 		ld = append(ld, &quot;-X&quot;, &quot;github.com&#47;ethereum&#47;go-ethereum&#47;internal&#47;version.gitDate=&quot;+env.Date)
 	}
<span class="term-fg32">+	if env.Tag != &quot;&quot; {</span>
<span class="term-fg32">+		ld = append(ld, &quot;-X&quot;, &quot;github.com&#47;ethereum&#47;go-ethereum&#47;params.gitTag=&quot;+env.Tag)</span>
<span class="term-fg32">+	}</span>
 	&#47;&#47; Strip DWARF on darwin. This used to be required for certain things,
 	&#47;&#47; and there is no downside to this, so we just keep doing it.
 	if runtime.GOOS == &quot;darwin&quot; {
<span class="term-fg36">@@ -707,7 +710,7 @@</span> 	switch {
 	case env.Branch == &quot;master&quot;:
 		tags = []string{&quot;latest&quot;}
 	case strings.HasPrefix(env.Tag, &quot;v1.&quot;):
<span class="term-fg31">-		tags = []string{&quot;stable&quot;, fmt.Sprintf(&quot;release-1.%d&quot;, params.VersionMinor), &quot;v&quot; + params.Version}</span>
<span class="term-fg32">+		tags = []string{&quot;stable&quot;, fmt.Sprintf(&quot;release-1.%d&quot;, params.OPVersionMinor), &quot;v&quot; + params.Version}</span>
 	}
 	&#47;&#47; If architecture specific image builds are requested, build and push them
 	if *image {
<span class="term-fg36">@@ -1006,10 +1009,10 @@</span> 	return wdflag
 }
&nbsp;
 func isUnstableBuild(env build.Environment) bool {
<span class="term-fg31">-	if env.Tag != &quot;&quot; {</span>
<span class="term-fg31">-		return false</span>
<span class="term-fg32">+	if env.Tag == &quot;untagged&quot; || env.Tag == &quot;&quot; {</span>
<span class="term-fg32">+		return true</span>
 	}
<span class="term-fg31">-	return true</span>
<span class="term-fg32">+	return false</span>
 }
&nbsp;
 type debPackage struct {</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-aef7a0d0b570da5ed1ead7ea" role="button"
                       aria-expanded="false" aria-controls="id-aef7a0d0b570da5ed1ead7ea">
                        <code>cmd/geth/misccmd.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/cmd/geth/misccmd.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/cmd/geth/misccmd.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+1</span></div>
                            <div class="text-start"><span class="text-danger">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-aef7a0d0b570da5ed1ead7ea"><span class="term-fg1">diff --git go-ethereum&#47;cmd&#47;geth&#47;misccmd.go op-geth&#47;cmd&#47;geth&#47;misccmd.go</span>
<span class="term-fg1">index f3530c30fb69fe08024d9f62a1a377d416c684d9..e7fb108ebfb6a065eb1232ced8fcdf1c49eee4c5 100644</span>
<span class="term-fg1">--- go-ethereum&#47;cmd&#47;geth&#47;misccmd.go</span>
<span class="term-fg1">+++ op-geth&#47;cmd&#47;geth&#47;misccmd.go</span>
<span class="term-fg36">@@ -80,6 +80,7 @@</span> 	}
 	if git.Date != &quot;&quot; {
 		fmt.Println(&quot;Git Commit Date:&quot;, git.Date)
 	}
<span class="term-fg32">+	fmt.Println(&quot;Upstream Version:&quot;, params.GethVersionWithMeta)</span>
 	fmt.Println(&quot;Architecture:&quot;, runtime.GOARCH)
 	fmt.Println(&quot;Go Version:&quot;, runtime.Version())
 	fmt.Println(&quot;Operating System:&quot;, runtime.GOOS)</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-e21d058efbdce2729f71ed53" role="button"
                       aria-expanded="false" aria-controls="id-e21d058efbdce2729f71ed53">
                        <code>params/version.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/params/version.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/params/version.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+52</span></div>
                            <div class="text-start"><span class="text-danger">-5</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-e21d058efbdce2729f71ed53"><span class="term-fg1">diff --git go-ethereum&#47;params&#47;version.go op-geth&#47;params&#47;version.go</span>
<span class="term-fg1">index c4e1274ad2dafcdbfa46638733c9056ada50c676..765b484bbe76a06107c5f6257a4b469ef8eb763e 100644</span>
<span class="term-fg1">--- go-ethereum&#47;params&#47;version.go</span>
<span class="term-fg1">+++ op-geth&#47;params&#47;version.go</span>
<span class="term-fg36">@@ -18,8 +18,11 @@</span> package params
&nbsp;
 import (
 	&quot;fmt&quot;
<span class="term-fg32">+	&quot;regexp&quot;</span>
<span class="term-fg32">+	&quot;strconv&quot;</span>
 )
&nbsp;
<span class="term-fg32">+&#47;&#47; Version is the version of upstream geth</span>
 const (
 	VersionMajor = 1        &#47;&#47; Major version component of the current release
 	VersionMinor = 14       &#47;&#47; Minor version component of the current release
<span class="term-fg36">@@ -27,14 +30,58 @@</span> 	VersionPatch = 7        &#47;&#47; Patch version component of the current release
 	VersionMeta  = &quot;stable&quot; &#47;&#47; Version metadata to append to the version string
 )
&nbsp;
<span class="term-fg32">+&#47;&#47; OPVersion is the version of op-geth</span>
<span class="term-fg32">+var (</span>
<span class="term-fg32">+	OPVersionMajor = 0          &#47;&#47; Major version component of the current release</span>
<span class="term-fg32">+	OPVersionMinor = 1          &#47;&#47; Minor version component of the current release</span>
<span class="term-fg32">+	OPVersionPatch = 0          &#47;&#47; Patch version component of the current release</span>
<span class="term-fg32">+	OPVersionMeta  = &quot;untagged&quot; &#47;&#47; Version metadata to append to the version string</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; This is set at build-time by the linker when the build is done by build&#47;ci.go.</span>
<span class="term-fg32">+var gitTag string</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; Override the version variables if the gitTag was set at build time.</span>
<span class="term-fg32">+var _ = func() (_ string) {</span>
<span class="term-fg32">+	semver := regexp.MustCompile(`^v([0-9]+)\.([0-9]+)\.([0-9]+)(?:-([0-9A-Za-z-]+(?:\.[0-9A-Za-z-]+)*))?(?:\+[0-9A-Za-z-]+)?$`)</span>
<span class="term-fg32">+	version := semver.FindStringSubmatch(gitTag)</span>
<span class="term-fg32">+	if version == nil {</span>
<span class="term-fg32">+		return</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if version[4] == &quot;&quot; {</span>
<span class="term-fg32">+		version[4] = &quot;stable&quot;</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	OPVersionMajor, _ = strconv.Atoi(version[1])</span>
<span class="term-fg32">+	OPVersionMinor, _ = strconv.Atoi(version[2])</span>
<span class="term-fg32">+	OPVersionPatch, _ = strconv.Atoi(version[3])</span>
<span class="term-fg32">+	OPVersionMeta = version[4]</span>
<span class="term-fg32">+	return</span>
<span class="term-fg32">+}()</span>
<span class="term-fg32">+</span>
 &#47;&#47; Version holds the textual version string.
 var Version = func() string {
<span class="term-fg31">-	return fmt.Sprintf(&quot;%d.%d.%d&quot;, VersionMajor, VersionMinor, VersionPatch)</span>
<span class="term-fg32">+	if OPVersionMeta == &quot;untagged&quot; {</span>
<span class="term-fg32">+		return OPVersionMeta</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	return fmt.Sprintf(&quot;%d.%d.%d&quot;, OPVersionMajor, OPVersionMinor, OPVersionPatch)</span>
 }()
&nbsp;
 &#47;&#47; VersionWithMeta holds the textual version string including the metadata.
 var VersionWithMeta = func() string {
<span class="term-fg31">-	v := Version</span>
<span class="term-fg32">+	if OPVersionMeta != &quot;untagged&quot; {</span>
<span class="term-fg32">+		return Version + &quot;-&quot; + OPVersionMeta</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	return Version</span>
<span class="term-fg32">+}()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; GethVersion holds the textual geth version string.</span>
<span class="term-fg32">+var GethVersion = func() string {</span>
<span class="term-fg32">+	return fmt.Sprintf(&quot;%d.%d.%d&quot;, VersionMajor, VersionMinor, VersionPatch)</span>
<span class="term-fg32">+}()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; GethVersionWithMeta holds the textual geth version string including the metadata.</span>
<span class="term-fg32">+var GethVersionWithMeta = func() string {</span>
<span class="term-fg32">+	v := GethVersion</span>
 	if VersionMeta != &quot;&quot; {
 		v += &quot;-&quot; + VersionMeta
 	}
<span class="term-fg36">@@ -46,8 +93,8 @@</span> &#47;&#47; &quot;1.8.11-dea1ce05&quot; for stable releases, or &quot;1.8.13-unstable-21c059b6&quot; for unstable
 &#47;&#47; releases.
 func ArchiveVersion(gitCommit string) string {
 	vsn := Version
<span class="term-fg31">-	if VersionMeta != &quot;stable&quot; {</span>
<span class="term-fg31">-		vsn += &quot;-&quot; + VersionMeta</span>
<span class="term-fg32">+	if OPVersionMeta != &quot;stable&quot; {</span>
<span class="term-fg32">+		vsn += &quot;-&quot; + OPVersionMeta</span>
 	}
 	if len(gitCommit) &gt;= 8 {
 		vsn += &quot;-&quot; + gitCommit[:8]
<span class="term-fg36">@@ -60,7 +107,7 @@</span> 	vsn := VersionWithMeta
 	if len(gitCommit) &gt;= 8 {
 		vsn += &quot;-&quot; + gitCommit[:8]
 	}
<span class="term-fg31">-	if (VersionMeta != &quot;stable&quot;) &amp;&amp; (gitDate != &quot;&quot;) {</span>
<span class="term-fg32">+	if (OPVersionMeta != &quot;stable&quot;) &amp;&amp; (gitDate != &quot;&quot;) {</span>
 		vsn += &quot;-&quot; + gitDate
 	}
 	return vsn</div>
    </div>

            
            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
        </div>
    </div>
</div>

            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-5e0e78f49404eb30c82891ac"role="button" aria-expanded="false" aria-controls="id-5e0e78f49404eb30c82891ac">
        
            <div class="col-12 col-md-12 col-lg-6 col-xl-6 text-start"><h3>Node config</h3></div>
        

        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2">
            <div class="row line-stat">
                
                
            </div>
        </div>
        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2 ">
            <div class="row line-stat">
                
                    <div class="text-end"><span class="text-success">+32</span></div>
                    <div class="text-start"><span class="text-danger">-6</span></div>
                
                
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-5e0e78f49404eb30c82891ac">
        <div></div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-5d0becf8450ed07fd96f5449" role="button"
                       aria-expanded="false" aria-controls="id-5d0becf8450ed07fd96f5449">
                        <code>eth/ethconfig/config.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/eth/ethconfig/config.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/eth/ethconfig/config.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+32</span></div>
                            <div class="text-start"><span class="text-danger">-6</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-5d0becf8450ed07fd96f5449"><span class="term-fg1">diff --git go-ethereum&#47;eth&#47;ethconfig&#47;config.go op-geth&#47;eth&#47;ethconfig&#47;config.go</span>
<span class="term-fg1">index 7453fb1efdd3ef433d0eada50ca3640575feae10..2dc03013d532c7afecf9b6a4187015caa5738d69 100644</span>
<span class="term-fg1">--- go-ethereum&#47;eth&#47;ethconfig&#47;config.go</span>
<span class="term-fg1">+++ op-geth&#47;eth&#47;ethconfig&#47;config.go</span>
<span class="term-fg36">@@ -38,12 +38,13 @@</span> )
&nbsp;
 &#47;&#47; FullNodeGPO contains default gasprice oracle settings for full node.
 var FullNodeGPO = gasprice.Config{
<span class="term-fg31">-	Blocks:           20,</span>
<span class="term-fg31">-	Percentile:       60,</span>
<span class="term-fg31">-	MaxHeaderHistory: 1024,</span>
<span class="term-fg31">-	MaxBlockHistory:  1024,</span>
<span class="term-fg31">-	MaxPrice:         gasprice.DefaultMaxPrice,</span>
<span class="term-fg31">-	IgnorePrice:      gasprice.DefaultIgnorePrice,</span>
<span class="term-fg32">+	Blocks:                  20,</span>
<span class="term-fg32">+	Percentile:              60,</span>
<span class="term-fg32">+	MaxHeaderHistory:        1024,</span>
<span class="term-fg32">+	MaxBlockHistory:         1024,</span>
<span class="term-fg32">+	MaxPrice:                gasprice.DefaultMaxPrice,</span>
<span class="term-fg32">+	IgnorePrice:             gasprice.DefaultIgnorePrice,</span>
<span class="term-fg32">+	MinSuggestedPriorityFee: gasprice.DefaultMinSuggestedPriorityFee,</span>
 }
&nbsp;
 &#47;&#47; Defaults contains default settings for use on the Ethereum main net.
<span class="term-fg36">@@ -166,12 +167,37 @@</span> 	OverrideCancun *uint64 `toml:&quot;,omitempty&quot;`
&nbsp;
 	&#47;&#47; OverrideVerkle (TODO: remove after the fork)
 	OverrideVerkle *uint64 `toml:&quot;,omitempty&quot;`
<span class="term-fg32">+</span>
<span class="term-fg32">+	OverrideOptimismCanyon *uint64 `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	OverrideOptimismEcotone *uint64 `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	OverrideOptimismFjord *uint64 `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	OverrideOptimismGranite *uint64 `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	OverrideOptimismHolocene *uint64 `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	OverrideOptimismInterop *uint64 `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; ApplySuperchainUpgrades requests the node to load chain-configuration from the superchain-registry.</span>
<span class="term-fg32">+	ApplySuperchainUpgrades bool `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	RollupSequencerHTTP                     string</span>
<span class="term-fg32">+	RollupHistoricalRPC                     string</span>
<span class="term-fg32">+	RollupHistoricalRPCTimeout              time.Duration</span>
<span class="term-fg32">+	RollupDisableTxPoolGossip               bool</span>
<span class="term-fg32">+	RollupDisableTxPoolAdmission            bool</span>
<span class="term-fg32">+	RollupHaltOnIncompatibleProtocolVersion string</span>
 }
&nbsp;
 &#47;&#47; CreateConsensusEngine creates a consensus engine for the given chain config.
 &#47;&#47; Clique is allowed for now to live standalone, but ethash is forbidden and can
 &#47;&#47; only exist on already merged networks.
 func CreateConsensusEngine(config *params.ChainConfig, db ethdb.Database) (consensus.Engine, error) {
<span class="term-fg32">+	if config.Optimism != nil {</span>
<span class="term-fg32">+		return beacon.New(&amp;beacon.OpLegacy{}), nil</span>
<span class="term-fg32">+	}</span>
 	&#47;&#47; Geth v1.14.0 dropped support for non-merged networks in any consensus
 	&#47;&#47; mode. If such a network is requested, reject startup.
 	if !config.TerminalTotalDifficultyPassed {</div>
    </div>

            
            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-2c5c574335bf213632e5e6fd"role="button" aria-expanded="false" aria-controls="id-2c5c574335bf213632e5e6fd">
        
            <div class="col-12 col-md-12 col-lg-6 col-xl-6 text-start"><h3>Tx gossip disable option</h3></div>
        

        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2">
            <div class="row line-stat">
                
                
            </div>
        </div>
        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2 ">
            <div class="row line-stat">
                
                    <div class="text-end"><span class="text-success">+32</span></div>
                    <div class="text-start"><span class="text-danger">-4</span></div>
                
                
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-2c5c574335bf213632e5e6fd">
        <div></div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-e66fc1f94aa1afa74c1edcbc" role="button"
                       aria-expanded="false" aria-controls="id-e66fc1f94aa1afa74c1edcbc">
                        <code>eth/handler.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/eth/handler.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/eth/handler.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+14</span></div>
                            <div class="text-start"><span class="text-danger">-3</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-e66fc1f94aa1afa74c1edcbc"><span class="term-fg1">diff --git go-ethereum&#47;eth&#47;handler.go op-geth&#47;eth&#47;handler.go</span>
<span class="term-fg1">index d5117584c0014e24f8f6267054f33fff752c8dad..7e1a9f2191f6d94f67829bb89b4c0814fa7201bc 100644</span>
<span class="term-fg1">--- go-ethereum&#47;eth&#47;handler.go</span>
<span class="term-fg1">+++ op-geth&#47;eth&#47;handler.go</span>
<span class="term-fg36">@@ -93,6 +93,7 @@</span> 	Sync           downloader.SyncMode    &#47;&#47; Whether to snap or full sync
 	BloomCache     uint64                 &#47;&#47; Megabytes to alloc for snap sync bloom
 	EventMux       *event.TypeMux         &#47;&#47; Legacy event mux, deprecate for `feed`
 	RequiredBlocks map[uint64]common.Hash &#47;&#47; Hard coded map of required block hashes for sync challenges
<span class="term-fg32">+	NoTxGossip     bool                   &#47;&#47; Disable P2P transaction gossip</span>
 }
&nbsp;
 type handler struct {
<span class="term-fg36">@@ -107,6 +108,8 @@</span> 	database ethdb.Database
 	txpool   txPool
 	chain    *core.BlockChain
 	maxPeers int
<span class="term-fg32">+</span>
<span class="term-fg32">+	noTxGossip bool</span>
&nbsp;
 	downloader *downloader.Downloader
 	txFetcher  *fetcher.TxFetcher
<span class="term-fg36">@@ -140,6 +143,7 @@</span> 		forkFilter:     forkid.NewFilter(config.Chain),
 		eventMux:       config.EventMux,
 		database:       config.Database,
 		txpool:         config.TxPool,
<span class="term-fg32">+		noTxGossip:     config.NoTxGossip,</span>
 		chain:          config.Chain,
 		peers:          newPeerSet(),
 		requiredBlocks: config.RequiredBlocks,
<span class="term-fg36">@@ -166,9 +170,10 @@</span> 			log.Warn(&quot;Switch sync mode from full sync to snap sync&quot;, &quot;reason&quot;, &quot;head state missing&quot;)
 		}
 	} else {
 		head := h.chain.CurrentBlock()
<span class="term-fg31">-		if head.Number.Uint64() &gt; 0 &amp;&amp; h.chain.HasState(head.Root) {</span>
<span class="term-fg32">+		if head.Number.Uint64() &gt; 0 &amp;&amp; h.chain.HasState(head.Root) &amp;&amp; (!config.Chain.Config().IsOptimism() || head.Number.Cmp(config.Chain.Config().BedrockBlock) != 0) {</span>
 			&#47;&#47; Print warning log if database is not empty to run snap sync.
<span class="term-fg31">-			log.Warn(&quot;Switch sync mode from snap sync to full sync&quot;, &quot;reason&quot;, &quot;snap sync complete&quot;)</span>
<span class="term-fg32">+			&#47;&#47; For OP chains, snap sync from bedrock block is allowed.</span>
<span class="term-fg32">+			log.Warn(&quot;Switch sync mode from snap sync to full sync&quot;)</span>
 		} else {
 			&#47;&#47; If snap sync was requested and our database is empty, grant it
 			h.snapSync.Store(true)
<span class="term-fg36">@@ -179,8 +184,14 @@</span> 	&#47;&#47; If snap sync is requested but snapshots are disabled, fail loudly
 	if h.snapSync.Load() &amp;&amp; config.Chain.Snapshots() == nil {
 		return nil, errors.New(&quot;snap sync not supported with snapshots disabled&quot;)
 	}
<span class="term-fg32">+	&#47;&#47; if the chainID is set, pass it to the downloader for use in sync</span>
<span class="term-fg32">+	&#47;&#47; this might not be set in tests</span>
<span class="term-fg32">+	var chainID uint64</span>
<span class="term-fg32">+	if cid := h.chain.Config().ChainID; cid != nil {</span>
<span class="term-fg32">+		chainID = cid.Uint64()</span>
<span class="term-fg32">+	}</span>
 	&#47;&#47; Construct the downloader (long sync)
<span class="term-fg31">-	h.downloader = downloader.New(config.Database, h.eventMux, h.chain, h.removePeer, h.enableSyncedFeatures)</span>
<span class="term-fg32">+	h.downloader = downloader.New(config.Database, h.eventMux, h.chain, h.removePeer, h.enableSyncedFeatures, chainID)</span>
&nbsp;
 	fetchTx := func(peer string, hashes []common.Hash) error {
 		p := h.peers.peer(peer)</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-43a87574104411a860c37383" role="button"
                       aria-expanded="false" aria-controls="id-43a87574104411a860c37383">
                        <code>eth/handler_eth.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/eth/handler_eth.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/eth/handler_eth.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+18</span></div>
                            <div class="text-start"><span class="text-danger">-1</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-43a87574104411a860c37383"><span class="term-fg1">diff --git go-ethereum&#47;eth&#47;handler_eth.go op-geth&#47;eth&#47;handler_eth.go</span>
<span class="term-fg1">index b2cd52a22105ac700782008678229d33853e4004..be0abc1b60855ad2c941f829515ebf8e6b28390f 100644</span>
<span class="term-fg1">--- go-ethereum&#47;eth&#47;handler_eth.go</span>
<span class="term-fg1">+++ op-geth&#47;eth&#47;handler_eth.go</span>
<span class="term-fg36">@@ -20,6 +20,7 @@</span> import (
 	&quot;errors&quot;
 	&quot;fmt&quot;
&nbsp;
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&quot;</span>
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&#47;types&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;eth&#47;protocols&#47;eth&quot;
<span class="term-fg36">@@ -31,7 +32,20 @@</span> &#47;&#47; packets that are sent as replies or broadcasts.
 type ethHandler handler
&nbsp;
 func (h *ethHandler) Chain() *core.BlockChain { return h.chain }
<span class="term-fg31">-func (h *ethHandler) TxPool() eth.TxPool      { return h.txpool }</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; NilPool satisfies the TxPool interface but does not return any tx in the</span>
<span class="term-fg32">+&#47;&#47; pool. It is used to disable transaction gossip.</span>
<span class="term-fg32">+type NilPool struct{}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; NilPool Get always returns nil</span>
<span class="term-fg32">+func (n NilPool) Get(hash common.Hash) *types.Transaction { return nil }</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (h *ethHandler) TxPool() eth.TxPool {</span>
<span class="term-fg32">+	if h.noTxGossip {</span>
<span class="term-fg32">+		return &amp;NilPool{}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	return h.txpool</span>
<span class="term-fg32">+}</span>
&nbsp;
 &#47;&#47; RunPeer is invoked when a peer joins on the `eth` protocol.
 func (h *ethHandler) RunPeer(peer *eth.Peer, hand eth.Handler) error {
<span class="term-fg36">@@ -49,6 +63,9 @@</span>
 &#47;&#47; AcceptTxs retrieves whether transaction processing is enabled on the node
 &#47;&#47; or if inbound transactions should simply be dropped.
 func (h *ethHandler) AcceptTxs() bool {
<span class="term-fg32">+	if h.noTxGossip {</span>
<span class="term-fg32">+		return false</span>
<span class="term-fg32">+	}</span>
 	return h.synced.Load()
 }
</div>
    </div>

            
            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-ff23bc3be4d3c9936e606220"role="button" aria-expanded="false" aria-controls="id-ff23bc3be4d3c9936e606220">
        
            <div class="col-12 col-md-12 col-lg-6 col-xl-6 text-start"><h3>Warn on missing hardfork data</h3></div>
        

        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2">
            <div class="row line-stat">
                
                
            </div>
        </div>
        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2 ">
            <div class="row line-stat">
                
                    <div class="text-end"><span class="text-success">+4</span></div>
                    <div class="text-start"><span class="text-danger">-0</span></div>
                
                
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-ff23bc3be4d3c9936e606220">
        <div></div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-7c04bfe676107f8014569fa7" role="button"
                       aria-expanded="false" aria-controls="id-7c04bfe676107f8014569fa7">
                        <code>core/blockchain.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/core/blockchain.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/core/blockchain.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+4</span></div>
                            <div class="text-start"><span class="text-danger">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-7c04bfe676107f8014569fa7"><span class="term-fg1">diff --git go-ethereum&#47;core&#47;blockchain.go op-geth&#47;core&#47;blockchain.go</span>
<span class="term-fg1">index 05ebfd18b830c0c6034a9d48452d1bd6780c6548..d1411003d8cc7dae0e51429765cd85d217d21790 100644</span>
<span class="term-fg1">--- go-ethereum&#47;core&#47;blockchain.go</span>
<span class="term-fg1">+++ op-geth&#47;core&#47;blockchain.go</span>
<span class="term-fg36">@@ -286,6 +286,10 @@</span> 	}
 	log.Info(strings.Repeat(&quot;-&quot;, 153))
 	log.Info(&quot;&quot;)
&nbsp;
<span class="term-fg32">+	if chainConfig.IsOptimism() &amp;&amp; chainConfig.RegolithTime == nil {</span>
<span class="term-fg32">+		log.Warn(&quot;Optimism RegolithTime has not been set&quot;)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
 	bc := &amp;BlockChain{
 		chainConfig:   chainConfig,
 		cacheConfig:   cacheConfig,</div>
    </div>

            
            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-7f75083b2e9a0689e1529c91"role="button" aria-expanded="false" aria-controls="id-7f75083b2e9a0689e1529c91">
        
            <div class="col-12 col-md-12 col-lg-6 col-xl-6 text-start"><h3>Optional Engine API extensions</h3></div>
        

        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2">
            <div class="row line-stat">
                
                
            </div>
        </div>
        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2 ">
            <div class="row line-stat">
                
                    <div class="text-end"><span class="text-success">+66</span></div>
                    <div class="text-start"><span class="text-danger">-0</span></div>
                
                
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-7f75083b2e9a0689e1529c91">
        <div></div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-0e912b90e71cb3be6effda76" role="button"
                       aria-expanded="false" aria-controls="id-0e912b90e71cb3be6effda76">
                        <code>eth/catalyst/superchain.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/eth/catalyst/superchain.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+66</span></div>
                            <div class="text-start"><span class="text-danger">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-0e912b90e71cb3be6effda76"><span class="term-fg1">diff --git go-ethereum&#47;eth&#47;catalyst&#47;superchain.go op-geth&#47;eth&#47;catalyst&#47;superchain.go</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..503519889f4f050ad0aa739525022044fa842bc6</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ op-geth&#47;eth&#47;catalyst&#47;superchain.go</span>
<span class="term-fg36">@@ -0,0 +1,66 @@</span>
<span class="term-fg32">+package catalyst</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+import (</span>
<span class="term-fg32">+	&quot;fmt&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;log&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;metrics&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;params&quot;</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+var (</span>
<span class="term-fg32">+	requiredProtocolDeltaGauge    = metrics.NewRegisteredGauge(&quot;superchain&#47;required&#47;delta&quot;, nil)</span>
<span class="term-fg32">+	recommendedProtocolDeltaGauge = metrics.NewRegisteredGauge(&quot;superchain&#47;recommended&#47;delta&quot;, nil)</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+type SuperchainSignal struct {</span>
<span class="term-fg32">+	Recommended params.ProtocolVersion `json:&quot;recommended&quot;`</span>
<span class="term-fg32">+	Required    params.ProtocolVersion `json:&quot;required&quot;`</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (api *ConsensusAPI) SignalSuperchainV1(signal *SuperchainSignal) (params.ProtocolVersion, error) {</span>
<span class="term-fg32">+	if signal == nil {</span>
<span class="term-fg32">+		log.Info(&quot;Received empty superchain version signal&quot;, &quot;local&quot;, params.OPStackSupport)</span>
<span class="term-fg32">+		return params.OPStackSupport, nil</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	&#47;&#47; update metrics and log any warnings&#47;info</span>
<span class="term-fg32">+	requiredProtocolDeltaGauge.Update(int64(params.OPStackSupport.Compare(signal.Required)))</span>
<span class="term-fg32">+	recommendedProtocolDeltaGauge.Update(int64(params.OPStackSupport.Compare(signal.Recommended)))</span>
<span class="term-fg32">+	logger := log.New(&quot;local&quot;, params.OPStackSupport, &quot;required&quot;, signal.Required, &quot;recommended&quot;, signal.Recommended)</span>
<span class="term-fg32">+	LogProtocolVersionSupport(logger, params.OPStackSupport, signal.Recommended, &quot;recommended&quot;)</span>
<span class="term-fg32">+	LogProtocolVersionSupport(logger, params.OPStackSupport, signal.Required, &quot;required&quot;)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	if err := api.eth.HandleRequiredProtocolVersion(signal.Required); err != nil {</span>
<span class="term-fg32">+		log.Error(&quot;Failed to handle required protocol version&quot;, &quot;err&quot;, err, &quot;required&quot;, signal.Required)</span>
<span class="term-fg32">+		return params.OPStackSupport, err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	return params.OPStackSupport, nil</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func LogProtocolVersionSupport(logger log.Logger, local, other params.ProtocolVersion, name string) {</span>
<span class="term-fg32">+	switch local.Compare(other) {</span>
<span class="term-fg32">+	case params.AheadMajor:</span>
<span class="term-fg32">+		logger.Info(fmt.Sprintf(&quot;Ahead with major %s protocol version change&quot;, name))</span>
<span class="term-fg32">+	case params.AheadMinor, params.AheadPatch, params.AheadPrerelease:</span>
<span class="term-fg32">+		logger.Debug(fmt.Sprintf(&quot;Ahead with compatible %s protocol version change&quot;, name))</span>
<span class="term-fg32">+	case params.Matching:</span>
<span class="term-fg32">+		logger.Debug(fmt.Sprintf(&quot;Latest %s protocol version is supported&quot;, name))</span>
<span class="term-fg32">+	case params.OutdatedMajor:</span>
<span class="term-fg32">+		logger.Error(fmt.Sprintf(&quot;Outdated with major %s protocol change&quot;, name))</span>
<span class="term-fg32">+	case params.OutdatedMinor:</span>
<span class="term-fg32">+		logger.Warn(fmt.Sprintf(&quot;Outdated with minor backward-compatible %s protocol change&quot;, name))</span>
<span class="term-fg32">+	case params.OutdatedPatch:</span>
<span class="term-fg32">+		logger.Info(fmt.Sprintf(&quot;Outdated with support backward-compatible %s protocol change&quot;, name))</span>
<span class="term-fg32">+	case params.OutdatedPrerelease:</span>
<span class="term-fg32">+		logger.Debug(fmt.Sprintf(&quot;New %s protocol pre-release is available&quot;, name))</span>
<span class="term-fg32">+	case params.DiffBuild:</span>
<span class="term-fg32">+		logger.Debug(fmt.Sprintf(&quot;Ignoring %s protocolversion signal, local build is different&quot;, name))</span>
<span class="term-fg32">+	case params.DiffVersionType:</span>
<span class="term-fg32">+		logger.Warn(fmt.Sprintf(&quot;Failed to recognize %s protocol version signal version-type&quot;, name))</span>
<span class="term-fg32">+	case params.EmptyVersion:</span>
<span class="term-fg32">+		logger.Debug(fmt.Sprintf(&quot;No %s protocol version available to check&quot;, name))</span>
<span class="term-fg32">+	case params.InvalidVersion:</span>
<span class="term-fg32">+		logger.Warn(fmt.Sprintf(&quot;Invalid protocol version comparison with %s&quot;, name))</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span></div>
    </div>

            
            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-769d1ea5c471b34b63546fbe"role="button" aria-expanded="false" aria-controls="id-769d1ea5c471b34b63546fbe">
        
            <div class="col-12 col-md-12 col-lg-6 col-xl-6 text-start"><h3>Support legacy DBs when snap-syncing</h3></div>
        

        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2">
            <div class="row line-stat">
                
                
            </div>
        </div>
        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2 ">
            <div class="row line-stat">
                
                    <div class="text-end"><span class="text-success">+9</span></div>
                    <div class="text-start"><span class="text-danger">-1</span></div>
                
                
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-769d1ea5c471b34b63546fbe">
        <div><p>Snap-sync does not serve unprefixed code by default.</p>
</div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-690334cb797b291680684234" role="button"
                       aria-expanded="false" aria-controls="id-690334cb797b291680684234">
                        <code>core/blockchain_reader.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/core/blockchain_reader.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/core/blockchain_reader.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+8</span></div>
                            <div class="text-start"><span class="text-danger">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-690334cb797b291680684234"><span class="term-fg1">diff --git go-ethereum&#47;core&#47;blockchain_reader.go op-geth&#47;core&#47;blockchain_reader.go</span>
<span class="term-fg1">index 8a85800dd877d563dceeb30ec9c7f76ee7e7f6a4..4a3d085c053d054efdc323a946cd2ec835f66aea 100644</span>
<span class="term-fg1">--- go-ethereum&#47;core&#47;blockchain_reader.go</span>
<span class="term-fg1">+++ op-geth&#47;core&#47;blockchain_reader.go</span>
<span class="term-fg36">@@ -349,6 +349,14 @@</span> 	&#47;&#47; in Verkle scheme. Fix it once snap-sync is supported for Verkle.
 	return bc.stateCache.(codeReader).ContractCodeWithPrefix(common.Address{}, hash)
 }
&nbsp;
<span class="term-fg32">+&#47;&#47; ContractCode retrieves a blob of data associated with a contract hash</span>
<span class="term-fg32">+&#47;&#47; either from ephemeral in-memory cache, or from persistent storage.</span>
<span class="term-fg32">+&#47;&#47; This is a legacy-method, replaced by ContractCodeWithPrefix,</span>
<span class="term-fg32">+&#47;&#47; but required for old databases to serve snap-sync.</span>
<span class="term-fg32">+func (bc *BlockChain) ContractCode(hash common.Hash) ([]byte, error) {</span>
<span class="term-fg32">+	return bc.stateCache.ContractCode(common.Address{}, hash)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
 &#47;&#47; State returns a new mutable state based on the current HEAD block.
 func (bc *BlockChain) State() (*state.StateDB, error) {
 	return bc.StateAt(bc.CurrentBlock().Root)</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-07f81426152a2160a65b5ffe" role="button"
                       aria-expanded="false" aria-controls="id-07f81426152a2160a65b5ffe">
                        <code>eth/protocols/snap/handler.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/eth/protocols/snap/handler.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/eth/protocols/snap/handler.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+1</span></div>
                            <div class="text-start"><span class="text-danger">-1</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-07f81426152a2160a65b5ffe"><span class="term-fg1">diff --git go-ethereum&#47;eth&#47;protocols&#47;snap&#47;handler.go op-geth&#47;eth&#47;protocols&#47;snap&#47;handler.go</span>
<span class="term-fg1">index 5cbe9d127056b695cd8b3126d36086deb5cb92b0..bc2d6084244d9c5b781429903cf8a814982e45ca 100644</span>
<span class="term-fg1">--- go-ethereum&#47;eth&#47;protocols&#47;snap&#47;handler.go</span>
<span class="term-fg1">+++ op-geth&#47;eth&#47;protocols&#47;snap&#47;handler.go</span>
<span class="term-fg36">@@ -463,7 +463,7 @@</span> 		if hash == types.EmptyCodeHash {
 			&#47;&#47; Peers should not request the empty code, but if they do, at
 			&#47;&#47; least sent them back a correct response without db lookups
 			codes = append(codes, []byte{})
<span class="term-fg31">-		} else if blob, err := chain.ContractCodeWithPrefix(hash); err == nil {</span>
<span class="term-fg32">+		} else if blob, err := chain.ContractCode(hash); err == nil {</span>
 			codes = append(codes, blob)
 			bytes += uint64(len(blob))
 		}</div>
    </div>

            
            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-53ef2e533e3928b81ccac54b"role="button" aria-expanded="false" aria-controls="id-53ef2e533e3928b81ccac54b">
        
            <div class="col-12 col-md-12 col-lg-6 col-xl-6 text-start"><h3>Historical data for Snap-sync</h3></div>
        

        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2">
            <div class="row line-stat">
                
                
            </div>
        </div>
        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2 ">
            <div class="row line-stat">
                
                    <div class="text-end"><span class="text-success">+150</span></div>
                    <div class="text-start"><span class="text-danger">-2</span></div>
                
                
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-53ef2e533e3928b81ccac54b">
        <div><p>Snap-sync has access to trusted Deposit Transaction Nonce Data.</p>
</div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-258fcfb38b88ff7f2f43a301" role="button"
                       aria-expanded="false" aria-controls="id-258fcfb38b88ff7f2f43a301">
                        <code>eth/downloader/downloader.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/eth/downloader/downloader.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/eth/downloader/downloader.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+6</span></div>
                            <div class="text-start"><span class="text-danger">-2</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-258fcfb38b88ff7f2f43a301"><span class="term-fg1">diff --git go-ethereum&#47;eth&#47;downloader&#47;downloader.go op-geth&#47;eth&#47;downloader&#47;downloader.go</span>
<span class="term-fg1">index d147414859f2d9a9ad1031cdeac52edef537618a..f5313715b6496609302eab8e539c819baa0af791 100644</span>
<span class="term-fg1">--- go-ethereum&#47;eth&#47;downloader&#47;downloader.go</span>
<span class="term-fg1">+++ op-geth&#47;eth&#47;downloader&#47;downloader.go</span>
<span class="term-fg36">@@ -139,6 +139,9 @@</span> 	&#47;&#47; Progress reporting metrics
 	syncStartBlock uint64    &#47;&#47; Head snap block when Geth was started
 	syncStartTime  time.Time &#47;&#47; Time instance when chain sync started
 	syncLogTime    time.Time &#47;&#47; Time instance when status was last reported
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Chain ID for downloaders to reference</span>
<span class="term-fg32">+	chainID uint64</span>
 }
&nbsp;
 &#47;&#47; BlockChain encapsulates functions required to sync a (full or snap) blockchain.
<span class="term-fg36">@@ -194,7 +197,7 @@</span> 	TrieDB() *triedb.Database
 }
&nbsp;
 &#47;&#47; New creates a new downloader to fetch hashes and blocks from remote peers.
<span class="term-fg31">-func New(stateDb ethdb.Database, mux *event.TypeMux, chain BlockChain, dropPeer peerDropFn, success func()) *Downloader {</span>
<span class="term-fg32">+func New(stateDb ethdb.Database, mux *event.TypeMux, chain BlockChain, dropPeer peerDropFn, success func(), chainID uint64) *Downloader {</span>
 	dl := &amp;Downloader{
 		stateDB:        stateDb,
 		mux:            mux,
<span class="term-fg36">@@ -207,6 +210,7 @@</span> 		quitCh:         make(chan struct{}),
 		SnapSyncer:     snap.NewSyncer(stateDb, chain.TrieDB().Scheme()),
 		stateSyncStart: make(chan *stateSync),
 		syncStartBlock: chain.CurrentSnapBlock().Number.Uint64(),
<span class="term-fg32">+		chainID:        chainID,</span>
 	}
 	&#47;&#47; Create the post-merge skeleton syncer and start the process
 	dl.skeleton = newSkeleton(stateDb, dl.peers, dropPeer, newBeaconBackfiller(dl, success))
<span class="term-fg36">@@ -982,7 +986,7 @@</span> 	blocks := make([]*types.Block, len(results))
 	receipts := make([]types.Receipts, len(results))
 	for i, result := range results {
 		blocks[i] = types.NewBlockWithHeader(result.Header).WithBody(result.body())
<span class="term-fg31">-		receipts[i] = result.Receipts</span>
<span class="term-fg32">+		receipts[i] = correctReceipts(result.Receipts, result.Transactions, blocks[i].NumberU64(), d.chainID)</span>
 	}
 	if index, err := d.blockchain.InsertReceiptChain(blocks, receipts, d.ancientLimit); err != nil {
 		log.Debug(&quot;Downloaded item processing failed&quot;, &quot;number&quot;, results[index].Header.Number, &quot;hash&quot;, results[index].Header.Hash(), &quot;err&quot;, err)</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-be50a6cda78a4c0af2865f2f" role="button"
                       aria-expanded="false" aria-controls="id-be50a6cda78a4c0af2865f2f">
                        <code>eth/downloader/receiptreference.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/eth/downloader/receiptreference.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+144</span></div>
                            <div class="text-start"><span class="text-danger">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-be50a6cda78a4c0af2865f2f"><span class="term-fg1">diff --git go-ethereum&#47;eth&#47;downloader&#47;receiptreference.go op-geth&#47;eth&#47;downloader&#47;receiptreference.go</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..b4c5623ddc9033ac6c03e48710f44e5c00cf1d94</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ op-geth&#47;eth&#47;downloader&#47;receiptreference.go</span>
<span class="term-fg36">@@ -0,0 +1,144 @@</span>
<span class="term-fg32">+package downloader</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+import (</span>
<span class="term-fg32">+	&quot;bytes&quot;</span>
<span class="term-fg32">+	&quot;embed&quot;</span>
<span class="term-fg32">+	&quot;encoding&#47;gob&quot;</span>
<span class="term-fg32">+	&quot;fmt&quot;</span>
<span class="term-fg32">+	&quot;path&quot;</span>
<span class="term-fg32">+	&quot;strings&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&#47;types&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;log&quot;</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; userDepositNonces is a struct to hold the reference data for user deposits</span>
<span class="term-fg32">+&#47;&#47; The reference data is used to correct the deposit nonce in the receipts</span>
<span class="term-fg32">+type userDepositNonces struct {</span>
<span class="term-fg32">+	ChainID uint64</span>
<span class="term-fg32">+	First   uint64</span>
<span class="term-fg32">+	Last    uint64 &#47;&#47; non inclusive</span>
<span class="term-fg32">+	Results map[uint64][]uint64</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+var (</span>
<span class="term-fg32">+	systemAddress        = common.HexToAddress(&quot;0xDeaDDEaDDeAdDeAdDEAdDEaddeAddEAdDEAd0001&quot;)</span>
<span class="term-fg32">+	receiptReferencePath = &quot;userDepositData&quot;</span>
<span class="term-fg32">+	&#47;&#47;go:embed userDepositData&#47;*.gob</span>
<span class="term-fg32">+	receiptReference                 embed.FS</span>
<span class="term-fg32">+	userDepositNoncesAlreadySearched = map[uint64]bool{}</span>
<span class="term-fg32">+	userDepositNoncesReference       = map[uint64]userDepositNonces{}</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; lazy load the reference data for the requested chain</span>
<span class="term-fg32">+&#47;&#47; if this chain data was already requested, returns early</span>
<span class="term-fg32">+func initReceiptReferences(chainID uint64) {</span>
<span class="term-fg32">+	&#47;&#47; if already loaded, return</span>
<span class="term-fg32">+	if userDepositNoncesAlreadySearched[chainID] {</span>
<span class="term-fg32">+		return</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	&#47;&#47; look for a file prefixed by the chainID</span>
<span class="term-fg32">+	fPrefix := fmt.Sprintf(&quot;%d.&quot;, chainID)</span>
<span class="term-fg32">+	files, err := receiptReference.ReadDir(receiptReferencePath)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		log.Warn(&quot;Receipt Correction: Failed to read reference directory&quot;, &quot;err&quot;, err)</span>
<span class="term-fg32">+		return</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	&#47;&#47; mark as loaded so we don&#39;t try again, even if no files match</span>
<span class="term-fg32">+	userDepositNoncesAlreadySearched[chainID] = true</span>
<span class="term-fg32">+	for _, file := range files {</span>
<span class="term-fg32">+		&#47;&#47; skip files which don&#39;t match the prefix</span>
<span class="term-fg32">+		if !strings.HasPrefix(file.Name(), fPrefix) {</span>
<span class="term-fg32">+			continue</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		fpath := path.Join(receiptReferencePath, file.Name())</span>
<span class="term-fg32">+		bs, err := receiptReference.ReadFile(fpath)</span>
<span class="term-fg32">+		if err != nil {</span>
<span class="term-fg32">+			log.Warn(&quot;Receipt Correction: Failed to read reference data&quot;, &quot;err&quot;, err)</span>
<span class="term-fg32">+			continue</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		udns := userDepositNonces{}</span>
<span class="term-fg32">+		err = gob.NewDecoder(bytes.NewReader(bs)).Decode(&amp;udns)</span>
<span class="term-fg32">+		if err != nil {</span>
<span class="term-fg32">+			log.Warn(&quot;Receipt Correction: Failed to decode reference data&quot;, &quot;err&quot;, err)</span>
<span class="term-fg32">+			continue</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		userDepositNoncesReference[udns.ChainID] = udns</span>
<span class="term-fg32">+		return</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; correctReceipts corrects the deposit nonce in the receipts using the reference data</span>
<span class="term-fg32">+&#47;&#47; prior to Canyon Hard Fork, DepositNonces were not cryptographically verifiable.</span>
<span class="term-fg32">+&#47;&#47; As a consequence, the deposit nonces found during Snap Sync may be incorrect.</span>
<span class="term-fg32">+&#47;&#47; This function inspects transaction data for user deposits, and if it is found to be incorrect, it is corrected.</span>
<span class="term-fg32">+&#47;&#47; The data used to correct the deposit nonce is stored in the userDepositData directory,</span>
<span class="term-fg32">+&#47;&#47; and was generated with the receipt reference tool in the optimism monorepo.</span>
<span class="term-fg32">+func correctReceipts(receipts types.Receipts, transactions types.Transactions, blockNumber uint64, chainID uint64) types.Receipts {</span>
<span class="term-fg32">+	initReceiptReferences(chainID)</span>
<span class="term-fg32">+	&#47;&#47; if there is no data even after initialization, return the receipts as is</span>
<span class="term-fg32">+	depositNoncesForChain, ok := userDepositNoncesReference[chainID]</span>
<span class="term-fg32">+	if !ok {</span>
<span class="term-fg32">+		log.Trace(&quot;Receipt Correction: No data source for chain&quot;, &quot;chainID&quot;, chainID)</span>
<span class="term-fg32">+		return receipts</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; check that the block number being examined is within the range of the reference data</span>
<span class="term-fg32">+	if blockNumber &lt; depositNoncesForChain.First || blockNumber &gt; depositNoncesForChain.Last {</span>
<span class="term-fg32">+		log.Trace(&quot;Receipt Correction: Block is out of range for receipt reference&quot;,</span>
<span class="term-fg32">+			&quot;blockNumber&quot;, blockNumber,</span>
<span class="term-fg32">+			&quot;start&quot;, depositNoncesForChain.First,</span>
<span class="term-fg32">+			&quot;end&quot;, depositNoncesForChain.Last)</span>
<span class="term-fg32">+		return receipts</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; get the block nonces</span>
<span class="term-fg32">+	blockNonces, ok := depositNoncesForChain.Results[blockNumber]</span>
<span class="term-fg32">+	if !ok {</span>
<span class="term-fg32">+		log.Trace(&quot;Receipt Correction: Block does not contain user deposits&quot;, &quot;blockNumber&quot;, blockNumber)</span>
<span class="term-fg32">+		return receipts</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; iterate through the receipts and transactions to correct the deposit nonce</span>
<span class="term-fg32">+	&#47;&#47; user deposits should always be at the front of the block, but we will check all transactions to be sure</span>
<span class="term-fg32">+	udCount := 0</span>
<span class="term-fg32">+	for i := 0; i &lt; len(receipts); i++ {</span>
<span class="term-fg32">+		r := receipts[i]</span>
<span class="term-fg32">+		tx := transactions[i]</span>
<span class="term-fg32">+		from, err := types.Sender(types.LatestSignerForChainID(tx.ChainId()), tx)</span>
<span class="term-fg32">+		if err != nil {</span>
<span class="term-fg32">+			log.Warn(&quot;Receipt Correction: Failed to determine sender&quot;, &quot;err&quot;, err)</span>
<span class="term-fg32">+			continue</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		&#47;&#47; break as soon as a non deposit is found</span>
<span class="term-fg32">+		if r.Type != types.DepositTxType {</span>
<span class="term-fg32">+			break</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		&#47;&#47; ignore any transactions from the system address</span>
<span class="term-fg32">+		if from != systemAddress {</span>
<span class="term-fg32">+			&#47;&#47; prevent index out of range (indicates a problem with the reference data or the block data)</span>
<span class="term-fg32">+			if udCount &gt;= len(blockNonces) {</span>
<span class="term-fg32">+				log.Warn(&quot;Receipt Correction: More user deposits in block than included in reference data&quot;, &quot;in_reference&quot;, len(blockNonces))</span>
<span class="term-fg32">+				break</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+			nonce := blockNonces[udCount]</span>
<span class="term-fg32">+			udCount++</span>
<span class="term-fg32">+			log.Trace(&quot;Receipt Correction: User Deposit detected&quot;, &quot;address&quot;, from, &quot;nonce&quot;, nonce)</span>
<span class="term-fg32">+			if nonce != *r.DepositNonce {</span>
<span class="term-fg32">+				&#47;&#47; correct the deposit nonce</span>
<span class="term-fg32">+				&#47;&#47; warn because this should not happen unless the data was modified by corruption or a malicious peer</span>
<span class="term-fg32">+				&#47;&#47; by correcting the nonce, the entire block is still valid for use</span>
<span class="term-fg32">+				log.Warn(&quot;Receipt Correction: Corrected deposit nonce&quot;, &quot;nonce&quot;, *r.DepositNonce, &quot;corrected&quot;, nonce)</span>
<span class="term-fg32">+				r.DepositNonce = &amp;nonce</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	&#47;&#47; check for unused reference data (indicates a problem with the reference data or the block data)</span>
<span class="term-fg32">+	if udCount &lt; len(blockNonces) {</span>
<span class="term-fg32">+		log.Warn(&quot;Receipt Correction: More user deposits in reference data than found in block&quot;, &quot;in_reference&quot;, len(blockNonces), &quot;in_block&quot;, udCount)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	log.Trace(&quot;Receipt Correction: Completed&quot;, &quot;blockNumber&quot;, blockNumber, &quot;userDeposits&quot;, udCount, &quot;receipts&quot;, len(receipts), &quot;transactions&quot;, len(transactions))</span>
<span class="term-fg32">+	return receipts</span>
<span class="term-fg32">+}</span></div>
    </div>

            
            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-7da3b29b1f202c326b3f217a"role="button" aria-expanded="false" aria-controls="id-7da3b29b1f202c326b3f217a">
        
            <div class="col-12 col-md-12 col-lg-6 col-xl-6 text-start"><h3>Discv5 node discovery</h3></div>
        

        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2">
            <div class="row line-stat">
                
                
            </div>
        </div>
        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2 ">
            <div class="row line-stat">
                
                    <div class="text-end"><span class="text-success">+1</span></div>
                    <div class="text-start"><span class="text-danger">-0</span></div>
                
                
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-7da3b29b1f202c326b3f217a">
        <div><p>Fix discv5 option to allow discv5 to be an active source for node-discovery.</p>
</div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-a465e3edf06fbdc15feb1bc4" role="button"
                       aria-expanded="false" aria-controls="id-a465e3edf06fbdc15feb1bc4">
                        <code>p2p/server.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/p2p/server.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/p2p/server.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+1</span></div>
                            <div class="text-start"><span class="text-danger">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-a465e3edf06fbdc15feb1bc4"><span class="term-fg1">diff --git go-ethereum&#47;p2p&#47;server.go op-geth&#47;p2p&#47;server.go</span>
<span class="term-fg1">index 172f0667eb13240aa2f43a12d119c1182e6ba402..0d1e9bd75e60cf1f8a95724987fc2c9745b19eba 100644</span>
<span class="term-fg1">--- go-ethereum&#47;p2p&#47;server.go</span>
<span class="term-fg1">+++ op-geth&#47;p2p&#47;server.go</span>
<span class="term-fg36">@@ -591,6 +591,7 @@</span> 		srv.discv5, err = discover.ListenV5(sconn, srv.localnode, cfg)
 		if err != nil {
 			return err
 		}
<span class="term-fg32">+		srv.discmix.AddSource(srv.discv5.RandomNodes())</span>
 	}
&nbsp;
 	&#47;&#47; Add protocol-specific discovery sources.</div>
    </div>

            
            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-35813e7d20e7d4bdffeaaf1f"role="button" aria-expanded="false" aria-controls="id-35813e7d20e7d4bdffeaaf1f">
        
            <div class="col-12 col-md-12 col-lg-6 col-xl-6 text-start"><h3>Bootnodes</h3></div>
        

        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2">
            <div class="row line-stat">
                
                
            </div>
        </div>
        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2 ">
            <div class="row line-stat">
                
                    <div class="text-end"><span class="text-success">+23</span></div>
                    <div class="text-start"><span class="text-danger">-0</span></div>
                
                
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-35813e7d20e7d4bdffeaaf1f">
        <div><p>Discovery bootnode addresses.</p>
</div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-84989d3d1caa4cde7f4a635a" role="button"
                       aria-expanded="false" aria-controls="id-84989d3d1caa4cde7f4a635a">
                        <code>params/bootnodes.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/params/bootnodes.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/params/bootnodes.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+23</span></div>
                            <div class="text-start"><span class="text-danger">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-84989d3d1caa4cde7f4a635a"><span class="term-fg1">diff --git go-ethereum&#47;params&#47;bootnodes.go op-geth&#47;params&#47;bootnodes.go</span>
<span class="term-fg1">index 5e2c7c21810234011be103fbd4c03b0d1c57adde..df05fc7a2f594a569aac44d6957a81101aca4810 100644</span>
<span class="term-fg1">--- go-ethereum&#47;params&#47;bootnodes.go</span>
<span class="term-fg1">+++ op-geth&#47;params&#47;bootnodes.go</span>
<span class="term-fg36">@@ -87,6 +87,29 @@</span> 	&quot;enr:-LK4QA8FfhaAjlb_BXsXxSfiysR7R52Nhi9JBt4F8SPssu8hdE1BXQQEtVDC3qStCW60LSO7hEsVHv5zm8_6Vnjhcn0Bh2F0dG5ldHOIAAAAAAAAAACEZXRoMpC1MD8qAAAAAP__________gmlkgnY0gmlwhAN4aBKJc2VjcDI1NmsxoQJerDhsJ-KxZ8sHySMOCmTO6sHM3iCFQ6VMvLTe948MyYN0Y3CCI4yDdWRwgiOM&quot;, &#47;&#47; 3.120.104.18 | aws-eu-central-1-frankfurt
 	&quot;enr:-LK4QKWrXTpV9T78hNG6s8AM6IO4XH9kFT91uZtFg1GcsJ6dKovDOr1jtAAFPnS2lvNltkOGA9k29BUN7lFh_sjuc9QBh2F0dG5ldHOIAAAAAAAAAACEZXRoMpC1MD8qAAAAAP__________gmlkgnY0gmlwhANAdd-Jc2VjcDI1NmsxoQLQa6ai7y9PMN5hpLe5HmiJSlYzMuzP7ZhwRiwHvqNXdoN0Y3CCI4yDdWRwgiOM&quot;, &#47;&#47; 3.64.117.223 | aws-eu-central-1-frankfurt}
 }
&nbsp;
<span class="term-fg32">+var V5OPBootnodes = []string{</span>
<span class="term-fg32">+	&#47;&#47; OP Labs</span>
<span class="term-fg32">+	&quot;enode:&#47;&#47;ca2774c3c401325850b2477fd7d0f27911efbf79b1e8b335066516e2bd8c4c9e0ba9696a94b1cb030a88eac582305ff55e905e64fb77fe0edcd70a4e5296d3ec@34.65.175.185:30305&quot;,</span>
<span class="term-fg32">+	&quot;enode:&#47;&#47;dd751a9ef8912be1bfa7a5e34e2c3785cc5253110bd929f385e07ba7ac19929fb0e0c5d93f77827291f4da02b2232240fbc47ea7ce04c46e333e452f8656b667@34.65.107.0:30305&quot;,</span>
<span class="term-fg32">+	&quot;enode:&#47;&#47;c5d289b56a77b6a2342ca29956dfd07aadf45364dde8ab20d1dc4efd4d1bc6b4655d902501daea308f4d8950737a4e93a4dfedd17b49cd5760ffd127837ca965@34.65.202.239:30305&quot;,</span>
<span class="term-fg32">+	&#47;&#47; Base</span>
<span class="term-fg32">+	&quot;enode:&#47;&#47;87a32fd13bd596b2ffca97020e31aef4ddcc1bbd4b95bb633d16c1329f654f34049ed240a36b449fda5e5225d70fe40bc667f53c304b71f8e68fc9d448690b51@3.231.138.188:30301&quot;,</span>
<span class="term-fg32">+	&quot;enode:&#47;&#47;ca21ea8f176adb2e229ce2d700830c844af0ea941a1d8152a9513b966fe525e809c3a6c73a2c18a12b74ed6ec4380edf91662778fe0b79f6a591236e49e176f9@184.72.129.189:30301&quot;,</span>
<span class="term-fg32">+	&quot;enode:&#47;&#47;acf4507a211ba7c1e52cdf4eef62cdc3c32e7c9c47998954f7ba024026f9a6b2150cd3f0b734d9c78e507ab70d59ba61dfe5c45e1078c7ad0775fb251d7735a2@3.220.145.177:30301&quot;,</span>
<span class="term-fg32">+	&quot;enode:&#47;&#47;8a5a5006159bf079d06a04e5eceab2a1ce6e0f721875b2a9c96905336219dbe14203d38f70f3754686a6324f786c2f9852d8c0dd3adac2d080f4db35efc678c5@3.231.11.52:30301&quot;,</span>
<span class="term-fg32">+	&quot;enode:&#47;&#47;cdadbe835308ad3557f9a1de8db411da1a260a98f8421d62da90e71da66e55e98aaa8e90aa7ce01b408a54e4bd2253d701218081ded3dbe5efbbc7b41d7cef79@54.198.153.150:30301&quot;,</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+var V5OPTestnetBootnodes = []string{</span>
<span class="term-fg32">+	&#47;&#47; OP Labs</span>
<span class="term-fg32">+	&quot;enode:&#47;&#47;2bd2e657bb3c8efffb8ff6db9071d9eb7be70d7c6d7d980ff80fc93b2629675c5f750bc0a5ef27cd788c2e491b8795a7e9a4a6e72178c14acc6753c0e5d77ae4@34.65.205.244:30305&quot;,</span>
<span class="term-fg32">+	&quot;enode:&#47;&#47;db8e1cab24624cc62fc35dbb9e481b88a9ef0116114cd6e41034c55b5b4f18755983819252333509bd8e25f6b12aadd6465710cd2e956558faf17672cce7551f@34.65.173.88:30305&quot;,</span>
<span class="term-fg32">+	&quot;enode:&#47;&#47;bfda2e0110cfd0f4c9f7aa5bf5ec66e6bd18f71a2db028d36b8bf8b0d6fdb03125c1606a6017b31311d96a36f5ef7e1ad11604d7a166745e6075a715dfa67f8a@34.65.229.245:30305&quot;,</span>
<span class="term-fg32">+	&#47;&#47; Base</span>
<span class="term-fg32">+	&quot;enode:&#47;&#47;548f715f3fc388a7c917ba644a2f16270f1ede48a5d88a4d14ea287cc916068363f3092e39936f1a3e7885198bef0e5af951f1d7b1041ce8ba4010917777e71f@18.210.176.114:30301&quot;,</span>
<span class="term-fg32">+	&quot;enode:&#47;&#47;6f10052847a966a725c9f4adf6716f9141155b99a0fb487fea3f51498f4c2a2cb8d534e680ee678f9447db85b93ff7c74562762c3714783a7233ac448603b25f@107.21.251.55:30301&quot;,</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
 const dnsPrefix = &quot;enrtree:&#47;&#47;AKA3AM6LPBYEUDMVNU3BSVQJ5AD45Y7YPOHJLEF6W26QOE4VTUDPE@&quot;
&nbsp;
 &#47;&#47; KnownDNSNetwork returns the address of a public DNS-based node list for the given</div>
    </div>

            
            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-d7103246efbfdb894ac9e843"role="button" aria-expanded="false" aria-controls="id-d7103246efbfdb894ac9e843">
        
            <div class="col-12 col-md-12 col-lg-6 col-xl-6 text-start"><h3>Generated TOML config update</h3></div>
        

        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2">
            <div class="row line-stat">
                
                
            </div>
        </div>
        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2 ">
            <div class="row line-stat">
                
                    <div class="text-end"><span class="text-success">+162</span></div>
                    <div class="text-start"><span class="text-danger">-84</span></div>
                
                
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-d7103246efbfdb894ac9e843">
        <div></div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-b387ced42ed2fc329189ce65" role="button"
                       aria-expanded="false" aria-controls="id-b387ced42ed2fc329189ce65">
                        <code>eth/ethconfig/gen_config.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/eth/ethconfig/gen_config.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/eth/ethconfig/gen_config.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+162</span></div>
                            <div class="text-start"><span class="text-danger">-84</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-b387ced42ed2fc329189ce65"><span class="term-fg1">diff --git go-ethereum&#47;eth&#47;ethconfig&#47;gen_config.go op-geth&#47;eth&#47;ethconfig&#47;gen_config.go</span>
<span class="term-fg1">index 147a5599848b5c11185450402d064db553cf8987..a8ffe914a48cf2c9dba0e42501795440924879fc 100644</span>
<span class="term-fg1">--- go-ethereum&#47;eth&#47;ethconfig&#47;gen_config.go</span>
<span class="term-fg1">+++ op-geth&#47;eth&#47;ethconfig&#47;gen_config.go</span>
<span class="term-fg36">@@ -17,48 +17,61 @@</span>
 &#47;&#47; MarshalTOML marshals as TOML.
 func (c Config) MarshalTOML() (interface{}, error) {
 	type Config struct {
<span class="term-fg31">-		Genesis                 *core.Genesis `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg31">-		NetworkId               uint64</span>
<span class="term-fg31">-		SyncMode                downloader.SyncMode</span>
<span class="term-fg31">-		EthDiscoveryURLs        []string</span>
<span class="term-fg31">-		SnapDiscoveryURLs       []string</span>
<span class="term-fg31">-		NoPruning               bool</span>
<span class="term-fg31">-		NoPrefetch              bool</span>
<span class="term-fg31">-		TxLookupLimit           uint64                 `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg31">-		TransactionHistory      uint64                 `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg31">-		StateHistory            uint64                 `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg31">-		StateScheme             string                 `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg31">-		RequiredBlocks          map[uint64]common.Hash `toml:&quot;-&quot;`</span>
<span class="term-fg31">-		LightServ               int                    `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg31">-		LightIngress            int                    `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg31">-		LightEgress             int                    `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg31">-		LightPeers              int                    `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg31">-		LightNoPrune            bool                   `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg31">-		LightNoSyncServe        bool                   `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg31">-		SkipBcVersionCheck      bool                   `toml:&quot;-&quot;`</span>
<span class="term-fg31">-		DatabaseHandles         int                    `toml:&quot;-&quot;`</span>
<span class="term-fg31">-		DatabaseCache           int</span>
<span class="term-fg31">-		DatabaseFreezer         string</span>
<span class="term-fg31">-		TrieCleanCache          int</span>
<span class="term-fg31">-		TrieDirtyCache          int</span>
<span class="term-fg31">-		TrieTimeout             time.Duration</span>
<span class="term-fg31">-		SnapshotCache           int</span>
<span class="term-fg31">-		Preimages               bool</span>
<span class="term-fg31">-		FilterLogCacheSize      int</span>
<span class="term-fg31">-		Miner                   miner.Config</span>
<span class="term-fg31">-		TxPool                  legacypool.Config</span>
<span class="term-fg31">-		BlobPool                blobpool.Config</span>
<span class="term-fg31">-		GPO                     gasprice.Config</span>
<span class="term-fg31">-		EnablePreimageRecording bool</span>
<span class="term-fg31">-		EnableWitnessCollection bool `toml:&quot;-&quot;`</span>
<span class="term-fg31">-		VMTrace                 string</span>
<span class="term-fg31">-		VMTraceJsonConfig       string</span>
<span class="term-fg31">-		DocRoot                 string `toml:&quot;-&quot;`</span>
<span class="term-fg31">-		RPCGasCap               uint64</span>
<span class="term-fg31">-		RPCEVMTimeout           time.Duration</span>
<span class="term-fg31">-		RPCTxFeeCap             float64</span>
<span class="term-fg31">-		OverrideCancun          *uint64 `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg31">-		OverrideVerkle          *uint64 `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg32">+		Genesis                                 *core.Genesis `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg32">+		NetworkId                               uint64</span>
<span class="term-fg32">+		SyncMode                                downloader.SyncMode</span>
<span class="term-fg32">+		EthDiscoveryURLs                        []string</span>
<span class="term-fg32">+		SnapDiscoveryURLs                       []string</span>
<span class="term-fg32">+		NoPruning                               bool</span>
<span class="term-fg32">+		NoPrefetch                              bool</span>
<span class="term-fg32">+		TxLookupLimit                           uint64                 `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg32">+		TransactionHistory                      uint64                 `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg32">+		StateHistory                            uint64                 `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg32">+		StateScheme                             string                 `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg32">+		RequiredBlocks                          map[uint64]common.Hash `toml:&quot;-&quot;`</span>
<span class="term-fg32">+		LightServ                               int                    `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg32">+		LightIngress                            int                    `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg32">+		LightEgress                             int                    `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg32">+		LightPeers                              int                    `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg32">+		LightNoPrune                            bool                   `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg32">+		LightNoSyncServe                        bool                   `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg32">+		SkipBcVersionCheck                      bool                   `toml:&quot;-&quot;`</span>
<span class="term-fg32">+		DatabaseHandles                         int                    `toml:&quot;-&quot;`</span>
<span class="term-fg32">+		DatabaseCache                           int</span>
<span class="term-fg32">+		DatabaseFreezer                         string</span>
<span class="term-fg32">+		TrieCleanCache                          int</span>
<span class="term-fg32">+		TrieDirtyCache                          int</span>
<span class="term-fg32">+		TrieTimeout                             time.Duration</span>
<span class="term-fg32">+		SnapshotCache                           int</span>
<span class="term-fg32">+		Preimages                               bool</span>
<span class="term-fg32">+		FilterLogCacheSize                      int</span>
<span class="term-fg32">+		Miner                                   miner.Config</span>
<span class="term-fg32">+		TxPool                                  legacypool.Config</span>
<span class="term-fg32">+		BlobPool                                blobpool.Config</span>
<span class="term-fg32">+		GPO                                     gasprice.Config</span>
<span class="term-fg32">+		EnablePreimageRecording                 bool</span>
<span class="term-fg32">+		EnableWitnessCollection                 bool `toml:&quot;-&quot;`</span>
<span class="term-fg32">+		VMTrace                                 string</span>
<span class="term-fg32">+		VMTraceJsonConfig                       string</span>
<span class="term-fg32">+		DocRoot                                 string `toml:&quot;-&quot;`</span>
<span class="term-fg32">+		RPCGasCap                               uint64</span>
<span class="term-fg32">+		RPCEVMTimeout                           time.Duration</span>
<span class="term-fg32">+		RPCTxFeeCap                             float64</span>
<span class="term-fg32">+		OverrideCancun                          *uint64 `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg32">+		OverrideVerkle                          *uint64 `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg32">+		OverrideOptimismCanyon                  *uint64 `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg32">+		OverrideOptimismEcotone                 *uint64 `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg32">+		OverrideOptimismFjord                   *uint64 `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg32">+		OverrideOptimismGranite                 *uint64 `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg32">+		OverrideOptimismHolocene                *uint64 `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg32">+		OverrideOptimismInterop                 *uint64 `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg32">+		ApplySuperchainUpgrades                 bool    `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg32">+		RollupSequencerHTTP                     string</span>
<span class="term-fg32">+		RollupHistoricalRPC                     string</span>
<span class="term-fg32">+		RollupHistoricalRPCTimeout              time.Duration</span>
<span class="term-fg32">+		RollupDisableTxPoolGossip               bool</span>
<span class="term-fg32">+		RollupDisableTxPoolAdmission            bool</span>
<span class="term-fg32">+		RollupHaltOnIncompatibleProtocolVersion string</span>
 	}
 	var enc Config
 	enc.Genesis = c.Genesis
<span class="term-fg36">@@ -103,54 +116,80 @@</span> 	enc.RPCEVMTimeout = c.RPCEVMTimeout
 	enc.RPCTxFeeCap = c.RPCTxFeeCap
 	enc.OverrideCancun = c.OverrideCancun
 	enc.OverrideVerkle = c.OverrideVerkle
<span class="term-fg32">+	enc.OverrideOptimismCanyon = c.OverrideOptimismCanyon</span>
<span class="term-fg32">+	enc.OverrideOptimismEcotone = c.OverrideOptimismEcotone</span>
<span class="term-fg32">+	enc.OverrideOptimismFjord = c.OverrideOptimismFjord</span>
<span class="term-fg32">+	enc.OverrideOptimismGranite = c.OverrideOptimismGranite</span>
<span class="term-fg32">+	enc.OverrideOptimismHolocene = c.OverrideOptimismHolocene</span>
<span class="term-fg32">+	enc.OverrideOptimismInterop = c.OverrideOptimismInterop</span>
<span class="term-fg32">+	enc.ApplySuperchainUpgrades = c.ApplySuperchainUpgrades</span>
<span class="term-fg32">+	enc.RollupSequencerHTTP = c.RollupSequencerHTTP</span>
<span class="term-fg32">+	enc.RollupHistoricalRPC = c.RollupHistoricalRPC</span>
<span class="term-fg32">+	enc.RollupHistoricalRPCTimeout = c.RollupHistoricalRPCTimeout</span>
<span class="term-fg32">+	enc.RollupDisableTxPoolGossip = c.RollupDisableTxPoolGossip</span>
<span class="term-fg32">+	enc.RollupDisableTxPoolAdmission = c.RollupDisableTxPoolAdmission</span>
<span class="term-fg32">+	enc.RollupHaltOnIncompatibleProtocolVersion = c.RollupHaltOnIncompatibleProtocolVersion</span>
 	return &amp;enc, nil
 }
&nbsp;
 &#47;&#47; UnmarshalTOML unmarshals from TOML.
 func (c *Config) UnmarshalTOML(unmarshal func(interface{}) error) error {
 	type Config struct {
<span class="term-fg31">-		Genesis                 *core.Genesis `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg31">-		NetworkId               *uint64</span>
<span class="term-fg31">-		SyncMode                *downloader.SyncMode</span>
<span class="term-fg31">-		EthDiscoveryURLs        []string</span>
<span class="term-fg31">-		SnapDiscoveryURLs       []string</span>
<span class="term-fg31">-		NoPruning               *bool</span>
<span class="term-fg31">-		NoPrefetch              *bool</span>
<span class="term-fg31">-		TxLookupLimit           *uint64                `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg31">-		TransactionHistory      *uint64                `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg31">-		StateHistory            *uint64                `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg31">-		StateScheme             *string                `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg31">-		RequiredBlocks          map[uint64]common.Hash `toml:&quot;-&quot;`</span>
<span class="term-fg31">-		LightServ               *int                   `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg31">-		LightIngress            *int                   `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg31">-		LightEgress             *int                   `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg31">-		LightPeers              *int                   `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg31">-		LightNoPrune            *bool                  `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg31">-		LightNoSyncServe        *bool                  `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg31">-		SkipBcVersionCheck      *bool                  `toml:&quot;-&quot;`</span>
<span class="term-fg31">-		DatabaseHandles         *int                   `toml:&quot;-&quot;`</span>
<span class="term-fg31">-		DatabaseCache           *int</span>
<span class="term-fg31">-		DatabaseFreezer         *string</span>
<span class="term-fg31">-		TrieCleanCache          *int</span>
<span class="term-fg31">-		TrieDirtyCache          *int</span>
<span class="term-fg31">-		TrieTimeout             *time.Duration</span>
<span class="term-fg31">-		SnapshotCache           *int</span>
<span class="term-fg31">-		Preimages               *bool</span>
<span class="term-fg31">-		FilterLogCacheSize      *int</span>
<span class="term-fg31">-		Miner                   *miner.Config</span>
<span class="term-fg31">-		TxPool                  *legacypool.Config</span>
<span class="term-fg31">-		BlobPool                *blobpool.Config</span>
<span class="term-fg31">-		GPO                     *gasprice.Config</span>
<span class="term-fg31">-		EnablePreimageRecording *bool</span>
<span class="term-fg31">-		EnableWitnessCollection *bool `toml:&quot;-&quot;`</span>
<span class="term-fg31">-		VMTrace                 *string</span>
<span class="term-fg31">-		VMTraceJsonConfig       *string</span>
<span class="term-fg31">-		DocRoot                 *string `toml:&quot;-&quot;`</span>
<span class="term-fg31">-		RPCGasCap               *uint64</span>
<span class="term-fg31">-		RPCEVMTimeout           *time.Duration</span>
<span class="term-fg31">-		RPCTxFeeCap             *float64</span>
<span class="term-fg31">-		OverrideCancun          *uint64 `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg31">-		OverrideVerkle          *uint64 `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg32">+		Genesis                                 *core.Genesis `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg32">+		NetworkId                               *uint64</span>
<span class="term-fg32">+		SyncMode                                *downloader.SyncMode</span>
<span class="term-fg32">+		EthDiscoveryURLs                        []string</span>
<span class="term-fg32">+		SnapDiscoveryURLs                       []string</span>
<span class="term-fg32">+		NoPruning                               *bool</span>
<span class="term-fg32">+		NoPrefetch                              *bool</span>
<span class="term-fg32">+		TxLookupLimit                           *uint64                `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg32">+		TransactionHistory                      *uint64                `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg32">+		StateHistory                            *uint64                `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg32">+		StateScheme                             *string                `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg32">+		RequiredBlocks                          map[uint64]common.Hash `toml:&quot;-&quot;`</span>
<span class="term-fg32">+		LightServ                               *int                   `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg32">+		LightIngress                            *int                   `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg32">+		LightEgress                             *int                   `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg32">+		LightPeers                              *int                   `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg32">+		LightNoPrune                            *bool                  `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg32">+		LightNoSyncServe                        *bool                  `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg32">+		SkipBcVersionCheck                      *bool                  `toml:&quot;-&quot;`</span>
<span class="term-fg32">+		DatabaseHandles                         *int                   `toml:&quot;-&quot;`</span>
<span class="term-fg32">+		DatabaseCache                           *int</span>
<span class="term-fg32">+		DatabaseFreezer                         *string</span>
<span class="term-fg32">+		TrieCleanCache                          *int</span>
<span class="term-fg32">+		TrieDirtyCache                          *int</span>
<span class="term-fg32">+		TrieTimeout                             *time.Duration</span>
<span class="term-fg32">+		SnapshotCache                           *int</span>
<span class="term-fg32">+		Preimages                               *bool</span>
<span class="term-fg32">+		FilterLogCacheSize                      *int</span>
<span class="term-fg32">+		Miner                                   *miner.Config</span>
<span class="term-fg32">+		TxPool                                  *legacypool.Config</span>
<span class="term-fg32">+		BlobPool                                *blobpool.Config</span>
<span class="term-fg32">+		GPO                                     *gasprice.Config</span>
<span class="term-fg32">+		EnablePreimageRecording                 *bool</span>
<span class="term-fg32">+		EnableWitnessCollection                 *bool `toml:&quot;-&quot;`</span>
<span class="term-fg32">+		VMTrace                                 *string</span>
<span class="term-fg32">+		VMTraceJsonConfig                       *string</span>
<span class="term-fg32">+		DocRoot                                 *string `toml:&quot;-&quot;`</span>
<span class="term-fg32">+		RPCGasCap                               *uint64</span>
<span class="term-fg32">+		RPCEVMTimeout                           *time.Duration</span>
<span class="term-fg32">+		RPCTxFeeCap                             *float64</span>
<span class="term-fg32">+		OverrideCancun                          *uint64 `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg32">+		OverrideVerkle                          *uint64 `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg32">+		OverrideOptimismCanyon                  *uint64 `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg32">+		OverrideOptimismEcotone                 *uint64 `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg32">+		OverrideOptimismFjord                   *uint64 `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg32">+		OverrideOptimismGranite                 *uint64 `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg32">+		OverrideOptimismHolocene                *uint64 `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg32">+		OverrideOptimismInterop                 *uint64 `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg32">+		ApplySuperchainUpgrades                 *bool   `toml:&quot;,omitempty&quot;`</span>
<span class="term-fg32">+		RollupSequencerHTTP                     *string</span>
<span class="term-fg32">+		RollupHistoricalRPC                     *string</span>
<span class="term-fg32">+		RollupHistoricalRPCTimeout              *time.Duration</span>
<span class="term-fg32">+		RollupDisableTxPoolGossip               *bool</span>
<span class="term-fg32">+		RollupDisableTxPoolAdmission            *bool</span>
<span class="term-fg32">+		RollupHaltOnIncompatibleProtocolVersion *string</span>
 	}
 	var dec Config
 	if err := unmarshal(&amp;dec); err != nil {
<span class="term-fg36">@@ -281,6 +320,45 @@</span> 		c.OverrideCancun = dec.OverrideCancun
 	}
 	if dec.OverrideVerkle != nil {
 		c.OverrideVerkle = dec.OverrideVerkle
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if dec.OverrideOptimismCanyon != nil {</span>
<span class="term-fg32">+		c.OverrideOptimismCanyon = dec.OverrideOptimismCanyon</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if dec.OverrideOptimismEcotone != nil {</span>
<span class="term-fg32">+		c.OverrideOptimismEcotone = dec.OverrideOptimismEcotone</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if dec.OverrideOptimismFjord != nil {</span>
<span class="term-fg32">+		c.OverrideOptimismFjord = dec.OverrideOptimismFjord</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if dec.OverrideOptimismGranite != nil {</span>
<span class="term-fg32">+		c.OverrideOptimismGranite = dec.OverrideOptimismGranite</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if dec.OverrideOptimismHolocene != nil {</span>
<span class="term-fg32">+		c.OverrideOptimismHolocene = dec.OverrideOptimismHolocene</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if dec.OverrideOptimismInterop != nil {</span>
<span class="term-fg32">+		c.OverrideOptimismInterop = dec.OverrideOptimismInterop</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if dec.ApplySuperchainUpgrades != nil {</span>
<span class="term-fg32">+		c.ApplySuperchainUpgrades = *dec.ApplySuperchainUpgrades</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if dec.RollupSequencerHTTP != nil {</span>
<span class="term-fg32">+		c.RollupSequencerHTTP = *dec.RollupSequencerHTTP</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if dec.RollupHistoricalRPC != nil {</span>
<span class="term-fg32">+		c.RollupHistoricalRPC = *dec.RollupHistoricalRPC</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if dec.RollupHistoricalRPCTimeout != nil {</span>
<span class="term-fg32">+		c.RollupHistoricalRPCTimeout = *dec.RollupHistoricalRPCTimeout</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if dec.RollupDisableTxPoolGossip != nil {</span>
<span class="term-fg32">+		c.RollupDisableTxPoolGossip = *dec.RollupDisableTxPoolGossip</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if dec.RollupDisableTxPoolAdmission != nil {</span>
<span class="term-fg32">+		c.RollupDisableTxPoolAdmission = *dec.RollupDisableTxPoolAdmission</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if dec.RollupHaltOnIncompatibleProtocolVersion != nil {</span>
<span class="term-fg32">+		c.RollupHaltOnIncompatibleProtocolVersion = *dec.RollupHaltOnIncompatibleProtocolVersion</span>
 	}
 	return nil
 }</div>
    </div>

            
            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
        </div>
    </div>
</div>

            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-5a9c8417bf4e7530e08f4386"role="button" aria-expanded="false" aria-controls="id-5a9c8417bf4e7530e08f4386">
        
            <div class="col-12 col-md-12 col-lg-6 col-xl-6 text-start"><h2>User API enhancements</h2></div>
        

        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2">
            <div class="row line-stat">
                
                
            </div>
        </div>
        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2 ">
            <div class="row line-stat">
                
                    <div class="text-end"><span class="text-success">+939</span></div>
                    <div class="text-start"><span class="text-danger">-86</span></div>
                
                
                    <div class="text-end"><span class="text-add-ignored">+369</span></div>
                    <div class="text-start"><span class="text-delete-ignored">-16</span></div>
                
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-5a9c8417bf4e7530e08f4386">
        <div><p>Encode the Deposit Tx properties, the L1 costs, and daisy-chain RPC-calls for pre-Bedrock historical data</p>
</div>
        <div>
            
            
        </div>
        <div>
            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-f1b7a7d64d64b401c8586e90"role="button" aria-expanded="false" aria-controls="id-f1b7a7d64d64b401c8586e90">
        
            <div class="col-12 col-md-12 col-lg-6 col-xl-6 text-start"><h3>Receipts metadata</h3></div>
        

        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2">
            <div class="row line-stat">
                
                
            </div>
        </div>
        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2 ">
            <div class="row line-stat">
                
                    <div class="text-end"><span class="text-success">+326</span></div>
                    <div class="text-start"><span class="text-danger">-37</span></div>
                
                
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-f1b7a7d64d64b401c8586e90">
        <div><p>Pre-Bedrock L1-cost receipt data is loaded from the database if available, and post-Bedrock the L1-cost
metadata is hydrated on-the-fly based on the L1 fee information in the corresponding block.</p>
</div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-3bce1a7bce6c732080ce1eaf" role="button"
                       aria-expanded="false" aria-controls="id-3bce1a7bce6c732080ce1eaf">
                        <code>core/rawdb/accessors_chain.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/core/rawdb/accessors_chain.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/core/rawdb/accessors_chain.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+9</span></div>
                            <div class="text-start"><span class="text-danger">-1</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-3bce1a7bce6c732080ce1eaf"><span class="term-fg1">diff --git go-ethereum&#47;core&#47;rawdb&#47;accessors_chain.go op-geth&#47;core&#47;rawdb&#47;accessors_chain.go</span>
<span class="term-fg1">index c4735c850c02785330703b563fa21a1eea998dcd..4914d961ec60e48ba3194f8f2a2eecfd8909c55d 100644</span>
<span class="term-fg1">--- go-ethereum&#47;core&#47;rawdb&#47;accessors_chain.go</span>
<span class="term-fg1">+++ op-geth&#47;core&#47;rawdb&#47;accessors_chain.go</span>
<span class="term-fg36">@@ -625,7 +625,6 @@</span> 		log.Error(&quot;Missing body but have receipt&quot;, &quot;hash&quot;, hash, &quot;number&quot;, number)
 		return nil
 	}
 	header := ReadHeader(db, hash, number)
<span class="term-fg31">-</span>
 	var baseFee *big.Int
 	if header == nil {
 		baseFee = big.NewInt(0)
<span class="term-fg36">@@ -675,6 +674,15 @@</span> type storedReceiptRLP struct {
 	PostStateOrStatus []byte
 	CumulativeGasUsed uint64
 	Logs              []*types.Log
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Remaining fields are declared to allow the receipt RLP to be parsed without errors.</span>
<span class="term-fg32">+	&#47;&#47; However, they must not be used as they may not be populated correctly due to multiple receipt formats</span>
<span class="term-fg32">+	&#47;&#47; being combined into a single list of optional fields which can be mistaken for each other.</span>
<span class="term-fg32">+	&#47;&#47; DepositNonce (*uint64) from Regolith deposit tx receipts will be parsed into L1GasUsed</span>
<span class="term-fg32">+	L1GasUsed  *big.Int `rlp:&quot;optional&quot;` &#47;&#47; OVM legacy</span>
<span class="term-fg32">+	L1GasPrice *big.Int `rlp:&quot;optional&quot;` &#47;&#47; OVM legacy</span>
<span class="term-fg32">+	L1Fee      *big.Int `rlp:&quot;optional&quot;` &#47;&#47; OVM legacy</span>
<span class="term-fg32">+	FeeScalar  string   `rlp:&quot;optional&quot;` &#47;&#47; OVM legacy</span>
 }
&nbsp;
 &#47;&#47; ReceiptLogs is a barebone version of ReceiptForStorage which only keeps</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-0064c36fb78ab4cf48651099" role="button"
                       aria-expanded="false" aria-controls="id-0064c36fb78ab4cf48651099">
                        <code>core/types/gen_receipt_json.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/core/types/gen_receipt_json.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/core/types/gen_receipt_json.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+84</span></div>
                            <div class="text-start"><span class="text-danger">-30</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-0064c36fb78ab4cf48651099"><span class="term-fg1">diff --git go-ethereum&#47;core&#47;types&#47;gen_receipt_json.go op-geth&#47;core&#47;types&#47;gen_receipt_json.go</span>
<span class="term-fg1">index 4c641a972795f70ce27e98baf1b3c2e032fe89c2..4e544a0b52b61bac03f57c71581117f04280f81e 100644</span>
<span class="term-fg1">--- go-ethereum&#47;core&#47;types&#47;gen_receipt_json.go</span>
<span class="term-fg1">+++ op-geth&#47;core&#47;types&#47;gen_receipt_json.go</span>
<span class="term-fg36">@@ -16,21 +16,30 @@</span>
 &#47;&#47; MarshalJSON marshals as JSON.
 func (r Receipt) MarshalJSON() ([]byte, error) {
 	type Receipt struct {
<span class="term-fg31">-		Type              hexutil.Uint64 `json:&quot;type,omitempty&quot;`</span>
<span class="term-fg31">-		PostState         hexutil.Bytes  `json:&quot;root&quot;`</span>
<span class="term-fg31">-		Status            hexutil.Uint64 `json:&quot;status&quot;`</span>
<span class="term-fg31">-		CumulativeGasUsed hexutil.Uint64 `json:&quot;cumulativeGasUsed&quot; gencodec:&quot;required&quot;`</span>
<span class="term-fg31">-		Bloom             Bloom          `json:&quot;logsBloom&quot;         gencodec:&quot;required&quot;`</span>
<span class="term-fg31">-		Logs              []*Log         `json:&quot;logs&quot;              gencodec:&quot;required&quot;`</span>
<span class="term-fg31">-		TxHash            common.Hash    `json:&quot;transactionHash&quot; gencodec:&quot;required&quot;`</span>
<span class="term-fg31">-		ContractAddress   common.Address `json:&quot;contractAddress&quot;`</span>
<span class="term-fg31">-		GasUsed           hexutil.Uint64 `json:&quot;gasUsed&quot; gencodec:&quot;required&quot;`</span>
<span class="term-fg31">-		EffectiveGasPrice *hexutil.Big   `json:&quot;effectiveGasPrice&quot;`</span>
<span class="term-fg31">-		BlobGasUsed       hexutil.Uint64 `json:&quot;blobGasUsed,omitempty&quot;`</span>
<span class="term-fg31">-		BlobGasPrice      *hexutil.Big   `json:&quot;blobGasPrice,omitempty&quot;`</span>
<span class="term-fg31">-		BlockHash         common.Hash    `json:&quot;blockHash,omitempty&quot;`</span>
<span class="term-fg31">-		BlockNumber       *hexutil.Big   `json:&quot;blockNumber,omitempty&quot;`</span>
<span class="term-fg31">-		TransactionIndex  hexutil.Uint   `json:&quot;transactionIndex&quot;`</span>
<span class="term-fg32">+		Type                  hexutil.Uint64  `json:&quot;type,omitempty&quot;`</span>
<span class="term-fg32">+		PostState             hexutil.Bytes   `json:&quot;root&quot;`</span>
<span class="term-fg32">+		Status                hexutil.Uint64  `json:&quot;status&quot;`</span>
<span class="term-fg32">+		CumulativeGasUsed     hexutil.Uint64  `json:&quot;cumulativeGasUsed&quot; gencodec:&quot;required&quot;`</span>
<span class="term-fg32">+		Bloom                 Bloom           `json:&quot;logsBloom&quot;         gencodec:&quot;required&quot;`</span>
<span class="term-fg32">+		Logs                  []*Log          `json:&quot;logs&quot;              gencodec:&quot;required&quot;`</span>
<span class="term-fg32">+		TxHash                common.Hash     `json:&quot;transactionHash&quot; gencodec:&quot;required&quot;`</span>
<span class="term-fg32">+		ContractAddress       common.Address  `json:&quot;contractAddress&quot;`</span>
<span class="term-fg32">+		GasUsed               hexutil.Uint64  `json:&quot;gasUsed&quot; gencodec:&quot;required&quot;`</span>
<span class="term-fg32">+		EffectiveGasPrice     *hexutil.Big    `json:&quot;effectiveGasPrice&quot;`</span>
<span class="term-fg32">+		BlobGasUsed           hexutil.Uint64  `json:&quot;blobGasUsed,omitempty&quot;`</span>
<span class="term-fg32">+		BlobGasPrice          *hexutil.Big    `json:&quot;blobGasPrice,omitempty&quot;`</span>
<span class="term-fg32">+		DepositNonce          *hexutil.Uint64 `json:&quot;depositNonce,omitempty&quot;`</span>
<span class="term-fg32">+		DepositReceiptVersion *hexutil.Uint64 `json:&quot;depositReceiptVersion,omitempty&quot;`</span>
<span class="term-fg32">+		BlockHash             common.Hash     `json:&quot;blockHash,omitempty&quot;`</span>
<span class="term-fg32">+		BlockNumber           *hexutil.Big    `json:&quot;blockNumber,omitempty&quot;`</span>
<span class="term-fg32">+		TransactionIndex      hexutil.Uint    `json:&quot;transactionIndex&quot;`</span>
<span class="term-fg32">+		L1GasPrice            *hexutil.Big    `json:&quot;l1GasPrice,omitempty&quot;`</span>
<span class="term-fg32">+		L1BlobBaseFee         *hexutil.Big    `json:&quot;l1BlobBaseFee,omitempty&quot;`</span>
<span class="term-fg32">+		L1GasUsed             *hexutil.Big    `json:&quot;l1GasUsed,omitempty&quot;`</span>
<span class="term-fg32">+		L1Fee                 *hexutil.Big    `json:&quot;l1Fee,omitempty&quot;`</span>
<span class="term-fg32">+		FeeScalar             *big.Float      `json:&quot;l1FeeScalar,omitempty&quot;`</span>
<span class="term-fg32">+		L1BaseFeeScalar       *hexutil.Uint64 `json:&quot;l1BaseFeeScalar,omitempty&quot;`</span>
<span class="term-fg32">+		L1BlobBaseFeeScalar   *hexutil.Uint64 `json:&quot;l1BlobBaseFeeScalar,omitempty&quot;`</span>
 	}
 	var enc Receipt
 	enc.Type = hexutil.Uint64(r.Type)
<span class="term-fg36">@@ -45,30 +54,48 @@</span> 	enc.GasUsed = hexutil.Uint64(r.GasUsed)
 	enc.EffectiveGasPrice = (*hexutil.Big)(r.EffectiveGasPrice)
 	enc.BlobGasUsed = hexutil.Uint64(r.BlobGasUsed)
 	enc.BlobGasPrice = (*hexutil.Big)(r.BlobGasPrice)
<span class="term-fg32">+	enc.DepositNonce = (*hexutil.Uint64)(r.DepositNonce)</span>
<span class="term-fg32">+	enc.DepositReceiptVersion = (*hexutil.Uint64)(r.DepositReceiptVersion)</span>
 	enc.BlockHash = r.BlockHash
 	enc.BlockNumber = (*hexutil.Big)(r.BlockNumber)
 	enc.TransactionIndex = hexutil.Uint(r.TransactionIndex)
<span class="term-fg32">+	enc.L1GasPrice = (*hexutil.Big)(r.L1GasPrice)</span>
<span class="term-fg32">+	enc.L1BlobBaseFee = (*hexutil.Big)(r.L1BlobBaseFee)</span>
<span class="term-fg32">+	enc.L1GasUsed = (*hexutil.Big)(r.L1GasUsed)</span>
<span class="term-fg32">+	enc.L1Fee = (*hexutil.Big)(r.L1Fee)</span>
<span class="term-fg32">+	enc.FeeScalar = r.FeeScalar</span>
<span class="term-fg32">+	enc.L1BaseFeeScalar = (*hexutil.Uint64)(r.L1BaseFeeScalar)</span>
<span class="term-fg32">+	enc.L1BlobBaseFeeScalar = (*hexutil.Uint64)(r.L1BlobBaseFeeScalar)</span>
 	return json.Marshal(&amp;enc)
 }
&nbsp;
 &#47;&#47; UnmarshalJSON unmarshals from JSON.
 func (r *Receipt) UnmarshalJSON(input []byte) error {
 	type Receipt struct {
<span class="term-fg31">-		Type              *hexutil.Uint64 `json:&quot;type,omitempty&quot;`</span>
<span class="term-fg31">-		PostState         *hexutil.Bytes  `json:&quot;root&quot;`</span>
<span class="term-fg31">-		Status            *hexutil.Uint64 `json:&quot;status&quot;`</span>
<span class="term-fg31">-		CumulativeGasUsed *hexutil.Uint64 `json:&quot;cumulativeGasUsed&quot; gencodec:&quot;required&quot;`</span>
<span class="term-fg31">-		Bloom             *Bloom          `json:&quot;logsBloom&quot;         gencodec:&quot;required&quot;`</span>
<span class="term-fg31">-		Logs              []*Log          `json:&quot;logs&quot;              gencodec:&quot;required&quot;`</span>
<span class="term-fg31">-		TxHash            *common.Hash    `json:&quot;transactionHash&quot; gencodec:&quot;required&quot;`</span>
<span class="term-fg31">-		ContractAddress   *common.Address `json:&quot;contractAddress&quot;`</span>
<span class="term-fg31">-		GasUsed           *hexutil.Uint64 `json:&quot;gasUsed&quot; gencodec:&quot;required&quot;`</span>
<span class="term-fg31">-		EffectiveGasPrice *hexutil.Big    `json:&quot;effectiveGasPrice&quot;`</span>
<span class="term-fg31">-		BlobGasUsed       *hexutil.Uint64 `json:&quot;blobGasUsed,omitempty&quot;`</span>
<span class="term-fg31">-		BlobGasPrice      *hexutil.Big    `json:&quot;blobGasPrice,omitempty&quot;`</span>
<span class="term-fg31">-		BlockHash         *common.Hash    `json:&quot;blockHash,omitempty&quot;`</span>
<span class="term-fg31">-		BlockNumber       *hexutil.Big    `json:&quot;blockNumber,omitempty&quot;`</span>
<span class="term-fg31">-		TransactionIndex  *hexutil.Uint   `json:&quot;transactionIndex&quot;`</span>
<span class="term-fg32">+		Type                  *hexutil.Uint64 `json:&quot;type,omitempty&quot;`</span>
<span class="term-fg32">+		PostState             *hexutil.Bytes  `json:&quot;root&quot;`</span>
<span class="term-fg32">+		Status                *hexutil.Uint64 `json:&quot;status&quot;`</span>
<span class="term-fg32">+		CumulativeGasUsed     *hexutil.Uint64 `json:&quot;cumulativeGasUsed&quot; gencodec:&quot;required&quot;`</span>
<span class="term-fg32">+		Bloom                 *Bloom          `json:&quot;logsBloom&quot;         gencodec:&quot;required&quot;`</span>
<span class="term-fg32">+		Logs                  []*Log          `json:&quot;logs&quot;              gencodec:&quot;required&quot;`</span>
<span class="term-fg32">+		TxHash                *common.Hash    `json:&quot;transactionHash&quot; gencodec:&quot;required&quot;`</span>
<span class="term-fg32">+		ContractAddress       *common.Address `json:&quot;contractAddress&quot;`</span>
<span class="term-fg32">+		GasUsed               *hexutil.Uint64 `json:&quot;gasUsed&quot; gencodec:&quot;required&quot;`</span>
<span class="term-fg32">+		EffectiveGasPrice     *hexutil.Big    `json:&quot;effectiveGasPrice&quot;`</span>
<span class="term-fg32">+		BlobGasUsed           *hexutil.Uint64 `json:&quot;blobGasUsed,omitempty&quot;`</span>
<span class="term-fg32">+		BlobGasPrice          *hexutil.Big    `json:&quot;blobGasPrice,omitempty&quot;`</span>
<span class="term-fg32">+		DepositNonce          *hexutil.Uint64 `json:&quot;depositNonce,omitempty&quot;`</span>
<span class="term-fg32">+		DepositReceiptVersion *hexutil.Uint64 `json:&quot;depositReceiptVersion,omitempty&quot;`</span>
<span class="term-fg32">+		BlockHash             *common.Hash    `json:&quot;blockHash,omitempty&quot;`</span>
<span class="term-fg32">+		BlockNumber           *hexutil.Big    `json:&quot;blockNumber,omitempty&quot;`</span>
<span class="term-fg32">+		TransactionIndex      *hexutil.Uint   `json:&quot;transactionIndex&quot;`</span>
<span class="term-fg32">+		L1GasPrice            *hexutil.Big    `json:&quot;l1GasPrice,omitempty&quot;`</span>
<span class="term-fg32">+		L1BlobBaseFee         *hexutil.Big    `json:&quot;l1BlobBaseFee,omitempty&quot;`</span>
<span class="term-fg32">+		L1GasUsed             *hexutil.Big    `json:&quot;l1GasUsed,omitempty&quot;`</span>
<span class="term-fg32">+		L1Fee                 *hexutil.Big    `json:&quot;l1Fee,omitempty&quot;`</span>
<span class="term-fg32">+		FeeScalar             *big.Float      `json:&quot;l1FeeScalar,omitempty&quot;`</span>
<span class="term-fg32">+		L1BaseFeeScalar       *hexutil.Uint64 `json:&quot;l1BaseFeeScalar,omitempty&quot;`</span>
<span class="term-fg32">+		L1BlobBaseFeeScalar   *hexutil.Uint64 `json:&quot;l1BlobBaseFeeScalar,omitempty&quot;`</span>
 	}
 	var dec Receipt
 	if err := json.Unmarshal(input, &amp;dec); err != nil {
<span class="term-fg36">@@ -115,6 +142,12 @@</span> 	}
 	if dec.BlobGasPrice != nil {
 		r.BlobGasPrice = (*big.Int)(dec.BlobGasPrice)
 	}
<span class="term-fg32">+	if dec.DepositNonce != nil {</span>
<span class="term-fg32">+		r.DepositNonce = (*uint64)(dec.DepositNonce)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if dec.DepositReceiptVersion != nil {</span>
<span class="term-fg32">+		r.DepositReceiptVersion = (*uint64)(dec.DepositReceiptVersion)</span>
<span class="term-fg32">+	}</span>
 	if dec.BlockHash != nil {
 		r.BlockHash = *dec.BlockHash
 	}
<span class="term-fg36">@@ -123,6 +156,27 @@</span> 		r.BlockNumber = (*big.Int)(dec.BlockNumber)
 	}
 	if dec.TransactionIndex != nil {
 		r.TransactionIndex = uint(*dec.TransactionIndex)
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if dec.L1GasPrice != nil {</span>
<span class="term-fg32">+		r.L1GasPrice = (*big.Int)(dec.L1GasPrice)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if dec.L1BlobBaseFee != nil {</span>
<span class="term-fg32">+		r.L1BlobBaseFee = (*big.Int)(dec.L1BlobBaseFee)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if dec.L1GasUsed != nil {</span>
<span class="term-fg32">+		r.L1GasUsed = (*big.Int)(dec.L1GasUsed)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if dec.L1Fee != nil {</span>
<span class="term-fg32">+		r.L1Fee = (*big.Int)(dec.L1Fee)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if dec.FeeScalar != nil {</span>
<span class="term-fg32">+		r.FeeScalar = dec.FeeScalar</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if dec.L1BaseFeeScalar != nil {</span>
<span class="term-fg32">+		r.L1BaseFeeScalar = (*uint64)(dec.L1BaseFeeScalar)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if dec.L1BlobBaseFeeScalar != nil {</span>
<span class="term-fg32">+		r.L1BlobBaseFeeScalar = (*uint64)(dec.L1BlobBaseFeeScalar)</span>
 	}
 	return nil
 }</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-5731f86a19569bbd01630fa2" role="button"
                       aria-expanded="false" aria-controls="id-5731f86a19569bbd01630fa2">
                        <code>core/types/receipt.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/core/types/receipt.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/core/types/receipt.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+233</span></div>
                            <div class="text-start"><span class="text-danger">-6</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-5731f86a19569bbd01630fa2"><span class="term-fg1">diff --git go-ethereum&#47;core&#47;types&#47;receipt.go op-geth&#47;core&#47;types&#47;receipt.go</span>
<span class="term-fg1">index 4f96fde59c44278beee06e9846e158c2501644e6..4bc83bf988f84dbe37f3fc0a04577c2838f9363a 100644</span>
<span class="term-fg1">--- go-ethereum&#47;core&#47;types&#47;receipt.go</span>
<span class="term-fg1">+++ op-geth&#47;core&#47;types&#47;receipt.go</span>
<span class="term-fg36">@@ -46,6 +46,9 @@</span> 	ReceiptStatusFailed = uint64(0)
&nbsp;
 	&#47;&#47; ReceiptStatusSuccessful is the status code of a transaction if execution succeeded.
 	ReceiptStatusSuccessful = uint64(1)
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; The version number for post-canyon deposit receipts.</span>
<span class="term-fg32">+	CanyonDepositReceiptVersion = uint64(1)</span>
 )
&nbsp;
 &#47;&#47; Receipt represents the results of a transaction.
<span class="term-fg36">@@ -58,7 +61,8 @@</span> 	CumulativeGasUsed uint64 `json:&quot;cumulativeGasUsed&quot; gencodec:&quot;required&quot;`
 	Bloom             Bloom  `json:&quot;logsBloom&quot;         gencodec:&quot;required&quot;`
 	Logs              []*Log `json:&quot;logs&quot;              gencodec:&quot;required&quot;`
&nbsp;
<span class="term-fg31">-	&#47;&#47; Implementation fields: These fields are added by geth when processing a transaction.</span>
<span class="term-fg32">+	&#47;&#47; Implementation fields: These fields are added by geth when processing a transaction or retrieving a receipt.</span>
<span class="term-fg32">+	&#47;&#47; gencodec annotated fields: these are stored in the chain database.</span>
 	TxHash            common.Hash    `json:&quot;transactionHash&quot; gencodec:&quot;required&quot;`
 	ContractAddress   common.Address `json:&quot;contractAddress&quot;`
 	GasUsed           uint64         `json:&quot;gasUsed&quot; gencodec:&quot;required&quot;`
<span class="term-fg36">@@ -66,11 +70,28 @@</span> 	EffectiveGasPrice *big.Int       `json:&quot;effectiveGasPrice&quot;` &#47;&#47; required, but tag omitted for backwards compatibility
 	BlobGasUsed       uint64         `json:&quot;blobGasUsed,omitempty&quot;`
 	BlobGasPrice      *big.Int       `json:&quot;blobGasPrice,omitempty&quot;`
&nbsp;
<span class="term-fg32">+	&#47;&#47; DepositNonce was introduced in Regolith to store the actual nonce used by deposit transactions</span>
<span class="term-fg32">+	&#47;&#47; The state transition process ensures this is only set for Regolith deposit transactions.</span>
<span class="term-fg32">+	DepositNonce *uint64 `json:&quot;depositNonce,omitempty&quot;`</span>
<span class="term-fg32">+	&#47;&#47; DepositReceiptVersion was introduced in Canyon to indicate an update to how receipt hashes</span>
<span class="term-fg32">+	&#47;&#47; should be computed when set. The state transition process ensures this is only set for</span>
<span class="term-fg32">+	&#47;&#47; post-Canyon deposit transactions.</span>
<span class="term-fg32">+	DepositReceiptVersion *uint64 `json:&quot;depositReceiptVersion,omitempty&quot;`</span>
<span class="term-fg32">+</span>
 	&#47;&#47; Inclusion information: These fields provide information about the inclusion of the
 	&#47;&#47; transaction corresponding to this receipt.
 	BlockHash        common.Hash `json:&quot;blockHash,omitempty&quot;`
 	BlockNumber      *big.Int    `json:&quot;blockNumber,omitempty&quot;`
 	TransactionIndex uint        `json:&quot;transactionIndex&quot;`
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Optimism: extend receipts with L1 fee info</span>
<span class="term-fg32">+	L1GasPrice          *big.Int   `json:&quot;l1GasPrice,omitempty&quot;`          &#47;&#47; Present from pre-bedrock. L1 Basefee after Bedrock</span>
<span class="term-fg32">+	L1BlobBaseFee       *big.Int   `json:&quot;l1BlobBaseFee,omitempty&quot;`       &#47;&#47; Always nil prior to the Ecotone hardfork</span>
<span class="term-fg32">+	L1GasUsed           *big.Int   `json:&quot;l1GasUsed,omitempty&quot;`           &#47;&#47; Present from pre-bedrock, deprecated as of Fjord</span>
<span class="term-fg32">+	L1Fee               *big.Int   `json:&quot;l1Fee,omitempty&quot;`               &#47;&#47; Present from pre-bedrock</span>
<span class="term-fg32">+	FeeScalar           *big.Float `json:&quot;l1FeeScalar,omitempty&quot;`         &#47;&#47; Present from pre-bedrock to Ecotone. Nil after Ecotone</span>
<span class="term-fg32">+	L1BaseFeeScalar     *uint64    `json:&quot;l1BaseFeeScalar,omitempty&quot;`     &#47;&#47; Always nil prior to the Ecotone hardfork</span>
<span class="term-fg32">+	L1BlobBaseFeeScalar *uint64    `json:&quot;l1BlobBaseFeeScalar,omitempty&quot;` &#47;&#47; Always nil prior to the Ecotone hardfork</span>
 }
&nbsp;
 type receiptMarshaling struct {
<span class="term-fg36">@@ -84,6 +105,17 @@</span> 	BlobGasUsed       hexutil.Uint64
 	BlobGasPrice      *hexutil.Big
 	BlockNumber       *hexutil.Big
 	TransactionIndex  hexutil.Uint
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Optimism</span>
<span class="term-fg32">+	L1GasPrice            *hexutil.Big</span>
<span class="term-fg32">+	L1BlobBaseFee         *hexutil.Big</span>
<span class="term-fg32">+	L1GasUsed             *hexutil.Big</span>
<span class="term-fg32">+	L1Fee                 *hexutil.Big</span>
<span class="term-fg32">+	FeeScalar             *big.Float</span>
<span class="term-fg32">+	L1BaseFeeScalar       *hexutil.Uint64</span>
<span class="term-fg32">+	L1BlobBaseFeeScalar   *hexutil.Uint64</span>
<span class="term-fg32">+	DepositNonce          *hexutil.Uint64</span>
<span class="term-fg32">+	DepositReceiptVersion *hexutil.Uint64</span>
 }
&nbsp;
 &#47;&#47; receiptRLP is the consensus encoding of a receipt.
<span class="term-fg36">@@ -94,11 +126,98 @@</span> 	Bloom             Bloom
 	Logs              []*Log
 }
&nbsp;
<span class="term-fg32">+type depositReceiptRLP struct {</span>
<span class="term-fg32">+	PostStateOrStatus []byte</span>
<span class="term-fg32">+	CumulativeGasUsed uint64</span>
<span class="term-fg32">+	Bloom             Bloom</span>
<span class="term-fg32">+	Logs              []*Log</span>
<span class="term-fg32">+	&#47;&#47; DepositNonce was introduced in Regolith to store the actual nonce used by deposit transactions.</span>
<span class="term-fg32">+	&#47;&#47; Must be nil for any transactions prior to Regolith or that aren&#39;t deposit transactions.</span>
<span class="term-fg32">+	DepositNonce *uint64 `rlp:&quot;optional&quot;`</span>
<span class="term-fg32">+	&#47;&#47; Receipt hash post-Regolith but pre-Canyon inadvertently did not include the above</span>
<span class="term-fg32">+	&#47;&#47; DepositNonce. Post Canyon, receipts will have a non-empty DepositReceiptVersion indicating</span>
<span class="term-fg32">+	&#47;&#47; which post-Canyon receipt hash function to invoke.</span>
<span class="term-fg32">+	DepositReceiptVersion *uint64 `rlp:&quot;optional&quot;`</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
 &#47;&#47; storedReceiptRLP is the storage encoding of a receipt.
 type storedReceiptRLP struct {
 	PostStateOrStatus []byte
 	CumulativeGasUsed uint64
 	Logs              []*Log
<span class="term-fg32">+	&#47;&#47; DepositNonce was introduced in Regolith to store the actual nonce used by deposit transactions.</span>
<span class="term-fg32">+	&#47;&#47; Must be nil for any transactions prior to Regolith or that aren&#39;t deposit transactions.</span>
<span class="term-fg32">+	DepositNonce *uint64 `rlp:&quot;optional&quot;`</span>
<span class="term-fg32">+	&#47;&#47; Receipt hash post-Regolith but pre-Canyon inadvertently did not include the above</span>
<span class="term-fg32">+	&#47;&#47; DepositNonce. Post Canyon, receipts will have a non-empty DepositReceiptVersion indicating</span>
<span class="term-fg32">+	&#47;&#47; which post-Canyon receipt hash function to invoke.</span>
<span class="term-fg32">+	DepositReceiptVersion *uint64 `rlp:&quot;optional&quot;`</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; LegacyOptimismStoredReceiptRLP is the pre bedrock storage encoding of a</span>
<span class="term-fg32">+&#47;&#47; receipt. It will only exist in the database if it was migrated using the</span>
<span class="term-fg32">+&#47;&#47; migration tool. Nodes that sync using snap-sync will not have any of these</span>
<span class="term-fg32">+&#47;&#47; entries.</span>
<span class="term-fg32">+type LegacyOptimismStoredReceiptRLP struct {</span>
<span class="term-fg32">+	PostStateOrStatus []byte</span>
<span class="term-fg32">+	CumulativeGasUsed uint64</span>
<span class="term-fg32">+	Logs              []*LogForStorage</span>
<span class="term-fg32">+	L1GasUsed         *big.Int</span>
<span class="term-fg32">+	L1GasPrice        *big.Int</span>
<span class="term-fg32">+	L1Fee             *big.Int</span>
<span class="term-fg32">+	FeeScalar         string</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; LogForStorage is a wrapper around a Log that handles</span>
<span class="term-fg32">+&#47;&#47; backward compatibility with prior storage formats.</span>
<span class="term-fg32">+type LogForStorage Log</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; EncodeRLP implements rlp.Encoder.</span>
<span class="term-fg32">+func (l *LogForStorage) EncodeRLP(w io.Writer) error {</span>
<span class="term-fg32">+	rl := Log{Address: l.Address, Topics: l.Topics, Data: l.Data}</span>
<span class="term-fg32">+	return rlp.Encode(w, &amp;rl)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+type legacyRlpStorageLog struct {</span>
<span class="term-fg32">+	Address     common.Address</span>
<span class="term-fg32">+	Topics      []common.Hash</span>
<span class="term-fg32">+	Data        []byte</span>
<span class="term-fg32">+	BlockNumber uint64</span>
<span class="term-fg32">+	TxHash      common.Hash</span>
<span class="term-fg32">+	TxIndex     uint</span>
<span class="term-fg32">+	BlockHash   common.Hash</span>
<span class="term-fg32">+	Index       uint</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; DecodeRLP implements rlp.Decoder.</span>
<span class="term-fg32">+&#47;&#47;</span>
<span class="term-fg32">+&#47;&#47; Note some redundant fields(e.g. block number, tx hash etc) will be assembled later.</span>
<span class="term-fg32">+func (l *LogForStorage) DecodeRLP(s *rlp.Stream) error {</span>
<span class="term-fg32">+	blob, err := s.Raw()</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	var dec Log</span>
<span class="term-fg32">+	err = rlp.DecodeBytes(blob, &amp;dec)</span>
<span class="term-fg32">+	if err == nil {</span>
<span class="term-fg32">+		*l = LogForStorage{</span>
<span class="term-fg32">+			Address: dec.Address,</span>
<span class="term-fg32">+			Topics:  dec.Topics,</span>
<span class="term-fg32">+			Data:    dec.Data,</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	} else {</span>
<span class="term-fg32">+		&#47;&#47; Try to decode log with previous definition.</span>
<span class="term-fg32">+		var dec legacyRlpStorageLog</span>
<span class="term-fg32">+		err = rlp.DecodeBytes(blob, &amp;dec)</span>
<span class="term-fg32">+		if err == nil {</span>
<span class="term-fg32">+			*l = LogForStorage{</span>
<span class="term-fg32">+				Address: dec.Address,</span>
<span class="term-fg32">+				Topics:  dec.Topics,</span>
<span class="term-fg32">+				Data:    dec.Data,</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	return err</span>
 }
&nbsp;
 &#47;&#47; NewReceipt creates a barebone transaction receipt, copying the init fields.
<span class="term-fg36">@@ -136,7 +255,13 @@</span>
 &#47;&#47; encodeTyped writes the canonical encoding of a typed receipt to w.
 func (r *Receipt) encodeTyped(data *receiptRLP, w *bytes.Buffer) error {
 	w.WriteByte(r.Type)
<span class="term-fg31">-	return rlp.Encode(w, data)</span>
<span class="term-fg32">+	switch r.Type {</span>
<span class="term-fg32">+	case DepositTxType:</span>
<span class="term-fg32">+		withNonce := &amp;depositReceiptRLP{data.PostStateOrStatus, data.CumulativeGasUsed, data.Bloom, data.Logs, r.DepositNonce, r.DepositReceiptVersion}</span>
<span class="term-fg32">+		return rlp.Encode(w, withNonce)</span>
<span class="term-fg32">+	default:</span>
<span class="term-fg32">+		return rlp.Encode(w, data)</span>
<span class="term-fg32">+	}</span>
 }
&nbsp;
 &#47;&#47; MarshalBinary returns the consensus encoding of the receipt.
<span class="term-fg36">@@ -212,6 +337,16 @@</span> 			return err
 		}
 		r.Type = b[0]
 		return r.setFromRLP(data)
<span class="term-fg32">+	case DepositTxType:</span>
<span class="term-fg32">+		var data depositReceiptRLP</span>
<span class="term-fg32">+		err := rlp.DecodeBytes(b[1:], &amp;data)</span>
<span class="term-fg32">+		if err != nil {</span>
<span class="term-fg32">+			return err</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		r.Type = b[0]</span>
<span class="term-fg32">+		r.DepositNonce = data.DepositNonce</span>
<span class="term-fg32">+		r.DepositReceiptVersion = data.DepositReceiptVersion</span>
<span class="term-fg32">+		return r.setFromRLP(receiptRLP{data.PostStateOrStatus, data.CumulativeGasUsed, data.Bloom, data.Logs})</span>
 	default:
 		return ErrTxTypeNotSupported
 	}
<span class="term-fg36">@@ -275,6 +410,12 @@</span> 			return err
 		}
 	}
 	w.ListEnd(logList)
<span class="term-fg32">+	if r.DepositNonce != nil {</span>
<span class="term-fg32">+		w.WriteUint64(*r.DepositNonce)</span>
<span class="term-fg32">+		if r.DepositReceiptVersion != nil {</span>
<span class="term-fg32">+			w.WriteUint64(*r.DepositReceiptVersion)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
 	w.ListEnd(outerList)
 	return w.Flush()
 }
<span class="term-fg36">@@ -282,8 +423,51 @@</span>
 &#47;&#47; DecodeRLP implements rlp.Decoder, and loads both consensus and implementation
 &#47;&#47; fields of a receipt from an RLP stream.
 func (r *ReceiptForStorage) DecodeRLP(s *rlp.Stream) error {
<span class="term-fg32">+	&#47;&#47; Retrieve the entire receipt blob as we need to try multiple decoders</span>
<span class="term-fg32">+	blob, err := s.Raw()</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	&#47;&#47; First try to decode the latest receipt database format, try the pre-bedrock Optimism legacy format otherwise.</span>
<span class="term-fg32">+	if err := decodeStoredReceiptRLP(r, blob); err == nil {</span>
<span class="term-fg32">+		return nil</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	return decodeLegacyOptimismReceiptRLP(r, blob)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func decodeLegacyOptimismReceiptRLP(r *ReceiptForStorage, blob []byte) error {</span>
<span class="term-fg32">+	var stored LegacyOptimismStoredReceiptRLP</span>
<span class="term-fg32">+	if err := rlp.DecodeBytes(blob, &amp;stored); err != nil {</span>
<span class="term-fg32">+		return err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if err := (*Receipt)(r).setStatus(stored.PostStateOrStatus); err != nil {</span>
<span class="term-fg32">+		return err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	r.CumulativeGasUsed = stored.CumulativeGasUsed</span>
<span class="term-fg32">+	r.Logs = make([]*Log, len(stored.Logs))</span>
<span class="term-fg32">+	for i, log := range stored.Logs {</span>
<span class="term-fg32">+		r.Logs[i] = (*Log)(log)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	r.Bloom = CreateBloom(Receipts{(*Receipt)(r)})</span>
<span class="term-fg32">+	&#47;&#47; UsingOVM</span>
<span class="term-fg32">+	scalar := new(big.Float)</span>
<span class="term-fg32">+	if stored.FeeScalar != &quot;&quot; {</span>
<span class="term-fg32">+		var ok bool</span>
<span class="term-fg32">+		scalar, ok = scalar.SetString(stored.FeeScalar)</span>
<span class="term-fg32">+		if !ok {</span>
<span class="term-fg32">+			return errors.New(&quot;cannot parse fee scalar&quot;)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	r.L1GasUsed = stored.L1GasUsed</span>
<span class="term-fg32">+	r.L1GasPrice = stored.L1GasPrice</span>
<span class="term-fg32">+	r.L1Fee = stored.L1Fee</span>
<span class="term-fg32">+	r.FeeScalar = scalar</span>
<span class="term-fg32">+	return nil</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func decodeStoredReceiptRLP(r *ReceiptForStorage, blob []byte) error {</span>
 	var stored storedReceiptRLP
<span class="term-fg31">-	if err := s.Decode(&amp;stored); err != nil {</span>
<span class="term-fg32">+	if err := rlp.DecodeBytes(blob, &amp;stored); err != nil {</span>
 		return err
 	}
 	if err := (*Receipt)(r).setStatus(stored.PostStateOrStatus); err != nil {
<span class="term-fg36">@@ -292,7 +476,10 @@</span> 	}
 	r.CumulativeGasUsed = stored.CumulativeGasUsed
 	r.Logs = stored.Logs
 	r.Bloom = CreateBloom(Receipts{(*Receipt)(r)})
<span class="term-fg31">-</span>
<span class="term-fg32">+	if stored.DepositNonce != nil {</span>
<span class="term-fg32">+		r.DepositNonce = stored.DepositNonce</span>
<span class="term-fg32">+		r.DepositReceiptVersion = stored.DepositReceiptVersion</span>
<span class="term-fg32">+	}</span>
 	return nil
 }
&nbsp;
<span class="term-fg36">@@ -302,7 +489,10 @@</span>
 &#47;&#47; Len returns the number of receipts in this list.
 func (rs Receipts) Len() int { return len(rs) }
&nbsp;
<span class="term-fg31">-&#47;&#47; EncodeIndex encodes the i&#39;th receipt to w.</span>
<span class="term-fg32">+&#47;&#47; EncodeIndex encodes the i&#39;th receipt to w. For DepositTxType receipts with non-nil DepositNonce</span>
<span class="term-fg32">+&#47;&#47; but nil DepositReceiptVersion, the output will differ than calling r.MarshalBinary(); this</span>
<span class="term-fg32">+&#47;&#47; behavior difference should not be changed to preserve backwards compatibility of receipt-root</span>
<span class="term-fg32">+&#47;&#47; hash computation.</span>
 func (rs Receipts) EncodeIndex(i int, w *bytes.Buffer) {
 	r := rs[i]
 	data := &amp;receiptRLP{r.statusEncoding(), r.CumulativeGasUsed, r.Bloom, r.Logs}
<span class="term-fg36">@@ -314,6 +504,14 @@</span> 	w.WriteByte(r.Type)
 	switch r.Type {
 	case AccessListTxType, DynamicFeeTxType, BlobTxType:
 		rlp.Encode(w, data)
<span class="term-fg32">+	case DepositTxType:</span>
<span class="term-fg32">+		if r.DepositReceiptVersion != nil {</span>
<span class="term-fg32">+			&#47;&#47; post-canyon receipt hash computation update</span>
<span class="term-fg32">+			depositData := &amp;depositReceiptRLP{data.PostStateOrStatus, data.CumulativeGasUsed, r.Bloom, r.Logs, r.DepositNonce, r.DepositReceiptVersion}</span>
<span class="term-fg32">+			rlp.Encode(w, depositData)</span>
<span class="term-fg32">+		} else {</span>
<span class="term-fg32">+			rlp.Encode(w, data)</span>
<span class="term-fg32">+		}</span>
 	default:
 		&#47;&#47; For unsupported types, write nothing. Since this is for
 		&#47;&#47; DeriveSha, the error will be caught matching the derived hash
<span class="term-fg36">@@ -351,7 +549,11 @@</span> 		&#47;&#47; The contract address can be derived from the transaction itself
 		if txs[i].To() == nil {
 			&#47;&#47; Deriving the signer is expensive, only do if it&#39;s actually needed
 			from, _ := Sender(signer, txs[i])
<span class="term-fg31">-			rs[i].ContractAddress = crypto.CreateAddress(from, txs[i].Nonce())</span>
<span class="term-fg32">+			nonce := txs[i].Nonce()</span>
<span class="term-fg32">+			if rs[i].DepositNonce != nil {</span>
<span class="term-fg32">+				nonce = *rs[i].DepositNonce</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+			rs[i].ContractAddress = crypto.CreateAddress(from, nonce)</span>
 		} else {
 			rs[i].ContractAddress = common.Address{}
 		}
<span class="term-fg36">@@ -373,5 +575,30 @@</span> 			rs[i].Logs[j].Index = logIndex
 			logIndex++
 		}
 	}
<span class="term-fg32">+	if config.Optimism != nil &amp;&amp; len(txs) &gt;= 2 &amp;&amp; config.IsBedrock(new(big.Int).SetUint64(number)) { &#47;&#47; need at least an info tx and a non-info tx</span>
<span class="term-fg32">+		gasParams, err := extractL1GasParams(config, time, txs[0].Data())</span>
<span class="term-fg32">+		if err != nil {</span>
<span class="term-fg32">+			return err</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		for i := 0; i &lt; len(rs); i++ {</span>
<span class="term-fg32">+			if txs[i].IsDepositTx() {</span>
<span class="term-fg32">+				continue</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+			rs[i].L1GasPrice = gasParams.l1BaseFee</span>
<span class="term-fg32">+			rs[i].L1BlobBaseFee = gasParams.l1BlobBaseFee</span>
<span class="term-fg32">+			rs[i].L1Fee, rs[i].L1GasUsed = gasParams.costFunc(txs[i].RollupCostData())</span>
<span class="term-fg32">+			rs[i].FeeScalar = gasParams.feeScalar</span>
<span class="term-fg32">+			rs[i].L1BaseFeeScalar = u32ptrTou64ptr(gasParams.l1BaseFeeScalar)</span>
<span class="term-fg32">+			rs[i].L1BlobBaseFeeScalar = u32ptrTou64ptr(gasParams.l1BlobBaseFeeScalar)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
 	return nil
 }
<span class="term-fg32">+</span>
<span class="term-fg32">+func u32ptrTou64ptr(a *uint32) *uint64 {</span>
<span class="term-fg32">+	if a == nil {</span>
<span class="term-fg32">+		return nil</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	b := uint64(*a)</span>
<span class="term-fg32">+	return &amp;b</span>
<span class="term-fg32">+}</span></div>
    </div>

            
            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-59fb407945b21bc522aa73fd"role="button" aria-expanded="false" aria-controls="id-59fb407945b21bc522aa73fd">
        
            <div class="col-12 col-md-12 col-lg-6 col-xl-6 text-start"><h3>API Backend</h3></div>
        

        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2">
            <div class="row line-stat">
                
                
            </div>
        </div>
        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2 ">
            <div class="row line-stat">
                
                    <div class="text-end"><span class="text-success">+144</span></div>
                    <div class="text-start"><span class="text-danger">-12</span></div>
                
                
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-59fb407945b21bc522aa73fd">
        <div><p>Forward transactions to the sequencer if configured.</p>
</div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-3a615ee1367a898007a148b4" role="button"
                       aria-expanded="false" aria-controls="id-3a615ee1367a898007a148b4">
                        <code>eth/api_backend.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/eth/api_backend.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/eth/api_backend.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+42</span></div>
                            <div class="text-start"><span class="text-danger">-6</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-3a615ee1367a898007a148b4"><span class="term-fg1">diff --git go-ethereum&#47;eth&#47;api_backend.go op-geth&#47;eth&#47;api_backend.go</span>
<span class="term-fg1">index 8a9898b956f38a6584f98a7ca4a067b27d03ba7e..bd1b623c367f5e25d66f92bc0c96790bf59e19ca 100644</span>
<span class="term-fg1">--- go-ethereum&#47;eth&#47;api_backend.go</span>
<span class="term-fg1">+++ op-geth&#47;eth&#47;api_backend.go</span>
<span class="term-fg36">@@ -19,12 +19,14 @@</span>
 import (
 	&quot;context&quot;
 	&quot;errors&quot;
<span class="term-fg32">+	&quot;fmt&quot;</span>
 	&quot;math&#47;big&quot;
 	&quot;time&quot;
&nbsp;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;accounts&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&quot;
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&#47;hexutil&quot;</span>
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;consensus&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;consensus&#47;misc&#47;eip4844&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&quot;
<span class="term-fg36">@@ -38,6 +40,7 @@</span> 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;eth&#47;gasprice&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;eth&#47;tracers&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;ethdb&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;event&quot;
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;log&quot;</span>
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;params&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;rpc&quot;
 )
<span class="term-fg36">@@ -46,6 +49,7 @@</span> &#47;&#47; EthAPIBackend implements ethapi.Backend and tracers.Backend for full nodes
 type EthAPIBackend struct {
 	extRPCEnabled       bool
 	allowUnprotectedTxs bool
<span class="term-fg32">+	disableTxPool       bool</span>
 	eth                 *Ethereum
 	gpo                 *gasprice.Oracle
 }
<span class="term-fg36">@@ -190,10 +194,11 @@</span> func (b *EthAPIBackend) StateAndHeaderByNumber(ctx context.Context, number rpc.BlockNumber) (*state.StateDB, *types.Header, error) {
 	&#47;&#47; Pending state is only known by the miner
 	if number == rpc.PendingBlockNumber {
 		block, _, state := b.eth.miner.Pending()
<span class="term-fg31">-		if block == nil || state == nil {</span>
<span class="term-fg31">-			return nil, nil, errors.New(&quot;pending state is not available&quot;)</span>
<span class="term-fg32">+		if block != nil &amp;&amp; state != nil {</span>
<span class="term-fg32">+			return state, block.Header(), nil</span>
<span class="term-fg32">+		} else {</span>
<span class="term-fg32">+			number = rpc.LatestBlockNumber &#47;&#47; fall back to latest state</span>
 		}
<span class="term-fg31">-		return state, block.Header(), nil</span>
 	}
 	&#47;&#47; Otherwise resolve the block number and return its state
 	header, err := b.HeaderByNumber(ctx, number)
<span class="term-fg36">@@ -201,7 +206,7 @@</span> 	if err != nil {
 		return nil, nil, err
 	}
 	if header == nil {
<span class="term-fg31">-		return nil, nil, errors.New(&quot;header not found&quot;)</span>
<span class="term-fg32">+		return nil, nil, fmt.Errorf(&quot;header %w&quot;, ethereum.NotFound)</span>
 	}
 	stateDb, err := b.eth.BlockChain().StateAt(header.Root)
 	if err != nil {
<span class="term-fg36">@@ -220,7 +225,7 @@</span> 		if err != nil {
 			return nil, nil, err
 		}
 		if header == nil {
<span class="term-fg31">-			return nil, nil, errors.New(&quot;header for hash not found&quot;)</span>
<span class="term-fg32">+			return nil, nil, fmt.Errorf(&quot;header for hash %w&quot;, ethereum.NotFound)</span>
 		}
 		if blockNrOrHash.RequireCanonical &amp;&amp; b.eth.blockchain.GetCanonicalHash(header.Number.Uint64()) != hash {
 			return nil, nil, errors.New(&quot;hash is not currently canonical&quot;)
<span class="term-fg36">@@ -258,7 +263,7 @@</span> 	var context vm.BlockContext
 	if blockCtx != nil {
 		context = *blockCtx
 	} else {
<span class="term-fg31">-		context = core.NewEVMBlockContext(header, b.eth.BlockChain(), nil)</span>
<span class="term-fg32">+		context = core.NewEVMBlockContext(header, b.eth.BlockChain(), nil, b.eth.blockchain.Config(), state)</span>
 	}
 	return vm.NewEVM(context, txContext, state, b.ChainConfig(), *vmConfig)
 }
<span class="term-fg36">@@ -284,6 +289,29 @@</span> 	return b.eth.BlockChain().SubscribeLogsEvent(ch)
 }
&nbsp;
 func (b *EthAPIBackend) SendTx(ctx context.Context, signedTx *types.Transaction) error {
<span class="term-fg32">+	if b.ChainConfig().IsOptimism() &amp;&amp; signedTx.Type() == types.BlobTxType {</span>
<span class="term-fg32">+		return types.ErrTxTypeNotSupported</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if b.eth.seqRPCService != nil {</span>
<span class="term-fg32">+		data, err := signedTx.MarshalBinary()</span>
<span class="term-fg32">+		if err != nil {</span>
<span class="term-fg32">+			return err</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		if err := b.eth.seqRPCService.CallContext(ctx, nil, &quot;eth_sendRawTransaction&quot;, hexutil.Encode(data)); err != nil {</span>
<span class="term-fg32">+			return err</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		if b.disableTxPool {</span>
<span class="term-fg32">+			return nil</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		&#47;&#47; Retain tx in local tx pool after forwarding, for local RPC usage.</span>
<span class="term-fg32">+		if err := b.eth.txPool.Add([]*types.Transaction{signedTx}, true, false)[0]; err != nil {</span>
<span class="term-fg32">+			log.Warn(&quot;successfully sent tx to sequencer, but failed to persist in local tx pool&quot;, &quot;err&quot;, err, &quot;tx&quot;, signedTx.Hash())</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		return nil</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if b.disableTxPool {</span>
<span class="term-fg32">+		return nil</span>
<span class="term-fg32">+	}</span>
 	return b.eth.txPool.Add([]*types.Transaction{signedTx}, true, false)[0]
 }
&nbsp;
<span class="term-fg36">@@ -431,3 +459,11 @@</span>
 func (b *EthAPIBackend) StateAtTransaction(ctx context.Context, block *types.Block, txIndex int, reexec uint64) (*types.Transaction, vm.BlockContext, *state.StateDB, tracers.StateReleaseFunc, error) {
 	return b.eth.stateAtTransaction(ctx, block, txIndex, reexec)
 }
<span class="term-fg32">+</span>
<span class="term-fg32">+func (b *EthAPIBackend) HistoricalRPCService() *rpc.Client {</span>
<span class="term-fg32">+	return b.eth.historicalRPCService</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (b *EthAPIBackend) Genesis() *types.Block {</span>
<span class="term-fg32">+	return b.eth.blockchain.Genesis()</span>
<span class="term-fg32">+}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-a7ebddaf2c698ef4e6a30f87" role="button"
                       aria-expanded="false" aria-controls="id-a7ebddaf2c698ef4e6a30f87">
                        <code>eth/backend.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/eth/backend.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/eth/backend.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+100</span></div>
                            <div class="text-start"><span class="text-danger">-6</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-a7ebddaf2c698ef4e6a30f87"><span class="term-fg1">diff --git go-ethereum&#47;eth&#47;backend.go op-geth&#47;eth&#47;backend.go</span>
<span class="term-fg1">index 91a07811f0383daab2b9884e3048f6bcb34cd6f0..ace4a00c244a60149567f324f0b8a150549e90e7 100644</span>
<span class="term-fg1">--- go-ethereum&#47;eth&#47;backend.go</span>
<span class="term-fg1">+++ op-geth&#47;eth&#47;backend.go</span>
<span class="term-fg36">@@ -18,11 +18,13 @@</span> &#47;&#47; Package eth implements the Ethereum protocol.
 package eth
&nbsp;
 import (
<span class="term-fg32">+	&quot;context&quot;</span>
 	&quot;encoding&#47;json&quot;
 	&quot;fmt&quot;
 	&quot;math&#47;big&quot;
 	&quot;runtime&quot;
 	&quot;sync&quot;
<span class="term-fg32">+	&quot;time&quot;</span>
&nbsp;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;accounts&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&quot;
<span class="term-fg36">@@ -74,6 +76,9 @@</span> 	handler            *handler
 	ethDialCandidates  enode.Iterator
 	snapDialCandidates enode.Iterator
&nbsp;
<span class="term-fg32">+	seqRPCService        *rpc.Client</span>
<span class="term-fg32">+	historicalRPCService *rpc.Client</span>
<span class="term-fg32">+</span>
 	&#47;&#47; DB interfaces
 	chainDb ethdb.Database &#47;&#47; Block chain database
&nbsp;
<span class="term-fg36">@@ -98,6 +103,8 @@</span>
 	lock sync.RWMutex &#47;&#47; Protects the variadic fields (e.g. gas price and etherbase)
&nbsp;
 	shutdownTracker *shutdowncheck.ShutdownTracker &#47;&#47; Tracks if and when the node has shutdown ungracefully
<span class="term-fg32">+</span>
<span class="term-fg32">+	nodeCloser func() error</span>
 }
&nbsp;
 &#47;&#47; New creates a new Ethereum object (including the initialisation of the common Ethereum object),
<span class="term-fg36">@@ -163,13 +170,13 @@</span> 		bloomRequests:     make(chan chan *bloombits.Retrieval),
 		bloomIndexer:      core.NewBloomIndexer(chainDb, params.BloomBitsBlocks, params.BloomConfirms),
 		p2pServer:         stack.Server(),
 		shutdownTracker:   shutdowncheck.NewShutdownTracker(chainDb),
<span class="term-fg32">+		nodeCloser:        stack.Close,</span>
 	}
 	bcVersion := rawdb.ReadDatabaseVersion(chainDb)
<span class="term-fg31">-	var dbVer = &quot;&lt;nil&gt;&quot;</span>
<span class="term-fg32">+	dbVer := &quot;&lt;nil&gt;&quot;</span>
 	if bcVersion != nil {
 		dbVer = fmt.Sprintf(&quot;%d&quot;, *bcVersion)
 	}
<span class="term-fg31">-	log.Info(&quot;Initialising Ethereum protocol&quot;, &quot;network&quot;, networkID, &quot;dbversion&quot;, dbVer)</span>
&nbsp;
 	if !config.SkipBcVersionCheck {
 		if bcVersion != nil &amp;&amp; *bcVersion &gt; core.BlockChainVersion {
<span class="term-fg36">@@ -217,6 +224,26 @@</span> 	}
 	if config.OverrideVerkle != nil {
 		overrides.OverrideVerkle = config.OverrideVerkle
 	}
<span class="term-fg32">+	if config.OverrideOptimismCanyon != nil {</span>
<span class="term-fg32">+		overrides.OverrideOptimismCanyon = config.OverrideOptimismCanyon</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if config.OverrideOptimismEcotone != nil {</span>
<span class="term-fg32">+		overrides.OverrideOptimismEcotone = config.OverrideOptimismEcotone</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if config.OverrideOptimismFjord != nil {</span>
<span class="term-fg32">+		overrides.OverrideOptimismFjord = config.OverrideOptimismFjord</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if config.OverrideOptimismGranite != nil {</span>
<span class="term-fg32">+		overrides.OverrideOptimismGranite = config.OverrideOptimismGranite</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if config.OverrideOptimismHolocene != nil {</span>
<span class="term-fg32">+		overrides.OverrideOptimismHolocene = config.OverrideOptimismHolocene</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if config.OverrideOptimismInterop != nil {</span>
<span class="term-fg32">+		overrides.OverrideOptimismInterop = config.OverrideOptimismInterop</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	overrides.ApplySuperchainUpgrades = config.ApplySuperchainUpgrades</span>
<span class="term-fg32">+</span>
 	&#47;&#47; TODO (MariusVanDerWijden) get rid of shouldPreserve in a follow-up PR
 	shouldPreserve := func(header *types.Header) bool {
 		return false
<span class="term-fg36">@@ -225,19 +252,29 @@</span> 	eth.blockchain, err = core.NewBlockChain(chainDb, cacheConfig, config.Genesis, &amp;overrides, eth.engine, vmConfig, shouldPreserve, &amp;config.TransactionHistory)
 	if err != nil {
 		return nil, err
 	}
<span class="term-fg32">+	if chainConfig := eth.blockchain.Config(); chainConfig.Optimism != nil { &#47;&#47; config.Genesis.Config.ChainID cannot be used because it&#39;s based on CLI flags only, thus default to mainnet L1</span>
<span class="term-fg32">+		config.NetworkId = chainConfig.ChainID.Uint64() &#47;&#47; optimism defaults eth network ID to chain ID</span>
<span class="term-fg32">+		eth.networkID = config.NetworkId</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	log.Info(&quot;Initialising Ethereum protocol&quot;, &quot;network&quot;, config.NetworkId, &quot;dbversion&quot;, dbVer)</span>
<span class="term-fg32">+</span>
 	eth.bloomIndexer.Start(eth.blockchain)
&nbsp;
 	if config.BlobPool.Datadir != &quot;&quot; {
 		config.BlobPool.Datadir = stack.ResolvePath(config.BlobPool.Datadir)
 	}
<span class="term-fg31">-	blobPool := blobpool.New(config.BlobPool, eth.blockchain)</span>
&nbsp;
 	if config.TxPool.Journal != &quot;&quot; {
 		config.TxPool.Journal = stack.ResolvePath(config.TxPool.Journal)
 	}
 	legacyPool := legacypool.New(config.TxPool, eth.blockchain)
&nbsp;
<span class="term-fg31">-	eth.txPool, err = txpool.New(config.TxPool.PriceLimit, eth.blockchain, []txpool.SubPool{legacyPool, blobPool})</span>
<span class="term-fg32">+	txPools := []txpool.SubPool{legacyPool}</span>
<span class="term-fg32">+	if !eth.BlockChain().Config().IsOptimism() {</span>
<span class="term-fg32">+		blobPool := blobpool.New(config.BlobPool, eth.blockchain)</span>
<span class="term-fg32">+		txPools = append(txPools, blobPool)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	eth.txPool, err = txpool.New(config.TxPool.PriceLimit, eth.blockchain, txPools)</span>
 	if err != nil {
 		return nil, err
 	}
<span class="term-fg36">@@ -253,6 +290,7 @@</span> 		Sync:           config.SyncMode,
 		BloomCache:     uint64(cacheLimit),
 		EventMux:       eth.eventMux,
 		RequiredBlocks: config.RequiredBlocks,
<span class="term-fg32">+		NoTxGossip:     config.RollupDisableTxPoolGossip,</span>
 	}); err != nil {
 		return nil, err
 	}
<span class="term-fg36">@@ -260,7 +298,7 @@</span>
 	eth.miner = miner.New(eth, config.Miner, eth.engine)
 	eth.miner.SetExtra(makeExtraData(config.Miner.ExtraData))
&nbsp;
<span class="term-fg31">-	eth.APIBackend = &amp;EthAPIBackend{stack.Config().ExtRPCEnabled(), stack.Config().AllowUnprotectedTxs, eth, nil}</span>
<span class="term-fg32">+	eth.APIBackend = &amp;EthAPIBackend{stack.Config().ExtRPCEnabled(), stack.Config().AllowUnprotectedTxs, config.RollupDisableTxPoolAdmission, eth, nil}</span>
 	if eth.APIBackend.allowUnprotectedTxs {
 		log.Info(&quot;Unprotected transactions allowed&quot;)
 	}
<span class="term-fg36">@@ -281,6 +319,26 @@</span> 	if err != nil {
 		return nil, err
 	}
&nbsp;
<span class="term-fg32">+	if config.RollupSequencerHTTP != &quot;&quot; {</span>
<span class="term-fg32">+		ctx, cancel := context.WithTimeout(context.Background(), 5*time.Second)</span>
<span class="term-fg32">+		client, err := rpc.DialContext(ctx, config.RollupSequencerHTTP)</span>
<span class="term-fg32">+		cancel()</span>
<span class="term-fg32">+		if err != nil {</span>
<span class="term-fg32">+			return nil, err</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		eth.seqRPCService = client</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	if config.RollupHistoricalRPC != &quot;&quot; {</span>
<span class="term-fg32">+		ctx, cancel := context.WithTimeout(context.Background(), config.RollupHistoricalRPCTimeout)</span>
<span class="term-fg32">+		client, err := rpc.DialContext(ctx, config.RollupHistoricalRPC)</span>
<span class="term-fg32">+		cancel()</span>
<span class="term-fg32">+		if err != nil {</span>
<span class="term-fg32">+			return nil, err</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		eth.historicalRPCService = client</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
 	&#47;&#47; Start the RPC service
 	eth.netRPCService = ethapi.NewNetAPI(eth.p2pServer, networkID)
&nbsp;
<span class="term-fg36">@@ -299,7 +357,7 @@</span> func makeExtraData(extra []byte) []byte {
 	if len(extra) == 0 {
 		&#47;&#47; create default extradata
 		extra, _ = rlp.EncodeToBytes([]interface{}{
<span class="term-fg31">-			uint(params.VersionMajor&lt;&lt;16 | params.VersionMinor&lt;&lt;8 | params.VersionPatch),</span>
<span class="term-fg32">+			uint(params.OPVersionMajor&lt;&lt;16 | params.OPVersionMinor&lt;&lt;8 | params.OPVersionPatch),</span>
 			&quot;geth&quot;,
 			runtime.Version(),
 			runtime.GOOS,
<span class="term-fg36">@@ -408,6 +466,12 @@</span> 	close(s.closeBloomHandler)
 	s.txPool.Close()
 	s.blockchain.Stop()
 	s.engine.Close()
<span class="term-fg32">+	if s.seqRPCService != nil {</span>
<span class="term-fg32">+		s.seqRPCService.Close()</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if s.historicalRPCService != nil {</span>
<span class="term-fg32">+		s.historicalRPCService.Close()</span>
<span class="term-fg32">+	}</span>
&nbsp;
 	&#47;&#47; Clean shutdown marker as the last thing before closing db
 	s.shutdownTracker.Stop()
<span class="term-fg36">@@ -443,3 +507,33 @@</span> 	}
 	&#47;&#47; Nope, we&#39;re really full syncing
 	return downloader.FullSync
 }
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; HandleRequiredProtocolVersion handles the protocol version signal. This implements opt-in halting,</span>
<span class="term-fg32">+&#47;&#47; the protocol version data is already logged and metered when signaled through the Engine API.</span>
<span class="term-fg32">+func (s *Ethereum) HandleRequiredProtocolVersion(required params.ProtocolVersion) error {</span>
<span class="term-fg32">+	var needLevel int</span>
<span class="term-fg32">+	switch s.config.RollupHaltOnIncompatibleProtocolVersion {</span>
<span class="term-fg32">+	case &quot;major&quot;:</span>
<span class="term-fg32">+		needLevel = 3</span>
<span class="term-fg32">+	case &quot;minor&quot;:</span>
<span class="term-fg32">+		needLevel = 2</span>
<span class="term-fg32">+	case &quot;patch&quot;:</span>
<span class="term-fg32">+		needLevel = 1</span>
<span class="term-fg32">+	default:</span>
<span class="term-fg32">+		return nil &#47;&#47; do not consider halting if not configured to</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	haveLevel := 0</span>
<span class="term-fg32">+	switch params.OPStackSupport.Compare(required) {</span>
<span class="term-fg32">+	case params.OutdatedMajor:</span>
<span class="term-fg32">+		haveLevel = 3</span>
<span class="term-fg32">+	case params.OutdatedMinor:</span>
<span class="term-fg32">+		haveLevel = 2</span>
<span class="term-fg32">+	case params.OutdatedPatch:</span>
<span class="term-fg32">+		haveLevel = 1</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if haveLevel &gt;= needLevel { &#47;&#47; halt if we opted in to do so at this granularity</span>
<span class="term-fg32">+		log.Error(&quot;Opted to halt, unprepared for protocol change&quot;, &quot;required&quot;, required, &quot;local&quot;, params.OPStackSupport)</span>
<span class="term-fg32">+		return s.nodeCloser()</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	return nil</span>
<span class="term-fg32">+}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-22a17a82bb5c562e6f42cd0a" role="button"
                       aria-expanded="false" aria-controls="id-22a17a82bb5c562e6f42cd0a">
                        <code>internal/ethapi/backend.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/internal/ethapi/backend.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/internal/ethapi/backend.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+2</span></div>
                            <div class="text-start"><span class="text-danger">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-22a17a82bb5c562e6f42cd0a"><span class="term-fg1">diff --git go-ethereum&#47;internal&#47;ethapi&#47;backend.go op-geth&#47;internal&#47;ethapi&#47;backend.go</span>
<span class="term-fg1">index 2a45ba09210fdf595f0c51d0213481670b3bb446..7265bed8a02fca230b74b8e6ad1e78c4e223b84a 100644</span>
<span class="term-fg1">--- go-ethereum&#47;internal&#47;ethapi&#47;backend.go</span>
<span class="term-fg1">+++ op-geth&#47;internal&#47;ethapi&#47;backend.go</span>
<span class="term-fg36">@@ -87,6 +87,8 @@</span> 	SubscribeNewTxsEvent(chan&lt;- core.NewTxsEvent) event.Subscription
&nbsp;
 	ChainConfig() *params.ChainConfig
 	Engine() consensus.Engine
<span class="term-fg32">+	HistoricalRPCService() *rpc.Client</span>
<span class="term-fg32">+	Genesis() *types.Block</span>
&nbsp;
 	&#47;&#47; This is copied from filters.Backend
 	&#47;&#47; eth&#47;filters needs to be initialized from this backend type, so methods needed by</div>
    </div>

            
            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-cd7c1bd8c3c63ad486d5eda2"role="button" aria-expanded="false" aria-controls="id-cd7c1bd8c3c63ad486d5eda2">
        
            <div class="col-12 col-md-12 col-lg-6 col-xl-6 text-start"><h3>Apply L1 cost in API responses</h3></div>
        

        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2">
            <div class="row line-stat">
                
                
            </div>
        </div>
        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2 ">
            <div class="row line-stat">
                
                    <div class="text-end"><span class="text-success">+2</span></div>
                    <div class="text-start"><span class="text-danger">-2</span></div>
                
                
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-cd7c1bd8c3c63ad486d5eda2">
        <div></div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-625069b85100dada34b47f6a" role="button"
                       aria-expanded="false" aria-controls="id-625069b85100dada34b47f6a">
                        <code>eth/state_accessor.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/eth/state_accessor.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/eth/state_accessor.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+2</span></div>
                            <div class="text-start"><span class="text-danger">-2</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-625069b85100dada34b47f6a"><span class="term-fg1">diff --git go-ethereum&#47;eth&#47;state_accessor.go op-geth&#47;eth&#47;state_accessor.go</span>
<span class="term-fg1">index 372c76f496924afff7498370bb581698a0803822..4aa5edde2e38f929d4d7c4893fd97bbe45b265fb 100644</span>
<span class="term-fg1">--- go-ethereum&#47;eth&#47;state_accessor.go</span>
<span class="term-fg1">+++ op-geth&#47;eth&#47;state_accessor.go</span>
<span class="term-fg36">@@ -235,7 +235,7 @@</span> 		return nil, vm.BlockContext{}, nil, nil, err
 	}
 	&#47;&#47; Insert parent beacon block root in the state as per EIP-4788.
 	if beaconRoot := block.BeaconRoot(); beaconRoot != nil {
<span class="term-fg31">-		context := core.NewEVMBlockContext(block.Header(), eth.blockchain, nil)</span>
<span class="term-fg32">+		context := core.NewEVMBlockContext(block.Header(), eth.blockchain, nil, eth.blockchain.Config(), statedb)</span>
 		vmenv := vm.NewEVM(context, vm.TxContext{}, statedb, eth.blockchain.Config(), vm.Config{})
 		core.ProcessBeaconBlockRoot(*beaconRoot, vmenv, statedb)
 	}
<span class="term-fg36">@@ -248,7 +248,7 @@</span> 	for idx, tx := range block.Transactions() {
 		&#47;&#47; Assemble the transaction call message and return if the requested offset
 		msg, _ := core.TransactionToMessage(tx, signer, block.BaseFee())
 		txContext := core.NewEVMTxContext(msg)
<span class="term-fg31">-		context := core.NewEVMBlockContext(block.Header(), eth.blockchain, nil)</span>
<span class="term-fg32">+		context := core.NewEVMBlockContext(block.Header(), eth.blockchain, nil, eth.blockchain.Config(), statedb)</span>
 		if idx == txIndex {
 			return tx, context, statedb, release, nil
 		}</div>
    </div>

            
            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-225a3232b47adc4f13f05610"role="button" aria-expanded="false" aria-controls="id-225a3232b47adc4f13f05610">
        
            <div class="col-12 col-md-12 col-lg-6 col-xl-6 text-start"><h3>API frontend</h3></div>
        

        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2">
            <div class="row line-stat">
                
                
            </div>
        </div>
        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2 ">
            <div class="row line-stat">
                
                    <div class="text-end"><span class="text-success">+265</span></div>
                    <div class="text-start"><span class="text-danger">-18</span></div>
                
                
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-225a3232b47adc4f13f05610">
        <div><p>Format deposit and L1-cost data in transaction responses. Add <code>debug_chainConfig</code> API.</p>
</div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-3e8c304a442676f8fb6c67a4" role="button"
                       aria-expanded="false" aria-controls="id-3e8c304a442676f8fb6c67a4">
                        <code>internal/ethapi/api.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/internal/ethapi/api.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/internal/ethapi/api.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+255</span></div>
                            <div class="text-start"><span class="text-danger">-18</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-3e8c304a442676f8fb6c67a4"><span class="term-fg1">diff --git go-ethereum&#47;internal&#47;ethapi&#47;api.go op-geth&#47;internal&#47;ethapi&#47;api.go</span>
<span class="term-fg1">index 0ecedf1130385796c195e1cb99c6fbf6a487952e..68b237e0af741a2771a31b85f4cabac955114ef4 100644</span>
<span class="term-fg1">--- go-ethereum&#47;internal&#47;ethapi&#47;api.go</span>
<span class="term-fg1">+++ op-geth&#47;internal&#47;ethapi&#47;api.go</span>
<span class="term-fg36">@@ -26,6 +26,7 @@</span> 	&quot;strings&quot;
 	&quot;time&quot;
&nbsp;
 	&quot;github.com&#47;davecgh&#47;go-spew&#47;spew&quot;
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&quot;</span>
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;accounts&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;accounts&#47;keystore&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;accounts&#47;scwallet&quot;
<span class="term-fg36">@@ -664,6 +665,24 @@</span> &#47;&#47; GetBalance returns the amount of wei for the given address in the state of the
 &#47;&#47; given block number. The rpc.LatestBlockNumber and rpc.PendingBlockNumber meta
 &#47;&#47; block numbers are also allowed.
 func (api *BlockChainAPI) GetBalance(ctx context.Context, address common.Address, blockNrOrHash rpc.BlockNumberOrHash) (*hexutil.Big, error) {
<span class="term-fg32">+	header, err := headerByNumberOrHash(ctx, api.b, blockNrOrHash)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return nil, err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	if api.b.ChainConfig().IsOptimismPreBedrock(header.Number) {</span>
<span class="term-fg32">+		if api.b.HistoricalRPCService() != nil {</span>
<span class="term-fg32">+			var res hexutil.Big</span>
<span class="term-fg32">+			err := api.b.HistoricalRPCService().CallContext(ctx, &amp;res, &quot;eth_getBalance&quot;, address, blockNrOrHash)</span>
<span class="term-fg32">+			if err != nil {</span>
<span class="term-fg32">+				return nil, fmt.Errorf(&quot;historical backend error: %w&quot;, err)</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+			return &amp;res, nil</span>
<span class="term-fg32">+		} else {</span>
<span class="term-fg32">+			return nil, rpc.ErrNoHistoricalFallback</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
 	state, _, err := api.b.StateAndHeaderByNumberOrHash(ctx, blockNrOrHash)
 	if state == nil || err != nil {
 		return nil, err
<span class="term-fg36">@@ -704,6 +723,22 @@</span> }
&nbsp;
 &#47;&#47; GetProof returns the Merkle-proof for a given account and optionally some storage keys.
 func (api *BlockChainAPI) GetProof(ctx context.Context, address common.Address, storageKeys []string, blockNrOrHash rpc.BlockNumberOrHash) (*AccountResult, error) {
<span class="term-fg32">+	header, err := headerByNumberOrHash(ctx, api.b, blockNrOrHash)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return nil, err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if api.b.ChainConfig().IsOptimismPreBedrock(header.Number) {</span>
<span class="term-fg32">+		if api.b.HistoricalRPCService() != nil {</span>
<span class="term-fg32">+			var res AccountResult</span>
<span class="term-fg32">+			err := api.b.HistoricalRPCService().CallContext(ctx, &amp;res, &quot;eth_getProof&quot;, address, storageKeys, blockNrOrHash)</span>
<span class="term-fg32">+			if err != nil {</span>
<span class="term-fg32">+				return nil, fmt.Errorf(&quot;historical backend error: %w&quot;, err)</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+			return &amp;res, nil</span>
<span class="term-fg32">+		} else {</span>
<span class="term-fg32">+			return nil, rpc.ErrNoHistoricalFallback</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
 	var (
 		keys         = make([]common.Hash, len(storageKeys))
 		keyLengths   = make([]int, len(storageKeys))
<span class="term-fg36">@@ -807,7 +842,7 @@</span> func (api *BlockChainAPI) GetHeaderByNumber(ctx context.Context, number rpc.BlockNumber) (map[string]interface{}, error) {
 	header, err := api.b.HeaderByNumber(ctx, number)
 	if header != nil &amp;&amp; err == nil {
 		response := api.rpcMarshalHeader(ctx, header)
<span class="term-fg31">-		if number == rpc.PendingBlockNumber {</span>
<span class="term-fg32">+		if number == rpc.PendingBlockNumber &amp;&amp; api.b.ChainConfig().Optimism == nil { &#47;&#47; don&#39;t remove info if optimism</span>
 			&#47;&#47; Pending header need to nil out a few fields
 			for _, field := range []string{&quot;hash&quot;, &quot;nonce&quot;, &quot;miner&quot;} {
 				response[field] = nil
<span class="term-fg36">@@ -838,7 +873,7 @@</span> func (api *BlockChainAPI) GetBlockByNumber(ctx context.Context, number rpc.BlockNumber, fullTx bool) (map[string]interface{}, error) {
 	block, err := api.b.BlockByNumber(ctx, number)
 	if block != nil &amp;&amp; err == nil {
 		response, err := api.rpcMarshalBlock(ctx, block, true, fullTx)
<span class="term-fg31">-		if err == nil &amp;&amp; number == rpc.PendingBlockNumber {</span>
<span class="term-fg32">+		if err == nil &amp;&amp; number == rpc.PendingBlockNumber &amp;&amp; api.b.ChainConfig().Optimism == nil { &#47;&#47; don&#39;t remove info if optimism</span>
 			&#47;&#47; Pending blocks need to nil out a few fields
 			for _, field := range []string{&quot;hash&quot;, &quot;nonce&quot;, &quot;miner&quot;} {
 				response[field] = nil
<span class="term-fg36">@@ -909,10 +944,29 @@</span> }
&nbsp;
 &#47;&#47; GetCode returns the code stored at the given address in the state for the given block number.
 func (api *BlockChainAPI) GetCode(ctx context.Context, address common.Address, blockNrOrHash rpc.BlockNumberOrHash) (hexutil.Bytes, error) {
<span class="term-fg32">+	header, err := headerByNumberOrHash(ctx, api.b, blockNrOrHash)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return nil, err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	if api.b.ChainConfig().IsOptimismPreBedrock(header.Number) {</span>
<span class="term-fg32">+		if api.b.HistoricalRPCService() != nil {</span>
<span class="term-fg32">+			var res hexutil.Bytes</span>
<span class="term-fg32">+			err := api.b.HistoricalRPCService().CallContext(ctx, &amp;res, &quot;eth_getCode&quot;, address, blockNrOrHash)</span>
<span class="term-fg32">+			if err != nil {</span>
<span class="term-fg32">+				return nil, fmt.Errorf(&quot;historical backend error: %w&quot;, err)</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+			return res, nil</span>
<span class="term-fg32">+		} else {</span>
<span class="term-fg32">+			return nil, rpc.ErrNoHistoricalFallback</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
 	state, _, err := api.b.StateAndHeaderByNumberOrHash(ctx, blockNrOrHash)
 	if state == nil || err != nil {
 		return nil, err
 	}
<span class="term-fg32">+</span>
 	code := state.GetCode(address)
 	return code, state.Error()
 }
<span class="term-fg36">@@ -921,10 +975,29 @@</span> &#47;&#47; GetStorageAt returns the storage from the state at the given address, key and
 &#47;&#47; block number. The rpc.LatestBlockNumber and rpc.PendingBlockNumber meta block
 &#47;&#47; numbers are also allowed.
 func (api *BlockChainAPI) GetStorageAt(ctx context.Context, address common.Address, hexKey string, blockNrOrHash rpc.BlockNumberOrHash) (hexutil.Bytes, error) {
<span class="term-fg32">+	header, err := headerByNumberOrHash(ctx, api.b, blockNrOrHash)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return nil, err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	if api.b.ChainConfig().IsOptimismPreBedrock(header.Number) {</span>
<span class="term-fg32">+		if api.b.HistoricalRPCService() != nil {</span>
<span class="term-fg32">+			var res hexutil.Bytes</span>
<span class="term-fg32">+			err := api.b.HistoricalRPCService().CallContext(ctx, &amp;res, &quot;eth_getStorageAt&quot;, address, hexKey, blockNrOrHash)</span>
<span class="term-fg32">+			if err != nil {</span>
<span class="term-fg32">+				return nil, fmt.Errorf(&quot;historical backend error: %w&quot;, err)</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+			return res, nil</span>
<span class="term-fg32">+		} else {</span>
<span class="term-fg32">+			return nil, rpc.ErrNoHistoricalFallback</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
 	state, _, err := api.b.StateAndHeaderByNumberOrHash(ctx, blockNrOrHash)
 	if state == nil || err != nil {
 		return nil, err
 	}
<span class="term-fg32">+</span>
 	key, _, err := decodeHash(hexKey)
 	if err != nil {
 		return nil, fmt.Errorf(&quot;unable to decode storage key: %s&quot;, err)
<span class="term-fg36">@@ -933,6 +1006,18 @@</span> 	res := state.GetState(address, key)
 	return res[:], state.Error()
 }
&nbsp;
<span class="term-fg32">+&#47;&#47; The HeaderByNumberOrHash method returns a nil error and nil header</span>
<span class="term-fg32">+&#47;&#47; if the header is not found, but only for nonexistent block numbers. This is</span>
<span class="term-fg32">+&#47;&#47; different from StateAndHeaderByNumberOrHash. To account for this discrepancy,</span>
<span class="term-fg32">+&#47;&#47; headerOrNumberByHash will properly convert the error into an ethereum.NotFound.</span>
<span class="term-fg32">+func headerByNumberOrHash(ctx context.Context, b Backend, blockNrOrHash rpc.BlockNumberOrHash) (*types.Header, error) {</span>
<span class="term-fg32">+	header, err := b.HeaderByNumberOrHash(ctx, blockNrOrHash)</span>
<span class="term-fg32">+	if header == nil {</span>
<span class="term-fg32">+		return nil, fmt.Errorf(&quot;header %w&quot;, ethereum.NotFound)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	return header, err</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
 &#47;&#47; GetBlockReceipts returns the block receipts for the given block hash or number or tag.
 func (api *BlockChainAPI) GetBlockReceipts(ctx context.Context, blockNrOrHash rpc.BlockNumberOrHash) ([]map[string]interface{}, error) {
 	block, err := api.b.BlockByNumberOrHash(ctx, blockNrOrHash)
<span class="term-fg36">@@ -955,7 +1040,7 @@</span> 	signer := types.MakeSigner(api.b.ChainConfig(), block.Number(), block.Time())
&nbsp;
 	result := make([]map[string]interface{}, len(receipts))
 	for i, receipt := range receipts {
<span class="term-fg31">-		result[i] = marshalReceipt(receipt, block.Hash(), block.NumberU64(), signer, txs[i], i)</span>
<span class="term-fg32">+		result[i] = marshalReceipt(receipt, block.Hash(), block.NumberU64(), signer, txs[i], i, api.b.ChainConfig())</span>
 	}
&nbsp;
 	return result, nil
<span class="term-fg36">@@ -1110,7 +1195,7 @@</span> 	&#47;&#47; this makes sure resources are cleaned up.
 	defer cancel()
&nbsp;
 	&#47;&#47; Get a new instance of the EVM.
<span class="term-fg31">-	blockCtx := core.NewEVMBlockContext(header, NewChainContext(ctx, b), nil)</span>
<span class="term-fg32">+	blockCtx := core.NewEVMBlockContext(header, NewChainContext(ctx, b), nil, b.ChainConfig(), state)</span>
 	if blockOverrides != nil {
 		blockOverrides.Apply(&amp;blockCtx)
 	}
<span class="term-fg36">@@ -1166,6 +1251,25 @@</span> 	if blockNrOrHash == nil {
 		latest := rpc.BlockNumberOrHashWithNumber(rpc.LatestBlockNumber)
 		blockNrOrHash = &amp;latest
 	}
<span class="term-fg32">+</span>
<span class="term-fg32">+	header, err := headerByNumberOrHash(ctx, api.b, *blockNrOrHash)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return nil, err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	if api.b.ChainConfig().IsOptimismPreBedrock(header.Number) {</span>
<span class="term-fg32">+		if api.b.HistoricalRPCService() != nil {</span>
<span class="term-fg32">+			var res hexutil.Bytes</span>
<span class="term-fg32">+			err := api.b.HistoricalRPCService().CallContext(ctx, &amp;res, &quot;eth_call&quot;, args, blockNrOrHash, overrides)</span>
<span class="term-fg32">+			if err != nil {</span>
<span class="term-fg32">+				return nil, fmt.Errorf(&quot;historical backend error: %w&quot;, err)</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+			return res, nil</span>
<span class="term-fg32">+		} else {</span>
<span class="term-fg32">+			return nil, rpc.ErrNoHistoricalFallback</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
 	result, err := DoCall(ctx, api.b, args, *blockNrOrHash, overrides, blockOverrides, api.b.RPCEVMTimeout(), api.b.RPCGasCap())
 	if err != nil {
 		return nil, err
<span class="term-fg36">@@ -1230,6 +1334,25 @@</span> 	bNrOrHash := rpc.BlockNumberOrHashWithNumber(rpc.LatestBlockNumber)
 	if blockNrOrHash != nil {
 		bNrOrHash = *blockNrOrHash
 	}
<span class="term-fg32">+</span>
<span class="term-fg32">+	header, err := headerByNumberOrHash(ctx, api.b, bNrOrHash)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return 0, err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	if api.b.ChainConfig().IsOptimismPreBedrock(header.Number) {</span>
<span class="term-fg32">+		if api.b.HistoricalRPCService() != nil {</span>
<span class="term-fg32">+			var res hexutil.Uint64</span>
<span class="term-fg32">+			err := api.b.HistoricalRPCService().CallContext(ctx, &amp;res, &quot;eth_estimateGas&quot;, args, blockNrOrHash)</span>
<span class="term-fg32">+			if err != nil {</span>
<span class="term-fg32">+				return 0, fmt.Errorf(&quot;historical backend error: %w&quot;, err)</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+			return res, nil</span>
<span class="term-fg32">+		} else {</span>
<span class="term-fg32">+			return 0, rpc.ErrNoHistoricalFallback</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
 	return DoEstimateGas(ctx, api.b, args, bNrOrHash, overrides, api.b.RPCGasCap())
 }
&nbsp;
<span class="term-fg36">@@ -1274,7 +1397,7 @@</span>
 &#47;&#47; RPCMarshalBlock converts the given block to the RPC output which depends on fullTx. If inclTx is true transactions are
 &#47;&#47; returned. When fullTx is true the returned block contains full transaction details, otherwise it will only contain
 &#47;&#47; transaction hashes.
<span class="term-fg31">-func RPCMarshalBlock(block *types.Block, inclTx bool, fullTx bool, config *params.ChainConfig) map[string]interface{} {</span>
<span class="term-fg32">+func RPCMarshalBlock(ctx context.Context, block *types.Block, inclTx bool, fullTx bool, config *params.ChainConfig, backend Backend) (map[string]interface{}, error) {</span>
 	fields := RPCMarshalHeader(block.Header())
 	fields[&quot;size&quot;] = hexutil.Uint64(block.Size())
&nbsp;
<span class="term-fg36">@@ -1284,7 +1407,7 @@</span> 			return tx.Hash()
 		}
 		if fullTx {
 			formatTx = func(idx int, tx *types.Transaction) interface{} {
<span class="term-fg31">-				return newRPCTransactionFromBlockIndex(block, uint64(idx), config)</span>
<span class="term-fg32">+				return newRPCTransactionFromBlockIndex(ctx, block, uint64(idx), config, backend)</span>
 			}
 		}
 		txs := block.Transactions()
<span class="term-fg36">@@ -1303,7 +1426,7 @@</span> 	fields[&quot;uncles&quot;] = uncleHashes
 	if block.Header().WithdrawalsHash != nil {
 		fields[&quot;withdrawals&quot;] = block.Withdrawals()
 	}
<span class="term-fg31">-	return fields</span>
<span class="term-fg32">+	return fields, nil</span>
 }
&nbsp;
 &#47;&#47; rpcMarshalHeader uses the generalized output filler, then adds the total difficulty field, which requires
<span class="term-fg36">@@ -1317,7 +1440,10 @@</span>
 &#47;&#47; rpcMarshalBlock uses the generalized output filler, then adds the total difficulty field, which requires
 &#47;&#47; a `BlockchainAPI`.
 func (api *BlockChainAPI) rpcMarshalBlock(ctx context.Context, b *types.Block, inclTx bool, fullTx bool) (map[string]interface{}, error) {
<span class="term-fg31">-	fields := RPCMarshalBlock(b, inclTx, fullTx, api.b.ChainConfig())</span>
<span class="term-fg32">+	fields, err := RPCMarshalBlock(ctx, b, inclTx, fullTx, api.b.ChainConfig(), api.b)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return nil, err</span>
<span class="term-fg32">+	}</span>
 	if inclTx {
 		fields[&quot;totalDifficulty&quot;] = (*hexutil.Big)(api.b.GetTd(ctx, b.Hash()))
 	}
<span class="term-fg36">@@ -1348,11 +1474,18 @@</span> 	V                   *hexutil.Big      `json:&quot;v&quot;`
 	R                   *hexutil.Big      `json:&quot;r&quot;`
 	S                   *hexutil.Big      `json:&quot;s&quot;`
 	YParity             *hexutil.Uint64   `json:&quot;yParity,omitempty&quot;`
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; deposit-tx only</span>
<span class="term-fg32">+	SourceHash *common.Hash `json:&quot;sourceHash,omitempty&quot;`</span>
<span class="term-fg32">+	Mint       *hexutil.Big `json:&quot;mint,omitempty&quot;`</span>
<span class="term-fg32">+	IsSystemTx *bool        `json:&quot;isSystemTx,omitempty&quot;`</span>
<span class="term-fg32">+	&#47;&#47; deposit-tx post-Canyon only</span>
<span class="term-fg32">+	DepositReceiptVersion *hexutil.Uint64 `json:&quot;depositReceiptVersion,omitempty&quot;`</span>
 }
&nbsp;
 &#47;&#47; newRPCTransaction returns a transaction that will serialize to the RPC
 &#47;&#47; representation, with the given location metadata set (if available).
<span class="term-fg31">-func newRPCTransaction(tx *types.Transaction, blockHash common.Hash, blockNumber uint64, blockTime uint64, index uint64, baseFee *big.Int, config *params.ChainConfig) *RPCTransaction {</span>
<span class="term-fg32">+func newRPCTransaction(tx *types.Transaction, blockHash common.Hash, blockNumber uint64, blockTime uint64, index uint64, baseFee *big.Int, config *params.ChainConfig, receipt *types.Receipt) *RPCTransaction {</span>
 	signer := types.MakeSigner(config, new(big.Int).SetUint64(blockNumber), blockTime)
 	from, _ := types.Sender(signer, tx)
 	v, r, s := tx.RawSignatureValues()
<span class="term-fg36">@@ -1377,7 +1510,27 @@</span> 		result.TransactionIndex = (*hexutil.Uint64)(&amp;index)
 	}
&nbsp;
 	switch tx.Type() {
<span class="term-fg32">+	case types.DepositTxType:</span>
<span class="term-fg32">+		srcHash := tx.SourceHash()</span>
<span class="term-fg32">+		isSystemTx := tx.IsSystemTx()</span>
<span class="term-fg32">+		result.SourceHash = &amp;srcHash</span>
<span class="term-fg32">+		if isSystemTx {</span>
<span class="term-fg32">+			&#47;&#47; Only include IsSystemTx when true</span>
<span class="term-fg32">+			result.IsSystemTx = &amp;isSystemTx</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		result.Mint = (*hexutil.Big)(tx.Mint())</span>
<span class="term-fg32">+		if receipt != nil &amp;&amp; receipt.DepositNonce != nil {</span>
<span class="term-fg32">+			result.Nonce = hexutil.Uint64(*receipt.DepositNonce)</span>
<span class="term-fg32">+			if receipt.DepositReceiptVersion != nil {</span>
<span class="term-fg32">+				result.DepositReceiptVersion = new(hexutil.Uint64)</span>
<span class="term-fg32">+				*result.DepositReceiptVersion = hexutil.Uint64(*receipt.DepositReceiptVersion)</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+		}</span>
 	case types.LegacyTxType:
<span class="term-fg32">+		if v.Sign() == 0 &amp;&amp; r.Sign() == 0 &amp;&amp; s.Sign() == 0 { &#47;&#47; pre-bedrock relayed tx does not have a signature</span>
<span class="term-fg32">+			result.ChainID = (*hexutil.Big)(new(big.Int).Set(config.ChainID))</span>
<span class="term-fg32">+			break</span>
<span class="term-fg32">+		}</span>
 		&#47;&#47; if a legacy transaction has an EIP-155 chain id, include it explicitly
 		if id := tx.ChainId(); id.Sign() != 0 {
 			result.ChainID = (*hexutil.Big)(id)
<span class="term-fg36">@@ -1446,20 +1599,36 @@</span> 		blockNumber = uint64(0)
 		blockTime   = uint64(0)
 	)
 	if current != nil {
<span class="term-fg31">-		baseFee = eip1559.CalcBaseFee(config, current)</span>
<span class="term-fg32">+		baseFee = eip1559.CalcBaseFee(config, current, current.Time+1)</span>
 		blockNumber = current.Number.Uint64()
 		blockTime = current.Time
 	}
<span class="term-fg31">-	return newRPCTransaction(tx, common.Hash{}, blockNumber, blockTime, 0, baseFee, config)</span>
<span class="term-fg32">+	return newRPCTransaction(tx, common.Hash{}, blockNumber, blockTime, 0, baseFee, config, nil)</span>
 }
&nbsp;
 &#47;&#47; newRPCTransactionFromBlockIndex returns a transaction that will serialize to the RPC representation.
<span class="term-fg31">-func newRPCTransactionFromBlockIndex(b *types.Block, index uint64, config *params.ChainConfig) *RPCTransaction {</span>
<span class="term-fg32">+func newRPCTransactionFromBlockIndex(ctx context.Context, b *types.Block, index uint64, config *params.ChainConfig, backend Backend) *RPCTransaction {</span>
 	txs := b.Transactions()
 	if index &gt;= uint64(len(txs)) {
 		return nil
 	}
<span class="term-fg31">-	return newRPCTransaction(txs[index], b.Hash(), b.NumberU64(), b.Time(), index, b.BaseFee(), config)</span>
<span class="term-fg32">+	tx := txs[index]</span>
<span class="term-fg32">+	rcpt := depositTxReceipt(ctx, b.Hash(), index, backend, tx)</span>
<span class="term-fg32">+	return newRPCTransaction(tx, b.Hash(), b.NumberU64(), b.Time(), index, b.BaseFee(), config, rcpt)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func depositTxReceipt(ctx context.Context, blockHash common.Hash, index uint64, backend Backend, tx *types.Transaction) *types.Receipt {</span>
<span class="term-fg32">+	if tx.Type() != types.DepositTxType {</span>
<span class="term-fg32">+		return nil</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	receipts, err := backend.GetReceipts(ctx, blockHash)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return nil</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if index &gt;= uint64(len(receipts)) {</span>
<span class="term-fg32">+		return nil</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	return receipts[index]</span>
 }
&nbsp;
 &#47;&#47; newRPCRawTransactionFromBlockIndex returns the bytes of a transaction given a block and a transaction index.
<span class="term-fg36">@@ -1488,6 +1657,21 @@</span> 	bNrOrHash := rpc.BlockNumberOrHashWithNumber(rpc.LatestBlockNumber)
 	if blockNrOrHash != nil {
 		bNrOrHash = *blockNrOrHash
 	}
<span class="term-fg32">+</span>
<span class="term-fg32">+	header, err := headerByNumberOrHash(ctx, api.b, bNrOrHash)</span>
<span class="term-fg32">+	if err == nil &amp;&amp; header != nil &amp;&amp; api.b.ChainConfig().IsOptimismPreBedrock(header.Number) {</span>
<span class="term-fg32">+		if api.b.HistoricalRPCService() != nil {</span>
<span class="term-fg32">+			var res accessListResult</span>
<span class="term-fg32">+			err := api.b.HistoricalRPCService().CallContext(ctx, &amp;res, &quot;eth_createAccessList&quot;, args, blockNrOrHash)</span>
<span class="term-fg32">+			if err != nil {</span>
<span class="term-fg32">+				return nil, fmt.Errorf(&quot;historical backend error: %w&quot;, err)</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+			return &amp;res, nil</span>
<span class="term-fg32">+		} else {</span>
<span class="term-fg32">+			return nil, rpc.ErrNoHistoricalFallback</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
 	acl, gasUsed, vmerr, err := AccessList(ctx, api.b, bNrOrHash, args)
 	if err != nil {
 		return nil, err
<span class="term-fg36">@@ -1593,7 +1777,7 @@</span>
 &#47;&#47; GetTransactionByBlockNumberAndIndex returns the transaction for the given block number and index.
 func (api *TransactionAPI) GetTransactionByBlockNumberAndIndex(ctx context.Context, blockNr rpc.BlockNumber, index hexutil.Uint) *RPCTransaction {
 	if block, _ := api.b.BlockByNumber(ctx, blockNr); block != nil {
<span class="term-fg31">-		return newRPCTransactionFromBlockIndex(block, uint64(index), api.b.ChainConfig())</span>
<span class="term-fg32">+		return newRPCTransactionFromBlockIndex(ctx, block, uint64(index), api.b.ChainConfig(), api.b)</span>
 	}
 	return nil
 }
<span class="term-fg36">@@ -1601,7 +1785,7 @@</span>
 &#47;&#47; GetTransactionByBlockHashAndIndex returns the transaction for the given block hash and index.
 func (api *TransactionAPI) GetTransactionByBlockHashAndIndex(ctx context.Context, blockHash common.Hash, index hexutil.Uint) *RPCTransaction {
 	if block, _ := api.b.BlockByHash(ctx, blockHash); block != nil {
<span class="term-fg31">-		return newRPCTransactionFromBlockIndex(block, uint64(index), api.b.ChainConfig())</span>
<span class="term-fg32">+		return newRPCTransactionFromBlockIndex(ctx, block, uint64(index), api.b.ChainConfig(), api.b)</span>
 	}
 	return nil
 }
<span class="term-fg36">@@ -1633,10 +1817,29 @@</span> 		}
 		return (*hexutil.Uint64)(&amp;nonce), nil
 	}
 	&#47;&#47; Resolve block number and use its state to ask for the nonce
<span class="term-fg32">+	header, err := headerByNumberOrHash(ctx, api.b, blockNrOrHash)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return nil, err</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	if api.b.ChainConfig().IsOptimismPreBedrock(header.Number) {</span>
<span class="term-fg32">+		if api.b.HistoricalRPCService() != nil {</span>
<span class="term-fg32">+			var res hexutil.Uint64</span>
<span class="term-fg32">+			err := api.b.HistoricalRPCService().CallContext(ctx, &amp;res, &quot;eth_getTransactionCount&quot;, address, blockNrOrHash)</span>
<span class="term-fg32">+			if err != nil {</span>
<span class="term-fg32">+				return nil, fmt.Errorf(&quot;historical backend error: %w&quot;, err)</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+			return &amp;res, nil</span>
<span class="term-fg32">+		} else {</span>
<span class="term-fg32">+			return nil, rpc.ErrNoHistoricalFallback</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
 	state, _, err := api.b.StateAndHeaderByNumberOrHash(ctx, blockNrOrHash)
 	if state == nil || err != nil {
 		return nil, err
 	}
<span class="term-fg32">+</span>
 	nonce := state.GetNonce(address)
 	return (*hexutil.Uint64)(&amp;nonce), state.Error()
 }
<span class="term-fg36">@@ -1659,7 +1862,8 @@</span> 	header, err := api.b.HeaderByHash(ctx, blockHash)
 	if err != nil {
 		return nil, err
 	}
<span class="term-fg31">-	return newRPCTransaction(tx, blockHash, blockNumber, header.Time, index, header.BaseFee, api.b.ChainConfig()), nil</span>
<span class="term-fg32">+	rcpt := depositTxReceipt(ctx, blockHash, index, api.b, tx)</span>
<span class="term-fg32">+	return newRPCTransaction(tx, blockHash, blockNumber, header.Time, index, header.BaseFee, api.b.ChainConfig(), rcpt), nil</span>
 }
&nbsp;
 &#47;&#47; GetRawTransactionByHash returns the bytes of the transaction for the given hash.
<span class="term-fg36">@@ -1702,11 +1906,11 @@</span> 	receipt := receipts[index]
&nbsp;
 	&#47;&#47; Derive the sender.
 	signer := types.MakeSigner(api.b.ChainConfig(), header.Number, header.Time)
<span class="term-fg31">-	return marshalReceipt(receipt, blockHash, blockNumber, signer, tx, int(index)), nil</span>
<span class="term-fg32">+	return marshalReceipt(receipt, blockHash, blockNumber, signer, tx, int(index), api.b.ChainConfig()), nil</span>
 }
&nbsp;
 &#47;&#47; marshalReceipt marshals a transaction receipt into a JSON object.
<span class="term-fg31">-func marshalReceipt(receipt *types.Receipt, blockHash common.Hash, blockNumber uint64, signer types.Signer, tx *types.Transaction, txIndex int) map[string]interface{} {</span>
<span class="term-fg32">+func marshalReceipt(receipt *types.Receipt, blockHash common.Hash, blockNumber uint64, signer types.Signer, tx *types.Transaction, txIndex int, chainConfig *params.ChainConfig) map[string]interface{} {</span>
 	from, _ := types.Sender(signer, tx)
&nbsp;
 	fields := map[string]interface{}{
<span class="term-fg36">@@ -1723,6 +1927,32 @@</span> 		&quot;logs&quot;:              receipt.Logs,
 		&quot;logsBloom&quot;:         receipt.Bloom,
 		&quot;type&quot;:              hexutil.Uint(tx.Type()),
 		&quot;effectiveGasPrice&quot;: (*hexutil.Big)(receipt.EffectiveGasPrice),
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	if chainConfig.Optimism != nil &amp;&amp; !tx.IsDepositTx() {</span>
<span class="term-fg32">+		fields[&quot;l1GasPrice&quot;] = (*hexutil.Big)(receipt.L1GasPrice)</span>
<span class="term-fg32">+		fields[&quot;l1GasUsed&quot;] = (*hexutil.Big)(receipt.L1GasUsed)</span>
<span class="term-fg32">+		fields[&quot;l1Fee&quot;] = (*hexutil.Big)(receipt.L1Fee)</span>
<span class="term-fg32">+		&#47;&#47; Fields removed with Ecotone</span>
<span class="term-fg32">+		if receipt.FeeScalar != nil {</span>
<span class="term-fg32">+			fields[&quot;l1FeeScalar&quot;] = receipt.FeeScalar.String()</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		&#47;&#47; Fields added in Ecotone</span>
<span class="term-fg32">+		if receipt.L1BlobBaseFee != nil {</span>
<span class="term-fg32">+			fields[&quot;l1BlobBaseFee&quot;] = (*hexutil.Big)(receipt.L1BlobBaseFee)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		if receipt.L1BaseFeeScalar != nil {</span>
<span class="term-fg32">+			fields[&quot;l1BaseFeeScalar&quot;] = hexutil.Uint64(*receipt.L1BaseFeeScalar)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		if receipt.L1BlobBaseFeeScalar != nil {</span>
<span class="term-fg32">+			fields[&quot;l1BlobBaseFeeScalar&quot;] = hexutil.Uint64(*receipt.L1BlobBaseFeeScalar)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if chainConfig.Optimism != nil &amp;&amp; tx.IsDepositTx() &amp;&amp; receipt.DepositNonce != nil {</span>
<span class="term-fg32">+		fields[&quot;depositNonce&quot;] = hexutil.Uint64(*receipt.DepositNonce)</span>
<span class="term-fg32">+		if receipt.DepositReceiptVersion != nil {</span>
<span class="term-fg32">+			fields[&quot;depositReceiptVersion&quot;] = hexutil.Uint64(*receipt.DepositReceiptVersion)</span>
<span class="term-fg32">+		}</span>
 	}
&nbsp;
 	&#47;&#47; Assign receipt status or post state.
<span class="term-fg36">@@ -1897,6 +2127,9 @@</span> 		return nil, errors.New(&quot;gas not specified&quot;)
 	}
 	if args.GasPrice == nil &amp;&amp; (args.MaxPriorityFeePerGas == nil || args.MaxFeePerGas == nil) {
 		return nil, errors.New(&quot;missing gasPrice or maxFeePerGas&#47;maxPriorityFeePerGas&quot;)
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if args.IsEIP4844() {</span>
<span class="term-fg32">+		return nil, errBlobTxNotSupported</span>
 	}
 	if args.Nonce == nil {
 		return nil, errors.New(&quot;nonce not specified&quot;)
<span class="term-fg36">@@ -2136,6 +2369,10 @@</span>
 &#47;&#47; SetHead rewinds the head of the blockchain to a previous block.
 func (api *DebugAPI) SetHead(number hexutil.Uint64) {
 	api.b.SetHead(uint64(number))
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (api *DebugAPI) ChainConfig() *params.ChainConfig {</span>
<span class="term-fg32">+	return api.b.ChainConfig()</span>
 }
&nbsp;
 &#47;&#47; NetAPI offers network related RPC methods</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-719a28c5e66b1540fea4a8d2" role="button"
                       aria-expanded="false" aria-controls="id-719a28c5e66b1540fea4a8d2">
                        <code>rpc/errors.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/rpc/errors.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/rpc/errors.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+10</span></div>
                            <div class="text-start"><span class="text-danger">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-719a28c5e66b1540fea4a8d2"><span class="term-fg1">diff --git go-ethereum&#47;rpc&#47;errors.go op-geth&#47;rpc&#47;errors.go</span>
<span class="term-fg1">index 438aff218c2e306d322160d8be8dcac16dd0dfa2..67c523d11a36294e4448988dc4c906f38541ec04 100644</span>
<span class="term-fg1">--- go-ethereum&#47;rpc&#47;errors.go</span>
<span class="term-fg1">+++ op-geth&#47;rpc&#47;errors.go</span>
<span class="term-fg36">@@ -73,6 +73,16 @@</span> 	errMsgResponseTooLarge = &quot;response too large&quot;
 	errMsgBatchTooLarge    = &quot;batch too large&quot;
 )
&nbsp;
<span class="term-fg32">+var ErrNoHistoricalFallback = NoHistoricalFallbackError{}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+type NoHistoricalFallbackError struct{}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (e NoHistoricalFallbackError) ErrorCode() int { return -32801 }</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (e NoHistoricalFallbackError) Error() string {</span>
<span class="term-fg32">+	return &quot;no historical RPC is available for this historical (pre-bedrock) execution request&quot;</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
 type methodNotFoundError struct{ method string }
&nbsp;
 func (e *methodNotFoundError) ErrorCode() int { return -32601 }</div>
    </div>

            
            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-300e6f8a2545b8afef1316c2"role="button" aria-expanded="false" aria-controls="id-300e6f8a2545b8afef1316c2">
        
            <div class="col-12 col-md-12 col-lg-6 col-xl-6 text-start"><h3>Tracer RPC daisy-chain</h3></div>
        

        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2">
            <div class="row line-stat">
                
                
            </div>
        </div>
        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2 ">
            <div class="row line-stat">
                
                    <div class="text-end"><span class="text-success">+58</span></div>
                    <div class="text-start"><span class="text-danger">-14</span></div>
                
                
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-300e6f8a2545b8afef1316c2">
        <div><p>Forward pre-bedrock tracing calls to legacy node.</p>
</div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-233ee1f3cc72438d74abbc5f" role="button"
                       aria-expanded="false" aria-controls="id-233ee1f3cc72438d74abbc5f">
                        <code>eth/tracers/api.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/eth/tracers/api.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/eth/tracers/api.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+58</span></div>
                            <div class="text-start"><span class="text-danger">-14</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-233ee1f3cc72438d74abbc5f"><span class="term-fg1">diff --git go-ethereum&#47;eth&#47;tracers&#47;api.go op-geth&#47;eth&#47;tracers&#47;api.go</span>
<span class="term-fg1">index 51b55ffdbb1b1de83e82eff1d53c8df2afa917f0..713e28344b7e57402f4f49c8e94f83dc7e643db4 100644</span>
<span class="term-fg1">--- go-ethereum&#47;eth&#47;tracers&#47;api.go</span>
<span class="term-fg1">+++ op-geth&#47;eth&#47;tracers&#47;api.go</span>
<span class="term-fg36">@@ -22,6 +22,7 @@</span> 	&quot;context&quot;
 	&quot;encoding&#47;json&quot;
 	&quot;errors&quot;
 	&quot;fmt&quot;
<span class="term-fg32">+	&quot;math&#47;big&quot;</span>
 	&quot;os&quot;
 	&quot;runtime&quot;
 	&quot;sync&quot;
<span class="term-fg36">@@ -67,8 +68,6 @@</span> 	&#47;&#47; trace states exceed this limit.
 	maximumPendingTraceStates = 128
 )
&nbsp;
<span class="term-fg31">-var errTxNotFound = errors.New(&quot;transaction not found&quot;)</span>
<span class="term-fg31">-</span>
 &#47;&#47; StateReleaseFunc is used to deallocate resources held by constructing a
 &#47;&#47; historical state for tracing purposes.
 type StateReleaseFunc func()
<span class="term-fg36">@@ -87,6 +86,7 @@</span> 	Engine() consensus.Engine
 	ChainDb() ethdb.Database
 	StateAtBlock(ctx context.Context, block *types.Block, reexec uint64, base *state.StateDB, readOnly bool, preferDisk bool) (*state.StateDB, StateReleaseFunc, error)
 	StateAtTransaction(ctx context.Context, block *types.Block, txIndex int, reexec uint64) (*types.Transaction, vm.BlockContext, *state.StateDB, StateReleaseFunc, error)
<span class="term-fg32">+	HistoricalRPCService() *rpc.Client</span>
 }
&nbsp;
 &#47;&#47; API is the collection of tracing APIs exposed over the private debugging endpoint.
<span class="term-fg36">@@ -208,6 +208,7 @@</span>
 &#47;&#47; TraceChain returns the structured logs created during the execution of EVM
 &#47;&#47; between two blocks (excluding start) and returns them as a JSON object.
 func (api *API) TraceChain(ctx context.Context, start, end rpc.BlockNumber, config *TraceConfig) (*rpc.Subscription, error) { &#47;&#47; Fetch the block interval that we want to trace
<span class="term-fg32">+	&#47;&#47; TODO: Need to implement a fallback for this</span>
 	from, err := api.blockByNumber(ctx, start)
 	if err != nil {
 		return nil, err
<span class="term-fg36">@@ -266,7 +267,7 @@</span> 			&#47;&#47; Fetch and execute the block trace taskCh
 			for task := range taskCh {
 				var (
 					signer   = types.MakeSigner(api.backend.ChainConfig(), task.block.Number(), task.block.Time())
<span class="term-fg31">-					blockCtx = core.NewEVMBlockContext(task.block.Header(), api.chainContext(ctx), nil)</span>
<span class="term-fg32">+					blockCtx = core.NewEVMBlockContext(task.block.Header(), api.chainContext(ctx), nil, api.backend.ChainConfig(), task.statedb)</span>
 				)
 				&#47;&#47; Trace all the transactions contained within
 				for i, tx := range task.block.Transactions() {
<span class="term-fg36">@@ -378,7 +379,7 @@</span> 			}
 			&#47;&#47; Insert block&#39;s parent beacon block root in the state
 			&#47;&#47; as per EIP-4788.
 			if beaconRoot := next.BeaconRoot(); beaconRoot != nil {
<span class="term-fg31">-				context := core.NewEVMBlockContext(next.Header(), api.chainContext(ctx), nil)</span>
<span class="term-fg32">+				context := core.NewEVMBlockContext(next.Header(), api.chainContext(ctx), nil, api.backend.ChainConfig(), statedb)</span>
 				vmenv := vm.NewEVM(context, vm.TxContext{}, statedb, api.backend.ChainConfig(), vm.Config{})
 				core.ProcessBeaconBlockRoot(*beaconRoot, vmenv, statedb)
 			}
<span class="term-fg36">@@ -441,6 +442,20 @@</span> 	block, err := api.blockByNumber(ctx, number)
 	if err != nil {
 		return nil, err
 	}
<span class="term-fg32">+</span>
<span class="term-fg32">+	if api.backend.ChainConfig().IsOptimismPreBedrock(block.Number()) {</span>
<span class="term-fg32">+		if api.backend.HistoricalRPCService() != nil {</span>
<span class="term-fg32">+			var histResult []*txTraceResult</span>
<span class="term-fg32">+			err = api.backend.HistoricalRPCService().CallContext(ctx, &amp;histResult, &quot;debug_traceBlockByNumber&quot;, number, config)</span>
<span class="term-fg32">+			if err != nil {</span>
<span class="term-fg32">+				return nil, fmt.Errorf(&quot;historical backend error: %w&quot;, err)</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+			return histResult, nil</span>
<span class="term-fg32">+		} else {</span>
<span class="term-fg32">+			return nil, rpc.ErrNoHistoricalFallback</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
 	return api.traceBlock(ctx, block, config)
 }
&nbsp;
<span class="term-fg36">@@ -451,6 +466,20 @@</span> 	block, err := api.blockByHash(ctx, hash)
 	if err != nil {
 		return nil, err
 	}
<span class="term-fg32">+</span>
<span class="term-fg32">+	if api.backend.ChainConfig().IsOptimismPreBedrock(block.Number()) {</span>
<span class="term-fg32">+		if api.backend.HistoricalRPCService() != nil {</span>
<span class="term-fg32">+			var histResult []*txTraceResult</span>
<span class="term-fg32">+			err = api.backend.HistoricalRPCService().CallContext(ctx, &amp;histResult, &quot;debug_traceBlockByHash&quot;, hash, config)</span>
<span class="term-fg32">+			if err != nil {</span>
<span class="term-fg32">+				return nil, fmt.Errorf(&quot;historical backend error: %w&quot;, err)</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+			return histResult, nil</span>
<span class="term-fg32">+		} else {</span>
<span class="term-fg32">+			return nil, rpc.ErrNoHistoricalFallback</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
 	return api.traceBlock(ctx, block, config)
 }
&nbsp;
<span class="term-fg36">@@ -500,6 +529,7 @@</span> &#47;&#47; IntermediateRoots executes a block (bad- or canon- or side-), and returns a list
 &#47;&#47; of intermediate roots: the stateroot after each transaction.
 func (api *API) IntermediateRoots(ctx context.Context, hash common.Hash, config *TraceConfig) ([]common.Hash, error) {
 	block, _ := api.blockByHash(ctx, hash)
<span class="term-fg32">+	&#47;&#47; TODO: Cannot get intermediate roots for pre-bedrock block without daisy chain</span>
 	if block == nil {
 		&#47;&#47; Check in the bad blocks
 		block = rawdb.ReadBadBlock(api.backend.ChainDb(), hash)
<span class="term-fg36">@@ -527,7 +557,7 @@</span> 	var (
 		roots              []common.Hash
 		signer             = types.MakeSigner(api.backend.ChainConfig(), block.Number(), block.Time())
 		chainConfig        = api.backend.ChainConfig()
<span class="term-fg31">-		vmctx              = core.NewEVMBlockContext(block.Header(), api.chainContext(ctx), nil)</span>
<span class="term-fg32">+		vmctx              = core.NewEVMBlockContext(block.Header(), api.chainContext(ctx), nil, chainConfig, statedb)</span>
 		deleteEmptyObjects = chainConfig.IsEIP158(block.Number())
 	)
 	if beaconRoot := block.BeaconRoot(); beaconRoot != nil {
<span class="term-fg36">@@ -605,7 +635,7 @@</span> 	&#47;&#47; Native tracers have low overhead
 	var (
 		txs       = block.Transactions()
 		blockHash = block.Hash()
<span class="term-fg31">-		blockCtx  = core.NewEVMBlockContext(block.Header(), api.chainContext(ctx), nil)</span>
<span class="term-fg32">+		blockCtx  = core.NewEVMBlockContext(block.Header(), api.chainContext(ctx), nil, api.backend.ChainConfig(), statedb)</span>
 		signer    = types.MakeSigner(api.backend.ChainConfig(), block.Number(), block.Time())
 		results   = make([]*txTraceResult, len(txs))
 	)
<span class="term-fg36">@@ -665,7 +695,7 @@</span> 				&#47;&#47; Reconstruct the block context for each transaction
 				&#47;&#47; as the GetHash function of BlockContext is not safe for
 				&#47;&#47; concurrent use.
 				&#47;&#47; See: https:&#47;&#47;github.com&#47;ethereum&#47;go-ethereum&#47;issues&#47;29114
<span class="term-fg31">-				blockCtx := core.NewEVMBlockContext(block.Header(), api.chainContext(ctx), nil)</span>
<span class="term-fg32">+				blockCtx := core.NewEVMBlockContext(block.Header(), api.chainContext(ctx), nil, api.backend.ChainConfig(), task.statedb)</span>
 				res, err := api.traceTx(ctx, txs[task.index], msg, txctx, blockCtx, task.statedb, config)
 				if err != nil {
 					results[task.index] = &amp;txTraceResult{TxHash: txs[task.index].Hash(), Error: err.Error()}
<span class="term-fg36">@@ -678,7 +708,7 @@</span> 	}
&nbsp;
 	&#47;&#47; Feed the transactions into the tracers and return
 	var failed error
<span class="term-fg31">-	blockCtx := core.NewEVMBlockContext(block.Header(), api.chainContext(ctx), nil)</span>
<span class="term-fg32">+	blockCtx := core.NewEVMBlockContext(block.Header(), api.chainContext(ctx), nil, api.backend.ChainConfig(), statedb)</span>
 txloop:
 	for i, tx := range txs {
 		&#47;&#47; Send the trace task over for execution
<span class="term-fg36">@@ -755,7 +785,7 @@</span> 	var (
 		dumps       []string
 		signer      = types.MakeSigner(api.backend.ChainConfig(), block.Number(), block.Time())
 		chainConfig = api.backend.ChainConfig()
<span class="term-fg31">-		vmctx       = core.NewEVMBlockContext(block.Header(), api.chainContext(ctx), nil)</span>
<span class="term-fg32">+		vmctx       = core.NewEVMBlockContext(block.Header(), api.chainContext(ctx), nil, chainConfig, statedb)</span>
 		canon       = true
 	)
 	&#47;&#47; Check if there are any overrides: the caller may wish to enable a future
<span class="term-fg36">@@ -847,13 +877,22 @@</span>
 &#47;&#47; TraceTransaction returns the structured logs created during the execution of EVM
 &#47;&#47; and returns them as a JSON object.
 func (api *API) TraceTransaction(ctx context.Context, hash common.Hash, config *TraceConfig) (interface{}, error) {
<span class="term-fg31">-	found, _, blockHash, blockNumber, index, err := api.backend.GetTransaction(ctx, hash)</span>
<span class="term-fg32">+	_, _, blockHash, blockNumber, index, err := api.backend.GetTransaction(ctx, hash)</span>
 	if err != nil {
 		return nil, ethapi.NewTxIndexingError()
 	}
<span class="term-fg31">-	&#47;&#47; Only mined txes are supported</span>
<span class="term-fg31">-	if !found {</span>
<span class="term-fg31">-		return nil, errTxNotFound</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	if api.backend.ChainConfig().IsOptimismPreBedrock(new(big.Int).SetUint64(blockNumber)) {</span>
<span class="term-fg32">+		if api.backend.HistoricalRPCService() != nil {</span>
<span class="term-fg32">+			var histResult json.RawMessage</span>
<span class="term-fg32">+			err := api.backend.HistoricalRPCService().CallContext(ctx, &amp;histResult, &quot;debug_traceTransaction&quot;, hash, config)</span>
<span class="term-fg32">+			if err != nil {</span>
<span class="term-fg32">+				return nil, fmt.Errorf(&quot;historical backend error: %w&quot;, err)</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+			return histResult, nil</span>
<span class="term-fg32">+		} else {</span>
<span class="term-fg32">+			return nil, rpc.ErrNoHistoricalFallback</span>
<span class="term-fg32">+		}</span>
 	}
 	&#47;&#47; It shouldn&#39;t happen in practice.
 	if blockNumber == 0 {
<span class="term-fg36">@@ -919,6 +958,11 @@</span> 	}
 	if err != nil {
 		return nil, err
 	}
<span class="term-fg32">+</span>
<span class="term-fg32">+	if api.backend.ChainConfig().IsOptimismPreBedrock(block.Number()) {</span>
<span class="term-fg32">+		return nil, errors.New(&quot;l2geth does not have a debug_traceCall method&quot;)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
 	&#47;&#47; try to recompute the state
 	reexec := defaultTraceReexec
 	if config != nil &amp;&amp; config.Reexec != nil {
<span class="term-fg36">@@ -935,7 +979,7 @@</span> 		return nil, err
 	}
 	defer release()
&nbsp;
<span class="term-fg31">-	vmctx := core.NewEVMBlockContext(block.Header(), api.chainContext(ctx), nil)</span>
<span class="term-fg32">+	vmctx := core.NewEVMBlockContext(block.Header(), api.chainContext(ctx), nil, api.backend.ChainConfig(), statedb)</span>
 	&#47;&#47; Apply the customization rules if required.
 	if config != nil {
 		if err := config.StateOverrides.Apply(statedb); err != nil {</div>
    </div>

            
            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-b5bcfd7fca758f82c0482900"role="button" aria-expanded="false" aria-controls="id-b5bcfd7fca758f82c0482900">
        
            <div class="col-12 col-md-12 col-lg-6 col-xl-6 text-start"><h3>Daisy Chain tests</h3></div>
        

        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2">
            <div class="row line-stat">
                
                
            </div>
        </div>
        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2 ">
            <div class="row line-stat">
                
                
                    <div class="text-end"><span class="text-add-ignored">+369</span></div>
                    <div class="text-start"><span class="text-delete-ignored">-16</span></div>
                
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-b5bcfd7fca758f82c0482900">
        <div></div>
        <div>
            
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-muted" data-bs-toggle="collapse" href="#id-97e9ebb356fff87d0265436a" role="button"
                       aria-expanded="false" aria-controls="id-97e9ebb356fff87d0265436a">
                        <code>eth/tracers/api_test.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/eth/tracers/api_test.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/eth/tracers/api_test.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-add-ignored">+190</span></div>
                            <div class="text-start"><span class="text-delete-ignored">-8</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-97e9ebb356fff87d0265436a"><span class="term-fg1">diff --git go-ethereum&#47;eth&#47;tracers&#47;api_test.go op-geth&#47;eth&#47;tracers&#47;api_test.go</span>
<span class="term-fg1">index 6fbb50848d633ef4b54bde64ce7ce667c69e86d5..9844c32f33c00187d9c075fcfbf2562ad55fe1d8 100644</span>
<span class="term-fg1">--- go-ethereum&#47;eth&#47;tracers&#47;api_test.go</span>
<span class="term-fg1">+++ op-geth&#47;eth&#47;tracers&#47;api_test.go</span>
<span class="term-fg36">@@ -23,12 +23,15 @@</span> 	&quot;encoding&#47;json&quot;
 	&quot;errors&quot;
 	&quot;fmt&quot;
 	&quot;math&#47;big&quot;
<span class="term-fg32">+	&quot;net&quot;</span>
<span class="term-fg32">+	&quot;net&#47;http&quot;</span>
 	&quot;reflect&quot;
 	&quot;slices&quot;
 	&quot;sync&#47;atomic&quot;
 	&quot;testing&quot;
 	&quot;time&quot;
&nbsp;
<span class="term-fg32">+	&quot;github.com&#47;davecgh&#47;go-spew&#47;spew&quot;</span>
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&#47;hexutil&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;consensus&quot;
<span class="term-fg36">@@ -43,8 +46,10 @@</span> 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;crypto&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;eth&#47;tracers&#47;logger&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;ethdb&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;internal&#47;ethapi&quot;
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;node&quot;</span>
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;params&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;rpc&quot;
<span class="term-fg32">+	&quot;github.com&#47;stretchr&#47;testify&#47;mock&quot;</span>
 )
&nbsp;
 var (
<span class="term-fg36">@@ -52,6 +57,66 @@</span> 	errStateNotFound = errors.New(&quot;state not found&quot;)
 	errBlockNotFound = errors.New(&quot;block not found&quot;)
 )
&nbsp;
<span class="term-fg32">+type mockHistoricalBackend struct {</span>
<span class="term-fg32">+	mock.Mock</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; mockHistoricalBackend does not have a TraceCall, because pre-bedrock there is no debug_traceCall available</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (m *mockHistoricalBackend) TraceBlockByNumber(ctx context.Context, number rpc.BlockNumber, config *TraceConfig) ([]*txTraceResult, error) {</span>
<span class="term-fg32">+	ret := m.Mock.MethodCalled(&quot;TraceBlockByNumber&quot;, number, config)</span>
<span class="term-fg32">+	return ret[0].([]*txTraceResult), *ret[1].(*error)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (m *mockHistoricalBackend) ExpectTraceBlockByNumber(number rpc.BlockNumber, config *TraceConfig, out []*txTraceResult, err error) {</span>
<span class="term-fg32">+	m.Mock.On(&quot;TraceBlockByNumber&quot;, number, config).Once().Return(out, &amp;err)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (m *mockHistoricalBackend) TraceTransaction(ctx context.Context, hash common.Hash, config *TraceConfig) (interface{}, error) {</span>
<span class="term-fg32">+	ret := m.Mock.MethodCalled(&quot;TraceTransaction&quot;, hash, config)</span>
<span class="term-fg32">+	return ret[0], *ret[1].(*error)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (m *mockHistoricalBackend) ExpectTraceTransaction(hash common.Hash, config *TraceConfig, out interface{}, err error) {</span>
<span class="term-fg32">+	jsonOut, _ := json.Marshal(out)</span>
<span class="term-fg32">+	m.Mock.On(&quot;TraceTransaction&quot;, hash, config).Once().Return(json.RawMessage(jsonOut), &amp;err)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func newMockHistoricalBackend(t *testing.T, backend *mockHistoricalBackend) string {</span>
<span class="term-fg32">+	s := rpc.NewServer()</span>
<span class="term-fg32">+	err := node.RegisterApis([]rpc.API{</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			Namespace:     &quot;debug&quot;,</span>
<span class="term-fg32">+			Service:       backend,</span>
<span class="term-fg32">+			Public:        true,</span>
<span class="term-fg32">+			Authenticated: false,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+	}, nil, s)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		t.Fatalf(&quot;error creating mock historical backend: %v&quot;, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	hdlr := node.NewHTTPHandlerStack(s, []string{&quot;*&quot;}, []string{&quot;*&quot;}, nil)</span>
<span class="term-fg32">+	mux := http.NewServeMux()</span>
<span class="term-fg32">+	mux.Handle(&quot;&#47;&quot;, hdlr)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	listener, err := net.Listen(&quot;tcp&quot;, &quot;127.0.0.1:0&quot;)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		t.Fatalf(&quot;error creating mock historical backend listener: %v&quot;, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	go func() {</span>
<span class="term-fg32">+		httpS := &amp;http.Server{Handler: mux}</span>
<span class="term-fg32">+		httpS.Serve(listener)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		t.Cleanup(func() {</span>
<span class="term-fg32">+			httpS.Shutdown(context.Background())</span>
<span class="term-fg32">+		})</span>
<span class="term-fg32">+	}()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	return fmt.Sprintf(&quot;http:&#47;&#47;%s&quot;, listener.Addr().String())</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
 type testBackend struct {
 	chainConfig *params.ChainConfig
 	engine      consensus.Engine
<span class="term-fg36">@@ -60,15 +125,28 @@</span> 	chain       *core.BlockChain
&nbsp;
 	refHook func() &#47;&#47; Hook is invoked when the requested state is referenced
 	relHook func() &#47;&#47; Hook is invoked when the requested state is released
<span class="term-fg32">+</span>
<span class="term-fg32">+	historical     *rpc.Client</span>
<span class="term-fg32">+	mockHistorical *mockHistoricalBackend</span>
 }
&nbsp;
 &#47;&#47; newTestBackend creates a new test backend. OBS: After test is done, teardown must be
 &#47;&#47; invoked in order to release associated resources.
 func newTestBackend(t *testing.T, n int, gspec *core.Genesis, generator func(i int, b *core.BlockGen)) *testBackend {
<span class="term-fg32">+	mock := new(mockHistoricalBackend)</span>
<span class="term-fg32">+	historicalAddr := newMockHistoricalBackend(t, mock)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	historicalClient, err := rpc.Dial(historicalAddr)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		t.Fatalf(&quot;error making historical client: %v&quot;, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
 	backend := &amp;testBackend{
<span class="term-fg31">-		chainConfig: gspec.Config,</span>
<span class="term-fg31">-		engine:      ethash.NewFaker(),</span>
<span class="term-fg31">-		chaindb:     rawdb.NewMemoryDatabase(),</span>
<span class="term-fg32">+		chainConfig:    gspec.Config,</span>
<span class="term-fg32">+		engine:         ethash.NewFaker(),</span>
<span class="term-fg32">+		chaindb:        rawdb.NewMemoryDatabase(),</span>
<span class="term-fg32">+		historical:     historicalClient,</span>
<span class="term-fg32">+		mockHistorical: mock,</span>
 	}
 	&#47;&#47; Generate blocks for testing
 	_, blocks, _ := core.GenerateChainWithGenesis(gspec, backend.engine, n, generator)
<span class="term-fg36">@@ -173,7 +251,7 @@</span> 	signer := types.MakeSigner(b.chainConfig, block.Number(), block.Time())
 	for idx, tx := range block.Transactions() {
 		msg, _ := core.TransactionToMessage(tx, signer, block.BaseFee())
 		txContext := core.NewEVMTxContext(msg)
<span class="term-fg31">-		context := core.NewEVMBlockContext(block.Header(), b.chain, nil)</span>
<span class="term-fg32">+		context := core.NewEVMBlockContext(block.Header(), b.chain, nil, b.chainConfig, statedb)</span>
 		if idx == txIndex {
 			return tx, context, statedb, release, nil
 		}
<span class="term-fg36">@@ -184,6 +262,10 @@</span> 		}
 		statedb.Finalise(vmenv.ChainConfig().IsEIP158(block.Number()))
 	}
 	return nil, vm.BlockContext{}, nil, nil, fmt.Errorf(&quot;transaction index %d out of range for block %#x&quot;, txIndex, block.Hash())
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (b *testBackend) HistoricalRPCService() *rpc.Client {</span>
<span class="term-fg32">+	return b.historical</span>
 }
&nbsp;
 func TestTraceCall(t *testing.T) {
<span class="term-fg36">@@ -451,11 +533,58 @@</span> 		StructLogs:  []logger.StructLogRes{},
 	}) {
 		t.Error(&quot;Transaction tracing result is different&quot;)
 	}
<span class="term-fg32">+}</span>
<span class="term-fg32">+func TestTraceTransactionHistorical(t *testing.T) {</span>
<span class="term-fg32">+	t.Parallel()</span>
&nbsp;
<span class="term-fg31">-	&#47;&#47; Test non-existent transaction</span>
<span class="term-fg31">-	_, err = api.TraceTransaction(context.Background(), common.Hash{42}, nil)</span>
<span class="term-fg31">-	if !errors.Is(err, errTxNotFound) {</span>
<span class="term-fg31">-		t.Fatalf(&quot;want %v, have %v&quot;, errTxNotFound, err)</span>
<span class="term-fg32">+	&#47;&#47; Initialize test accounts</span>
<span class="term-fg32">+	accounts := newAccounts(2)</span>
<span class="term-fg32">+	genesis := &amp;core.Genesis{</span>
<span class="term-fg32">+		Config: params.OptimismTestConfig,</span>
<span class="term-fg32">+		Alloc: core.GenesisAlloc{</span>
<span class="term-fg32">+			accounts[0].addr: {Balance: big.NewInt(params.Ether)},</span>
<span class="term-fg32">+			accounts[1].addr: {Balance: big.NewInt(params.Ether)},</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	target := common.Hash{}</span>
<span class="term-fg32">+	signer := types.HomesteadSigner{}</span>
<span class="term-fg32">+	backend := newTestBackend(t, 1, genesis, func(i int, b *core.BlockGen) {</span>
<span class="term-fg32">+		&#47;&#47; Transfer from account[0] to account[1]</span>
<span class="term-fg32">+		&#47;&#47;    value: 1000 wei</span>
<span class="term-fg32">+		&#47;&#47;    fee:   0 wei</span>
<span class="term-fg32">+		tx, _ := types.SignTx(types.NewTransaction(uint64(i), accounts[1].addr, big.NewInt(1000), params.TxGas, b.BaseFee(), nil), signer, accounts[0].key)</span>
<span class="term-fg32">+		b.AddTx(tx)</span>
<span class="term-fg32">+		target = tx.Hash()</span>
<span class="term-fg32">+	})</span>
<span class="term-fg32">+	defer backend.mockHistorical.AssertExpectations(t)</span>
<span class="term-fg32">+	defer backend.chain.Stop()</span>
<span class="term-fg32">+	backend.mockHistorical.ExpectTraceTransaction(</span>
<span class="term-fg32">+		target,</span>
<span class="term-fg32">+		nil,</span>
<span class="term-fg32">+		logger.ExecutionResult{</span>
<span class="term-fg32">+			Gas:         params.TxGas,</span>
<span class="term-fg32">+			Failed:      false,</span>
<span class="term-fg32">+			ReturnValue: &quot;&quot;,</span>
<span class="term-fg32">+			StructLogs:  []logger.StructLogRes{},</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		nil)</span>
<span class="term-fg32">+	api := NewAPI(backend)</span>
<span class="term-fg32">+	result, err := api.TraceTransaction(context.Background(), target, nil)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		t.Errorf(&quot;Failed to trace transaction %v&quot;, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	var have *logger.ExecutionResult</span>
<span class="term-fg32">+	spew.Dump(result)</span>
<span class="term-fg32">+	if err := json.Unmarshal(result.(json.RawMessage), &amp;have); err != nil {</span>
<span class="term-fg32">+		t.Errorf(&quot;failed to unmarshal result %v&quot;, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if !reflect.DeepEqual(have, &amp;logger.ExecutionResult{</span>
<span class="term-fg32">+		Gas:         params.TxGas,</span>
<span class="term-fg32">+		Failed:      false,</span>
<span class="term-fg32">+		ReturnValue: &quot;&quot;,</span>
<span class="term-fg32">+		StructLogs:  []logger.StructLogRes{},</span>
<span class="term-fg32">+	}) {</span>
<span class="term-fg32">+		t.Error(&quot;Transaction tracing result is different&quot;)</span>
 	}
 }
&nbsp;
<span class="term-fg36">@@ -546,6 +675,59 @@</span> 		want := tc.want
 		if string(have) != want {
 			t.Errorf(&quot;test %d, result mismatch, have\n%v\n, want\n%v\n&quot;, i, string(have), want)
 		}
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func TestTraceBlockHistorical(t *testing.T) {</span>
<span class="term-fg32">+	t.Parallel()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Initialize test accounts</span>
<span class="term-fg32">+	accounts := newAccounts(3)</span>
<span class="term-fg32">+	genesis := &amp;core.Genesis{</span>
<span class="term-fg32">+		Config: params.OptimismTestConfig,</span>
<span class="term-fg32">+		Alloc: core.GenesisAlloc{</span>
<span class="term-fg32">+			accounts[0].addr: {Balance: big.NewInt(params.Ether)},</span>
<span class="term-fg32">+			accounts[1].addr: {Balance: big.NewInt(params.Ether)},</span>
<span class="term-fg32">+			accounts[2].addr: {Balance: big.NewInt(params.Ether)},</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	genBlocks := 10</span>
<span class="term-fg32">+	signer := types.HomesteadSigner{}</span>
<span class="term-fg32">+	backend := newTestBackend(t, genBlocks, genesis, func(i int, b *core.BlockGen) {</span>
<span class="term-fg32">+		&#47;&#47; Transfer from account[0] to account[1]</span>
<span class="term-fg32">+		&#47;&#47;    value: 1000 wei</span>
<span class="term-fg32">+		&#47;&#47;    fee:   0 wei</span>
<span class="term-fg32">+		tx, _ := types.SignTx(types.NewTransaction(uint64(i), accounts[1].addr, big.NewInt(1000), params.TxGas, b.BaseFee(), nil), signer, accounts[0].key)</span>
<span class="term-fg32">+		b.AddTx(tx)</span>
<span class="term-fg32">+	})</span>
<span class="term-fg32">+	defer backend.mockHistorical.AssertExpectations(t)</span>
<span class="term-fg32">+	defer backend.chain.Stop()</span>
<span class="term-fg32">+	api := NewAPI(backend)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	var expectErr error</span>
<span class="term-fg32">+	var config *TraceConfig</span>
<span class="term-fg32">+	blockNumber := rpc.BlockNumber(3)</span>
<span class="term-fg32">+	want := `[{&quot;txHash&quot;:&quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;,&quot;result&quot;:{&quot;failed&quot;:false,&quot;gas&quot;:21000,&quot;returnValue&quot;:&quot;&quot;,&quot;structLogs&quot;:[]}}]`</span>
<span class="term-fg32">+	var ret []*txTraceResult</span>
<span class="term-fg32">+	_ = json.Unmarshal([]byte(want), &amp;ret)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	backend.mockHistorical.ExpectTraceBlockByNumber(blockNumber, config, ret, nil)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	result, err := api.TraceBlockByNumber(context.Background(), blockNumber, config)</span>
<span class="term-fg32">+	if expectErr != nil {</span>
<span class="term-fg32">+		if err == nil {</span>
<span class="term-fg32">+			t.Errorf(&quot;want error %v&quot;, expectErr)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		if !reflect.DeepEqual(err, expectErr) {</span>
<span class="term-fg32">+			t.Errorf(&quot;error mismatch, want %v, get %v&quot;, expectErr, err)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		t.Errorf(&quot;want no error, have %v&quot;, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	have, _ := json.Marshal(result)</span>
<span class="term-fg32">+	if string(have) != want {</span>
<span class="term-fg32">+		t.Errorf(&quot;result mismatch, have\n%v\n, want\n%v\n&quot;, string(have), want)</span>
 	}
 }
</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-muted" data-bs-toggle="collapse" href="#id-7912c7f0211d5f2a5f12811a" role="button"
                       aria-expanded="false" aria-controls="id-7912c7f0211d5f2a5f12811a">
                        <code>ethclient/ethclient_test.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/ethclient/ethclient_test.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/ethclient/ethclient_test.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-add-ignored">+176</span></div>
                            <div class="text-start"><span class="text-delete-ignored">-7</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-7912c7f0211d5f2a5f12811a"><span class="term-fg1">diff --git go-ethereum&#47;ethclient&#47;ethclient_test.go op-geth&#47;ethclient&#47;ethclient_test.go</span>
<span class="term-fg1">index 2f3229cedcb55428ffa5526ec4d7af3853ff9a79..795f3797d7efd741b4d721fae613278d2b9afc9c 100644</span>
<span class="term-fg1">--- go-ethereum&#47;ethclient&#47;ethclient_test.go</span>
<span class="term-fg1">+++ op-geth&#47;ethclient&#47;ethclient_test.go</span>
<span class="term-fg36">@@ -20,10 +20,18 @@</span> import (
 	&quot;bytes&quot;
 	&quot;context&quot;
 	&quot;errors&quot;
<span class="term-fg32">+	&quot;fmt&quot;</span>
 	&quot;math&#47;big&quot;
<span class="term-fg32">+	&quot;net&quot;</span>
<span class="term-fg32">+	&quot;net&#47;http&quot;</span>
 	&quot;reflect&quot;
 	&quot;testing&quot;
 	&quot;time&quot;
<span class="term-fg32">+</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&#47;hexutil&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;consensus&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;consensus&#47;beacon&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;internal&#47;ethapi&quot;</span>
&nbsp;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&quot;
<span class="term-fg36">@@ -193,6 +201,21 @@</span> 	Timestamp: 9000,
 	BaseFee:   big.NewInt(params.InitialBaseFee),
 }
&nbsp;
<span class="term-fg32">+var genesisForHistorical = &amp;core.Genesis{</span>
<span class="term-fg32">+	Config:    params.OptimismTestConfig,</span>
<span class="term-fg32">+	Alloc:     core.GenesisAlloc{testAddr: {Balance: testBalance}},</span>
<span class="term-fg32">+	ExtraData: []byte(&quot;test genesis&quot;),</span>
<span class="term-fg32">+	Timestamp: 9000,</span>
<span class="term-fg32">+	BaseFee:   big.NewInt(params.InitialBaseFee),</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+var depositTx = types.NewTx(&amp;types.DepositTx{</span>
<span class="term-fg32">+	Value: big.NewInt(12),</span>
<span class="term-fg32">+	Gas:   params.TxGas + 2000,</span>
<span class="term-fg32">+	To:    &amp;common.Address{2},</span>
<span class="term-fg32">+	Data:  make([]byte, 500),</span>
<span class="term-fg32">+})</span>
<span class="term-fg32">+</span>
 var testTx1 = types.MustSignNewTx(testKey, types.LatestSigner(genesis.Config), &amp;types.LegacyTx{
 	Nonce:    0,
 	Value:    big.NewInt(12),
<span class="term-fg36">@@ -209,9 +232,77 @@</span> 	Gas:      params.TxGas,
 	To:       &amp;common.Address{2},
 })
&nbsp;
<span class="term-fg31">-func newTestBackend(t *testing.T) (*node.Node, []*types.Block) {</span>
<span class="term-fg31">-	&#47;&#47; Generate test chain.</span>
<span class="term-fg31">-	blocks := generateTestChain()</span>
<span class="term-fg32">+type mockHistoricalBackend struct{}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (m *mockHistoricalBackend) Call(ctx context.Context, args ethapi.TransactionArgs, blockNrOrHash rpc.BlockNumberOrHash, overrides *ethapi.StateOverride) (hexutil.Bytes, error) {</span>
<span class="term-fg32">+	num, ok := blockNrOrHash.Number()</span>
<span class="term-fg32">+	if ok &amp;&amp; num == 1 {</span>
<span class="term-fg32">+		return hexutil.Bytes(&quot;test&quot;), nil</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	return nil, ethereum.NotFound</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (m *mockHistoricalBackend) EstimateGas(ctx context.Context, args ethapi.TransactionArgs, blockNrOrHash *rpc.BlockNumberOrHash) (hexutil.Uint64, error) {</span>
<span class="term-fg32">+	num, ok := blockNrOrHash.Number()</span>
<span class="term-fg32">+	if ok &amp;&amp; num == 1 {</span>
<span class="term-fg32">+		return hexutil.Uint64(12345), nil</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	return 0, ethereum.NotFound</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func newMockHistoricalBackend(t *testing.T) string {</span>
<span class="term-fg32">+	s := rpc.NewServer()</span>
<span class="term-fg32">+	err := node.RegisterApis([]rpc.API{</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			Namespace:     &quot;eth&quot;,</span>
<span class="term-fg32">+			Service:       new(mockHistoricalBackend),</span>
<span class="term-fg32">+			Public:        true,</span>
<span class="term-fg32">+			Authenticated: false,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+	}, nil, s)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		t.Fatalf(&quot;error creating mock historical backend: %v&quot;, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	hdlr := node.NewHTTPHandlerStack(s, []string{&quot;*&quot;}, []string{&quot;*&quot;}, nil)</span>
<span class="term-fg32">+	mux := http.NewServeMux()</span>
<span class="term-fg32">+	mux.Handle(&quot;&#47;&quot;, hdlr)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	listener, err := net.Listen(&quot;tcp&quot;, &quot;127.0.0.1:0&quot;)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		t.Fatalf(&quot;error creating mock historical backend listener: %v&quot;, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	go func() {</span>
<span class="term-fg32">+		httpS := &amp;http.Server{Handler: mux}</span>
<span class="term-fg32">+		httpS.Serve(listener)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		t.Cleanup(func() {</span>
<span class="term-fg32">+			httpS.Shutdown(context.Background())</span>
<span class="term-fg32">+		})</span>
<span class="term-fg32">+	}()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	return fmt.Sprintf(&quot;http:&#47;&#47;%s&quot;, listener.Addr().String())</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func newTestBackend(t *testing.T, enableHistoricalState bool) (*node.Node, []*types.Block) {</span>
<span class="term-fg32">+	histAddr := newMockHistoricalBackend(t)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	var consensusEngine consensus.Engine</span>
<span class="term-fg32">+	var actualGenesis *core.Genesis</span>
<span class="term-fg32">+	var chainLength int</span>
<span class="term-fg32">+	if enableHistoricalState {</span>
<span class="term-fg32">+		actualGenesis = genesisForHistorical</span>
<span class="term-fg32">+		consensusEngine = beacon.New(ethash.NewFaker())</span>
<span class="term-fg32">+		chainLength = 10</span>
<span class="term-fg32">+	} else {</span>
<span class="term-fg32">+		actualGenesis = genesis</span>
<span class="term-fg32">+		consensusEngine = ethash.NewFaker()</span>
<span class="term-fg32">+		chainLength = 2</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Generate test chain</span>
<span class="term-fg32">+	blocks := generateTestChain(consensusEngine, actualGenesis, chainLength)</span>
&nbsp;
 	&#47;&#47; Create node
 	n, err := node.New(&amp;node.Config{})
<span class="term-fg36">@@ -219,11 +310,18 @@</span> 	if err != nil {
 		t.Fatalf(&quot;can&#39;t create new node: %v&quot;, err)
 	}
 	&#47;&#47; Create Ethereum Service
<span class="term-fg31">-	config := &amp;ethconfig.Config{Genesis: genesis}</span>
<span class="term-fg32">+	config := &amp;ethconfig.Config{Genesis: actualGenesis}</span>
<span class="term-fg32">+	if enableHistoricalState {</span>
<span class="term-fg32">+		config.RollupHistoricalRPC = histAddr</span>
<span class="term-fg32">+		config.RollupHistoricalRPCTimeout = time.Second * 5</span>
<span class="term-fg32">+	}</span>
 	ethservice, err := eth.New(n, config)
 	if err != nil {
 		t.Fatalf(&quot;can&#39;t create new ethereum service: %v&quot;, err)
 	}
<span class="term-fg32">+	if enableHistoricalState { &#47;&#47; swap to the pre-bedrock consensus-engine that we used to generate the historical blocks</span>
<span class="term-fg32">+		ethservice.BlockChain().Engine().(*beacon.Beacon).SwapInner(ethash.NewFaker())</span>
<span class="term-fg32">+	}</span>
 	&#47;&#47; Import the test chain.
 	if err := n.Start(); err != nil {
 		t.Fatalf(&quot;can&#39;t start test node: %v&quot;, err)
<span class="term-fg36">@@ -231,6 +329,7 @@</span> 	}
 	if _, err := ethservice.BlockChain().InsertChain(blocks[1:]); err != nil {
 		t.Fatalf(&quot;can&#39;t import test blocks: %v&quot;, err)
 	}
<span class="term-fg32">+</span>
 	&#47;&#47; Ensure the tx indexing is fully generated
 	for ; ; time.Sleep(time.Millisecond * 100) {
 		progress, err := ethservice.BlockChain().TxIndexProgress()
<span class="term-fg36">@@ -238,25 +337,44 @@</span> 		if err == nil &amp;&amp; progress.Done() {
 			break
 		}
 	}
<span class="term-fg32">+</span>
<span class="term-fg32">+	if enableHistoricalState {</span>
<span class="term-fg32">+		&#47;&#47; Now that we have a filled DB, swap the pre-Bedrock consensus to OpLegacy,</span>
<span class="term-fg32">+		&#47;&#47; which does not support re-processing of pre-bedrock data.</span>
<span class="term-fg32">+		ethservice.Engine().(*beacon.Beacon).SwapInner(&amp;beacon.OpLegacy{})</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
 	return n, blocks
 }
&nbsp;
<span class="term-fg31">-func generateTestChain() []*types.Block {</span>
<span class="term-fg32">+func generateTestChain(consensusEngine consensus.Engine, genesis *core.Genesis, length int) []*types.Block {</span>
 	generate := func(i int, g *core.BlockGen) {
 		g.OffsetTime(5)
 		g.SetExtra([]byte(&quot;test&quot;))
 		if i == 1 {
 			&#47;&#47; Test transactions are included in block #2.
<span class="term-fg32">+			if genesis.Config.Optimism != nil &amp;&amp; genesis.Config.IsBedrock(big.NewInt(1)) {</span>
<span class="term-fg32">+				g.AddTx(depositTx)</span>
<span class="term-fg32">+			}</span>
 			g.AddTx(testTx1)
 			g.AddTx(testTx2)
 		}
 	}
<span class="term-fg31">-	_, blocks, _ := core.GenerateChainWithGenesis(genesis, ethash.NewFaker(), 2, generate)</span>
<span class="term-fg32">+	_, blocks, _ := core.GenerateChainWithGenesis(genesis, consensusEngine, length, generate)</span>
 	return append([]*types.Block{genesis.ToBlock()}, blocks...)
 }
&nbsp;
<span class="term-fg32">+func TestEthClientHistoricalBackend(t *testing.T) {</span>
<span class="term-fg32">+	backend, _ := newTestBackend(t, true)</span>
<span class="term-fg32">+	client := backend.Attach()</span>
<span class="term-fg32">+	defer backend.Close()</span>
<span class="term-fg32">+	defer client.Close()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	testHistoricalRPC(t, client)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
 func TestEthClient(t *testing.T) {
<span class="term-fg31">-	backend, chain := newTestBackend(t)</span>
<span class="term-fg32">+	backend, chain := newTestBackend(t, false)</span>
 	client := backend.Attach()
 	defer backend.Close()
 	defer client.Close()
<span class="term-fg36">@@ -293,6 +411,9 @@</span> 			func(t *testing.T) { testAtFunctions(t, client) },
 		},
 		&quot;TransactionSender&quot;: {
 			func(t *testing.T) { testTransactionSender(t, client) },
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		&quot;EstimateGas&quot;: {</span>
<span class="term-fg32">+			func(t *testing.T) { testEstimateGas(t, client) },</span>
 		},
 	}
&nbsp;
<span class="term-fg36">@@ -734,6 +855,54 @@</span> 		t.Fatal(err)
 	}
 	if sender2 != testAddr {
 		t.Fatal(&quot;wrong sender:&quot;, sender2)
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func testEstimateGas(t *testing.T, client *rpc.Client) {</span>
<span class="term-fg32">+	ec := NewClient(client)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; EstimateGas</span>
<span class="term-fg32">+	msg := ethereum.CallMsg{</span>
<span class="term-fg32">+		From:  testAddr,</span>
<span class="term-fg32">+		To:    &amp;common.Address{},</span>
<span class="term-fg32">+		Gas:   21000,</span>
<span class="term-fg32">+		Value: big.NewInt(1),</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	gas, err := ec.EstimateGas(context.Background(), msg)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		t.Fatalf(&quot;unexpected error: %v&quot;, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if gas != 21000 {</span>
<span class="term-fg32">+		t.Fatalf(&quot;unexpected gas price: %v&quot;, gas)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func testHistoricalRPC(t *testing.T, client *rpc.Client) {</span>
<span class="term-fg32">+	ec := NewClient(client)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Estimate Gas RPC</span>
<span class="term-fg32">+	msg := ethereum.CallMsg{</span>
<span class="term-fg32">+		From:  testAddr,</span>
<span class="term-fg32">+		To:    &amp;common.Address{},</span>
<span class="term-fg32">+		Gas:   21000,</span>
<span class="term-fg32">+		Value: big.NewInt(1),</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	var res hexutil.Uint64</span>
<span class="term-fg32">+	err := client.CallContext(context.Background(), &amp;res, &quot;eth_estimateGas&quot;, toCallArg(msg), rpc.BlockNumberOrHashWithNumber(1))</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		t.Fatalf(&quot;unexpected error: %v&quot;, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if res != 12345 {</span>
<span class="term-fg32">+		t.Fatalf(&quot;invalid result: %d&quot;, res)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Call Contract RPC</span>
<span class="term-fg32">+	histVal, err := ec.CallContract(context.Background(), msg, big.NewInt(1))</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		t.Fatalf(&quot;unexpected error: %v&quot;, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if string(histVal) != &quot;test&quot; {</span>
<span class="term-fg32">+		t.Fatalf(&quot;expected %s to equal test&quot;, string(histVal))</span>
 	}
 }
</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-muted" data-bs-toggle="collapse" href="#id-4aa093138632f4fdd29cfb66" role="button"
                       aria-expanded="false" aria-controls="id-4aa093138632f4fdd29cfb66">
                        <code>internal/ethapi/transaction_args_test.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/internal/ethapi/transaction_args_test.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/internal/ethapi/transaction_args_test.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-add-ignored">+3</span></div>
                            <div class="text-start"><span class="text-delete-ignored">-1</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-4aa093138632f4fdd29cfb66"><span class="term-fg1">diff --git go-ethereum&#47;internal&#47;ethapi&#47;transaction_args_test.go op-geth&#47;internal&#47;ethapi&#47;transaction_args_test.go</span>
<span class="term-fg1">index 6750fc07a944c1abc70483d780d1e05036bc2099..79fe9a425757029ebfc22f19ec286fc6d104cd08 100644</span>
<span class="term-fg1">--- go-ethereum&#47;internal&#47;ethapi&#47;transaction_args_test.go</span>
<span class="term-fg1">+++ op-geth&#47;internal&#47;ethapi&#47;transaction_args_test.go</span>
<span class="term-fg36">@@ -402,4 +402,6 @@</span> func (b *backendMock) SubscribeRemovedLogsEvent(ch chan&lt;- core.RemovedLogsEvent) event.Subscription {
 	return nil
 }
&nbsp;
<span class="term-fg31">-func (b *backendMock) Engine() consensus.Engine { return nil }</span>
<span class="term-fg32">+func (b *backendMock) Engine() consensus.Engine          { return nil }</span>
<span class="term-fg32">+func (b *backendMock) HistoricalRPCService() *rpc.Client { return nil }</span>
<span class="term-fg32">+func (b *backendMock) Genesis() *types.Block             { return nil }</span></div>
    </div>

            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-35c6759364741586b9f54155"role="button" aria-expanded="false" aria-controls="id-35c6759364741586b9f54155">
        
            <div class="col-12 col-md-12 col-lg-6 col-xl-6 text-start"><h3>Debug API</h3></div>
        

        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2">
            <div class="row line-stat">
                
                
            </div>
        </div>
        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2 ">
            <div class="row line-stat">
                
                    <div class="text-end"><span class="text-success">+4</span></div>
                    <div class="text-start"><span class="text-danger">-1</span></div>
                
                
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-35c6759364741586b9f54155">
        <div><p>Fix Debug API block marshaling to include deposits</p>
</div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-c9d22b39ab1c7d74c315c206" role="button"
                       aria-expanded="false" aria-controls="id-c9d22b39ab1c7d74c315c206">
                        <code>eth/api_debug.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/eth/api_debug.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/eth/api_debug.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+4</span></div>
                            <div class="text-start"><span class="text-danger">-1</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-c9d22b39ab1c7d74c315c206"><span class="term-fg1">diff --git go-ethereum&#47;eth&#47;api_debug.go op-geth&#47;eth&#47;api_debug.go</span>
<span class="term-fg1">index d5e4dda1401c9ae49a754077f837d0ebed760310..f6e09d185a9b036a32c3d50d5baa9d538105bc7b 100644</span>
<span class="term-fg1">--- go-ethereum&#47;eth&#47;api_debug.go</span>
<span class="term-fg1">+++ op-geth&#47;eth&#47;api_debug.go</span>
<span class="term-fg36">@@ -119,7 +119,10 @@</span> 			blockRlp = err.Error() &#47;&#47; Hacky, but hey, it works
 		} else {
 			blockRlp = fmt.Sprintf(&quot;%#x&quot;, rlpBytes)
 		}
<span class="term-fg31">-		blockJSON = ethapi.RPCMarshalBlock(block, true, true, api.eth.APIBackend.ChainConfig())</span>
<span class="term-fg32">+		var err error</span>
<span class="term-fg32">+		if blockJSON, err = ethapi.RPCMarshalBlock(ctx, block, true, true, api.eth.APIBackend.ChainConfig(), api.eth.APIBackend); err != nil {</span>
<span class="term-fg32">+			blockJSON = map[string]interface{}{&quot;error&quot;: err.Error()}</span>
<span class="term-fg32">+		}</span>
 		results = append(results, &amp;BadBlockArgs{
 			Hash:  block.Hash(),
 			RLP:   blockRlp,</div>
    </div>

            
            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-8ac09e5edf80656ec07dbc2c"role="button" aria-expanded="false" aria-controls="id-8ac09e5edf80656ec07dbc2c">
        
            <div class="col-12 col-md-12 col-lg-6 col-xl-6 text-start"><h3>Eth gasprice suggestions</h3></div>
        

        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2">
            <div class="row line-stat">
                
                
            </div>
        </div>
        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2 ">
            <div class="row line-stat">
                
                    <div class="text-end"><span class="text-success">+139</span></div>
                    <div class="text-start"><span class="text-danger">-1</span></div>
                
                
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-8ac09e5edf80656ec07dbc2c">
        <div><p>gasprice suggestion adjustments to accommodate faster L2 blocks and lower fees.</p>
</div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-f6ceaab2788346d62da6de94" role="button"
                       aria-expanded="false" aria-controls="id-f6ceaab2788346d62da6de94">
                        <code>eth/gasprice/gasprice.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/eth/gasprice/gasprice.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/eth/gasprice/gasprice.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+29</span></div>
                            <div class="text-start"><span class="text-danger">-1</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-f6ceaab2788346d62da6de94"><span class="term-fg1">diff --git go-ethereum&#47;eth&#47;gasprice&#47;gasprice.go op-geth&#47;eth&#47;gasprice&#47;gasprice.go</span>
<span class="term-fg1">index c90408e363023f607af149123120ec170b44f9b7..b07532a878addfd7b152de422be8f4f32b752c26 100644</span>
<span class="term-fg1">--- go-ethereum&#47;eth&#47;gasprice&#47;gasprice.go</span>
<span class="term-fg1">+++ op-geth&#47;eth&#47;gasprice&#47;gasprice.go</span>
<span class="term-fg36">@@ -38,6 +38,8 @@</span>
 var (
 	DefaultMaxPrice    = big.NewInt(500 * params.GWei)
 	DefaultIgnorePrice = big.NewInt(2 * params.Wei)
<span class="term-fg32">+</span>
<span class="term-fg32">+	DefaultMinSuggestedPriorityFee = big.NewInt(1e6 * params.Wei) &#47;&#47; 0.001 gwei, for Optimism fee suggestion</span>
 )
&nbsp;
 type Config struct {
<span class="term-fg36">@@ -48,6 +50,8 @@</span> 	MaxBlockHistory  uint64
 	Default          *big.Int `toml:&quot;,omitempty&quot;`
 	MaxPrice         *big.Int `toml:&quot;,omitempty&quot;`
 	IgnorePrice      *big.Int `toml:&quot;,omitempty&quot;`
<span class="term-fg32">+</span>
<span class="term-fg32">+	MinSuggestedPriorityFee *big.Int `toml:&quot;,omitempty&quot;` &#47;&#47; for Optimism fee suggestion</span>
 }
&nbsp;
 &#47;&#47; OracleBackend includes all necessary background APIs for oracle.
<span class="term-fg36">@@ -75,6 +79,8 @@</span> 	checkBlocks, percentile           int
 	maxHeaderHistory, maxBlockHistory uint64
&nbsp;
 	historyCache *lru.Cache[cacheKey, processedFees]
<span class="term-fg32">+</span>
<span class="term-fg32">+	minSuggestedPriorityFee *big.Int &#47;&#47; for Optimism fee suggestion</span>
 }
&nbsp;
 &#47;&#47; NewOracle returns a new gasprice oracle which can recommend suitable
<span class="term-fg36">@@ -129,7 +135,7 @@</span> 			lastHead = ev.Block.Hash()
 		}
 	}()
&nbsp;
<span class="term-fg31">-	return &amp;Oracle{</span>
<span class="term-fg32">+	r := &amp;Oracle{</span>
 		backend:          backend,
 		lastPrice:        params.Default,
 		maxPrice:         maxPrice,
<span class="term-fg36">@@ -140,6 +146,17 @@</span> 		maxHeaderHistory: maxHeaderHistory,
 		maxBlockHistory:  maxBlockHistory,
 		historyCache:     cache,
 	}
<span class="term-fg32">+</span>
<span class="term-fg32">+	if backend.ChainConfig().IsOptimism() {</span>
<span class="term-fg32">+		r.minSuggestedPriorityFee = params.MinSuggestedPriorityFee</span>
<span class="term-fg32">+		if r.minSuggestedPriorityFee == nil || r.minSuggestedPriorityFee.Int64() &lt;= 0 {</span>
<span class="term-fg32">+			r.minSuggestedPriorityFee = DefaultMinSuggestedPriorityFee</span>
<span class="term-fg32">+			log.Warn(&quot;Sanitizing invalid optimism gasprice oracle min priority fee suggestion&quot;,</span>
<span class="term-fg32">+				&quot;provided&quot;, params.MinSuggestedPriorityFee,</span>
<span class="term-fg32">+				&quot;updated&quot;, r.minSuggestedPriorityFee)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	return r</span>
 }
&nbsp;
 &#47;&#47; SuggestTipCap returns a tip cap so that newly created transaction can have a
<span class="term-fg36">@@ -169,6 +186,11 @@</span> 	oracle.cacheLock.RUnlock()
 	if headHash == lastHead {
 		return new(big.Int).Set(lastPrice), nil
 	}
<span class="term-fg32">+</span>
<span class="term-fg32">+	if oracle.backend.ChainConfig().IsOptimism() {</span>
<span class="term-fg32">+		return oracle.SuggestOptimismPriorityFee(ctx, head, headHash), nil</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
 	var (
 		sent, exp int
 		number    = head.Number.Uint64()
<span class="term-fg36">@@ -275,3 +297,9 @@</span> 	case result &lt;- results{prices, nil}:
 	case &lt;-quit:
 	}
 }
<span class="term-fg32">+</span>
<span class="term-fg32">+type bigIntArray []*big.Int</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (s bigIntArray) Len() int           { return len(s) }</span>
<span class="term-fg32">+func (s bigIntArray) Less(i, j int) bool { return s[i].Cmp(s[j]) &lt; 0 }</span>
<span class="term-fg32">+func (s bigIntArray) Swap(i, j int)      { s[i], s[j] = s[j], s[i] }</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-73ee20364322495b5e1717b4" role="button"
                       aria-expanded="false" aria-controls="id-73ee20364322495b5e1717b4">
                        <code>eth/gasprice/optimism-gasprice.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/eth/gasprice/optimism-gasprice.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+110</span></div>
                            <div class="text-start"><span class="text-danger">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-73ee20364322495b5e1717b4"><span class="term-fg1">diff --git go-ethereum&#47;eth&#47;gasprice&#47;optimism-gasprice.go op-geth&#47;eth&#47;gasprice&#47;optimism-gasprice.go</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..71cd021f637f92e4b6d99ec5fc337d27edf547e5</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ op-geth&#47;eth&#47;gasprice&#47;optimism-gasprice.go</span>
<span class="term-fg36">@@ -0,0 +1,110 @@</span>
<span class="term-fg32">+package gasprice</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+import (</span>
<span class="term-fg32">+	&quot;context&quot;</span>
<span class="term-fg32">+	&quot;math&#47;big&quot;</span>
<span class="term-fg32">+	&quot;sort&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&#47;types&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;log&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;rpc&quot;</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; SuggestOptimismPriorityFee returns a max priority fee value that can be used such that newly</span>
<span class="term-fg32">+&#47;&#47; created transactions have a very high chance to be included in the following blocks, using a</span>
<span class="term-fg32">+&#47;&#47; simplified and more predictable algorithm appropriate for chains like Optimism with a single</span>
<span class="term-fg32">+&#47;&#47; known block builder.</span>
<span class="term-fg32">+&#47;&#47;</span>
<span class="term-fg32">+&#47;&#47; In the typical case, which results whenever the last block had room for more transactions, this</span>
<span class="term-fg32">+&#47;&#47; function returns a minimum suggested priority fee value. Otherwise it returns the higher of this</span>
<span class="term-fg32">+&#47;&#47; minimum suggestion or 10% over the median effective priority fee from the last block.</span>
<span class="term-fg32">+&#47;&#47;</span>
<span class="term-fg32">+&#47;&#47; Rationale: For a chain such as Optimism where there is a single block builder whose behavior is</span>
<span class="term-fg32">+&#47;&#47; known, we know priority fee (as long as it is non-zero) has no impact on the probability for tx</span>
<span class="term-fg32">+&#47;&#47; inclusion as long as there is capacity for it in the block. In this case then, there&#39;s no reason</span>
<span class="term-fg32">+&#47;&#47; to return any value higher than some fixed minimum. Blocks typically reach capacity only under</span>
<span class="term-fg32">+&#47;&#47; extreme events such as airdrops, meaning predicting whether the next block is going to be at</span>
<span class="term-fg32">+&#47;&#47; capacity is difficult *except* in the case where we&#39;re already experiencing the increased demand</span>
<span class="term-fg32">+&#47;&#47; from such an event. We therefore expect whether the last known block is at capacity to be one of</span>
<span class="term-fg32">+&#47;&#47; the best predictors of whether the next block is likely to be at capacity. (An even better</span>
<span class="term-fg32">+&#47;&#47; predictor is to look at the state of the transaction pool, but we want an algorithm that works</span>
<span class="term-fg32">+&#47;&#47; even if the txpool is private or unavailable.)</span>
<span class="term-fg32">+&#47;&#47;</span>
<span class="term-fg32">+&#47;&#47; In the event the next block may be at capacity, the algorithm should allow for average fees to</span>
<span class="term-fg32">+&#47;&#47; rise in order to reach a market price that appropriately reflects demand. We accomplish this by</span>
<span class="term-fg32">+&#47;&#47; returning a suggestion that is a significant amount (10%) higher than the median effective</span>
<span class="term-fg32">+&#47;&#47; priority fee from the previous block.</span>
<span class="term-fg32">+func (oracle *Oracle) SuggestOptimismPriorityFee(ctx context.Context, h *types.Header, headHash common.Hash) *big.Int {</span>
<span class="term-fg32">+	suggestion := new(big.Int).Set(oracle.minSuggestedPriorityFee)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; find the maximum gas used by any of the transactions in the block to use as the capacity</span>
<span class="term-fg32">+	&#47;&#47; margin</span>
<span class="term-fg32">+	receipts, err := oracle.backend.GetReceipts(ctx, headHash)</span>
<span class="term-fg32">+	if receipts == nil || err != nil {</span>
<span class="term-fg32">+		log.Error(&quot;failed to get block receipts&quot;, &quot;err&quot;, err)</span>
<span class="term-fg32">+		return suggestion</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	var maxTxGasUsed uint64</span>
<span class="term-fg32">+	for i := range receipts {</span>
<span class="term-fg32">+		gu := receipts[i].GasUsed</span>
<span class="term-fg32">+		if gu &gt; maxTxGasUsed {</span>
<span class="term-fg32">+			maxTxGasUsed = gu</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; sanity check the max gas used value</span>
<span class="term-fg32">+	if maxTxGasUsed &gt; h.GasLimit {</span>
<span class="term-fg32">+		log.Error(&quot;found tx consuming more gas than the block limit&quot;, &quot;gas&quot;, maxTxGasUsed)</span>
<span class="term-fg32">+		return suggestion</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	if h.GasUsed+maxTxGasUsed &gt; h.GasLimit {</span>
<span class="term-fg32">+		&#47;&#47; A block is &quot;at capacity&quot; if, when it is built, there is a pending tx in the txpool that</span>
<span class="term-fg32">+		&#47;&#47; could not be included because the block&#39;s gas limit would be exceeded. Since we don&#39;t</span>
<span class="term-fg32">+		&#47;&#47; have access to the txpool, we instead adopt the following heuristic: consider a block as</span>
<span class="term-fg32">+		&#47;&#47; at capacity if the total gas consumed by its transactions is within max-tx-gas-used of</span>
<span class="term-fg32">+		&#47;&#47; the block limit, where max-tx-gas-used is the most gas used by any one transaction</span>
<span class="term-fg32">+		&#47;&#47; within the block. This heuristic is almost perfectly accurate when transactions always</span>
<span class="term-fg32">+		&#47;&#47; consume the same amount of gas, but becomes less accurate as tx gas consumption begins</span>
<span class="term-fg32">+		&#47;&#47; to vary. The typical error is we assume a block is at capacity when it was not because</span>
<span class="term-fg32">+		&#47;&#47; max-tx-gas-used will in most cases over-estimate the &quot;capacity margin&quot;. But it&#39;s better</span>
<span class="term-fg32">+		&#47;&#47; to err on the side of returning a higher-than-needed suggestion than a lower-than-needed</span>
<span class="term-fg32">+		&#47;&#47; one in order to satisfy our desire for high chance of inclusion and rising fees under</span>
<span class="term-fg32">+		&#47;&#47; high demand.</span>
<span class="term-fg32">+		block, err := oracle.backend.BlockByNumber(ctx, rpc.BlockNumber(h.Number.Int64()))</span>
<span class="term-fg32">+		if block == nil || err != nil {</span>
<span class="term-fg32">+			log.Error(&quot;failed to get last block&quot;, &quot;err&quot;, err)</span>
<span class="term-fg32">+			return suggestion</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		baseFee := block.BaseFee()</span>
<span class="term-fg32">+		txs := block.Transactions()</span>
<span class="term-fg32">+		if len(txs) == 0 {</span>
<span class="term-fg32">+			log.Error(&quot;block was at capacity but doesn&#39;t have transactions&quot;)</span>
<span class="term-fg32">+			return suggestion</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		tips := bigIntArray(make([]*big.Int, len(txs)))</span>
<span class="term-fg32">+		for i := range txs {</span>
<span class="term-fg32">+			tips[i] = txs[i].EffectiveGasTipValue(baseFee)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		sort.Sort(tips)</span>
<span class="term-fg32">+		median := tips[len(tips)&#47;2]</span>
<span class="term-fg32">+		newSuggestion := new(big.Int).Add(median, new(big.Int).Div(median, big.NewInt(10)))</span>
<span class="term-fg32">+		&#47;&#47; use the new suggestion only if it&#39;s bigger than the minimum</span>
<span class="term-fg32">+		if newSuggestion.Cmp(suggestion) &gt; 0 {</span>
<span class="term-fg32">+			suggestion = newSuggestion</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; the suggestion should be capped by oracle.maxPrice</span>
<span class="term-fg32">+	if suggestion.Cmp(oracle.maxPrice) &gt; 0 {</span>
<span class="term-fg32">+		suggestion.Set(oracle.maxPrice)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	oracle.cacheLock.Lock()</span>
<span class="term-fg32">+	oracle.lastHead = headHash</span>
<span class="term-fg32">+	oracle.lastPrice = suggestion</span>
<span class="term-fg32">+	oracle.cacheLock.Unlock()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	return new(big.Int).Set(suggestion)</span>
<span class="term-fg32">+}</span></div>
    </div>

            
            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-a0b232a7146b7a3ee1c9e9a9"role="button" aria-expanded="false" aria-controls="id-a0b232a7146b7a3ee1c9e9a9">
        
            <div class="col-12 col-md-12 col-lg-6 col-xl-6 text-start"><h3>API testvector fix</h3></div>
        

        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2">
            <div class="row line-stat">
                
                
            </div>
        </div>
        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2 ">
            <div class="row line-stat">
                
                    <div class="text-end"><span class="text-success">+1</span></div>
                    <div class="text-start"><span class="text-danger">-1</span></div>
                
                
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-a0b232a7146b7a3ee1c9e9a9">
        <div><p>Upstream test of broken behavior; in Optimism, a zero signature is valid (pre-bedrock for deposit-txs),
and the chain ID formula on signature data must not be used, or an underflow happens.</p>
</div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-0c9f5fe18557ec2c24ba0fc1" role="button"
                       aria-expanded="false" aria-controls="id-0c9f5fe18557ec2c24ba0fc1">
                        <code>internal/ethapi/testdata/eth_getBlockByNumber-tag-pending-fullTx.json</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/internal/ethapi/testdata/eth_getBlockByNumber-tag-pending-fullTx.json" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/internal/ethapi/testdata/eth_getBlockByNumber-tag-pending-fullTx.json" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+1</span></div>
                            <div class="text-start"><span class="text-danger">-1</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-0c9f5fe18557ec2c24ba0fc1"><span class="term-fg1">diff --git go-ethereum&#47;internal&#47;ethapi&#47;testdata&#47;eth_getBlockByNumber-tag-pending-fullTx.json op-geth&#47;internal&#47;ethapi&#47;testdata&#47;eth_getBlockByNumber-tag-pending-fullTx.json</span>
<span class="term-fg1">index 1d524d6eced19249ab7f1d7beeb04863087e81c1..7087932286ea7facdae1e56caf15e618b5307e71 100644</span>
<span class="term-fg1">--- go-ethereum&#47;internal&#47;ethapi&#47;testdata&#47;eth_getBlockByNumber-tag-pending-fullTx.json</span>
<span class="term-fg1">+++ op-geth&#47;internal&#47;ethapi&#47;testdata&#47;eth_getBlockByNumber-tag-pending-fullTx.json</span>
<span class="term-fg36">@@ -30,7 +30,7 @@</span>       &quot;to&quot;: &quot;0x0d3ab14bbad3d99f4203bd7a11acb94882050e7e&quot;,
       &quot;transactionIndex&quot;: &quot;0x0&quot;,
       &quot;value&quot;: &quot;0x6f&quot;,
       &quot;type&quot;: &quot;0x0&quot;,
<span class="term-fg31">-      &quot;chainId&quot;: &quot;0x7fffffffffffffee&quot;,</span>
<span class="term-fg32">+      &quot;chainId&quot;: &quot;0x1&quot;,</span>
       &quot;v&quot;: &quot;0x0&quot;,
       &quot;r&quot;: &quot;0x0&quot;,
       &quot;s&quot;: &quot;0x0&quot;</div>
    </div>

            
            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
        </div>
    </div>
</div>

            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-9ce0ddc0dd955d2823390d56"role="button" aria-expanded="false" aria-controls="id-9ce0ddc0dd955d2823390d56">
        
            <div class="col-12 col-md-12 col-lg-6 col-xl-6 text-start"><h2>Geth extras</h2></div>
        

        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2">
            <div class="row line-stat">
                
                
            </div>
        </div>
        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2 ">
            <div class="row line-stat">
                
                    <div class="text-end"><span class="text-success">+33</span></div>
                    <div class="text-start"><span class="text-danger">-0</span></div>
                
                
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-9ce0ddc0dd955d2823390d56">
        <div><p>Extend the tools available in geth to improve external testing and tooling.</p>
</div>
        <div>
            
            
        </div>
        <div>
            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-b3dbefa6a98e87e674176856"role="button" aria-expanded="false" aria-controls="id-b3dbefa6a98e87e674176856">
        
            <div class="col-12 col-md-12 col-lg-6 col-xl-6 text-start"><h3>Simulated Backend</h3></div>
        

        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2">
            <div class="row line-stat">
                
                
            </div>
        </div>
        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2 ">
            <div class="row line-stat">
                
                    <div class="text-end"><span class="text-success">+30</span></div>
                    <div class="text-start"><span class="text-danger">-0</span></div>
                
                
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-b3dbefa6a98e87e674176856">
        <div></div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-5b56f30c84d9d73f8966a44e" role="button"
                       aria-expanded="false" aria-controls="id-5b56f30c84d9d73f8966a44e">
                        <code>accounts/abi/bind/backends/simulated.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/accounts/abi/bind/backends/simulated.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/accounts/abi/bind/backends/simulated.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+9</span></div>
                            <div class="text-start"><span class="text-danger">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-5b56f30c84d9d73f8966a44e"><span class="term-fg1">diff --git go-ethereum&#47;accounts&#47;abi&#47;bind&#47;backends&#47;simulated.go op-geth&#47;accounts&#47;abi&#47;bind&#47;backends&#47;simulated.go</span>
<span class="term-fg1">index dfd929695286568a72fcb10a8c671e7b00b8cf22..38ac9d60d091204326f9fd8ec932fff4f4721bc9 100644</span>
<span class="term-fg1">--- go-ethereum&#47;accounts&#47;abi&#47;bind&#47;backends&#47;simulated.go</span>
<span class="term-fg1">+++ op-geth&#47;accounts&#47;abi&#47;bind&#47;backends&#47;simulated.go</span>
<span class="term-fg36">@@ -21,6 +21,7 @@</span> 	&quot;context&quot;
&nbsp;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&#47;types&quot;
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;eth&#47;ethconfig&quot;</span>
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;ethclient&#47;simulated&quot;
 )
&nbsp;
<span class="term-fg36">@@ -50,3 +51,11 @@</span> 		Backend: b,
 		Client:  b.Client(),
 	}
 }
<span class="term-fg32">+</span>
<span class="term-fg32">+func NewSimulatedBackendFromConfig(cfg ethconfig.Config) *SimulatedBackend {</span>
<span class="term-fg32">+	b := simulated.NewBackendFromConfig(cfg)</span>
<span class="term-fg32">+	return &amp;SimulatedBackend{</span>
<span class="term-fg32">+		Backend: b,</span>
<span class="term-fg32">+		Client:  b.Client(),</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-763f57c886b4f1e9938d38b0" role="button"
                       aria-expanded="false" aria-controls="id-763f57c886b4f1e9938d38b0">
                        <code>ethclient/simulated/backend.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/ethclient/simulated/backend.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/ethclient/simulated/backend.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+21</span></div>
                            <div class="text-start"><span class="text-danger">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-763f57c886b4f1e9938d38b0"><span class="term-fg1">diff --git go-ethereum&#47;ethclient&#47;simulated&#47;backend.go op-geth&#47;ethclient&#47;simulated&#47;backend.go</span>
<span class="term-fg1">index 6e07aa68d071d88a5bf393193a11ae51120e8826..03bb56da66d546219801343973d43ca94d55bd34 100644</span>
<span class="term-fg1">--- go-ethereum&#47;ethclient&#47;simulated&#47;backend.go</span>
<span class="term-fg1">+++ op-geth&#47;ethclient&#47;simulated&#47;backend.go</span>
<span class="term-fg36">@@ -103,6 +103,27 @@</span> 	}
 	return sim
 }
&nbsp;
<span class="term-fg32">+func NewBackendFromConfig(conf ethconfig.Config) *Backend {</span>
<span class="term-fg32">+	&#47;&#47; Setup the node object</span>
<span class="term-fg32">+	nodeConf := node.DefaultConfig</span>
<span class="term-fg32">+	nodeConf.DataDir = &quot;&quot;</span>
<span class="term-fg32">+	nodeConf.P2P = p2p.Config{NoDiscovery: true}</span>
<span class="term-fg32">+	stack, err := node.New(&amp;nodeConf)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		&#47;&#47; This should never happen, if it does, please open an issue</span>
<span class="term-fg32">+		panic(err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	conf.SyncMode = downloader.FullSync</span>
<span class="term-fg32">+	conf.TxPool.NoLocals = true</span>
<span class="term-fg32">+	sim, err := newWithNode(stack, &amp;conf, 0)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		&#47;&#47; This should never happen, if it does, please open an issue</span>
<span class="term-fg32">+		panic(err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	return sim</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
 &#47;&#47; newWithNode sets up a simulated backend on an existing node. The provided node
 &#47;&#47; must not be started and will be started by this method.
 func newWithNode(stack *node.Node, conf *eth.Config, blockPeriod uint64) (*Backend, error) {</div>
    </div>

            
            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-25019296a2d07ec4fab6f0e7"role="button" aria-expanded="false" aria-controls="id-25019296a2d07ec4fab6f0e7">
        
            <div class="col-12 col-md-12 col-lg-6 col-xl-6 text-start"><h3>Live tracer update</h3></div>
        

        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2">
            <div class="row line-stat">
                
                
            </div>
        </div>
        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2 ">
            <div class="row line-stat">
                
                    <div class="text-end"><span class="text-success">+3</span></div>
                    <div class="text-start"><span class="text-danger">-0</span></div>
                
                
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-25019296a2d07ec4fab6f0e7">
        <div><p>Track L1-deposited native currency that is coming into the L2 supply.
The balance delta is considered to be a &ldquo;withdrawal&rdquo; from L1,
similar to a withdrawal of the Beacon-chain into the Ethereum L1 execution chain.</p>
</div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-d38338f6f272d152847bfeaf" role="button"
                       aria-expanded="false" aria-controls="id-d38338f6f272d152847bfeaf">
                        <code>eth/tracers/live/supply.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/eth/tracers/live/supply.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/eth/tracers/live/supply.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+3</span></div>
                            <div class="text-start"><span class="text-danger">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-d38338f6f272d152847bfeaf"><span class="term-fg1">diff --git go-ethereum&#47;eth&#47;tracers&#47;live&#47;supply.go op-geth&#47;eth&#47;tracers&#47;live&#47;supply.go</span>
<span class="term-fg1">index 96f70594548cb4936ea58fa4813f11c7f39b5edb..cfa4843bfe1faada945a8d4416642e6b3a02588d 100644</span>
<span class="term-fg1">--- go-ethereum&#47;eth&#47;tracers&#47;live&#47;supply.go</span>
<span class="term-fg1">+++ op-geth&#47;eth&#47;tracers&#47;live&#47;supply.go</span>
<span class="term-fg36">@@ -188,6 +188,9 @@</span> 	case tracing.BalanceDecreaseSelfdestructBurn:
 		&#47;&#47; BalanceDecreaseSelfdestructBurn is non-reversible as it happens
 		&#47;&#47; at the end of the transaction.
 		s.delta.Burn.Misc.Sub(s.delta.Burn.Misc, diff)
<span class="term-fg32">+	&#47;&#47; Technically an OP-Stack deposit mint is a &quot;withdrawal&quot; from L1, taking funds into L2.</span>
<span class="term-fg32">+	case tracing.BalanceMint:</span>
<span class="term-fg32">+		s.delta.Issuance.Withdrawals.Add(s.delta.Issuance.Withdrawals, diff)</span>
 	default:
 		return
 	}</div>
    </div>

            
            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
        </div>
    </div>
</div>

            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-3dcfad2c949d01b7b6a632d7"role="button" aria-expanded="false" aria-controls="id-3dcfad2c949d01b7b6a632d7">
        
            <div class="col-12 col-md-12 col-lg-6 col-xl-6 text-start"><h2>Hardware wallet support</h2></div>
        

        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2">
            <div class="row line-stat">
                
                
            </div>
        </div>
        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2 ">
            <div class="row line-stat">
                
                    <div class="text-end"><span class="text-success">+10</span></div>
                    <div class="text-start"><span class="text-danger">-7</span></div>
                
                
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-3dcfad2c949d01b7b6a632d7">
        <div><p>Extend Ledger wallet support for newer devices on Macos</p>
</div>
        <div>
            
            
        </div>
        <div>
            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-d3d0e46a445ef8e277606860"role="button" aria-expanded="false" aria-controls="id-d3d0e46a445ef8e277606860">
        
            <div class="col-12 col-md-12 col-lg-6 col-xl-6 text-start"><h3>Fix Ledger discoverability</h3></div>
        

        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2">
            <div class="row line-stat">
                
                
            </div>
        </div>
        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2 ">
            <div class="row line-stat">
                
                    <div class="text-end"><span class="text-success">+10</span></div>
                    <div class="text-start"><span class="text-danger">-7</span></div>
                
                
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-d3d0e46a445ef8e277606860">
        <div></div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-4b32952215c4bef22b4d20ba" role="button"
                       aria-expanded="false" aria-controls="id-4b32952215c4bef22b4d20ba">
                        <code>accounts/usbwallet/hub.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/accounts/usbwallet/hub.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/accounts/usbwallet/hub.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+10</span></div>
                            <div class="text-start"><span class="text-danger">-7</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-4b32952215c4bef22b4d20ba"><span class="term-fg1">diff --git go-ethereum&#47;accounts&#47;usbwallet&#47;hub.go op-geth&#47;accounts&#47;usbwallet&#47;hub.go</span>
<span class="term-fg1">index e22dffe9718e6aba0ad50357f22a146babcf18e4..4603b392358288cd10eae62e6c9bb68693b4fe40 100644</span>
<span class="term-fg1">--- go-ethereum&#47;accounts&#47;usbwallet&#47;hub.go</span>
<span class="term-fg1">+++ op-geth&#47;accounts&#47;usbwallet&#47;hub.go</span>
<span class="term-fg36">@@ -19,6 +19,7 @@</span>
 import (
 	&quot;errors&quot;
 	&quot;runtime&quot;
<span class="term-fg32">+	&quot;slices&quot;</span>
 	&quot;sync&quot;
 	&quot;sync&#47;atomic&quot;
 	&quot;time&quot;
<span class="term-fg36">@@ -48,7 +49,7 @@</span> type Hub struct {
 	scheme     string                  &#47;&#47; Protocol scheme prefixing account and wallet URLs.
 	vendorID   uint16                  &#47;&#47; USB vendor identifier used for device discovery
 	productIDs []uint16                &#47;&#47; USB product identifiers used for device discovery
<span class="term-fg31">-	usageID    uint16                  &#47;&#47; USB usage page identifier used for macOS device discovery</span>
<span class="term-fg32">+	usageIDs   []uint16                &#47;&#47; USB usage page identifier used for macOS device discovery</span>
 	endpointID int                     &#47;&#47; USB endpoint identifier used for non-macOS device discovery
 	makeDriver func(log.Logger) driver &#47;&#47; Factory method to construct a vendor specific driver
&nbsp;
<span class="term-fg36">@@ -93,22 +94,22 @@</span> 		0x1011, &#47;* HID + WebUSB Ledger Nano S *&#47;
 		0x4011, &#47;* HID + WebUSB Ledger Nano X *&#47;
 		0x5011, &#47;* HID + WebUSB Ledger Nano S Plus *&#47;
 		0x6011, &#47;* HID + WebUSB Ledger Nano FTS *&#47;
<span class="term-fg31">-	}, 0xffa0, 0, newLedgerDriver)</span>
<span class="term-fg32">+	}, []uint16{0xffa0, 0}, 2, newLedgerDriver)</span>
 }
&nbsp;
 &#47;&#47; NewTrezorHubWithHID creates a new hardware wallet manager for Trezor devices.
 func NewTrezorHubWithHID() (*Hub, error) {
<span class="term-fg31">-	return newHub(TrezorScheme, 0x534c, []uint16{0x0001 &#47;* Trezor HID *&#47;}, 0xff00, 0, newTrezorDriver)</span>
<span class="term-fg32">+	return newHub(TrezorScheme, 0x534c, []uint16{0x0001 &#47;* Trezor HID *&#47;}, []uint16{0xff00}, 0, newTrezorDriver)</span>
 }
&nbsp;
 &#47;&#47; NewTrezorHubWithWebUSB creates a new hardware wallet manager for Trezor devices with
 &#47;&#47; firmware version &gt; 1.8.0
 func NewTrezorHubWithWebUSB() (*Hub, error) {
<span class="term-fg31">-	return newHub(TrezorScheme, 0x1209, []uint16{0x53c1 &#47;* Trezor WebUSB *&#47;}, 0xffff &#47;* No usage id on webusb, don&#39;t match unset (0) *&#47;, 0, newTrezorDriver)</span>
<span class="term-fg32">+	return newHub(TrezorScheme, 0x1209, []uint16{0x53c1 &#47;* Trezor WebUSB *&#47;}, []uint16{0xffff} &#47;* No usage id on webusb, don&#39;t match unset (0) *&#47;, 0, newTrezorDriver)</span>
 }
&nbsp;
 &#47;&#47; newHub creates a new hardware wallet manager for generic USB devices.
<span class="term-fg31">-func newHub(scheme string, vendorID uint16, productIDs []uint16, usageID uint16, endpointID int, makeDriver func(log.Logger) driver) (*Hub, error) {</span>
<span class="term-fg32">+func newHub(scheme string, vendorID uint16, productIDs []uint16, usageIDs []uint16, endpointID int, makeDriver func(log.Logger) driver) (*Hub, error) {</span>
 	if !hid.Supported() {
 		return nil, errors.New(&quot;unsupported platform&quot;)
 	}
<span class="term-fg36">@@ -116,7 +117,7 @@</span> 	hub := &amp;Hub{
 		scheme:     scheme,
 		vendorID:   vendorID,
 		productIDs: productIDs,
<span class="term-fg31">-		usageID:    usageID,</span>
<span class="term-fg32">+		usageIDs:   usageIDs,</span>
 		endpointID: endpointID,
 		makeDriver: makeDriver,
 		quit:       make(chan chan error),
<span class="term-fg36">@@ -186,7 +187,9 @@</span>
 	for _, info := range infos {
 		for _, id := range hub.productIDs {
 			&#47;&#47; Windows and Macos use UsageID matching, Linux uses Interface matching
<span class="term-fg31">-			if info.ProductID == id &amp;&amp; (info.UsagePage == hub.usageID || info.Interface == hub.endpointID) {</span>
<span class="term-fg32">+			if info.ProductID == id &amp;&amp;</span>
<span class="term-fg32">+				info.Path != &quot;&quot; &amp;&amp;</span>
<span class="term-fg32">+				(slices.Contains(hub.usageIDs, info.UsagePage) || info.Interface == hub.endpointID) {</span>
 				devices = append(devices, info)
 				break
 			}</div>
    </div>

            
            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
        </div>
    </div>
</div>

            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-790255ceb7c5d0fab58ddda0"role="button" aria-expanded="false" aria-controls="id-790255ceb7c5d0fab58ddda0">
        
            <div class="col-12 col-md-12 col-lg-6 col-xl-6 text-start"><h2>Testing</h2></div>
        

        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2">
            <div class="row line-stat">
                
                
            </div>
        </div>
        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2 ">
            <div class="row line-stat">
                
                
                    <div class="text-end"><span class="text-add-ignored">+2262</span></div>
                    <div class="text-start"><span class="text-delete-ignored">-306</span></div>
                
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-790255ceb7c5d0fab58ddda0">
        <div><p>Additional or modified tests, not already captured by the above diff</p>
</div>
        <div>
            
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-muted" data-bs-toggle="collapse" href="#id-471ddd66a262c0a8ad782b79" role="button"
                       aria-expanded="false" aria-controls="id-471ddd66a262c0a8ad782b79">
                        <code>accounts/abi/packing_test.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/accounts/abi/packing_test.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/accounts/abi/packing_test.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-add-ignored">+5</span></div>
                            <div class="text-start"><span class="text-delete-ignored">-5</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-471ddd66a262c0a8ad782b79"><span class="term-fg1">diff --git go-ethereum&#47;accounts&#47;abi&#47;packing_test.go op-geth&#47;accounts&#47;abi&#47;packing_test.go</span>
<span class="term-fg1">index eae3b0df20562372b4e739ba0e72559c0d19bd96..9ed52a475eb900f5be20dfe9441ba25ac330defd 100644</span>
<span class="term-fg1">--- go-ethereum&#47;accounts&#47;abi&#47;packing_test.go</span>
<span class="term-fg1">+++ op-geth&#47;accounts&#47;abi&#47;packing_test.go</span>
<span class="term-fg36">@@ -375,7 +375,7 @@</span> 	{
 		def: `[{&quot;type&quot;: &quot;bytes&quot;}]`,
 		packed: &quot;0000000000000000000000000000000000000000000000000000000000000020&quot; +
 			&quot;0000000000000000000000000000000000000000000000000000000000000020&quot; +
<span class="term-fg31">-			&quot;0100000000000000000000000000000000000000000000000000000000000000&quot;,</span>
<span class="term-fg32">+			&quot;0100000000000000000000000000000000000000000000000000000000000000&quot;, &#47;&#47;nolint:all</span>
 		unpacked: common.Hex2Bytes(&quot;0100000000000000000000000000000000000000000000000000000000000000&quot;),
 	},
 	{
<span class="term-fg36">@@ -476,7 +476,7 @@</span> 	{
 		def: `[{&quot;type&quot;: &quot;int256[3]&quot;}]`,
 		packed: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot; +
 			&quot;0000000000000000000000000000000000000000000000000000000000000002&quot; +
<span class="term-fg31">-			&quot;0000000000000000000000000000000000000000000000000000000000000003&quot;,</span>
<span class="term-fg32">+			&quot;0000000000000000000000000000000000000000000000000000000000000003&quot;, &#47;&#47;nolint:all</span>
 		unpacked: [3]*big.Int{big.NewInt(1), big.NewInt(2), big.NewInt(3)},
 	},
 	&#47;&#47; multi dimensional, if these pass, all types that don&#39;t require length prefix should pass
<span class="term-fg36">@@ -536,7 +536,7 @@</span> 	{
 		def: `[{&quot;type&quot;: &quot;uint8[][2]&quot;}]`,
 		packed: &quot;0000000000000000000000000000000000000000000000000000000000000020&quot; +
 			&quot;0000000000000000000000000000000000000000000000000000000000000040&quot; +
<span class="term-fg31">-			&quot;0000000000000000000000000000000000000000000000000000000000000080&quot; +</span>
<span class="term-fg32">+			&quot;0000000000000000000000000000000000000000000000000000000000000080&quot; + &#47;&#47;nolint:all</span>
 			&quot;0000000000000000000000000000000000000000000000000000000000000001&quot; +
 			&quot;0000000000000000000000000000000000000000000000000000000000000001&quot; +
 			&quot;0000000000000000000000000000000000000000000000000000000000000001&quot; +
<span class="term-fg36">@@ -801,7 +801,7 @@</span> 			&quot;0000000000000000000000000000000000000000000000000000000000000002&quot; + &#47;&#47; len(array[0]) = 2
 			&quot;0100000000000000000000000000000000000000000000000000000000000000&quot; + &#47;&#47; array[0][0]
 			&quot;0200000000000000000000000000000000000000000000000000000000000000&quot; + &#47;&#47; array[0][1]
 			&quot;0000000000000000000000000000000000000000000000000000000000000003&quot; + &#47;&#47; len(array[1]) = 3
<span class="term-fg31">-			&quot;0300000000000000000000000000000000000000000000000000000000000000&quot; + &#47;&#47; array[1][0]</span>
<span class="term-fg32">+			&quot;0300000000000000000000000000000000000000000000000000000000000000&quot; + &#47;&#47;nolint:all  &#47;&#47; array[1][0]</span>
 			&quot;0400000000000000000000000000000000000000000000000000000000000000&quot; + &#47;&#47; array[1][1]
 			&quot;0500000000000000000000000000000000000000000000000000000000000000&quot;, &#47;&#47; array[1][2]
 	},
<span class="term-fg36">@@ -845,7 +845,7 @@</span> 			E [2][3][32]byte
 		}{1, big.NewInt(1), big.NewInt(-1), true, [2][3][32]byte{{{1}, {2}, {3}}, {{3}, {4}, {5}}}},
 		packed: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot; + &#47;&#47; struct[a]
 			&quot;0000000000000000000000000000000000000000000000000000000000000001&quot; + &#47;&#47; struct[b]
<span class="term-fg31">-			&quot;ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff&quot; + &#47;&#47; struct[c]</span>
<span class="term-fg32">+			&quot;ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff&quot; + &#47;&#47;nolint:all  &#47;&#47; struct[c]</span>
 			&quot;0000000000000000000000000000000000000000000000000000000000000001&quot; + &#47;&#47; struct[d]
 			&quot;0100000000000000000000000000000000000000000000000000000000000000&quot; + &#47;&#47; struct[e] array[0][0]
 			&quot;0200000000000000000000000000000000000000000000000000000000000000&quot; + &#47;&#47; struct[e] array[0][1]</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-muted" data-bs-toggle="collapse" href="#id-f7a4029001c5d0509ff5c5c1" role="button"
                       aria-expanded="false" aria-controls="id-f7a4029001c5d0509ff5c5c1">
                        <code>consensus/misc/create2deployer_test.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/consensus/misc/create2deployer_test.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-add-ignored">+95</span></div>
                            <div class="text-start"><span class="text-delete-ignored">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-f7a4029001c5d0509ff5c5c1"><span class="term-fg1">diff --git go-ethereum&#47;consensus&#47;misc&#47;create2deployer_test.go op-geth&#47;consensus&#47;misc&#47;create2deployer_test.go</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..fc0ef79fd7739d92431085d515481be8621e8fcb</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ op-geth&#47;consensus&#47;misc&#47;create2deployer_test.go</span>
<span class="term-fg36">@@ -0,0 +1,95 @@</span>
<span class="term-fg32">+package misc</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+import (</span>
<span class="term-fg32">+	&quot;math&#47;big&quot;</span>
<span class="term-fg32">+	&quot;testing&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&quot;github.com&#47;stretchr&#47;testify&#47;assert&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&#47;vm&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;params&quot;</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func TestEnsureCreate2Deployer(t *testing.T) {</span>
<span class="term-fg32">+	canyonTime := uint64(1000)</span>
<span class="term-fg32">+	var tests = []struct {</span>
<span class="term-fg32">+		name       string</span>
<span class="term-fg32">+		override   func(cfg *params.ChainConfig)</span>
<span class="term-fg32">+		timestamp  uint64</span>
<span class="term-fg32">+		codeExists bool</span>
<span class="term-fg32">+		applied    bool</span>
<span class="term-fg32">+	}{</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			name:      &quot;at hardfork&quot;,</span>
<span class="term-fg32">+			timestamp: canyonTime,</span>
<span class="term-fg32">+			applied:   true,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			name: &quot;another chain ID&quot;,</span>
<span class="term-fg32">+			override: func(cfg *params.ChainConfig) {</span>
<span class="term-fg32">+				cfg.ChainID = big.NewInt(params.OPMainnetChainID)</span>
<span class="term-fg32">+			},</span>
<span class="term-fg32">+			timestamp: canyonTime,</span>
<span class="term-fg32">+			applied:   true,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			name:       &quot;code already exists&quot;,</span>
<span class="term-fg32">+			timestamp:  canyonTime,</span>
<span class="term-fg32">+			codeExists: true,</span>
<span class="term-fg32">+			applied:    true,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			name:      &quot;pre canyon&quot;,</span>
<span class="term-fg32">+			timestamp: canyonTime - 1,</span>
<span class="term-fg32">+			applied:   false,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			name:      &quot;post hardfork&quot;,</span>
<span class="term-fg32">+			timestamp: canyonTime + 1,</span>
<span class="term-fg32">+			applied:   false,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			name: &quot;canyon not configured&quot;,</span>
<span class="term-fg32">+			override: func(cfg *params.ChainConfig) {</span>
<span class="term-fg32">+				cfg.CanyonTime = nil</span>
<span class="term-fg32">+			},</span>
<span class="term-fg32">+			timestamp: canyonTime,</span>
<span class="term-fg32">+			applied:   false,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	for _, tt := range tests {</span>
<span class="term-fg32">+		t.Run(tt.name, func(t *testing.T) {</span>
<span class="term-fg32">+			cfg := params.ChainConfig{</span>
<span class="term-fg32">+				ChainID:    big.NewInt(params.BaseMainnetChainID),</span>
<span class="term-fg32">+				Optimism:   &amp;params.OptimismConfig{},</span>
<span class="term-fg32">+				CanyonTime: &amp;canyonTime,</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+			if tt.override != nil {</span>
<span class="term-fg32">+				tt.override(&amp;cfg)</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+			state := &amp;stateDb{</span>
<span class="term-fg32">+				codeExists: tt.codeExists,</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+			EnsureCreate2Deployer(&amp;cfg, tt.timestamp, state)</span>
<span class="term-fg32">+			assert.Equal(t, tt.applied, state.codeSet)</span>
<span class="term-fg32">+		})</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+type stateDb struct {</span>
<span class="term-fg32">+	vm.StateDB</span>
<span class="term-fg32">+	codeExists bool</span>
<span class="term-fg32">+	codeSet    bool</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (s *stateDb) GetCodeSize(_ common.Address) int {</span>
<span class="term-fg32">+	if s.codeExists {</span>
<span class="term-fg32">+		return 1</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	return 0</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (s *stateDb) SetCode(_ common.Address, _ []byte) {</span>
<span class="term-fg32">+	s.codeSet = true</span>
<span class="term-fg32">+}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-muted" data-bs-toggle="collapse" href="#id-3c9bdd1c46c90ca13798dc9b" role="button"
                       aria-expanded="false" aria-controls="id-3c9bdd1c46c90ca13798dc9b">
                        <code>consensus/misc/eip1559/eip1559_test.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/consensus/misc/eip1559/eip1559_test.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/consensus/misc/eip1559/eip1559_test.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-add-ignored">+48</span></div>
                            <div class="text-start"><span class="text-delete-ignored">-1</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-3c9bdd1c46c90ca13798dc9b"><span class="term-fg1">diff --git go-ethereum&#47;consensus&#47;misc&#47;eip1559&#47;eip1559_test.go op-geth&#47;consensus&#47;misc&#47;eip1559&#47;eip1559_test.go</span>
<span class="term-fg1">index b5afdf0fe5e56ca6ced6031be233c6aafb17dcdd..39766b57cc18f9e1e433495cff8183cd7e0984b4 100644</span>
<span class="term-fg1">--- go-ethereum&#47;consensus&#47;misc&#47;eip1559&#47;eip1559_test.go</span>
<span class="term-fg1">+++ op-geth&#47;consensus&#47;misc&#47;eip1559&#47;eip1559_test.go</span>
<span class="term-fg36">@@ -55,6 +55,20 @@</span> 	config.LondonBlock = big.NewInt(5)
 	return config
 }
&nbsp;
<span class="term-fg32">+func opConfig() *params.ChainConfig {</span>
<span class="term-fg32">+	config := copyConfig(params.TestChainConfig)</span>
<span class="term-fg32">+	config.LondonBlock = big.NewInt(5)</span>
<span class="term-fg32">+	ct := uint64(10)</span>
<span class="term-fg32">+	eip1559DenominatorCanyon := uint64(250)</span>
<span class="term-fg32">+	config.CanyonTime = &amp;ct</span>
<span class="term-fg32">+	config.Optimism = &amp;params.OptimismConfig{</span>
<span class="term-fg32">+		EIP1559Elasticity:        6,</span>
<span class="term-fg32">+		EIP1559Denominator:       50,</span>
<span class="term-fg32">+		EIP1559DenominatorCanyon: &amp;eip1559DenominatorCanyon,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	return config</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
 &#47;&#47; TestBlockGasLimits tests the gasLimit checks for blocks both across
 &#47;&#47; the EIP-1559 boundary and post-1559 blocks
 func TestBlockGasLimits(t *testing.T) {
<span class="term-fg36">@@ -124,7 +138,40 @@</span> 			GasLimit: test.parentGasLimit,
 			GasUsed:  test.parentGasUsed,
 			BaseFee:  big.NewInt(test.parentBaseFee),
 		}
<span class="term-fg31">-		if have, want := CalcBaseFee(config(), parent), big.NewInt(test.expectedBaseFee); have.Cmp(want) != 0 {</span>
<span class="term-fg32">+		if have, want := CalcBaseFee(config(), parent, 0), big.NewInt(test.expectedBaseFee); have.Cmp(want) != 0 {</span>
<span class="term-fg32">+			t.Errorf(&quot;test %d: have %d  want %d, &quot;, i, have, want)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; TestCalcBaseFeeOptimism assumes all blocks are 1559-blocks but tests the Canyon activation</span>
<span class="term-fg32">+func TestCalcBaseFeeOptimism(t *testing.T) {</span>
<span class="term-fg32">+	tests := []struct {</span>
<span class="term-fg32">+		parentBaseFee   int64</span>
<span class="term-fg32">+		parentGasLimit  uint64</span>
<span class="term-fg32">+		parentGasUsed   uint64</span>
<span class="term-fg32">+		expectedBaseFee int64</span>
<span class="term-fg32">+		postCanyon      bool</span>
<span class="term-fg32">+	}{</span>
<span class="term-fg32">+		{params.InitialBaseFee, 30_000_000, 5_000_000, params.InitialBaseFee, false}, &#47;&#47; usage == target</span>
<span class="term-fg32">+		{params.InitialBaseFee, 30_000_000, 4_000_000, 996000000, false},             &#47;&#47; usage below target</span>
<span class="term-fg32">+		{params.InitialBaseFee, 30_000_000, 10_000_000, 1020000000, false},           &#47;&#47; usage above target</span>
<span class="term-fg32">+		{params.InitialBaseFee, 30_000_000, 5_000_000, params.InitialBaseFee, true},  &#47;&#47; usage == target</span>
<span class="term-fg32">+		{params.InitialBaseFee, 30_000_000, 4_000_000, 999200000, true},              &#47;&#47; usage below target</span>
<span class="term-fg32">+		{params.InitialBaseFee, 30_000_000, 10_000_000, 1004000000, true},            &#47;&#47; usage above target</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	for i, test := range tests {</span>
<span class="term-fg32">+		parent := &amp;types.Header{</span>
<span class="term-fg32">+			Number:   common.Big32,</span>
<span class="term-fg32">+			GasLimit: test.parentGasLimit,</span>
<span class="term-fg32">+			GasUsed:  test.parentGasUsed,</span>
<span class="term-fg32">+			BaseFee:  big.NewInt(test.parentBaseFee),</span>
<span class="term-fg32">+			Time:     6,</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		if test.postCanyon {</span>
<span class="term-fg32">+			parent.Time = 8</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		if have, want := CalcBaseFee(opConfig(), parent, parent.Time+2), big.NewInt(test.expectedBaseFee); have.Cmp(want) != 0 {</span>
 			t.Errorf(&quot;test %d: have %d  want %d, &quot;, i, have, want)
 		}
 	}</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-muted" data-bs-toggle="collapse" href="#id-d25465d94853858e21ed379c" role="button"
                       aria-expanded="false" aria-controls="id-d25465d94853858e21ed379c">
                        <code>core/rawdb/accessors_chain_test.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/core/rawdb/accessors_chain_test.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/core/rawdb/accessors_chain_test.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-add-ignored">+79</span></div>
                            <div class="text-start"><span class="text-delete-ignored">-22</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-d25465d94853858e21ed379c"><span class="term-fg1">diff --git go-ethereum&#47;core&#47;rawdb&#47;accessors_chain_test.go op-geth&#47;core&#47;rawdb&#47;accessors_chain_test.go</span>
<span class="term-fg1">index 2d30af4b3d20d43f9b8b011cb5de251347fe3a1b..cf6cac6d075add43ca657be445001dd80a10204b 100644</span>
<span class="term-fg1">--- go-ethereum&#47;core&#47;rawdb&#47;accessors_chain_test.go</span>
<span class="term-fg1">+++ op-geth&#47;core&#47;rawdb&#47;accessors_chain_test.go</span>
<span class="term-fg36">@@ -27,10 +27,12 @@</span> 	&quot;reflect&quot;
 	&quot;testing&quot;
&nbsp;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&quot;
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&#47;math&quot;</span>
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&#47;types&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;crypto&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;params&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;rlp&quot;
<span class="term-fg32">+	&quot;github.com&#47;stretchr&#47;testify&#47;require&quot;</span>
 	&quot;golang.org&#47;x&#47;crypto&#47;sha3&quot;
 )
&nbsp;
<span class="term-fg36">@@ -347,6 +349,9 @@</span> 	&#47;&#47; Create a live block since we need metadata to reconstruct the receipt
 	tx1 := types.NewTransaction(1, common.HexToAddress(&quot;0x1&quot;), big.NewInt(1), 1, big.NewInt(1), nil)
 	tx2 := types.NewTransaction(2, common.HexToAddress(&quot;0x2&quot;), big.NewInt(2), 2, big.NewInt(2), nil)
&nbsp;
<span class="term-fg32">+	header := &amp;types.Header{</span>
<span class="term-fg32">+		Number: big.NewInt(0),</span>
<span class="term-fg32">+	}</span>
 	body := &amp;types.Body{Transactions: types.Transactions{tx1, tx2}}
&nbsp;
 	&#47;&#47; Create the two receipts to manage afterwards
<span class="term-fg36">@@ -378,13 +383,16 @@</span> 	receipt2.Bloom = types.CreateBloom(types.Receipts{receipt2})
 	receipts := []*types.Receipt{receipt1, receipt2}
&nbsp;
 	&#47;&#47; Check that no receipt entries are in a pristine database
<span class="term-fg31">-	hash := common.BytesToHash([]byte{0x03, 0x14})</span>
<span class="term-fg32">+	hash := header.Hash()</span>
 	if rs := ReadReceipts(db, hash, 0, 0, params.TestChainConfig); len(rs) != 0 {
 		t.Fatalf(&quot;non existent receipts returned: %v&quot;, rs)
 	}
 	&#47;&#47; Insert the body that corresponds to the receipts
 	WriteBody(db, hash, 0, body)
&nbsp;
<span class="term-fg32">+	&#47;&#47; Insert the header that corresponds to the receipts</span>
<span class="term-fg32">+	WriteHeader(db, header)</span>
<span class="term-fg32">+</span>
 	&#47;&#47; Insert the receipt slice into the database and check presence
 	WriteReceipts(db, hash, 0, receipts)
 	if rs := ReadReceipts(db, hash, 0, 0, params.TestChainConfig); len(rs) == 0 {
<span class="term-fg36">@@ -694,36 +702,56 @@</span>
 	&#47;&#47; Create a live block since we need metadata to reconstruct the receipt
 	tx1 := types.NewTransaction(1, common.HexToAddress(&quot;0x1&quot;), big.NewInt(1), 1, big.NewInt(1), nil)
 	tx2 := types.NewTransaction(2, common.HexToAddress(&quot;0x2&quot;), big.NewInt(2), 2, big.NewInt(2), nil)
<span class="term-fg32">+	tx3 := types.NewTransaction(3, common.HexToAddress(&quot;0x3&quot;), big.NewInt(3), 3, big.NewInt(3), nil)</span>
&nbsp;
<span class="term-fg31">-	body := &amp;types.Body{Transactions: types.Transactions{tx1, tx2}}</span>
<span class="term-fg32">+	body := &amp;types.Body{Transactions: types.Transactions{tx1, tx2, tx3}}</span>
&nbsp;
<span class="term-fg31">-	&#47;&#47; Create the two receipts to manage afterwards</span>
<span class="term-fg31">-	receipt1 := &amp;types.Receipt{</span>
<span class="term-fg32">+	&#47;&#47; Create the three receipts to manage afterwards</span>
<span class="term-fg32">+	depositNonce := uint64(math.MaxUint64)</span>
<span class="term-fg32">+	depositReceipt := types.Receipt{</span>
 		Status:            types.ReceiptStatusFailed,
 		CumulativeGasUsed: 1,
 		Logs: []*types.Log{
 			{Address: common.BytesToAddress([]byte{0x11})},
 			{Address: common.BytesToAddress([]byte{0x01, 0x11})},
 		},
<span class="term-fg31">-		TxHash:          tx1.Hash(),</span>
<span class="term-fg31">-		ContractAddress: common.BytesToAddress([]byte{0x01, 0x11, 0x11}),</span>
<span class="term-fg31">-		GasUsed:         111111,</span>
<span class="term-fg32">+		TxHash:                tx1.Hash(),</span>
<span class="term-fg32">+		ContractAddress:       common.BytesToAddress([]byte{0x01, 0x11, 0x11}),</span>
<span class="term-fg32">+		GasUsed:               111111,</span>
<span class="term-fg32">+		DepositNonce:          &amp;depositNonce,</span>
<span class="term-fg32">+		DepositReceiptVersion: nil,</span>
 	}
<span class="term-fg31">-	receipt1.Bloom = types.CreateBloom(types.Receipts{receipt1})</span>
<span class="term-fg32">+	depositReceipt.Bloom = types.CreateBloom(types.Receipts{&amp;depositReceipt})</span>
&nbsp;
<span class="term-fg31">-	receipt2 := &amp;types.Receipt{</span>
<span class="term-fg31">-		PostState:         common.Hash{2}.Bytes(),</span>
<span class="term-fg32">+	receiptVersion := types.CanyonDepositReceiptVersion</span>
<span class="term-fg32">+	versionedDepositReceipt := types.Receipt{</span>
<span class="term-fg32">+		Status:            types.ReceiptStatusFailed,</span>
 		CumulativeGasUsed: 2,
 		Logs: []*types.Log{
 			{Address: common.BytesToAddress([]byte{0x22})},
<span class="term-fg31">-			{Address: common.BytesToAddress([]byte{0x02, 0x22})},</span>
<span class="term-fg32">+			{Address: common.BytesToAddress([]byte{0x01, 0x11})},</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		TxHash:                tx2.Hash(),</span>
<span class="term-fg32">+		ContractAddress:       common.BytesToAddress([]byte{0x02, 0x22, 0x22}),</span>
<span class="term-fg32">+		GasUsed:               222222,</span>
<span class="term-fg32">+		DepositNonce:          &amp;depositNonce,</span>
<span class="term-fg32">+		DepositReceiptVersion: &amp;receiptVersion,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	versionedDepositReceipt.Bloom = types.CreateBloom(types.Receipts{&amp;versionedDepositReceipt})</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	receipt := types.Receipt{</span>
<span class="term-fg32">+		PostState:         common.Hash{3}.Bytes(),</span>
<span class="term-fg32">+		CumulativeGasUsed: 3,</span>
<span class="term-fg32">+		Logs: []*types.Log{</span>
<span class="term-fg32">+			{Address: common.BytesToAddress([]byte{0x33})},</span>
<span class="term-fg32">+			{Address: common.BytesToAddress([]byte{0x03, 0x33})},</span>
 		},
<span class="term-fg31">-		TxHash:          tx2.Hash(),</span>
<span class="term-fg31">-		ContractAddress: common.BytesToAddress([]byte{0x02, 0x22, 0x22}),</span>
<span class="term-fg31">-		GasUsed:         222222,</span>
<span class="term-fg32">+		TxHash:          tx3.Hash(),</span>
<span class="term-fg32">+		ContractAddress: common.BytesToAddress([]byte{0x03, 0x33, 0x33}),</span>
<span class="term-fg32">+		GasUsed:         333333,</span>
 	}
<span class="term-fg31">-	receipt2.Bloom = types.CreateBloom(types.Receipts{receipt2})</span>
<span class="term-fg31">-	receipts := []*types.Receipt{receipt1, receipt2}</span>
<span class="term-fg32">+	receipt.Bloom = types.CreateBloom(types.Receipts{&amp;receipt})</span>
<span class="term-fg32">+	receipts := []*types.Receipt{&amp;receipt, &amp;depositReceipt, &amp;versionedDepositReceipt}</span>
&nbsp;
 	hash := common.BytesToHash([]byte{0x03, 0x14})
 	&#47;&#47; Check that no receipt entries are in a pristine database
<span class="term-fg36">@@ -740,14 +768,13 @@</span> 	logs := ReadLogs(db, hash, 0)
 	if len(logs) == 0 {
 		t.Fatalf(&quot;no logs returned&quot;)
 	}
<span class="term-fg31">-	if have, want := len(logs), 2; have != want {</span>
<span class="term-fg32">+	if have, want := len(logs), 3; have != want {</span>
 		t.Fatalf(&quot;unexpected number of logs returned, have %d want %d&quot;, have, want)
 	}
<span class="term-fg31">-	if have, want := len(logs[0]), 2; have != want {</span>
<span class="term-fg31">-		t.Fatalf(&quot;unexpected number of logs[0] returned, have %d want %d&quot;, have, want)</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-	if have, want := len(logs[1]), 2; have != want {</span>
<span class="term-fg31">-		t.Fatalf(&quot;unexpected number of logs[1] returned, have %d want %d&quot;, have, want)</span>
<span class="term-fg32">+	for i := range logs {</span>
<span class="term-fg32">+		if have, want := len(logs[i]), 2; have != want {</span>
<span class="term-fg32">+			t.Fatalf(&quot;unexpected number of logs[%d] returned, have %d want %d&quot;, i, have, want)</span>
<span class="term-fg32">+		}</span>
 	}
&nbsp;
 	for i, pr := range receipts {
<span class="term-fg36">@@ -765,6 +792,36 @@</span> 				t.Fatalf(&quot;receipt #%d: receipt mismatch: have %s, want %s&quot;, i, hex.EncodeToString(rlpHave), hex.EncodeToString(rlpWant))
 			}
 		}
 	}
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func TestParseLegacyReceiptRLP(t *testing.T) {</span>
<span class="term-fg32">+	&#47;&#47; Create a gasUsed value greater than a uint64 can represent</span>
<span class="term-fg32">+	gasUsed := big.NewInt(0)</span>
<span class="term-fg32">+	gasUsed = gasUsed.SetUint64(math.MaxUint64)</span>
<span class="term-fg32">+	gasUsed = gasUsed.Add(gasUsed, big.NewInt(math.MaxInt64))</span>
<span class="term-fg32">+	sanityCheck := (&amp;big.Int{}).SetUint64(gasUsed.Uint64())</span>
<span class="term-fg32">+	require.NotEqual(t, gasUsed, sanityCheck)</span>
<span class="term-fg32">+	receipt := types.LegacyOptimismStoredReceiptRLP{</span>
<span class="term-fg32">+		CumulativeGasUsed: 1,</span>
<span class="term-fg32">+		Logs: []*types.LogForStorage{</span>
<span class="term-fg32">+			{Address: common.BytesToAddress([]byte{0x11})},</span>
<span class="term-fg32">+			{Address: common.BytesToAddress([]byte{0x01, 0x11})},</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		L1GasUsed:  gasUsed,</span>
<span class="term-fg32">+		L1GasPrice: gasUsed,</span>
<span class="term-fg32">+		L1Fee:      gasUsed,</span>
<span class="term-fg32">+		FeeScalar:  &quot;6&quot;,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	data, err := rlp.EncodeToBytes(receipt)</span>
<span class="term-fg32">+	require.NoError(t, err)</span>
<span class="term-fg32">+	var result storedReceiptRLP</span>
<span class="term-fg32">+	err = rlp.DecodeBytes(data, &amp;result)</span>
<span class="term-fg32">+	require.NoError(t, err)</span>
<span class="term-fg32">+	require.Equal(t, receipt.L1GasUsed, result.L1GasUsed)</span>
<span class="term-fg32">+	require.Equal(t, receipt.L1GasPrice, result.L1GasPrice)</span>
<span class="term-fg32">+	require.Equal(t, receipt.L1Fee, result.L1Fee)</span>
<span class="term-fg32">+	require.Equal(t, receipt.FeeScalar, result.FeeScalar)</span>
 }
&nbsp;
 func TestDeriveLogFields(t *testing.T) {</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-muted" data-bs-toggle="collapse" href="#id-b1ea484cc77c25f287170cda" role="button"
                       aria-expanded="false" aria-controls="id-b1ea484cc77c25f287170cda">
                        <code>core/state_processor_test.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/core/state_processor_test.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/core/state_processor_test.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-add-ignored">+1</span></div>
                            <div class="text-start"><span class="text-delete-ignored">-1</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-b1ea484cc77c25f287170cda"><span class="term-fg1">diff --git go-ethereum&#47;core&#47;state_processor_test.go op-geth&#47;core&#47;state_processor_test.go</span>
<span class="term-fg1">index af4d29b604da0acb99327d2cf7ae577cfa7e7102..fc47cd09693b7acf061272eb444f30bd5aca37f4 100644</span>
<span class="term-fg1">--- go-ethereum&#47;core&#47;state_processor_test.go</span>
<span class="term-fg1">+++ op-geth&#47;core&#47;state_processor_test.go</span>
<span class="term-fg36">@@ -379,7 +379,7 @@</span> 		Time:       parent.Time() + 10,
 		UncleHash:  types.EmptyUncleHash,
 	}
 	if config.IsLondon(header.Number) {
<span class="term-fg31">-		header.BaseFee = eip1559.CalcBaseFee(config, parent.Header())</span>
<span class="term-fg32">+		header.BaseFee = eip1559.CalcBaseFee(config, parent.Header(), header.Time)</span>
 	}
 	if config.IsShanghai(header.Number, header.Time) {
 		header.WithdrawalsHash = &amp;types.EmptyWithdrawalsHash</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-muted" data-bs-toggle="collapse" href="#id-147f1632eea3e6b6c4e7cc6b" role="button"
                       aria-expanded="false" aria-controls="id-147f1632eea3e6b6c4e7cc6b">
                        <code>core/superchain_test.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/core/superchain_test.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-add-ignored">+101</span></div>
                            <div class="text-start"><span class="text-delete-ignored">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-147f1632eea3e6b6c4e7cc6b"><span class="term-fg1">diff --git go-ethereum&#47;core&#47;superchain_test.go op-geth&#47;core&#47;superchain_test.go</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..6ed8d8ad33933a52357ff5df6b35c4c9c01957c6</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ op-geth&#47;core&#47;superchain_test.go</span>
<span class="term-fg36">@@ -0,0 +1,101 @@</span>
<span class="term-fg32">+package core</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+import (</span>
<span class="term-fg32">+	&quot;testing&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum-optimism&#47;superchain-registry&#47;superchain&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&#47;rawdb&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;triedb&quot;</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func TestOPStackGenesis(t *testing.T) {</span>
<span class="term-fg32">+	for id := range superchain.OPChains {</span>
<span class="term-fg32">+		_, err := LoadOPStackGenesis(id)</span>
<span class="term-fg32">+		if err != nil {</span>
<span class="term-fg32">+			t.Error(err)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func TestRegistryChainConfigOverride(t *testing.T) {</span>
<span class="term-fg32">+	var tests = []struct {</span>
<span class="term-fg32">+		name                 string</span>
<span class="term-fg32">+		overrides            *ChainOverrides</span>
<span class="term-fg32">+		setDenominator       *uint64</span>
<span class="term-fg32">+		expectedDenominator  uint64</span>
<span class="term-fg32">+		expectedRegolithTime *uint64</span>
<span class="term-fg32">+	}{</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			name:                 &quot;ApplySuperchainUpgrades&quot;,</span>
<span class="term-fg32">+			overrides:            &amp;ChainOverrides{ApplySuperchainUpgrades: true},</span>
<span class="term-fg32">+			setDenominator:       uint64ptr(50),</span>
<span class="term-fg32">+			expectedDenominator:  250,</span>
<span class="term-fg32">+			expectedRegolithTime: uint64ptr(0),</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			name:                 &quot;OverrideOptimismCanyon_denom_nil&quot;,</span>
<span class="term-fg32">+			overrides:            &amp;ChainOverrides{OverrideOptimismCanyon: uint64ptr(1)},</span>
<span class="term-fg32">+			setDenominator:       nil,</span>
<span class="term-fg32">+			expectedDenominator:  250,</span>
<span class="term-fg32">+			expectedRegolithTime: nil,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			name:                 &quot;OverrideOptimismCanyon_denom_0&quot;,</span>
<span class="term-fg32">+			overrides:            &amp;ChainOverrides{OverrideOptimismCanyon: uint64ptr(1)},</span>
<span class="term-fg32">+			setDenominator:       uint64ptr(0),</span>
<span class="term-fg32">+			expectedDenominator:  250,</span>
<span class="term-fg32">+			expectedRegolithTime: nil,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			name:                 &quot;OverrideOptimismCanyon_ignore_override&quot;,</span>
<span class="term-fg32">+			overrides:            &amp;ChainOverrides{OverrideOptimismCanyon: uint64ptr(1)},</span>
<span class="term-fg32">+			setDenominator:       uint64ptr(100),</span>
<span class="term-fg32">+			expectedDenominator:  100,</span>
<span class="term-fg32">+			expectedRegolithTime: nil,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	for _, tt := range tests {</span>
<span class="term-fg32">+		tt := tt</span>
<span class="term-fg32">+		t.Run(tt.name, func(t *testing.T) {</span>
<span class="term-fg32">+			t.Parallel()</span>
<span class="term-fg32">+			db := rawdb.NewMemoryDatabase()</span>
<span class="term-fg32">+			genesis, err := LoadOPStackGenesis(10)</span>
<span class="term-fg32">+			if err != nil {</span>
<span class="term-fg32">+				t.Fatal(err)</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+			if genesis.Config.RegolithTime == nil {</span>
<span class="term-fg32">+				t.Fatal(&quot;expected non-nil regolith time&quot;)</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+			genesis.Config.RegolithTime = nil</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+			&#47;&#47; initialize the DB</span>
<span class="term-fg32">+			tdb := triedb.NewDatabase(db, newDbConfig(rawdb.PathScheme))</span>
<span class="term-fg32">+			genesis.MustCommit(db, tdb)</span>
<span class="term-fg32">+			bl := genesis.ToBlock()</span>
<span class="term-fg32">+			rawdb.WriteCanonicalHash(db, bl.Hash(), 0)</span>
<span class="term-fg32">+			rawdb.WriteBlock(db, bl)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+			genesis.Config.Optimism.EIP1559DenominatorCanyon = tt.setDenominator</span>
<span class="term-fg32">+			&#47;&#47; create chain config, even with incomplete genesis input: the chain config should be corrected</span>
<span class="term-fg32">+			chainConfig, _, err := SetupGenesisBlockWithOverride(db, tdb, genesis, tt.overrides)</span>
<span class="term-fg32">+			if err != nil {</span>
<span class="term-fg32">+				t.Fatal(err)</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+			&#47;&#47; check if we have a corrected chain config</span>
<span class="term-fg32">+			if tt.expectedRegolithTime == nil {</span>
<span class="term-fg32">+				if chainConfig.RegolithTime != nil {</span>
<span class="term-fg32">+					t.Fatal(&quot;expected regolith time to be nil&quot;)</span>
<span class="term-fg32">+				}</span>
<span class="term-fg32">+			} else if *chainConfig.RegolithTime != *tt.expectedRegolithTime {</span>
<span class="term-fg32">+				t.Fatalf(&quot;expected regolith time to be %d, but got %d&quot;, *tt.expectedRegolithTime, *chainConfig.RegolithTime)</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+			if *chainConfig.Optimism.EIP1559DenominatorCanyon != tt.expectedDenominator {</span>
<span class="term-fg32">+				t.Fatalf(&quot;expected EIP1559DenominatorCanyon to be %d, but got %d&quot;, tt.expectedDenominator, *chainConfig.Optimism.EIP1559DenominatorCanyon)</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+		})</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-muted" data-bs-toggle="collapse" href="#id-d808c22a4d65902ca80654f8" role="button"
                       aria-expanded="false" aria-controls="id-d808c22a4d65902ca80654f8">
                        <code>core/types/receipt_test.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/core/types/receipt_test.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/core/types/receipt_test.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-add-ignored">+538</span></div>
                            <div class="text-start"><span class="text-delete-ignored">-6</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-d808c22a4d65902ca80654f8"><span class="term-fg1">diff --git go-ethereum&#47;core&#47;types&#47;receipt_test.go op-geth&#47;core&#47;types&#47;receipt_test.go</span>
<span class="term-fg1">index fc51eb11a528caea6627d1a6ff49705c00615292..76599fdd323980c098bca80d62393ec0bd945dae 100644</span>
<span class="term-fg1">--- go-ethereum&#47;core&#47;types&#47;receipt_test.go</span>
<span class="term-fg1">+++ op-geth&#47;core&#47;types&#47;receipt_test.go</span>
<span class="term-fg36">@@ -19,6 +19,7 @@</span>
 import (
 	&quot;bytes&quot;
 	&quot;encoding&#47;json&quot;
<span class="term-fg32">+	&quot;fmt&quot;</span>
 	&quot;math&quot;
 	&quot;math&#47;big&quot;
 	&quot;reflect&quot;
<span class="term-fg36">@@ -29,9 +30,25 @@</span> 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;params&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;rlp&quot;
 	&quot;github.com&#47;holiman&#47;uint256&quot;
 	&quot;github.com&#47;kylelemons&#47;godebug&#47;diff&quot;
<span class="term-fg32">+	&quot;github.com&#47;stretchr&#47;testify&#47;require&quot;</span>
 )
&nbsp;
 var (
<span class="term-fg32">+	bedrockGenesisTestConfig = func() *params.ChainConfig {</span>
<span class="term-fg32">+		conf := *params.AllCliqueProtocolChanges &#47;&#47; copy the config</span>
<span class="term-fg32">+		conf.Clique = nil</span>
<span class="term-fg32">+		conf.TerminalTotalDifficultyPassed = true</span>
<span class="term-fg32">+		conf.BedrockBlock = big.NewInt(0)</span>
<span class="term-fg32">+		conf.Optimism = &amp;params.OptimismConfig{EIP1559Elasticity: 50, EIP1559Denominator: 10}</span>
<span class="term-fg32">+		return &amp;conf</span>
<span class="term-fg32">+	}()</span>
<span class="term-fg32">+	ecotoneTestConfig = func() *params.ChainConfig {</span>
<span class="term-fg32">+		conf := *bedrockGenesisTestConfig &#47;&#47; copy the config</span>
<span class="term-fg32">+		time := uint64(0)</span>
<span class="term-fg32">+		conf.EcotoneTime = &amp;time</span>
<span class="term-fg32">+		return &amp;conf</span>
<span class="term-fg32">+	}()</span>
<span class="term-fg32">+</span>
 	legacyReceipt = &amp;Receipt{
 		Status:            ReceiptStatusFailed,
 		CumulativeGasUsed: 1,
<span class="term-fg36">@@ -82,6 +99,63 @@</span> 			},
 		},
 		Type: DynamicFeeTxType,
 	}
<span class="term-fg32">+	depositReceiptNoNonce = &amp;Receipt{</span>
<span class="term-fg32">+		Status:            ReceiptStatusFailed,</span>
<span class="term-fg32">+		CumulativeGasUsed: 1,</span>
<span class="term-fg32">+		Logs: []*Log{</span>
<span class="term-fg32">+			{</span>
<span class="term-fg32">+				Address: common.BytesToAddress([]byte{0x11}),</span>
<span class="term-fg32">+				Topics:  []common.Hash{common.HexToHash(&quot;dead&quot;), common.HexToHash(&quot;beef&quot;)},</span>
<span class="term-fg32">+				Data:    []byte{0x01, 0x00, 0xff},</span>
<span class="term-fg32">+			},</span>
<span class="term-fg32">+			{</span>
<span class="term-fg32">+				Address: common.BytesToAddress([]byte{0x01, 0x11}),</span>
<span class="term-fg32">+				Topics:  []common.Hash{common.HexToHash(&quot;dead&quot;), common.HexToHash(&quot;beef&quot;)},</span>
<span class="term-fg32">+				Data:    []byte{0x01, 0x00, 0xff},</span>
<span class="term-fg32">+			},</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		Type: DepositTxType,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	nonce                   = uint64(1234)</span>
<span class="term-fg32">+	depositReceiptWithNonce = &amp;Receipt{</span>
<span class="term-fg32">+		Status:                ReceiptStatusFailed,</span>
<span class="term-fg32">+		CumulativeGasUsed:     1,</span>
<span class="term-fg32">+		DepositNonce:          &amp;nonce,</span>
<span class="term-fg32">+		DepositReceiptVersion: nil,</span>
<span class="term-fg32">+		Logs: []*Log{</span>
<span class="term-fg32">+			{</span>
<span class="term-fg32">+				Address: common.BytesToAddress([]byte{0x11}),</span>
<span class="term-fg32">+				Topics:  []common.Hash{common.HexToHash(&quot;dead&quot;), common.HexToHash(&quot;beef&quot;)},</span>
<span class="term-fg32">+				Data:    []byte{0x01, 0x00, 0xff},</span>
<span class="term-fg32">+			},</span>
<span class="term-fg32">+			{</span>
<span class="term-fg32">+				Address: common.BytesToAddress([]byte{0x01, 0x11}),</span>
<span class="term-fg32">+				Topics:  []common.Hash{common.HexToHash(&quot;dead&quot;), common.HexToHash(&quot;beef&quot;)},</span>
<span class="term-fg32">+				Data:    []byte{0x01, 0x00, 0xff},</span>
<span class="term-fg32">+			},</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		Type: DepositTxType,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	version                           = CanyonDepositReceiptVersion</span>
<span class="term-fg32">+	depositReceiptWithNonceAndVersion = &amp;Receipt{</span>
<span class="term-fg32">+		Status:                ReceiptStatusFailed,</span>
<span class="term-fg32">+		CumulativeGasUsed:     1,</span>
<span class="term-fg32">+		DepositNonce:          &amp;nonce,</span>
<span class="term-fg32">+		DepositReceiptVersion: &amp;version,</span>
<span class="term-fg32">+		Logs: []*Log{</span>
<span class="term-fg32">+			{</span>
<span class="term-fg32">+				Address: common.BytesToAddress([]byte{0x11}),</span>
<span class="term-fg32">+				Topics:  []common.Hash{common.HexToHash(&quot;dead&quot;), common.HexToHash(&quot;beef&quot;)},</span>
<span class="term-fg32">+				Data:    []byte{0x01, 0x00, 0xff},</span>
<span class="term-fg32">+			},</span>
<span class="term-fg32">+			{</span>
<span class="term-fg32">+				Address: common.BytesToAddress([]byte{0x01, 0x11}),</span>
<span class="term-fg32">+				Topics:  []common.Hash{common.HexToHash(&quot;dead&quot;), common.HexToHash(&quot;beef&quot;)},</span>
<span class="term-fg32">+				Data:    []byte{0x01, 0x00, 0xff},</span>
<span class="term-fg32">+			},</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		Type: DepositTxType,</span>
<span class="term-fg32">+	}</span>
&nbsp;
 	&#47;&#47; Create a few transactions to have receipts for
 	to2 = common.HexToAddress(&quot;0x2&quot;)
<span class="term-fg36">@@ -149,11 +223,23 @@</span> 			GasFeeCap:  uint256.NewInt(1077),
 			BlobFeeCap: uint256.NewInt(100077),
 			BlobHashes: []common.Hash{{}, {}, {}},
 		}),
<span class="term-fg32">+		NewTx(&amp;DepositTx{</span>
<span class="term-fg32">+			To:    nil, &#47;&#47; contract creation</span>
<span class="term-fg32">+			Value: big.NewInt(6),</span>
<span class="term-fg32">+			Gas:   50,</span>
<span class="term-fg32">+		}),</span>
<span class="term-fg32">+		NewTx(&amp;DepositTx{</span>
<span class="term-fg32">+			To:    nil, &#47;&#47; contract creation</span>
<span class="term-fg32">+			Value: big.NewInt(6),</span>
<span class="term-fg32">+			Gas:   60,</span>
<span class="term-fg32">+		}),</span>
 	}
<span class="term-fg31">-</span>
<span class="term-fg31">-	blockNumber = big.NewInt(1)</span>
<span class="term-fg31">-	blockTime   = uint64(2)</span>
<span class="term-fg31">-	blockHash   = common.BytesToHash([]byte{0x03, 0x14})</span>
<span class="term-fg32">+	depNonce1                   = uint64(7)</span>
<span class="term-fg32">+	depNonce2                   = uint64(8)</span>
<span class="term-fg32">+	blockNumber                 = big.NewInt(1)</span>
<span class="term-fg32">+	blockTime                   = uint64(2)</span>
<span class="term-fg32">+	blockHash                   = common.BytesToHash([]byte{0x03, 0x14})</span>
<span class="term-fg32">+	canyonDepositReceiptVersion = CanyonDepositReceiptVersion</span>
&nbsp;
 	&#47;&#47; Create the corresponding receipts
 	receipts = Receipts{
<span class="term-fg36">@@ -293,6 +379,78 @@</span> 			BlockHash:         blockHash,
 			BlockNumber:       blockNumber,
 			TransactionIndex:  6,
 		},
<span class="term-fg32">+		&amp;Receipt{</span>
<span class="term-fg32">+			Type:              DepositTxType,</span>
<span class="term-fg32">+			PostState:         common.Hash{5}.Bytes(),</span>
<span class="term-fg32">+			CumulativeGasUsed: 50 + 28,</span>
<span class="term-fg32">+			Logs: []*Log{</span>
<span class="term-fg32">+				{</span>
<span class="term-fg32">+					Address: common.BytesToAddress([]byte{0x33}),</span>
<span class="term-fg32">+					Topics:  []common.Hash{common.HexToHash(&quot;dead&quot;), common.HexToHash(&quot;beef&quot;)},</span>
<span class="term-fg32">+					&#47;&#47; derived fields:</span>
<span class="term-fg32">+					BlockNumber: blockNumber.Uint64(),</span>
<span class="term-fg32">+					TxHash:      txs[7].Hash(),</span>
<span class="term-fg32">+					TxIndex:     7,</span>
<span class="term-fg32">+					BlockHash:   blockHash,</span>
<span class="term-fg32">+					Index:       4,</span>
<span class="term-fg32">+				},</span>
<span class="term-fg32">+				{</span>
<span class="term-fg32">+					Address: common.BytesToAddress([]byte{0x03, 0x33}),</span>
<span class="term-fg32">+					Topics:  []common.Hash{common.HexToHash(&quot;dead&quot;), common.HexToHash(&quot;beef&quot;)},</span>
<span class="term-fg32">+					&#47;&#47; derived fields:</span>
<span class="term-fg32">+					BlockNumber: blockNumber.Uint64(),</span>
<span class="term-fg32">+					TxHash:      txs[7].Hash(),</span>
<span class="term-fg32">+					TxIndex:     7,</span>
<span class="term-fg32">+					BlockHash:   blockHash,</span>
<span class="term-fg32">+					Index:       5,</span>
<span class="term-fg32">+				},</span>
<span class="term-fg32">+			},</span>
<span class="term-fg32">+			TxHash:                txs[7].Hash(),</span>
<span class="term-fg32">+			ContractAddress:       common.HexToAddress(&quot;0x3bb898b4bbe24f68a4e9be46cfe72d1787fd74f4&quot;),</span>
<span class="term-fg32">+			GasUsed:               50,</span>
<span class="term-fg32">+			EffectiveGasPrice:     big.NewInt(0),</span>
<span class="term-fg32">+			BlockHash:             blockHash,</span>
<span class="term-fg32">+			BlockNumber:           blockNumber,</span>
<span class="term-fg32">+			TransactionIndex:      7,</span>
<span class="term-fg32">+			DepositNonce:          &amp;depNonce1,</span>
<span class="term-fg32">+			DepositReceiptVersion: nil,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		&amp;Receipt{</span>
<span class="term-fg32">+			Type:              DepositTxType,</span>
<span class="term-fg32">+			PostState:         common.Hash{5}.Bytes(),</span>
<span class="term-fg32">+			CumulativeGasUsed: 60 + 50 + 28,</span>
<span class="term-fg32">+			Logs: []*Log{</span>
<span class="term-fg32">+				{</span>
<span class="term-fg32">+					Address: common.BytesToAddress([]byte{0x33}),</span>
<span class="term-fg32">+					Topics:  []common.Hash{common.HexToHash(&quot;dead&quot;), common.HexToHash(&quot;beef&quot;)},</span>
<span class="term-fg32">+					&#47;&#47; derived fields:</span>
<span class="term-fg32">+					BlockNumber: blockNumber.Uint64(),</span>
<span class="term-fg32">+					TxHash:      txs[8].Hash(),</span>
<span class="term-fg32">+					TxIndex:     8,</span>
<span class="term-fg32">+					BlockHash:   blockHash,</span>
<span class="term-fg32">+					Index:       6,</span>
<span class="term-fg32">+				},</span>
<span class="term-fg32">+				{</span>
<span class="term-fg32">+					Address: common.BytesToAddress([]byte{0x03, 0x33}),</span>
<span class="term-fg32">+					Topics:  []common.Hash{common.HexToHash(&quot;dead&quot;), common.HexToHash(&quot;beef&quot;)},</span>
<span class="term-fg32">+					&#47;&#47; derived fields:</span>
<span class="term-fg32">+					BlockNumber: blockNumber.Uint64(),</span>
<span class="term-fg32">+					TxHash:      txs[8].Hash(),</span>
<span class="term-fg32">+					TxIndex:     8,</span>
<span class="term-fg32">+					BlockHash:   blockHash,</span>
<span class="term-fg32">+					Index:       7,</span>
<span class="term-fg32">+				},</span>
<span class="term-fg32">+			},</span>
<span class="term-fg32">+			TxHash:                txs[8].Hash(),</span>
<span class="term-fg32">+			ContractAddress:       common.HexToAddress(&quot;0x117814af22cb83d8ad6e8489e9477d28265bc105&quot;),</span>
<span class="term-fg32">+			GasUsed:               60,</span>
<span class="term-fg32">+			EffectiveGasPrice:     big.NewInt(0),</span>
<span class="term-fg32">+			BlockHash:             blockHash,</span>
<span class="term-fg32">+			BlockNumber:           blockNumber,</span>
<span class="term-fg32">+			TransactionIndex:      8,</span>
<span class="term-fg32">+			DepositNonce:          &amp;depNonce2,</span>
<span class="term-fg32">+			DepositReceiptVersion: &amp;canyonDepositReceiptVersion,</span>
<span class="term-fg32">+		},</span>
 	}
 )
&nbsp;
<span class="term-fg36">@@ -308,10 +466,10 @@</span>
 &#47;&#47; Tests that receipt data can be correctly derived from the contextual infos
 func TestDeriveFields(t *testing.T) {
 	&#47;&#47; Re-derive receipts.
<span class="term-fg31">-	basefee := big.NewInt(1000)</span>
<span class="term-fg32">+	baseFee := big.NewInt(1000)</span>
 	blobGasPrice := big.NewInt(920)
 	derivedReceipts := clearComputedFieldsOnReceipts(receipts)
<span class="term-fg31">-	err := Receipts(derivedReceipts).DeriveFields(params.TestChainConfig, blockHash, blockNumber.Uint64(), blockTime, basefee, blobGasPrice, txs)</span>
<span class="term-fg32">+	err := Receipts(derivedReceipts).DeriveFields(params.TestChainConfig, blockHash, blockNumber.Uint64(), blockTime, baseFee, blobGasPrice, txs)</span>
 	if err != nil {
 		t.Fatalf(&quot;DeriveFields(...) = %v, want &lt;nil&gt;&quot;, err)
 	}
<span class="term-fg36">@@ -344,6 +502,18 @@</span> 		r := Receipt{}
 		err = r.UnmarshalJSON(b)
 		if err != nil {
 			t.Fatal(&quot;error unmarshalling receipt from json:&quot;, err)
<span class="term-fg32">+		}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		&#47;&#47; Make sure marshal&#47;unmarshal doesn&#39;t affect receipt hash root computation by comparing</span>
<span class="term-fg32">+		&#47;&#47; the output of EncodeIndex</span>
<span class="term-fg32">+		rsBefore := Receipts([]*Receipt{receipts[i]})</span>
<span class="term-fg32">+		rsAfter := Receipts([]*Receipt{&amp;r})</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		encBefore, encAfter := bytes.Buffer{}, bytes.Buffer{}</span>
<span class="term-fg32">+		rsBefore.EncodeIndex(0, &amp;encBefore)</span>
<span class="term-fg32">+		rsAfter.EncodeIndex(0, &amp;encAfter)</span>
<span class="term-fg32">+		if !bytes.Equal(encBefore.Bytes(), encAfter.Bytes()) {</span>
<span class="term-fg32">+			t.Errorf(&quot;%v: EncodeIndex differs after JSON marshal&#47;unmarshal&quot;, i)</span>
 		}
 	}
 }
<span class="term-fg36">@@ -527,3 +697,365 @@</span> 		l[i] = &amp;cpy
 	}
 	return l
 }
<span class="term-fg32">+</span>
<span class="term-fg32">+func getOptimismEcotoneTxReceipts(l1AttributesPayload []byte, l1GasPrice, l1BlobGasPrice, l1GasUsed, l1Fee *big.Int, baseFeeScalar, blobBaseFeeScalar *uint64) ([]*Transaction, []*Receipt) {</span>
<span class="term-fg32">+	&#47;&#47; Create a few transactions to have receipts for</span>
<span class="term-fg32">+	txs := Transactions{</span>
<span class="term-fg32">+		NewTx(&amp;DepositTx{</span>
<span class="term-fg32">+			To:    nil, &#47;&#47; contract creation</span>
<span class="term-fg32">+			Value: big.NewInt(6),</span>
<span class="term-fg32">+			Gas:   50,</span>
<span class="term-fg32">+			Data:  l1AttributesPayload,</span>
<span class="term-fg32">+		}),</span>
<span class="term-fg32">+		emptyTx,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Create the corresponding receipts</span>
<span class="term-fg32">+	receipts := Receipts{</span>
<span class="term-fg32">+		&amp;Receipt{</span>
<span class="term-fg32">+			Type:              DepositTxType,</span>
<span class="term-fg32">+			PostState:         common.Hash{5}.Bytes(),</span>
<span class="term-fg32">+			CumulativeGasUsed: 50 + 15,</span>
<span class="term-fg32">+			Logs: []*Log{</span>
<span class="term-fg32">+				{</span>
<span class="term-fg32">+					Address: common.BytesToAddress([]byte{0x33}),</span>
<span class="term-fg32">+					&#47;&#47; derived fields:</span>
<span class="term-fg32">+					BlockNumber: blockNumber.Uint64(),</span>
<span class="term-fg32">+					TxHash:      txs[0].Hash(),</span>
<span class="term-fg32">+					TxIndex:     0,</span>
<span class="term-fg32">+					BlockHash:   blockHash,</span>
<span class="term-fg32">+					Index:       0,</span>
<span class="term-fg32">+				},</span>
<span class="term-fg32">+				{</span>
<span class="term-fg32">+					Address: common.BytesToAddress([]byte{0x03, 0x33}),</span>
<span class="term-fg32">+					&#47;&#47; derived fields:</span>
<span class="term-fg32">+					BlockNumber: blockNumber.Uint64(),</span>
<span class="term-fg32">+					TxHash:      txs[0].Hash(),</span>
<span class="term-fg32">+					TxIndex:     0,</span>
<span class="term-fg32">+					BlockHash:   blockHash,</span>
<span class="term-fg32">+					Index:       1,</span>
<span class="term-fg32">+				},</span>
<span class="term-fg32">+			},</span>
<span class="term-fg32">+			TxHash:            txs[0].Hash(),</span>
<span class="term-fg32">+			ContractAddress:   common.HexToAddress(&quot;0x3bb898b4bbe24f68a4e9be46cfe72d1787fd74f4&quot;),</span>
<span class="term-fg32">+			GasUsed:           65,</span>
<span class="term-fg32">+			EffectiveGasPrice: big.NewInt(0),</span>
<span class="term-fg32">+			BlockHash:         blockHash,</span>
<span class="term-fg32">+			BlockNumber:       blockNumber,</span>
<span class="term-fg32">+			TransactionIndex:  0,</span>
<span class="term-fg32">+			DepositNonce:      &amp;depNonce1,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		&amp;Receipt{</span>
<span class="term-fg32">+			Type:              LegacyTxType,</span>
<span class="term-fg32">+			EffectiveGasPrice: big.NewInt(0),</span>
<span class="term-fg32">+			PostState:         common.Hash{4}.Bytes(),</span>
<span class="term-fg32">+			CumulativeGasUsed: 10,</span>
<span class="term-fg32">+			Logs:              []*Log{},</span>
<span class="term-fg32">+			&#47;&#47; derived fields:</span>
<span class="term-fg32">+			TxHash:              txs[1].Hash(),</span>
<span class="term-fg32">+			GasUsed:             18446744073709551561,</span>
<span class="term-fg32">+			BlockHash:           blockHash,</span>
<span class="term-fg32">+			BlockNumber:         blockNumber,</span>
<span class="term-fg32">+			TransactionIndex:    1,</span>
<span class="term-fg32">+			L1GasPrice:          l1GasPrice,</span>
<span class="term-fg32">+			L1BlobBaseFee:       l1BlobGasPrice,</span>
<span class="term-fg32">+			L1GasUsed:           l1GasUsed,</span>
<span class="term-fg32">+			L1Fee:               l1Fee,</span>
<span class="term-fg32">+			L1BaseFeeScalar:     baseFeeScalar,</span>
<span class="term-fg32">+			L1BlobBaseFeeScalar: blobBaseFeeScalar,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	return txs, receipts</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func getOptimismTxReceipts(l1AttributesPayload []byte, l1GasPrice, l1GasUsed, l1Fee *big.Int, feeScalar *big.Float) ([]*Transaction, []*Receipt) {</span>
<span class="term-fg32">+	&#47;&#47; Create a few transactions to have receipts for</span>
<span class="term-fg32">+	txs := Transactions{</span>
<span class="term-fg32">+		NewTx(&amp;DepositTx{</span>
<span class="term-fg32">+			To:    nil, &#47;&#47; contract creation</span>
<span class="term-fg32">+			Value: big.NewInt(6),</span>
<span class="term-fg32">+			Gas:   50,</span>
<span class="term-fg32">+			Data:  l1AttributesPayload,</span>
<span class="term-fg32">+		}),</span>
<span class="term-fg32">+		emptyTx,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Create the corresponding receipts</span>
<span class="term-fg32">+	receipts := Receipts{</span>
<span class="term-fg32">+		&amp;Receipt{</span>
<span class="term-fg32">+			Type:              DepositTxType,</span>
<span class="term-fg32">+			PostState:         common.Hash{5}.Bytes(),</span>
<span class="term-fg32">+			CumulativeGasUsed: 50 + 15,</span>
<span class="term-fg32">+			Logs: []*Log{</span>
<span class="term-fg32">+				{</span>
<span class="term-fg32">+					Address: common.BytesToAddress([]byte{0x33}),</span>
<span class="term-fg32">+					&#47;&#47; derived fields:</span>
<span class="term-fg32">+					BlockNumber: blockNumber.Uint64(),</span>
<span class="term-fg32">+					TxHash:      txs[0].Hash(),</span>
<span class="term-fg32">+					TxIndex:     0,</span>
<span class="term-fg32">+					BlockHash:   blockHash,</span>
<span class="term-fg32">+					Index:       0,</span>
<span class="term-fg32">+				},</span>
<span class="term-fg32">+				{</span>
<span class="term-fg32">+					Address: common.BytesToAddress([]byte{0x03, 0x33}),</span>
<span class="term-fg32">+					&#47;&#47; derived fields:</span>
<span class="term-fg32">+					BlockNumber: blockNumber.Uint64(),</span>
<span class="term-fg32">+					TxHash:      txs[0].Hash(),</span>
<span class="term-fg32">+					TxIndex:     0,</span>
<span class="term-fg32">+					BlockHash:   blockHash,</span>
<span class="term-fg32">+					Index:       1,</span>
<span class="term-fg32">+				},</span>
<span class="term-fg32">+			},</span>
<span class="term-fg32">+			TxHash:            txs[0].Hash(),</span>
<span class="term-fg32">+			ContractAddress:   common.HexToAddress(&quot;0x3bb898b4bbe24f68a4e9be46cfe72d1787fd74f4&quot;),</span>
<span class="term-fg32">+			GasUsed:           65,</span>
<span class="term-fg32">+			EffectiveGasPrice: big.NewInt(0),</span>
<span class="term-fg32">+			BlockHash:         blockHash,</span>
<span class="term-fg32">+			BlockNumber:       blockNumber,</span>
<span class="term-fg32">+			TransactionIndex:  0,</span>
<span class="term-fg32">+			DepositNonce:      &amp;depNonce1,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		&amp;Receipt{</span>
<span class="term-fg32">+			Type:              LegacyTxType,</span>
<span class="term-fg32">+			EffectiveGasPrice: big.NewInt(0),</span>
<span class="term-fg32">+			PostState:         common.Hash{4}.Bytes(),</span>
<span class="term-fg32">+			CumulativeGasUsed: 10,</span>
<span class="term-fg32">+			Logs:              []*Log{},</span>
<span class="term-fg32">+			&#47;&#47; derived fields:</span>
<span class="term-fg32">+			TxHash:           txs[1].Hash(),</span>
<span class="term-fg32">+			GasUsed:          18446744073709551561,</span>
<span class="term-fg32">+			BlockHash:        blockHash,</span>
<span class="term-fg32">+			BlockNumber:      blockNumber,</span>
<span class="term-fg32">+			TransactionIndex: 1,</span>
<span class="term-fg32">+			L1GasPrice:       l1GasPrice,</span>
<span class="term-fg32">+			L1GasUsed:        l1GasUsed,</span>
<span class="term-fg32">+			L1Fee:            l1Fee,</span>
<span class="term-fg32">+			FeeScalar:        feeScalar,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	return txs, receipts</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func TestDeriveOptimismBedrockTxReceipts(t *testing.T) {</span>
<span class="term-fg32">+	&#47;&#47; Bedrock style l1 attributes with L1Scalar=7_000_000 (becomes 7 after division), L1Overhead=50, L1BaseFee=1000*1e6</span>
<span class="term-fg32">+	payload := common.Hex2Bytes(&quot;015d8eb900000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000003b9aca0000000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000000003200000000000000000000000000000000000000000000000000000000006acfc0015d8eb900000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000003b9aca0000000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000000003200000000000000000000000000000000000000000000000000000000006acfc0&quot;)</span>
<span class="term-fg32">+	&#47;&#47; the parameters we use below are defined in rollup_test.go</span>
<span class="term-fg32">+	l1GasPrice := baseFee</span>
<span class="term-fg32">+	l1GasUsed := bedrockGas</span>
<span class="term-fg32">+	feeScalar := big.NewFloat(float64(scalar.Uint64() &#47; 1e6))</span>
<span class="term-fg32">+	l1Fee := bedrockFee</span>
<span class="term-fg32">+	txs, receipts := getOptimismTxReceipts(payload, l1GasPrice, l1GasUsed, l1Fee, feeScalar)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Re-derive receipts.</span>
<span class="term-fg32">+	baseFee := big.NewInt(1000)</span>
<span class="term-fg32">+	derivedReceipts := clearComputedFieldsOnReceipts(receipts)</span>
<span class="term-fg32">+	err := Receipts(derivedReceipts).DeriveFields(bedrockGenesisTestConfig, blockHash, blockNumber.Uint64(), 0, baseFee, nil, txs)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		t.Fatalf(&quot;DeriveFields(...) = %v, want &lt;nil&gt;&quot;, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	checkBedrockReceipts(t, receipts, derivedReceipts)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Should get same result with the Ecotone config because it will assume this is &quot;first ecotone block&quot;</span>
<span class="term-fg32">+	&#47;&#47; if it sees the bedrock style L1 attributes.</span>
<span class="term-fg32">+	err = Receipts(derivedReceipts).DeriveFields(ecotoneTestConfig, blockHash, blockNumber.Uint64(), 0, baseFee, nil, txs)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		t.Fatalf(&quot;DeriveFields(...) = %v, want &lt;nil&gt;&quot;, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	checkBedrockReceipts(t, receipts, derivedReceipts)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func TestDeriveOptimismEcotoneTxReceipts(t *testing.T) {</span>
<span class="term-fg32">+	&#47;&#47; Ecotone style l1 attributes with baseFeeScalar=2, blobBaseFeeScalar=3, baseFee=1000*1e6, blobBaseFee=10*1e6</span>
<span class="term-fg32">+	payload := common.Hex2Bytes(&quot;440a5e20000000020000000300000000000004d200000000000004d200000000000004d2000000000000000000000000000000000000000000000000000000003b9aca00000000000000000000000000000000000000000000000000000000000098968000000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2&quot;)</span>
<span class="term-fg32">+	&#47;&#47; the parameters we use below are defined in rollup_test.go</span>
<span class="term-fg32">+	baseFeeScalarUint64 := baseFeeScalar.Uint64()</span>
<span class="term-fg32">+	blobBaseFeeScalarUint64 := blobBaseFeeScalar.Uint64()</span>
<span class="term-fg32">+	txs, receipts := getOptimismEcotoneTxReceipts(payload, baseFee, blobBaseFee, ecotoneGas, ecotoneFee, &amp;baseFeeScalarUint64, &amp;blobBaseFeeScalarUint64)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Re-derive receipts.</span>
<span class="term-fg32">+	baseFee := big.NewInt(1000)</span>
<span class="term-fg32">+	derivedReceipts := clearComputedFieldsOnReceipts(receipts)</span>
<span class="term-fg32">+	&#47;&#47; Should error out if we try to process this with a pre-Ecotone config</span>
<span class="term-fg32">+	err := Receipts(derivedReceipts).DeriveFields(bedrockGenesisTestConfig, blockHash, blockNumber.Uint64(), 0, baseFee, nil, txs)</span>
<span class="term-fg32">+	if err == nil {</span>
<span class="term-fg32">+		t.Fatalf(&quot;expected error from deriving ecotone receipts with pre-ecotone config, got none&quot;)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	err = Receipts(derivedReceipts).DeriveFields(ecotoneTestConfig, blockHash, blockNumber.Uint64(), 0, baseFee, nil, txs)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		t.Fatalf(&quot;DeriveFields(...) = %v, want &lt;nil&gt;&quot;, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	diffReceipts(t, receipts, derivedReceipts)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func diffReceipts(t *testing.T, receipts, derivedReceipts []*Receipt) {</span>
<span class="term-fg32">+	&#47;&#47; Check diff of receipts against derivedReceipts.</span>
<span class="term-fg32">+	r1, err := json.MarshalIndent(receipts, &quot;&quot;, &quot;  &quot;)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		t.Fatal(&quot;error marshaling input receipts:&quot;, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	r2, err := json.MarshalIndent(derivedReceipts, &quot;&quot;, &quot;  &quot;)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		t.Fatal(&quot;error marshaling derived receipts:&quot;, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	d := diff.Diff(string(r1), string(r2))</span>
<span class="term-fg32">+	if d != &quot;&quot; {</span>
<span class="term-fg32">+		t.Fatal(&quot;receipts differ:&quot;, d)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func checkBedrockReceipts(t *testing.T, receipts, derivedReceipts []*Receipt) {</span>
<span class="term-fg32">+	diffReceipts(t, receipts, derivedReceipts)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Check that we preserved the invariant: l1Fee = l1GasPrice * l1GasUsed * l1FeeScalar</span>
<span class="term-fg32">+	&#47;&#47; but with more difficult int math...</span>
<span class="term-fg32">+	l2Rcpt := derivedReceipts[1]</span>
<span class="term-fg32">+	l1GasCost := new(big.Int).Mul(l2Rcpt.L1GasPrice, l2Rcpt.L1GasUsed)</span>
<span class="term-fg32">+	l1Fee := new(big.Float).Mul(new(big.Float).SetInt(l1GasCost), l2Rcpt.FeeScalar)</span>
<span class="term-fg32">+	require.Equal(t, new(big.Float).SetInt(l2Rcpt.L1Fee), l1Fee)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func TestBedrockDepositReceiptUnchanged(t *testing.T) {</span>
<span class="term-fg32">+	expectedRlp := common.FromHex(&quot;7EF90156A003000000000000000000000000000000000000000000000000000000000000000AB9010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000F0D7940000000000000000000000000000000000000033C001D7940000000000000000000000000000000000000333C002&quot;)</span>
<span class="term-fg32">+	&#47;&#47; Deposit receipt with no nonce</span>
<span class="term-fg32">+	receipt := &amp;Receipt{</span>
<span class="term-fg32">+		Type:              DepositTxType,</span>
<span class="term-fg32">+		PostState:         common.Hash{3}.Bytes(),</span>
<span class="term-fg32">+		CumulativeGasUsed: 10,</span>
<span class="term-fg32">+		Logs: []*Log{</span>
<span class="term-fg32">+			{Address: common.BytesToAddress([]byte{0x33}), Data: []byte{1}, Topics: []common.Hash{}},</span>
<span class="term-fg32">+			{Address: common.BytesToAddress([]byte{0x03, 0x33}), Data: []byte{2}, Topics: []common.Hash{}},</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		TxHash:          common.Hash{},</span>
<span class="term-fg32">+		ContractAddress: common.BytesToAddress([]byte{0x03, 0x33, 0x33}),</span>
<span class="term-fg32">+		GasUsed:         4,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	rlp, err := receipt.MarshalBinary()</span>
<span class="term-fg32">+	require.NoError(t, err)</span>
<span class="term-fg32">+	require.Equal(t, expectedRlp, rlp)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Consensus values should be unchanged after reparsing</span>
<span class="term-fg32">+	parsed := new(Receipt)</span>
<span class="term-fg32">+	err = parsed.UnmarshalBinary(rlp)</span>
<span class="term-fg32">+	require.NoError(t, err)</span>
<span class="term-fg32">+	require.Equal(t, receipt.Status, parsed.Status)</span>
<span class="term-fg32">+	require.Equal(t, receipt.CumulativeGasUsed, parsed.CumulativeGasUsed)</span>
<span class="term-fg32">+	require.Equal(t, receipt.Bloom, parsed.Bloom)</span>
<span class="term-fg32">+	require.EqualValues(t, receipt.Logs, parsed.Logs)</span>
<span class="term-fg32">+	&#47;&#47; And still shouldn&#39;t have a nonce</span>
<span class="term-fg32">+	require.Nil(t, parsed.DepositNonce)</span>
<span class="term-fg32">+	&#47;&#47; ..or a deposit nonce</span>
<span class="term-fg32">+	require.Nil(t, parsed.DepositReceiptVersion)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; Regolith introduced an inconsistency in behavior between EncodeIndex and MarshalBinary for a</span>
<span class="term-fg32">+&#47;&#47; deposit transaction receipt. TestReceiptEncodeIndexBugIsEnshrined makes sure this difference is</span>
<span class="term-fg32">+&#47;&#47; preserved for backwards compatibility purposes, but also that there is no discrepancy for the</span>
<span class="term-fg32">+&#47;&#47; post-Canyon encoding.</span>
<span class="term-fg32">+func TestReceiptEncodeIndexBugIsEnshrined(t *testing.T) {</span>
<span class="term-fg32">+	&#47;&#47; Check that a post-Regolith, pre-Canyon receipt produces the expected difference between</span>
<span class="term-fg32">+	&#47;&#47; EncodeIndex and MarshalBinary.</span>
<span class="term-fg32">+	buf := new(bytes.Buffer)</span>
<span class="term-fg32">+	receipts := Receipts{depositReceiptWithNonce}</span>
<span class="term-fg32">+	receipts.EncodeIndex(0, buf)</span>
<span class="term-fg32">+	indexBytes := buf.Bytes()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	regularBytes, _ := receipts[0].MarshalBinary()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	require.NotEqual(t, indexBytes, regularBytes)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Confirm the buggy encoding is as expected, which means it should encode as if it had no</span>
<span class="term-fg32">+	&#47;&#47; nonce specified (like that of a non-deposit receipt, whose encoding would differ only in the</span>
<span class="term-fg32">+	&#47;&#47; type byte).</span>
<span class="term-fg32">+	buf.Reset()</span>
<span class="term-fg32">+	tempReceipt := *depositReceiptWithNonce</span>
<span class="term-fg32">+	tempReceipt.Type = eip1559Receipt.Type</span>
<span class="term-fg32">+	buggyBytes, _ := tempReceipt.MarshalBinary()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	require.Equal(t, indexBytes[1:], buggyBytes[1:])</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; check that the post-Canyon encoding has no differences between EncodeIndex and</span>
<span class="term-fg32">+	&#47;&#47; MarshalBinary.</span>
<span class="term-fg32">+	buf.Reset()</span>
<span class="term-fg32">+	receipts = Receipts{depositReceiptWithNonceAndVersion}</span>
<span class="term-fg32">+	receipts.EncodeIndex(0, buf)</span>
<span class="term-fg32">+	indexBytes = buf.Bytes()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	regularBytes, _ = receipts[0].MarshalBinary()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	require.Equal(t, indexBytes, regularBytes)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Check that bumping the nonce post-canyon changes the hash</span>
<span class="term-fg32">+	bumpedReceipt := *depositReceiptWithNonceAndVersion</span>
<span class="term-fg32">+	bumpedNonce := nonce + 1</span>
<span class="term-fg32">+	bumpedReceipt.DepositNonce = &amp;bumpedNonce</span>
<span class="term-fg32">+	bumpedBytes, _ := bumpedReceipt.MarshalBinary()</span>
<span class="term-fg32">+	require.NotEqual(t, regularBytes, bumpedBytes)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func TestRoundTripReceipt(t *testing.T) {</span>
<span class="term-fg32">+	tests := []struct {</span>
<span class="term-fg32">+		name string</span>
<span class="term-fg32">+		rcpt *Receipt</span>
<span class="term-fg32">+	}{</span>
<span class="term-fg32">+		{name: &quot;Legacy&quot;, rcpt: legacyReceipt},</span>
<span class="term-fg32">+		{name: &quot;AccessList&quot;, rcpt: accessListReceipt},</span>
<span class="term-fg32">+		{name: &quot;EIP1559&quot;, rcpt: eip1559Receipt},</span>
<span class="term-fg32">+		{name: &quot;DepositNoNonce&quot;, rcpt: depositReceiptNoNonce},</span>
<span class="term-fg32">+		{name: &quot;DepositWithNonce&quot;, rcpt: depositReceiptWithNonce},</span>
<span class="term-fg32">+		{name: &quot;DepositWithNonceAndVersion&quot;, rcpt: depositReceiptWithNonceAndVersion},</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	for _, test := range tests {</span>
<span class="term-fg32">+		t.Run(test.name, func(t *testing.T) {</span>
<span class="term-fg32">+			data, err := test.rcpt.MarshalBinary()</span>
<span class="term-fg32">+			require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+			d := &amp;Receipt{}</span>
<span class="term-fg32">+			err = d.UnmarshalBinary(data)</span>
<span class="term-fg32">+			require.NoError(t, err)</span>
<span class="term-fg32">+			require.Equal(t, test.rcpt, d)</span>
<span class="term-fg32">+			require.Equal(t, test.rcpt.DepositNonce, d.DepositNonce)</span>
<span class="term-fg32">+			require.Equal(t, test.rcpt.DepositReceiptVersion, d.DepositReceiptVersion)</span>
<span class="term-fg32">+		})</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		t.Run(fmt.Sprintf(&quot;%sRejectExtraData&quot;, test.name), func(t *testing.T) {</span>
<span class="term-fg32">+			data, err := test.rcpt.MarshalBinary()</span>
<span class="term-fg32">+			require.NoError(t, err)</span>
<span class="term-fg32">+			data = append(data, 1, 2, 3, 4)</span>
<span class="term-fg32">+			d := &amp;Receipt{}</span>
<span class="term-fg32">+			err = d.UnmarshalBinary(data)</span>
<span class="term-fg32">+			require.Error(t, err)</span>
<span class="term-fg32">+		})</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func TestRoundTripReceiptForStorage(t *testing.T) {</span>
<span class="term-fg32">+	tests := []struct {</span>
<span class="term-fg32">+		name string</span>
<span class="term-fg32">+		rcpt *Receipt</span>
<span class="term-fg32">+	}{</span>
<span class="term-fg32">+		{name: &quot;Legacy&quot;, rcpt: legacyReceipt},</span>
<span class="term-fg32">+		{name: &quot;AccessList&quot;, rcpt: accessListReceipt},</span>
<span class="term-fg32">+		{name: &quot;EIP1559&quot;, rcpt: eip1559Receipt},</span>
<span class="term-fg32">+		{name: &quot;DepositNoNonce&quot;, rcpt: depositReceiptNoNonce},</span>
<span class="term-fg32">+		{name: &quot;DepositWithNonce&quot;, rcpt: depositReceiptWithNonce},</span>
<span class="term-fg32">+		{name: &quot;DepositWithNonceAndVersion&quot;, rcpt: depositReceiptWithNonceAndVersion},</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	for _, test := range tests {</span>
<span class="term-fg32">+		t.Run(test.name, func(t *testing.T) {</span>
<span class="term-fg32">+			data, err := rlp.EncodeToBytes((*ReceiptForStorage)(test.rcpt))</span>
<span class="term-fg32">+			require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+			d := &amp;ReceiptForStorage{}</span>
<span class="term-fg32">+			err = rlp.DecodeBytes(data, d)</span>
<span class="term-fg32">+			require.NoError(t, err)</span>
<span class="term-fg32">+			&#47;&#47; Only check the stored fields - the others are derived later</span>
<span class="term-fg32">+			require.Equal(t, test.rcpt.Status, d.Status)</span>
<span class="term-fg32">+			require.Equal(t, test.rcpt.CumulativeGasUsed, d.CumulativeGasUsed)</span>
<span class="term-fg32">+			require.Equal(t, test.rcpt.Logs, d.Logs)</span>
<span class="term-fg32">+			require.Equal(t, test.rcpt.DepositNonce, d.DepositNonce)</span>
<span class="term-fg32">+			require.Equal(t, test.rcpt.DepositReceiptVersion, d.DepositReceiptVersion)</span>
<span class="term-fg32">+		})</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-muted" data-bs-toggle="collapse" href="#id-6566018fca2be4bf2107c3ed" role="button"
                       aria-expanded="false" aria-controls="id-6566018fca2be4bf2107c3ed">
                        <code>core/types/rollup_cost_test.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/core/types/rollup_cost_test.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-add-ignored">+407</span></div>
                            <div class="text-start"><span class="text-delete-ignored">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-6566018fca2be4bf2107c3ed"><span class="term-fg1">diff --git go-ethereum&#47;core&#47;types&#47;rollup_cost_test.go op-geth&#47;core&#47;types&#47;rollup_cost_test.go</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..8d0f1e92185986c420aaeebce0bb46662f6e3ab0</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ op-geth&#47;core&#47;types&#47;rollup_cost_test.go</span>
<span class="term-fg36">@@ -0,0 +1,407 @@</span>
<span class="term-fg32">+package types</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+import (</span>
<span class="term-fg32">+	&quot;bytes&quot;</span>
<span class="term-fg32">+	&quot;encoding&#47;binary&quot;</span>
<span class="term-fg32">+	&quot;encoding&#47;hex&quot;</span>
<span class="term-fg32">+	&quot;math&#47;big&quot;</span>
<span class="term-fg32">+	&quot;testing&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&quot;github.com&#47;stretchr&#47;testify&#47;require&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;params&quot;</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+var (</span>
<span class="term-fg32">+	baseFee  = big.NewInt(1000 * 1e6)</span>
<span class="term-fg32">+	overhead = big.NewInt(50)</span>
<span class="term-fg32">+	scalar   = big.NewInt(7 * 1e6)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	blobBaseFee       = big.NewInt(10 * 1e6)</span>
<span class="term-fg32">+	baseFeeScalar     = big.NewInt(2)</span>
<span class="term-fg32">+	blobBaseFeeScalar = big.NewInt(3)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; below are the expected cost func outcomes for the above parameter settings on the emptyTx</span>
<span class="term-fg32">+	&#47;&#47; which is defined in transaction_test.go</span>
<span class="term-fg32">+	bedrockFee  = big.NewInt(11326000000000)</span>
<span class="term-fg32">+	regolithFee = big.NewInt(3710000000000)</span>
<span class="term-fg32">+	ecotoneFee  = big.NewInt(960900) &#47;&#47; (480&#47;16)*(2*16*1000 + 3*10) == 960900</span>
<span class="term-fg32">+	&#47;&#47; the emptyTx is out of bounds for the linear regression so it uses the minimum size</span>
<span class="term-fg32">+	fjordFee = big.NewInt(3203000) &#47;&#47; 100_000_000 * (2 * 1000 * 1e6 * 16 + 3 * 10 * 1e6) &#47; 1e12</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	bedrockGas      = big.NewInt(1618)</span>
<span class="term-fg32">+	regolithGas     = big.NewInt(530) &#47;&#47; 530  = 1618 - (16*68)</span>
<span class="term-fg32">+	ecotoneGas      = big.NewInt(480)</span>
<span class="term-fg32">+	minimumFjordGas = big.NewInt(1600) &#47;&#47; fastlz size of minimum txn, 100_000_000 * 16 &#47; 1e6</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func TestBedrockL1CostFunc(t *testing.T) {</span>
<span class="term-fg32">+	costFunc0 := newL1CostFuncBedrockHelper(baseFee, overhead, scalar, false &#47;*isRegolith*&#47;)</span>
<span class="term-fg32">+	costFunc1 := newL1CostFuncBedrockHelper(baseFee, overhead, scalar, true)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	c0, g0 := costFunc0(emptyTx.RollupCostData()) &#47;&#47; pre-Regolith</span>
<span class="term-fg32">+	c1, g1 := costFunc1(emptyTx.RollupCostData())</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	require.Equal(t, bedrockFee, c0)</span>
<span class="term-fg32">+	require.Equal(t, bedrockGas, g0) &#47;&#47; gas-used</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	require.Equal(t, regolithFee, c1)</span>
<span class="term-fg32">+	require.Equal(t, regolithGas, g1)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func TestEcotoneL1CostFunc(t *testing.T) {</span>
<span class="term-fg32">+	costFunc := newL1CostFuncEcotone(baseFee, blobBaseFee, baseFeeScalar, blobBaseFeeScalar)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	c0, g0 := costFunc(emptyTx.RollupCostData())</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	require.Equal(t, ecotoneGas, g0)</span>
<span class="term-fg32">+	require.Equal(t, ecotoneFee, c0)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func TestFjordL1CostFuncMinimumBounds(t *testing.T) {</span>
<span class="term-fg32">+	costFunc := NewL1CostFuncFjord(</span>
<span class="term-fg32">+		baseFee,</span>
<span class="term-fg32">+		blobBaseFee,</span>
<span class="term-fg32">+		baseFeeScalar,</span>
<span class="term-fg32">+		blobBaseFeeScalar,</span>
<span class="term-fg32">+	)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Minimum size transactions:</span>
<span class="term-fg32">+	&#47;&#47; -42.5856 + 0.8365*110 = 49.4294</span>
<span class="term-fg32">+	&#47;&#47; -42.5856 + 0.8365*150 = 82.8894</span>
<span class="term-fg32">+	&#47;&#47; -42.5856 + 0.8365*170 = 99.6194</span>
<span class="term-fg32">+	for _, fastLzsize := range []uint64{100, 150, 170} {</span>
<span class="term-fg32">+		c, g := costFunc(RollupCostData{</span>
<span class="term-fg32">+			FastLzSize: fastLzsize,</span>
<span class="term-fg32">+		})</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		require.Equal(t, minimumFjordGas, g)</span>
<span class="term-fg32">+		require.Equal(t, fjordFee, c)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Larger size transactions:</span>
<span class="term-fg32">+	&#47;&#47; -42.5856 + 0.8365*171 = 100.4559</span>
<span class="term-fg32">+	&#47;&#47; -42.5856 + 0.8365*175 = 108.8019</span>
<span class="term-fg32">+	&#47;&#47; -42.5856 + 0.8365*200 = 124.7144</span>
<span class="term-fg32">+	for _, fastLzsize := range []uint64{171, 175, 200} {</span>
<span class="term-fg32">+		c, g := costFunc(RollupCostData{</span>
<span class="term-fg32">+			FastLzSize: fastLzsize,</span>
<span class="term-fg32">+		})</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+		require.Greater(t, g.Uint64(), minimumFjordGas.Uint64())</span>
<span class="term-fg32">+		require.Greater(t, c.Uint64(), fjordFee.Uint64())</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; TestFjordL1CostSolidityParity tests that the cost function for the fjord upgrade matches a Solidity</span>
<span class="term-fg32">+&#47;&#47; test to ensure the outputs are the same.</span>
<span class="term-fg32">+func TestFjordL1CostSolidityParity(t *testing.T) {</span>
<span class="term-fg32">+	costFunc := NewL1CostFuncFjord(</span>
<span class="term-fg32">+		big.NewInt(2*1e6),</span>
<span class="term-fg32">+		big.NewInt(3*1e6),</span>
<span class="term-fg32">+		big.NewInt(20),</span>
<span class="term-fg32">+		big.NewInt(15),</span>
<span class="term-fg32">+	)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	c0, g0 := costFunc(RollupCostData{</span>
<span class="term-fg32">+		FastLzSize: 235,</span>
<span class="term-fg32">+	})</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	require.Equal(t, big.NewInt(2463), g0)</span>
<span class="term-fg32">+	require.Equal(t, big.NewInt(105484), c0)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func TestExtractBedrockGasParams(t *testing.T) {</span>
<span class="term-fg32">+	regolithTime := uint64(1)</span>
<span class="term-fg32">+	config := &amp;params.ChainConfig{</span>
<span class="term-fg32">+		Optimism:     params.OptimismTestConfig.Optimism,</span>
<span class="term-fg32">+		RegolithTime: &amp;regolithTime,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	data := getBedrockL1Attributes(baseFee, overhead, scalar)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	gasparams, err := extractL1GasParams(config, regolithTime-1, data)</span>
<span class="term-fg32">+	costFuncPreRegolith := gasparams.costFunc</span>
<span class="term-fg32">+	require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Function should continue to succeed even with extra data (that just gets ignored) since we</span>
<span class="term-fg32">+	&#47;&#47; have been testing the data size is at least the expected number of bytes instead of exactly</span>
<span class="term-fg32">+	&#47;&#47; the expected number of bytes. It&#39;s unclear if this flexibility was intentional, but since</span>
<span class="term-fg32">+	&#47;&#47; it&#39;s been in production we shouldn&#39;t change this behavior.</span>
<span class="term-fg32">+	data = append(data, []byte{0xBE, 0xEE, 0xEE, 0xFF}...) &#47;&#47; tack on garbage data</span>
<span class="term-fg32">+	gasparams, err = extractL1GasParams(config, regolithTime, data)</span>
<span class="term-fg32">+	costFuncRegolith := gasparams.costFunc</span>
<span class="term-fg32">+	require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	c, _ := costFuncPreRegolith(emptyTx.RollupCostData())</span>
<span class="term-fg32">+	require.Equal(t, bedrockFee, c)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	c, _ = costFuncRegolith(emptyTx.RollupCostData())</span>
<span class="term-fg32">+	require.Equal(t, regolithFee, c)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; try to extract from data which has not enough params, should get error.</span>
<span class="term-fg32">+	data = data[:len(data)-4-32]</span>
<span class="term-fg32">+	_, err = extractL1GasParams(config, regolithTime, data)</span>
<span class="term-fg32">+	require.Error(t, err)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func TestExtractEcotoneGasParams(t *testing.T) {</span>
<span class="term-fg32">+	zeroTime := uint64(0)</span>
<span class="term-fg32">+	&#47;&#47; create a config where ecotone upgrade is active</span>
<span class="term-fg32">+	config := &amp;params.ChainConfig{</span>
<span class="term-fg32">+		Optimism:     params.OptimismTestConfig.Optimism,</span>
<span class="term-fg32">+		RegolithTime: &amp;zeroTime,</span>
<span class="term-fg32">+		EcotoneTime:  &amp;zeroTime,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	require.True(t, config.IsOptimismEcotone(zeroTime))</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	data := getEcotoneL1Attributes(</span>
<span class="term-fg32">+		baseFee,</span>
<span class="term-fg32">+		blobBaseFee,</span>
<span class="term-fg32">+		baseFeeScalar,</span>
<span class="term-fg32">+		blobBaseFeeScalar,</span>
<span class="term-fg32">+	)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	gasparams, err := extractL1GasParams(config, zeroTime, data)</span>
<span class="term-fg32">+	require.NoError(t, err)</span>
<span class="term-fg32">+	costFunc := gasparams.costFunc</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	c, g := costFunc(emptyTx.RollupCostData())</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	require.Equal(t, ecotoneGas, g)</span>
<span class="term-fg32">+	require.Equal(t, ecotoneFee, c)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; make sure wrong amont of data results in error</span>
<span class="term-fg32">+	data = append(data, 0x00) &#47;&#47; tack on garbage byte</span>
<span class="term-fg32">+	_, err = extractL1GasParamsPostEcotone(data)</span>
<span class="term-fg32">+	require.Error(t, err)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func TestExtractFjordGasParams(t *testing.T) {</span>
<span class="term-fg32">+	zeroTime := uint64(0)</span>
<span class="term-fg32">+	&#47;&#47; create a config where fjord is active</span>
<span class="term-fg32">+	config := &amp;params.ChainConfig{</span>
<span class="term-fg32">+		Optimism:     params.OptimismTestConfig.Optimism,</span>
<span class="term-fg32">+		RegolithTime: &amp;zeroTime,</span>
<span class="term-fg32">+		EcotoneTime:  &amp;zeroTime,</span>
<span class="term-fg32">+		FjordTime:    &amp;zeroTime,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	require.True(t, config.IsOptimismFjord(zeroTime))</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	data := getEcotoneL1Attributes(</span>
<span class="term-fg32">+		baseFee,</span>
<span class="term-fg32">+		blobBaseFee,</span>
<span class="term-fg32">+		baseFeeScalar,</span>
<span class="term-fg32">+		blobBaseFeeScalar,</span>
<span class="term-fg32">+	)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	gasparams, err := extractL1GasParams(config, zeroTime, data)</span>
<span class="term-fg32">+	require.NoError(t, err)</span>
<span class="term-fg32">+	costFunc := gasparams.costFunc</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	c, g := costFunc(emptyTx.RollupCostData())</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	require.Equal(t, minimumFjordGas, g)</span>
<span class="term-fg32">+	require.Equal(t, fjordFee, c)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; make sure the first block of the ecotone upgrade is properly detected, and invokes the bedrock</span>
<span class="term-fg32">+&#47;&#47; cost function appropriately</span>
<span class="term-fg32">+func TestFirstBlockEcotoneGasParams(t *testing.T) {</span>
<span class="term-fg32">+	zeroTime := uint64(0)</span>
<span class="term-fg32">+	&#47;&#47; create a config where ecotone upgrade is active</span>
<span class="term-fg32">+	config := &amp;params.ChainConfig{</span>
<span class="term-fg32">+		Optimism:     params.OptimismTestConfig.Optimism,</span>
<span class="term-fg32">+		RegolithTime: &amp;zeroTime,</span>
<span class="term-fg32">+		EcotoneTime:  &amp;zeroTime,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	require.True(t, config.IsOptimismEcotone(0))</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	data := getBedrockL1Attributes(baseFee, overhead, scalar)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	gasparams, err := extractL1GasParams(config, zeroTime, data)</span>
<span class="term-fg32">+	require.NoError(t, err)</span>
<span class="term-fg32">+	oldCostFunc := gasparams.costFunc</span>
<span class="term-fg32">+	c, g := oldCostFunc(emptyTx.RollupCostData())</span>
<span class="term-fg32">+	require.Equal(t, regolithGas, g)</span>
<span class="term-fg32">+	require.Equal(t, regolithFee, c)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func getBedrockL1Attributes(baseFee, overhead, scalar *big.Int) []byte {</span>
<span class="term-fg32">+	uint256 := make([]byte, 32)</span>
<span class="term-fg32">+	ignored := big.NewInt(1234)</span>
<span class="term-fg32">+	data := []byte{}</span>
<span class="term-fg32">+	data = append(data, BedrockL1AttributesSelector...)</span>
<span class="term-fg32">+	data = append(data, ignored.FillBytes(uint256)...)  &#47;&#47; arg 0</span>
<span class="term-fg32">+	data = append(data, ignored.FillBytes(uint256)...)  &#47;&#47; arg 1</span>
<span class="term-fg32">+	data = append(data, baseFee.FillBytes(uint256)...)  &#47;&#47; arg 2</span>
<span class="term-fg32">+	data = append(data, ignored.FillBytes(uint256)...)  &#47;&#47; arg 3</span>
<span class="term-fg32">+	data = append(data, ignored.FillBytes(uint256)...)  &#47;&#47; arg 4</span>
<span class="term-fg32">+	data = append(data, ignored.FillBytes(uint256)...)  &#47;&#47; arg 5</span>
<span class="term-fg32">+	data = append(data, overhead.FillBytes(uint256)...) &#47;&#47; arg 6</span>
<span class="term-fg32">+	data = append(data, scalar.FillBytes(uint256)...)   &#47;&#47; arg 7</span>
<span class="term-fg32">+	return data</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func getEcotoneL1Attributes(baseFee, blobBaseFee, baseFeeScalar, blobBaseFeeScalar *big.Int) []byte {</span>
<span class="term-fg32">+	ignored := big.NewInt(1234)</span>
<span class="term-fg32">+	data := []byte{}</span>
<span class="term-fg32">+	uint256Slice := make([]byte, 32)</span>
<span class="term-fg32">+	uint64Slice := make([]byte, 8)</span>
<span class="term-fg32">+	uint32Slice := make([]byte, 4)</span>
<span class="term-fg32">+	data = append(data, EcotoneL1AttributesSelector...)</span>
<span class="term-fg32">+	data = append(data, baseFeeScalar.FillBytes(uint32Slice)...)</span>
<span class="term-fg32">+	data = append(data, blobBaseFeeScalar.FillBytes(uint32Slice)...)</span>
<span class="term-fg32">+	data = append(data, ignored.FillBytes(uint64Slice)...)</span>
<span class="term-fg32">+	data = append(data, ignored.FillBytes(uint64Slice)...)</span>
<span class="term-fg32">+	data = append(data, ignored.FillBytes(uint64Slice)...)</span>
<span class="term-fg32">+	data = append(data, baseFee.FillBytes(uint256Slice)...)</span>
<span class="term-fg32">+	data = append(data, blobBaseFee.FillBytes(uint256Slice)...)</span>
<span class="term-fg32">+	data = append(data, ignored.FillBytes(uint256Slice)...)</span>
<span class="term-fg32">+	data = append(data, ignored.FillBytes(uint256Slice)...)</span>
<span class="term-fg32">+	return data</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+type testStateGetter struct {</span>
<span class="term-fg32">+	baseFee, blobBaseFee, overhead, scalar *big.Int</span>
<span class="term-fg32">+	baseFeeScalar, blobBaseFeeScalar       uint32</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (sg *testStateGetter) GetState(addr common.Address, slot common.Hash) common.Hash {</span>
<span class="term-fg32">+	buf := common.Hash{}</span>
<span class="term-fg32">+	switch slot {</span>
<span class="term-fg32">+	case L1BaseFeeSlot:</span>
<span class="term-fg32">+		sg.baseFee.FillBytes(buf[:])</span>
<span class="term-fg32">+	case OverheadSlot:</span>
<span class="term-fg32">+		sg.overhead.FillBytes(buf[:])</span>
<span class="term-fg32">+	case ScalarSlot:</span>
<span class="term-fg32">+		sg.scalar.FillBytes(buf[:])</span>
<span class="term-fg32">+	case L1BlobBaseFeeSlot:</span>
<span class="term-fg32">+		sg.blobBaseFee.FillBytes(buf[:])</span>
<span class="term-fg32">+	case L1FeeScalarsSlot:</span>
<span class="term-fg32">+		&#47;&#47; fetch Ecotone fee sclars</span>
<span class="term-fg32">+		offset := scalarSectionStart</span>
<span class="term-fg32">+		binary.BigEndian.PutUint32(buf[offset:offset+4], sg.baseFeeScalar)</span>
<span class="term-fg32">+		binary.BigEndian.PutUint32(buf[offset+4:offset+8], sg.blobBaseFeeScalar)</span>
<span class="term-fg32">+	default:</span>
<span class="term-fg32">+		panic(&quot;unknown slot&quot;)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	return buf</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; TestNewL1CostFunc tests that the appropriate cost function is selected based on the</span>
<span class="term-fg32">+&#47;&#47; configuration and statedb values.</span>
<span class="term-fg32">+func TestNewL1CostFunc(t *testing.T) {</span>
<span class="term-fg32">+	time := uint64(10)</span>
<span class="term-fg32">+	timeInFuture := uint64(20)</span>
<span class="term-fg32">+	config := &amp;params.ChainConfig{</span>
<span class="term-fg32">+		Optimism: params.OptimismTestConfig.Optimism,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	statedb := &amp;testStateGetter{</span>
<span class="term-fg32">+		baseFee:           baseFee,</span>
<span class="term-fg32">+		overhead:          overhead,</span>
<span class="term-fg32">+		scalar:            scalar,</span>
<span class="term-fg32">+		blobBaseFee:       blobBaseFee,</span>
<span class="term-fg32">+		baseFeeScalar:     uint32(baseFeeScalar.Uint64()),</span>
<span class="term-fg32">+		blobBaseFeeScalar: uint32(blobBaseFeeScalar.Uint64()),</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	costFunc := NewL1CostFunc(config, statedb)</span>
<span class="term-fg32">+	require.NotNil(t, costFunc)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; empty cost data should result in nil fee</span>
<span class="term-fg32">+	fee := costFunc(RollupCostData{}, time)</span>
<span class="term-fg32">+	require.Nil(t, fee)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; emptyTx fee w&#47; bedrock config should be the bedrock fee</span>
<span class="term-fg32">+	fee = costFunc(emptyTx.RollupCostData(), time)</span>
<span class="term-fg32">+	require.NotNil(t, fee)</span>
<span class="term-fg32">+	require.Equal(t, bedrockFee, fee)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; emptyTx fee w&#47; regolith config should be the regolith fee</span>
<span class="term-fg32">+	config.RegolithTime = &amp;time</span>
<span class="term-fg32">+	costFunc = NewL1CostFunc(config, statedb)</span>
<span class="term-fg32">+	require.NotNil(t, costFunc)</span>
<span class="term-fg32">+	fee = costFunc(emptyTx.RollupCostData(), time)</span>
<span class="term-fg32">+	require.NotNil(t, fee)</span>
<span class="term-fg32">+	require.Equal(t, regolithFee, fee)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; emptyTx fee w&#47; ecotone config should be the ecotone fee</span>
<span class="term-fg32">+	config.EcotoneTime = &amp;time</span>
<span class="term-fg32">+	costFunc = NewL1CostFunc(config, statedb)</span>
<span class="term-fg32">+	fee = costFunc(emptyTx.RollupCostData(), time)</span>
<span class="term-fg32">+	require.NotNil(t, fee)</span>
<span class="term-fg32">+	require.Equal(t, ecotoneFee, fee)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; emptyTx fee w&#47; fjord config should be the fjord fee</span>
<span class="term-fg32">+	config.FjordTime = &amp;time</span>
<span class="term-fg32">+	costFunc = NewL1CostFunc(config, statedb)</span>
<span class="term-fg32">+	fee = costFunc(emptyTx.RollupCostData(), time)</span>
<span class="term-fg32">+	require.NotNil(t, fee)</span>
<span class="term-fg32">+	require.Equal(t, fjordFee, fee)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; emptyTx fee w&#47; ecotone config, but simulate first ecotone block by blowing away the ecotone</span>
<span class="term-fg32">+	&#47;&#47; params. Should result in regolith fee.</span>
<span class="term-fg32">+	config.FjordTime = &amp;timeInFuture</span>
<span class="term-fg32">+	statedb.baseFeeScalar = 0</span>
<span class="term-fg32">+	statedb.blobBaseFeeScalar = 0</span>
<span class="term-fg32">+	statedb.blobBaseFee = new(big.Int)</span>
<span class="term-fg32">+	costFunc = NewL1CostFunc(config, statedb)</span>
<span class="term-fg32">+	fee = costFunc(emptyTx.RollupCostData(), time)</span>
<span class="term-fg32">+	require.NotNil(t, fee)</span>
<span class="term-fg32">+	require.Equal(t, regolithFee, fee)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; emptyTx fee w&#47; fjord config, but simulate first ecotone block by blowing away the ecotone</span>
<span class="term-fg32">+	&#47;&#47; params. Should result in regolith fee.</span>
<span class="term-fg32">+	config.EcotoneTime = &amp;time</span>
<span class="term-fg32">+	config.FjordTime = &amp;time</span>
<span class="term-fg32">+	statedb.baseFeeScalar = 0</span>
<span class="term-fg32">+	statedb.blobBaseFeeScalar = 0</span>
<span class="term-fg32">+	statedb.blobBaseFee = new(big.Int)</span>
<span class="term-fg32">+	costFunc = NewL1CostFunc(config, statedb)</span>
<span class="term-fg32">+	fee = costFunc(emptyTx.RollupCostData(), time)</span>
<span class="term-fg32">+	require.NotNil(t, fee)</span>
<span class="term-fg32">+	require.Equal(t, regolithFee, fee)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func TestFlzCompressLen(t *testing.T) {</span>
<span class="term-fg32">+	var (</span>
<span class="term-fg32">+		emptyTxBytes, _   = emptyTx.MarshalBinary()</span>
<span class="term-fg32">+		contractCallTxStr = &quot;02f901550a758302df1483be21b88304743f94f8&quot; +</span>
<span class="term-fg32">+			&quot;0e51afb613d764fa61751affd3313c190a86bb870151bd62fd12adb8&quot; +</span>
<span class="term-fg32">+			&quot;e41ef24f3f0000000000000000000000000000000000000000000000&quot; +</span>
<span class="term-fg32">+			&quot;00000000000000006e000000000000000000000000af88d065e77c8c&quot; +</span>
<span class="term-fg32">+			&quot;c2239327c5edb3a432268e5831000000000000000000000000000000&quot; +</span>
<span class="term-fg32">+			&quot;000000000000000000000000000003c1e50000000000000000000000&quot; +</span>
<span class="term-fg32">+			&quot;00000000000000000000000000000000000000000000000000000000&quot; +</span>
<span class="term-fg32">+			&quot;000000000000000000000000000000000000000000000000a0000000&quot; +</span>
<span class="term-fg32">+			&quot;00000000000000000000000000000000000000000000000000000000&quot; +</span>
<span class="term-fg32">+			&quot;148c89ed219d02f1a5be012c689b4f5b731827bebe00000000000000&quot; +</span>
<span class="term-fg32">+			&quot;0000000000c001a033fd89cb37c31b2cba46b6466e040c61fc9b2a36&quot; +</span>
<span class="term-fg32">+			&quot;75a7f5f493ebd5ad77c497f8a07cdf65680e238392693019b4092f61&quot; +</span>
<span class="term-fg32">+			&quot;0222e71b7cec06449cb922b93b6a12744e&quot;</span>
<span class="term-fg32">+		contractCallTx, _ = hex.DecodeString(contractCallTxStr)</span>
<span class="term-fg32">+	)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	testCases := []struct {</span>
<span class="term-fg32">+		input       []byte</span>
<span class="term-fg32">+		expectedLen uint32</span>
<span class="term-fg32">+	}{</span>
<span class="term-fg32">+		&#47;&#47; empty input</span>
<span class="term-fg32">+		{[]byte{}, 0},</span>
<span class="term-fg32">+		&#47;&#47; all 1 inputs</span>
<span class="term-fg32">+		{bytes.Repeat([]byte{1}, 1000), 21},</span>
<span class="term-fg32">+		&#47;&#47; all 0 inputs</span>
<span class="term-fg32">+		{make([]byte, 1000), 21},</span>
<span class="term-fg32">+		&#47;&#47; empty tx input</span>
<span class="term-fg32">+		{emptyTxBytes, 31},</span>
<span class="term-fg32">+		&#47;&#47; contract call tx: https:&#47;&#47;optimistic.etherscan.io&#47;tx&#47;0x8eb9dd4eb6d33f4dc25fb015919e4b1e9f7542f9b0322bf6622e268cd116b594</span>
<span class="term-fg32">+		{contractCallTx, 202},</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	for _, tc := range testCases {</span>
<span class="term-fg32">+		output := FlzCompressLen(tc.input)</span>
<span class="term-fg32">+		require.Equal(t, tc.expectedLen, output)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-muted" data-bs-toggle="collapse" href="#id-7aac20e48558e7e927024be4" role="button"
                       aria-expanded="false" aria-controls="id-7aac20e48558e7e927024be4">
                        <code>core/types/transaction_marshalling_test.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/core/types/transaction_marshalling_test.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-add-ignored">+103</span></div>
                            <div class="text-start"><span class="text-delete-ignored">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-7aac20e48558e7e927024be4"><span class="term-fg1">diff --git go-ethereum&#47;core&#47;types&#47;transaction_marshalling_test.go op-geth&#47;core&#47;types&#47;transaction_marshalling_test.go</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..4ab93a539d19bbcffa0293738b2e4dcc3ebe7ad2</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ op-geth&#47;core&#47;types&#47;transaction_marshalling_test.go</span>
<span class="term-fg36">@@ -0,0 +1,103 @@</span>
<span class="term-fg32">+package types</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+import (</span>
<span class="term-fg32">+	&quot;encoding&#47;json&quot;</span>
<span class="term-fg32">+	&quot;math&#47;big&quot;</span>
<span class="term-fg32">+	&quot;testing&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;stretchr&#47;testify&#47;require&quot;</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func TestTransactionUnmarshalJsonDeposit(t *testing.T) {</span>
<span class="term-fg32">+	tx := NewTx(&amp;DepositTx{</span>
<span class="term-fg32">+		SourceHash:          common.HexToHash(&quot;0x1234&quot;),</span>
<span class="term-fg32">+		IsSystemTransaction: true,</span>
<span class="term-fg32">+		Mint:                big.NewInt(34),</span>
<span class="term-fg32">+	})</span>
<span class="term-fg32">+	json, err := tx.MarshalJSON()</span>
<span class="term-fg32">+	require.NoError(t, err, &quot;Failed to marshal tx JSON&quot;)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	got := &amp;Transaction{}</span>
<span class="term-fg32">+	err = got.UnmarshalJSON(json)</span>
<span class="term-fg32">+	require.NoError(t, err, &quot;Failed to unmarshal tx JSON&quot;)</span>
<span class="term-fg32">+	require.Equal(t, tx.Hash(), got.Hash())</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func TestTransactionUnmarshalJSON(t *testing.T) {</span>
<span class="term-fg32">+	tests := []struct {</span>
<span class="term-fg32">+		name          string</span>
<span class="term-fg32">+		json          string</span>
<span class="term-fg32">+		expectedError string</span>
<span class="term-fg32">+	}{</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			name:          &quot;No gas&quot;,</span>
<span class="term-fg32">+			json:          `{&quot;type&quot;:&quot;0x7e&quot;,&quot;nonce&quot;:null,&quot;gasPrice&quot;:null,&quot;maxPriorityFeePerGas&quot;:null,&quot;maxFeePerGas&quot;:null,&quot;value&quot;:&quot;0x1&quot;,&quot;input&quot;:&quot;0x616263646566&quot;,&quot;v&quot;:null,&quot;r&quot;:null,&quot;s&quot;:null,&quot;to&quot;:null,&quot;sourceHash&quot;:&quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;,&quot;from&quot;:&quot;0x0000000000000000000000000000000000000001&quot;,&quot;isSystemTx&quot;:false,&quot;hash&quot;:&quot;0xa4341f3db4363b7ca269a8538bd027b2f8784f84454ca917668642d5f6dffdf9&quot;}`,</span>
<span class="term-fg32">+			expectedError: &quot;missing required field &#39;gas&#39;&quot;,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			name:          &quot;No value&quot;,</span>
<span class="term-fg32">+			json:          `{&quot;type&quot;:&quot;0x7e&quot;,&quot;nonce&quot;:null,&quot;gas&quot;: &quot;0x1234&quot;, &quot;gasPrice&quot;:null,&quot;maxPriorityFeePerGas&quot;:null,&quot;maxFeePerGas&quot;:null,&quot;input&quot;:&quot;0x616263646566&quot;,&quot;v&quot;:null,&quot;r&quot;:null,&quot;s&quot;:null,&quot;to&quot;:null,&quot;sourceHash&quot;:&quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;,&quot;from&quot;:&quot;0x0000000000000000000000000000000000000001&quot;,&quot;isSystemTx&quot;:false,&quot;hash&quot;:&quot;0xa4341f3db4363b7ca269a8538bd027b2f8784f84454ca917668642d5f6dffdf9&quot;}`,</span>
<span class="term-fg32">+			expectedError: &quot;missing required field &#39;value&#39;&quot;,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			name:          &quot;No input&quot;,</span>
<span class="term-fg32">+			json:          `{&quot;type&quot;:&quot;0x7e&quot;,&quot;nonce&quot;:null,&quot;gas&quot;: &quot;0x1234&quot;, &quot;gasPrice&quot;:null,&quot;maxPriorityFeePerGas&quot;:null,&quot;maxFeePerGas&quot;:null,&quot;value&quot;:&quot;0x1&quot;,&quot;v&quot;:null,&quot;r&quot;:null,&quot;s&quot;:null,&quot;to&quot;:null,&quot;sourceHash&quot;:&quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;,&quot;from&quot;:&quot;0x0000000000000000000000000000000000000001&quot;,&quot;isSystemTx&quot;:false,&quot;hash&quot;:&quot;0xa4341f3db4363b7ca269a8538bd027b2f8784f84454ca917668642d5f6dffdf9&quot;}`,</span>
<span class="term-fg32">+			expectedError: &quot;missing required field &#39;input&#39;&quot;,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			name:          &quot;No from&quot;,</span>
<span class="term-fg32">+			json:          `{&quot;type&quot;:&quot;0x7e&quot;,&quot;nonce&quot;:null,&quot;gas&quot;: &quot;0x1234&quot;, &quot;gasPrice&quot;:null,&quot;maxPriorityFeePerGas&quot;:null,&quot;maxFeePerGas&quot;:null,&quot;value&quot;:&quot;0x1&quot;,&quot;input&quot;:&quot;0x616263646566&quot;,&quot;v&quot;:null,&quot;r&quot;:null,&quot;s&quot;:null,&quot;to&quot;:null,&quot;sourceHash&quot;:&quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;,&quot;isSystemTx&quot;:false,&quot;hash&quot;:&quot;0xa4341f3db4363b7ca269a8538bd027b2f8784f84454ca917668642d5f6dffdf9&quot;}`,</span>
<span class="term-fg32">+			expectedError: &quot;missing required field &#39;from&#39;&quot;,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			name:          &quot;No sourceHash&quot;,</span>
<span class="term-fg32">+			json:          `{&quot;type&quot;:&quot;0x7e&quot;,&quot;nonce&quot;:null,&quot;gas&quot;: &quot;0x1234&quot;, &quot;gasPrice&quot;:null,&quot;maxPriorityFeePerGas&quot;:null,&quot;maxFeePerGas&quot;:null,&quot;value&quot;:&quot;0x1&quot;,&quot;input&quot;:&quot;0x616263646566&quot;,&quot;v&quot;:null,&quot;r&quot;:null,&quot;s&quot;:null,&quot;to&quot;:null,&quot;from&quot;:&quot;0x0000000000000000000000000000000000000001&quot;,&quot;isSystemTx&quot;:false,&quot;hash&quot;:&quot;0xa4341f3db4363b7ca269a8538bd027b2f8784f84454ca917668642d5f6dffdf9&quot;}`,</span>
<span class="term-fg32">+			expectedError: &quot;missing required field &#39;sourceHash&#39;&quot;,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			name: &quot;No mint&quot;,</span>
<span class="term-fg32">+			json: `{&quot;type&quot;:&quot;0x7e&quot;,&quot;nonce&quot;:null,&quot;gas&quot;: &quot;0x1234&quot;, &quot;gasPrice&quot;:null,&quot;maxPriorityFeePerGas&quot;:null,&quot;maxFeePerGas&quot;:null,&quot;value&quot;:&quot;0x1&quot;,&quot;input&quot;:&quot;0x616263646566&quot;,&quot;v&quot;:null,&quot;r&quot;:null,&quot;s&quot;:null,&quot;to&quot;:null,&quot;sourceHash&quot;:&quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;,&quot;from&quot;:&quot;0x0000000000000000000000000000000000000001&quot;,&quot;isSystemTx&quot;:false,&quot;hash&quot;:&quot;0xa4341f3db4363b7ca269a8538bd027b2f8784f84454ca917668642d5f6dffdf9&quot;}`,</span>
<span class="term-fg32">+			&#47;&#47; Allowed</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			name: &quot;No IsSystemTx&quot;,</span>
<span class="term-fg32">+			json: `{&quot;type&quot;:&quot;0x7e&quot;,&quot;nonce&quot;:null,&quot;gas&quot;: &quot;0x1234&quot;, &quot;gasPrice&quot;:null,&quot;maxPriorityFeePerGas&quot;:null,&quot;maxFeePerGas&quot;:null,&quot;value&quot;:&quot;0x1&quot;,&quot;input&quot;:&quot;0x616263646566&quot;,&quot;v&quot;:null,&quot;r&quot;:null,&quot;s&quot;:null,&quot;to&quot;:null,&quot;sourceHash&quot;:&quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;,&quot;from&quot;:&quot;0x0000000000000000000000000000000000000001&quot;,&quot;hash&quot;:&quot;0xa4341f3db4363b7ca269a8538bd027b2f8784f84454ca917668642d5f6dffdf9&quot;}`,</span>
<span class="term-fg32">+			&#47;&#47; Allowed</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	for _, test := range tests {</span>
<span class="term-fg32">+		t.Run(test.name, func(t *testing.T) {</span>
<span class="term-fg32">+			var parsedTx = &amp;Transaction{}</span>
<span class="term-fg32">+			err := json.Unmarshal([]byte(test.json), &amp;parsedTx)</span>
<span class="term-fg32">+			if test.expectedError == &quot;&quot; {</span>
<span class="term-fg32">+				require.NoError(t, err)</span>
<span class="term-fg32">+			} else {</span>
<span class="term-fg32">+				require.ErrorContains(t, err, test.expectedError)</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+		})</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	tests = []struct {</span>
<span class="term-fg32">+		name          string</span>
<span class="term-fg32">+		json          string</span>
<span class="term-fg32">+		expectedError string</span>
<span class="term-fg32">+	}{</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			name: &quot;Valid deposit sender&quot;,</span>
<span class="term-fg32">+			json: `{&quot;type&quot;:&quot;0x7e&quot;,&quot;nonce&quot;:&quot;0x1&quot;,&quot;gas&quot;: &quot;0x1234&quot;, &quot;gasPrice&quot;:null,&quot;maxPriorityFeePerGas&quot;:null,&quot;maxFeePerGas&quot;:null,&quot;value&quot;:&quot;0x1&quot;,&quot;input&quot;:&quot;0x616263646566&quot;,&quot;v&quot;:null,&quot;r&quot;:null,&quot;s&quot;:null,&quot;to&quot;:null,&quot;sourceHash&quot;:&quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;,&quot;from&quot;:&quot;0x0000000000000000000000000000000000000001&quot;,&quot;hash&quot;:&quot;0xa4341f3db4363b7ca269a8538bd027b2f8784f84454ca917668642d5f6dffdf9&quot;}`,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	for _, test := range tests {</span>
<span class="term-fg32">+		t.Run(test.name, func(t *testing.T) {</span>
<span class="term-fg32">+			var parsedTx = &amp;Transaction{}</span>
<span class="term-fg32">+			err := json.Unmarshal([]byte(test.json), &amp;parsedTx)</span>
<span class="term-fg32">+			require.NoError(t, err)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+			signer := NewLondonSigner(big.NewInt(123))</span>
<span class="term-fg32">+			sender, err := signer.Sender(parsedTx)</span>
<span class="term-fg32">+			require.NoError(t, err)</span>
<span class="term-fg32">+			require.Equal(t, common.HexToAddress(&quot;0x1&quot;), sender)</span>
<span class="term-fg32">+		})</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-muted" data-bs-toggle="collapse" href="#id-e4aabd5ab434654a44607f8c" role="button"
                       aria-expanded="false" aria-controls="id-e4aabd5ab434654a44607f8c">
                        <code>core/types/transaction_test.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/core/types/transaction_test.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/core/types/transaction_test.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-add-ignored">+35</span></div>
                            <div class="text-start"><span class="text-delete-ignored">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-e4aabd5ab434654a44607f8c"><span class="term-fg1">diff --git go-ethereum&#47;core&#47;types&#47;transaction_test.go op-geth&#47;core&#47;types&#47;transaction_test.go</span>
<span class="term-fg1">index 5dbf367073b55dd1cc1eafe74bc1ee9c7683dba7..ceab998db8c03890c56af76a84d32ca7d0f1a603 100644</span>
<span class="term-fg1">--- go-ethereum&#47;core&#47;types&#47;transaction_test.go</span>
<span class="term-fg1">+++ op-geth&#47;core&#47;types&#47;transaction_test.go</span>
<span class="term-fg36">@@ -345,6 +345,41 @@</span> 		}
 	}
 }
&nbsp;
<span class="term-fg32">+func TestLegacyTransaction_ConsistenV_LargeChainIds(t *testing.T) {</span>
<span class="term-fg32">+	chainId := new(big.Int).SetUint64(13317435930671861669)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	txdata := &amp;LegacyTx{</span>
<span class="term-fg32">+		Nonce:    1,</span>
<span class="term-fg32">+		Gas:      1,</span>
<span class="term-fg32">+		GasPrice: big.NewInt(2),</span>
<span class="term-fg32">+		Data:     []byte(&quot;abcdef&quot;),</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	key, err := crypto.GenerateKey()</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		t.Fatalf(&quot;could not generate key: %v&quot;, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	tx, err := SignNewTx(key, NewEIP2930Signer(chainId), txdata)</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		t.Fatalf(&quot;could not sign transaction: %v&quot;, err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Make a copy of the initial V value</span>
<span class="term-fg32">+	preV, _, _ := tx.RawSignatureValues()</span>
<span class="term-fg32">+	preV = new(big.Int).Set(preV)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	if tx.ChainId().Cmp(chainId) != 0 {</span>
<span class="term-fg32">+		t.Fatalf(&quot;wrong chain id: %v&quot;, tx.ChainId())</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	v, _, _ := tx.RawSignatureValues()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	if v.Cmp(preV) != 0 {</span>
<span class="term-fg32">+		t.Fatalf(&quot;wrong v value: %v&quot;, v)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
 func encodeDecodeJSON(tx *Transaction) (*Transaction, error) {
 	data, err := json.Marshal(tx)
 	if err != nil {</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-muted" data-bs-toggle="collapse" href="#id-a8bfd0e2e4a02392a593badc" role="button"
                       aria-expanded="false" aria-controls="id-a8bfd0e2e4a02392a593badc">
                        <code>core/vm/contracts_test.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/core/vm/contracts_test.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/core/vm/contracts_test.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-add-ignored">+25</span></div>
                            <div class="text-start"><span class="text-delete-ignored">-1</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-a8bfd0e2e4a02392a593badc"><span class="term-fg1">diff --git go-ethereum&#47;core&#47;vm&#47;contracts_test.go op-geth&#47;core&#47;vm&#47;contracts_test.go</span>
<span class="term-fg1">index fff5c966f34f0deff118edba7f300a205246b26d..414a867f20888aa01f383baf880b10d7126d3dca 100644</span>
<span class="term-fg1">--- go-ethereum&#47;core&#47;vm&#47;contracts_test.go</span>
<span class="term-fg1">+++ op-geth&#47;core&#47;vm&#47;contracts_test.go</span>
<span class="term-fg36">@@ -25,6 +25,7 @@</span> 	&quot;testing&quot;
 	&quot;time&quot;
&nbsp;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&quot;
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;params&quot;</span>
 )
&nbsp;
 &#47;&#47; precompiledTest defines the input&#47;output pairs for precompiled contract tests.
<span class="term-fg36">@@ -54,9 +55,11 @@</span> 	common.BytesToAddress([]byte{5}):    &amp;bigModExp{eip2565: false},
 	common.BytesToAddress([]byte{0xf5}): &amp;bigModExp{eip2565: true},
 	common.BytesToAddress([]byte{6}):    &amp;bn256AddIstanbul{},
 	common.BytesToAddress([]byte{7}):    &amp;bn256ScalarMulIstanbul{},
<span class="term-fg31">-	common.BytesToAddress([]byte{8}):    &amp;bn256PairingIstanbul{},</span>
<span class="term-fg32">+	common.BytesToAddress([]byte{8}):    &amp;bn256PairingGranite{},</span>
 	common.BytesToAddress([]byte{9}):    &amp;blake2F{},
 	common.BytesToAddress([]byte{0x0a}): &amp;kzgPointEvaluation{},
<span class="term-fg32">+</span>
<span class="term-fg32">+	common.BytesToAddress([]byte{0x01, 0x00}): &amp;p256Verify{},</span>
&nbsp;
 	common.BytesToAddress([]byte{0x0f, 0x0a}): &amp;bls12381G1Add{},
 	common.BytesToAddress([]byte{0x0f, 0x0b}): &amp;bls12381G1Mul{},
<span class="term-fg36">@@ -272,6 +275,15 @@</span> 		testPrecompiledFailure(&quot;09&quot;, test, t)
 	}
 }
&nbsp;
<span class="term-fg32">+func TestPrecompileBn256PairingTooLargeInput(t *testing.T) {</span>
<span class="term-fg32">+	big := make([]byte, params.Bn256PairingMaxInputSizeGranite+1)</span>
<span class="term-fg32">+	testPrecompiledFailure(&quot;08&quot;, precompiledFailureTest{</span>
<span class="term-fg32">+		Input:         common.Bytes2Hex(big),</span>
<span class="term-fg32">+		ExpectedError: &quot;bad elliptic curve pairing input size&quot;,</span>
<span class="term-fg32">+		Name:          &quot;bn256Pairing_input_too_big&quot;,</span>
<span class="term-fg32">+	}, t)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
 func TestPrecompiledEcrecover(t *testing.T) { testJson(&quot;ecRecover&quot;, &quot;01&quot;, t) }
&nbsp;
 func testJson(name, addr string, t *testing.T) {
<span class="term-fg36">@@ -397,3 +409,15 @@</span> 		NoBenchmark: false,
 	}
 	benchmarkPrecompiled(&quot;f0f&quot;, testcase, b)
 }
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; Benchmarks the sample inputs from the P256VERIFY precompile.</span>
<span class="term-fg32">+func BenchmarkPrecompiledP256Verify(bench *testing.B) {</span>
<span class="term-fg32">+	t := precompiledTest{</span>
<span class="term-fg32">+		Input:    &quot;4cee90eb86eaa050036147a12d49004b6b9c72bd725d39d4785011fe190f0b4da73bd4903f0ce3b639bbbf6e8e80d16931ff4bcf5993d58468e8fb19086e8cac36dbcd03009df8c59286b162af3bd7fcc0450c9aa81be5d10d312af6c66b1d604aebd3099c618202fcfe16ae7770b0c49ab5eadf74b754204a3bb6060e44eff37618b065f9832de4ca6ca971a7a1adc826d0f7c00181a5fb2ddf79ae00b4e10e&quot;,</span>
<span class="term-fg32">+		Expected: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+		Name:     &quot;p256Verify&quot;,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	benchmarkPrecompiled(&quot;100&quot;, t, bench)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func TestPrecompiledP256Verify(t *testing.T) { testJson(&quot;p256Verify&quot;, &quot;100&quot;, t) }</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-muted" data-bs-toggle="collapse" href="#id-e231d300534ca372353f3618" role="button"
                       aria-expanded="false" aria-controls="id-e231d300534ca372353f3618">
                        <code>core/vm/gas_table_test.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/core/vm/gas_table_test.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/core/vm/gas_table_test.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-add-ignored">+1</span></div>
                            <div class="text-start"><span class="text-delete-ignored">-1</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-e231d300534ca372353f3618"><span class="term-fg1">diff --git go-ethereum&#47;core&#47;vm&#47;gas_table_test.go op-geth&#47;core&#47;vm&#47;gas_table_test.go</span>
<span class="term-fg1">index 02fc94840d60e834e9f96aee5a51b05dafaa6c54..4d9c5506ba3b3f08fea1976701bafa3935f5c4f6 100644</span>
<span class="term-fg1">--- go-ethereum&#47;core&#47;vm&#47;gas_table_test.go</span>
<span class="term-fg1">+++ op-geth&#47;core&#47;vm&#47;gas_table_test.go</span>
<span class="term-fg36">@@ -118,7 +118,7 @@</span> 	gasUsed    uint64
 	minimumGas uint64
 }{
 	&#47;&#47; legacy create(0, 0, 0xc000) without 3860 used
<span class="term-fg31">-	{&quot;0x61C00060006000f0&quot; + &quot;600052&quot; + &quot;60206000F3&quot;, false, 41237, 41237},</span>
<span class="term-fg32">+	{&quot;0x61C00060006000f0&quot; + &quot;600052&quot; + &quot;60206000F3&quot;, false, 41237, 41237}, &#47;&#47;nolint:all</span>
 	&#47;&#47; legacy create(0, 0, 0xc000) _with_ 3860
 	{&quot;0x61C00060006000f0&quot; + &quot;600052&quot; + &quot;60206000F3&quot;, true, 44309, 44309},
 	&#47;&#47; create2(0, 0, 0xc001, 0) without 3860</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-muted" data-bs-toggle="collapse" href="#id-74cf00a878bca3d37119bcc2" role="button"
                       aria-expanded="false" aria-controls="id-74cf00a878bca3d37119bcc2">
                        <code>crypto/secp256k1/secp256_test.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/secp256_test.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-add-ignored">+0</span></div>
                            <div class="text-start"><span class="text-delete-ignored">-240</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-74cf00a878bca3d37119bcc2"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;secp256_test.go op-geth&#47;crypto&#47;secp256k1&#47;secp256_test.go</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 4827cc5b255c49838b91ca8f24020d1f066b4716..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;secp256_test.go</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,240 +0,0 @@</span>
<span class="term-fg31">-&#47;&#47; Copyright 2015 Jeffrey Wilcke, Felix Lange, Gustav Simonsson. All rights reserved.</span>
<span class="term-fg31">-&#47;&#47; Use of this source code is governed by a BSD-style license that can be found in</span>
<span class="term-fg31">-&#47;&#47; the LICENSE file.</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;&#47;go:build !gofuzz &amp;&amp; cgo</span>
<span class="term-fg31">-&#47;&#47; +build !gofuzz,cgo</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-package secp256k1</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-import (</span>
<span class="term-fg31">-	&quot;bytes&quot;</span>
<span class="term-fg31">-	&quot;crypto&#47;ecdsa&quot;</span>
<span class="term-fg31">-	&quot;crypto&#47;rand&quot;</span>
<span class="term-fg31">-	&quot;encoding&#47;hex&quot;</span>
<span class="term-fg31">-	&quot;io&quot;</span>
<span class="term-fg31">-	&quot;testing&quot;</span>
<span class="term-fg31">-)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-const TestCount = 1000</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-func generateKeyPair() (pubkey, privkey []byte) {</span>
<span class="term-fg31">-	key, err := ecdsa.GenerateKey(S256(), rand.Reader)</span>
<span class="term-fg31">-	if err != nil {</span>
<span class="term-fg31">-		panic(err)</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-	pubkey = S256().Marshal(key.X, key.Y)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	privkey = make([]byte, 32)</span>
<span class="term-fg31">-	blob := key.D.Bytes()</span>
<span class="term-fg31">-	copy(privkey[32-len(blob):], blob)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	return pubkey, privkey</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-func csprngEntropy(n int) []byte {</span>
<span class="term-fg31">-	buf := make([]byte, n)</span>
<span class="term-fg31">-	if _, err := io.ReadFull(rand.Reader, buf); err != nil {</span>
<span class="term-fg31">-		panic(&quot;reading from crypto&#47;rand failed: &quot; + err.Error())</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-	return buf</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-func randSig() []byte {</span>
<span class="term-fg31">-	sig := csprngEntropy(65)</span>
<span class="term-fg31">-	sig[32] &amp;= 0x70</span>
<span class="term-fg31">-	sig[64] %= 4</span>
<span class="term-fg31">-	return sig</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;&#47; tests for malleability</span>
<span class="term-fg31">-&#47;&#47; the highest bit of signature ECDSA s value must be 0, in the 33th byte</span>
<span class="term-fg31">-func compactSigCheck(t *testing.T, sig []byte) {</span>
<span class="term-fg31">-	var b = int(sig[32])</span>
<span class="term-fg31">-	if b &lt; 0 {</span>
<span class="term-fg31">-		t.Errorf(&quot;highest bit is negative: %d&quot;, b)</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-	if ((b &gt;&gt; 7) == 1) != ((b &amp; 0x80) == 0x80) {</span>
<span class="term-fg31">-		t.Errorf(&quot;highest bit: %d bit &gt;&gt; 7: %d&quot;, b, b&gt;&gt;7)</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-	if (b &amp; 0x80) == 0x80 {</span>
<span class="term-fg31">-		t.Errorf(&quot;highest bit: %d bit &amp; 0x80: %d&quot;, b, b&amp;0x80)</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-func TestSignatureValidity(t *testing.T) {</span>
<span class="term-fg31">-	pubkey, seckey := generateKeyPair()</span>
<span class="term-fg31">-	msg := csprngEntropy(32)</span>
<span class="term-fg31">-	sig, err := Sign(msg, seckey)</span>
<span class="term-fg31">-	if err != nil {</span>
<span class="term-fg31">-		t.Errorf(&quot;signature error: %s&quot;, err)</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-	compactSigCheck(t, sig)</span>
<span class="term-fg31">-	if len(pubkey) != 65 {</span>
<span class="term-fg31">-		t.Errorf(&quot;pubkey length mismatch: want: 65 have: %d&quot;, len(pubkey))</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-	if len(seckey) != 32 {</span>
<span class="term-fg31">-		t.Errorf(&quot;seckey length mismatch: want: 32 have: %d&quot;, len(seckey))</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-	if len(sig) != 65 {</span>
<span class="term-fg31">-		t.Errorf(&quot;sig length mismatch: want: 65 have: %d&quot;, len(sig))</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-	recid := int(sig[64])</span>
<span class="term-fg31">-	if recid &gt; 4 || recid &lt; 0 {</span>
<span class="term-fg31">-		t.Errorf(&quot;sig recid mismatch: want: within 0 to 4 have: %d&quot;, int(sig[64]))</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-func TestInvalidRecoveryID(t *testing.T) {</span>
<span class="term-fg31">-	_, seckey := generateKeyPair()</span>
<span class="term-fg31">-	msg := csprngEntropy(32)</span>
<span class="term-fg31">-	sig, _ := Sign(msg, seckey)</span>
<span class="term-fg31">-	sig[64] = 99</span>
<span class="term-fg31">-	_, err := RecoverPubkey(msg, sig)</span>
<span class="term-fg31">-	if err != ErrInvalidRecoveryID {</span>
<span class="term-fg31">-		t.Fatalf(&quot;got %q, want %q&quot;, err, ErrInvalidRecoveryID)</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-func TestSignAndRecover(t *testing.T) {</span>
<span class="term-fg31">-	pubkey1, seckey := generateKeyPair()</span>
<span class="term-fg31">-	msg := csprngEntropy(32)</span>
<span class="term-fg31">-	sig, err := Sign(msg, seckey)</span>
<span class="term-fg31">-	if err != nil {</span>
<span class="term-fg31">-		t.Errorf(&quot;signature error: %s&quot;, err)</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-	pubkey2, err := RecoverPubkey(msg, sig)</span>
<span class="term-fg31">-	if err != nil {</span>
<span class="term-fg31">-		t.Errorf(&quot;recover error: %s&quot;, err)</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-	if !bytes.Equal(pubkey1, pubkey2) {</span>
<span class="term-fg31">-		t.Errorf(&quot;pubkey mismatch: want: %x have: %x&quot;, pubkey1, pubkey2)</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-func TestSignDeterministic(t *testing.T) {</span>
<span class="term-fg31">-	_, seckey := generateKeyPair()</span>
<span class="term-fg31">-	msg := make([]byte, 32)</span>
<span class="term-fg31">-	copy(msg, &quot;hi there&quot;)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	sig1, err := Sign(msg, seckey)</span>
<span class="term-fg31">-	if err != nil {</span>
<span class="term-fg31">-		t.Fatal(err)</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-	sig2, err := Sign(msg, seckey)</span>
<span class="term-fg31">-	if err != nil {</span>
<span class="term-fg31">-		t.Fatal(err)</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-	if !bytes.Equal(sig1, sig2) {</span>
<span class="term-fg31">-		t.Fatal(&quot;signatures not equal&quot;)</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-func TestRandomMessagesWithSameKey(t *testing.T) {</span>
<span class="term-fg31">-	pubkey, seckey := generateKeyPair()</span>
<span class="term-fg31">-	keys := func() ([]byte, []byte) {</span>
<span class="term-fg31">-		return pubkey, seckey</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-	signAndRecoverWithRandomMessages(t, keys)</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-func TestRandomMessagesWithRandomKeys(t *testing.T) {</span>
<span class="term-fg31">-	keys := func() ([]byte, []byte) {</span>
<span class="term-fg31">-		pubkey, seckey := generateKeyPair()</span>
<span class="term-fg31">-		return pubkey, seckey</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-	signAndRecoverWithRandomMessages(t, keys)</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-func signAndRecoverWithRandomMessages(t *testing.T, keys func() ([]byte, []byte)) {</span>
<span class="term-fg31">-	for i := 0; i &lt; TestCount; i++ {</span>
<span class="term-fg31">-		pubkey1, seckey := keys()</span>
<span class="term-fg31">-		msg := csprngEntropy(32)</span>
<span class="term-fg31">-		sig, err := Sign(msg, seckey)</span>
<span class="term-fg31">-		if err != nil {</span>
<span class="term-fg31">-			t.Fatalf(&quot;signature error: %s&quot;, err)</span>
<span class="term-fg31">-		}</span>
<span class="term-fg31">-		if sig == nil {</span>
<span class="term-fg31">-			t.Fatal(&quot;signature is nil&quot;)</span>
<span class="term-fg31">-		}</span>
<span class="term-fg31">-		compactSigCheck(t, sig)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-		&#47;&#47; TODO: why do we flip around the recovery id?</span>
<span class="term-fg31">-		sig[len(sig)-1] %= 4</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-		pubkey2, err := RecoverPubkey(msg, sig)</span>
<span class="term-fg31">-		if err != nil {</span>
<span class="term-fg31">-			t.Fatalf(&quot;recover error: %s&quot;, err)</span>
<span class="term-fg31">-		}</span>
<span class="term-fg31">-		if pubkey2 == nil {</span>
<span class="term-fg31">-			t.Error(&quot;pubkey is nil&quot;)</span>
<span class="term-fg31">-		}</span>
<span class="term-fg31">-		if !bytes.Equal(pubkey1, pubkey2) {</span>
<span class="term-fg31">-			t.Fatalf(&quot;pubkey mismatch: want: %x have: %x&quot;, pubkey1, pubkey2)</span>
<span class="term-fg31">-		}</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-func TestRecoveryOfRandomSignature(t *testing.T) {</span>
<span class="term-fg31">-	pubkey1, _ := generateKeyPair()</span>
<span class="term-fg31">-	msg := csprngEntropy(32)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	for i := 0; i &lt; TestCount; i++ {</span>
<span class="term-fg31">-		&#47;&#47; recovery can sometimes work, but if so should always give wrong pubkey</span>
<span class="term-fg31">-		pubkey2, _ := RecoverPubkey(msg, randSig())</span>
<span class="term-fg31">-		if bytes.Equal(pubkey1, pubkey2) {</span>
<span class="term-fg31">-			t.Fatalf(&quot;iteration: %d: pubkey mismatch: do NOT want %x: &quot;, i, pubkey2)</span>
<span class="term-fg31">-		}</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-func TestRandomMessagesAgainstValidSig(t *testing.T) {</span>
<span class="term-fg31">-	pubkey1, seckey := generateKeyPair()</span>
<span class="term-fg31">-	msg := csprngEntropy(32)</span>
<span class="term-fg31">-	sig, _ := Sign(msg, seckey)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	for i := 0; i &lt; TestCount; i++ {</span>
<span class="term-fg31">-		msg = csprngEntropy(32)</span>
<span class="term-fg31">-		pubkey2, _ := RecoverPubkey(msg, sig)</span>
<span class="term-fg31">-		&#47;&#47; recovery can sometimes work, but if so should always give wrong pubkey</span>
<span class="term-fg31">-		if bytes.Equal(pubkey1, pubkey2) {</span>
<span class="term-fg31">-			t.Fatalf(&quot;iteration: %d: pubkey mismatch: do NOT want %x: &quot;, i, pubkey2)</span>
<span class="term-fg31">-		}</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;&#47; Useful when the underlying libsecp256k1 API changes to quickly</span>
<span class="term-fg31">-&#47;&#47; check only recover function without use of signature function</span>
<span class="term-fg31">-func TestRecoverSanity(t *testing.T) {</span>
<span class="term-fg31">-	msg, _ := hex.DecodeString(&quot;ce0677bb30baa8cf067c88db9811f4333d131bf8bcf12fe7065d211dce971008&quot;)</span>
<span class="term-fg31">-	sig, _ := hex.DecodeString(&quot;90f27b8b488db00b00606796d2987f6a5f59ae62ea05effe84fef5b8b0e549984a691139ad57a3f0b906637673aa2f63d1f55cb1a69199d4009eea23ceaddc9301&quot;)</span>
<span class="term-fg31">-	pubkey1, _ := hex.DecodeString(&quot;04e32df42865e97135acfb65f3bae71bdc86f4d49150ad6a440b6f15878109880a0a2b2667f7e725ceea70c673093bf67663e0312623c8e091b13cf2c0f11ef652&quot;)</span>
<span class="term-fg31">-	pubkey2, err := RecoverPubkey(msg, sig)</span>
<span class="term-fg31">-	if err != nil {</span>
<span class="term-fg31">-		t.Fatalf(&quot;recover error: %s&quot;, err)</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-	if !bytes.Equal(pubkey1, pubkey2) {</span>
<span class="term-fg31">-		t.Errorf(&quot;pubkey mismatch: want: %x have: %x&quot;, pubkey1, pubkey2)</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-func BenchmarkSign(b *testing.B) {</span>
<span class="term-fg31">-	_, seckey := generateKeyPair()</span>
<span class="term-fg31">-	msg := csprngEntropy(32)</span>
<span class="term-fg31">-	b.ResetTimer()</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	for i := 0; i &lt; b.N; i++ {</span>
<span class="term-fg31">-		Sign(msg, seckey)</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-func BenchmarkRecover(b *testing.B) {</span>
<span class="term-fg31">-	msg := csprngEntropy(32)</span>
<span class="term-fg31">-	_, seckey := generateKeyPair()</span>
<span class="term-fg31">-	sig, _ := Sign(msg, seckey)</span>
<span class="term-fg31">-	b.ResetTimer()</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	for i := 0; i &lt; b.N; i++ {</span>
<span class="term-fg31">-		RecoverPubkey(msg, sig)</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-muted" data-bs-toggle="collapse" href="#id-66013c3de79e358c256f246e" role="button"
                       aria-expanded="false" aria-controls="id-66013c3de79e358c256f246e">
                        <code>crypto/signify/signify_test.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/signify/signify_test.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/crypto/signify/signify_test.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-add-ignored">+1</span></div>
                            <div class="text-start"><span class="text-delete-ignored">-1</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-66013c3de79e358c256f246e"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;signify&#47;signify_test.go op-geth&#47;crypto&#47;signify&#47;signify_test.go</span>
<span class="term-fg1">index 9bac2c825f2c844bff70f7566bbe3d953a16f583..56195649dfb3b2ccfcc3e5239bae8bd33d28796a 100644</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;signify&#47;signify_test.go</span>
<span class="term-fg1">+++ op-geth&#47;crypto&#47;signify&#47;signify_test.go</span>
<span class="term-fg36">@@ -48,7 +48,7 @@</span> 	if err = tmpFile.Close(); err != nil {
 		t.Fatal(err)
 	}
&nbsp;
<span class="term-fg31">-	err = SignFile(tmpFile.Name(), tmpFile.Name()+&quot;.sig&quot;, testSecKey, &quot;cl&quot;, &quot;croissants&quot;)</span>
<span class="term-fg32">+	err = SignFile(tmpFile.Name(), tmpFile.Name()+&quot;.sig&quot;, testSecKey, &quot;cl&quot;, &quot;croissants&quot;) &#47;&#47;nolint:all</span>
 	if err != nil {
 		t.Fatal(err)
 	}</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-muted" data-bs-toggle="collapse" href="#id-6ef0eeabd003d40270a283f7" role="button"
                       aria-expanded="false" aria-controls="id-6ef0eeabd003d40270a283f7">
                        <code>eth/catalyst/api_test.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/eth/catalyst/api_test.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/eth/catalyst/api_test.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-add-ignored">+33</span></div>
                            <div class="text-start"><span class="text-delete-ignored">-9</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-6ef0eeabd003d40270a283f7"><span class="term-fg1">diff --git go-ethereum&#47;eth&#47;catalyst&#47;api_test.go op-geth&#47;eth&#47;catalyst&#47;api_test.go</span>
<span class="term-fg1">index 64e6684be15500c00f3b2f99bbd02b3295e2fc24..2ceb9139ec11c965e03148d08c138f558132dd03 100644</span>
<span class="term-fg1">--- go-ethereum&#47;eth&#47;catalyst&#47;api_test.go</span>
<span class="term-fg1">+++ op-geth&#47;eth&#47;catalyst&#47;api_test.go</span>
<span class="term-fg36">@@ -28,6 +28,8 @@</span> 	&quot;sync&quot;
 	&quot;testing&quot;
 	&quot;time&quot;
&nbsp;
<span class="term-fg32">+	&quot;github.com&#47;stretchr&#47;testify&#47;require&quot;</span>
<span class="term-fg32">+</span>
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;beacon&#47;engine&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&#47;hexutil&quot;
<span class="term-fg36">@@ -198,12 +200,10 @@</span> 		HeadBlockHash:      blocks[8].Hash(),
 		SafeBlockHash:      common.Hash{},
 		FinalizedBlockHash: common.Hash{},
 	}
<span class="term-fg31">-	_, err := api.ForkchoiceUpdatedV1(fcState, &amp;blockParams)</span>
<span class="term-fg32">+	resp, err := api.ForkchoiceUpdatedV1(fcState, &amp;blockParams)</span>
 	if err != nil {
 		t.Fatalf(&quot;error preparing payload, err=%v&quot;, err)
 	}
<span class="term-fg31">-	&#47;&#47; give the payload some time to be built</span>
<span class="term-fg31">-	time.Sleep(100 * time.Millisecond)</span>
 	payloadID := (&amp;miner.BuildPayloadArgs{
 		Parent:       fcState.HeadBlockHash,
 		Timestamp:    blockParams.Timestamp,
<span class="term-fg36">@@ -212,6 +212,8 @@</span> 		Random:       blockParams.Random,
 		BeaconRoot:   blockParams.BeaconRoot,
 		Version:      engine.PayloadV1,
 	}).Id()
<span class="term-fg32">+	require.Equal(t, payloadID, *resp.PayloadID)</span>
<span class="term-fg32">+	require.NoError(t, waitForApiPayloadToBuild(api, *resp.PayloadID))</span>
 	execData, err := api.GetPayloadV1(payloadID)
 	if err != nil {
 		t.Fatalf(&quot;error getting payload, err=%v&quot;, err)
<span class="term-fg36">@@ -435,6 +437,13 @@</span> }
&nbsp;
 &#47;&#47; startEthService creates a full node instance for testing.
 func startEthService(t *testing.T, genesis *core.Genesis, blocks []*types.Block) (*node.Node, *eth.Ethereum) {
<span class="term-fg32">+	mcfg := miner.DefaultConfig</span>
<span class="term-fg32">+	mcfg.PendingFeeRecipient = testAddr</span>
<span class="term-fg32">+	ethcfg := &amp;ethconfig.Config{Genesis: genesis, SyncMode: downloader.FullSync, TrieTimeout: time.Minute, TrieDirtyCache: 256, TrieCleanCache: 256, Miner: mcfg}</span>
<span class="term-fg32">+	return startEthServiceWithConfigFn(t, blocks, ethcfg)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func startEthServiceWithConfigFn(t *testing.T, blocks []*types.Block, ethcfg *ethconfig.Config) (*node.Node, *eth.Ethereum) {</span>
 	t.Helper()
&nbsp;
 	n, err := node.New(&amp;node.Config{
<span class="term-fg36">@@ -447,9 +456,7 @@</span> 	if err != nil {
 		t.Fatal(&quot;can&#39;t create node:&quot;, err)
 	}
&nbsp;
<span class="term-fg31">-	mcfg := miner.DefaultConfig</span>
<span class="term-fg31">-	mcfg.PendingFeeRecipient = testAddr</span>
<span class="term-fg31">-	ethcfg := &amp;ethconfig.Config{Genesis: genesis, SyncMode: downloader.FullSync, TrieTimeout: time.Minute, TrieDirtyCache: 256, TrieCleanCache: 256, Miner: mcfg}</span>
<span class="term-fg32">+	&#47;&#47; default eth config is moved to startEthService</span>
 	ethservice, err := eth.New(n, ethcfg)
 	if err != nil {
 		t.Fatal(&quot;can&#39;t create eth service:&quot;, err)
<span class="term-fg36">@@ -629,8 +636,7 @@</span> 			}
 			if resp.PayloadStatus.Status != engine.VALID {
 				t.Fatalf(&quot;error preparing payload, invalid status: %v&quot;, resp.PayloadStatus.Status)
 			}
<span class="term-fg31">-			&#47;&#47; give the payload some time to be built</span>
<span class="term-fg31">-			time.Sleep(50 * time.Millisecond)</span>
<span class="term-fg32">+			require.NoError(t, waitForApiPayloadToBuild(api, *resp.PayloadID))</span>
 			if payload, err = api.GetPayloadV1(*resp.PayloadID); err != nil {
 				t.Fatalf(&quot;can&#39;t get payload: %v&quot;, err)
 			}
<span class="term-fg36">@@ -678,6 +684,7 @@</span> 	payload, err := api.eth.Miner().BuildPayload(args)
 	if err != nil {
 		return nil, err
 	}
<span class="term-fg32">+	waitForPayloadToBuild(payload)</span>
 	return payload.ResolveFull().ExecutionPayload, nil
 }
&nbsp;
<span class="term-fg36">@@ -915,6 +922,7 @@</span> 	payload, err := api.eth.Miner().BuildPayload(args)
 	if err != nil {
 		t.Fatalf(&quot;error preparing payload, err=%v&quot;, err)
 	}
<span class="term-fg32">+	waitForPayloadToBuild(payload)</span>
 	data := *payload.Resolve().ExecutionPayload
 	&#47;&#47; We need to recompute the blockhash, since the miner computes a wrong (correct) blockhash
 	txs, _ := decodeTransactions(data.Transactions)
<span class="term-fg36">@@ -1075,6 +1083,8 @@</span> 		Withdrawals:  blockParams.Withdrawals,
 		BeaconRoot:   blockParams.BeaconRoot,
 		Version:      engine.PayloadV2,
 	}).Id()
<span class="term-fg32">+	require.Equal(t, payloadID, *resp.PayloadID)</span>
<span class="term-fg32">+	require.NoError(t, waitForApiPayloadToBuild(api, payloadID))</span>
 	execData, err := api.GetPayloadV2(payloadID)
 	if err != nil {
 		t.Fatalf(&quot;error getting payload, err=%v&quot;, err)
<span class="term-fg36">@@ -1109,7 +1119,7 @@</span> 			},
 		},
 	}
 	fcState.HeadBlockHash = execData.ExecutionPayload.BlockHash
<span class="term-fg31">-	_, err = api.ForkchoiceUpdatedV2(fcState, &amp;blockParams)</span>
<span class="term-fg32">+	resp, err = api.ForkchoiceUpdatedV2(fcState, &amp;blockParams)</span>
 	if err != nil {
 		t.Fatalf(&quot;error preparing payload, err=%v&quot;, err)
 	}
<span class="term-fg36">@@ -1124,6 +1134,8 @@</span> 		Withdrawals:  blockParams.Withdrawals,
 		BeaconRoot:   blockParams.BeaconRoot,
 		Version:      engine.PayloadV2,
 	}).Id()
<span class="term-fg32">+	require.Equal(t, payloadID, *resp.PayloadID)</span>
<span class="term-fg32">+	require.NoError(t, waitForApiPayloadToBuild(api, payloadID))</span>
 	execData, err = api.GetPayloadV2(payloadID)
 	if err != nil {
 		t.Fatalf(&quot;error getting payload, err=%v&quot;, err)
<span class="term-fg36">@@ -1263,6 +1275,8 @@</span> 			Parent:       fcState.HeadBlockHash,
 			Timestamp:    test.blockParams.Timestamp,
 			FeeRecipient: test.blockParams.SuggestedFeeRecipient,
 			Random:       test.blockParams.Random,
<span class="term-fg32">+			BeaconRoot:   test.blockParams.BeaconRoot,</span>
<span class="term-fg32">+			Withdrawals:  test.blockParams.Withdrawals,</span>
 			Version:      payloadVersion,
 		}).Id()
 		execData, err := api.GetPayloadV2(payloadID)
<span class="term-fg36">@@ -1619,6 +1633,8 @@</span> 		Withdrawals:  blockParams.Withdrawals,
 		BeaconRoot:   blockParams.BeaconRoot,
 		Version:      engine.PayloadV3,
 	}).Id()
<span class="term-fg32">+	require.Equal(t, payloadID, *resp.PayloadID)</span>
<span class="term-fg32">+	require.NoError(t, waitForApiPayloadToBuild(api, *resp.PayloadID))</span>
 	execData, err := api.GetPayloadV3(payloadID)
 	if err != nil {
 		t.Fatalf(&quot;error getting payload, err=%v&quot;, err)
<span class="term-fg36">@@ -1656,6 +1672,14 @@</span> 	}
 	if root := db.GetState(params.BeaconRootsAddress, rootIdx); root != *blockParams.BeaconRoot {
 		t.Fatalf(&quot;incorrect root stored: want %s, got %s&quot;, *blockParams.BeaconRoot, root)
 	}
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func waitForPayloadToBuild(payload *miner.Payload) {</span>
<span class="term-fg32">+	payload.WaitFull()</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func waitForApiPayloadToBuild(api *ConsensusAPI, id engine.PayloadID) error {</span>
<span class="term-fg32">+	return api.localBlocks.waitFull(id)</span>
 }
&nbsp;
 &#47;&#47; TestGetClientVersion verifies the expected version info is returned.</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-muted" data-bs-toggle="collapse" href="#id-5b7a7e9a639d20453144ed78" role="button"
                       aria-expanded="false" aria-controls="id-5b7a7e9a639d20453144ed78">
                        <code>eth/catalyst/superchain_test.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/eth/catalyst/superchain_test.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-add-ignored">+120</span></div>
                            <div class="text-start"><span class="text-delete-ignored">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-5b7a7e9a639d20453144ed78"><span class="term-fg1">diff --git go-ethereum&#47;eth&#47;catalyst&#47;superchain_test.go op-geth&#47;eth&#47;catalyst&#47;superchain_test.go</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..4fd46a4c1257c38998878071ef618a71849e6d6e</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ op-geth&#47;eth&#47;catalyst&#47;superchain_test.go</span>
<span class="term-fg36">@@ -0,0 +1,120 @@</span>
<span class="term-fg32">+package catalyst</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+import (</span>
<span class="term-fg32">+	&quot;testing&quot;</span>
<span class="term-fg32">+	&quot;time&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;eth&#47;downloader&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;eth&#47;ethconfig&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;node&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;params&quot;</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func TestSignalSuperchainV1(t *testing.T) {</span>
<span class="term-fg32">+	genesis, preMergeBlocks := generateMergeChain(2, false)</span>
<span class="term-fg32">+	n, ethservice := startEthService(t, genesis, preMergeBlocks)</span>
<span class="term-fg32">+	defer n.Close()</span>
<span class="term-fg32">+	api := NewConsensusAPI(ethservice)</span>
<span class="term-fg32">+	t.Run(&quot;matching&quot;, func(t *testing.T) {</span>
<span class="term-fg32">+		out, err := api.SignalSuperchainV1(&amp;SuperchainSignal{</span>
<span class="term-fg32">+			Recommended: params.OPStackSupport,</span>
<span class="term-fg32">+			Required:    params.OPStackSupport,</span>
<span class="term-fg32">+		})</span>
<span class="term-fg32">+		if err != nil {</span>
<span class="term-fg32">+			t.Fatalf(&quot;failed to process signal: %v&quot;, err)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		if out != params.OPStackSupport {</span>
<span class="term-fg32">+			t.Fatalf(&quot;expected %s but got %s&quot;, params.OPStackSupport, out)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	})</span>
<span class="term-fg32">+	t.Run(&quot;null_arg&quot;, func(t *testing.T) {</span>
<span class="term-fg32">+		out, err := api.SignalSuperchainV1(nil)</span>
<span class="term-fg32">+		if err != nil {</span>
<span class="term-fg32">+			t.Fatalf(&quot;failed to process signal: %v&quot;, err)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		if out != params.OPStackSupport {</span>
<span class="term-fg32">+			t.Fatalf(&quot;expected %s but got %s&quot;, params.OPStackSupport, out)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	})</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func TestSignalSuperchainV1Halt(t *testing.T) {</span>
<span class="term-fg32">+	&#47;&#47; Note: depending on the params.OPStackSupport some types of bumps are not possible with active prerelease</span>
<span class="term-fg32">+	testCases := []struct {</span>
<span class="term-fg32">+		cfg  string</span>
<span class="term-fg32">+		bump string</span>
<span class="term-fg32">+		halt bool</span>
<span class="term-fg32">+	}{</span>
<span class="term-fg32">+		{&quot;none&quot;, &quot;major&quot;, false},</span>
<span class="term-fg32">+		{&quot;major&quot;, &quot;major&quot;, true},</span>
<span class="term-fg32">+		{&quot;minor&quot;, &quot;major&quot;, true},</span>
<span class="term-fg32">+		{&quot;patch&quot;, &quot;major&quot;, true},</span>
<span class="term-fg32">+		{&quot;major&quot;, &quot;minor&quot;, false},</span>
<span class="term-fg32">+		{&quot;minor&quot;, &quot;minor&quot;, true},</span>
<span class="term-fg32">+		{&quot;patch&quot;, &quot;minor&quot;, true},</span>
<span class="term-fg32">+		{&quot;major&quot;, &quot;patch&quot;, false},</span>
<span class="term-fg32">+		{&quot;minor&quot;, &quot;patch&quot;, false},</span>
<span class="term-fg32">+		{&quot;patch&quot;, &quot;patch&quot;, true},</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	for _, tc := range testCases {</span>
<span class="term-fg32">+		tc := tc</span>
<span class="term-fg32">+		t.Run(tc.cfg+&quot;_&quot;+tc.bump, func(t *testing.T) {</span>
<span class="term-fg32">+			genesis, preMergeBlocks := generateMergeChain(2, false)</span>
<span class="term-fg32">+			ethcfg := &amp;ethconfig.Config{Genesis: genesis, SyncMode: downloader.FullSync, TrieTimeout: time.Minute, TrieDirtyCache: 256, TrieCleanCache: 256}</span>
<span class="term-fg32">+			ethcfg.RollupHaltOnIncompatibleProtocolVersion = tc.cfg &#47;&#47; opt-in to halting (or not)</span>
<span class="term-fg32">+			n, ethservice := startEthServiceWithConfigFn(t, preMergeBlocks, ethcfg)</span>
<span class="term-fg32">+			defer n.Close() &#47;&#47; close at the end, regardless of any prior (failed) closing</span>
<span class="term-fg32">+			api := NewConsensusAPI(ethservice)</span>
<span class="term-fg32">+			_, build, major, minor, patch, preRelease := params.OPStackSupport.Parse()</span>
<span class="term-fg32">+			if preRelease != 0 { &#47;&#47; transform back from prerelease, so we can do a clean version bump</span>
<span class="term-fg32">+				if patch != 0 {</span>
<span class="term-fg32">+					patch -= 1</span>
<span class="term-fg32">+				} else if minor != 0 {</span>
<span class="term-fg32">+					&#47;&#47; can&#39;t patch-bump e.g. v3.1.0-1, the prerelease forces a minor bump:</span>
<span class="term-fg32">+					&#47;&#47; v3.0.999 is lower than the prerelease, v3.1.1-1 is a prerelease of v3.1.1.</span>
<span class="term-fg32">+					if tc.bump == &quot;patch&quot; {</span>
<span class="term-fg32">+						t.Skip()</span>
<span class="term-fg32">+					}</span>
<span class="term-fg32">+					minor -= 1</span>
<span class="term-fg32">+				} else if major != 0 {</span>
<span class="term-fg32">+					if tc.bump == &quot;minor&quot; || tc.bump == &quot;patch&quot; { &#47;&#47; can&#39;t minor-bump or patch-bump</span>
<span class="term-fg32">+						t.Skip()</span>
<span class="term-fg32">+					}</span>
<span class="term-fg32">+					major -= 1</span>
<span class="term-fg32">+				}</span>
<span class="term-fg32">+				preRelease = 0</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+			majorSignal, minorSignal, patchSignal := major, minor, patch</span>
<span class="term-fg32">+			switch tc.bump {</span>
<span class="term-fg32">+			case &quot;major&quot;:</span>
<span class="term-fg32">+				majorSignal += 1</span>
<span class="term-fg32">+			case &quot;minor&quot;:</span>
<span class="term-fg32">+				minorSignal += 1</span>
<span class="term-fg32">+			case &quot;patch&quot;:</span>
<span class="term-fg32">+				patchSignal += 1</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+			out, err := api.SignalSuperchainV1(&amp;SuperchainSignal{</span>
<span class="term-fg32">+				Recommended: params.OPStackSupport, &#47;&#47; required version change should be enough</span>
<span class="term-fg32">+				Required:    params.ProtocolVersionV0{Build: build, Major: majorSignal, Minor: minorSignal, Patch: patchSignal, PreRelease: preRelease}.Encode(),</span>
<span class="term-fg32">+			})</span>
<span class="term-fg32">+			if err != nil {</span>
<span class="term-fg32">+				t.Fatalf(&quot;failed to process signal: %v&quot;, err)</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+			if out != params.OPStackSupport {</span>
<span class="term-fg32">+				t.Fatalf(&quot;expected %s but got %s&quot;, params.OPStackSupport, out)</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+			closeErr := n.Close()</span>
<span class="term-fg32">+			if !tc.halt {</span>
<span class="term-fg32">+				&#47;&#47; assert no halt by closing, and not getting any error</span>
<span class="term-fg32">+				if closeErr != nil {</span>
<span class="term-fg32">+					t.Fatalf(&quot;expected not to have closed already, but just closed without error&quot;)</span>
<span class="term-fg32">+				}</span>
<span class="term-fg32">+			} else {</span>
<span class="term-fg32">+				&#47;&#47; assert halt by closing again, and seeing if we are not stopped already</span>
<span class="term-fg32">+				if closeErr != node.ErrNodeStopped {</span>
<span class="term-fg32">+					t.Fatalf(&quot;expected to have already closed and get a ErrNodeStopped error, but got %v&quot;, closeErr)</span>
<span class="term-fg32">+				}</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+		})</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-muted" data-bs-toggle="collapse" href="#id-58321b9531aafb2610c76bd9" role="button"
                       aria-expanded="false" aria-controls="id-58321b9531aafb2610c76bd9">
                        <code>eth/downloader/downloader_test.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/eth/downloader/downloader_test.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/eth/downloader/downloader_test.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-add-ignored">+1</span></div>
                            <div class="text-start"><span class="text-delete-ignored">-1</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-58321b9531aafb2610c76bd9"><span class="term-fg1">diff --git go-ethereum&#47;eth&#47;downloader&#47;downloader_test.go op-geth&#47;eth&#47;downloader&#47;downloader_test.go</span>
<span class="term-fg1">index 0cbddee6bf7a538086a9c63a612a2ae143d169dc..0e3d62ab9795a9ec08c36fa0d6ba2d4b7d528871 100644</span>
<span class="term-fg1">--- go-ethereum&#47;eth&#47;downloader&#47;downloader_test.go</span>
<span class="term-fg1">+++ op-geth&#47;eth&#47;downloader&#47;downloader_test.go</span>
<span class="term-fg36">@@ -76,7 +76,7 @@</span> 	tester := &amp;downloadTester{
 		chain: chain,
 		peers: make(map[string]*downloadTesterPeer),
 	}
<span class="term-fg31">-	tester.downloader = New(db, new(event.TypeMux), tester.chain, tester.dropPeer, success)</span>
<span class="term-fg32">+	tester.downloader = New(db, new(event.TypeMux), tester.chain, tester.dropPeer, success, 0)</span>
 	return tester
 }
</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-muted" data-bs-toggle="collapse" href="#id-9bd44f52c412a9e869d1211a" role="button"
                       aria-expanded="false" aria-controls="id-9bd44f52c412a9e869d1211a">
                        <code>eth/downloader/receiptreference_test.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/eth/downloader/receiptreference_test.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-add-ignored">+108</span></div>
                            <div class="text-start"><span class="text-delete-ignored">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-9bd44f52c412a9e869d1211a"><span class="term-fg1">diff --git go-ethereum&#47;eth&#47;downloader&#47;receiptreference_test.go op-geth&#47;eth&#47;downloader&#47;receiptreference_test.go</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..85bc4e1aaa77aa18aafadf64bc41f0147486a455</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ op-geth&#47;eth&#47;downloader&#47;receiptreference_test.go</span>
<span class="term-fg36">@@ -0,0 +1,108 @@</span>
<span class="term-fg32">+package downloader</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+import (</span>
<span class="term-fg32">+	&quot;testing&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&#47;types&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;stretchr&#47;testify&#47;assert&quot;</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; makeCorrection is a helper function to create a slice of receipts and a slice of corrected receipts</span>
<span class="term-fg32">+func makeCorrection(bn uint64, cid uint64, ns []uint64, ty []uint8) (types.Receipts, types.Receipts) {</span>
<span class="term-fg32">+	receipts := make(types.Receipts, len(ns))</span>
<span class="term-fg32">+	correctedReceipts := make(types.Receipts, len(ns))</span>
<span class="term-fg32">+	transactions := make(types.Transactions, len(ns))</span>
<span class="term-fg32">+	for i := range ns {</span>
<span class="term-fg32">+		receipts[i] = &amp;types.Receipt{Type: ty[i], DepositNonce: &amp;ns[i]}</span>
<span class="term-fg32">+		correctedReceipts[i] = &amp;types.Receipt{Type: ty[i], DepositNonce: &amp;ns[i]}</span>
<span class="term-fg32">+		transactions[i] = types.NewTx(&amp;types.DepositTx{})</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	correctedReceipts = correctReceipts(correctedReceipts, transactions, bn, cid)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	return receipts, correctedReceipts</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func TestCorrectReceipts(t *testing.T) {</span>
<span class="term-fg32">+	type testcase struct {</span>
<span class="term-fg32">+		blockNum uint64</span>
<span class="term-fg32">+		chainID  uint64</span>
<span class="term-fg32">+		nonces   []uint64</span>
<span class="term-fg32">+		txTypes  []uint8</span>
<span class="term-fg32">+		validate func(types.Receipts, types.Receipts)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Tests use the real reference data, so block numbers and chainIDs are selected for different test cases</span>
<span class="term-fg32">+	testcases := []testcase{</span>
<span class="term-fg32">+		&#47;&#47; Test case 1: No receipts</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			blockNum: 6825767,</span>
<span class="term-fg32">+			chainID:  420,</span>
<span class="term-fg32">+			nonces:   []uint64{},</span>
<span class="term-fg32">+			txTypes:  []uint8{},</span>
<span class="term-fg32">+			validate: func(receipts types.Receipts, correctedReceipts types.Receipts) {</span>
<span class="term-fg32">+				assert.Empty(t, correctedReceipts)</span>
<span class="term-fg32">+			},</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		&#47;&#47; Test case 2: No deposits</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			blockNum: 6825767,</span>
<span class="term-fg32">+			chainID:  420,</span>
<span class="term-fg32">+			nonces:   []uint64{1, 2, 3},</span>
<span class="term-fg32">+			txTypes:  []uint8{1, 1, 1},</span>
<span class="term-fg32">+			validate: func(receipts types.Receipts, correctedReceipts types.Receipts) {</span>
<span class="term-fg32">+				assert.Equal(t, receipts, correctedReceipts)</span>
<span class="term-fg32">+			},</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		&#47;&#47; Test case 3: all deposits with no correction</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			blockNum: 8835769,</span>
<span class="term-fg32">+			chainID:  420,</span>
<span class="term-fg32">+			nonces:   []uint64{78756, 78757, 78758, 78759, 78760, 78761, 78762, 78763, 78764},</span>
<span class="term-fg32">+			txTypes:  []uint8{126, 126, 126, 126, 126, 126, 126, 126, 126},</span>
<span class="term-fg32">+			validate: func(receipts types.Receipts, correctedReceipts types.Receipts) {</span>
<span class="term-fg32">+				assert.Equal(t, receipts, correctedReceipts)</span>
<span class="term-fg32">+			},</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		&#47;&#47; Test case 4: all deposits with a correction</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			blockNum: 8835769,</span>
<span class="term-fg32">+			chainID:  420,</span>
<span class="term-fg32">+			nonces:   []uint64{78756, 78757, 78758, 12345, 78760, 78761, 78762, 78763, 78764},</span>
<span class="term-fg32">+			txTypes:  []uint8{126, 126, 126, 126, 126, 126, 126, 126, 126},</span>
<span class="term-fg32">+			validate: func(receipts types.Receipts, correctedReceipts types.Receipts) {</span>
<span class="term-fg32">+				assert.NotEqual(t, receipts[3], correctedReceipts[3])</span>
<span class="term-fg32">+				for i := range receipts {</span>
<span class="term-fg32">+					if i != 3 {</span>
<span class="term-fg32">+						assert.Equal(t, receipts[i], correctedReceipts[i])</span>
<span class="term-fg32">+					}</span>
<span class="term-fg32">+				}</span>
<span class="term-fg32">+			},</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		&#47;&#47; Test case 5: deposits with several corrections and non-deposits</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			blockNum: 8835769,</span>
<span class="term-fg32">+			chainID:  420,</span>
<span class="term-fg32">+			nonces:   []uint64{0, 1, 2, 78759, 78760, 78761, 6, 78763, 78764, 9, 10, 11},</span>
<span class="term-fg32">+			txTypes:  []uint8{126, 126, 126, 126, 126, 126, 126, 126, 126, 1, 1, 1},</span>
<span class="term-fg32">+			validate: func(receipts types.Receipts, correctedReceipts types.Receipts) {</span>
<span class="term-fg32">+				&#47;&#47; indexes 0, 1, 2, 6 were modified</span>
<span class="term-fg32">+				&#47;&#47; indexes 9, 10, 11 were added too, but they are not user deposits</span>
<span class="term-fg32">+				assert.NotEqual(t, receipts[0], correctedReceipts[0])</span>
<span class="term-fg32">+				assert.NotEqual(t, receipts[1], correctedReceipts[1])</span>
<span class="term-fg32">+				assert.NotEqual(t, receipts[2], correctedReceipts[2])</span>
<span class="term-fg32">+				assert.NotEqual(t, receipts[6], correctedReceipts[6])</span>
<span class="term-fg32">+				for i := range receipts {</span>
<span class="term-fg32">+					if i != 0 &amp;&amp; i != 1 &amp;&amp; i != 2 &amp;&amp; i != 6 {</span>
<span class="term-fg32">+						assert.Equal(t, receipts[i], correctedReceipts[i])</span>
<span class="term-fg32">+					}</span>
<span class="term-fg32">+				}</span>
<span class="term-fg32">+			},</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	for _, tc := range testcases {</span>
<span class="term-fg32">+		receipts, correctedReceipts := makeCorrection(tc.blockNum, tc.chainID, tc.nonces, tc.txTypes)</span>
<span class="term-fg32">+		tc.validate(receipts, correctedReceipts)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-muted" data-bs-toggle="collapse" href="#id-d425a1e8f75122e64ddc12ee" role="button"
                       aria-expanded="false" aria-controls="id-d425a1e8f75122e64ddc12ee">
                        <code>eth/gasprice/optimism-gasprice_test.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/eth/gasprice/optimism-gasprice_test.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-add-ignored">+145</span></div>
                            <div class="text-start"><span class="text-delete-ignored">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-d425a1e8f75122e64ddc12ee"><span class="term-fg1">diff --git go-ethereum&#47;eth&#47;gasprice&#47;optimism-gasprice_test.go op-geth&#47;eth&#47;gasprice&#47;optimism-gasprice_test.go</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..e3be34c8b10fa3511895c35c4754a4356a82eb39</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ op-geth&#47;eth&#47;gasprice&#47;optimism-gasprice_test.go</span>
<span class="term-fg36">@@ -0,0 +1,145 @@</span>
<span class="term-fg32">+&#47;&#47; Copyright 2020 The go-ethereum Authors</span>
<span class="term-fg32">+&#47;&#47; This file is part of the go-ethereum library.</span>
<span class="term-fg32">+&#47;&#47;</span>
<span class="term-fg32">+&#47;&#47; The go-ethereum library is free software: you can redistribute it and&#47;or modify</span>
<span class="term-fg32">+&#47;&#47; it under the terms of the GNU Lesser General Public License as published by</span>
<span class="term-fg32">+&#47;&#47; the Free Software Foundation, either version 3 of the License, or</span>
<span class="term-fg32">+&#47;&#47; (at your option) any later version.</span>
<span class="term-fg32">+&#47;&#47;</span>
<span class="term-fg32">+&#47;&#47; The go-ethereum library is distributed in the hope that it will be useful,</span>
<span class="term-fg32">+&#47;&#47; but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="term-fg32">+&#47;&#47; MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the</span>
<span class="term-fg32">+&#47;&#47; GNU Lesser General Public License for more details.</span>
<span class="term-fg32">+&#47;&#47;</span>
<span class="term-fg32">+&#47;&#47; You should have received a copy of the GNU Lesser General Public License</span>
<span class="term-fg32">+&#47;&#47; along with the go-ethereum library. If not, see &lt;http:&#47;&#47;www.gnu.org&#47;licenses&#47;&gt;.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+package gasprice</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+import (</span>
<span class="term-fg32">+	&quot;context&quot;</span>
<span class="term-fg32">+	&quot;math&#47;big&quot;</span>
<span class="term-fg32">+	&quot;testing&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&#47;state&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&#47;types&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;crypto&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;event&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;params&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;rpc&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;trie&quot;</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+const (</span>
<span class="term-fg32">+	blockGasLimit = params.TxGas * 3</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+type testTxData struct {</span>
<span class="term-fg32">+	priorityFee int64</span>
<span class="term-fg32">+	gasLimit    uint64</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+type opTestBackend struct {</span>
<span class="term-fg32">+	block    *types.Block</span>
<span class="term-fg32">+	receipts []*types.Receipt</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (b *opTestBackend) HeaderByNumber(ctx context.Context, number rpc.BlockNumber) (*types.Header, error) {</span>
<span class="term-fg32">+	panic(&quot;not implemented&quot;)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (b *opTestBackend) BlockByNumber(ctx context.Context, number rpc.BlockNumber) (*types.Block, error) {</span>
<span class="term-fg32">+	return b.block, nil</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (b *opTestBackend) GetReceipts(ctx context.Context, hash common.Hash) (types.Receipts, error) {</span>
<span class="term-fg32">+	return b.receipts, nil</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (b *opTestBackend) Pending() (*types.Block, types.Receipts, *state.StateDB) {</span>
<span class="term-fg32">+	panic(&quot;not implemented&quot;)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (b *opTestBackend) ChainConfig() *params.ChainConfig {</span>
<span class="term-fg32">+	return params.OptimismTestConfig</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func (b *opTestBackend) SubscribeChainHeadEvent(ch chan&lt;- core.ChainHeadEvent) event.Subscription {</span>
<span class="term-fg32">+	return nil</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+var _ OracleBackend = (*opTestBackend)(nil)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func newOpTestBackend(t *testing.T, txs []testTxData) *opTestBackend {</span>
<span class="term-fg32">+	var (</span>
<span class="term-fg32">+		key, _ = crypto.HexToECDSA(&quot;b71c71a67e1177ad4e901695e1b4b9ee17ae16c6668d313eac2f96dbcda3f291&quot;)</span>
<span class="term-fg32">+		signer = types.LatestSigner(params.TestChainConfig)</span>
<span class="term-fg32">+	)</span>
<span class="term-fg32">+	&#47;&#47; only the most recent block is considered for optimism priority fee suggestions, so this is</span>
<span class="term-fg32">+	&#47;&#47; where we add the test transactions</span>
<span class="term-fg32">+	ts := []*types.Transaction{}</span>
<span class="term-fg32">+	rs := []*types.Receipt{}</span>
<span class="term-fg32">+	header := types.Header{}</span>
<span class="term-fg32">+	header.GasLimit = blockGasLimit</span>
<span class="term-fg32">+	var nonce uint64</span>
<span class="term-fg32">+	for _, tx := range txs {</span>
<span class="term-fg32">+		txdata := &amp;types.DynamicFeeTx{</span>
<span class="term-fg32">+			ChainID:   params.TestChainConfig.ChainID,</span>
<span class="term-fg32">+			Nonce:     nonce,</span>
<span class="term-fg32">+			To:        &amp;common.Address{},</span>
<span class="term-fg32">+			Gas:       params.TxGas,</span>
<span class="term-fg32">+			GasFeeCap: big.NewInt(100 * params.GWei),</span>
<span class="term-fg32">+			GasTipCap: big.NewInt(tx.priorityFee),</span>
<span class="term-fg32">+			Data:      []byte{},</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		t := types.MustSignNewTx(key, signer, txdata)</span>
<span class="term-fg32">+		ts = append(ts, t)</span>
<span class="term-fg32">+		r := types.Receipt{}</span>
<span class="term-fg32">+		r.GasUsed = tx.gasLimit</span>
<span class="term-fg32">+		header.GasUsed += r.GasUsed</span>
<span class="term-fg32">+		rs = append(rs, &amp;r)</span>
<span class="term-fg32">+		nonce++</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	hasher := trie.NewStackTrie(nil)</span>
<span class="term-fg32">+	b := types.NewBlock(&amp;header, &amp;types.Body{Transactions: ts}, nil, hasher)</span>
<span class="term-fg32">+	return &amp;opTestBackend{block: b, receipts: rs}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func TestSuggestOptimismPriorityFee(t *testing.T) {</span>
<span class="term-fg32">+	minSuggestion := new(big.Int).SetUint64(1e8 * params.Wei)</span>
<span class="term-fg32">+	var cases = []struct {</span>
<span class="term-fg32">+		txdata []testTxData</span>
<span class="term-fg32">+		want   *big.Int</span>
<span class="term-fg32">+	}{</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			&#47;&#47; block well under capacity, expect min priority fee suggestion</span>
<span class="term-fg32">+			txdata: []testTxData{{params.GWei, 21000}},</span>
<span class="term-fg32">+			want:   minSuggestion,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			&#47;&#47; 2 txs, still under capacity, expect min priority fee suggestion</span>
<span class="term-fg32">+			txdata: []testTxData{{params.GWei, 21000}, {params.GWei, 21000}},</span>
<span class="term-fg32">+			want:   minSuggestion,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			&#47;&#47; 2 txs w same priority fee (1 gwei), but second tx puts it right over capacity</span>
<span class="term-fg32">+			txdata: []testTxData{{params.GWei, 21000}, {params.GWei, 21001}},</span>
<span class="term-fg32">+			want:   big.NewInt(1100000000), &#47;&#47; 10 percent over 1 gwei, the median</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			&#47;&#47; 3 txs, full block. return 10% over the median tx (10 gwei * 10% == 11 gwei)</span>
<span class="term-fg32">+			txdata: []testTxData{{10 * params.GWei, 21000}, {1 * params.GWei, 21000}, {100 * params.GWei, 21000}},</span>
<span class="term-fg32">+			want:   big.NewInt(11 * params.GWei),</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	for i, c := range cases {</span>
<span class="term-fg32">+		backend := newOpTestBackend(t, c.txdata)</span>
<span class="term-fg32">+		oracle := NewOracle(backend, Config{MinSuggestedPriorityFee: minSuggestion})</span>
<span class="term-fg32">+		got := oracle.SuggestOptimismPriorityFee(context.Background(), backend.block.Header(), backend.block.Hash())</span>
<span class="term-fg32">+		if got.Cmp(c.want) != 0 {</span>
<span class="term-fg32">+			t.Errorf(&quot;Gas price mismatch for test case %d: want %d, got %d&quot;, i, c.want, got)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-muted" data-bs-toggle="collapse" href="#id-a68d44556aba9c7deaf04ef3" role="button"
                       aria-expanded="false" aria-controls="id-a68d44556aba9c7deaf04ef3">
                        <code>eth/tracers/internal/tracetest/calltrace_test.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/eth/tracers/internal/tracetest/calltrace_test.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/eth/tracers/internal/tracetest/calltrace_test.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-add-ignored">+1</span></div>
                            <div class="text-start"><span class="text-delete-ignored">-1</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-a68d44556aba9c7deaf04ef3"><span class="term-fg1">diff --git go-ethereum&#47;eth&#47;tracers&#47;internal&#47;tracetest&#47;calltrace_test.go op-geth&#47;eth&#47;tracers&#47;internal&#47;tracetest&#47;calltrace_test.go</span>
<span class="term-fg1">index 31b2ef6d16ee48944c0ff46d2e53e84cff504fe4..e97023825eb780c6c85b0f7a51f63fe0f9a2ba30 100644</span>
<span class="term-fg1">--- go-ethereum&#47;eth&#47;tracers&#47;internal&#47;tracetest&#47;calltrace_test.go</span>
<span class="term-fg1">+++ op-geth&#47;eth&#47;tracers&#47;internal&#47;tracetest&#47;calltrace_test.go</span>
<span class="term-fg36">@@ -96,6 +96,7 @@</span> 	for _, file := range files {
 		if !strings.HasSuffix(file.Name(), &quot;.json&quot;) {
 			continue
 		}
<span class="term-fg32">+</span>
 		file := file &#47;&#47; capture range variable
 		t.Run(camel(strings.TrimSuffix(file.Name(), &quot;.json&quot;)), func(t *testing.T) {
 			t.Parallel()
<span class="term-fg36">@@ -125,7 +126,6 @@</span> 			tracer, err := tracers.DefaultDirectory.New(tracerName, new(tracers.Context), test.TracerConfig)
 			if err != nil {
 				t.Fatalf(&quot;failed to create call tracer: %v&quot;, err)
 			}
<span class="term-fg31">-</span>
 			state.StateDB.SetLogger(tracer.Hooks)
 			msg, err := core.TransactionToMessage(tx, signer, context.BaseFee)
 			if err != nil {</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-muted" data-bs-toggle="collapse" href="#id-d8d4d1ef298596a712579ecc" role="button"
                       aria-expanded="false" aria-controls="id-d8d4d1ef298596a712579ecc">
                        <code>eth/tracers/internal/tracetest/flat_calltrace_test.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/eth/tracers/internal/tracetest/flat_calltrace_test.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/eth/tracers/internal/tracetest/flat_calltrace_test.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-add-ignored">+1</span></div>
                            <div class="text-start"><span class="text-delete-ignored">-2</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-d8d4d1ef298596a712579ecc"><span class="term-fg1">diff --git go-ethereum&#47;eth&#47;tracers&#47;internal&#47;tracetest&#47;flat_calltrace_test.go op-geth&#47;eth&#47;tracers&#47;internal&#47;tracetest&#47;flat_calltrace_test.go</span>
<span class="term-fg1">index ec7a944b91de0f5f6203ea87f981a058b5d97509..050950c8643bb0d81776a7b6af630886e299b16f 100644</span>
<span class="term-fg1">--- go-ethereum&#47;eth&#47;tracers&#47;internal&#47;tracetest&#47;flat_calltrace_test.go</span>
<span class="term-fg1">+++ op-geth&#47;eth&#47;tracers&#47;internal&#47;tracetest&#47;flat_calltrace_test.go</span>
<span class="term-fg36">@@ -17,7 +17,6 @@</span> 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&#47;rawdb&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&#47;types&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&#47;vm&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;eth&#47;tracers&quot;
<span class="term-fg31">-	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;rlp&quot;</span>
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;tests&quot;
 )
&nbsp;
<span class="term-fg36">@@ -80,7 +79,7 @@</span> 		return fmt.Errorf(&quot;failed to parse testcase: %v&quot;, err)
 	}
 	&#47;&#47; Configure a blockchain with the given prestate
 	tx := new(types.Transaction)
<span class="term-fg31">-	if err := rlp.DecodeBytes(common.FromHex(test.Input), tx); err != nil {</span>
<span class="term-fg32">+	if err := tx.UnmarshalBinary(common.FromHex(test.Input)); err != nil {</span>
 		return fmt.Errorf(&quot;failed to parse testcase input: %v&quot;, err)
 	}
 	signer := types.MakeSigner(test.Genesis.Config, new(big.Int).SetUint64(uint64(test.Context.Number)), uint64(test.Context.Time))</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-muted" data-bs-toggle="collapse" href="#id-c1e23f0c6c71f94948daa85e" role="button"
                       aria-expanded="false" aria-controls="id-c1e23f0c6c71f94948daa85e">
                        <code>internal/ethapi/api_test.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/internal/ethapi/api_test.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/internal/ethapi/api_test.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-add-ignored">+179</span></div>
                            <div class="text-start"><span class="text-delete-ignored">-8</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-c1e23f0c6c71f94948daa85e"><span class="term-fg1">diff --git go-ethereum&#47;internal&#47;ethapi&#47;api_test.go op-geth&#47;internal&#47;ethapi&#47;api_test.go</span>
<span class="term-fg1">index cf5160caf778b519dca71db0f0b69a69d5728b22..f3f80eb84a2917443bc4304abb5a554b320ded43 100644</span>
<span class="term-fg1">--- go-ethereum&#47;internal&#47;ethapi&#47;api_test.go</span>
<span class="term-fg1">+++ op-geth&#47;internal&#47;ethapi&#47;api_test.go</span>
<span class="term-fg36">@@ -58,6 +58,164 @@</span> 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;params&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;rpc&quot;
 )
&nbsp;
<span class="term-fg32">+func TestNewRPCTransactionDepositTx(t *testing.T) {</span>
<span class="term-fg32">+	tx := types.NewTx(&amp;types.DepositTx{</span>
<span class="term-fg32">+		SourceHash:          common.HexToHash(&quot;0x1234&quot;),</span>
<span class="term-fg32">+		IsSystemTransaction: true,</span>
<span class="term-fg32">+		Mint:                big.NewInt(34),</span>
<span class="term-fg32">+	})</span>
<span class="term-fg32">+	nonce := uint64(7)</span>
<span class="term-fg32">+	receipt := &amp;types.Receipt{</span>
<span class="term-fg32">+		DepositNonce: &amp;nonce,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	got := newRPCTransaction(tx, common.Hash{}, uint64(12), uint64(1234), uint64(1), big.NewInt(0), &amp;params.ChainConfig{}, receipt)</span>
<span class="term-fg32">+	&#47;&#47; Should provide zero values for unused fields that are required in other transactions</span>
<span class="term-fg32">+	require.Equal(t, got.GasPrice, (*hexutil.Big)(big.NewInt(0)), &quot;newRPCTransaction().GasPrice = %v, want 0x0&quot;, got.GasPrice)</span>
<span class="term-fg32">+	require.Equal(t, got.V, (*hexutil.Big)(big.NewInt(0)), &quot;newRPCTransaction().V = %v, want 0x0&quot;, got.V)</span>
<span class="term-fg32">+	require.Equal(t, got.R, (*hexutil.Big)(big.NewInt(0)), &quot;newRPCTransaction().R = %v, want 0x0&quot;, got.R)</span>
<span class="term-fg32">+	require.Equal(t, got.S, (*hexutil.Big)(big.NewInt(0)), &quot;newRPCTransaction().S = %v, want 0x0&quot;, got.S)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Should include deposit tx specific fields</span>
<span class="term-fg32">+	require.Equal(t, *got.SourceHash, tx.SourceHash(), &quot;newRPCTransaction().SourceHash = %v, want %v&quot;, got.SourceHash, tx.SourceHash())</span>
<span class="term-fg32">+	require.Equal(t, *got.IsSystemTx, tx.IsSystemTx(), &quot;newRPCTransaction().IsSystemTx = %v, want %v&quot;, got.IsSystemTx, tx.IsSystemTx())</span>
<span class="term-fg32">+	require.Equal(t, got.Mint, (*hexutil.Big)(tx.Mint()), &quot;newRPCTransaction().Mint = %v, want %v&quot;, got.Mint, tx.Mint())</span>
<span class="term-fg32">+	require.Equal(t, got.Nonce, (hexutil.Uint64)(nonce), &quot;newRPCTransaction().Nonce = %v, want %v&quot;, got.Nonce, nonce)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func TestRPCTransactionDepositTxWithVersion(t *testing.T) {</span>
<span class="term-fg32">+	tx := types.NewTx(&amp;types.DepositTx{</span>
<span class="term-fg32">+		SourceHash:          common.HexToHash(&quot;0x1234&quot;),</span>
<span class="term-fg32">+		IsSystemTransaction: true,</span>
<span class="term-fg32">+		Mint:                big.NewInt(34),</span>
<span class="term-fg32">+	})</span>
<span class="term-fg32">+	nonce := uint64(7)</span>
<span class="term-fg32">+	version := types.CanyonDepositReceiptVersion</span>
<span class="term-fg32">+	receipt := &amp;types.Receipt{</span>
<span class="term-fg32">+		DepositNonce:          &amp;nonce,</span>
<span class="term-fg32">+		DepositReceiptVersion: &amp;version,</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	got := newRPCTransaction(tx, common.Hash{}, uint64(12), uint64(1234), uint64(1), big.NewInt(0), &amp;params.ChainConfig{}, receipt)</span>
<span class="term-fg32">+	&#47;&#47; Should provide zero values for unused fields that are required in other transactions</span>
<span class="term-fg32">+	require.Equal(t, got.GasPrice, (*hexutil.Big)(big.NewInt(0)), &quot;newRPCTransaction().GasPrice = %v, want 0x0&quot;, got.GasPrice)</span>
<span class="term-fg32">+	require.Equal(t, got.V, (*hexutil.Big)(big.NewInt(0)), &quot;newRPCTransaction().V = %v, want 0x0&quot;, got.V)</span>
<span class="term-fg32">+	require.Equal(t, got.R, (*hexutil.Big)(big.NewInt(0)), &quot;newRPCTransaction().R = %v, want 0x0&quot;, got.R)</span>
<span class="term-fg32">+	require.Equal(t, got.S, (*hexutil.Big)(big.NewInt(0)), &quot;newRPCTransaction().S = %v, want 0x0&quot;, got.S)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Should include versioned deposit tx specific fields</span>
<span class="term-fg32">+	require.Equal(t, *got.SourceHash, tx.SourceHash(), &quot;newRPCTransaction().SourceHash = %v, want %v&quot;, got.SourceHash, tx.SourceHash())</span>
<span class="term-fg32">+	require.Equal(t, *got.IsSystemTx, tx.IsSystemTx(), &quot;newRPCTransaction().IsSystemTx = %v, want %v&quot;, got.IsSystemTx, tx.IsSystemTx())</span>
<span class="term-fg32">+	require.Equal(t, got.Mint, (*hexutil.Big)(tx.Mint()), &quot;newRPCTransaction().Mint = %v, want %v&quot;, got.Mint, tx.Mint())</span>
<span class="term-fg32">+	require.Equal(t, got.Nonce, (hexutil.Uint64)(nonce), &quot;newRPCTransaction().Nonce = %v, want %v&quot;, got.Nonce, nonce)</span>
<span class="term-fg32">+	require.Equal(t, *got.DepositReceiptVersion, (hexutil.Uint64(version)), &quot;newRPCTransaction().DepositReceiptVersion = %v, want %v&quot;, *got.DepositReceiptVersion, version)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; Make sure json marshal&#47;unmarshal of the rpc tx preserves the receipt version</span>
<span class="term-fg32">+	b, err := json.Marshal(got)</span>
<span class="term-fg32">+	require.NoError(t, err, &quot;marshalling failed: %w&quot;, err)</span>
<span class="term-fg32">+	parsed := make(map[string]interface{})</span>
<span class="term-fg32">+	err = json.Unmarshal(b, &amp;parsed)</span>
<span class="term-fg32">+	require.NoError(t, err, &quot;unmarshalling failed: %w&quot;, err)</span>
<span class="term-fg32">+	require.Equal(t, &quot;0x1&quot;, parsed[&quot;depositReceiptVersion&quot;])</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func TestNewRPCTransactionOmitIsSystemTxFalse(t *testing.T) {</span>
<span class="term-fg32">+	tx := types.NewTx(&amp;types.DepositTx{</span>
<span class="term-fg32">+		IsSystemTransaction: false,</span>
<span class="term-fg32">+	})</span>
<span class="term-fg32">+	got := newRPCTransaction(tx, common.Hash{}, uint64(12), uint64(1234), uint64(1), big.NewInt(0), &amp;params.ChainConfig{}, nil)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	require.Nil(t, got.IsSystemTx, &quot;should omit IsSystemTx when false&quot;)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func TestUnmarshalRpcDepositTx(t *testing.T) {</span>
<span class="term-fg32">+	version := hexutil.Uint64(types.CanyonDepositReceiptVersion)</span>
<span class="term-fg32">+	tests := []struct {</span>
<span class="term-fg32">+		name     string</span>
<span class="term-fg32">+		modifier func(tx *RPCTransaction)</span>
<span class="term-fg32">+		valid    bool</span>
<span class="term-fg32">+	}{</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			name:     &quot;Unmodified&quot;,</span>
<span class="term-fg32">+			modifier: func(tx *RPCTransaction) {},</span>
<span class="term-fg32">+			valid:    true,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			name: &quot;Zero Values&quot;,</span>
<span class="term-fg32">+			modifier: func(tx *RPCTransaction) {</span>
<span class="term-fg32">+				tx.V = (*hexutil.Big)(common.Big0)</span>
<span class="term-fg32">+				tx.R = (*hexutil.Big)(common.Big0)</span>
<span class="term-fg32">+				tx.S = (*hexutil.Big)(common.Big0)</span>
<span class="term-fg32">+				tx.GasPrice = (*hexutil.Big)(common.Big0)</span>
<span class="term-fg32">+			},</span>
<span class="term-fg32">+			valid: true,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			name: &quot;Nil Values&quot;,</span>
<span class="term-fg32">+			modifier: func(tx *RPCTransaction) {</span>
<span class="term-fg32">+				tx.V = nil</span>
<span class="term-fg32">+				tx.R = nil</span>
<span class="term-fg32">+				tx.S = nil</span>
<span class="term-fg32">+				tx.GasPrice = nil</span>
<span class="term-fg32">+			},</span>
<span class="term-fg32">+			valid: true,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			name: &quot;Non-Zero GasPrice&quot;,</span>
<span class="term-fg32">+			modifier: func(tx *RPCTransaction) {</span>
<span class="term-fg32">+				tx.GasPrice = (*hexutil.Big)(big.NewInt(43))</span>
<span class="term-fg32">+			},</span>
<span class="term-fg32">+			valid: false,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			name: &quot;Non-Zero V&quot;,</span>
<span class="term-fg32">+			modifier: func(tx *RPCTransaction) {</span>
<span class="term-fg32">+				tx.V = (*hexutil.Big)(big.NewInt(43))</span>
<span class="term-fg32">+			},</span>
<span class="term-fg32">+			valid: false,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			name: &quot;Non-Zero R&quot;,</span>
<span class="term-fg32">+			modifier: func(tx *RPCTransaction) {</span>
<span class="term-fg32">+				tx.R = (*hexutil.Big)(big.NewInt(43))</span>
<span class="term-fg32">+			},</span>
<span class="term-fg32">+			valid: false,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			name: &quot;Non-Zero S&quot;,</span>
<span class="term-fg32">+			modifier: func(tx *RPCTransaction) {</span>
<span class="term-fg32">+				tx.S = (*hexutil.Big)(big.NewInt(43))</span>
<span class="term-fg32">+			},</span>
<span class="term-fg32">+			valid: false,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			name: &quot;Non-nil deposit receipt version&quot;,</span>
<span class="term-fg32">+			modifier: func(tx *RPCTransaction) {</span>
<span class="term-fg32">+				tx.DepositReceiptVersion = &amp;version</span>
<span class="term-fg32">+			},</span>
<span class="term-fg32">+			valid: true,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	for _, test := range tests {</span>
<span class="term-fg32">+		t.Run(test.name, func(t *testing.T) {</span>
<span class="term-fg32">+			tx := types.NewTx(&amp;types.DepositTx{</span>
<span class="term-fg32">+				SourceHash:          common.HexToHash(&quot;0x1234&quot;),</span>
<span class="term-fg32">+				IsSystemTransaction: true,</span>
<span class="term-fg32">+				Mint:                big.NewInt(34),</span>
<span class="term-fg32">+			})</span>
<span class="term-fg32">+			rpcTx := newRPCTransaction(tx, common.Hash{}, uint64(12), uint64(1234), uint64(1), big.NewInt(0), &amp;params.ChainConfig{}, nil)</span>
<span class="term-fg32">+			test.modifier(rpcTx)</span>
<span class="term-fg32">+			json, err := json.Marshal(rpcTx)</span>
<span class="term-fg32">+			require.NoError(t, err, &quot;marshalling failed: %w&quot;, err)</span>
<span class="term-fg32">+			parsed := &amp;types.Transaction{}</span>
<span class="term-fg32">+			err = parsed.UnmarshalJSON(json)</span>
<span class="term-fg32">+			if test.valid {</span>
<span class="term-fg32">+				require.NoError(t, err, &quot;unmarshal failed: %w&quot;, err)</span>
<span class="term-fg32">+			} else {</span>
<span class="term-fg32">+				require.Error(t, err, &quot;unmarshal should have failed but did not&quot;)</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+		})</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
 func testTransactionMarshal(t *testing.T, tests []txData, config *params.ChainConfig) {
 	t.Parallel()
 	var (
<span class="term-fg36">@@ -81,7 +239,7 @@</span> 			t.Fatalf(&quot;test %d: stx changed, want %x have %x&quot;, i, want, have)
 		}
&nbsp;
 		&#47;&#47; rpcTransaction
<span class="term-fg31">-		rpcTx := newRPCTransaction(tx, common.Hash{}, 0, 0, 0, nil, config)</span>
<span class="term-fg32">+		rpcTx := newRPCTransaction(tx, common.Hash{}, 0, 0, 0, nil, config, nil)</span>
 		if data, err := json.Marshal(rpcTx); err != nil {
 			t.Fatalf(&quot;test %d: marshalling failed; %v&quot;, i, err)
 		} else if err = tx2.UnmarshalJSON(data); err != nil {
<span class="term-fg36">@@ -569,7 +727,7 @@</span> 	if vmConfig == nil {
 		vmConfig = b.chain.GetVMConfig()
 	}
 	txContext := core.NewEVMTxContext(msg)
<span class="term-fg31">-	context := core.NewEVMBlockContext(header, b.chain, nil)</span>
<span class="term-fg32">+	context := core.NewEVMBlockContext(header, b.chain, nil, b.ChainConfig(), state)</span>
 	if blockContext != nil {
 		context = *blockContext
 	}
<span class="term-fg36">@@ -621,6 +779,12 @@</span> func (b testBackend) BloomStatus() (uint64, uint64) { panic(&quot;implement me&quot;) }
 func (b testBackend) ServiceFilter(ctx context.Context, session *bloombits.MatcherSession) {
 	panic(&quot;implement me&quot;)
 }
<span class="term-fg32">+func (b testBackend) HistoricalRPCService() *rpc.Client {</span>
<span class="term-fg32">+	panic(&quot;implement me&quot;)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+func (b testBackend) Genesis() *types.Block {</span>
<span class="term-fg32">+	panic(&quot;implement me&quot;)</span>
<span class="term-fg32">+}</span>
&nbsp;
 func TestEstimateGas(t *testing.T) {
 	t.Parallel()
<span class="term-fg36">@@ -842,7 +1006,7 @@</span> 				From:  &amp;accounts[0].addr,
 				To:    &amp;accounts[1].addr,
 				Value: (*hexutil.Big)(big.NewInt(1000)),
 			},
<span class="term-fg31">-			expectErr: errors.New(&quot;header not found&quot;),</span>
<span class="term-fg32">+			expectErr: ethereum.NotFound,</span>
 		},
 		&#47;&#47; transfer on the latest block
 		{
<span class="term-fg36">@@ -1039,8 +1203,11 @@</span> 		t.Fatalf(&quot;failed to fill tx defaults: %v\n&quot;, err)
 	}
&nbsp;
 	_, err = api.SignTransaction(context.Background(), argsFromTransaction(res.Tx, b.acc.Address))
<span class="term-fg31">-	if err != nil {</span>
<span class="term-fg31">-		t.Fatalf(&quot;should not fail on blob transaction&quot;)</span>
<span class="term-fg32">+	if err == nil {</span>
<span class="term-fg32">+		t.Fatalf(&quot;should fail on blob transaction&quot;)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if !errors.Is(err, errBlobTxNotSupported) {</span>
<span class="term-fg32">+		t.Errorf(&quot;error mismatch. Have: %v, want: %v&quot;, err, errBlobTxNotSupported)</span>
 	}
 }
&nbsp;
<span class="term-fg36">@@ -1466,7 +1633,7 @@</span> 						&quot;to&quot;: &quot;0x0000000000000000000000000000000000000011&quot;,
 						&quot;transactionIndex&quot;: &quot;0x1&quot;,
 						&quot;value&quot;: &quot;0x6f&quot;,
 						&quot;type&quot;: &quot;0x0&quot;,
<span class="term-fg31">-						&quot;chainId&quot;: &quot;0x7fffffffffffffee&quot;,</span>
<span class="term-fg32">+						&quot;chainId&quot;: &quot;0x1&quot;,</span>
 						&quot;v&quot;: &quot;0x0&quot;,
 						&quot;r&quot;: &quot;0x0&quot;,
 						&quot;s&quot;: &quot;0x0&quot;
<span class="term-fg36">@@ -1504,7 +1671,7 @@</span> 						&quot;to&quot;: &quot;0x0000000000000000000000000000000000000011&quot;,
 						&quot;transactionIndex&quot;: &quot;0x3&quot;,
 						&quot;value&quot;: &quot;0x6f&quot;,
 						&quot;type&quot;: &quot;0x0&quot;,
<span class="term-fg31">-						&quot;chainId&quot;: &quot;0x7fffffffffffffee&quot;,</span>
<span class="term-fg32">+						&quot;chainId&quot;: &quot;0x1&quot;,</span>
 						&quot;v&quot;: &quot;0x0&quot;,
 						&quot;r&quot;: &quot;0x0&quot;,
 						&quot;s&quot;: &quot;0x0&quot;
<span class="term-fg36">@@ -1517,7 +1684,11 @@</span> 		},
 	}
&nbsp;
 	for i, tc := range testSuite {
<span class="term-fg31">-		resp := RPCMarshalBlock(block, tc.inclTx, tc.fullTx, params.MainnetChainConfig)</span>
<span class="term-fg32">+		resp, err := RPCMarshalBlock(context.Background(), block, tc.inclTx, tc.fullTx, params.MainnetChainConfig, testBackend{})</span>
<span class="term-fg32">+		if err != nil {</span>
<span class="term-fg32">+			t.Errorf(&quot;test %d: got error %v&quot;, i, err)</span>
<span class="term-fg32">+			continue</span>
<span class="term-fg32">+		}</span>
 		out, err := json.Marshal(resp)
 		if err != nil {
 			t.Errorf(&quot;test %d: json marshal error: %v&quot;, i, err)</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-muted" data-bs-toggle="collapse" href="#id-65a3ae0475b1a2d38cd93aa0" role="button"
                       aria-expanded="false" aria-controls="id-65a3ae0475b1a2d38cd93aa0">
                        <code>params/config_test.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/params/config_test.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/params/config_test.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-add-ignored">+61</span></div>
                            <div class="text-start"><span class="text-delete-ignored">-5</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-65a3ae0475b1a2d38cd93aa0"><span class="term-fg1">diff --git go-ethereum&#47;params&#47;config_test.go op-geth&#47;params&#47;config_test.go</span>
<span class="term-fg1">index fa444a1d0b760c940ae5785a83aa1065bf5a6b50..4e5f3e5af416b27b3fbed26351f68da4907bd646 100644</span>
<span class="term-fg1">--- go-ethereum&#47;params&#47;config_test.go</span>
<span class="term-fg1">+++ op-geth&#47;params&#47;config_test.go</span>
<span class="term-fg36">@@ -17,6 +17,7 @@</span>
 package params
&nbsp;
 import (
<span class="term-fg32">+	&quot;fmt&quot;</span>
 	&quot;math&#47;big&quot;
 	&quot;reflect&quot;
 	&quot;testing&quot;
<span class="term-fg36">@@ -32,6 +33,8 @@</span> 		stored, new   *ChainConfig
 		headBlock     uint64
 		headTimestamp uint64
 		wantErr       *ConfigCompatError
<span class="term-fg32">+</span>
<span class="term-fg32">+		genesisTimestamp *uint64</span>
 	}
 	tests := []test{
 		{stored: AllEthashProtocolChanges, new: AllEthashProtocolChanges, headBlock: 0, headTimestamp: 0, wantErr: nil},
<span class="term-fg36">@@ -110,13 +113,46 @@</span> 				NewTime:      newUint64(20),
 				RewindToTime: 9,
 			},
 		},
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			stored:           &amp;ChainConfig{CanyonTime: newUint64(10)},</span>
<span class="term-fg32">+			new:              &amp;ChainConfig{CanyonTime: newUint64(20)},</span>
<span class="term-fg32">+			headTimestamp:    25,</span>
<span class="term-fg32">+			genesisTimestamp: newUint64(2),</span>
<span class="term-fg32">+			wantErr: &amp;ConfigCompatError{</span>
<span class="term-fg32">+				What:         &quot;Canyon fork timestamp&quot;,</span>
<span class="term-fg32">+				StoredTime:   newUint64(10),</span>
<span class="term-fg32">+				NewTime:      newUint64(20),</span>
<span class="term-fg32">+				RewindToTime: 9,</span>
<span class="term-fg32">+			},</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			stored:           &amp;ChainConfig{CanyonTime: newUint64(10)},</span>
<span class="term-fg32">+			new:              &amp;ChainConfig{CanyonTime: newUint64(20)},</span>
<span class="term-fg32">+			headTimestamp:    25,</span>
<span class="term-fg32">+			genesisTimestamp: nil,</span>
<span class="term-fg32">+			wantErr: &amp;ConfigCompatError{</span>
<span class="term-fg32">+				What:         &quot;Canyon fork timestamp&quot;,</span>
<span class="term-fg32">+				StoredTime:   newUint64(10),</span>
<span class="term-fg32">+				NewTime:      newUint64(20),</span>
<span class="term-fg32">+				RewindToTime: 9,</span>
<span class="term-fg32">+			},</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			stored:           &amp;ChainConfig{CanyonTime: newUint64(10)},</span>
<span class="term-fg32">+			new:              &amp;ChainConfig{CanyonTime: newUint64(20)},</span>
<span class="term-fg32">+			headTimestamp:    25,</span>
<span class="term-fg32">+			genesisTimestamp: newUint64(24),</span>
<span class="term-fg32">+			wantErr:          nil,</span>
<span class="term-fg32">+		},</span>
 	}
&nbsp;
<span class="term-fg31">-	for _, test := range tests {</span>
<span class="term-fg31">-		err := test.stored.CheckCompatible(test.new, test.headBlock, test.headTimestamp)</span>
<span class="term-fg31">-		if !reflect.DeepEqual(err, test.wantErr) {</span>
<span class="term-fg31">-			t.Errorf(&quot;error mismatch:\nstored: %v\nnew: %v\nheadBlock: %v\nheadTimestamp: %v\nerr: %v\nwant: %v&quot;, test.stored, test.new, test.headBlock, test.headTimestamp, err, test.wantErr)</span>
<span class="term-fg31">-		}</span>
<span class="term-fg32">+	for i, test := range tests {</span>
<span class="term-fg32">+		t.Run(fmt.Sprintf(&quot;case %d&quot;, i), func(t *testing.T) {</span>
<span class="term-fg32">+			err := test.stored.CheckCompatible(test.new, test.headBlock, test.headTimestamp, test.genesisTimestamp)</span>
<span class="term-fg32">+			if !reflect.DeepEqual(err, test.wantErr) {</span>
<span class="term-fg32">+				t.Errorf(&quot;error mismatch:\nstored: %v\nnew: %v\nheadBlock: %v\nheadTimestamp: %v\nerr: %v\nwant: %v&quot;, test.stored, test.new, test.headBlock, test.headTimestamp, err, test.wantErr)</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+		})</span>
 	}
 }
&nbsp;
<span class="term-fg36">@@ -155,3 +191,23 @@</span>
 	require.Equal(t, newTimestampCompatError(errWhat, newUint64(0), newUint64(1681338455)).Error(),
 		&quot;mismatching Shanghai fork timestamp in database (have timestamp 0, want timestamp 1681338455, rewindto timestamp 0)&quot;)
 }
<span class="term-fg32">+</span>
<span class="term-fg32">+func TestConfigRulesRegolith(t *testing.T) {</span>
<span class="term-fg32">+	c := &amp;ChainConfig{</span>
<span class="term-fg32">+		RegolithTime: newUint64(500),</span>
<span class="term-fg32">+		LondonBlock:  new(big.Int),</span>
<span class="term-fg32">+		Optimism:     &amp;OptimismConfig{},</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	var stamp uint64</span>
<span class="term-fg32">+	if r := c.Rules(big.NewInt(0), true, stamp); r.IsOptimismRegolith {</span>
<span class="term-fg32">+		t.Errorf(&quot;expected %v to not be regolith&quot;, stamp)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	stamp = 500</span>
<span class="term-fg32">+	if r := c.Rules(big.NewInt(0), true, stamp); !r.IsOptimismRegolith {</span>
<span class="term-fg32">+		t.Errorf(&quot;expected %v to be regolith&quot;, stamp)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	stamp = math.MaxInt64</span>
<span class="term-fg32">+	if r := c.Rules(big.NewInt(0), true, stamp); !r.IsOptimismRegolith {</span>
<span class="term-fg32">+		t.Errorf(&quot;expected %v to be regolith&quot;, stamp)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-muted" data-bs-toggle="collapse" href="#id-11c6c5d929c74409436d5687" role="button"
                       aria-expanded="false" aria-controls="id-11c6c5d929c74409436d5687">
                        <code>params/superchain_test.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/params/superchain_test.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-add-ignored">+172</span></div>
                            <div class="text-start"><span class="text-delete-ignored">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-11c6c5d929c74409436d5687"><span class="term-fg1">diff --git go-ethereum&#47;params&#47;superchain_test.go op-geth&#47;params&#47;superchain_test.go</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..abb72bbd351f4c0a99ea8b78deac222a816a9ccc</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ op-geth&#47;params&#47;superchain_test.go</span>
<span class="term-fg36">@@ -0,0 +1,172 @@</span>
<span class="term-fg32">+package params</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+import (</span>
<span class="term-fg32">+	&quot;fmt&quot;</span>
<span class="term-fg32">+	&quot;testing&quot;</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+type HumanProtocolVersion struct {</span>
<span class="term-fg32">+	VersionType         uint8</span>
<span class="term-fg32">+	Major, Minor, Patch uint32</span>
<span class="term-fg32">+	Prerelease          uint32</span>
<span class="term-fg32">+	Build               [8]byte</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+type ComparisonCase struct {</span>
<span class="term-fg32">+	A, B HumanProtocolVersion</span>
<span class="term-fg32">+	Cmp  ProtocolVersionComparison</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func TestProtocolVersion_Compare(t *testing.T) {</span>
<span class="term-fg32">+	testCases := []ComparisonCase{</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			A:   HumanProtocolVersion{0, 2, 1, 1, 1, [8]byte{}},</span>
<span class="term-fg32">+			B:   HumanProtocolVersion{0, 1, 2, 2, 2, [8]byte{}},</span>
<span class="term-fg32">+			Cmp: AheadMajor,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			A:   HumanProtocolVersion{0, 1, 2, 1, 1, [8]byte{}},</span>
<span class="term-fg32">+			B:   HumanProtocolVersion{0, 1, 1, 2, 2, [8]byte{}},</span>
<span class="term-fg32">+			Cmp: AheadMinor,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			A:   HumanProtocolVersion{0, 1, 1, 2, 1, [8]byte{}},</span>
<span class="term-fg32">+			B:   HumanProtocolVersion{0, 1, 1, 1, 2, [8]byte{}},</span>
<span class="term-fg32">+			Cmp: AheadPatch,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			A:   HumanProtocolVersion{0, 1, 1, 1, 2, [8]byte{}},</span>
<span class="term-fg32">+			B:   HumanProtocolVersion{0, 1, 1, 1, 1, [8]byte{}},</span>
<span class="term-fg32">+			Cmp: AheadPrerelease,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			A:   HumanProtocolVersion{0, 1, 2, 3, 4, [8]byte{}},</span>
<span class="term-fg32">+			B:   HumanProtocolVersion{0, 1, 2, 3, 4, [8]byte{}},</span>
<span class="term-fg32">+			Cmp: Matching,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			A:   HumanProtocolVersion{0, 3, 2, 1, 5, [8]byte{3}},</span>
<span class="term-fg32">+			B:   HumanProtocolVersion{1, 1, 2, 3, 3, [8]byte{6}},</span>
<span class="term-fg32">+			Cmp: DiffVersionType,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			A:   HumanProtocolVersion{0, 3, 2, 1, 5, [8]byte{3}},</span>
<span class="term-fg32">+			B:   HumanProtocolVersion{0, 1, 2, 3, 3, [8]byte{6}},</span>
<span class="term-fg32">+			Cmp: DiffBuild,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			A:   HumanProtocolVersion{0, 0, 0, 0, 0, [8]byte{}},</span>
<span class="term-fg32">+			B:   HumanProtocolVersion{0, 1, 3, 3, 3, [8]byte{3}},</span>
<span class="term-fg32">+			Cmp: EmptyVersion,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			A:   HumanProtocolVersion{0, 4, 0, 0, 0, [8]byte{}},</span>
<span class="term-fg32">+			B:   HumanProtocolVersion{0, 4, 0, 0, 1, [8]byte{}},</span>
<span class="term-fg32">+			Cmp: AheadMajor,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			A:   HumanProtocolVersion{0, 4, 1, 0, 0, [8]byte{}},</span>
<span class="term-fg32">+			B:   HumanProtocolVersion{0, 4, 1, 0, 1, [8]byte{}},</span>
<span class="term-fg32">+			Cmp: AheadMinor,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			A:   HumanProtocolVersion{0, 4, 0, 1, 0, [8]byte{}},</span>
<span class="term-fg32">+			B:   HumanProtocolVersion{0, 4, 0, 1, 1, [8]byte{}},</span>
<span class="term-fg32">+			Cmp: AheadPatch,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			A:   HumanProtocolVersion{0, 4, 0, 0, 2, [8]byte{}},</span>
<span class="term-fg32">+			B:   HumanProtocolVersion{0, 4, 0, 0, 1, [8]byte{}},</span>
<span class="term-fg32">+			Cmp: AheadPrerelease,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			A:   HumanProtocolVersion{0, 4, 1, 0, 1, [8]byte{}},</span>
<span class="term-fg32">+			B:   HumanProtocolVersion{0, 4, 0, 0, 0, [8]byte{}},</span>
<span class="term-fg32">+			Cmp: AheadPatch,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			A:   HumanProtocolVersion{0, 4, 0, 1, 1, [8]byte{}},</span>
<span class="term-fg32">+			B:   HumanProtocolVersion{0, 4, 0, 0, 0, [8]byte{}},</span>
<span class="term-fg32">+			Cmp: AheadPrerelease,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			A:   HumanProtocolVersion{0, 4, 1, 1, 1, [8]byte{}},</span>
<span class="term-fg32">+			B:   HumanProtocolVersion{0, 4, 0, 0, 0, [8]byte{}},</span>
<span class="term-fg32">+			Cmp: AheadMinor,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			A:   HumanProtocolVersion{0, 4, 0, 2, 1, [8]byte{}},</span>
<span class="term-fg32">+			B:   HumanProtocolVersion{0, 4, 0, 0, 0, [8]byte{}},</span>
<span class="term-fg32">+			Cmp: AheadPatch,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			A:   HumanProtocolVersion{0, 5, 0, 1, 1, [8]byte{}},</span>
<span class="term-fg32">+			B:   HumanProtocolVersion{0, 4, 0, 0, 0, [8]byte{}},</span>
<span class="term-fg32">+			Cmp: AheadMajor,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			A:   HumanProtocolVersion{0, 1, 0, 0, 1, [8]byte{}},</span>
<span class="term-fg32">+			B:   HumanProtocolVersion{0, 0, 9, 0, 0, [8]byte{}},</span>
<span class="term-fg32">+			Cmp: AheadMinor,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			A:   HumanProtocolVersion{0, 0, 1, 0, 1, [8]byte{}},</span>
<span class="term-fg32">+			B:   HumanProtocolVersion{0, 0, 0, 9, 0, [8]byte{}},</span>
<span class="term-fg32">+			Cmp: AheadPatch,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+		{</span>
<span class="term-fg32">+			A:   HumanProtocolVersion{0, 1, ^uint32(0), 0, 1, [8]byte{}},</span>
<span class="term-fg32">+			B:   HumanProtocolVersion{0, 0, 1, 0, 0, [8]byte{}},</span>
<span class="term-fg32">+			Cmp: InvalidVersion,</span>
<span class="term-fg32">+		},</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	for i, tc := range testCases {</span>
<span class="term-fg32">+		tc := tc &#47;&#47; not a parallel sub-test, but better than a flake</span>
<span class="term-fg32">+		t.Run(fmt.Sprintf(&quot;case_%d&quot;, i), func(t *testing.T) {</span>
<span class="term-fg32">+			a := ProtocolVersionV0{tc.A.Build, tc.A.Major, tc.A.Minor, tc.A.Patch, tc.A.Prerelease}.Encode()</span>
<span class="term-fg32">+			a[0] = tc.A.VersionType</span>
<span class="term-fg32">+			b := ProtocolVersionV0{tc.B.Build, tc.B.Major, tc.B.Minor, tc.B.Patch, tc.B.Prerelease}.Encode()</span>
<span class="term-fg32">+			b[0] = tc.B.VersionType</span>
<span class="term-fg32">+			cmp := a.Compare(b)</span>
<span class="term-fg32">+			if cmp != tc.Cmp {</span>
<span class="term-fg32">+				t.Fatalf(&quot;expected %d but got %d&quot;, tc.Cmp, cmp)</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+			switch tc.Cmp {</span>
<span class="term-fg32">+			case AheadMajor, AheadMinor, AheadPatch, AheadPrerelease:</span>
<span class="term-fg32">+				inv := b.Compare(a)</span>
<span class="term-fg32">+				if inv != -tc.Cmp {</span>
<span class="term-fg32">+					t.Fatalf(&quot;expected inverse when reversing the comparison, %d but got %d&quot;, -tc.Cmp, inv)</span>
<span class="term-fg32">+				}</span>
<span class="term-fg32">+			case DiffVersionType, DiffBuild, EmptyVersion, Matching:</span>
<span class="term-fg32">+				inv := b.Compare(a)</span>
<span class="term-fg32">+				if inv != tc.Cmp {</span>
<span class="term-fg32">+					t.Fatalf(&quot;expected comparison reversed to hold the same, expected %d but got %d&quot;, tc.Cmp, inv)</span>
<span class="term-fg32">+				}</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+		})</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+func TestProtocolVersion_String(t *testing.T) {</span>
<span class="term-fg32">+	testCases := []struct {</span>
<span class="term-fg32">+		version  ProtocolVersion</span>
<span class="term-fg32">+		expected string</span>
<span class="term-fg32">+	}{</span>
<span class="term-fg32">+		{ProtocolVersionV0{[8]byte{}, 0, 0, 0, 0}.Encode(), &quot;v0.0.0&quot;},</span>
<span class="term-fg32">+		{ProtocolVersionV0{[8]byte{}, 0, 0, 0, 1}.Encode(), &quot;v0.0.0-1&quot;},</span>
<span class="term-fg32">+		{ProtocolVersionV0{[8]byte{}, 0, 0, 1, 0}.Encode(), &quot;v0.0.1&quot;},</span>
<span class="term-fg32">+		{ProtocolVersionV0{[8]byte{}, 4, 3, 2, 1}.Encode(), &quot;v4.3.2-1&quot;},</span>
<span class="term-fg32">+		{ProtocolVersionV0{[8]byte{}, 0, 100, 2, 0}.Encode(), &quot;v0.100.2&quot;},</span>
<span class="term-fg32">+		{ProtocolVersionV0{[8]byte{&#39;O&#39;, &#39;P&#39;, &#39;-&#39;, &#39;m&#39;, &#39;o&#39;, &#39;d&#39;}, 42, 0, 2, 1}.Encode(), &quot;v42.0.2-1+OP-mod&quot;},</span>
<span class="term-fg32">+		{ProtocolVersionV0{[8]byte{&#39;b&#39;, &#39;e&#39;, &#39;t&#39;, &#39;a&#39;, &#39;.&#39;, &#39;1&#39;, &#39;2&#39;, &#39;3&#39;}, 1, 0, 0, 0}.Encode(), &quot;v1.0.0+beta.123&quot;},</span>
<span class="term-fg32">+		{ProtocolVersionV0{[8]byte{&#39;a&#39;, &#39;b&#39;, 1}, 42, 0, 2, 0}.Encode(), &quot;v42.0.2+0x6162010000000000&quot;}, &#47;&#47; do not render invalid alpha numeric</span>
<span class="term-fg32">+		{ProtocolVersionV0{[8]byte{1, 2, 3, 4, 5, 6, 7, 8}, 42, 0, 2, 0}.Encode(), &quot;v42.0.2+0x0102030405060708&quot;},</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	for _, tc := range testCases {</span>
<span class="term-fg32">+		t.Run(tc.expected, func(t *testing.T) {</span>
<span class="term-fg32">+			got := tc.version.String()</span>
<span class="term-fg32">+			if got != tc.expected {</span>
<span class="term-fg32">+				t.Fatalf(&quot;got %q but expected %q&quot;, got, tc.expected)</span>
<span class="term-fg32">+			}</span>
<span class="term-fg32">+		})</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-muted" data-bs-toggle="collapse" href="#id-e7c9d3654179ad2a01fc3674" role="button"
                       aria-expanded="false" aria-controls="id-e7c9d3654179ad2a01fc3674">
                        <code>rpc/client_test.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/rpc/client_test.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/rpc/client_test.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-add-ignored">+1</span></div>
                            <div class="text-start"><span class="text-delete-ignored">-1</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-e7c9d3654179ad2a01fc3674"><span class="term-fg1">diff --git go-ethereum&#47;rpc&#47;client_test.go op-geth&#47;rpc&#47;client_test.go</span>
<span class="term-fg1">index 01c326afb017eb13ca9013d1b20a017277bf4c1c..e692f7752dbdebcd00d8216db9d0fb166d9b0016 100644</span>
<span class="term-fg1">--- go-ethereum&#47;rpc&#47;client_test.go</span>
<span class="term-fg1">+++ op-geth&#47;rpc&#47;client_test.go</span>
<span class="term-fg36">@@ -587,7 +587,7 @@</span>
 	var (
 		srv     = NewServer()
 		httpsrv = httptest.NewServer(srv.WebsocketHandler(nil))
<span class="term-fg31">-		wsURL   = &quot;ws:&quot; + strings.TrimPrefix(httpsrv.URL, &quot;http:&quot;)</span>
<span class="term-fg32">+		wsURL   = &quot;ws:&quot; + strings.TrimPrefix(httpsrv.URL, &quot;http:&quot;) &#47;&#47;nolint:all</span>
 	)
 	defer srv.Stop()
 	defer httpsrv.Close()</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-muted" data-bs-toggle="collapse" href="#id-b742787c22ec0f2d5bb92772" role="button"
                       aria-expanded="false" aria-controls="id-b742787c22ec0f2d5bb92772">
                        <code>tests/state_test.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/tests/state_test.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/tests/state_test.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-add-ignored">+1</span></div>
                            <div class="text-start"><span class="text-delete-ignored">-1</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-b742787c22ec0f2d5bb92772"><span class="term-fg1">diff --git go-ethereum&#47;tests&#47;state_test.go op-geth&#47;tests&#47;state_test.go</span>
<span class="term-fg1">index 76fec97de0ee0ea0ea8d9c1328839998f87ee2a0..95233c3b103273599a3a55e167c8c7113b7a7d22 100644</span>
<span class="term-fg1">--- go-ethereum&#47;tests&#47;state_test.go</span>
<span class="term-fg1">+++ op-geth&#47;tests&#47;state_test.go</span>
<span class="term-fg36">@@ -302,7 +302,7 @@</span> 			}
&nbsp;
 			&#47;&#47; Prepare the EVM.
 			txContext := core.NewEVMTxContext(msg)
<span class="term-fg31">-			context := core.NewEVMBlockContext(block.Header(), nil, &amp;t.json.Env.Coinbase)</span>
<span class="term-fg32">+			context := core.NewEVMBlockContext(block.Header(), nil, &amp;t.json.Env.Coinbase, config, state.StateDB)</span>
 			context.GetHash = vmTestBlockHash
 			context.BaseFee = baseFee
 			evm := vm.NewEVM(context, txContext, state.StateDB, config, vmconfig)</div>
    </div>

            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
                <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-271e13efd8fae65bb2b535f7"role="button" aria-expanded="false" aria-controls="id-271e13efd8fae65bb2b535f7">
        
            <div class="col-12 col-md-12 col-lg-6 col-xl-6 text-start"><h2>Other changes</h2></div>
        

        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2">
            <div class="row line-stat">
                
                
            </div>
        </div>
        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2 ">
            <div class="row line-stat">
                
                    <div class="text-end"><span class="text-success">+123</span></div>
                    <div class="text-start"><span class="text-danger">-22039</span></div>
                
                
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-271e13efd8fae65bb2b535f7">
        <div></div>
        <div>
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-d2c1efb12f86567c40c98153" role="button"
                       aria-expanded="false" aria-controls="id-d2c1efb12f86567c40c98153">
                        <code>beacon/engine/gen_epe.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/beacon/engine/gen_epe.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/beacon/engine/gen_epe.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+15</span></div>
                            <div class="text-start"><span class="text-danger">-8</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-d2c1efb12f86567c40c98153"><span class="term-fg1">diff --git go-ethereum&#47;beacon&#47;engine&#47;gen_epe.go op-geth&#47;beacon&#47;engine&#47;gen_epe.go</span>
<span class="term-fg1">index e69f9a5951a28deeaa9ad51f1b2d9e8733b2feca..3529bbd66141dcf34643f03ee03c5dbe2a67f1d5 100644</span>
<span class="term-fg1">--- go-ethereum&#47;beacon&#47;engine&#47;gen_epe.go</span>
<span class="term-fg1">+++ op-geth&#47;beacon&#47;engine&#47;gen_epe.go</span>
<span class="term-fg36">@@ -7,6 +7,7 @@</span> 	&quot;encoding&#47;json&quot;
 	&quot;errors&quot;
 	&quot;math&#47;big&quot;
&nbsp;
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&quot;</span>
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&#47;hexutil&quot;
 )
&nbsp;
<span class="term-fg36">@@ -15,26 +16,29 @@</span>
 &#47;&#47; MarshalJSON marshals as JSON.
 func (e ExecutionPayloadEnvelope) MarshalJSON() ([]byte, error) {
 	type ExecutionPayloadEnvelope struct {
<span class="term-fg31">-		ExecutionPayload *ExecutableData `json:&quot;executionPayload&quot;  gencodec:&quot;required&quot;`</span>
<span class="term-fg31">-		BlockValue       *hexutil.Big    `json:&quot;blockValue&quot;  gencodec:&quot;required&quot;`</span>
<span class="term-fg31">-		BlobsBundle      *BlobsBundleV1  `json:&quot;blobsBundle&quot;`</span>
<span class="term-fg31">-		Override         bool            `json:&quot;shouldOverrideBuilder&quot;`</span>
<span class="term-fg32">+		ExecutionPayload      *ExecutableData `json:&quot;executionPayload&quot;  gencodec:&quot;required&quot;`</span>
<span class="term-fg32">+		BlockValue            *hexutil.Big    `json:&quot;blockValue&quot;  gencodec:&quot;required&quot;`</span>
<span class="term-fg32">+		BlobsBundle           *BlobsBundleV1  `json:&quot;blobsBundle&quot;`</span>
<span class="term-fg32">+		Override              bool            `json:&quot;shouldOverrideBuilder&quot;`</span>
<span class="term-fg32">+		ParentBeaconBlockRoot *common.Hash    `json:&quot;parentBeaconBlockRoot,omitempty&quot;`</span>
 	}
 	var enc ExecutionPayloadEnvelope
 	enc.ExecutionPayload = e.ExecutionPayload
 	enc.BlockValue = (*hexutil.Big)(e.BlockValue)
 	enc.BlobsBundle = e.BlobsBundle
 	enc.Override = e.Override
<span class="term-fg32">+	enc.ParentBeaconBlockRoot = e.ParentBeaconBlockRoot</span>
 	return json.Marshal(&amp;enc)
 }
&nbsp;
 &#47;&#47; UnmarshalJSON unmarshals from JSON.
 func (e *ExecutionPayloadEnvelope) UnmarshalJSON(input []byte) error {
 	type ExecutionPayloadEnvelope struct {
<span class="term-fg31">-		ExecutionPayload *ExecutableData `json:&quot;executionPayload&quot;  gencodec:&quot;required&quot;`</span>
<span class="term-fg31">-		BlockValue       *hexutil.Big    `json:&quot;blockValue&quot;  gencodec:&quot;required&quot;`</span>
<span class="term-fg31">-		BlobsBundle      *BlobsBundleV1  `json:&quot;blobsBundle&quot;`</span>
<span class="term-fg31">-		Override         *bool           `json:&quot;shouldOverrideBuilder&quot;`</span>
<span class="term-fg32">+		ExecutionPayload      *ExecutableData `json:&quot;executionPayload&quot;  gencodec:&quot;required&quot;`</span>
<span class="term-fg32">+		BlockValue            *hexutil.Big    `json:&quot;blockValue&quot;  gencodec:&quot;required&quot;`</span>
<span class="term-fg32">+		BlobsBundle           *BlobsBundleV1  `json:&quot;blobsBundle&quot;`</span>
<span class="term-fg32">+		Override              *bool           `json:&quot;shouldOverrideBuilder&quot;`</span>
<span class="term-fg32">+		ParentBeaconBlockRoot *common.Hash    `json:&quot;parentBeaconBlockRoot,omitempty&quot;`</span>
 	}
 	var dec ExecutionPayloadEnvelope
 	if err := json.Unmarshal(input, &amp;dec); err != nil {
<span class="term-fg36">@@ -53,6 +57,9 @@</span> 		e.BlobsBundle = dec.BlobsBundle
 	}
 	if dec.Override != nil {
 		e.Override = *dec.Override
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	if dec.ParentBeaconBlockRoot != nil {</span>
<span class="term-fg32">+		e.ParentBeaconBlockRoot = dec.ParentBeaconBlockRoot</span>
 	}
 	return nil
 }</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-fe240b43cc3de2c85cab8ba8" role="button"
                       aria-expanded="false" aria-controls="id-fe240b43cc3de2c85cab8ba8">
                        <code>cmd/era/main.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/cmd/era/main.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/cmd/era/main.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+6</span></div>
                            <div class="text-start"><span class="text-danger">-1</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-fe240b43cc3de2c85cab8ba8"><span class="term-fg1">diff --git go-ethereum&#47;cmd&#47;era&#47;main.go op-geth&#47;cmd&#47;era&#47;main.go</span>
<span class="term-fg1">index 8b57fd695c531d3a45282f6cfdc944b34c2d9f93..8163e659994c20b908e45bfd4401c30223d86f6e 100644</span>
<span class="term-fg1">--- go-ethereum&#47;cmd&#47;era&#47;main.go</span>
<span class="term-fg1">+++ op-geth&#47;cmd&#47;era&#47;main.go</span>
<span class="term-fg36">@@ -29,6 +29,7 @@</span> 	&quot;time&quot;
&nbsp;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&#47;types&quot;
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;eth&quot;</span>
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;internal&#47;era&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;internal&#47;ethapi&quot;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;internal&#47;flags&quot;
<span class="term-fg36">@@ -122,7 +123,11 @@</span> 	if err != nil {
 		return fmt.Errorf(&quot;error reading block %d: %w&quot;, num, err)
 	}
 	&#47;&#47; Convert block to JSON and print.
<span class="term-fg31">-	val := ethapi.RPCMarshalBlock(block, ctx.Bool(txsFlag.Name), ctx.Bool(txsFlag.Name), params.MainnetChainConfig)</span>
<span class="term-fg32">+	&#47;&#47; TODO: without a proper Eth API Backend, this tool isn&#39;t expected to function correctly</span>
<span class="term-fg32">+	val, err := ethapi.RPCMarshalBlock(ctx.Context, block, ctx.Bool(txsFlag.Name), ctx.Bool(txsFlag.Name), params.MainnetChainConfig, &amp;eth.EthAPIBackend{})</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		return fmt.Errorf(&quot;error marshaling block: %w&quot;, err)</span>
<span class="term-fg32">+	}</span>
 	b, err := json.MarshalIndent(val, &quot;&quot;, &quot;  &quot;)
 	if err != nil {
 		return fmt.Errorf(&quot;error marshaling json: %w&quot;, err)</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-85efa42cd33cda20492e7e3c" role="button"
                       aria-expanded="false" aria-controls="id-85efa42cd33cda20492e7e3c">
                        <code>cmd/evm/internal/t8ntool/transition.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/cmd/evm/internal/t8ntool/transition.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/cmd/evm/internal/t8ntool/transition.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+1</span></div>
                            <div class="text-start"><span class="text-danger">-1</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-85efa42cd33cda20492e7e3c"><span class="term-fg1">diff --git go-ethereum&#47;cmd&#47;evm&#47;internal&#47;t8ntool&#47;transition.go op-geth&#47;cmd&#47;evm&#47;internal&#47;t8ntool&#47;transition.go</span>
<span class="term-fg1">index fa052f59549b7373c2e5e455aaaafdc55b0ba285..8b7c77ae76d998a4b47990621e24319d99da5cbb 100644</span>
<span class="term-fg1">--- go-ethereum&#47;cmd&#47;evm&#47;internal&#47;t8ntool&#47;transition.go</span>
<span class="term-fg1">+++ op-geth&#47;cmd&#47;evm&#47;internal&#47;t8ntool&#47;transition.go</span>
<span class="term-fg36">@@ -224,7 +224,7 @@</span> 		Number:   new(big.Int).SetUint64(env.Number - 1),
 		BaseFee:  env.ParentBaseFee,
 		GasUsed:  env.ParentGasUsed,
 		GasLimit: env.ParentGasLimit,
<span class="term-fg31">-	})</span>
<span class="term-fg32">+	}, env.Timestamp)</span>
 	return nil
 }
</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-58eeaad504e7c0bf9c23d4bd" role="button"
                       aria-expanded="false" aria-controls="id-58eeaad504e7c0bf9c23d4bd">
                        <code>consensus/misc/create2deployer.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/consensus/misc/create2deployer.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+37</span></div>
                            <div class="text-start"><span class="text-danger">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-58eeaad504e7c0bf9c23d4bd"><span class="term-fg1">diff --git go-ethereum&#47;consensus&#47;misc&#47;create2deployer.go op-geth&#47;consensus&#47;misc&#47;create2deployer.go</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..27c87a4a8c45b1e859719e8d4f8e5775ff3da0ca</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ op-geth&#47;consensus&#47;misc&#47;create2deployer.go</span>
<span class="term-fg36">@@ -0,0 +1,37 @@</span>
<span class="term-fg32">+package misc</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+import (</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum-optimism&#47;superchain-registry&#47;superchain&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;common&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;core&#47;vm&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;log&quot;</span>
<span class="term-fg32">+	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;params&quot;</span>
<span class="term-fg32">+)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; The original create2deployer contract could not be deployed to Base mainnet at</span>
<span class="term-fg32">+&#47;&#47; the canonical address of 0x13b0D85CcB8bf860b6b79AF3029fCA081AE9beF2 due to</span>
<span class="term-fg32">+&#47;&#47; an accidental nonce increment from a deposit transaction. See</span>
<span class="term-fg32">+&#47;&#47; https:&#47;&#47;github.com&#47;pcaversaccio&#47;create2deployer&#47;issues&#47;128 for context. This</span>
<span class="term-fg32">+&#47;&#47; file applies the contract code to the canonical address manually in the Canyon</span>
<span class="term-fg32">+&#47;&#47; hardfork.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+var create2DeployerAddress = common.HexToAddress(&quot;0x13b0D85CcB8bf860b6b79AF3029fCA081AE9beF2&quot;)</span>
<span class="term-fg32">+var create2DeployerCodeHash = common.HexToHash(&quot;0xb0550b5b431e30d38000efb7107aaa0ade03d48a7198a140edda9d27134468b2&quot;)</span>
<span class="term-fg32">+var create2DeployerCode []byte</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func init() {</span>
<span class="term-fg32">+	code, err := superchain.LoadContractBytecode(superchain.Hash(create2DeployerCodeHash))</span>
<span class="term-fg32">+	if err != nil {</span>
<span class="term-fg32">+		panic(err)</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	create2DeployerCode = code</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+func EnsureCreate2Deployer(c *params.ChainConfig, timestamp uint64, db vm.StateDB) {</span>
<span class="term-fg32">+	if !c.IsOptimism() || c.CanyonTime == nil || *c.CanyonTime != timestamp {</span>
<span class="term-fg32">+		return</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	log.Info(&quot;Setting Create2Deployer code&quot;, &quot;address&quot;, create2DeployerAddress, &quot;codeHash&quot;, create2DeployerCodeHash)</span>
<span class="term-fg32">+	db.SetCode(create2DeployerAddress, create2DeployerCode)</span>
<span class="term-fg32">+}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-ef08f49e5c630ba48748b6f9" role="button"
                       aria-expanded="false" aria-controls="id-ef08f49e5c630ba48748b6f9">
                        <code>core/chain_makers.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/core/chain_makers.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/core/chain_makers.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+4</span></div>
                            <div class="text-start"><span class="text-danger">-4</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-ef08f49e5c630ba48748b6f9"><span class="term-fg1">diff --git go-ethereum&#47;core&#47;chain_makers.go op-geth&#47;core&#47;chain_makers.go</span>
<span class="term-fg1">index 58985347bb3171c8003cd966df440bb8cac18dac..149134fbe75303011c0cefe24295257c6efbe25a 100644</span>
<span class="term-fg1">--- go-ethereum&#47;core&#47;chain_makers.go</span>
<span class="term-fg1">+++ op-geth&#47;core&#47;chain_makers.go</span>
<span class="term-fg36">@@ -99,7 +99,7 @@</span> &#47;&#47; block.
 func (b *BlockGen) SetParentBeaconRoot(root common.Hash) {
 	b.header.ParentBeaconRoot = &amp;root
 	var (
<span class="term-fg31">-		blockContext = NewEVMBlockContext(b.header, b.cm, &amp;b.header.Coinbase)</span>
<span class="term-fg32">+		blockContext = NewEVMBlockContext(b.header, b.cm, &amp;b.header.Coinbase, b.cm.config, b.statedb)</span>
 		vmenv        = vm.NewEVM(blockContext, vm.TxContext{}, b.statedb, b.cm.config, vm.Config{})
 	)
 	ProcessBeaconBlockRoot(root, vmenv, b.statedb)
<span class="term-fg36">@@ -231,7 +231,7 @@</span>
 	&#47;&#47; The gas limit and price should be derived from the parent
 	h.GasLimit = parent.GasLimit
 	if b.cm.config.IsLondon(h.Number) {
<span class="term-fg31">-		h.BaseFee = eip1559.CalcBaseFee(b.cm.config, parent)</span>
<span class="term-fg32">+		h.BaseFee = eip1559.CalcBaseFee(b.cm.config, parent, h.Time)</span>
 		if !b.cm.config.IsLondon(parent.Number) {
 			parentGasLimit := parent.GasLimit * b.cm.config.ElasticityMultiplier()
 			h.GasLimit = CalcGasLimit(parentGasLimit, parentGasLimit)
<span class="term-fg36">@@ -321,7 +321,7 @@</span> 		&#47;&#47; Set the difficulty for clique block. The chain maker doesn&#39;t have access
 		&#47;&#47; to a chain, so the difficulty will be left unset (nil). Set it here to the
 		&#47;&#47; correct value.
 		if b.header.Difficulty == nil {
<span class="term-fg31">-			if config.TerminalTotalDifficulty == nil {</span>
<span class="term-fg32">+			if config.TerminalTotalDifficulty == nil &amp;&amp; !config.IsOptimismBedrock(b.header.Number) {</span>
 				&#47;&#47; Clique chain
 				b.header.Difficulty = big.NewInt(2)
 			} else {
<span class="term-fg36">@@ -538,7 +538,7 @@</span> 		Time:       time,
 	}
&nbsp;
 	if cm.config.IsLondon(header.Number) {
<span class="term-fg31">-		header.BaseFee = eip1559.CalcBaseFee(cm.config, parent.Header())</span>
<span class="term-fg32">+		header.BaseFee = eip1559.CalcBaseFee(cm.config, parent.Header(), header.Time)</span>
 		if !cm.config.IsLondon(parent.Number()) {
 			parentGasLimit := parent.GasLimit() * cm.config.ElasticityMultiplier()
 			header.GasLimit = CalcGasLimit(parentGasLimit, parentGasLimit)</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-54c5c380fea3b0f5eaafbb87" role="button"
                       aria-expanded="false" aria-controls="id-54c5c380fea3b0f5eaafbb87">
                        <code>core/state/statedb.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/core/state/statedb.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/core/state/statedb.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+6</span></div>
                            <div class="text-start"><span class="text-danger">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-54c5c380fea3b0f5eaafbb87"><span class="term-fg1">diff --git go-ethereum&#47;core&#47;state&#47;statedb.go op-geth&#47;core&#47;state&#47;statedb.go</span>
<span class="term-fg1">index ac82a8e3e3ab0fb1eff18b7559bfb6b5d3372115..deb79caf9a8ccdd9d66c948305b355493003461d 100644</span>
<span class="term-fg1">--- go-ethereum&#47;core&#47;state&#47;statedb.go</span>
<span class="term-fg1">+++ op-geth&#47;core&#47;state&#47;statedb.go</span>
<span class="term-fg36">@@ -1450,6 +1450,12 @@</span> func (s *StateDB) SlotInAccessList(addr common.Address, slot common.Hash) (addressPresent bool, slotPresent bool) {
 	return s.accessList.Contains(addr, slot)
 }
&nbsp;
<span class="term-fg32">+&#47;&#47; OpenStorageTrie opens the storage trie for the storage root of the provided address.</span>
<span class="term-fg32">+func (s *StateDB) OpenStorageTrie(addr common.Address) (Trie, error) {</span>
<span class="term-fg32">+	storageRoot := s.GetStorageRoot(addr)</span>
<span class="term-fg32">+	return s.db.OpenStorageTrie(s.originalRoot, addr, storageRoot, s.trie)</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
 &#47;&#47; markDelete is invoked when an account is deleted but the deletion is
 &#47;&#47; not yet committed. The pending mutation is cached and will be applied
 &#47;&#47; all together</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-8ff6ed6df662b6b7d9c5aa92" role="button"
                       aria-expanded="false" aria-controls="id-8ff6ed6df662b6b7d9c5aa92">
                        <code>core/tracing/hooks.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/core/tracing/hooks.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/core/tracing/hooks.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+3</span></div>
                            <div class="text-start"><span class="text-danger">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-8ff6ed6df662b6b7d9c5aa92"><span class="term-fg1">diff --git go-ethereum&#47;core&#47;tracing&#47;hooks.go op-geth&#47;core&#47;tracing&#47;hooks.go</span>
<span class="term-fg1">index aa66dc49ff09dbc8797f2ca9813ff53203e744e8..9efe11a2d96c42706178b1ef011e9b350a8c56a1 100644</span>
<span class="term-fg1">--- go-ethereum&#47;core&#47;tracing&#47;hooks.go</span>
<span class="term-fg1">+++ op-geth&#47;core&#47;tracing&#47;hooks.go</span>
<span class="term-fg36">@@ -244,6 +244,9 @@</span> 	&#47;&#47; BalanceDecreaseSelfdestructBurn is ether that is sent to an already self-destructed
 	&#47;&#47; account within the same tx (captured at end of tx).
 	&#47;&#47; Note it doesn&#39;t account for a self-destruct which appoints itself as recipient.
 	BalanceDecreaseSelfdestructBurn BalanceChangeReason = 14
<span class="term-fg32">+</span>
<span class="term-fg32">+	&#47;&#47; OP-Geth specific</span>
<span class="term-fg32">+	BalanceMint BalanceChangeReason = 200</span>
 )
&nbsp;
 &#47;&#47; GasChangeReason is used to indicate the reason for a gas change, useful</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-16111a1db33c605afd9e70db" role="button"
                       aria-expanded="false" aria-controls="id-16111a1db33c605afd9e70db">
                        <code>crypto/secp256k1/.gitignore</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/.gitignore" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-24</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-16111a1db33c605afd9e70db"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;.gitignore op-geth&#47;crypto&#47;secp256k1&#47;.gitignore</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 802b6744a1d9fb2b9711384aca36a8790bae7f0f..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;.gitignore</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,24 +0,0 @@</span>
<span class="term-fg31">-# Compiled Object files, Static and Dynamic libs (Shared Objects)</span>
<span class="term-fg31">-*.o</span>
<span class="term-fg31">-*.a</span>
<span class="term-fg31">-*.so</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-# Folders</span>
<span class="term-fg31">-_obj</span>
<span class="term-fg31">-_test</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-# Architecture specific extensions&#47;prefixes</span>
<span class="term-fg31">-*.[568vq]</span>
<span class="term-fg31">-[568vq].out</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-*.cgo1.go</span>
<span class="term-fg31">-*.cgo2.c</span>
<span class="term-fg31">-_cgo_defun.c</span>
<span class="term-fg31">-_cgo_gotypes.go</span>
<span class="term-fg31">-_cgo_export.*</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-_testmain.go</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-*.exe</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-*~</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-8ae2f3a5d6de7168c1724197" role="button"
                       aria-expanded="false" aria-controls="id-8ae2f3a5d6de7168c1724197">
                        <code>crypto/secp256k1/LICENSE</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/LICENSE" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-31</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-8ae2f3a5d6de7168c1724197"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;LICENSE op-geth&#47;crypto&#47;secp256k1&#47;LICENSE</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index f9090e14236bc29a71ac446c306b0e4d3c3b2065..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;LICENSE</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,31 +0,0 @@</span>
<span class="term-fg31">-Copyright (c) 2010 The Go Authors. All rights reserved.</span>
<span class="term-fg31">-Copyright (c) 2011 ThePiachu. All rights reserved.</span>
<span class="term-fg31">-Copyright (c) 2015 Jeffrey Wilcke. All rights reserved.</span>
<span class="term-fg31">-Copyright (c) 2015 Felix Lange. All rights reserved.</span>
<span class="term-fg31">-Copyright (c) 2015 Gustav Simonsson. All rights reserved.</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-Redistribution and use in source and binary forms, with or without</span>
<span class="term-fg31">-modification, are permitted provided that the following conditions are</span>
<span class="term-fg31">-met:</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-   * Redistributions of source code must retain the above copyright</span>
<span class="term-fg31">-notice, this list of conditions and the following disclaimer.</span>
<span class="term-fg31">-   * Redistributions in binary form must reproduce the above</span>
<span class="term-fg31">-copyright notice, this list of conditions and the following disclaimer</span>
<span class="term-fg31">-in the documentation and&#47;or other materials provided with the</span>
<span class="term-fg31">-distribution.</span>
<span class="term-fg31">-   * Neither the name of the copyright holder. nor the names of its</span>
<span class="term-fg31">-contributors may be used to endorse or promote products derived from</span>
<span class="term-fg31">-this software without specific prior written permission.</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS</span>
<span class="term-fg31">-&quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT</span>
<span class="term-fg31">-LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR</span>
<span class="term-fg31">-A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT</span>
<span class="term-fg31">-OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,</span>
<span class="term-fg31">-SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT</span>
<span class="term-fg31">-LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,</span>
<span class="term-fg31">-DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY</span>
<span class="term-fg31">-THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span>
<span class="term-fg31">-(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<span class="term-fg31">-OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-8a26142706dd6f696f6d9348" role="button"
                       aria-expanded="false" aria-controls="id-8a26142706dd6f696f6d9348">
                        <code>crypto/secp256k1/curve.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/curve.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-297</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-8a26142706dd6f696f6d9348"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;curve.go op-geth&#47;crypto&#47;secp256k1&#47;curve.go</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 85ba885d6f5f0fc089659f0769db6525e78aa539..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;curve.go</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,297 +0,0 @@</span>
<span class="term-fg31">-&#47;&#47; Copyright 2010 The Go Authors. All rights reserved.</span>
<span class="term-fg31">-&#47;&#47; Copyright 2011 ThePiachu. All rights reserved.</span>
<span class="term-fg31">-&#47;&#47; Copyright 2015 Jeffrey Wilcke, Felix Lange, Gustav Simonsson. All rights reserved.</span>
<span class="term-fg31">-&#47;&#47;</span>
<span class="term-fg31">-&#47;&#47; Redistribution and use in source and binary forms, with or without</span>
<span class="term-fg31">-&#47;&#47; modification, are permitted provided that the following conditions are</span>
<span class="term-fg31">-&#47;&#47; met:</span>
<span class="term-fg31">-&#47;&#47;</span>
<span class="term-fg31">-&#47;&#47; * Redistributions of source code must retain the above copyright</span>
<span class="term-fg31">-&#47;&#47;   notice, this list of conditions and the following disclaimer.</span>
<span class="term-fg31">-&#47;&#47; * Redistributions in binary form must reproduce the above</span>
<span class="term-fg31">-&#47;&#47;   copyright notice, this list of conditions and the following disclaimer</span>
<span class="term-fg31">-&#47;&#47;   in the documentation and&#47;or other materials provided with the</span>
<span class="term-fg31">-&#47;&#47;   distribution.</span>
<span class="term-fg31">-&#47;&#47; * Neither the name of Google Inc. nor the names of its</span>
<span class="term-fg31">-&#47;&#47;   contributors may be used to endorse or promote products derived from</span>
<span class="term-fg31">-&#47;&#47;   this software without specific prior written permission.</span>
<span class="term-fg31">-&#47;&#47; * The name of ThePiachu may not be used to endorse or promote products</span>
<span class="term-fg31">-&#47;&#47;   derived from this software without specific prior written permission.</span>
<span class="term-fg31">-&#47;&#47;</span>
<span class="term-fg31">-&#47;&#47; THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS</span>
<span class="term-fg31">-&#47;&#47; &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT</span>
<span class="term-fg31">-&#47;&#47; LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR</span>
<span class="term-fg31">-&#47;&#47; A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT</span>
<span class="term-fg31">-&#47;&#47; OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,</span>
<span class="term-fg31">-&#47;&#47; SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT</span>
<span class="term-fg31">-&#47;&#47; LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,</span>
<span class="term-fg31">-&#47;&#47; DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY</span>
<span class="term-fg31">-&#47;&#47; THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span>
<span class="term-fg31">-&#47;&#47; (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<span class="term-fg31">-&#47;&#47; OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-package secp256k1</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-import (</span>
<span class="term-fg31">-	&quot;crypto&#47;elliptic&quot;</span>
<span class="term-fg31">-	&quot;math&#47;big&quot;</span>
<span class="term-fg31">-)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-const (</span>
<span class="term-fg31">-	&#47;&#47; number of bits in a big.Word</span>
<span class="term-fg31">-	wordBits = 32 &lt;&lt; (uint64(^big.Word(0)) &gt;&gt; 63)</span>
<span class="term-fg31">-	&#47;&#47; number of bytes in a big.Word</span>
<span class="term-fg31">-	wordBytes = wordBits &#47; 8</span>
<span class="term-fg31">-)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;&#47; readBits encodes the absolute value of bigint as big-endian bytes. Callers</span>
<span class="term-fg31">-&#47;&#47; must ensure that buf has enough space. If buf is too short the result will</span>
<span class="term-fg31">-&#47;&#47; be incomplete.</span>
<span class="term-fg31">-func readBits(bigint *big.Int, buf []byte) {</span>
<span class="term-fg31">-	i := len(buf)</span>
<span class="term-fg31">-	for _, d := range bigint.Bits() {</span>
<span class="term-fg31">-		for j := 0; j &lt; wordBytes &amp;&amp; i &gt; 0; j++ {</span>
<span class="term-fg31">-			i--</span>
<span class="term-fg31">-			buf[i] = byte(d)</span>
<span class="term-fg31">-			d &gt;&gt;= 8</span>
<span class="term-fg31">-		}</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;&#47; This code is from https:&#47;&#47;github.com&#47;ThePiachu&#47;GoBit and implements</span>
<span class="term-fg31">-&#47;&#47; several Koblitz elliptic curves over prime fields.</span>
<span class="term-fg31">-&#47;&#47;</span>
<span class="term-fg31">-&#47;&#47; The curve methods, internally, on Jacobian coordinates. For a given</span>
<span class="term-fg31">-&#47;&#47; (x, y) position on the curve, the Jacobian coordinates are (x1, y1,</span>
<span class="term-fg31">-&#47;&#47; z1) where x = x1&#47;z1 and y = y1&#47;z1. The greatest speedups come</span>
<span class="term-fg31">-&#47;&#47; when the whole calculation can be performed within the transform</span>
<span class="term-fg31">-&#47;&#47; (as in ScalarMult and ScalarBaseMult). But even for Add and Double,</span>
<span class="term-fg31">-&#47;&#47; it&#39;s faster to apply and reverse the transform than to operate in</span>
<span class="term-fg31">-&#47;&#47; affine coordinates.</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;&#47; A BitCurve represents a Koblitz Curve with a=0.</span>
<span class="term-fg31">-&#47;&#47; See http:&#47;&#47;www.hyperelliptic.org&#47;EFD&#47;g1p&#47;auto-shortw.html</span>
<span class="term-fg31">-type BitCurve struct {</span>
<span class="term-fg31">-	P       *big.Int &#47;&#47; the order of the underlying field</span>
<span class="term-fg31">-	N       *big.Int &#47;&#47; the order of the base point</span>
<span class="term-fg31">-	B       *big.Int &#47;&#47; the constant of the BitCurve equation</span>
<span class="term-fg31">-	Gx, Gy  *big.Int &#47;&#47; (x,y) of the base point</span>
<span class="term-fg31">-	BitSize int      &#47;&#47; the size of the underlying field</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-func (bitCurve *BitCurve) Params() *elliptic.CurveParams {</span>
<span class="term-fg31">-	return &amp;elliptic.CurveParams{</span>
<span class="term-fg31">-		P:       bitCurve.P,</span>
<span class="term-fg31">-		N:       bitCurve.N,</span>
<span class="term-fg31">-		B:       bitCurve.B,</span>
<span class="term-fg31">-		Gx:      bitCurve.Gx,</span>
<span class="term-fg31">-		Gy:      bitCurve.Gy,</span>
<span class="term-fg31">-		BitSize: bitCurve.BitSize,</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;&#47; IsOnCurve returns true if the given (x,y) lies on the BitCurve.</span>
<span class="term-fg31">-func (bitCurve *BitCurve) IsOnCurve(x, y *big.Int) bool {</span>
<span class="term-fg31">-	&#47;&#47; y = x + b</span>
<span class="term-fg31">-	y2 := new(big.Int).Mul(y, y) &#47;&#47;y</span>
<span class="term-fg31">-	y2.Mod(y2, bitCurve.P)       &#47;&#47;y%P</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	x3 := new(big.Int).Mul(x, x) &#47;&#47;x</span>
<span class="term-fg31">-	x3.Mul(x3, x)                &#47;&#47;x</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	x3.Add(x3, bitCurve.B) &#47;&#47;x+B</span>
<span class="term-fg31">-	x3.Mod(x3, bitCurve.P) &#47;&#47;(x+B)%P</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	return x3.Cmp(y2) == 0</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;&#47; affineFromJacobian reverses the Jacobian transform. See the comment at the</span>
<span class="term-fg31">-&#47;&#47; top of the file.</span>
<span class="term-fg31">-func (bitCurve *BitCurve) affineFromJacobian(x, y, z *big.Int) (xOut, yOut *big.Int) {</span>
<span class="term-fg31">-	if z.Sign() == 0 {</span>
<span class="term-fg31">-		return new(big.Int), new(big.Int)</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	zinv := new(big.Int).ModInverse(z, bitCurve.P)</span>
<span class="term-fg31">-	zinvsq := new(big.Int).Mul(zinv, zinv)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	xOut = new(big.Int).Mul(x, zinvsq)</span>
<span class="term-fg31">-	xOut.Mod(xOut, bitCurve.P)</span>
<span class="term-fg31">-	zinvsq.Mul(zinvsq, zinv)</span>
<span class="term-fg31">-	yOut = new(big.Int).Mul(y, zinvsq)</span>
<span class="term-fg31">-	yOut.Mod(yOut, bitCurve.P)</span>
<span class="term-fg31">-	return</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;&#47; Add returns the sum of (x1,y1) and (x2,y2)</span>
<span class="term-fg31">-func (bitCurve *BitCurve) Add(x1, y1, x2, y2 *big.Int) (*big.Int, *big.Int) {</span>
<span class="term-fg31">-	&#47;&#47; If one point is at infinity, return the other point.</span>
<span class="term-fg31">-	&#47;&#47; Adding the point at infinity to any point will preserve the other point.</span>
<span class="term-fg31">-	if x1.Sign() == 0 &amp;&amp; y1.Sign() == 0 {</span>
<span class="term-fg31">-		return x2, y2</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-	if x2.Sign() == 0 &amp;&amp; y2.Sign() == 0 {</span>
<span class="term-fg31">-		return x1, y1</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-	z := new(big.Int).SetInt64(1)</span>
<span class="term-fg31">-	if x1.Cmp(x2) == 0 &amp;&amp; y1.Cmp(y2) == 0 {</span>
<span class="term-fg31">-		return bitCurve.affineFromJacobian(bitCurve.doubleJacobian(x1, y1, z))</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-	return bitCurve.affineFromJacobian(bitCurve.addJacobian(x1, y1, z, x2, y2, z))</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;&#47; addJacobian takes two points in Jacobian coordinates, (x1, y1, z1) and</span>
<span class="term-fg31">-&#47;&#47; (x2, y2, z2) and returns their sum, also in Jacobian form.</span>
<span class="term-fg31">-func (bitCurve *BitCurve) addJacobian(x1, y1, z1, x2, y2, z2 *big.Int) (*big.Int, *big.Int, *big.Int) {</span>
<span class="term-fg31">-	&#47;&#47; See http:&#47;&#47;hyperelliptic.org&#47;EFD&#47;g1p&#47;auto-shortw-jacobian-0.html#addition-add-2007-bl</span>
<span class="term-fg31">-	z1z1 := new(big.Int).Mul(z1, z1)</span>
<span class="term-fg31">-	z1z1.Mod(z1z1, bitCurve.P)</span>
<span class="term-fg31">-	z2z2 := new(big.Int).Mul(z2, z2)</span>
<span class="term-fg31">-	z2z2.Mod(z2z2, bitCurve.P)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	u1 := new(big.Int).Mul(x1, z2z2)</span>
<span class="term-fg31">-	u1.Mod(u1, bitCurve.P)</span>
<span class="term-fg31">-	u2 := new(big.Int).Mul(x2, z1z1)</span>
<span class="term-fg31">-	u2.Mod(u2, bitCurve.P)</span>
<span class="term-fg31">-	h := new(big.Int).Sub(u2, u1)</span>
<span class="term-fg31">-	if h.Sign() == -1 {</span>
<span class="term-fg31">-		h.Add(h, bitCurve.P)</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-	i := new(big.Int).Lsh(h, 1)</span>
<span class="term-fg31">-	i.Mul(i, i)</span>
<span class="term-fg31">-	j := new(big.Int).Mul(h, i)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	s1 := new(big.Int).Mul(y1, z2)</span>
<span class="term-fg31">-	s1.Mul(s1, z2z2)</span>
<span class="term-fg31">-	s1.Mod(s1, bitCurve.P)</span>
<span class="term-fg31">-	s2 := new(big.Int).Mul(y2, z1)</span>
<span class="term-fg31">-	s2.Mul(s2, z1z1)</span>
<span class="term-fg31">-	s2.Mod(s2, bitCurve.P)</span>
<span class="term-fg31">-	r := new(big.Int).Sub(s2, s1)</span>
<span class="term-fg31">-	if r.Sign() == -1 {</span>
<span class="term-fg31">-		r.Add(r, bitCurve.P)</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-	r.Lsh(r, 1)</span>
<span class="term-fg31">-	v := new(big.Int).Mul(u1, i)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	x3 := new(big.Int).Set(r)</span>
<span class="term-fg31">-	x3.Mul(x3, x3)</span>
<span class="term-fg31">-	x3.Sub(x3, j)</span>
<span class="term-fg31">-	x3.Sub(x3, v)</span>
<span class="term-fg31">-	x3.Sub(x3, v)</span>
<span class="term-fg31">-	x3.Mod(x3, bitCurve.P)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	y3 := new(big.Int).Set(r)</span>
<span class="term-fg31">-	v.Sub(v, x3)</span>
<span class="term-fg31">-	y3.Mul(y3, v)</span>
<span class="term-fg31">-	s1.Mul(s1, j)</span>
<span class="term-fg31">-	s1.Lsh(s1, 1)</span>
<span class="term-fg31">-	y3.Sub(y3, s1)</span>
<span class="term-fg31">-	y3.Mod(y3, bitCurve.P)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	z3 := new(big.Int).Add(z1, z2)</span>
<span class="term-fg31">-	z3.Mul(z3, z3)</span>
<span class="term-fg31">-	z3.Sub(z3, z1z1)</span>
<span class="term-fg31">-	if z3.Sign() == -1 {</span>
<span class="term-fg31">-		z3.Add(z3, bitCurve.P)</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-	z3.Sub(z3, z2z2)</span>
<span class="term-fg31">-	if z3.Sign() == -1 {</span>
<span class="term-fg31">-		z3.Add(z3, bitCurve.P)</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-	z3.Mul(z3, h)</span>
<span class="term-fg31">-	z3.Mod(z3, bitCurve.P)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	return x3, y3, z3</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;&#47; Double returns 2*(x,y)</span>
<span class="term-fg31">-func (bitCurve *BitCurve) Double(x1, y1 *big.Int) (*big.Int, *big.Int) {</span>
<span class="term-fg31">-	z1 := new(big.Int).SetInt64(1)</span>
<span class="term-fg31">-	return bitCurve.affineFromJacobian(bitCurve.doubleJacobian(x1, y1, z1))</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;&#47; doubleJacobian takes a point in Jacobian coordinates, (x, y, z), and</span>
<span class="term-fg31">-&#47;&#47; returns its double, also in Jacobian form.</span>
<span class="term-fg31">-func (bitCurve *BitCurve) doubleJacobian(x, y, z *big.Int) (*big.Int, *big.Int, *big.Int) {</span>
<span class="term-fg31">-	&#47;&#47; See http:&#47;&#47;hyperelliptic.org&#47;EFD&#47;g1p&#47;auto-shortw-jacobian-0.html#doubling-dbl-2009-l</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	a := new(big.Int).Mul(x, x) &#47;&#47;X1</span>
<span class="term-fg31">-	b := new(big.Int).Mul(y, y) &#47;&#47;Y1</span>
<span class="term-fg31">-	c := new(big.Int).Mul(b, b) &#47;&#47;B</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	d := new(big.Int).Add(x, b) &#47;&#47;X1+B</span>
<span class="term-fg31">-	d.Mul(d, d)                 &#47;&#47;(X1+B)</span>
<span class="term-fg31">-	d.Sub(d, a)                 &#47;&#47;(X1+B)-A</span>
<span class="term-fg31">-	d.Sub(d, c)                 &#47;&#47;(X1+B)-A-C</span>
<span class="term-fg31">-	d.Mul(d, big.NewInt(2))     &#47;&#47;2*((X1+B)-A-C)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	e := new(big.Int).Mul(big.NewInt(3), a) &#47;&#47;3*A</span>
<span class="term-fg31">-	f := new(big.Int).Mul(e, e)             &#47;&#47;E</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	x3 := new(big.Int).Mul(big.NewInt(2), d) &#47;&#47;2*D</span>
<span class="term-fg31">-	x3.Sub(f, x3)                            &#47;&#47;F-2*D</span>
<span class="term-fg31">-	x3.Mod(x3, bitCurve.P)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	y3 := new(big.Int).Sub(d, x3)                  &#47;&#47;D-X3</span>
<span class="term-fg31">-	y3.Mul(e, y3)                                  &#47;&#47;E*(D-X3)</span>
<span class="term-fg31">-	y3.Sub(y3, new(big.Int).Mul(big.NewInt(8), c)) &#47;&#47;E*(D-X3)-8*C</span>
<span class="term-fg31">-	y3.Mod(y3, bitCurve.P)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	z3 := new(big.Int).Mul(y, z) &#47;&#47;Y1*Z1</span>
<span class="term-fg31">-	z3.Mul(big.NewInt(2), z3)    &#47;&#47;3*Y1*Z1</span>
<span class="term-fg31">-	z3.Mod(z3, bitCurve.P)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	return x3, y3, z3</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;&#47; ScalarBaseMult returns k*G, where G is the base point of the group and k is</span>
<span class="term-fg31">-&#47;&#47; an integer in big-endian form.</span>
<span class="term-fg31">-func (bitCurve *BitCurve) ScalarBaseMult(k []byte) (*big.Int, *big.Int) {</span>
<span class="term-fg31">-	return bitCurve.ScalarMult(bitCurve.Gx, bitCurve.Gy, k)</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;&#47; Marshal converts a point into the form specified in section 4.3.6 of ANSI</span>
<span class="term-fg31">-&#47;&#47; X9.62.</span>
<span class="term-fg31">-func (bitCurve *BitCurve) Marshal(x, y *big.Int) []byte {</span>
<span class="term-fg31">-	byteLen := (bitCurve.BitSize + 7) &gt;&gt; 3</span>
<span class="term-fg31">-	ret := make([]byte, 1+2*byteLen)</span>
<span class="term-fg31">-	ret[0] = 4 &#47;&#47; uncompressed point flag</span>
<span class="term-fg31">-	readBits(x, ret[1:1+byteLen])</span>
<span class="term-fg31">-	readBits(y, ret[1+byteLen:])</span>
<span class="term-fg31">-	return ret</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;&#47; Unmarshal converts a point, serialised by Marshal, into an x, y pair. On</span>
<span class="term-fg31">-&#47;&#47; error, x = nil.</span>
<span class="term-fg31">-func (bitCurve *BitCurve) Unmarshal(data []byte) (x, y *big.Int) {</span>
<span class="term-fg31">-	byteLen := (bitCurve.BitSize + 7) &gt;&gt; 3</span>
<span class="term-fg31">-	if len(data) != 1+2*byteLen {</span>
<span class="term-fg31">-		return</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-	if data[0] != 4 { &#47;&#47; uncompressed form</span>
<span class="term-fg31">-		return</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-	x = new(big.Int).SetBytes(data[1 : 1+byteLen])</span>
<span class="term-fg31">-	y = new(big.Int).SetBytes(data[1+byteLen:])</span>
<span class="term-fg31">-	return</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-var theCurve = new(BitCurve)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-func init() {</span>
<span class="term-fg31">-	&#47;&#47; See SEC 2 section 2.7.1</span>
<span class="term-fg31">-	&#47;&#47; curve parameters taken from:</span>
<span class="term-fg31">-	&#47;&#47; http:&#47;&#47;www.secg.org&#47;sec2-v2.pdf</span>
<span class="term-fg31">-	theCurve.P, _ = new(big.Int).SetString(&quot;0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F&quot;, 0)</span>
<span class="term-fg31">-	theCurve.N, _ = new(big.Int).SetString(&quot;0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141&quot;, 0)</span>
<span class="term-fg31">-	theCurve.B, _ = new(big.Int).SetString(&quot;0x0000000000000000000000000000000000000000000000000000000000000007&quot;, 0)</span>
<span class="term-fg31">-	theCurve.Gx, _ = new(big.Int).SetString(&quot;0x79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798&quot;, 0)</span>
<span class="term-fg31">-	theCurve.Gy, _ = new(big.Int).SetString(&quot;0x483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8&quot;, 0)</span>
<span class="term-fg31">-	theCurve.BitSize = 256</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;&#47; S256 returns a BitCurve which implements secp256k1.</span>
<span class="term-fg31">-func S256() *BitCurve {</span>
<span class="term-fg31">-	return theCurve</span>
<span class="term-fg31">-}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-470e34c82adec0084c089a7e" role="button"
                       aria-expanded="false" aria-controls="id-470e34c82adec0084c089a7e">
                        <code>crypto/secp256k1/dummy.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/dummy.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-21</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-470e34c82adec0084c089a7e"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;dummy.go op-geth&#47;crypto&#47;secp256k1&#47;dummy.go</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 65a75080f60a01f8b2c95da98f7a3b397debc4d7..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;dummy.go</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,21 +0,0 @@</span>
<span class="term-fg31">-&#47;&#47;go:build dummy</span>
<span class="term-fg31">-&#47;&#47; +build dummy</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;&#47; This file is part of a workaround for `go mod vendor` which won&#39;t vendor</span>
<span class="term-fg31">-&#47;&#47; C files if there&#39;s no Go file in the same directory.</span>
<span class="term-fg31">-&#47;&#47; This would prevent the crypto&#47;secp256k1&#47;libsecp256k1&#47;include&#47;secp256k1.h file to be vendored.</span>
<span class="term-fg31">-&#47;&#47;</span>
<span class="term-fg31">-&#47;&#47; This Go file imports the c directory where there is another dummy.go file which</span>
<span class="term-fg31">-&#47;&#47; is the second part of this workaround.</span>
<span class="term-fg31">-&#47;&#47;</span>
<span class="term-fg31">-&#47;&#47; These two files combined make it so `go mod vendor` behaves correctly.</span>
<span class="term-fg31">-&#47;&#47;</span>
<span class="term-fg31">-&#47;&#47; See this issue for reference: https:&#47;&#47;github.com&#47;golang&#47;go&#47;issues&#47;26366</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-package secp256k1</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-import (</span>
<span class="term-fg31">-	_ &quot;github.com&#47;ethereum&#47;go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;include&quot;</span>
<span class="term-fg31">-	_ &quot;github.com&#47;ethereum&#47;go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&quot;</span>
<span class="term-fg31">-	_ &quot;github.com&#47;ethereum&#47;go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;modules&#47;recovery&quot;</span>
<span class="term-fg31">-)</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-1a8e2b0542288719b858da79" role="button"
                       aria-expanded="false" aria-controls="id-1a8e2b0542288719b858da79">
                        <code>crypto/secp256k1/ext.h</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/ext.h" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-130</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-1a8e2b0542288719b858da79"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;ext.h op-geth&#47;crypto&#47;secp256k1&#47;ext.h</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index e422fe4b496d29fedaffc352d25669d53803c1c8..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;ext.h</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,130 +0,0 @@</span>
<span class="term-fg31">-&#47;&#47; Copyright 2015 Jeffrey Wilcke, Felix Lange, Gustav Simonsson. All rights reserved.</span>
<span class="term-fg31">-&#47;&#47; Use of this source code is governed by a BSD-style license that can be found in</span>
<span class="term-fg31">-&#47;&#47; the LICENSE file.</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;&#47; secp256k1_context_create_sign_verify creates a context for signing and signature verification.</span>
<span class="term-fg31">-static secp256k1_context* secp256k1_context_create_sign_verify() {</span>
<span class="term-fg31">-	return secp256k1_context_create(SECP256K1_CONTEXT_SIGN | SECP256K1_CONTEXT_VERIFY);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;&#47; secp256k1_ext_ecdsa_recover recovers the public key of an encoded compact signature.</span>
<span class="term-fg31">-&#47;&#47;</span>
<span class="term-fg31">-&#47;&#47; Returns: 1: recovery was successful</span>
<span class="term-fg31">-&#47;&#47;          0: recovery was not successful</span>
<span class="term-fg31">-&#47;&#47; Args:    ctx:        pointer to a context object (cannot be NULL)</span>
<span class="term-fg31">-&#47;&#47;  Out:    pubkey_out: the serialized 65-byte public key of the signer (cannot be NULL)</span>
<span class="term-fg31">-&#47;&#47;  In:     sigdata:    pointer to a 65-byte signature with the recovery id at the end (cannot be NULL)</span>
<span class="term-fg31">-&#47;&#47;          msgdata:    pointer to a 32-byte message (cannot be NULL)</span>
<span class="term-fg31">-static int secp256k1_ext_ecdsa_recover(</span>
<span class="term-fg31">-	const secp256k1_context* ctx,</span>
<span class="term-fg31">-	unsigned char *pubkey_out,</span>
<span class="term-fg31">-	const unsigned char *sigdata,</span>
<span class="term-fg31">-	const unsigned char *msgdata</span>
<span class="term-fg31">-) {</span>
<span class="term-fg31">-	secp256k1_ecdsa_recoverable_signature sig;</span>
<span class="term-fg31">-	secp256k1_pubkey pubkey;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	if (!secp256k1_ecdsa_recoverable_signature_parse_compact(ctx, &amp;sig, sigdata, (int)sigdata[64])) {</span>
<span class="term-fg31">-		return 0;</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-	if (!secp256k1_ecdsa_recover(ctx, &amp;pubkey, &amp;sig, msgdata)) {</span>
<span class="term-fg31">-		return 0;</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-	size_t outputlen = 65;</span>
<span class="term-fg31">-	return secp256k1_ec_pubkey_serialize(ctx, pubkey_out, &amp;outputlen, &amp;pubkey, SECP256K1_EC_UNCOMPRESSED);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;&#47; secp256k1_ext_ecdsa_verify verifies an encoded compact signature.</span>
<span class="term-fg31">-&#47;&#47;</span>
<span class="term-fg31">-&#47;&#47; Returns: 1: signature is valid</span>
<span class="term-fg31">-&#47;&#47;          0: signature is invalid</span>
<span class="term-fg31">-&#47;&#47; Args:    ctx:        pointer to a context object (cannot be NULL)</span>
<span class="term-fg31">-&#47;&#47;  In:     sigdata:    pointer to a 64-byte signature (cannot be NULL)</span>
<span class="term-fg31">-&#47;&#47;          msgdata:    pointer to a 32-byte message (cannot be NULL)</span>
<span class="term-fg31">-&#47;&#47;          pubkeydata: pointer to public key data (cannot be NULL)</span>
<span class="term-fg31">-&#47;&#47;          pubkeylen:  length of pubkeydata</span>
<span class="term-fg31">-static int secp256k1_ext_ecdsa_verify(</span>
<span class="term-fg31">-	const secp256k1_context* ctx,</span>
<span class="term-fg31">-	const unsigned char *sigdata,</span>
<span class="term-fg31">-	const unsigned char *msgdata,</span>
<span class="term-fg31">-	const unsigned char *pubkeydata,</span>
<span class="term-fg31">-	size_t pubkeylen</span>
<span class="term-fg31">-) {</span>
<span class="term-fg31">-	secp256k1_ecdsa_signature sig;</span>
<span class="term-fg31">-	secp256k1_pubkey pubkey;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	if (!secp256k1_ecdsa_signature_parse_compact(ctx, &amp;sig, sigdata)) {</span>
<span class="term-fg31">-		return 0;</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-	if (!secp256k1_ec_pubkey_parse(ctx, &amp;pubkey, pubkeydata, pubkeylen)) {</span>
<span class="term-fg31">-		return 0;</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-	return secp256k1_ecdsa_verify(ctx, &amp;sig, msgdata, &amp;pubkey);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;&#47; secp256k1_ext_reencode_pubkey decodes then encodes a public key. It can be used to</span>
<span class="term-fg31">-&#47;&#47; convert between public key formats. The input&#47;output formats are chosen depending on the</span>
<span class="term-fg31">-&#47;&#47; length of the input&#47;output buffers.</span>
<span class="term-fg31">-&#47;&#47;</span>
<span class="term-fg31">-&#47;&#47; Returns: 1: conversion successful</span>
<span class="term-fg31">-&#47;&#47;          0: conversion unsuccessful</span>
<span class="term-fg31">-&#47;&#47; Args:    ctx:        pointer to a context object (cannot be NULL)</span>
<span class="term-fg31">-&#47;&#47;  Out:    out:        output buffer that will contain the reencoded key (cannot be NULL)</span>
<span class="term-fg31">-&#47;&#47;  In:     outlen:     length of out (33 for compressed keys, 65 for uncompressed keys)</span>
<span class="term-fg31">-&#47;&#47;          pubkeydata: the input public key (cannot be NULL)</span>
<span class="term-fg31">-&#47;&#47;          pubkeylen:  length of pubkeydata</span>
<span class="term-fg31">-static int secp256k1_ext_reencode_pubkey(</span>
<span class="term-fg31">-	const secp256k1_context* ctx,</span>
<span class="term-fg31">-	unsigned char *out,</span>
<span class="term-fg31">-	size_t outlen,</span>
<span class="term-fg31">-	const unsigned char *pubkeydata,</span>
<span class="term-fg31">-	size_t pubkeylen</span>
<span class="term-fg31">-) {</span>
<span class="term-fg31">-	secp256k1_pubkey pubkey;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	if (!secp256k1_ec_pubkey_parse(ctx, &amp;pubkey, pubkeydata, pubkeylen)) {</span>
<span class="term-fg31">-		return 0;</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-	unsigned int flag = (outlen == 33) ? SECP256K1_EC_COMPRESSED : SECP256K1_EC_UNCOMPRESSED;</span>
<span class="term-fg31">-	return secp256k1_ec_pubkey_serialize(ctx, out, &amp;outlen, &amp;pubkey, flag);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;&#47; secp256k1_ext_scalar_mul multiplies a point by a scalar in constant time.</span>
<span class="term-fg31">-&#47;&#47;</span>
<span class="term-fg31">-&#47;&#47; Returns: 1: multiplication was successful</span>
<span class="term-fg31">-&#47;&#47;          0: scalar was invalid (zero or overflow)</span>
<span class="term-fg31">-&#47;&#47; Args:    ctx:      pointer to a context object (cannot be NULL)</span>
<span class="term-fg31">-&#47;&#47;  Out:    point:    the multiplied point (usually secret)</span>
<span class="term-fg31">-&#47;&#47;  In:     point:    pointer to a 64-byte public point,</span>
<span class="term-fg31">-&#47;&#47;                    encoded as two 256bit big-endian numbers.</span>
<span class="term-fg31">-&#47;&#47;          scalar:   a 32-byte scalar with which to multiply the point</span>
<span class="term-fg31">-int secp256k1_ext_scalar_mul(const secp256k1_context* ctx, unsigned char *point, const unsigned char *scalar) {</span>
<span class="term-fg31">-	int ret = 0;</span>
<span class="term-fg31">-	int overflow = 0;</span>
<span class="term-fg31">-	secp256k1_fe feX, feY;</span>
<span class="term-fg31">-	secp256k1_gej res;</span>
<span class="term-fg31">-	secp256k1_ge ge;</span>
<span class="term-fg31">-	secp256k1_scalar s;</span>
<span class="term-fg31">-	ARG_CHECK(point != NULL);</span>
<span class="term-fg31">-	ARG_CHECK(scalar != NULL);</span>
<span class="term-fg31">-	(void)ctx;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	secp256k1_fe_set_b32(&amp;feX, point);</span>
<span class="term-fg31">-	secp256k1_fe_set_b32(&amp;feY, point+32);</span>
<span class="term-fg31">-	secp256k1_ge_set_xy(&amp;ge, &amp;feX, &amp;feY);</span>
<span class="term-fg31">-	secp256k1_scalar_set_b32(&amp;s, scalar, &amp;overflow);</span>
<span class="term-fg31">-	if (overflow || secp256k1_scalar_is_zero(&amp;s)) {</span>
<span class="term-fg31">-		ret = 0;</span>
<span class="term-fg31">-	} else {</span>
<span class="term-fg31">-		secp256k1_ecmult_const(&amp;res, &amp;ge, &amp;s);</span>
<span class="term-fg31">-		secp256k1_ge_set_gej(&amp;ge, &amp;res);</span>
<span class="term-fg31">-		&#47;* Note: can&#39;t use secp256k1_pubkey_save here because it is not constant time. *&#47;</span>
<span class="term-fg31">-		secp256k1_fe_normalize(&amp;ge.x);</span>
<span class="term-fg31">-		secp256k1_fe_normalize(&amp;ge.y);</span>
<span class="term-fg31">-		secp256k1_fe_get_b32(point, &amp;ge.x);</span>
<span class="term-fg31">-		secp256k1_fe_get_b32(point+32, &amp;ge.y);</span>
<span class="term-fg31">-		ret = 1;</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-	secp256k1_scalar_clear(&amp;s);</span>
<span class="term-fg31">-	return ret;</span>
<span class="term-fg31">-}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-68e12d711b22093278f4ff8a" role="button"
                       aria-expanded="false" aria-controls="id-68e12d711b22093278f4ff8a">
                        <code>crypto/secp256k1/libsecp256k1/.gitignore</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/.gitignore" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-49</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-68e12d711b22093278f4ff8a"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;.gitignore op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;.gitignore</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 87fea161ba5aea04756cb378d487b703bb2e2ab2..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;.gitignore</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,49 +0,0 @@</span>
<span class="term-fg31">-bench_inv</span>
<span class="term-fg31">-bench_ecdh</span>
<span class="term-fg31">-bench_sign</span>
<span class="term-fg31">-bench_verify</span>
<span class="term-fg31">-bench_schnorr_verify</span>
<span class="term-fg31">-bench_recover</span>
<span class="term-fg31">-bench_internal</span>
<span class="term-fg31">-tests</span>
<span class="term-fg31">-exhaustive_tests</span>
<span class="term-fg31">-gen_context</span>
<span class="term-fg31">-*.exe</span>
<span class="term-fg31">-*.so</span>
<span class="term-fg31">-*.a</span>
<span class="term-fg31">-!.gitignore</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-Makefile</span>
<span class="term-fg31">-configure</span>
<span class="term-fg31">-.libs&#47;</span>
<span class="term-fg31">-Makefile.in</span>
<span class="term-fg31">-aclocal.m4</span>
<span class="term-fg31">-autom4te.cache&#47;</span>
<span class="term-fg31">-config.log</span>
<span class="term-fg31">-config.status</span>
<span class="term-fg31">-*.tar.gz</span>
<span class="term-fg31">-*.la</span>
<span class="term-fg31">-libtool</span>
<span class="term-fg31">-.deps&#47;</span>
<span class="term-fg31">-.dirstamp</span>
<span class="term-fg31">-*.lo</span>
<span class="term-fg31">-*.o</span>
<span class="term-fg31">-*~</span>
<span class="term-fg31">-src&#47;libsecp256k1-config.h</span>
<span class="term-fg31">-src&#47;libsecp256k1-config.h.in</span>
<span class="term-fg31">-src&#47;ecmult_static_context.h</span>
<span class="term-fg31">-build-aux&#47;config.guess</span>
<span class="term-fg31">-build-aux&#47;config.sub</span>
<span class="term-fg31">-build-aux&#47;depcomp</span>
<span class="term-fg31">-build-aux&#47;install-sh</span>
<span class="term-fg31">-build-aux&#47;ltmain.sh</span>
<span class="term-fg31">-build-aux&#47;m4&#47;libtool.m4</span>
<span class="term-fg31">-build-aux&#47;m4&#47;lt~obsolete.m4</span>
<span class="term-fg31">-build-aux&#47;m4&#47;ltoptions.m4</span>
<span class="term-fg31">-build-aux&#47;m4&#47;ltsugar.m4</span>
<span class="term-fg31">-build-aux&#47;m4&#47;ltversion.m4</span>
<span class="term-fg31">-build-aux&#47;missing</span>
<span class="term-fg31">-build-aux&#47;compile</span>
<span class="term-fg31">-build-aux&#47;test-driver</span>
<span class="term-fg31">-src&#47;stamp-h1</span>
<span class="term-fg31">-libsecp256k1.pc</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-e80522992e17722fc44c4e49" role="button"
                       aria-expanded="false" aria-controls="id-e80522992e17722fc44c4e49">
                        <code>crypto/secp256k1/libsecp256k1/.travis.yml</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/.travis.yml" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-69</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-e80522992e17722fc44c4e49"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;.travis.yml op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;.travis.yml</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 24395292426d697856f34b0b0d6c8f26d81d6856..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;.travis.yml</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,69 +0,0 @@</span>
<span class="term-fg31">-language: c</span>
<span class="term-fg31">-sudo: false</span>
<span class="term-fg31">-addons:</span>
<span class="term-fg31">-  apt:</span>
<span class="term-fg31">-    packages: libgmp-dev</span>
<span class="term-fg31">-compiler:</span>
<span class="term-fg31">-  - clang</span>
<span class="term-fg31">-  - gcc</span>
<span class="term-fg31">-cache:</span>
<span class="term-fg31">-  directories:</span>
<span class="term-fg31">-  - src&#47;java&#47;guava&#47;</span>
<span class="term-fg31">-env:</span>
<span class="term-fg31">-  global:</span>
<span class="term-fg31">-    - FIELD=auto  BIGNUM=auto  SCALAR=auto  ENDOMORPHISM=no  STATICPRECOMPUTATION=yes  ASM=no  BUILD=check  EXTRAFLAGS=  HOST=  ECDH=no  RECOVERY=no  EXPERIMENTAL=no</span>
<span class="term-fg31">-    - GUAVA_URL=https:&#47;&#47;search.maven.org&#47;remotecontent?filepath=com&#47;google&#47;guava&#47;guava&#47;18.0&#47;guava-18.0.jar GUAVA_JAR=src&#47;java&#47;guava&#47;guava-18.0.jar</span>
<span class="term-fg31">-  matrix:</span>
<span class="term-fg31">-    - SCALAR=32bit    RECOVERY=yes</span>
<span class="term-fg31">-    - SCALAR=32bit    FIELD=32bit       ECDH=yes  EXPERIMENTAL=yes</span>
<span class="term-fg31">-    - SCALAR=64bit</span>
<span class="term-fg31">-    - FIELD=64bit     RECOVERY=yes</span>
<span class="term-fg31">-    - FIELD=64bit     ENDOMORPHISM=yes</span>
<span class="term-fg31">-    - FIELD=64bit     ENDOMORPHISM=yes  ECDH=yes EXPERIMENTAL=yes</span>
<span class="term-fg31">-    - FIELD=64bit                       ASM=x86_64</span>
<span class="term-fg31">-    - FIELD=64bit     ENDOMORPHISM=yes  ASM=x86_64</span>
<span class="term-fg31">-    - FIELD=32bit     ENDOMORPHISM=yes</span>
<span class="term-fg31">-    - BIGNUM=no</span>
<span class="term-fg31">-    - BIGNUM=no       ENDOMORPHISM=yes RECOVERY=yes EXPERIMENTAL=yes</span>
<span class="term-fg31">-    - BIGNUM=no       STATICPRECOMPUTATION=no</span>
<span class="term-fg31">-    - BUILD=distcheck</span>
<span class="term-fg31">-    - EXTRAFLAGS=CPPFLAGS=-DDETERMINISTIC</span>
<span class="term-fg31">-    - EXTRAFLAGS=CFLAGS=-O0</span>
<span class="term-fg31">-    - BUILD=check-java ECDH=yes EXPERIMENTAL=yes</span>
<span class="term-fg31">-matrix:</span>
<span class="term-fg31">-  fast_finish: true</span>
<span class="term-fg31">-  include:</span>
<span class="term-fg31">-    - compiler: clang</span>
<span class="term-fg31">-      env: HOST=i686-linux-gnu ENDOMORPHISM=yes</span>
<span class="term-fg31">-      addons:</span>
<span class="term-fg31">-        apt:</span>
<span class="term-fg31">-          packages:</span>
<span class="term-fg31">-            - gcc-multilib</span>
<span class="term-fg31">-            - libgmp-dev:i386</span>
<span class="term-fg31">-    - compiler: clang</span>
<span class="term-fg31">-      env: HOST=i686-linux-gnu</span>
<span class="term-fg31">-      addons:</span>
<span class="term-fg31">-        apt:</span>
<span class="term-fg31">-          packages:</span>
<span class="term-fg31">-            - gcc-multilib</span>
<span class="term-fg31">-    - compiler: gcc</span>
<span class="term-fg31">-      env: HOST=i686-linux-gnu ENDOMORPHISM=yes</span>
<span class="term-fg31">-      addons:</span>
<span class="term-fg31">-        apt:</span>
<span class="term-fg31">-          packages:</span>
<span class="term-fg31">-            - gcc-multilib</span>
<span class="term-fg31">-    - compiler: gcc</span>
<span class="term-fg31">-      env: HOST=i686-linux-gnu</span>
<span class="term-fg31">-      addons:</span>
<span class="term-fg31">-        apt:</span>
<span class="term-fg31">-          packages:</span>
<span class="term-fg31">-            - gcc-multilib</span>
<span class="term-fg31">-            - libgmp-dev:i386</span>
<span class="term-fg31">-before_install: mkdir -p `dirname $GUAVA_JAR`</span>
<span class="term-fg31">-install: if [ ! -f $GUAVA_JAR ]; then wget $GUAVA_URL -O $GUAVA_JAR; fi</span>
<span class="term-fg31">-before_script: .&#47;autogen.sh</span>
<span class="term-fg31">-script:</span>
<span class="term-fg31">- - if [ -n &quot;$HOST&quot; ]; then export USE_HOST=&quot;--host=$HOST&quot;; fi</span>
<span class="term-fg31">- - if [ &quot;x$HOST&quot; = &quot;xi686-linux-gnu&quot; ]; then export CC=&quot;$CC -m32&quot;; fi</span>
<span class="term-fg31">- - .&#47;configure --enable-experimental=$EXPERIMENTAL --enable-endomorphism=$ENDOMORPHISM --with-field=$FIELD --with-bignum=$BIGNUM --with-scalar=$SCALAR --enable-ecmult-static-precomputation=$STATICPRECOMPUTATION --enable-module-ecdh=$ECDH --enable-module-recovery=$RECOVERY $EXTRAFLAGS $USE_HOST &amp;&amp; make -j2 $BUILD</span>
<span class="term-fg31">-os: linux</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-51bd4bb0333cb096e658961c" role="button"
                       aria-expanded="false" aria-controls="id-51bd4bb0333cb096e658961c">
                        <code>crypto/secp256k1/libsecp256k1/COPYING</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/COPYING" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-19</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-51bd4bb0333cb096e658961c"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;COPYING op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;COPYING</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 4522a5990e2823f2be0db7efcbc4fca139c08025..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;COPYING</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,19 +0,0 @@</span>
<span class="term-fg31">-Copyright (c) 2013 Pieter Wuille</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-Permission is hereby granted, free of charge, to any person obtaining a copy</span>
<span class="term-fg31">-of this software and associated documentation files (the &quot;Software&quot;), to deal</span>
<span class="term-fg31">-in the Software without restriction, including without limitation the rights</span>
<span class="term-fg31">-to use, copy, modify, merge, publish, distribute, sublicense, and&#47;or sell</span>
<span class="term-fg31">-copies of the Software, and to permit persons to whom the Software is</span>
<span class="term-fg31">-furnished to do so, subject to the following conditions:</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-The above copyright notice and this permission notice shall be included in</span>
<span class="term-fg31">-all copies or substantial portions of the Software.</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span>
<span class="term-fg31">-IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span>
<span class="term-fg31">-FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</span>
<span class="term-fg31">-AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span>
<span class="term-fg31">-LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,</span>
<span class="term-fg31">-OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN</span>
<span class="term-fg31">-THE SOFTWARE.</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-661a2d33842a8d9c65f4cc1c" role="button"
                       aria-expanded="false" aria-controls="id-661a2d33842a8d9c65f4cc1c">
                        <code>crypto/secp256k1/libsecp256k1/Makefile.am</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/Makefile.am" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-177</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-661a2d33842a8d9c65f4cc1c"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;Makefile.am op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;Makefile.am</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index c071fbe2753c9bda4c8d7b74143dc15878572c4b..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;Makefile.am</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,177 +0,0 @@</span>
<span class="term-fg31">-ACLOCAL_AMFLAGS = -I build-aux&#47;m4</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-lib_LTLIBRARIES = libsecp256k1.la</span>
<span class="term-fg31">-if USE_JNI</span>
<span class="term-fg31">-JNI_LIB = libsecp256k1_jni.la</span>
<span class="term-fg31">-noinst_LTLIBRARIES = $(JNI_LIB)</span>
<span class="term-fg31">-else</span>
<span class="term-fg31">-JNI_LIB =</span>
<span class="term-fg31">-endif</span>
<span class="term-fg31">-include_HEADERS = include&#47;secp256k1.h</span>
<span class="term-fg31">-noinst_HEADERS =</span>
<span class="term-fg31">-noinst_HEADERS += src&#47;scalar.h</span>
<span class="term-fg31">-noinst_HEADERS += src&#47;scalar_4x64.h</span>
<span class="term-fg31">-noinst_HEADERS += src&#47;scalar_8x32.h</span>
<span class="term-fg31">-noinst_HEADERS += src&#47;scalar_low.h</span>
<span class="term-fg31">-noinst_HEADERS += src&#47;scalar_impl.h</span>
<span class="term-fg31">-noinst_HEADERS += src&#47;scalar_4x64_impl.h</span>
<span class="term-fg31">-noinst_HEADERS += src&#47;scalar_8x32_impl.h</span>
<span class="term-fg31">-noinst_HEADERS += src&#47;scalar_low_impl.h</span>
<span class="term-fg31">-noinst_HEADERS += src&#47;group.h</span>
<span class="term-fg31">-noinst_HEADERS += src&#47;group_impl.h</span>
<span class="term-fg31">-noinst_HEADERS += src&#47;num_gmp.h</span>
<span class="term-fg31">-noinst_HEADERS += src&#47;num_gmp_impl.h</span>
<span class="term-fg31">-noinst_HEADERS += src&#47;ecdsa.h</span>
<span class="term-fg31">-noinst_HEADERS += src&#47;ecdsa_impl.h</span>
<span class="term-fg31">-noinst_HEADERS += src&#47;eckey.h</span>
<span class="term-fg31">-noinst_HEADERS += src&#47;eckey_impl.h</span>
<span class="term-fg31">-noinst_HEADERS += src&#47;ecmult.h</span>
<span class="term-fg31">-noinst_HEADERS += src&#47;ecmult_impl.h</span>
<span class="term-fg31">-noinst_HEADERS += src&#47;ecmult_const.h</span>
<span class="term-fg31">-noinst_HEADERS += src&#47;ecmult_const_impl.h</span>
<span class="term-fg31">-noinst_HEADERS += src&#47;ecmult_gen.h</span>
<span class="term-fg31">-noinst_HEADERS += src&#47;ecmult_gen_impl.h</span>
<span class="term-fg31">-noinst_HEADERS += src&#47;num.h</span>
<span class="term-fg31">-noinst_HEADERS += src&#47;num_impl.h</span>
<span class="term-fg31">-noinst_HEADERS += src&#47;field_10x26.h</span>
<span class="term-fg31">-noinst_HEADERS += src&#47;field_10x26_impl.h</span>
<span class="term-fg31">-noinst_HEADERS += src&#47;field_5x52.h</span>
<span class="term-fg31">-noinst_HEADERS += src&#47;field_5x52_impl.h</span>
<span class="term-fg31">-noinst_HEADERS += src&#47;field_5x52_int128_impl.h</span>
<span class="term-fg31">-noinst_HEADERS += src&#47;field_5x52_asm_impl.h</span>
<span class="term-fg31">-noinst_HEADERS += src&#47;java&#47;org_bitcoin_NativeSecp256k1.h</span>
<span class="term-fg31">-noinst_HEADERS += src&#47;java&#47;org_bitcoin_Secp256k1Context.h</span>
<span class="term-fg31">-noinst_HEADERS += src&#47;util.h</span>
<span class="term-fg31">-noinst_HEADERS += src&#47;testrand.h</span>
<span class="term-fg31">-noinst_HEADERS += src&#47;testrand_impl.h</span>
<span class="term-fg31">-noinst_HEADERS += src&#47;hash.h</span>
<span class="term-fg31">-noinst_HEADERS += src&#47;hash_impl.h</span>
<span class="term-fg31">-noinst_HEADERS += src&#47;field.h</span>
<span class="term-fg31">-noinst_HEADERS += src&#47;field_impl.h</span>
<span class="term-fg31">-noinst_HEADERS += src&#47;bench.h</span>
<span class="term-fg31">-noinst_HEADERS += contrib&#47;lax_der_parsing.h</span>
<span class="term-fg31">-noinst_HEADERS += contrib&#47;lax_der_parsing.c</span>
<span class="term-fg31">-noinst_HEADERS += contrib&#47;lax_der_privatekey_parsing.h</span>
<span class="term-fg31">-noinst_HEADERS += contrib&#47;lax_der_privatekey_parsing.c</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-if USE_EXTERNAL_ASM</span>
<span class="term-fg31">-COMMON_LIB = libsecp256k1_common.la</span>
<span class="term-fg31">-noinst_LTLIBRARIES = $(COMMON_LIB)</span>
<span class="term-fg31">-else</span>
<span class="term-fg31">-COMMON_LIB =</span>
<span class="term-fg31">-endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-pkgconfigdir = $(libdir)&#47;pkgconfig</span>
<span class="term-fg31">-pkgconfig_DATA = libsecp256k1.pc</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-if USE_EXTERNAL_ASM</span>
<span class="term-fg31">-if USE_ASM_ARM</span>
<span class="term-fg31">-libsecp256k1_common_la_SOURCES = src&#47;asm&#47;field_10x26_arm.s</span>
<span class="term-fg31">-endif</span>
<span class="term-fg31">-endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-libsecp256k1_la_SOURCES = src&#47;secp256k1.c</span>
<span class="term-fg31">-libsecp256k1_la_CPPFLAGS = -DSECP256K1_BUILD -I$(top_srcdir)&#47;include -I$(top_srcdir)&#47;src $(SECP_INCLUDES)</span>
<span class="term-fg31">-libsecp256k1_la_LIBADD = $(JNI_LIB) $(SECP_LIBS) $(COMMON_LIB)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-libsecp256k1_jni_la_SOURCES  = src&#47;java&#47;org_bitcoin_NativeSecp256k1.c src&#47;java&#47;org_bitcoin_Secp256k1Context.c</span>
<span class="term-fg31">-libsecp256k1_jni_la_CPPFLAGS = -DSECP256K1_BUILD $(JNI_INCLUDES)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-noinst_PROGRAMS =</span>
<span class="term-fg31">-if USE_BENCHMARK</span>
<span class="term-fg31">-noinst_PROGRAMS += bench_verify bench_sign bench_internal</span>
<span class="term-fg31">-bench_verify_SOURCES = src&#47;bench_verify.c</span>
<span class="term-fg31">-bench_verify_LDADD = libsecp256k1.la $(SECP_LIBS) $(SECP_TEST_LIBS) $(COMMON_LIB)</span>
<span class="term-fg31">-bench_sign_SOURCES = src&#47;bench_sign.c</span>
<span class="term-fg31">-bench_sign_LDADD = libsecp256k1.la $(SECP_LIBS) $(SECP_TEST_LIBS) $(COMMON_LIB)</span>
<span class="term-fg31">-bench_internal_SOURCES = src&#47;bench_internal.c</span>
<span class="term-fg31">-bench_internal_LDADD = $(SECP_LIBS) $(COMMON_LIB)</span>
<span class="term-fg31">-bench_internal_CPPFLAGS = -DSECP256K1_BUILD $(SECP_INCLUDES)</span>
<span class="term-fg31">-endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-TESTS =</span>
<span class="term-fg31">-if USE_TESTS</span>
<span class="term-fg31">-noinst_PROGRAMS += tests</span>
<span class="term-fg31">-tests_SOURCES = src&#47;tests.c</span>
<span class="term-fg31">-tests_CPPFLAGS = -DSECP256K1_BUILD -I$(top_srcdir)&#47;src -I$(top_srcdir)&#47;include $(SECP_INCLUDES) $(SECP_TEST_INCLUDES)</span>
<span class="term-fg31">-if !ENABLE_COVERAGE</span>
<span class="term-fg31">-tests_CPPFLAGS += -DVERIFY</span>
<span class="term-fg31">-endif</span>
<span class="term-fg31">-tests_LDADD = $(SECP_LIBS) $(SECP_TEST_LIBS) $(COMMON_LIB)</span>
<span class="term-fg31">-tests_LDFLAGS = -static</span>
<span class="term-fg31">-TESTS += tests</span>
<span class="term-fg31">-endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-if USE_EXHAUSTIVE_TESTS</span>
<span class="term-fg31">-noinst_PROGRAMS += exhaustive_tests</span>
<span class="term-fg31">-exhaustive_tests_SOURCES = src&#47;tests_exhaustive.c</span>
<span class="term-fg31">-exhaustive_tests_CPPFLAGS = -DSECP256K1_BUILD -I$(top_srcdir)&#47;src $(SECP_INCLUDES)</span>
<span class="term-fg31">-if !ENABLE_COVERAGE</span>
<span class="term-fg31">-exhaustive_tests_CPPFLAGS += -DVERIFY</span>
<span class="term-fg31">-endif</span>
<span class="term-fg31">-exhaustive_tests_LDADD = $(SECP_LIBS)</span>
<span class="term-fg31">-exhaustive_tests_LDFLAGS = -static</span>
<span class="term-fg31">-TESTS += exhaustive_tests</span>
<span class="term-fg31">-endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-JAVAROOT=src&#47;java</span>
<span class="term-fg31">-JAVAORG=org&#47;bitcoin</span>
<span class="term-fg31">-JAVA_GUAVA=$(srcdir)&#47;$(JAVAROOT)&#47;guava&#47;guava-18.0.jar</span>
<span class="term-fg31">-CLASSPATH_ENV=CLASSPATH=$(JAVA_GUAVA)</span>
<span class="term-fg31">-JAVA_FILES= \</span>
<span class="term-fg31">-  $(JAVAROOT)&#47;$(JAVAORG)&#47;NativeSecp256k1.java \</span>
<span class="term-fg31">-  $(JAVAROOT)&#47;$(JAVAORG)&#47;NativeSecp256k1Test.java \</span>
<span class="term-fg31">-  $(JAVAROOT)&#47;$(JAVAORG)&#47;NativeSecp256k1Util.java \</span>
<span class="term-fg31">-  $(JAVAROOT)&#47;$(JAVAORG)&#47;Secp256k1Context.java</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-if USE_JNI</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-$(JAVA_GUAVA):</span>
<span class="term-fg31">-	@echo Guava is missing. Fetch it via: \</span>
<span class="term-fg31">-	wget https:&#47;&#47;search.maven.org&#47;remotecontent?filepath=com&#47;google&#47;guava&#47;guava&#47;18.0&#47;guava-18.0.jar -O $(@)</span>
<span class="term-fg31">-	@false</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-.stamp-java: $(JAVA_FILES)</span>
<span class="term-fg31">-	@echo   Compiling $^</span>
<span class="term-fg31">-	$(AM_V_at)$(CLASSPATH_ENV) javac $^</span>
<span class="term-fg31">-	@touch $@</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-if USE_TESTS</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-check-java: libsecp256k1.la $(JAVA_GUAVA) .stamp-java</span>
<span class="term-fg31">-	$(AM_V_at)java -Djava.library.path=&quot;.&#47;:.&#47;src:.&#47;src&#47;.libs:.libs&#47;&quot; -cp &quot;$(JAVA_GUAVA):$(JAVAROOT)&quot; $(JAVAORG)&#47;NativeSecp256k1Test</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-endif</span>
<span class="term-fg31">-endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-if USE_ECMULT_STATIC_PRECOMPUTATION</span>
<span class="term-fg31">-CPPFLAGS_FOR_BUILD +=-I$(top_srcdir)</span>
<span class="term-fg31">-CFLAGS_FOR_BUILD += -Wall -Wextra -Wno-unused-function</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-gen_context_OBJECTS = gen_context.o</span>
<span class="term-fg31">-gen_context_BIN = gen_context$(BUILD_EXEEXT)</span>
<span class="term-fg31">-gen_%.o: src&#47;gen_%.c</span>
<span class="term-fg31">-	$(CC_FOR_BUILD) $(CPPFLAGS_FOR_BUILD) $(CFLAGS_FOR_BUILD) -c $&lt; -o $@</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-$(gen_context_BIN): $(gen_context_OBJECTS)</span>
<span class="term-fg31">-	$(CC_FOR_BUILD) $^ -o $@</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-$(libsecp256k1_la_OBJECTS): src&#47;ecmult_static_context.h</span>
<span class="term-fg31">-$(tests_OBJECTS): src&#47;ecmult_static_context.h</span>
<span class="term-fg31">-$(bench_internal_OBJECTS): src&#47;ecmult_static_context.h</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-src&#47;ecmult_static_context.h: $(gen_context_BIN)</span>
<span class="term-fg31">-	.&#47;$(gen_context_BIN)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-CLEANFILES = $(gen_context_BIN) src&#47;ecmult_static_context.h $(JAVAROOT)&#47;$(JAVAORG)&#47;*.class .stamp-java</span>
<span class="term-fg31">-endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-EXTRA_DIST = autogen.sh src&#47;gen_context.c src&#47;basic-config.h $(JAVA_FILES)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-if ENABLE_MODULE_ECDH</span>
<span class="term-fg31">-include src&#47;modules&#47;ecdh&#47;Makefile.am.include</span>
<span class="term-fg31">-endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-if ENABLE_MODULE_RECOVERY</span>
<span class="term-fg31">-include src&#47;modules&#47;recovery&#47;Makefile.am.include</span>
<span class="term-fg31">-endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-184a225b0977d41d8fa0524b" role="button"
                       aria-expanded="false" aria-controls="id-184a225b0977d41d8fa0524b">
                        <code>crypto/secp256k1/libsecp256k1/README.md</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/README.md" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-61</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-184a225b0977d41d8fa0524b"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;README.md op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;README.md</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 8cd344ea81232413cf9004bc50dec4ec2fe112a6..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;README.md</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,61 +0,0 @@</span>
<span class="term-fg31">-libsecp256k1</span>
<span class="term-fg31">-============</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-[![Build Status](https:&#47;&#47;travis-ci.org&#47;bitcoin-core&#47;secp256k1.svg?branch=master)](https:&#47;&#47;travis-ci.org&#47;bitcoin-core&#47;secp256k1)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-Optimized C library for EC operations on curve secp256k1.</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-This library is a work in progress and is being used to research best practices. Use at your own risk.</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-Features:</span>
<span class="term-fg31">-* secp256k1 ECDSA signing&#47;verification and key generation.</span>
<span class="term-fg31">-* Adding&#47;multiplying private&#47;public keys.</span>
<span class="term-fg31">-* Serialization&#47;parsing of private keys, public keys, signatures.</span>
<span class="term-fg31">-* Constant time, constant memory access signing and pubkey generation.</span>
<span class="term-fg31">-* Derandomized DSA (via RFC6979 or with a caller provided function.)</span>
<span class="term-fg31">-* Very efficient implementation.</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-Implementation details</span>
<span class="term-fg31">-----------------------</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-* General</span>
<span class="term-fg31">-  * No runtime heap allocation.</span>
<span class="term-fg31">-  * Extensive testing infrastructure.</span>
<span class="term-fg31">-  * Structured to facilitate review and analysis.</span>
<span class="term-fg31">-  * Intended to be portable to any system with a C89 compiler and uint64_t support.</span>
<span class="term-fg31">-  * Expose only higher level interfaces to minimize the API surface and improve application security. (&quot;Be difficult to use insecurely.&quot;)</span>
<span class="term-fg31">-* Field operations</span>
<span class="term-fg31">-  * Optimized implementation of arithmetic modulo the curve&#39;s field size (2^256 - 0x1000003D1).</span>
<span class="term-fg31">-    * Using 5 52-bit limbs (including hand-optimized assembly for x86_64, by Diederik Huys).</span>
<span class="term-fg31">-    * Using 10 26-bit limbs.</span>
<span class="term-fg31">-  * Field inverses and square roots using a sliding window over blocks of 1s (by Peter Dettman).</span>
<span class="term-fg31">-* Scalar operations</span>
<span class="term-fg31">-  * Optimized implementation without data-dependent branches of arithmetic modulo the curve&#39;s order.</span>
<span class="term-fg31">-    * Using 4 64-bit limbs (relying on __int128 support in the compiler).</span>
<span class="term-fg31">-    * Using 8 32-bit limbs.</span>
<span class="term-fg31">-* Group operations</span>
<span class="term-fg31">-  * Point addition formula specifically simplified for the curve equation (y^2 = x^3 + 7).</span>
<span class="term-fg31">-  * Use addition between points in Jacobian and affine coordinates where possible.</span>
<span class="term-fg31">-  * Use a unified addition&#47;doubling formula where necessary to avoid data-dependent branches.</span>
<span class="term-fg31">-  * Point&#47;x comparison without a field inversion by comparison in the Jacobian coordinate space.</span>
<span class="term-fg31">-* Point multiplication for verification (a*P + b*G).</span>
<span class="term-fg31">-  * Use wNAF notation for point multiplicands.</span>
<span class="term-fg31">-  * Use a much larger window for multiples of G, using precomputed multiples.</span>
<span class="term-fg31">-  * Use Shamir&#39;s trick to do the multiplication with the public key and the generator simultaneously.</span>
<span class="term-fg31">-  * Optionally (off by default) use secp256k1&#39;s efficiently-computable endomorphism to split the P multiplicand into 2 half-sized ones.</span>
<span class="term-fg31">-* Point multiplication for signing</span>
<span class="term-fg31">-  * Use a precomputed table of multiples of powers of 16 multiplied with the generator, so general multiplication becomes a series of additions.</span>
<span class="term-fg31">-  * Access the table with branch-free conditional moves so memory access is uniform.</span>
<span class="term-fg31">-  * No data-dependent branches</span>
<span class="term-fg31">-  * The precomputed tables add and eventually subtract points for which no known scalar (private key) is known, preventing even an attacker with control over the private key used to control the data internally.</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-Build steps</span>
<span class="term-fg31">------------</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-libsecp256k1 is built using autotools:</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    $ .&#47;autogen.sh</span>
<span class="term-fg31">-    $ .&#47;configure</span>
<span class="term-fg31">-    $ make</span>
<span class="term-fg31">-    $ .&#47;tests</span>
<span class="term-fg31">-    $ sudo make install  # optional</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-b42ba471a8c6901790ec0bc4" role="button"
                       aria-expanded="false" aria-controls="id-b42ba471a8c6901790ec0bc4">
                        <code>crypto/secp256k1/libsecp256k1/TODO</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/TODO" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-3</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-b42ba471a8c6901790ec0bc4"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;TODO op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;TODO</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index a300e1c5eb9b1376c82b1f5d557d56be5708546f..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;TODO</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,3 +0,0 @@</span>
<span class="term-fg31">-* Unit tests for fieldelem&#47;groupelem, including ones intended to</span>
<span class="term-fg31">-  trigger fieldelem&#39;s boundary cases.</span>
<span class="term-fg31">-* Complete constant-time operations for signing&#47;keygen</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-21ad8bfcccc82adec394500a" role="button"
                       aria-expanded="false" aria-controls="id-21ad8bfcccc82adec394500a">
                        <code>crypto/secp256k1/libsecp256k1/autogen.sh</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/autogen.sh" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-3</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-21ad8bfcccc82adec394500a"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;autogen.sh op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;autogen.sh</span>
<span class="term-fg1">deleted file mode 100755</span>
<span class="term-fg1">index 65286b93530332340a0c4ec89301a54bff92a35b..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;autogen.sh</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,3 +0,0 @@</span>
<span class="term-fg31">-#!&#47;bin&#47;sh</span>
<span class="term-fg31">-set -e</span>
<span class="term-fg31">-autoreconf -if --warnings=all</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-dbbf60b23e66f1664b28a725" role="button"
                       aria-expanded="false" aria-controls="id-dbbf60b23e66f1664b28a725">
                        <code>crypto/secp256k1/libsecp256k1/build-aux/m4/ax_jni_include_dir.m4</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/build-aux/m4/ax_jni_include_dir.m4" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-140</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-dbbf60b23e66f1664b28a725"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;build-aux&#47;m4&#47;ax_jni_include_dir.m4 op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;build-aux&#47;m4&#47;ax_jni_include_dir.m4</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 1fc36276144a2fb7740c436bd53f09f42b12daff..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;build-aux&#47;m4&#47;ax_jni_include_dir.m4</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,140 +0,0 @@</span>
<span class="term-fg31">-# ===========================================================================</span>
<span class="term-fg31">-#    http:&#47;&#47;www.gnu.org&#47;software&#47;autoconf-archive&#47;ax_jni_include_dir.html</span>
<span class="term-fg31">-# ===========================================================================</span>
<span class="term-fg31">-#</span>
<span class="term-fg31">-# SYNOPSIS</span>
<span class="term-fg31">-#</span>
<span class="term-fg31">-#   AX_JNI_INCLUDE_DIR</span>
<span class="term-fg31">-#</span>
<span class="term-fg31">-# DESCRIPTION</span>
<span class="term-fg31">-#</span>
<span class="term-fg31">-#   AX_JNI_INCLUDE_DIR finds include directories needed for compiling</span>
<span class="term-fg31">-#   programs using the JNI interface.</span>
<span class="term-fg31">-#</span>
<span class="term-fg31">-#   JNI include directories are usually in the Java distribution. This is</span>
<span class="term-fg31">-#   deduced from the value of $JAVA_HOME, $JAVAC, or the path to &quot;javac&quot;, in</span>
<span class="term-fg31">-#   that order. When this macro completes, a list of directories is left in</span>
<span class="term-fg31">-#   the variable JNI_INCLUDE_DIRS.</span>
<span class="term-fg31">-#</span>
<span class="term-fg31">-#   Example usage follows:</span>
<span class="term-fg31">-#</span>
<span class="term-fg31">-#     AX_JNI_INCLUDE_DIR</span>
<span class="term-fg31">-#</span>
<span class="term-fg31">-#     for JNI_INCLUDE_DIR in $JNI_INCLUDE_DIRS</span>
<span class="term-fg31">-#     do</span>
<span class="term-fg31">-#             CPPFLAGS=&quot;$CPPFLAGS -I$JNI_INCLUDE_DIR&quot;</span>
<span class="term-fg31">-#     done</span>
<span class="term-fg31">-#</span>
<span class="term-fg31">-#   If you want to force a specific compiler:</span>
<span class="term-fg31">-#</span>
<span class="term-fg31">-#   - at the configure.in level, set JAVAC=yourcompiler before calling</span>
<span class="term-fg31">-#   AX_JNI_INCLUDE_DIR</span>
<span class="term-fg31">-#</span>
<span class="term-fg31">-#   - at the configure level, setenv JAVAC</span>
<span class="term-fg31">-#</span>
<span class="term-fg31">-#   Note: This macro can work with the autoconf M4 macros for Java programs.</span>
<span class="term-fg31">-#   This particular macro is not part of the original set of macros.</span>
<span class="term-fg31">-#</span>
<span class="term-fg31">-# LICENSE</span>
<span class="term-fg31">-#</span>
<span class="term-fg31">-#   Copyright (c) 2008 Don Anderson &lt;dda@sleepycat.com&gt;</span>
<span class="term-fg31">-#</span>
<span class="term-fg31">-#   Copying and distribution of this file, with or without modification, are</span>
<span class="term-fg31">-#   permitted in any medium without royalty provided the copyright notice</span>
<span class="term-fg31">-#   and this notice are preserved. This file is offered as-is, without any</span>
<span class="term-fg31">-#   warranty.</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#serial 10</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-AU_ALIAS([AC_JNI_INCLUDE_DIR], [AX_JNI_INCLUDE_DIR])</span>
<span class="term-fg31">-AC_DEFUN([AX_JNI_INCLUDE_DIR],[</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-JNI_INCLUDE_DIRS=&quot;&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-if test &quot;x$JAVA_HOME&quot; != x; then</span>
<span class="term-fg31">-	_JTOPDIR=&quot;$JAVA_HOME&quot;</span>
<span class="term-fg31">-else</span>
<span class="term-fg31">-	if test &quot;x$JAVAC&quot; = x; then</span>
<span class="term-fg31">-		JAVAC=javac</span>
<span class="term-fg31">-	fi</span>
<span class="term-fg31">-	AC_PATH_PROG([_ACJNI_JAVAC], [$JAVAC], [no])</span>
<span class="term-fg31">-	if test &quot;x$_ACJNI_JAVAC&quot; = xno; then</span>
<span class="term-fg31">-		AC_MSG_WARN([cannot find JDK; try setting \$JAVAC or \$JAVA_HOME])</span>
<span class="term-fg31">-	fi</span>
<span class="term-fg31">-	_ACJNI_FOLLOW_SYMLINKS(&quot;$_ACJNI_JAVAC&quot;)</span>
<span class="term-fg31">-	_JTOPDIR=`echo &quot;$_ACJNI_FOLLOWED&quot; | sed -e &#39;s:&#47;&#47;*:&#47;:g&#39; -e &#39;s:&#47;[[^&#47;]]*$::&#39;`</span>
<span class="term-fg31">-fi</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-case &quot;$host_os&quot; in</span>
<span class="term-fg31">-        darwin*)        _JTOPDIR=`echo &quot;$_JTOPDIR&quot; | sed -e &#39;s:&#47;[[^&#47;]]*$::&#39;`</span>
<span class="term-fg31">-                        _JINC=&quot;$_JTOPDIR&#47;Headers&quot;;;</span>
<span class="term-fg31">-        *)              _JINC=&quot;$_JTOPDIR&#47;include&quot;;;</span>
<span class="term-fg31">-esac</span>
<span class="term-fg31">-_AS_ECHO_LOG([_JTOPDIR=$_JTOPDIR])</span>
<span class="term-fg31">-_AS_ECHO_LOG([_JINC=$_JINC])</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-# On Mac OS X 10.6.4, jni.h is a symlink:</span>
<span class="term-fg31">-# &#47;System&#47;Library&#47;Frameworks&#47;JavaVM.framework&#47;Versions&#47;Current&#47;Headers&#47;jni.h</span>
<span class="term-fg31">-# -&gt; ..&#47;..&#47;CurrentJDK&#47;Headers&#47;jni.h.</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-AC_CACHE_CHECK(jni headers, ac_cv_jni_header_path,</span>
<span class="term-fg31">-[</span>
<span class="term-fg31">-if test -f &quot;$_JINC&#47;jni.h&quot;; then</span>
<span class="term-fg31">-  ac_cv_jni_header_path=&quot;$_JINC&quot;</span>
<span class="term-fg31">-  JNI_INCLUDE_DIRS=&quot;$JNI_INCLUDE_DIRS $ac_cv_jni_header_path&quot;</span>
<span class="term-fg31">-else</span>
<span class="term-fg31">-  _JTOPDIR=`echo &quot;$_JTOPDIR&quot; | sed -e &#39;s:&#47;[[^&#47;]]*$::&#39;`</span>
<span class="term-fg31">-  if test -f &quot;$_JTOPDIR&#47;include&#47;jni.h&quot;; then</span>
<span class="term-fg31">-    ac_cv_jni_header_path=&quot;$_JTOPDIR&#47;include&quot;</span>
<span class="term-fg31">-    JNI_INCLUDE_DIRS=&quot;$JNI_INCLUDE_DIRS $ac_cv_jni_header_path&quot;</span>
<span class="term-fg31">-  else</span>
<span class="term-fg31">-    ac_cv_jni_header_path=none</span>
<span class="term-fg31">-  fi</span>
<span class="term-fg31">-fi</span>
<span class="term-fg31">-])</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-# get the likely subdirectories for system specific java includes</span>
<span class="term-fg31">-case &quot;$host_os&quot; in</span>
<span class="term-fg31">-bsdi*)          _JNI_INC_SUBDIRS=&quot;bsdos&quot;;;</span>
<span class="term-fg31">-darwin*)        _JNI_INC_SUBDIRS=&quot;darwin&quot;;;</span>
<span class="term-fg31">-freebsd*)       _JNI_INC_SUBDIRS=&quot;freebsd&quot;;;</span>
<span class="term-fg31">-linux*)         _JNI_INC_SUBDIRS=&quot;linux genunix&quot;;;</span>
<span class="term-fg31">-osf*)           _JNI_INC_SUBDIRS=&quot;alpha&quot;;;</span>
<span class="term-fg31">-solaris*)       _JNI_INC_SUBDIRS=&quot;solaris&quot;;;</span>
<span class="term-fg31">-mingw*)		_JNI_INC_SUBDIRS=&quot;win32&quot;;;</span>
<span class="term-fg31">-cygwin*)	_JNI_INC_SUBDIRS=&quot;win32&quot;;;</span>
<span class="term-fg31">-*)              _JNI_INC_SUBDIRS=&quot;genunix&quot;;;</span>
<span class="term-fg31">-esac</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-if test &quot;x$ac_cv_jni_header_path&quot; != &quot;xnone&quot;; then</span>
<span class="term-fg31">-  # add any subdirectories that are present</span>
<span class="term-fg31">-  for JINCSUBDIR in $_JNI_INC_SUBDIRS</span>
<span class="term-fg31">-  do</span>
<span class="term-fg31">-      if test -d &quot;$_JTOPDIR&#47;include&#47;$JINCSUBDIR&quot;; then</span>
<span class="term-fg31">-           JNI_INCLUDE_DIRS=&quot;$JNI_INCLUDE_DIRS $_JTOPDIR&#47;include&#47;$JINCSUBDIR&quot;</span>
<span class="term-fg31">-      fi</span>
<span class="term-fg31">-  done</span>
<span class="term-fg31">-fi</span>
<span class="term-fg31">-])</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-# _ACJNI_FOLLOW_SYMLINKS &lt;path&gt;</span>
<span class="term-fg31">-# Follows symbolic links on &lt;path&gt;,</span>
<span class="term-fg31">-# finally setting variable _ACJNI_FOLLOWED</span>
<span class="term-fg31">-# ----------------------------------------</span>
<span class="term-fg31">-AC_DEFUN([_ACJNI_FOLLOW_SYMLINKS],[</span>
<span class="term-fg31">-# find the include directory relative to the javac executable</span>
<span class="term-fg31">-_cur=&quot;$1&quot;</span>
<span class="term-fg31">-while ls -ld &quot;$_cur&quot; 2&gt;&#47;dev&#47;null | grep &quot; -&gt; &quot; &gt;&#47;dev&#47;null; do</span>
<span class="term-fg31">-        AC_MSG_CHECKING([symlink for $_cur])</span>
<span class="term-fg31">-        _slink=`ls -ld &quot;$_cur&quot; | sed &#39;s&#47;.* -&gt; &#47;&#47;&#39;`</span>
<span class="term-fg31">-        case &quot;$_slink&quot; in</span>
<span class="term-fg31">-        &#47;*) _cur=&quot;$_slink&quot;;;</span>
<span class="term-fg31">-        # &#39;X&#39; avoids triggering unwanted echo options.</span>
<span class="term-fg31">-        *) _cur=`echo &quot;X$_cur&quot; | sed -e &#39;s&#47;^X&#47;&#47;&#39; -e &#39;s:[[^&#47;]]*$::&#39;`&quot;$_slink&quot;;;</span>
<span class="term-fg31">-        esac</span>
<span class="term-fg31">-        AC_MSG_RESULT([$_cur])</span>
<span class="term-fg31">-done</span>
<span class="term-fg31">-_ACJNI_FOLLOWED=&quot;$_cur&quot;</span>
<span class="term-fg31">-])# _ACJNI</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-841390c38d43823ba46fdf8a" role="button"
                       aria-expanded="false" aria-controls="id-841390c38d43823ba46fdf8a">
                        <code>crypto/secp256k1/libsecp256k1/build-aux/m4/ax_prog_cc_for_build.m4</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/build-aux/m4/ax_prog_cc_for_build.m4" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-125</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-841390c38d43823ba46fdf8a"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;build-aux&#47;m4&#47;ax_prog_cc_for_build.m4 op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;build-aux&#47;m4&#47;ax_prog_cc_for_build.m4</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 77fd346a79a6faea6e1c40e34465bb6a5b7f5895..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;build-aux&#47;m4&#47;ax_prog_cc_for_build.m4</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,125 +0,0 @@</span>
<span class="term-fg31">-# ===========================================================================</span>
<span class="term-fg31">-#   http:&#47;&#47;www.gnu.org&#47;software&#47;autoconf-archive&#47;ax_prog_cc_for_build.html</span>
<span class="term-fg31">-# ===========================================================================</span>
<span class="term-fg31">-#</span>
<span class="term-fg31">-# SYNOPSIS</span>
<span class="term-fg31">-#</span>
<span class="term-fg31">-#   AX_PROG_CC_FOR_BUILD</span>
<span class="term-fg31">-#</span>
<span class="term-fg31">-# DESCRIPTION</span>
<span class="term-fg31">-#</span>
<span class="term-fg31">-#   This macro searches for a C compiler that generates native executables,</span>
<span class="term-fg31">-#   that is a C compiler that surely is not a cross-compiler. This can be</span>
<span class="term-fg31">-#   useful if you have to generate source code at compile-time like for</span>
<span class="term-fg31">-#   example GCC does.</span>
<span class="term-fg31">-#</span>
<span class="term-fg31">-#   The macro sets the CC_FOR_BUILD and CPP_FOR_BUILD macros to anything</span>
<span class="term-fg31">-#   needed to compile or link (CC_FOR_BUILD) and preprocess (CPP_FOR_BUILD).</span>
<span class="term-fg31">-#   The value of these variables can be overridden by the user by specifying</span>
<span class="term-fg31">-#   a compiler with an environment variable (like you do for standard CC).</span>
<span class="term-fg31">-#</span>
<span class="term-fg31">-#   It also sets BUILD_EXEEXT and BUILD_OBJEXT to the executable and object</span>
<span class="term-fg31">-#   file extensions for the build platform, and GCC_FOR_BUILD to `yes&#39; if</span>
<span class="term-fg31">-#   the compiler we found is GCC. All these variables but GCC_FOR_BUILD are</span>
<span class="term-fg31">-#   substituted in the Makefile.</span>
<span class="term-fg31">-#</span>
<span class="term-fg31">-# LICENSE</span>
<span class="term-fg31">-#</span>
<span class="term-fg31">-#   Copyright (c) 2008 Paolo Bonzini &lt;bonzini@gnu.org&gt;</span>
<span class="term-fg31">-#</span>
<span class="term-fg31">-#   Copying and distribution of this file, with or without modification, are</span>
<span class="term-fg31">-#   permitted in any medium without royalty provided the copyright notice</span>
<span class="term-fg31">-#   and this notice are preserved. This file is offered as-is, without any</span>
<span class="term-fg31">-#   warranty.</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#serial 8</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-AU_ALIAS([AC_PROG_CC_FOR_BUILD], [AX_PROG_CC_FOR_BUILD])</span>
<span class="term-fg31">-AC_DEFUN([AX_PROG_CC_FOR_BUILD], [dnl</span>
<span class="term-fg31">-AC_REQUIRE([AC_PROG_CC])dnl</span>
<span class="term-fg31">-AC_REQUIRE([AC_PROG_CPP])dnl</span>
<span class="term-fg31">-AC_REQUIRE([AC_EXEEXT])dnl</span>
<span class="term-fg31">-AC_REQUIRE([AC_CANONICAL_HOST])dnl</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-dnl Use the standard macros, but make them use other variable names</span>
<span class="term-fg31">-dnl</span>
<span class="term-fg31">-pushdef([ac_cv_prog_CPP], ac_cv_build_prog_CPP)dnl</span>
<span class="term-fg31">-pushdef([ac_cv_prog_gcc], ac_cv_build_prog_gcc)dnl</span>
<span class="term-fg31">-pushdef([ac_cv_prog_cc_works], ac_cv_build_prog_cc_works)dnl</span>
<span class="term-fg31">-pushdef([ac_cv_prog_cc_cross], ac_cv_build_prog_cc_cross)dnl</span>
<span class="term-fg31">-pushdef([ac_cv_prog_cc_g], ac_cv_build_prog_cc_g)dnl</span>
<span class="term-fg31">-pushdef([ac_cv_exeext], ac_cv_build_exeext)dnl</span>
<span class="term-fg31">-pushdef([ac_cv_objext], ac_cv_build_objext)dnl</span>
<span class="term-fg31">-pushdef([ac_exeext], ac_build_exeext)dnl</span>
<span class="term-fg31">-pushdef([ac_objext], ac_build_objext)dnl</span>
<span class="term-fg31">-pushdef([CC], CC_FOR_BUILD)dnl</span>
<span class="term-fg31">-pushdef([CPP], CPP_FOR_BUILD)dnl</span>
<span class="term-fg31">-pushdef([CFLAGS], CFLAGS_FOR_BUILD)dnl</span>
<span class="term-fg31">-pushdef([CPPFLAGS], CPPFLAGS_FOR_BUILD)dnl</span>
<span class="term-fg31">-pushdef([LDFLAGS], LDFLAGS_FOR_BUILD)dnl</span>
<span class="term-fg31">-pushdef([host], build)dnl</span>
<span class="term-fg31">-pushdef([host_alias], build_alias)dnl</span>
<span class="term-fg31">-pushdef([host_cpu], build_cpu)dnl</span>
<span class="term-fg31">-pushdef([host_vendor], build_vendor)dnl</span>
<span class="term-fg31">-pushdef([host_os], build_os)dnl</span>
<span class="term-fg31">-pushdef([ac_cv_host], ac_cv_build)dnl</span>
<span class="term-fg31">-pushdef([ac_cv_host_alias], ac_cv_build_alias)dnl</span>
<span class="term-fg31">-pushdef([ac_cv_host_cpu], ac_cv_build_cpu)dnl</span>
<span class="term-fg31">-pushdef([ac_cv_host_vendor], ac_cv_build_vendor)dnl</span>
<span class="term-fg31">-pushdef([ac_cv_host_os], ac_cv_build_os)dnl</span>
<span class="term-fg31">-pushdef([ac_cpp], ac_build_cpp)dnl</span>
<span class="term-fg31">-pushdef([ac_compile], ac_build_compile)dnl</span>
<span class="term-fg31">-pushdef([ac_link], ac_build_link)dnl</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-save_cross_compiling=$cross_compiling</span>
<span class="term-fg31">-save_ac_tool_prefix=$ac_tool_prefix</span>
<span class="term-fg31">-cross_compiling=no</span>
<span class="term-fg31">-ac_tool_prefix=</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-AC_PROG_CC</span>
<span class="term-fg31">-AC_PROG_CPP</span>
<span class="term-fg31">-AC_EXEEXT</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-ac_tool_prefix=$save_ac_tool_prefix</span>
<span class="term-fg31">-cross_compiling=$save_cross_compiling</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-dnl Restore the old definitions</span>
<span class="term-fg31">-dnl</span>
<span class="term-fg31">-popdef([ac_link])dnl</span>
<span class="term-fg31">-popdef([ac_compile])dnl</span>
<span class="term-fg31">-popdef([ac_cpp])dnl</span>
<span class="term-fg31">-popdef([ac_cv_host_os])dnl</span>
<span class="term-fg31">-popdef([ac_cv_host_vendor])dnl</span>
<span class="term-fg31">-popdef([ac_cv_host_cpu])dnl</span>
<span class="term-fg31">-popdef([ac_cv_host_alias])dnl</span>
<span class="term-fg31">-popdef([ac_cv_host])dnl</span>
<span class="term-fg31">-popdef([host_os])dnl</span>
<span class="term-fg31">-popdef([host_vendor])dnl</span>
<span class="term-fg31">-popdef([host_cpu])dnl</span>
<span class="term-fg31">-popdef([host_alias])dnl</span>
<span class="term-fg31">-popdef([host])dnl</span>
<span class="term-fg31">-popdef([LDFLAGS])dnl</span>
<span class="term-fg31">-popdef([CPPFLAGS])dnl</span>
<span class="term-fg31">-popdef([CFLAGS])dnl</span>
<span class="term-fg31">-popdef([CPP])dnl</span>
<span class="term-fg31">-popdef([CC])dnl</span>
<span class="term-fg31">-popdef([ac_objext])dnl</span>
<span class="term-fg31">-popdef([ac_exeext])dnl</span>
<span class="term-fg31">-popdef([ac_cv_objext])dnl</span>
<span class="term-fg31">-popdef([ac_cv_exeext])dnl</span>
<span class="term-fg31">-popdef([ac_cv_prog_cc_g])dnl</span>
<span class="term-fg31">-popdef([ac_cv_prog_cc_cross])dnl</span>
<span class="term-fg31">-popdef([ac_cv_prog_cc_works])dnl</span>
<span class="term-fg31">-popdef([ac_cv_prog_gcc])dnl</span>
<span class="term-fg31">-popdef([ac_cv_prog_CPP])dnl</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-dnl Finally, set Makefile variables</span>
<span class="term-fg31">-dnl</span>
<span class="term-fg31">-BUILD_EXEEXT=$ac_build_exeext</span>
<span class="term-fg31">-BUILD_OBJEXT=$ac_build_objext</span>
<span class="term-fg31">-AC_SUBST(BUILD_EXEEXT)dnl</span>
<span class="term-fg31">-AC_SUBST(BUILD_OBJEXT)dnl</span>
<span class="term-fg31">-AC_SUBST([CFLAGS_FOR_BUILD])dnl</span>
<span class="term-fg31">-AC_SUBST([CPPFLAGS_FOR_BUILD])dnl</span>
<span class="term-fg31">-AC_SUBST([LDFLAGS_FOR_BUILD])dnl</span>
<span class="term-fg31">-])</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-a588929ee2aad50727e299be" role="button"
                       aria-expanded="false" aria-controls="id-a588929ee2aad50727e299be">
                        <code>crypto/secp256k1/libsecp256k1/build-aux/m4/bitcoin_secp.m4</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/build-aux/m4/bitcoin_secp.m4" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-69</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-a588929ee2aad50727e299be"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;build-aux&#47;m4&#47;bitcoin_secp.m4 op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;build-aux&#47;m4&#47;bitcoin_secp.m4</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index b74acb8c138823c67e7fd0a11d059a90bd2551a9..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;build-aux&#47;m4&#47;bitcoin_secp.m4</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,69 +0,0 @@</span>
<span class="term-fg31">-dnl libsecp25k1 helper checks</span>
<span class="term-fg31">-AC_DEFUN([SECP_INT128_CHECK],[</span>
<span class="term-fg31">-has_int128=$ac_cv_type___int128</span>
<span class="term-fg31">-])</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-dnl escape &quot;$0x&quot; below using the m4 quadrigaph @S|@, and escape it again with a \ for the shell.</span>
<span class="term-fg31">-AC_DEFUN([SECP_64BIT_ASM_CHECK],[</span>
<span class="term-fg31">-AC_MSG_CHECKING(for x86_64 assembly availability)</span>
<span class="term-fg31">-AC_COMPILE_IFELSE([AC_LANG_PROGRAM([[</span>
<span class="term-fg31">-  #include &lt;stdint.h&gt;]],[[</span>
<span class="term-fg31">-  uint64_t a = 11, tmp;</span>
<span class="term-fg31">-  __asm__ __volatile__(&quot;movq \@S|@0x100000000,%1; mulq %%rsi&quot; : &quot;+a&quot;(a) : &quot;S&quot;(tmp) : &quot;cc&quot;, &quot;%rdx&quot;);</span>
<span class="term-fg31">-  ]])],[has_64bit_asm=yes],[has_64bit_asm=no])</span>
<span class="term-fg31">-AC_MSG_RESULT([$has_64bit_asm])</span>
<span class="term-fg31">-])</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-dnl</span>
<span class="term-fg31">-AC_DEFUN([SECP_OPENSSL_CHECK],[</span>
<span class="term-fg31">-  has_libcrypto=no</span>
<span class="term-fg31">-  m4_ifdef([PKG_CHECK_MODULES],[</span>
<span class="term-fg31">-    PKG_CHECK_MODULES([CRYPTO], [libcrypto], [has_libcrypto=yes],[has_libcrypto=no])</span>
<span class="term-fg31">-    if test x&quot;$has_libcrypto&quot; = x&quot;yes&quot;; then</span>
<span class="term-fg31">-      TEMP_LIBS=&quot;$LIBS&quot;</span>
<span class="term-fg31">-      LIBS=&quot;$LIBS $CRYPTO_LIBS&quot;</span>
<span class="term-fg31">-      AC_CHECK_LIB(crypto, main,[AC_DEFINE(HAVE_LIBCRYPTO,1,[Define this symbol if libcrypto is installed])],[has_libcrypto=no])</span>
<span class="term-fg31">-      LIBS=&quot;$TEMP_LIBS&quot;</span>
<span class="term-fg31">-    fi</span>
<span class="term-fg31">-  ])</span>
<span class="term-fg31">-  if test x$has_libcrypto = xno; then</span>
<span class="term-fg31">-    AC_CHECK_HEADER(openssl&#47;crypto.h,[</span>
<span class="term-fg31">-      AC_CHECK_LIB(crypto, main,[</span>
<span class="term-fg31">-        has_libcrypto=yes</span>
<span class="term-fg31">-        CRYPTO_LIBS=-lcrypto</span>
<span class="term-fg31">-        AC_DEFINE(HAVE_LIBCRYPTO,1,[Define this symbol if libcrypto is installed])</span>
<span class="term-fg31">-      ])</span>
<span class="term-fg31">-    ])</span>
<span class="term-fg31">-    LIBS=</span>
<span class="term-fg31">-  fi</span>
<span class="term-fg31">-if test x&quot;$has_libcrypto&quot; = x&quot;yes&quot; &amp;&amp; test x&quot;$has_openssl_ec&quot; = x; then</span>
<span class="term-fg31">-  AC_MSG_CHECKING(for EC functions in libcrypto)</span>
<span class="term-fg31">-  AC_COMPILE_IFELSE([AC_LANG_PROGRAM([[</span>
<span class="term-fg31">-    #include &lt;openssl&#47;ec.h&gt;</span>
<span class="term-fg31">-    #include &lt;openssl&#47;ecdsa.h&gt;</span>
<span class="term-fg31">-    #include &lt;openssl&#47;obj_mac.h&gt;]],[[</span>
<span class="term-fg31">-    EC_KEY *eckey = EC_KEY_new_by_curve_name(NID_secp256k1);</span>
<span class="term-fg31">-    ECDSA_sign(0, NULL, 0, NULL, NULL, eckey);</span>
<span class="term-fg31">-    ECDSA_verify(0, NULL, 0, NULL, 0, eckey);</span>
<span class="term-fg31">-    EC_KEY_free(eckey);</span>
<span class="term-fg31">-    ECDSA_SIG *sig_openssl;</span>
<span class="term-fg31">-    sig_openssl = ECDSA_SIG_new();</span>
<span class="term-fg31">-    (void)sig_openssl-&gt;r;</span>
<span class="term-fg31">-    ECDSA_SIG_free(sig_openssl);</span>
<span class="term-fg31">-  ]])],[has_openssl_ec=yes],[has_openssl_ec=no])</span>
<span class="term-fg31">-  AC_MSG_RESULT([$has_openssl_ec])</span>
<span class="term-fg31">-fi</span>
<span class="term-fg31">-])</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-dnl</span>
<span class="term-fg31">-AC_DEFUN([SECP_GMP_CHECK],[</span>
<span class="term-fg31">-if test x&quot;$has_gmp&quot; != x&quot;yes&quot;; then</span>
<span class="term-fg31">-  CPPFLAGS_TEMP=&quot;$CPPFLAGS&quot;</span>
<span class="term-fg31">-  CPPFLAGS=&quot;$GMP_CPPFLAGS $CPPFLAGS&quot;</span>
<span class="term-fg31">-  LIBS_TEMP=&quot;$LIBS&quot;</span>
<span class="term-fg31">-  LIBS=&quot;$GMP_LIBS $LIBS&quot;</span>
<span class="term-fg31">-  AC_CHECK_HEADER(gmp.h,[AC_CHECK_LIB(gmp, __gmpz_init,[has_gmp=yes; GMP_LIBS=&quot;$GMP_LIBS -lgmp&quot;; AC_DEFINE(HAVE_LIBGMP,1,[Define this symbol if libgmp is installed])])])</span>
<span class="term-fg31">-  CPPFLAGS=&quot;$CPPFLAGS_TEMP&quot;</span>
<span class="term-fg31">-  LIBS=&quot;$LIBS_TEMP&quot;</span>
<span class="term-fg31">-fi</span>
<span class="term-fg31">-])</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-5bf26b3519f1d928a94c8c17" role="button"
                       aria-expanded="false" aria-controls="id-5bf26b3519f1d928a94c8c17">
                        <code>crypto/secp256k1/libsecp256k1/configure.ac</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/configure.ac" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-493</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-5bf26b3519f1d928a94c8c17"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;configure.ac op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;configure.ac</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index e5fcbcb4edf2ace1c2b8740fc118b1e784f12d5e..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;configure.ac</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,493 +0,0 @@</span>
<span class="term-fg31">-AC_PREREQ([2.60])</span>
<span class="term-fg31">-AC_INIT([libsecp256k1],[0.1])</span>
<span class="term-fg31">-AC_CONFIG_AUX_DIR([build-aux])</span>
<span class="term-fg31">-AC_CONFIG_MACRO_DIR([build-aux&#47;m4])</span>
<span class="term-fg31">-AC_CANONICAL_HOST</span>
<span class="term-fg31">-AH_TOP([#ifndef LIBSECP256K1_CONFIG_H])</span>
<span class="term-fg31">-AH_TOP([#define LIBSECP256K1_CONFIG_H])</span>
<span class="term-fg31">-AH_BOTTOM([#endif &#47;*LIBSECP256K1_CONFIG_H*&#47;])</span>
<span class="term-fg31">-AM_INIT_AUTOMAKE([foreign subdir-objects])</span>
<span class="term-fg31">-LT_INIT</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-dnl make the compilation flags quiet unless V=1 is used</span>
<span class="term-fg31">-m4_ifdef([AM_SILENT_RULES], [AM_SILENT_RULES([yes])])</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-PKG_PROG_PKG_CONFIG</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-AC_PATH_TOOL(AR, ar)</span>
<span class="term-fg31">-AC_PATH_TOOL(RANLIB, ranlib)</span>
<span class="term-fg31">-AC_PATH_TOOL(STRIP, strip)</span>
<span class="term-fg31">-AX_PROG_CC_FOR_BUILD</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-if test &quot;x$CFLAGS&quot; = &quot;x&quot;; then</span>
<span class="term-fg31">-  CFLAGS=&quot;-g&quot;</span>
<span class="term-fg31">-fi</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-AM_PROG_CC_C_O</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-AC_PROG_CC_C89</span>
<span class="term-fg31">-if test x&quot;$ac_cv_prog_cc_c89&quot; = x&quot;no&quot;; then</span>
<span class="term-fg31">-  AC_MSG_ERROR([c89 compiler support required])</span>
<span class="term-fg31">-fi</span>
<span class="term-fg31">-AM_PROG_AS</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-case $host_os in</span>
<span class="term-fg31">-  *darwin*)</span>
<span class="term-fg31">-     if  test x$cross_compiling != xyes; then</span>
<span class="term-fg31">-       AC_PATH_PROG([BREW],brew,)</span>
<span class="term-fg31">-       if test x$BREW != x; then</span>
<span class="term-fg31">-         dnl These Homebrew packages may be keg-only, meaning that they won&#39;t be found</span>
<span class="term-fg31">-         dnl in expected paths because they may conflict with system files. Ask</span>
<span class="term-fg31">-         dnl Homebrew where each one is located, then adjust paths accordingly.</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-         openssl_prefix=`$BREW --prefix openssl 2&gt;&#47;dev&#47;null`</span>
<span class="term-fg31">-         gmp_prefix=`$BREW --prefix gmp 2&gt;&#47;dev&#47;null`</span>
<span class="term-fg31">-         if test x$openssl_prefix != x; then</span>
<span class="term-fg31">-           PKG_CONFIG_PATH=&quot;$openssl_prefix&#47;lib&#47;pkgconfig:$PKG_CONFIG_PATH&quot;</span>
<span class="term-fg31">-           export PKG_CONFIG_PATH</span>
<span class="term-fg31">-         fi</span>
<span class="term-fg31">-         if test x$gmp_prefix != x; then</span>
<span class="term-fg31">-           GMP_CPPFLAGS=&quot;-I$gmp_prefix&#47;include&quot;</span>
<span class="term-fg31">-           GMP_LIBS=&quot;-L$gmp_prefix&#47;lib&quot;</span>
<span class="term-fg31">-         fi</span>
<span class="term-fg31">-       else</span>
<span class="term-fg31">-         AC_PATH_PROG([PORT],port,)</span>
<span class="term-fg31">-         dnl if homebrew isn&#39;t installed and macports is, add the macports default paths</span>
<span class="term-fg31">-         dnl as a last resort.</span>
<span class="term-fg31">-         if test x$PORT != x; then</span>
<span class="term-fg31">-           CPPFLAGS=&quot;$CPPFLAGS -isystem &#47;opt&#47;local&#47;include&quot;</span>
<span class="term-fg31">-           LDFLAGS=&quot;$LDFLAGS -L&#47;opt&#47;local&#47;lib&quot;</span>
<span class="term-fg31">-         fi</span>
<span class="term-fg31">-       fi</span>
<span class="term-fg31">-     fi</span>
<span class="term-fg31">-   ;;</span>
<span class="term-fg31">-esac</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-CFLAGS=&quot;$CFLAGS -W&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-warn_CFLAGS=&quot;-std=c89 -pedantic -Wall -Wextra -Wcast-align -Wnested-externs -Wshadow -Wstrict-prototypes -Wno-unused-function -Wno-long-long -Wno-overlength-strings&quot;</span>
<span class="term-fg31">-saved_CFLAGS=&quot;$CFLAGS&quot;</span>
<span class="term-fg31">-CFLAGS=&quot;$CFLAGS $warn_CFLAGS&quot;</span>
<span class="term-fg31">-AC_MSG_CHECKING([if ${CC} supports ${warn_CFLAGS}])</span>
<span class="term-fg31">-AC_COMPILE_IFELSE([AC_LANG_SOURCE([[char foo;]])],</span>
<span class="term-fg31">-    [ AC_MSG_RESULT([yes]) ],</span>
<span class="term-fg31">-    [ AC_MSG_RESULT([no])</span>
<span class="term-fg31">-      CFLAGS=&quot;$saved_CFLAGS&quot;</span>
<span class="term-fg31">-    ])</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-saved_CFLAGS=&quot;$CFLAGS&quot;</span>
<span class="term-fg31">-CFLAGS=&quot;$CFLAGS -fvisibility=hidden&quot;</span>
<span class="term-fg31">-AC_MSG_CHECKING([if ${CC} supports -fvisibility=hidden])</span>
<span class="term-fg31">-AC_COMPILE_IFELSE([AC_LANG_SOURCE([[char foo;]])],</span>
<span class="term-fg31">-    [ AC_MSG_RESULT([yes]) ],</span>
<span class="term-fg31">-    [ AC_MSG_RESULT([no])</span>
<span class="term-fg31">-      CFLAGS=&quot;$saved_CFLAGS&quot;</span>
<span class="term-fg31">-    ])</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-AC_ARG_ENABLE(benchmark,</span>
<span class="term-fg31">-    AS_HELP_STRING([--enable-benchmark],[compile benchmark (default is no)]),</span>
<span class="term-fg31">-    [use_benchmark=$enableval],</span>
<span class="term-fg31">-    [use_benchmark=no])</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-AC_ARG_ENABLE(coverage,</span>
<span class="term-fg31">-    AS_HELP_STRING([--enable-coverage],[enable compiler flags to support kcov coverage analysis]),</span>
<span class="term-fg31">-    [enable_coverage=$enableval],</span>
<span class="term-fg31">-    [enable_coverage=no])</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-AC_ARG_ENABLE(tests,</span>
<span class="term-fg31">-    AS_HELP_STRING([--enable-tests],[compile tests (default is yes)]),</span>
<span class="term-fg31">-    [use_tests=$enableval],</span>
<span class="term-fg31">-    [use_tests=yes])</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-AC_ARG_ENABLE(openssl_tests,</span>
<span class="term-fg31">-    AS_HELP_STRING([--enable-openssl-tests],[enable OpenSSL tests, if OpenSSL is available (default is auto)]),</span>
<span class="term-fg31">-    [enable_openssl_tests=$enableval],</span>
<span class="term-fg31">-    [enable_openssl_tests=auto])</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-AC_ARG_ENABLE(experimental,</span>
<span class="term-fg31">-    AS_HELP_STRING([--enable-experimental],[allow experimental configure options (default is no)]),</span>
<span class="term-fg31">-    [use_experimental=$enableval],</span>
<span class="term-fg31">-    [use_experimental=no])</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-AC_ARG_ENABLE(exhaustive_tests,</span>
<span class="term-fg31">-    AS_HELP_STRING([--enable-exhaustive-tests],[compile exhaustive tests (default is yes)]),</span>
<span class="term-fg31">-    [use_exhaustive_tests=$enableval],</span>
<span class="term-fg31">-    [use_exhaustive_tests=yes])</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-AC_ARG_ENABLE(endomorphism,</span>
<span class="term-fg31">-    AS_HELP_STRING([--enable-endomorphism],[enable endomorphism (default is no)]),</span>
<span class="term-fg31">-    [use_endomorphism=$enableval],</span>
<span class="term-fg31">-    [use_endomorphism=no])</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-AC_ARG_ENABLE(ecmult_static_precomputation,</span>
<span class="term-fg31">-    AS_HELP_STRING([--enable-ecmult-static-precomputation],[enable precomputed ecmult table for signing (default is yes)]),</span>
<span class="term-fg31">-    [use_ecmult_static_precomputation=$enableval],</span>
<span class="term-fg31">-    [use_ecmult_static_precomputation=auto])</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-AC_ARG_ENABLE(module_ecdh,</span>
<span class="term-fg31">-    AS_HELP_STRING([--enable-module-ecdh],[enable ECDH shared secret computation (experimental)]),</span>
<span class="term-fg31">-    [enable_module_ecdh=$enableval],</span>
<span class="term-fg31">-    [enable_module_ecdh=no])</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-AC_ARG_ENABLE(module_recovery,</span>
<span class="term-fg31">-    AS_HELP_STRING([--enable-module-recovery],[enable ECDSA pubkey recovery module (default is no)]),</span>
<span class="term-fg31">-    [enable_module_recovery=$enableval],</span>
<span class="term-fg31">-    [enable_module_recovery=no])</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-AC_ARG_ENABLE(jni,</span>
<span class="term-fg31">-    AS_HELP_STRING([--enable-jni],[enable libsecp256k1_jni (default is auto)]),</span>
<span class="term-fg31">-    [use_jni=$enableval],</span>
<span class="term-fg31">-    [use_jni=auto])</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-AC_ARG_WITH([field], [AS_HELP_STRING([--with-field=64bit|32bit|auto],</span>
<span class="term-fg31">-[Specify Field Implementation. Default is auto])],[req_field=$withval], [req_field=auto])</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-AC_ARG_WITH([bignum], [AS_HELP_STRING([--with-bignum=gmp|no|auto],</span>
<span class="term-fg31">-[Specify Bignum Implementation. Default is auto])],[req_bignum=$withval], [req_bignum=auto])</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-AC_ARG_WITH([scalar], [AS_HELP_STRING([--with-scalar=64bit|32bit|auto],</span>
<span class="term-fg31">-[Specify scalar implementation. Default is auto])],[req_scalar=$withval], [req_scalar=auto])</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-AC_ARG_WITH([asm], [AS_HELP_STRING([--with-asm=x86_64|arm|no|auto]</span>
<span class="term-fg31">-[Specify assembly optimizations to use. Default is auto (experimental: arm)])],[req_asm=$withval], [req_asm=auto])</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-AC_CHECK_TYPES([__int128])</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-AC_MSG_CHECKING([for __builtin_expect])</span>
<span class="term-fg31">-AC_COMPILE_IFELSE([AC_LANG_SOURCE([[void myfunc() {__builtin_expect(0,0);}]])],</span>
<span class="term-fg31">-    [ AC_MSG_RESULT([yes]);AC_DEFINE(HAVE_BUILTIN_EXPECT,1,[Define this symbol if __builtin_expect is available]) ],</span>
<span class="term-fg31">-    [ AC_MSG_RESULT([no])</span>
<span class="term-fg31">-    ])</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-if test x&quot;$enable_coverage&quot; = x&quot;yes&quot;; then</span>
<span class="term-fg31">-    AC_DEFINE(COVERAGE, 1, [Define this symbol to compile out all VERIFY code])</span>
<span class="term-fg31">-    CFLAGS=&quot;$CFLAGS -O0 --coverage&quot;</span>
<span class="term-fg31">-    LDFLAGS=&quot;--coverage&quot;</span>
<span class="term-fg31">-else</span>
<span class="term-fg31">-    CFLAGS=&quot;$CFLAGS -O3&quot;</span>
<span class="term-fg31">-fi</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-if test x&quot;$use_ecmult_static_precomputation&quot; != x&quot;no&quot;; then</span>
<span class="term-fg31">-  save_cross_compiling=$cross_compiling</span>
<span class="term-fg31">-  cross_compiling=no</span>
<span class="term-fg31">-  TEMP_CC=&quot;$CC&quot;</span>
<span class="term-fg31">-  CC=&quot;$CC_FOR_BUILD&quot;</span>
<span class="term-fg31">-  AC_MSG_CHECKING([native compiler: ${CC_FOR_BUILD}])</span>
<span class="term-fg31">-  AC_RUN_IFELSE(</span>
<span class="term-fg31">-    [AC_LANG_PROGRAM([], [return 0])],</span>
<span class="term-fg31">-    [working_native_cc=yes],</span>
<span class="term-fg31">-    [working_native_cc=no],[dnl])</span>
<span class="term-fg31">-  CC=&quot;$TEMP_CC&quot;</span>
<span class="term-fg31">-  cross_compiling=$save_cross_compiling</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  if test x&quot;$working_native_cc&quot; = x&quot;no&quot;; then</span>
<span class="term-fg31">-    set_precomp=no</span>
<span class="term-fg31">-    if test x&quot;$use_ecmult_static_precomputation&quot; = x&quot;yes&quot;;  then</span>
<span class="term-fg31">-      AC_MSG_ERROR([${CC_FOR_BUILD} does not produce working binaries. Please set CC_FOR_BUILD])</span>
<span class="term-fg31">-    else</span>
<span class="term-fg31">-      AC_MSG_RESULT([${CC_FOR_BUILD} does not produce working binaries. Please set CC_FOR_BUILD])</span>
<span class="term-fg31">-    fi</span>
<span class="term-fg31">-  else</span>
<span class="term-fg31">-    AC_MSG_RESULT([ok])</span>
<span class="term-fg31">-    set_precomp=yes</span>
<span class="term-fg31">-  fi</span>
<span class="term-fg31">-else</span>
<span class="term-fg31">-  set_precomp=no</span>
<span class="term-fg31">-fi</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-if test x&quot;$req_asm&quot; = x&quot;auto&quot;; then</span>
<span class="term-fg31">-  SECP_64BIT_ASM_CHECK</span>
<span class="term-fg31">-  if test x&quot;$has_64bit_asm&quot; = x&quot;yes&quot;; then</span>
<span class="term-fg31">-    set_asm=x86_64</span>
<span class="term-fg31">-  fi</span>
<span class="term-fg31">-  if test x&quot;$set_asm&quot; = x; then</span>
<span class="term-fg31">-    set_asm=no</span>
<span class="term-fg31">-  fi</span>
<span class="term-fg31">-else</span>
<span class="term-fg31">-  set_asm=$req_asm</span>
<span class="term-fg31">-  case $set_asm in</span>
<span class="term-fg31">-  x86_64)</span>
<span class="term-fg31">-    SECP_64BIT_ASM_CHECK</span>
<span class="term-fg31">-    if test x&quot;$has_64bit_asm&quot; != x&quot;yes&quot;; then</span>
<span class="term-fg31">-      AC_MSG_ERROR([x86_64 assembly optimization requested but not available])</span>
<span class="term-fg31">-    fi</span>
<span class="term-fg31">-    ;;</span>
<span class="term-fg31">-  arm)</span>
<span class="term-fg31">-    ;;</span>
<span class="term-fg31">-  no)</span>
<span class="term-fg31">-    ;;</span>
<span class="term-fg31">-  *)</span>
<span class="term-fg31">-    AC_MSG_ERROR([invalid assembly optimization selection])</span>
<span class="term-fg31">-    ;;</span>
<span class="term-fg31">-  esac</span>
<span class="term-fg31">-fi</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-if test x&quot;$req_field&quot; = x&quot;auto&quot;; then</span>
<span class="term-fg31">-  if test x&quot;set_asm&quot; = x&quot;x86_64&quot;; then</span>
<span class="term-fg31">-    set_field=64bit</span>
<span class="term-fg31">-  fi</span>
<span class="term-fg31">-  if test x&quot;$set_field&quot; = x; then</span>
<span class="term-fg31">-    SECP_INT128_CHECK</span>
<span class="term-fg31">-    if test x&quot;$has_int128&quot; = x&quot;yes&quot;; then</span>
<span class="term-fg31">-      set_field=64bit</span>
<span class="term-fg31">-    fi</span>
<span class="term-fg31">-  fi</span>
<span class="term-fg31">-  if test x&quot;$set_field&quot; = x; then</span>
<span class="term-fg31">-    set_field=32bit</span>
<span class="term-fg31">-  fi</span>
<span class="term-fg31">-else</span>
<span class="term-fg31">-  set_field=$req_field</span>
<span class="term-fg31">-  case $set_field in</span>
<span class="term-fg31">-  64bit)</span>
<span class="term-fg31">-    if test x&quot;$set_asm&quot; != x&quot;x86_64&quot;; then</span>
<span class="term-fg31">-      SECP_INT128_CHECK</span>
<span class="term-fg31">-      if test x&quot;$has_int128&quot; != x&quot;yes&quot;; then</span>
<span class="term-fg31">-        AC_MSG_ERROR([64bit field explicitly requested but neither __int128 support or x86_64 assembly available])</span>
<span class="term-fg31">-      fi</span>
<span class="term-fg31">-    fi</span>
<span class="term-fg31">-    ;;</span>
<span class="term-fg31">-  32bit)</span>
<span class="term-fg31">-    ;;</span>
<span class="term-fg31">-  *)</span>
<span class="term-fg31">-    AC_MSG_ERROR([invalid field implementation selection])</span>
<span class="term-fg31">-    ;;</span>
<span class="term-fg31">-  esac</span>
<span class="term-fg31">-fi</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-if test x&quot;$req_scalar&quot; = x&quot;auto&quot;; then</span>
<span class="term-fg31">-  SECP_INT128_CHECK</span>
<span class="term-fg31">-  if test x&quot;$has_int128&quot; = x&quot;yes&quot;; then</span>
<span class="term-fg31">-    set_scalar=64bit</span>
<span class="term-fg31">-  fi</span>
<span class="term-fg31">-  if test x&quot;$set_scalar&quot; = x; then</span>
<span class="term-fg31">-    set_scalar=32bit</span>
<span class="term-fg31">-  fi</span>
<span class="term-fg31">-else</span>
<span class="term-fg31">-  set_scalar=$req_scalar</span>
<span class="term-fg31">-  case $set_scalar in</span>
<span class="term-fg31">-  64bit)</span>
<span class="term-fg31">-    SECP_INT128_CHECK</span>
<span class="term-fg31">-    if test x&quot;$has_int128&quot; != x&quot;yes&quot;; then</span>
<span class="term-fg31">-      AC_MSG_ERROR([64bit scalar explicitly requested but __int128 support not available])</span>
<span class="term-fg31">-    fi</span>
<span class="term-fg31">-    ;;</span>
<span class="term-fg31">-  32bit)</span>
<span class="term-fg31">-    ;;</span>
<span class="term-fg31">-  *)</span>
<span class="term-fg31">-    AC_MSG_ERROR([invalid scalar implementation selected])</span>
<span class="term-fg31">-    ;;</span>
<span class="term-fg31">-  esac</span>
<span class="term-fg31">-fi</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-if test x&quot;$req_bignum&quot; = x&quot;auto&quot;; then</span>
<span class="term-fg31">-  SECP_GMP_CHECK</span>
<span class="term-fg31">-  if test x&quot;$has_gmp&quot; = x&quot;yes&quot;; then</span>
<span class="term-fg31">-    set_bignum=gmp</span>
<span class="term-fg31">-  fi</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  if test x&quot;$set_bignum&quot; = x; then</span>
<span class="term-fg31">-    set_bignum=no</span>
<span class="term-fg31">-  fi</span>
<span class="term-fg31">-else</span>
<span class="term-fg31">-  set_bignum=$req_bignum</span>
<span class="term-fg31">-  case $set_bignum in</span>
<span class="term-fg31">-  gmp)</span>
<span class="term-fg31">-    SECP_GMP_CHECK</span>
<span class="term-fg31">-    if test x&quot;$has_gmp&quot; != x&quot;yes&quot;; then</span>
<span class="term-fg31">-      AC_MSG_ERROR([gmp bignum explicitly requested but libgmp not available])</span>
<span class="term-fg31">-    fi</span>
<span class="term-fg31">-    ;;</span>
<span class="term-fg31">-  no)</span>
<span class="term-fg31">-    ;;</span>
<span class="term-fg31">-  *)</span>
<span class="term-fg31">-    AC_MSG_ERROR([invalid bignum implementation selection])</span>
<span class="term-fg31">-    ;;</span>
<span class="term-fg31">-  esac</span>
<span class="term-fg31">-fi</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-# select assembly optimization</span>
<span class="term-fg31">-use_external_asm=no</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-case $set_asm in</span>
<span class="term-fg31">-x86_64)</span>
<span class="term-fg31">-  AC_DEFINE(USE_ASM_X86_64, 1, [Define this symbol to enable x86_64 assembly optimizations])</span>
<span class="term-fg31">-  ;;</span>
<span class="term-fg31">-arm)</span>
<span class="term-fg31">-  use_external_asm=yes</span>
<span class="term-fg31">-  ;;</span>
<span class="term-fg31">-no)</span>
<span class="term-fg31">-  ;;</span>
<span class="term-fg31">-*)</span>
<span class="term-fg31">-  AC_MSG_ERROR([invalid assembly optimizations])</span>
<span class="term-fg31">-  ;;</span>
<span class="term-fg31">-esac</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-# select field implementation</span>
<span class="term-fg31">-case $set_field in</span>
<span class="term-fg31">-64bit)</span>
<span class="term-fg31">-  AC_DEFINE(USE_FIELD_5X52, 1, [Define this symbol to use the FIELD_5X52 implementation])</span>
<span class="term-fg31">-  ;;</span>
<span class="term-fg31">-32bit)</span>
<span class="term-fg31">-  AC_DEFINE(USE_FIELD_10X26, 1, [Define this symbol to use the FIELD_10X26 implementation])</span>
<span class="term-fg31">-  ;;</span>
<span class="term-fg31">-*)</span>
<span class="term-fg31">-  AC_MSG_ERROR([invalid field implementation])</span>
<span class="term-fg31">-  ;;</span>
<span class="term-fg31">-esac</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-# select bignum implementation</span>
<span class="term-fg31">-case $set_bignum in</span>
<span class="term-fg31">-gmp)</span>
<span class="term-fg31">-  AC_DEFINE(HAVE_LIBGMP, 1, [Define this symbol if libgmp is installed])</span>
<span class="term-fg31">-  AC_DEFINE(USE_NUM_GMP, 1, [Define this symbol to use the gmp implementation for num])</span>
<span class="term-fg31">-  AC_DEFINE(USE_FIELD_INV_NUM, 1, [Define this symbol to use the num-based field inverse implementation])</span>
<span class="term-fg31">-  AC_DEFINE(USE_SCALAR_INV_NUM, 1, [Define this symbol to use the num-based scalar inverse implementation])</span>
<span class="term-fg31">-  ;;</span>
<span class="term-fg31">-no)</span>
<span class="term-fg31">-  AC_DEFINE(USE_NUM_NONE, 1, [Define this symbol to use no num implementation])</span>
<span class="term-fg31">-  AC_DEFINE(USE_FIELD_INV_BUILTIN, 1, [Define this symbol to use the native field inverse implementation])</span>
<span class="term-fg31">-  AC_DEFINE(USE_SCALAR_INV_BUILTIN, 1, [Define this symbol to use the native scalar inverse implementation])</span>
<span class="term-fg31">-  ;;</span>
<span class="term-fg31">-*)</span>
<span class="term-fg31">-  AC_MSG_ERROR([invalid bignum implementation])</span>
<span class="term-fg31">-  ;;</span>
<span class="term-fg31">-esac</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#select scalar implementation</span>
<span class="term-fg31">-case $set_scalar in</span>
<span class="term-fg31">-64bit)</span>
<span class="term-fg31">-  AC_DEFINE(USE_SCALAR_4X64, 1, [Define this symbol to use the 4x64 scalar implementation])</span>
<span class="term-fg31">-  ;;</span>
<span class="term-fg31">-32bit)</span>
<span class="term-fg31">-  AC_DEFINE(USE_SCALAR_8X32, 1, [Define this symbol to use the 8x32 scalar implementation])</span>
<span class="term-fg31">-  ;;</span>
<span class="term-fg31">-*)</span>
<span class="term-fg31">-  AC_MSG_ERROR([invalid scalar implementation])</span>
<span class="term-fg31">-  ;;</span>
<span class="term-fg31">-esac</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-if test x&quot;$use_tests&quot; = x&quot;yes&quot;; then</span>
<span class="term-fg31">-  SECP_OPENSSL_CHECK</span>
<span class="term-fg31">-  if test x&quot;$has_openssl_ec&quot; = x&quot;yes&quot;; then</span>
<span class="term-fg31">-    if test x&quot;$enable_openssl_tests&quot; != x&quot;no&quot;; then</span>
<span class="term-fg31">-      AC_DEFINE(ENABLE_OPENSSL_TESTS, 1, [Define this symbol if OpenSSL EC functions are available])</span>
<span class="term-fg31">-      SECP_TEST_INCLUDES=&quot;$SSL_CFLAGS $CRYPTO_CFLAGS&quot;</span>
<span class="term-fg31">-      SECP_TEST_LIBS=&quot;$CRYPTO_LIBS&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-      case $host in</span>
<span class="term-fg31">-      *mingw*)</span>
<span class="term-fg31">-        SECP_TEST_LIBS=&quot;$SECP_TEST_LIBS -lgdi32&quot;</span>
<span class="term-fg31">-        ;;</span>
<span class="term-fg31">-      esac</span>
<span class="term-fg31">-    fi</span>
<span class="term-fg31">-  else</span>
<span class="term-fg31">-    if test x&quot;$enable_openssl_tests&quot; = x&quot;yes&quot;; then</span>
<span class="term-fg31">-      AC_MSG_ERROR([OpenSSL tests requested but OpenSSL with EC support is not available])</span>
<span class="term-fg31">-    fi</span>
<span class="term-fg31">-  fi</span>
<span class="term-fg31">-else</span>
<span class="term-fg31">-  if test x&quot;$enable_openssl_tests&quot; = x&quot;yes&quot;; then</span>
<span class="term-fg31">-    AC_MSG_ERROR([OpenSSL tests requested but tests are not enabled])</span>
<span class="term-fg31">-  fi</span>
<span class="term-fg31">-fi</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-if test x&quot;$use_jni&quot; != x&quot;no&quot;; then</span>
<span class="term-fg31">-  AX_JNI_INCLUDE_DIR</span>
<span class="term-fg31">-  have_jni_dependencies=yes</span>
<span class="term-fg31">-  if test x&quot;$enable_module_ecdh&quot; = x&quot;no&quot;; then</span>
<span class="term-fg31">-    have_jni_dependencies=no</span>
<span class="term-fg31">-  fi</span>
<span class="term-fg31">-  if test &quot;x$JNI_INCLUDE_DIRS&quot; = &quot;x&quot;; then</span>
<span class="term-fg31">-    have_jni_dependencies=no</span>
<span class="term-fg31">-  fi</span>
<span class="term-fg31">-  if test &quot;x$have_jni_dependencies&quot; = &quot;xno&quot;; then</span>
<span class="term-fg31">-    if test x&quot;$use_jni&quot; = x&quot;yes&quot;; then</span>
<span class="term-fg31">-      AC_MSG_ERROR([jni support explicitly requested but headers&#47;dependencies were not found. Enable ECDH and try again.])</span>
<span class="term-fg31">-    fi</span>
<span class="term-fg31">-    AC_MSG_WARN([jni headers&#47;dependencies not found. jni support disabled])</span>
<span class="term-fg31">-    use_jni=no</span>
<span class="term-fg31">-  else</span>
<span class="term-fg31">-    use_jni=yes</span>
<span class="term-fg31">-    for JNI_INCLUDE_DIR in $JNI_INCLUDE_DIRS; do</span>
<span class="term-fg31">-      JNI_INCLUDES=&quot;$JNI_INCLUDES -I$JNI_INCLUDE_DIR&quot;</span>
<span class="term-fg31">-    done</span>
<span class="term-fg31">-  fi</span>
<span class="term-fg31">-fi</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-if test x&quot;$set_bignum&quot; = x&quot;gmp&quot;; then</span>
<span class="term-fg31">-  SECP_LIBS=&quot;$SECP_LIBS $GMP_LIBS&quot;</span>
<span class="term-fg31">-  SECP_INCLUDES=&quot;$SECP_INCLUDES $GMP_CPPFLAGS&quot;</span>
<span class="term-fg31">-fi</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-if test x&quot;$use_endomorphism&quot; = x&quot;yes&quot;; then</span>
<span class="term-fg31">-  AC_DEFINE(USE_ENDOMORPHISM, 1, [Define this symbol to use endomorphism optimization])</span>
<span class="term-fg31">-fi</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-if test x&quot;$set_precomp&quot; = x&quot;yes&quot;; then</span>
<span class="term-fg31">-  AC_DEFINE(USE_ECMULT_STATIC_PRECOMPUTATION, 1, [Define this symbol to use a statically generated ecmult table])</span>
<span class="term-fg31">-fi</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-if test x&quot;$enable_module_ecdh&quot; = x&quot;yes&quot;; then</span>
<span class="term-fg31">-  AC_DEFINE(ENABLE_MODULE_ECDH, 1, [Define this symbol to enable the ECDH module])</span>
<span class="term-fg31">-fi</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-if test x&quot;$enable_module_recovery&quot; = x&quot;yes&quot;; then</span>
<span class="term-fg31">-  AC_DEFINE(ENABLE_MODULE_RECOVERY, 1, [Define this symbol to enable the ECDSA pubkey recovery module])</span>
<span class="term-fg31">-fi</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-AC_C_BIGENDIAN()</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-if test x&quot;$use_external_asm&quot; = x&quot;yes&quot;; then</span>
<span class="term-fg31">-  AC_DEFINE(USE_EXTERNAL_ASM, 1, [Define this symbol if an external (non-inline) assembly implementation is used])</span>
<span class="term-fg31">-fi</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-AC_MSG_NOTICE([Using static precomputation: $set_precomp])</span>
<span class="term-fg31">-AC_MSG_NOTICE([Using assembly optimizations: $set_asm])</span>
<span class="term-fg31">-AC_MSG_NOTICE([Using field implementation: $set_field])</span>
<span class="term-fg31">-AC_MSG_NOTICE([Using bignum implementation: $set_bignum])</span>
<span class="term-fg31">-AC_MSG_NOTICE([Using scalar implementation: $set_scalar])</span>
<span class="term-fg31">-AC_MSG_NOTICE([Using endomorphism optimizations: $use_endomorphism])</span>
<span class="term-fg31">-AC_MSG_NOTICE([Building for coverage analysis: $enable_coverage])</span>
<span class="term-fg31">-AC_MSG_NOTICE([Building ECDH module: $enable_module_ecdh])</span>
<span class="term-fg31">-AC_MSG_NOTICE([Building ECDSA pubkey recovery module: $enable_module_recovery])</span>
<span class="term-fg31">-AC_MSG_NOTICE([Using jni: $use_jni])</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-if test x&quot;$enable_experimental&quot; = x&quot;yes&quot;; then</span>
<span class="term-fg31">-  AC_MSG_NOTICE([******])</span>
<span class="term-fg31">-  AC_MSG_NOTICE([WARNING: experimental build])</span>
<span class="term-fg31">-  AC_MSG_NOTICE([Experimental features do not have stable APIs or properties, and may not be safe for production use.])</span>
<span class="term-fg31">-  AC_MSG_NOTICE([Building ECDH module: $enable_module_ecdh])</span>
<span class="term-fg31">-  AC_MSG_NOTICE([******])</span>
<span class="term-fg31">-else</span>
<span class="term-fg31">-  if test x&quot;$enable_module_ecdh&quot; = x&quot;yes&quot;; then</span>
<span class="term-fg31">-    AC_MSG_ERROR([ECDH module is experimental. Use --enable-experimental to allow.])</span>
<span class="term-fg31">-  fi</span>
<span class="term-fg31">-  if test x&quot;$set_asm&quot; = x&quot;arm&quot;; then</span>
<span class="term-fg31">-    AC_MSG_ERROR([ARM assembly optimization is experimental. Use --enable-experimental to allow.])</span>
<span class="term-fg31">-  fi</span>
<span class="term-fg31">-fi</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-AC_CONFIG_HEADERS([src&#47;libsecp256k1-config.h])</span>
<span class="term-fg31">-AC_CONFIG_FILES([Makefile libsecp256k1.pc])</span>
<span class="term-fg31">-AC_SUBST(JNI_INCLUDES)</span>
<span class="term-fg31">-AC_SUBST(SECP_INCLUDES)</span>
<span class="term-fg31">-AC_SUBST(SECP_LIBS)</span>
<span class="term-fg31">-AC_SUBST(SECP_TEST_LIBS)</span>
<span class="term-fg31">-AC_SUBST(SECP_TEST_INCLUDES)</span>
<span class="term-fg31">-AM_CONDITIONAL([ENABLE_COVERAGE], [test x&quot;$enable_coverage&quot; = x&quot;yes&quot;])</span>
<span class="term-fg31">-AM_CONDITIONAL([USE_TESTS], [test x&quot;$use_tests&quot; != x&quot;no&quot;])</span>
<span class="term-fg31">-AM_CONDITIONAL([USE_EXHAUSTIVE_TESTS], [test x&quot;$use_exhaustive_tests&quot; != x&quot;no&quot;])</span>
<span class="term-fg31">-AM_CONDITIONAL([USE_BENCHMARK], [test x&quot;$use_benchmark&quot; = x&quot;yes&quot;])</span>
<span class="term-fg31">-AM_CONDITIONAL([USE_ECMULT_STATIC_PRECOMPUTATION], [test x&quot;$set_precomp&quot; = x&quot;yes&quot;])</span>
<span class="term-fg31">-AM_CONDITIONAL([ENABLE_MODULE_ECDH], [test x&quot;$enable_module_ecdh&quot; = x&quot;yes&quot;])</span>
<span class="term-fg31">-AM_CONDITIONAL([ENABLE_MODULE_RECOVERY], [test x&quot;$enable_module_recovery&quot; = x&quot;yes&quot;])</span>
<span class="term-fg31">-AM_CONDITIONAL([USE_JNI], [test x&quot;$use_jni&quot; == x&quot;yes&quot;])</span>
<span class="term-fg31">-AM_CONDITIONAL([USE_EXTERNAL_ASM], [test x&quot;$use_external_asm&quot; = x&quot;yes&quot;])</span>
<span class="term-fg31">-AM_CONDITIONAL([USE_ASM_ARM], [test x&quot;$set_asm&quot; = x&quot;arm&quot;])</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-dnl make sure nothing new is exported so that we don&#39;t break the cache</span>
<span class="term-fg31">-PKGCONFIG_PATH_TEMP=&quot;$PKG_CONFIG_PATH&quot;</span>
<span class="term-fg31">-unset PKG_CONFIG_PATH</span>
<span class="term-fg31">-PKG_CONFIG_PATH=&quot;$PKGCONFIG_PATH_TEMP&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-AC_OUTPUT</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-9cde2db1c3c5a47455601e99" role="button"
                       aria-expanded="false" aria-controls="id-9cde2db1c3c5a47455601e99">
                        <code>crypto/secp256k1/libsecp256k1/contrib/dummy.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/contrib/dummy.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-8</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-9cde2db1c3c5a47455601e99"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;contrib&#47;dummy.go op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;contrib&#47;dummy.go</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 2c946210c54d3776fa19fff82213747179aa9fd6..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;contrib&#47;dummy.go</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,8 +0,0 @@</span>
<span class="term-fg31">-&#47;&#47;go:build dummy</span>
<span class="term-fg31">-&#47;&#47; +build dummy</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;&#47; Package c contains only a C file.</span>
<span class="term-fg31">-&#47;&#47;</span>
<span class="term-fg31">-&#47;&#47; This Go file is part of a workaround for `go mod vendor`.</span>
<span class="term-fg31">-&#47;&#47; Please see the file crypto&#47;secp256k1&#47;dummy.go for more information.</span>
<span class="term-fg31">-package contrib</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-a7bec7b80db6cc0a3395d33b" role="button"
                       aria-expanded="false" aria-controls="id-a7bec7b80db6cc0a3395d33b">
                        <code>crypto/secp256k1/libsecp256k1/contrib/lax_der_parsing.c</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/contrib/lax_der_parsing.c" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-150</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-a7bec7b80db6cc0a3395d33b"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;contrib&#47;lax_der_parsing.c op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;contrib&#47;lax_der_parsing.c</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 5b141a99481c71f18bffe38e71a763443b14ef4e..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;contrib&#47;lax_der_parsing.c</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,150 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2015 Pieter Wuille                                   *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &lt;string.h&gt;</span>
<span class="term-fg31">-#include &lt;secp256k1.h&gt;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &quot;lax_der_parsing.h&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-int ecdsa_signature_parse_der_lax(const secp256k1_context* ctx, secp256k1_ecdsa_signature* sig, const unsigned char *input, size_t inputlen) {</span>
<span class="term-fg31">-    size_t rpos, rlen, spos, slen;</span>
<span class="term-fg31">-    size_t pos = 0;</span>
<span class="term-fg31">-    size_t lenbyte;</span>
<span class="term-fg31">-    unsigned char tmpsig[64] = {0};</span>
<span class="term-fg31">-    int overflow = 0;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Hack to initialize sig with a correctly-parsed but invalid signature. *&#47;</span>
<span class="term-fg31">-    secp256k1_ecdsa_signature_parse_compact(ctx, sig, tmpsig);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Sequence tag byte *&#47;</span>
<span class="term-fg31">-    if (pos == inputlen || input[pos] != 0x30) {</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    pos++;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Sequence length bytes *&#47;</span>
<span class="term-fg31">-    if (pos == inputlen) {</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    lenbyte = input[pos++];</span>
<span class="term-fg31">-    if (lenbyte &amp; 0x80) {</span>
<span class="term-fg31">-        lenbyte -= 0x80;</span>
<span class="term-fg31">-        if (pos + lenbyte &gt; inputlen) {</span>
<span class="term-fg31">-            return 0;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        pos += lenbyte;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Integer tag byte for R *&#47;</span>
<span class="term-fg31">-    if (pos == inputlen || input[pos] != 0x02) {</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    pos++;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Integer length for R *&#47;</span>
<span class="term-fg31">-    if (pos == inputlen) {</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    lenbyte = input[pos++];</span>
<span class="term-fg31">-    if (lenbyte &amp; 0x80) {</span>
<span class="term-fg31">-        lenbyte -= 0x80;</span>
<span class="term-fg31">-        if (pos + lenbyte &gt; inputlen) {</span>
<span class="term-fg31">-            return 0;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        while (lenbyte &gt; 0 &amp;&amp; input[pos] == 0) {</span>
<span class="term-fg31">-            pos++;</span>
<span class="term-fg31">-            lenbyte--;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        if (lenbyte &gt;= sizeof(size_t)) {</span>
<span class="term-fg31">-            return 0;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        rlen = 0;</span>
<span class="term-fg31">-        while (lenbyte &gt; 0) {</span>
<span class="term-fg31">-            rlen = (rlen &lt;&lt; 8) + input[pos];</span>
<span class="term-fg31">-            pos++;</span>
<span class="term-fg31">-            lenbyte--;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    } else {</span>
<span class="term-fg31">-        rlen = lenbyte;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    if (rlen &gt; inputlen - pos) {</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    rpos = pos;</span>
<span class="term-fg31">-    pos += rlen;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Integer tag byte for S *&#47;</span>
<span class="term-fg31">-    if (pos == inputlen || input[pos] != 0x02) {</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    pos++;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Integer length for S *&#47;</span>
<span class="term-fg31">-    if (pos == inputlen) {</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    lenbyte = input[pos++];</span>
<span class="term-fg31">-    if (lenbyte &amp; 0x80) {</span>
<span class="term-fg31">-        lenbyte -= 0x80;</span>
<span class="term-fg31">-        if (pos + lenbyte &gt; inputlen) {</span>
<span class="term-fg31">-            return 0;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        while (lenbyte &gt; 0 &amp;&amp; input[pos] == 0) {</span>
<span class="term-fg31">-            pos++;</span>
<span class="term-fg31">-            lenbyte--;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        if (lenbyte &gt;= sizeof(size_t)) {</span>
<span class="term-fg31">-            return 0;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        slen = 0;</span>
<span class="term-fg31">-        while (lenbyte &gt; 0) {</span>
<span class="term-fg31">-            slen = (slen &lt;&lt; 8) + input[pos];</span>
<span class="term-fg31">-            pos++;</span>
<span class="term-fg31">-            lenbyte--;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    } else {</span>
<span class="term-fg31">-        slen = lenbyte;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    if (slen &gt; inputlen - pos) {</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    spos = pos;</span>
<span class="term-fg31">-    pos += slen;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Ignore leading zeroes in R *&#47;</span>
<span class="term-fg31">-    while (rlen &gt; 0 &amp;&amp; input[rpos] == 0) {</span>
<span class="term-fg31">-        rlen--;</span>
<span class="term-fg31">-        rpos++;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    &#47;* Copy R value *&#47;</span>
<span class="term-fg31">-    if (rlen &gt; 32) {</span>
<span class="term-fg31">-        overflow = 1;</span>
<span class="term-fg31">-    } else {</span>
<span class="term-fg31">-        memcpy(tmpsig + 32 - rlen, input + rpos, rlen);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Ignore leading zeroes in S *&#47;</span>
<span class="term-fg31">-    while (slen &gt; 0 &amp;&amp; input[spos] == 0) {</span>
<span class="term-fg31">-        slen--;</span>
<span class="term-fg31">-        spos++;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    &#47;* Copy S value *&#47;</span>
<span class="term-fg31">-    if (slen &gt; 32) {</span>
<span class="term-fg31">-        overflow = 1;</span>
<span class="term-fg31">-    } else {</span>
<span class="term-fg31">-        memcpy(tmpsig + 64 - slen, input + spos, slen);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    if (!overflow) {</span>
<span class="term-fg31">-        overflow = !secp256k1_ecdsa_signature_parse_compact(ctx, sig, tmpsig);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    if (overflow) {</span>
<span class="term-fg31">-        memset(tmpsig, 0, 64);</span>
<span class="term-fg31">-        secp256k1_ecdsa_signature_parse_compact(ctx, sig, tmpsig);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    return 1;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-39f3a97020e6b14667290957" role="button"
                       aria-expanded="false" aria-controls="id-39f3a97020e6b14667290957">
                        <code>crypto/secp256k1/libsecp256k1/contrib/lax_der_parsing.h</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/contrib/lax_der_parsing.h" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-91</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-39f3a97020e6b14667290957"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;contrib&#47;lax_der_parsing.h op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;contrib&#47;lax_der_parsing.h</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 6d27871a7ccda3dfc1d34e051a345205522a172f..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;contrib&#47;lax_der_parsing.h</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,91 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2015 Pieter Wuille                                   *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;****</span>
<span class="term-fg31">- * Please do not link this file directly. It is not part of the libsecp256k1</span>
<span class="term-fg31">- * project and does not promise any stability in its API, functionality or</span>
<span class="term-fg31">- * presence. Projects which use this code should instead copy this header</span>
<span class="term-fg31">- * and its accompanying .c file directly into their codebase.</span>
<span class="term-fg31">- ****&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;* This file defines a function that parses DER with various errors and</span>
<span class="term-fg31">- * violations. This is not a part of the library itself, because the allowed</span>
<span class="term-fg31">- * violations are chosen arbitrarily and do not follow or establish any</span>
<span class="term-fg31">- * standard.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- * In many places it matters that different implementations do not only accept</span>
<span class="term-fg31">- * the same set of valid signatures, but also reject the same set of signatures.</span>
<span class="term-fg31">- * The only means to accomplish that is by strictly obeying a standard, and not</span>
<span class="term-fg31">- * accepting anything else.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- * Nonetheless, sometimes there is a need for compatibility with systems that</span>
<span class="term-fg31">- * use signatures which do not strictly obey DER. The snippet below shows how</span>
<span class="term-fg31">- * certain violations are easily supported. You may need to adapt it.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- * Do not use this for new systems. Use well-defined DER or compact signatures</span>
<span class="term-fg31">- * instead if you have the choice (see secp256k1_ecdsa_signature_parse_der and</span>
<span class="term-fg31">- * secp256k1_ecdsa_signature_parse_compact).</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- * The supported violations are:</span>
<span class="term-fg31">- * - All numbers are parsed as nonnegative integers, even though X.609-0207</span>
<span class="term-fg31">- *   section 8.3.3 specifies that integers are always encoded as two&#39;s</span>
<span class="term-fg31">- *   complement.</span>
<span class="term-fg31">- * - Integers can have length 0, even though section 8.3.1 says they can&#39;t.</span>
<span class="term-fg31">- * - Integers with overly long padding are accepted, violation section</span>
<span class="term-fg31">- *   8.3.2.</span>
<span class="term-fg31">- * - 127-byte long length descriptors are accepted, even though section</span>
<span class="term-fg31">- *   8.1.3.5.c says that they are not.</span>
<span class="term-fg31">- * - Trailing garbage data inside or after the signature is ignored.</span>
<span class="term-fg31">- * - The length descriptor of the sequence is ignored.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- * Compared to for example OpenSSL, many violations are NOT supported:</span>
<span class="term-fg31">- * - Using overly long tag descriptors for the sequence or integers inside,</span>
<span class="term-fg31">- *   violating section 8.1.2.2.</span>
<span class="term-fg31">- * - Encoding primitive integers as constructed values, violating section</span>
<span class="term-fg31">- *   8.3.1.</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef _SECP256K1_CONTRIB_LAX_DER_PARSING_H_</span>
<span class="term-fg31">-#define _SECP256K1_CONTRIB_LAX_DER_PARSING_H_</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &lt;secp256k1.h&gt;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-# ifdef __cplusplus</span>
<span class="term-fg31">-extern &quot;C&quot; {</span>
<span class="term-fg31">-# endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Parse a signature in &quot;lax DER&quot; format</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  Returns: 1 when the signature could be parsed, 0 otherwise.</span>
<span class="term-fg31">- *  Args: ctx:      a secp256k1 context object</span>
<span class="term-fg31">- *  Out:  sig:      a pointer to a signature object</span>
<span class="term-fg31">- *  In:   input:    a pointer to the signature to be parsed</span>
<span class="term-fg31">- *        inputlen: the length of the array pointed to be input</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  This function will accept any valid DER encoded signature, even if the</span>
<span class="term-fg31">- *  encoded numbers are out of range. In addition, it will accept signatures</span>
<span class="term-fg31">- *  which violate the DER spec in various ways. Its purpose is to allow</span>
<span class="term-fg31">- *  validation of the Bitcoin blockchain, which includes non-DER signatures</span>
<span class="term-fg31">- *  from before the network rules were updated to enforce DER. Note that</span>
<span class="term-fg31">- *  the set of supported violations is a strict subset of what OpenSSL will</span>
<span class="term-fg31">- *  accept.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  After the call, sig will always be initialized. If parsing failed or the</span>
<span class="term-fg31">- *  encoded numbers are out of range, signature validation with it is</span>
<span class="term-fg31">- *  guaranteed to fail for every message and public key.</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-int ecdsa_signature_parse_der_lax(</span>
<span class="term-fg31">-    const secp256k1_context* ctx,</span>
<span class="term-fg31">-    secp256k1_ecdsa_signature* sig,</span>
<span class="term-fg31">-    const unsigned char *input,</span>
<span class="term-fg31">-    size_t inputlen</span>
<span class="term-fg31">-) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef __cplusplus</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-70f488ad9acb08062868c4de" role="button"
                       aria-expanded="false" aria-controls="id-70f488ad9acb08062868c4de">
                        <code>crypto/secp256k1/libsecp256k1/contrib/lax_der_privatekey_parsing.c</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/contrib/lax_der_privatekey_parsing.c" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-113</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-70f488ad9acb08062868c4de"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;contrib&#47;lax_der_privatekey_parsing.c op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;contrib&#47;lax_der_privatekey_parsing.c</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index c2e63b4b8d7b379543dcee8ba9b0e4bdc957dc0a..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;contrib&#47;lax_der_privatekey_parsing.c</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,113 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2014, 2015 Pieter Wuille                             *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &lt;string.h&gt;</span>
<span class="term-fg31">-#include &lt;secp256k1.h&gt;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &quot;lax_der_privatekey_parsing.h&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-int ec_privkey_import_der(const secp256k1_context* ctx, unsigned char *out32, const unsigned char *privkey, size_t privkeylen) {</span>
<span class="term-fg31">-    const unsigned char *end = privkey + privkeylen;</span>
<span class="term-fg31">-    int lenb = 0;</span>
<span class="term-fg31">-    int len = 0;</span>
<span class="term-fg31">-    memset(out32, 0, 32);</span>
<span class="term-fg31">-    &#47;* sequence header *&#47;</span>
<span class="term-fg31">-    if (end &lt; privkey+1 || *privkey != 0x30) {</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    privkey++;</span>
<span class="term-fg31">-    &#47;* sequence length constructor *&#47;</span>
<span class="term-fg31">-    if (end &lt; privkey+1 || !(*privkey &amp; 0x80)) {</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    lenb = *privkey &amp; ~0x80; privkey++;</span>
<span class="term-fg31">-    if (lenb &lt; 1 || lenb &gt; 2) {</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    if (end &lt; privkey+lenb) {</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    &#47;* sequence length *&#47;</span>
<span class="term-fg31">-    len = privkey[lenb-1] | (lenb &gt; 1 ? privkey[lenb-2] &lt;&lt; 8 : 0);</span>
<span class="term-fg31">-    privkey += lenb;</span>
<span class="term-fg31">-    if (end &lt; privkey+len) {</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    &#47;* sequence element 0: version number (=1) *&#47;</span>
<span class="term-fg31">-    if (end &lt; privkey+3 || privkey[0] != 0x02 || privkey[1] != 0x01 || privkey[2] != 0x01) {</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    privkey += 3;</span>
<span class="term-fg31">-    &#47;* sequence element 1: octet string, up to 32 bytes *&#47;</span>
<span class="term-fg31">-    if (end &lt; privkey+2 || privkey[0] != 0x04 || privkey[1] &gt; 0x20 || end &lt; privkey+2+privkey[1]) {</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    memcpy(out32 + 32 - privkey[1], privkey + 2, privkey[1]);</span>
<span class="term-fg31">-    if (!secp256k1_ec_seckey_verify(ctx, out32)) {</span>
<span class="term-fg31">-        memset(out32, 0, 32);</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    return 1;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-int ec_privkey_export_der(const secp256k1_context *ctx, unsigned char *privkey, size_t *privkeylen, const unsigned char *key32, int compressed) {</span>
<span class="term-fg31">-    secp256k1_pubkey pubkey;</span>
<span class="term-fg31">-    size_t pubkeylen = 0;</span>
<span class="term-fg31">-    if (!secp256k1_ec_pubkey_create(ctx, &amp;pubkey, key32)) {</span>
<span class="term-fg31">-        *privkeylen = 0;</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    if (compressed) {</span>
<span class="term-fg31">-        static const unsigned char begin[] = {</span>
<span class="term-fg31">-            0x30,0x81,0xD3,0x02,0x01,0x01,0x04,0x20</span>
<span class="term-fg31">-        };</span>
<span class="term-fg31">-        static const unsigned char middle[] = {</span>
<span class="term-fg31">-            0xA0,0x81,0x85,0x30,0x81,0x82,0x02,0x01,0x01,0x30,0x2C,0x06,0x07,0x2A,0x86,0x48,</span>
<span class="term-fg31">-            0xCE,0x3D,0x01,0x01,0x02,0x21,0x00,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,</span>
<span class="term-fg31">-            0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,</span>
<span class="term-fg31">-            0xFF,0xFF,0xFE,0xFF,0xFF,0xFC,0x2F,0x30,0x06,0x04,0x01,0x00,0x04,0x01,0x07,0x04,</span>
<span class="term-fg31">-            0x21,0x02,0x79,0xBE,0x66,0x7E,0xF9,0xDC,0xBB,0xAC,0x55,0xA0,0x62,0x95,0xCE,0x87,</span>
<span class="term-fg31">-            0x0B,0x07,0x02,0x9B,0xFC,0xDB,0x2D,0xCE,0x28,0xD9,0x59,0xF2,0x81,0x5B,0x16,0xF8,</span>
<span class="term-fg31">-            0x17,0x98,0x02,0x21,0x00,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,</span>
<span class="term-fg31">-            0xFF,0xFF,0xFF,0xFF,0xFE,0xBA,0xAE,0xDC,0xE6,0xAF,0x48,0xA0,0x3B,0xBF,0xD2,0x5E,</span>
<span class="term-fg31">-            0x8C,0xD0,0x36,0x41,0x41,0x02,0x01,0x01,0xA1,0x24,0x03,0x22,0x00</span>
<span class="term-fg31">-        };</span>
<span class="term-fg31">-        unsigned char *ptr = privkey;</span>
<span class="term-fg31">-        memcpy(ptr, begin, sizeof(begin)); ptr += sizeof(begin);</span>
<span class="term-fg31">-        memcpy(ptr, key32, 32); ptr += 32;</span>
<span class="term-fg31">-        memcpy(ptr, middle, sizeof(middle)); ptr += sizeof(middle);</span>
<span class="term-fg31">-        pubkeylen = 33;</span>
<span class="term-fg31">-        secp256k1_ec_pubkey_serialize(ctx, ptr, &amp;pubkeylen, &amp;pubkey, SECP256K1_EC_COMPRESSED);</span>
<span class="term-fg31">-        ptr += pubkeylen;</span>
<span class="term-fg31">-        *privkeylen = ptr - privkey;</span>
<span class="term-fg31">-    } else {</span>
<span class="term-fg31">-        static const unsigned char begin[] = {</span>
<span class="term-fg31">-            0x30,0x82,0x01,0x13,0x02,0x01,0x01,0x04,0x20</span>
<span class="term-fg31">-        };</span>
<span class="term-fg31">-        static const unsigned char middle[] = {</span>
<span class="term-fg31">-            0xA0,0x81,0xA5,0x30,0x81,0xA2,0x02,0x01,0x01,0x30,0x2C,0x06,0x07,0x2A,0x86,0x48,</span>
<span class="term-fg31">-            0xCE,0x3D,0x01,0x01,0x02,0x21,0x00,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,</span>
<span class="term-fg31">-            0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,</span>
<span class="term-fg31">-            0xFF,0xFF,0xFE,0xFF,0xFF,0xFC,0x2F,0x30,0x06,0x04,0x01,0x00,0x04,0x01,0x07,0x04,</span>
<span class="term-fg31">-            0x41,0x04,0x79,0xBE,0x66,0x7E,0xF9,0xDC,0xBB,0xAC,0x55,0xA0,0x62,0x95,0xCE,0x87,</span>
<span class="term-fg31">-            0x0B,0x07,0x02,0x9B,0xFC,0xDB,0x2D,0xCE,0x28,0xD9,0x59,0xF2,0x81,0x5B,0x16,0xF8,</span>
<span class="term-fg31">-            0x17,0x98,0x48,0x3A,0xDA,0x77,0x26,0xA3,0xC4,0x65,0x5D,0xA4,0xFB,0xFC,0x0E,0x11,</span>
<span class="term-fg31">-            0x08,0xA8,0xFD,0x17,0xB4,0x48,0xA6,0x85,0x54,0x19,0x9C,0x47,0xD0,0x8F,0xFB,0x10,</span>
<span class="term-fg31">-            0xD4,0xB8,0x02,0x21,0x00,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,</span>
<span class="term-fg31">-            0xFF,0xFF,0xFF,0xFF,0xFE,0xBA,0xAE,0xDC,0xE6,0xAF,0x48,0xA0,0x3B,0xBF,0xD2,0x5E,</span>
<span class="term-fg31">-            0x8C,0xD0,0x36,0x41,0x41,0x02,0x01,0x01,0xA1,0x44,0x03,0x42,0x00</span>
<span class="term-fg31">-        };</span>
<span class="term-fg31">-        unsigned char *ptr = privkey;</span>
<span class="term-fg31">-        memcpy(ptr, begin, sizeof(begin)); ptr += sizeof(begin);</span>
<span class="term-fg31">-        memcpy(ptr, key32, 32); ptr += 32;</span>
<span class="term-fg31">-        memcpy(ptr, middle, sizeof(middle)); ptr += sizeof(middle);</span>
<span class="term-fg31">-        pubkeylen = 65;</span>
<span class="term-fg31">-        secp256k1_ec_pubkey_serialize(ctx, ptr, &amp;pubkeylen, &amp;pubkey, SECP256K1_EC_UNCOMPRESSED);</span>
<span class="term-fg31">-        ptr += pubkeylen;</span>
<span class="term-fg31">-        *privkeylen = ptr - privkey;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    return 1;</span>
<span class="term-fg31">-}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-0913b3bb4172e2809d8b17e5" role="button"
                       aria-expanded="false" aria-controls="id-0913b3bb4172e2809d8b17e5">
                        <code>crypto/secp256k1/libsecp256k1/contrib/lax_der_privatekey_parsing.h</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/contrib/lax_der_privatekey_parsing.h" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-90</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-0913b3bb4172e2809d8b17e5"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;contrib&#47;lax_der_privatekey_parsing.h op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;contrib&#47;lax_der_privatekey_parsing.h</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 2fd088f8abf1393a0ca49542f262a81d8d6669ab..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;contrib&#47;lax_der_privatekey_parsing.h</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,90 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2014, 2015 Pieter Wuille                             *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;****</span>
<span class="term-fg31">- * Please do not link this file directly. It is not part of the libsecp256k1</span>
<span class="term-fg31">- * project and does not promise any stability in its API, functionality or</span>
<span class="term-fg31">- * presence. Projects which use this code should instead copy this header</span>
<span class="term-fg31">- * and its accompanying .c file directly into their codebase.</span>
<span class="term-fg31">- ****&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;* This file contains code snippets that parse DER private keys with</span>
<span class="term-fg31">- * various errors and violations.  This is not a part of the library</span>
<span class="term-fg31">- * itself, because the allowed violations are chosen arbitrarily and</span>
<span class="term-fg31">- * do not follow or establish any standard.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- * It also contains code to serialize private keys in a compatible</span>
<span class="term-fg31">- * manner.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- * These functions are meant for compatibility with applications</span>
<span class="term-fg31">- * that require BER encoded keys. When working with secp256k1-specific</span>
<span class="term-fg31">- * code, the simple 32-byte private keys normally used by the</span>
<span class="term-fg31">- * library are sufficient.</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef _SECP256K1_CONTRIB_BER_PRIVATEKEY_H_</span>
<span class="term-fg31">-#define _SECP256K1_CONTRIB_BER_PRIVATEKEY_H_</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &lt;secp256k1.h&gt;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-# ifdef __cplusplus</span>
<span class="term-fg31">-extern &quot;C&quot; {</span>
<span class="term-fg31">-# endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Export a private key in DER format.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  Returns: 1 if the private key was valid.</span>
<span class="term-fg31">- *  Args: ctx:        pointer to a context object, initialized for signing (cannot</span>
<span class="term-fg31">- *                    be NULL)</span>
<span class="term-fg31">- *  Out: privkey:     pointer to an array for storing the private key in BER.</span>
<span class="term-fg31">- *                    Should have space for 279 bytes, and cannot be NULL.</span>
<span class="term-fg31">- *       privkeylen:  Pointer to an int where the length of the private key in</span>
<span class="term-fg31">- *                    privkey will be stored.</span>
<span class="term-fg31">- *  In:  seckey:      pointer to a 32-byte secret key to export.</span>
<span class="term-fg31">- *       compressed:  1 if the key should be exported in</span>
<span class="term-fg31">- *                    compressed format, 0 otherwise</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  This function is purely meant for compatibility with applications that</span>
<span class="term-fg31">- *  require BER encoded keys. When working with secp256k1-specific code, the</span>
<span class="term-fg31">- *  simple 32-byte private keys are sufficient.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  Note that this function does not guarantee correct DER output. It is</span>
<span class="term-fg31">- *  guaranteed to be parsable by secp256k1_ec_privkey_import_der</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-SECP256K1_WARN_UNUSED_RESULT int ec_privkey_export_der(</span>
<span class="term-fg31">-    const secp256k1_context* ctx,</span>
<span class="term-fg31">-    unsigned char *privkey,</span>
<span class="term-fg31">-    size_t *privkeylen,</span>
<span class="term-fg31">-    const unsigned char *seckey,</span>
<span class="term-fg31">-    int compressed</span>
<span class="term-fg31">-) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3) SECP256K1_ARG_NONNULL(4);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Import a private key in DER format.</span>
<span class="term-fg31">- * Returns: 1 if a private key was extracted.</span>
<span class="term-fg31">- * Args: ctx:        pointer to a context object (cannot be NULL).</span>
<span class="term-fg31">- * Out:  seckey:     pointer to a 32-byte array for storing the private key.</span>
<span class="term-fg31">- *                   (cannot be NULL).</span>
<span class="term-fg31">- * In:   privkey:    pointer to a private key in DER format (cannot be NULL).</span>
<span class="term-fg31">- *       privkeylen: length of the DER private key pointed to be privkey.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- * This function will accept more than just strict DER, and even allow some BER</span>
<span class="term-fg31">- * violations. The public key stored inside the DER-encoded private key is not</span>
<span class="term-fg31">- * verified for correctness, nor are the curve parameters. Use this function</span>
<span class="term-fg31">- * only if you know in advance it is supposed to contain a secp256k1 private</span>
<span class="term-fg31">- * key.</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-SECP256K1_WARN_UNUSED_RESULT int ec_privkey_import_der(</span>
<span class="term-fg31">-    const secp256k1_context* ctx,</span>
<span class="term-fg31">-    unsigned char *seckey,</span>
<span class="term-fg31">-    const unsigned char *privkey,</span>
<span class="term-fg31">-    size_t privkeylen</span>
<span class="term-fg31">-) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef __cplusplus</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-81923bc24ec3034a76a9e945" role="button"
                       aria-expanded="false" aria-controls="id-81923bc24ec3034a76a9e945">
                        <code>crypto/secp256k1/libsecp256k1/dummy.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/dummy.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-8</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-81923bc24ec3034a76a9e945"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;dummy.go op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;dummy.go</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 04bbe3d76eccd7c3a158b161f4121b49d379330c..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;dummy.go</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,8 +0,0 @@</span>
<span class="term-fg31">-&#47;&#47;go:build dummy</span>
<span class="term-fg31">-&#47;&#47; +build dummy</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;&#47; Package c contains only a C file.</span>
<span class="term-fg31">-&#47;&#47;</span>
<span class="term-fg31">-&#47;&#47; This Go file is part of a workaround for `go mod vendor`.</span>
<span class="term-fg31">-&#47;&#47; Please see the file crypto&#47;secp256k1&#47;dummy.go for more information.</span>
<span class="term-fg31">-package libsecp256k1</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-2b98b4462596847042a7df29" role="button"
                       aria-expanded="false" aria-controls="id-2b98b4462596847042a7df29">
                        <code>crypto/secp256k1/libsecp256k1/include/dummy.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/include/dummy.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-8</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-2b98b4462596847042a7df29"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;include&#47;dummy.go op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;include&#47;dummy.go</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 64c71b8451d8703435cabf6b1c012621012720a1..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;include&#47;dummy.go</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,8 +0,0 @@</span>
<span class="term-fg31">-&#47;&#47;go:build dummy</span>
<span class="term-fg31">-&#47;&#47; +build dummy</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;&#47; Package c contains only a C file.</span>
<span class="term-fg31">-&#47;&#47;</span>
<span class="term-fg31">-&#47;&#47; This Go file is part of a workaround for `go mod vendor`.</span>
<span class="term-fg31">-&#47;&#47; Please see the file crypto&#47;secp256k1&#47;dummy.go for more information.</span>
<span class="term-fg31">-package include</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-7f345e23869840d44655da34" role="button"
                       aria-expanded="false" aria-controls="id-7f345e23869840d44655da34">
                        <code>crypto/secp256k1/libsecp256k1/include/secp256k1.h</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/include/secp256k1.h" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-577</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-7f345e23869840d44655da34"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;include&#47;secp256k1.h op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;include&#47;secp256k1.h</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 76af8396918e608bd3480a6330f9bf8cbc0763c6..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;include&#47;secp256k1.h</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,577 +0,0 @@</span>
<span class="term-fg31">-#ifndef _SECP256K1_</span>
<span class="term-fg31">-# define _SECP256K1_</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-# ifdef __cplusplus</span>
<span class="term-fg31">-extern &quot;C&quot; {</span>
<span class="term-fg31">-# endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &lt;stddef.h&gt;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;* These rules specify the order of arguments in API calls:</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- * 1. Context pointers go first, followed by output arguments, combined</span>
<span class="term-fg31">- *    output&#47;input arguments, and finally input-only arguments.</span>
<span class="term-fg31">- * 2. Array lengths always immediately the follow the argument whose length</span>
<span class="term-fg31">- *    they describe, even if this violates rule 1.</span>
<span class="term-fg31">- * 3. Within the OUT&#47;OUTIN&#47;IN groups, pointers to data that is typically generated</span>
<span class="term-fg31">- *    later go first. This means: signatures, public nonces, private nonces,</span>
<span class="term-fg31">- *    messages, public keys, secret keys, tweaks.</span>
<span class="term-fg31">- * 4. Arguments that are not data pointers go last, from more complex to less</span>
<span class="term-fg31">- *    complex: function pointers, algorithm names, messages, void pointers,</span>
<span class="term-fg31">- *    counts, flags, booleans.</span>
<span class="term-fg31">- * 5. Opaque data pointers follow the function pointer they are to be passed to.</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Opaque data structure that holds context information (precomputed tables etc.).</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  The purpose of context structures is to cache large precomputed data tables</span>
<span class="term-fg31">- *  that are expensive to construct, and also to maintain the randomization data</span>
<span class="term-fg31">- *  for blinding.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  Do not create a new context object for each operation, as construction is</span>
<span class="term-fg31">- *  far slower than all other API calls (~100 times slower than an ECDSA</span>
<span class="term-fg31">- *  verification).</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  A constructed context can safely be used from multiple threads</span>
<span class="term-fg31">- *  simultaneously, but API call that take a non-const pointer to a context</span>
<span class="term-fg31">- *  need exclusive access to it. In particular this is the case for</span>
<span class="term-fg31">- *  secp256k1_context_destroy and secp256k1_context_randomize.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  Regarding randomization, either do it once at creation time (in which case</span>
<span class="term-fg31">- *  you do not need any locking for the other calls), or use a read-write lock.</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-typedef struct secp256k1_context_struct secp256k1_context;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Opaque data structure that holds a parsed and valid public key.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  The exact representation of data inside is implementation defined and not</span>
<span class="term-fg31">- *  guaranteed to be portable between different platforms or versions. It is</span>
<span class="term-fg31">- *  however guaranteed to be 64 bytes in size, and can be safely copied&#47;moved.</span>
<span class="term-fg31">- *  If you need to convert to a format suitable for storage, transmission, or</span>
<span class="term-fg31">- *  comparison, use secp256k1_ec_pubkey_serialize and secp256k1_ec_pubkey_parse.</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-typedef struct {</span>
<span class="term-fg31">-    unsigned char data[64];</span>
<span class="term-fg31">-} secp256k1_pubkey;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Opaque data structured that holds a parsed ECDSA signature.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  The exact representation of data inside is implementation defined and not</span>
<span class="term-fg31">- *  guaranteed to be portable between different platforms or versions. It is</span>
<span class="term-fg31">- *  however guaranteed to be 64 bytes in size, and can be safely copied&#47;moved.</span>
<span class="term-fg31">- *  If you need to convert to a format suitable for storage, transmission, or</span>
<span class="term-fg31">- *  comparison, use the secp256k1_ecdsa_signature_serialize_* and</span>
<span class="term-fg31">- *  secp256k1_ecdsa_signature_serialize_* functions.</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-typedef struct {</span>
<span class="term-fg31">-    unsigned char data[64];</span>
<span class="term-fg31">-} secp256k1_ecdsa_signature;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** A pointer to a function to deterministically generate a nonce.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- * Returns: 1 if a nonce was successfully generated. 0 will cause signing to fail.</span>
<span class="term-fg31">- * Out:     nonce32:   pointer to a 32-byte array to be filled by the function.</span>
<span class="term-fg31">- * In:      msg32:     the 32-byte message hash being verified (will not be NULL)</span>
<span class="term-fg31">- *          key32:     pointer to a 32-byte secret key (will not be NULL)</span>
<span class="term-fg31">- *          algo16:    pointer to a 16-byte array describing the signature</span>
<span class="term-fg31">- *                     algorithm (will be NULL for ECDSA for compatibility).</span>
<span class="term-fg31">- *          data:      Arbitrary data pointer that is passed through.</span>
<span class="term-fg31">- *          attempt:   how many iterations we have tried to find a nonce.</span>
<span class="term-fg31">- *                     This will almost always be 0, but different attempt values</span>
<span class="term-fg31">- *                     are required to result in a different nonce.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- * Except for test cases, this function should compute some cryptographic hash of</span>
<span class="term-fg31">- * the message, the algorithm, the key and the attempt.</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-typedef int (*secp256k1_nonce_function)(</span>
<span class="term-fg31">-    unsigned char *nonce32,</span>
<span class="term-fg31">-    const unsigned char *msg32,</span>
<span class="term-fg31">-    const unsigned char *key32,</span>
<span class="term-fg31">-    const unsigned char *algo16,</span>
<span class="term-fg31">-    void *data,</span>
<span class="term-fg31">-    unsigned int attempt</span>
<span class="term-fg31">-);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-# if !defined(SECP256K1_GNUC_PREREQ)</span>
<span class="term-fg31">-#  if defined(__GNUC__)&amp;&amp;defined(__GNUC_MINOR__)</span>
<span class="term-fg31">-#   define SECP256K1_GNUC_PREREQ(_maj,_min) \</span>
<span class="term-fg31">- ((__GNUC__&lt;&lt;16)+__GNUC_MINOR__&gt;=((_maj)&lt;&lt;16)+(_min))</span>
<span class="term-fg31">-#  else</span>
<span class="term-fg31">-#   define SECP256K1_GNUC_PREREQ(_maj,_min) 0</span>
<span class="term-fg31">-#  endif</span>
<span class="term-fg31">-# endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-# if (!defined(__STDC_VERSION__) || (__STDC_VERSION__ &lt; 199901L) )</span>
<span class="term-fg31">-#  if SECP256K1_GNUC_PREREQ(2,7)</span>
<span class="term-fg31">-#   define SECP256K1_INLINE __inline__</span>
<span class="term-fg31">-#  elif (defined(_MSC_VER))</span>
<span class="term-fg31">-#   define SECP256K1_INLINE __inline</span>
<span class="term-fg31">-#  else</span>
<span class="term-fg31">-#   define SECP256K1_INLINE</span>
<span class="term-fg31">-#  endif</span>
<span class="term-fg31">-# else</span>
<span class="term-fg31">-#  define SECP256K1_INLINE inline</span>
<span class="term-fg31">-# endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef SECP256K1_API</span>
<span class="term-fg31">-# if defined(_WIN32)</span>
<span class="term-fg31">-#  ifdef SECP256K1_BUILD</span>
<span class="term-fg31">-#   define SECP256K1_API __declspec(dllexport)</span>
<span class="term-fg31">-#  else</span>
<span class="term-fg31">-#   define SECP256K1_API</span>
<span class="term-fg31">-#  endif</span>
<span class="term-fg31">-# elif defined(__GNUC__) &amp;&amp; defined(SECP256K1_BUILD)</span>
<span class="term-fg31">-#  define SECP256K1_API __attribute__ ((visibility (&quot;default&quot;)))</span>
<span class="term-fg31">-# else</span>
<span class="term-fg31">-#  define SECP256K1_API</span>
<span class="term-fg31">-# endif</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;**Warning attributes</span>
<span class="term-fg31">-  * NONNULL is not used if SECP256K1_BUILD is set to avoid the compiler optimizing out</span>
<span class="term-fg31">-  * some paranoid null checks. *&#47;</span>
<span class="term-fg31">-# if defined(__GNUC__) &amp;&amp; SECP256K1_GNUC_PREREQ(3, 4)</span>
<span class="term-fg31">-#  define SECP256K1_WARN_UNUSED_RESULT __attribute__ ((__warn_unused_result__))</span>
<span class="term-fg31">-# else</span>
<span class="term-fg31">-#  define SECP256K1_WARN_UNUSED_RESULT</span>
<span class="term-fg31">-# endif</span>
<span class="term-fg31">-# if !defined(SECP256K1_BUILD) &amp;&amp; defined(__GNUC__) &amp;&amp; SECP256K1_GNUC_PREREQ(3, 4)</span>
<span class="term-fg31">-#  define SECP256K1_ARG_NONNULL(_x)  __attribute__ ((__nonnull__(_x)))</span>
<span class="term-fg31">-# else</span>
<span class="term-fg31">-#  define SECP256K1_ARG_NONNULL(_x)</span>
<span class="term-fg31">-# endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** All flags&#39; lower 8 bits indicate what they&#39;re for. Do not use directly. *&#47;</span>
<span class="term-fg31">-#define SECP256K1_FLAGS_TYPE_MASK ((1 &lt;&lt; 8) - 1)</span>
<span class="term-fg31">-#define SECP256K1_FLAGS_TYPE_CONTEXT (1 &lt;&lt; 0)</span>
<span class="term-fg31">-#define SECP256K1_FLAGS_TYPE_COMPRESSION (1 &lt;&lt; 1)</span>
<span class="term-fg31">-&#47;** The higher bits contain the actual data. Do not use directly. *&#47;</span>
<span class="term-fg31">-#define SECP256K1_FLAGS_BIT_CONTEXT_VERIFY (1 &lt;&lt; 8)</span>
<span class="term-fg31">-#define SECP256K1_FLAGS_BIT_CONTEXT_SIGN (1 &lt;&lt; 9)</span>
<span class="term-fg31">-#define SECP256K1_FLAGS_BIT_COMPRESSION (1 &lt;&lt; 8)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Flags to pass to secp256k1_context_create. *&#47;</span>
<span class="term-fg31">-#define SECP256K1_CONTEXT_VERIFY (SECP256K1_FLAGS_TYPE_CONTEXT | SECP256K1_FLAGS_BIT_CONTEXT_VERIFY)</span>
<span class="term-fg31">-#define SECP256K1_CONTEXT_SIGN (SECP256K1_FLAGS_TYPE_CONTEXT | SECP256K1_FLAGS_BIT_CONTEXT_SIGN)</span>
<span class="term-fg31">-#define SECP256K1_CONTEXT_NONE (SECP256K1_FLAGS_TYPE_CONTEXT)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Flag to pass to secp256k1_ec_pubkey_serialize and secp256k1_ec_privkey_export. *&#47;</span>
<span class="term-fg31">-#define SECP256K1_EC_COMPRESSED (SECP256K1_FLAGS_TYPE_COMPRESSION | SECP256K1_FLAGS_BIT_COMPRESSION)</span>
<span class="term-fg31">-#define SECP256K1_EC_UNCOMPRESSED (SECP256K1_FLAGS_TYPE_COMPRESSION)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Create a secp256k1 context object.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  Returns: a newly created context object.</span>
<span class="term-fg31">- *  In:      flags: which parts of the context to initialize.</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-SECP256K1_API secp256k1_context* secp256k1_context_create(</span>
<span class="term-fg31">-    unsigned int flags</span>
<span class="term-fg31">-) SECP256K1_WARN_UNUSED_RESULT;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Copies a secp256k1 context object.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  Returns: a newly created context object.</span>
<span class="term-fg31">- *  Args:    ctx: an existing context to copy (cannot be NULL)</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-SECP256K1_API secp256k1_context* secp256k1_context_clone(</span>
<span class="term-fg31">-    const secp256k1_context* ctx</span>
<span class="term-fg31">-) SECP256K1_ARG_NONNULL(1) SECP256K1_WARN_UNUSED_RESULT;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Destroy a secp256k1 context object.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  The context pointer may not be used afterwards.</span>
<span class="term-fg31">- *  Args:   ctx: an existing context to destroy (cannot be NULL)</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-SECP256K1_API void secp256k1_context_destroy(</span>
<span class="term-fg31">-    secp256k1_context* ctx</span>
<span class="term-fg31">-);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Set a callback function to be called when an illegal argument is passed to</span>
<span class="term-fg31">- *  an API call. It will only trigger for violations that are mentioned</span>
<span class="term-fg31">- *  explicitly in the header.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  The philosophy is that these shouldn&#39;t be dealt with through a</span>
<span class="term-fg31">- *  specific return value, as calling code should not have branches to deal with</span>
<span class="term-fg31">- *  the case that this code itself is broken.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  On the other hand, during debug stage, one would want to be informed about</span>
<span class="term-fg31">- *  such mistakes, and the default (crashing) may be inadvisable.</span>
<span class="term-fg31">- *  When this callback is triggered, the API function called is guaranteed not</span>
<span class="term-fg31">- *  to cause a crash, though its return value and output arguments are</span>
<span class="term-fg31">- *  undefined.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  Args: ctx:  an existing context object (cannot be NULL)</span>
<span class="term-fg31">- *  In:   fun:  a pointer to a function to call when an illegal argument is</span>
<span class="term-fg31">- *              passed to the API, taking a message and an opaque pointer</span>
<span class="term-fg31">- *              (NULL restores a default handler that calls abort).</span>
<span class="term-fg31">- *        data: the opaque pointer to pass to fun above.</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-SECP256K1_API void secp256k1_context_set_illegal_callback(</span>
<span class="term-fg31">-    secp256k1_context* ctx,</span>
<span class="term-fg31">-    void (*fun)(const char* message, void* data),</span>
<span class="term-fg31">-    const void* data</span>
<span class="term-fg31">-) SECP256K1_ARG_NONNULL(1);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Set a callback function to be called when an internal consistency check</span>
<span class="term-fg31">- *  fails. The default is crashing.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  This can only trigger in case of a hardware failure, miscompilation,</span>
<span class="term-fg31">- *  memory corruption, serious bug in the library, or other error would can</span>
<span class="term-fg31">- *  otherwise result in undefined behaviour. It will not trigger due to mere</span>
<span class="term-fg31">- *  incorrect usage of the API (see secp256k1_context_set_illegal_callback</span>
<span class="term-fg31">- *  for that). After this callback returns, anything may happen, including</span>
<span class="term-fg31">- *  crashing.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  Args: ctx:  an existing context object (cannot be NULL)</span>
<span class="term-fg31">- *  In:   fun:  a pointer to a function to call when an internal error occurs,</span>
<span class="term-fg31">- *              taking a message and an opaque pointer (NULL restores a default</span>
<span class="term-fg31">- *              handler that calls abort).</span>
<span class="term-fg31">- *        data: the opaque pointer to pass to fun above.</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-SECP256K1_API void secp256k1_context_set_error_callback(</span>
<span class="term-fg31">-    secp256k1_context* ctx,</span>
<span class="term-fg31">-    void (*fun)(const char* message, void* data),</span>
<span class="term-fg31">-    const void* data</span>
<span class="term-fg31">-) SECP256K1_ARG_NONNULL(1);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Parse a variable-length public key into the pubkey object.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  Returns: 1 if the public key was fully valid.</span>
<span class="term-fg31">- *           0 if the public key could not be parsed or is invalid.</span>
<span class="term-fg31">- *  Args: ctx:      a secp256k1 context object.</span>
<span class="term-fg31">- *  Out:  pubkey:   pointer to a pubkey object. If 1 is returned, it is set to a</span>
<span class="term-fg31">- *                  parsed version of input. If not, its value is undefined.</span>
<span class="term-fg31">- *  In:   input:    pointer to a serialized public key</span>
<span class="term-fg31">- *        inputlen: length of the array pointed to by input</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  This function supports parsing compressed (33 bytes, header byte 0x02 or</span>
<span class="term-fg31">- *  0x03), uncompressed (65 bytes, header byte 0x04), or hybrid (65 bytes, header</span>
<span class="term-fg31">- *  byte 0x06 or 0x07) format public keys.</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_ec_pubkey_parse(</span>
<span class="term-fg31">-    const secp256k1_context* ctx,</span>
<span class="term-fg31">-    secp256k1_pubkey* pubkey,</span>
<span class="term-fg31">-    const unsigned char *input,</span>
<span class="term-fg31">-    size_t inputlen</span>
<span class="term-fg31">-) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Serialize a pubkey object into a serialized byte sequence.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  Returns: 1 always.</span>
<span class="term-fg31">- *  Args:   ctx:        a secp256k1 context object.</span>
<span class="term-fg31">- *  Out:    output:     a pointer to a 65-byte (if compressed==0) or 33-byte (if</span>
<span class="term-fg31">- *                      compressed==1) byte array to place the serialized key</span>
<span class="term-fg31">- *                      in.</span>
<span class="term-fg31">- *  In&#47;Out: outputlen:  a pointer to an integer which is initially set to the</span>
<span class="term-fg31">- *                      size of output, and is overwritten with the written</span>
<span class="term-fg31">- *                      size.</span>
<span class="term-fg31">- *  In:     pubkey:     a pointer to a secp256k1_pubkey containing an</span>
<span class="term-fg31">- *                      initialized public key.</span>
<span class="term-fg31">- *          flags:      SECP256K1_EC_COMPRESSED if serialization should be in</span>
<span class="term-fg31">- *                      compressed format, otherwise SECP256K1_EC_UNCOMPRESSED.</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-SECP256K1_API int secp256k1_ec_pubkey_serialize(</span>
<span class="term-fg31">-    const secp256k1_context* ctx,</span>
<span class="term-fg31">-    unsigned char *output,</span>
<span class="term-fg31">-    size_t *outputlen,</span>
<span class="term-fg31">-    const secp256k1_pubkey* pubkey,</span>
<span class="term-fg31">-    unsigned int flags</span>
<span class="term-fg31">-) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3) SECP256K1_ARG_NONNULL(4);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Parse an ECDSA signature in compact (64 bytes) format.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  Returns: 1 when the signature could be parsed, 0 otherwise.</span>
<span class="term-fg31">- *  Args: ctx:      a secp256k1 context object</span>
<span class="term-fg31">- *  Out:  sig:      a pointer to a signature object</span>
<span class="term-fg31">- *  In:   input64:  a pointer to the 64-byte array to parse</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  The signature must consist of a 32-byte big endian R value, followed by a</span>
<span class="term-fg31">- *  32-byte big endian S value. If R or S fall outside of [0..order-1], the</span>
<span class="term-fg31">- *  encoding is invalid. R and S with value 0 are allowed in the encoding.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  After the call, sig will always be initialized. If parsing failed or R or</span>
<span class="term-fg31">- *  S are zero, the resulting sig value is guaranteed to fail validation for any</span>
<span class="term-fg31">- *  message and public key.</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-SECP256K1_API int secp256k1_ecdsa_signature_parse_compact(</span>
<span class="term-fg31">-    const secp256k1_context* ctx,</span>
<span class="term-fg31">-    secp256k1_ecdsa_signature* sig,</span>
<span class="term-fg31">-    const unsigned char *input64</span>
<span class="term-fg31">-) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Parse a DER ECDSA signature.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  Returns: 1 when the signature could be parsed, 0 otherwise.</span>
<span class="term-fg31">- *  Args: ctx:      a secp256k1 context object</span>
<span class="term-fg31">- *  Out:  sig:      a pointer to a signature object</span>
<span class="term-fg31">- *  In:   input:    a pointer to the signature to be parsed</span>
<span class="term-fg31">- *        inputlen: the length of the array pointed to be input</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  This function will accept any valid DER encoded signature, even if the</span>
<span class="term-fg31">- *  encoded numbers are out of range.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  After the call, sig will always be initialized. If parsing failed or the</span>
<span class="term-fg31">- *  encoded numbers are out of range, signature validation with it is</span>
<span class="term-fg31">- *  guaranteed to fail for every message and public key.</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-SECP256K1_API int secp256k1_ecdsa_signature_parse_der(</span>
<span class="term-fg31">-    const secp256k1_context* ctx,</span>
<span class="term-fg31">-    secp256k1_ecdsa_signature* sig,</span>
<span class="term-fg31">-    const unsigned char *input,</span>
<span class="term-fg31">-    size_t inputlen</span>
<span class="term-fg31">-) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Serialize an ECDSA signature in DER format.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  Returns: 1 if enough space was available to serialize, 0 otherwise</span>
<span class="term-fg31">- *  Args:   ctx:       a secp256k1 context object</span>
<span class="term-fg31">- *  Out:    output:    a pointer to an array to store the DER serialization</span>
<span class="term-fg31">- *  In&#47;Out: outputlen: a pointer to a length integer. Initially, this integer</span>
<span class="term-fg31">- *                     should be set to the length of output. After the call</span>
<span class="term-fg31">- *                     it will be set to the length of the serialization (even</span>
<span class="term-fg31">- *                     if 0 was returned).</span>
<span class="term-fg31">- *  In:     sig:       a pointer to an initialized signature object</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-SECP256K1_API int secp256k1_ecdsa_signature_serialize_der(</span>
<span class="term-fg31">-    const secp256k1_context* ctx,</span>
<span class="term-fg31">-    unsigned char *output,</span>
<span class="term-fg31">-    size_t *outputlen,</span>
<span class="term-fg31">-    const secp256k1_ecdsa_signature* sig</span>
<span class="term-fg31">-) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3) SECP256K1_ARG_NONNULL(4);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Serialize an ECDSA signature in compact (64 byte) format.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  Returns: 1</span>
<span class="term-fg31">- *  Args:   ctx:       a secp256k1 context object</span>
<span class="term-fg31">- *  Out:    output64:  a pointer to a 64-byte array to store the compact serialization</span>
<span class="term-fg31">- *  In:     sig:       a pointer to an initialized signature object</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  See secp256k1_ecdsa_signature_parse_compact for details about the encoding.</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-SECP256K1_API int secp256k1_ecdsa_signature_serialize_compact(</span>
<span class="term-fg31">-    const secp256k1_context* ctx,</span>
<span class="term-fg31">-    unsigned char *output64,</span>
<span class="term-fg31">-    const secp256k1_ecdsa_signature* sig</span>
<span class="term-fg31">-) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Verify an ECDSA signature.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  Returns: 1: correct signature</span>
<span class="term-fg31">- *           0: incorrect or unparsable signature</span>
<span class="term-fg31">- *  Args:    ctx:       a secp256k1 context object, initialized for verification.</span>
<span class="term-fg31">- *  In:      sig:       the signature being verified (cannot be NULL)</span>
<span class="term-fg31">- *           msg32:     the 32-byte message hash being verified (cannot be NULL)</span>
<span class="term-fg31">- *           pubkey:    pointer to an initialized public key to verify with (cannot be NULL)</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- * To avoid accepting malleable signatures, only ECDSA signatures in lower-S</span>
<span class="term-fg31">- * form are accepted.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- * If you need to accept ECDSA signatures from sources that do not obey this</span>
<span class="term-fg31">- * rule, apply secp256k1_ecdsa_signature_normalize to the signature prior to</span>
<span class="term-fg31">- * validation, but be aware that doing so results in malleable signatures.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- * For details, see the comments for that function.</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_ecdsa_verify(</span>
<span class="term-fg31">-    const secp256k1_context* ctx,</span>
<span class="term-fg31">-    const secp256k1_ecdsa_signature *sig,</span>
<span class="term-fg31">-    const unsigned char *msg32,</span>
<span class="term-fg31">-    const secp256k1_pubkey *pubkey</span>
<span class="term-fg31">-) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3) SECP256K1_ARG_NONNULL(4);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Convert a signature to a normalized lower-S form.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  Returns: 1 if sigin was not normalized, 0 if it already was.</span>
<span class="term-fg31">- *  Args: ctx:    a secp256k1 context object</span>
<span class="term-fg31">- *  Out:  sigout: a pointer to a signature to fill with the normalized form,</span>
<span class="term-fg31">- *                or copy if the input was already normalized. (can be NULL if</span>
<span class="term-fg31">- *                you&#39;re only interested in whether the input was already</span>
<span class="term-fg31">- *                normalized).</span>
<span class="term-fg31">- *  In:   sigin:  a pointer to a signature to check&#47;normalize (cannot be NULL,</span>
<span class="term-fg31">- *                can be identical to sigout)</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  With ECDSA a third-party can forge a second distinct signature of the same</span>
<span class="term-fg31">- *  message, given a single initial signature, but without knowing the key. This</span>
<span class="term-fg31">- *  is done by negating the S value modulo the order of the curve, &#39;flipping&#39;</span>
<span class="term-fg31">- *  the sign of the random point R which is not included in the signature.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  Forgery of the same message isn&#39;t universally problematic, but in systems</span>
<span class="term-fg31">- *  where message malleability or uniqueness of signatures is important this can</span>
<span class="term-fg31">- *  cause issues. This forgery can be blocked by all verifiers forcing signers</span>
<span class="term-fg31">- *  to use a normalized form.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  The lower-S form reduces the size of signatures slightly on average when</span>
<span class="term-fg31">- *  variable length encodings (such as DER) are used and is cheap to verify,</span>
<span class="term-fg31">- *  making it a good choice. Security of always using lower-S is assured because</span>
<span class="term-fg31">- *  anyone can trivially modify a signature after the fact to enforce this</span>
<span class="term-fg31">- *  property anyway.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  The lower S value is always between 0x1 and</span>
<span class="term-fg31">- *  0x7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF5D576E7357A4501DDFE92F46681B20A0,</span>
<span class="term-fg31">- *  inclusive.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  No other forms of ECDSA malleability are known and none seem likely, but</span>
<span class="term-fg31">- *  there is no formal proof that ECDSA, even with this additional restriction,</span>
<span class="term-fg31">- *  is free of other malleability. Commonly used serialization schemes will also</span>
<span class="term-fg31">- *  accept various non-unique encodings, so care should be taken when this</span>
<span class="term-fg31">- *  property is required for an application.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  The secp256k1_ecdsa_sign function will by default create signatures in the</span>
<span class="term-fg31">- *  lower-S form, and secp256k1_ecdsa_verify will not accept others. In case</span>
<span class="term-fg31">- *  signatures come from a system that cannot enforce this property,</span>
<span class="term-fg31">- *  secp256k1_ecdsa_signature_normalize must be called before verification.</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-SECP256K1_API int secp256k1_ecdsa_signature_normalize(</span>
<span class="term-fg31">-    const secp256k1_context* ctx,</span>
<span class="term-fg31">-    secp256k1_ecdsa_signature *sigout,</span>
<span class="term-fg31">-    const secp256k1_ecdsa_signature *sigin</span>
<span class="term-fg31">-) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(3);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** An implementation of RFC6979 (using HMAC-SHA256) as nonce generation function.</span>
<span class="term-fg31">- * If a data pointer is passed, it is assumed to be a pointer to 32 bytes of</span>
<span class="term-fg31">- * extra entropy.</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-SECP256K1_API extern const secp256k1_nonce_function secp256k1_nonce_function_rfc6979;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** A default safe nonce generation function (currently equal to secp256k1_nonce_function_rfc6979). *&#47;</span>
<span class="term-fg31">-SECP256K1_API extern const secp256k1_nonce_function secp256k1_nonce_function_default;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Create an ECDSA signature.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  Returns: 1: signature created</span>
<span class="term-fg31">- *           0: the nonce generation function failed, or the private key was invalid.</span>
<span class="term-fg31">- *  Args:    ctx:    pointer to a context object, initialized for signing (cannot be NULL)</span>
<span class="term-fg31">- *  Out:     sig:    pointer to an array where the signature will be placed (cannot be NULL)</span>
<span class="term-fg31">- *  In:      msg32:  the 32-byte message hash being signed (cannot be NULL)</span>
<span class="term-fg31">- *           seckey: pointer to a 32-byte secret key (cannot be NULL)</span>
<span class="term-fg31">- *           noncefp:pointer to a nonce generation function. If NULL, secp256k1_nonce_function_default is used</span>
<span class="term-fg31">- *           ndata:  pointer to arbitrary data used by the nonce generation function (can be NULL)</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- * The created signature is always in lower-S form. See</span>
<span class="term-fg31">- * secp256k1_ecdsa_signature_normalize for more details.</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-SECP256K1_API int secp256k1_ecdsa_sign(</span>
<span class="term-fg31">-    const secp256k1_context* ctx,</span>
<span class="term-fg31">-    secp256k1_ecdsa_signature *sig,</span>
<span class="term-fg31">-    const unsigned char *msg32,</span>
<span class="term-fg31">-    const unsigned char *seckey,</span>
<span class="term-fg31">-    secp256k1_nonce_function noncefp,</span>
<span class="term-fg31">-    const void *ndata</span>
<span class="term-fg31">-) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3) SECP256K1_ARG_NONNULL(4);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Verify an ECDSA secret key.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  Returns: 1: secret key is valid</span>
<span class="term-fg31">- *           0: secret key is invalid</span>
<span class="term-fg31">- *  Args:    ctx: pointer to a context object (cannot be NULL)</span>
<span class="term-fg31">- *  In:      seckey: pointer to a 32-byte secret key (cannot be NULL)</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_ec_seckey_verify(</span>
<span class="term-fg31">-    const secp256k1_context* ctx,</span>
<span class="term-fg31">-    const unsigned char *seckey</span>
<span class="term-fg31">-) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Compute the public key for a secret key.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  Returns: 1: secret was valid, public key stores</span>
<span class="term-fg31">- *           0: secret was invalid, try again</span>
<span class="term-fg31">- *  Args:   ctx:        pointer to a context object, initialized for signing (cannot be NULL)</span>
<span class="term-fg31">- *  Out:    pubkey:     pointer to the created public key (cannot be NULL)</span>
<span class="term-fg31">- *  In:     seckey:     pointer to a 32-byte private key (cannot be NULL)</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_ec_pubkey_create(</span>
<span class="term-fg31">-    const secp256k1_context* ctx,</span>
<span class="term-fg31">-    secp256k1_pubkey *pubkey,</span>
<span class="term-fg31">-    const unsigned char *seckey</span>
<span class="term-fg31">-) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Tweak a private key by adding tweak to it.</span>
<span class="term-fg31">- * Returns: 0 if the tweak was out of range (chance of around 1 in 2^128 for</span>
<span class="term-fg31">- *          uniformly random 32-byte arrays, or if the resulting private key</span>
<span class="term-fg31">- *          would be invalid (only when the tweak is the complement of the</span>
<span class="term-fg31">- *          private key). 1 otherwise.</span>
<span class="term-fg31">- * Args:    ctx:    pointer to a context object (cannot be NULL).</span>
<span class="term-fg31">- * In&#47;Out:  seckey: pointer to a 32-byte private key.</span>
<span class="term-fg31">- * In:      tweak:  pointer to a 32-byte tweak.</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_ec_privkey_tweak_add(</span>
<span class="term-fg31">-    const secp256k1_context* ctx,</span>
<span class="term-fg31">-    unsigned char *seckey,</span>
<span class="term-fg31">-    const unsigned char *tweak</span>
<span class="term-fg31">-) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Tweak a public key by adding tweak times the generator to it.</span>
<span class="term-fg31">- * Returns: 0 if the tweak was out of range (chance of around 1 in 2^128 for</span>
<span class="term-fg31">- *          uniformly random 32-byte arrays, or if the resulting public key</span>
<span class="term-fg31">- *          would be invalid (only when the tweak is the complement of the</span>
<span class="term-fg31">- *          corresponding private key). 1 otherwise.</span>
<span class="term-fg31">- * Args:    ctx:    pointer to a context object initialized for validation</span>
<span class="term-fg31">- *                  (cannot be NULL).</span>
<span class="term-fg31">- * In&#47;Out:  pubkey: pointer to a public key object.</span>
<span class="term-fg31">- * In:      tweak:  pointer to a 32-byte tweak.</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_ec_pubkey_tweak_add(</span>
<span class="term-fg31">-    const secp256k1_context* ctx,</span>
<span class="term-fg31">-    secp256k1_pubkey *pubkey,</span>
<span class="term-fg31">-    const unsigned char *tweak</span>
<span class="term-fg31">-) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Tweak a private key by multiplying it by a tweak.</span>
<span class="term-fg31">- * Returns: 0 if the tweak was out of range (chance of around 1 in 2^128 for</span>
<span class="term-fg31">- *          uniformly random 32-byte arrays, or equal to zero. 1 otherwise.</span>
<span class="term-fg31">- * Args:   ctx:    pointer to a context object (cannot be NULL).</span>
<span class="term-fg31">- * In&#47;Out: seckey: pointer to a 32-byte private key.</span>
<span class="term-fg31">- * In:     tweak:  pointer to a 32-byte tweak.</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_ec_privkey_tweak_mul(</span>
<span class="term-fg31">-    const secp256k1_context* ctx,</span>
<span class="term-fg31">-    unsigned char *seckey,</span>
<span class="term-fg31">-    const unsigned char *tweak</span>
<span class="term-fg31">-) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Tweak a public key by multiplying it by a tweak value.</span>
<span class="term-fg31">- * Returns: 0 if the tweak was out of range (chance of around 1 in 2^128 for</span>
<span class="term-fg31">- *          uniformly random 32-byte arrays, or equal to zero. 1 otherwise.</span>
<span class="term-fg31">- * Args:    ctx:    pointer to a context object initialized for validation</span>
<span class="term-fg31">- *                 (cannot be NULL).</span>
<span class="term-fg31">- * In&#47;Out:  pubkey: pointer to a public key obkect.</span>
<span class="term-fg31">- * In:      tweak:  pointer to a 32-byte tweak.</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_ec_pubkey_tweak_mul(</span>
<span class="term-fg31">-    const secp256k1_context* ctx,</span>
<span class="term-fg31">-    secp256k1_pubkey *pubkey,</span>
<span class="term-fg31">-    const unsigned char *tweak</span>
<span class="term-fg31">-) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Updates the context randomization.</span>
<span class="term-fg31">- *  Returns: 1: randomization successfully updated</span>
<span class="term-fg31">- *           0: error</span>
<span class="term-fg31">- *  Args:    ctx:       pointer to a context object (cannot be NULL)</span>
<span class="term-fg31">- *  In:      seed32:    pointer to a 32-byte random seed (NULL resets to initial state)</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_context_randomize(</span>
<span class="term-fg31">-    secp256k1_context* ctx,</span>
<span class="term-fg31">-    const unsigned char *seed32</span>
<span class="term-fg31">-) SECP256K1_ARG_NONNULL(1);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Add a number of public keys together.</span>
<span class="term-fg31">- *  Returns: 1: the sum of the public keys is valid.</span>
<span class="term-fg31">- *           0: the sum of the public keys is not valid.</span>
<span class="term-fg31">- *  Args:   ctx:        pointer to a context object</span>
<span class="term-fg31">- *  Out:    out:        pointer to a public key object for placing the resulting public key</span>
<span class="term-fg31">- *                      (cannot be NULL)</span>
<span class="term-fg31">- *  In:     ins:        pointer to array of pointers to public keys (cannot be NULL)</span>
<span class="term-fg31">- *          n:          the number of public keys to add together (must be at least 1)</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_ec_pubkey_combine(</span>
<span class="term-fg31">-    const secp256k1_context* ctx,</span>
<span class="term-fg31">-    secp256k1_pubkey *out,</span>
<span class="term-fg31">-    const secp256k1_pubkey * const * ins,</span>
<span class="term-fg31">-    size_t n</span>
<span class="term-fg31">-) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-# ifdef __cplusplus</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-# endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-3474070eb46798b26e1a4d61" role="button"
                       aria-expanded="false" aria-controls="id-3474070eb46798b26e1a4d61">
                        <code>crypto/secp256k1/libsecp256k1/include/secp256k1_ecdh.h</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/include/secp256k1_ecdh.h" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-31</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-3474070eb46798b26e1a4d61"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;include&#47;secp256k1_ecdh.h op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;include&#47;secp256k1_ecdh.h</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 4b84d7a963499698ff6c8b920d337fed2d1cb5f7..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;include&#47;secp256k1_ecdh.h</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,31 +0,0 @@</span>
<span class="term-fg31">-#ifndef _SECP256K1_ECDH_</span>
<span class="term-fg31">-# define _SECP256K1_ECDH_</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-# include &quot;secp256k1.h&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-# ifdef __cplusplus</span>
<span class="term-fg31">-extern &quot;C&quot; {</span>
<span class="term-fg31">-# endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Compute an EC Diffie-Hellman secret in constant time</span>
<span class="term-fg31">- *  Returns: 1: exponentiation was successful</span>
<span class="term-fg31">- *           0: scalar was invalid (zero or overflow)</span>
<span class="term-fg31">- *  Args:    ctx:        pointer to a context object (cannot be NULL)</span>
<span class="term-fg31">- *  Out:     result:     a 32-byte array which will be populated by an ECDH</span>
<span class="term-fg31">- *                       secret computed from the point and scalar</span>
<span class="term-fg31">- *  In:      pubkey:     a pointer to a secp256k1_pubkey containing an</span>
<span class="term-fg31">- *                       initialized public key</span>
<span class="term-fg31">- *           privkey:    a 32-byte scalar with which to multiply the point</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_ecdh(</span>
<span class="term-fg31">-  const secp256k1_context* ctx,</span>
<span class="term-fg31">-  unsigned char *result,</span>
<span class="term-fg31">-  const secp256k1_pubkey *pubkey,</span>
<span class="term-fg31">-  const unsigned char *privkey</span>
<span class="term-fg31">-) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3) SECP256K1_ARG_NONNULL(4);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-# ifdef __cplusplus</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-# endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-e713661eaca99552e76da26d" role="button"
                       aria-expanded="false" aria-controls="id-e713661eaca99552e76da26d">
                        <code>crypto/secp256k1/libsecp256k1/include/secp256k1_recovery.h</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/include/secp256k1_recovery.h" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-110</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-e713661eaca99552e76da26d"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;include&#47;secp256k1_recovery.h op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;include&#47;secp256k1_recovery.h</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 05537972532fb89feb6693d07c19168688136f38..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;include&#47;secp256k1_recovery.h</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,110 +0,0 @@</span>
<span class="term-fg31">-#ifndef _SECP256K1_RECOVERY_</span>
<span class="term-fg31">-# define _SECP256K1_RECOVERY_</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-# include &quot;secp256k1.h&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-# ifdef __cplusplus</span>
<span class="term-fg31">-extern &quot;C&quot; {</span>
<span class="term-fg31">-# endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Opaque data structured that holds a parsed ECDSA signature,</span>
<span class="term-fg31">- *  supporting pubkey recovery.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  The exact representation of data inside is implementation defined and not</span>
<span class="term-fg31">- *  guaranteed to be portable between different platforms or versions. It is</span>
<span class="term-fg31">- *  however guaranteed to be 65 bytes in size, and can be safely copied&#47;moved.</span>
<span class="term-fg31">- *  If you need to convert to a format suitable for storage or transmission, use</span>
<span class="term-fg31">- *  the secp256k1_ecdsa_signature_serialize_* and</span>
<span class="term-fg31">- *  secp256k1_ecdsa_signature_parse_* functions.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  Furthermore, it is guaranteed that identical signatures (including their</span>
<span class="term-fg31">- *  recoverability) will have identical representation, so they can be</span>
<span class="term-fg31">- *  memcmp&#39;ed.</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-typedef struct {</span>
<span class="term-fg31">-    unsigned char data[65];</span>
<span class="term-fg31">-} secp256k1_ecdsa_recoverable_signature;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Parse a compact ECDSA signature (64 bytes + recovery id).</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  Returns: 1 when the signature could be parsed, 0 otherwise</span>
<span class="term-fg31">- *  Args: ctx:     a secp256k1 context object</span>
<span class="term-fg31">- *  Out:  sig:     a pointer to a signature object</span>
<span class="term-fg31">- *  In:   input64: a pointer to a 64-byte compact signature</span>
<span class="term-fg31">- *        recid:   the recovery id (0, 1, 2 or 3)</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-SECP256K1_API int secp256k1_ecdsa_recoverable_signature_parse_compact(</span>
<span class="term-fg31">-    const secp256k1_context* ctx,</span>
<span class="term-fg31">-    secp256k1_ecdsa_recoverable_signature* sig,</span>
<span class="term-fg31">-    const unsigned char *input64,</span>
<span class="term-fg31">-    int recid</span>
<span class="term-fg31">-) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Convert a recoverable signature into a normal signature.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  Returns: 1</span>
<span class="term-fg31">- *  Out: sig:    a pointer to a normal signature (cannot be NULL).</span>
<span class="term-fg31">- *  In:  sigin:  a pointer to a recoverable signature (cannot be NULL).</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-SECP256K1_API int secp256k1_ecdsa_recoverable_signature_convert(</span>
<span class="term-fg31">-    const secp256k1_context* ctx,</span>
<span class="term-fg31">-    secp256k1_ecdsa_signature* sig,</span>
<span class="term-fg31">-    const secp256k1_ecdsa_recoverable_signature* sigin</span>
<span class="term-fg31">-) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Serialize an ECDSA signature in compact format (64 bytes + recovery id).</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  Returns: 1</span>
<span class="term-fg31">- *  Args: ctx:      a secp256k1 context object</span>
<span class="term-fg31">- *  Out:  output64: a pointer to a 64-byte array of the compact signature (cannot be NULL)</span>
<span class="term-fg31">- *        recid:    a pointer to an integer to hold the recovery id (can be NULL).</span>
<span class="term-fg31">- *  In:   sig:      a pointer to an initialized signature object (cannot be NULL)</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-SECP256K1_API int secp256k1_ecdsa_recoverable_signature_serialize_compact(</span>
<span class="term-fg31">-    const secp256k1_context* ctx,</span>
<span class="term-fg31">-    unsigned char *output64,</span>
<span class="term-fg31">-    int *recid,</span>
<span class="term-fg31">-    const secp256k1_ecdsa_recoverable_signature* sig</span>
<span class="term-fg31">-) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3) SECP256K1_ARG_NONNULL(4);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Create a recoverable ECDSA signature.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  Returns: 1: signature created</span>
<span class="term-fg31">- *           0: the nonce generation function failed, or the private key was invalid.</span>
<span class="term-fg31">- *  Args:    ctx:    pointer to a context object, initialized for signing (cannot be NULL)</span>
<span class="term-fg31">- *  Out:     sig:    pointer to an array where the signature will be placed (cannot be NULL)</span>
<span class="term-fg31">- *  In:      msg32:  the 32-byte message hash being signed (cannot be NULL)</span>
<span class="term-fg31">- *           seckey: pointer to a 32-byte secret key (cannot be NULL)</span>
<span class="term-fg31">- *           noncefp:pointer to a nonce generation function. If NULL, secp256k1_nonce_function_default is used</span>
<span class="term-fg31">- *           ndata:  pointer to arbitrary data used by the nonce generation function (can be NULL)</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-SECP256K1_API int secp256k1_ecdsa_sign_recoverable(</span>
<span class="term-fg31">-    const secp256k1_context* ctx,</span>
<span class="term-fg31">-    secp256k1_ecdsa_recoverable_signature *sig,</span>
<span class="term-fg31">-    const unsigned char *msg32,</span>
<span class="term-fg31">-    const unsigned char *seckey,</span>
<span class="term-fg31">-    secp256k1_nonce_function noncefp,</span>
<span class="term-fg31">-    const void *ndata</span>
<span class="term-fg31">-) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3) SECP256K1_ARG_NONNULL(4);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Recover an ECDSA public key from a signature.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  Returns: 1: public key successfully recovered (which guarantees a correct signature).</span>
<span class="term-fg31">- *           0: otherwise.</span>
<span class="term-fg31">- *  Args:    ctx:        pointer to a context object, initialized for verification (cannot be NULL)</span>
<span class="term-fg31">- *  Out:     pubkey:     pointer to the recovered public key (cannot be NULL)</span>
<span class="term-fg31">- *  In:      sig:        pointer to initialized signature that supports pubkey recovery (cannot be NULL)</span>
<span class="term-fg31">- *           msg32:      the 32-byte message hash assumed to be signed (cannot be NULL)</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_ecdsa_recover(</span>
<span class="term-fg31">-    const secp256k1_context* ctx,</span>
<span class="term-fg31">-    secp256k1_pubkey *pubkey,</span>
<span class="term-fg31">-    const secp256k1_ecdsa_recoverable_signature *sig,</span>
<span class="term-fg31">-    const unsigned char *msg32</span>
<span class="term-fg31">-) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3) SECP256K1_ARG_NONNULL(4);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-# ifdef __cplusplus</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-# endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-8866a65f41d4571fb668268a" role="button"
                       aria-expanded="false" aria-controls="id-8866a65f41d4571fb668268a">
                        <code>crypto/secp256k1/libsecp256k1/libsecp256k1.pc.in</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/libsecp256k1.pc.in" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-13</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-8866a65f41d4571fb668268a"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;libsecp256k1.pc.in op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;libsecp256k1.pc.in</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index a0d006f1131f47d9bb80de6d425e38912e1258f0..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;libsecp256k1.pc.in</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,13 +0,0 @@</span>
<span class="term-fg31">-prefix=@prefix@</span>
<span class="term-fg31">-exec_prefix=@exec_prefix@</span>
<span class="term-fg31">-libdir=@libdir@</span>
<span class="term-fg31">-includedir=@includedir@</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-Name: libsecp256k1</span>
<span class="term-fg31">-Description: Optimized C library for EC operations on curve secp256k1</span>
<span class="term-fg31">-URL: https:&#47;&#47;github.com&#47;bitcoin-core&#47;secp256k1</span>
<span class="term-fg31">-Version: @PACKAGE_VERSION@</span>
<span class="term-fg31">-Cflags: -I${includedir}</span>
<span class="term-fg31">-Libs.private: @SECP_LIBS@</span>
<span class="term-fg31">-Libs: -L${libdir} -lsecp256k1</span>
<span class="term-fg31">-</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-5b5077661dbe8eda79e0f97f" role="button"
                       aria-expanded="false" aria-controls="id-5b5077661dbe8eda79e0f97f">
                        <code>crypto/secp256k1/libsecp256k1/obj/.gitignore</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/obj/.gitignore" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <span class="text-secondary">(binary file)</span>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-5b5077661dbe8eda79e0f97f"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;obj&#47;.gitignore op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;obj&#47;.gitignore</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index e69de29bb2d1d6434b8b29ae775ad8c2e48c5391..0000000000000000000000000000000000000000</span>
<span class="term-fg1">Binary files go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;obj&#47;.gitignore and &#47;dev&#47;null differ</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-9a689e42e22fcfbc76f18d30" role="button"
                       aria-expanded="false" aria-controls="id-9a689e42e22fcfbc76f18d30">
                        <code>crypto/secp256k1/libsecp256k1/sage/group_prover.sage</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/sage/group_prover.sage" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-322</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-9a689e42e22fcfbc76f18d30"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;sage&#47;group_prover.sage op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;sage&#47;group_prover.sage</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 68882e93659af62ff21602d2efbc743465348345..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;sage&#47;group_prover.sage</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,322 +0,0 @@</span>
<span class="term-fg31">-# This code supports verifying group implementations which have branches</span>
<span class="term-fg31">-# or conditional statements (like cmovs), by allowing each execution path</span>
<span class="term-fg31">-# to independently set assumptions on input or intermediary variables.</span>
<span class="term-fg31">-#</span>
<span class="term-fg31">-# The general approach is:</span>
<span class="term-fg31">-# * A constraint is a tuple of two sets of of symbolic expressions:</span>
<span class="term-fg31">-#   the first of which are required to evaluate to zero, the second of which</span>
<span class="term-fg31">-#   are required to evaluate to nonzero.</span>
<span class="term-fg31">-#   - A constraint is said to be conflicting if any of its nonzero expressions</span>
<span class="term-fg31">-#     is in the ideal with basis the zero expressions (in other words: when the</span>
<span class="term-fg31">-#     zero expressions imply that one of the nonzero expressions are zero).</span>
<span class="term-fg31">-# * There is a list of laws that describe the intended behaviour, including</span>
<span class="term-fg31">-#   laws for addition and doubling. Each law is called with the symbolic point</span>
<span class="term-fg31">-#   coordinates as arguments, and returns:</span>
<span class="term-fg31">-#   - A constraint describing the assumptions under which it is applicable,</span>
<span class="term-fg31">-#     called &quot;assumeLaw&quot;</span>
<span class="term-fg31">-#   - A constraint describing the requirements of the law, called &quot;require&quot;</span>
<span class="term-fg31">-# * Implementations are transliterated into functions that operate as well on</span>
<span class="term-fg31">-#   algebraic input points, and are called once per combination of branches</span>
<span class="term-fg31">-#   executed. Each execution returns:</span>
<span class="term-fg31">-#   - A constraint describing the assumptions this implementation requires</span>
<span class="term-fg31">-#     (such as Z1=1), called &quot;assumeFormula&quot;</span>
<span class="term-fg31">-#   - A constraint describing the assumptions this specific branch requires,</span>
<span class="term-fg31">-#     but which is by construction guaranteed to cover the entire space by</span>
<span class="term-fg31">-#     merging the results from all branches, called &quot;assumeBranch&quot;</span>
<span class="term-fg31">-#   - The result of the computation</span>
<span class="term-fg31">-# * All combinations of laws with implementation branches are tried, and:</span>
<span class="term-fg31">-#   - If the combination of assumeLaw, assumeFormula, and assumeBranch results</span>
<span class="term-fg31">-#     in a conflict, it means this law does not apply to this branch, and it is</span>
<span class="term-fg31">-#     skipped.</span>
<span class="term-fg31">-#   - For others, we try to prove the require constraints hold, assuming the</span>
<span class="term-fg31">-#     information in assumeLaw + assumeFormula + assumeBranch, and if this does</span>
<span class="term-fg31">-#     not succeed, we fail.</span>
<span class="term-fg31">-#     + To prove an expression is zero, we check whether it belongs to the</span>
<span class="term-fg31">-#       ideal with the assumed zero expressions as basis. This test is exact.</span>
<span class="term-fg31">-#     + To prove an expression is nonzero, we check whether each of its</span>
<span class="term-fg31">-#       factors is contained in the set of nonzero assumptions&#39; factors.</span>
<span class="term-fg31">-#       This test is not exact, so various combinations of original and</span>
<span class="term-fg31">-#       reduced expressions&#39; factors are tried.</span>
<span class="term-fg31">-#   - If we succeed, we print out the assumptions from assumeFormula that</span>
<span class="term-fg31">-#     weren&#39;t implied by assumeLaw already. Those from assumeBranch are skipped,</span>
<span class="term-fg31">-#     as we assume that all constraints in it are complementary with each other.</span>
<span class="term-fg31">-#</span>
<span class="term-fg31">-# Based on the sage verification scripts used in the Explicit-Formulas Database</span>
<span class="term-fg31">-# by Tanja Lange and others, see http:&#47;&#47;hyperelliptic.org&#47;EFD</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-class fastfrac:</span>
<span class="term-fg31">-  &quot;&quot;&quot;Fractions over rings.&quot;&quot;&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  def __init__(self,R,top,bot=1):</span>
<span class="term-fg31">-    &quot;&quot;&quot;Construct a fractional, given a ring, a numerator, and denominator.&quot;&quot;&quot;</span>
<span class="term-fg31">-    self.R = R</span>
<span class="term-fg31">-    if parent(top) == ZZ or parent(top) == R:</span>
<span class="term-fg31">-      self.top = R(top)</span>
<span class="term-fg31">-      self.bot = R(bot)</span>
<span class="term-fg31">-    elif top.__class__ == fastfrac:</span>
<span class="term-fg31">-      self.top = top.top</span>
<span class="term-fg31">-      self.bot = top.bot * bot</span>
<span class="term-fg31">-    else:</span>
<span class="term-fg31">-      self.top = R(numerator(top))</span>
<span class="term-fg31">-      self.bot = R(denominator(top)) * bot</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  def iszero(self,I):</span>
<span class="term-fg31">-    &quot;&quot;&quot;Return whether this fraction is zero given an ideal.&quot;&quot;&quot;</span>
<span class="term-fg31">-    return self.top in I and self.bot not in I</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  def reduce(self,assumeZero):</span>
<span class="term-fg31">-    zero = self.R.ideal(map(numerator, assumeZero))</span>
<span class="term-fg31">-    return fastfrac(self.R, zero.reduce(self.top)) &#47; fastfrac(self.R, zero.reduce(self.bot))</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  def __add__(self,other):</span>
<span class="term-fg31">-    &quot;&quot;&quot;Add two fractions.&quot;&quot;&quot;</span>
<span class="term-fg31">-    if parent(other) == ZZ:</span>
<span class="term-fg31">-      return fastfrac(self.R,self.top + self.bot * other,self.bot)</span>
<span class="term-fg31">-    if other.__class__ == fastfrac:</span>
<span class="term-fg31">-      return fastfrac(self.R,self.top * other.bot + self.bot * other.top,self.bot * other.bot)</span>
<span class="term-fg31">-    return NotImplemented</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  def __sub__(self,other):</span>
<span class="term-fg31">-    &quot;&quot;&quot;Subtract two fractions.&quot;&quot;&quot;</span>
<span class="term-fg31">-    if parent(other) == ZZ:</span>
<span class="term-fg31">-      return fastfrac(self.R,self.top - self.bot * other,self.bot)</span>
<span class="term-fg31">-    if other.__class__ == fastfrac:</span>
<span class="term-fg31">-      return fastfrac(self.R,self.top * other.bot - self.bot * other.top,self.bot * other.bot)</span>
<span class="term-fg31">-    return NotImplemented</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  def __neg__(self):</span>
<span class="term-fg31">-    &quot;&quot;&quot;Return the negation of a fraction.&quot;&quot;&quot;</span>
<span class="term-fg31">-    return fastfrac(self.R,-self.top,self.bot)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  def __mul__(self,other):</span>
<span class="term-fg31">-    &quot;&quot;&quot;Multiply two fractions.&quot;&quot;&quot;</span>
<span class="term-fg31">-    if parent(other) == ZZ:</span>
<span class="term-fg31">-      return fastfrac(self.R,self.top * other,self.bot)</span>
<span class="term-fg31">-    if other.__class__ == fastfrac:</span>
<span class="term-fg31">-      return fastfrac(self.R,self.top * other.top,self.bot * other.bot)</span>
<span class="term-fg31">-    return NotImplemented</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  def __rmul__(self,other):</span>
<span class="term-fg31">-    &quot;&quot;&quot;Multiply something else with a fraction.&quot;&quot;&quot;</span>
<span class="term-fg31">-    return self.__mul__(other)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  def __div__(self,other):</span>
<span class="term-fg31">-    &quot;&quot;&quot;Divide two fractions.&quot;&quot;&quot;</span>
<span class="term-fg31">-    if parent(other) == ZZ:</span>
<span class="term-fg31">-      return fastfrac(self.R,self.top,self.bot * other)</span>
<span class="term-fg31">-    if other.__class__ == fastfrac:</span>
<span class="term-fg31">-      return fastfrac(self.R,self.top * other.bot,self.bot * other.top)</span>
<span class="term-fg31">-    return NotImplemented</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  def __pow__(self,other):</span>
<span class="term-fg31">-    &quot;&quot;&quot;Compute a power of a fraction.&quot;&quot;&quot;</span>
<span class="term-fg31">-    if parent(other) == ZZ:</span>
<span class="term-fg31">-      if other &lt; 0:</span>
<span class="term-fg31">-        # Negative powers require flipping top and bottom</span>
<span class="term-fg31">-        return fastfrac(self.R,self.bot ^ (-other),self.top ^ (-other))</span>
<span class="term-fg31">-      else:</span>
<span class="term-fg31">-        return fastfrac(self.R,self.top ^ other,self.bot ^ other)</span>
<span class="term-fg31">-    return NotImplemented</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  def __str__(self):</span>
<span class="term-fg31">-    return &quot;fastfrac((&quot; + str(self.top) + &quot;) &#47; (&quot; + str(self.bot) + &quot;))&quot;</span>
<span class="term-fg31">-  def __repr__(self):</span>
<span class="term-fg31">-    return &quot;%s&quot; % self</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  def numerator(self):</span>
<span class="term-fg31">-    return self.top</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-class constraints:</span>
<span class="term-fg31">-  &quot;&quot;&quot;A set of constraints, consisting of zero and nonzero expressions.</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  Constraints can either be used to express knowledge or a requirement.</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  Both the fields zero and nonzero are maps from expressions to description</span>
<span class="term-fg31">-  strings. The expressions that are the keys in zero are required to be zero,</span>
<span class="term-fg31">-  and the expressions that are the keys in nonzero are required to be nonzero.</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  Note that (a != 0) and (b != 0) is the same as (a*b != 0), so all keys in</span>
<span class="term-fg31">-  nonzero could be multiplied into a single key. This is often much less</span>
<span class="term-fg31">-  efficient to work with though, so we keep them separate inside the</span>
<span class="term-fg31">-  constraints. This allows higher-level code to do fast checks on the individual</span>
<span class="term-fg31">-  nonzero elements, or combine them if needed for stronger checks.</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  We can&#39;t multiply the different zero elements, as it would suffice for one of</span>
<span class="term-fg31">-  the factors to be zero, instead of all of them. Instead, the zero elements are</span>
<span class="term-fg31">-  typically combined into an ideal first.</span>
<span class="term-fg31">-  &quot;&quot;&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  def __init__(self, **kwargs):</span>
<span class="term-fg31">-    if &#39;zero&#39; in kwargs:</span>
<span class="term-fg31">-      self.zero = dict(kwargs[&#39;zero&#39;])</span>
<span class="term-fg31">-    else:</span>
<span class="term-fg31">-      self.zero = dict()</span>
<span class="term-fg31">-    if &#39;nonzero&#39; in kwargs:</span>
<span class="term-fg31">-      self.nonzero = dict(kwargs[&#39;nonzero&#39;])</span>
<span class="term-fg31">-    else:</span>
<span class="term-fg31">-      self.nonzero = dict()</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  def negate(self):</span>
<span class="term-fg31">-    return constraints(zero=self.nonzero, nonzero=self.zero)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  def __add__(self, other):</span>
<span class="term-fg31">-    zero = self.zero.copy()</span>
<span class="term-fg31">-    zero.update(other.zero)</span>
<span class="term-fg31">-    nonzero = self.nonzero.copy()</span>
<span class="term-fg31">-    nonzero.update(other.nonzero)</span>
<span class="term-fg31">-    return constraints(zero=zero, nonzero=nonzero)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  def __str__(self):</span>
<span class="term-fg31">-    return &quot;constraints(zero=%s,nonzero=%s)&quot; % (self.zero, self.nonzero)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  def __repr__(self):</span>
<span class="term-fg31">-    return &quot;%s&quot; % self</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-def conflicts(R, con):</span>
<span class="term-fg31">-  &quot;&quot;&quot;Check whether any of the passed non-zero assumptions is implied by the zero assumptions&quot;&quot;&quot;</span>
<span class="term-fg31">-  zero = R.ideal(map(numerator, con.zero))</span>
<span class="term-fg31">-  if 1 in zero:</span>
<span class="term-fg31">-    return True</span>
<span class="term-fg31">-  # First a cheap check whether any of the individual nonzero terms conflict on</span>
<span class="term-fg31">-  # their own.</span>
<span class="term-fg31">-  for nonzero in con.nonzero:</span>
<span class="term-fg31">-    if nonzero.iszero(zero):</span>
<span class="term-fg31">-      return True</span>
<span class="term-fg31">-  # It can be the case that entries in the nonzero set do not individually</span>
<span class="term-fg31">-  # conflict with the zero set, but their combination does. For example, knowing</span>
<span class="term-fg31">-  # that either x or y is zero is equivalent to having x*y in the zero set.</span>
<span class="term-fg31">-  # Having x or y individually in the nonzero set is not a conflict, but both</span>
<span class="term-fg31">-  # simultaneously is, so that is the right thing to check for.</span>
<span class="term-fg31">-  if reduce(lambda a,b: a * b, con.nonzero, fastfrac(R, 1)).iszero(zero):</span>
<span class="term-fg31">-    return True</span>
<span class="term-fg31">-  return False</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-def get_nonzero_set(R, assume):</span>
<span class="term-fg31">-  &quot;&quot;&quot;Calculate a simple set of nonzero expressions&quot;&quot;&quot;</span>
<span class="term-fg31">-  zero = R.ideal(map(numerator, assume.zero))</span>
<span class="term-fg31">-  nonzero = set()</span>
<span class="term-fg31">-  for nz in map(numerator, assume.nonzero):</span>
<span class="term-fg31">-    for (f,n) in nz.factor():</span>
<span class="term-fg31">-      nonzero.add(f)</span>
<span class="term-fg31">-    rnz = zero.reduce(nz)</span>
<span class="term-fg31">-    for (f,n) in rnz.factor():</span>
<span class="term-fg31">-      nonzero.add(f)</span>
<span class="term-fg31">-  return nonzero</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-def prove_nonzero(R, exprs, assume):</span>
<span class="term-fg31">-  &quot;&quot;&quot;Check whether an expression is provably nonzero, given assumptions&quot;&quot;&quot;</span>
<span class="term-fg31">-  zero = R.ideal(map(numerator, assume.zero))</span>
<span class="term-fg31">-  nonzero = get_nonzero_set(R, assume)</span>
<span class="term-fg31">-  expl = set()</span>
<span class="term-fg31">-  ok = True</span>
<span class="term-fg31">-  for expr in exprs:</span>
<span class="term-fg31">-    if numerator(expr) in zero:</span>
<span class="term-fg31">-      return (False, [exprs[expr]])</span>
<span class="term-fg31">-  allexprs = reduce(lambda a,b: numerator(a)*numerator(b), exprs, 1)</span>
<span class="term-fg31">-  for (f, n) in allexprs.factor():</span>
<span class="term-fg31">-    if f not in nonzero:</span>
<span class="term-fg31">-      ok = False</span>
<span class="term-fg31">-  if ok:</span>
<span class="term-fg31">-    return (True, None)</span>
<span class="term-fg31">-  ok = True</span>
<span class="term-fg31">-  for (f, n) in zero.reduce(numerator(allexprs)).factor():</span>
<span class="term-fg31">-    if f not in nonzero:</span>
<span class="term-fg31">-      ok = False</span>
<span class="term-fg31">-  if ok:</span>
<span class="term-fg31">-    return (True, None)</span>
<span class="term-fg31">-  ok = True</span>
<span class="term-fg31">-  for expr in exprs:</span>
<span class="term-fg31">-    for (f,n) in numerator(expr).factor():</span>
<span class="term-fg31">-      if f not in nonzero:</span>
<span class="term-fg31">-        ok = False</span>
<span class="term-fg31">-  if ok:</span>
<span class="term-fg31">-    return (True, None)</span>
<span class="term-fg31">-  ok = True</span>
<span class="term-fg31">-  for expr in exprs:</span>
<span class="term-fg31">-    for (f,n) in zero.reduce(numerator(expr)).factor():</span>
<span class="term-fg31">-      if f not in nonzero:</span>
<span class="term-fg31">-        expl.add(exprs[expr])</span>
<span class="term-fg31">-  if expl:</span>
<span class="term-fg31">-    return (False, list(expl))</span>
<span class="term-fg31">-  else:</span>
<span class="term-fg31">-    return (True, None)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-def prove_zero(R, exprs, assume):</span>
<span class="term-fg31">-  &quot;&quot;&quot;Check whether all of the passed expressions are provably zero, given assumptions&quot;&quot;&quot;</span>
<span class="term-fg31">-  r, e = prove_nonzero(R, dict(map(lambda x: (fastfrac(R, x.bot, 1), exprs[x]), exprs)), assume)</span>
<span class="term-fg31">-  if not r:</span>
<span class="term-fg31">-    return (False, map(lambda x: &quot;Possibly zero denominator: %s&quot; % x, e))</span>
<span class="term-fg31">-  zero = R.ideal(map(numerator, assume.zero))</span>
<span class="term-fg31">-  nonzero = prod(x for x in assume.nonzero)</span>
<span class="term-fg31">-  expl = []</span>
<span class="term-fg31">-  for expr in exprs:</span>
<span class="term-fg31">-    if not expr.iszero(zero):</span>
<span class="term-fg31">-      expl.append(exprs[expr])</span>
<span class="term-fg31">-  if not expl:</span>
<span class="term-fg31">-    return (True, None)</span>
<span class="term-fg31">-  return (False, expl)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-def describe_extra(R, assume, assumeExtra):</span>
<span class="term-fg31">-  &quot;&quot;&quot;Describe what assumptions are added, given existing assumptions&quot;&quot;&quot;</span>
<span class="term-fg31">-  zerox = assume.zero.copy()</span>
<span class="term-fg31">-  zerox.update(assumeExtra.zero)</span>
<span class="term-fg31">-  zero = R.ideal(map(numerator, assume.zero))</span>
<span class="term-fg31">-  zeroextra = R.ideal(map(numerator, zerox))</span>
<span class="term-fg31">-  nonzero = get_nonzero_set(R, assume)</span>
<span class="term-fg31">-  ret = set()</span>
<span class="term-fg31">-  # Iterate over the extra zero expressions</span>
<span class="term-fg31">-  for base in assumeExtra.zero:</span>
<span class="term-fg31">-    if base not in zero:</span>
<span class="term-fg31">-      add = []</span>
<span class="term-fg31">-      for (f, n) in numerator(base).factor():</span>
<span class="term-fg31">-        if f not in nonzero:</span>
<span class="term-fg31">-          add += [&quot;%s&quot; % f]</span>
<span class="term-fg31">-      if add:</span>
<span class="term-fg31">-        ret.add((&quot; * &quot;.join(add)) + &quot; = 0 [%s]&quot; % assumeExtra.zero[base])</span>
<span class="term-fg31">-  # Iterate over the extra nonzero expressions</span>
<span class="term-fg31">-  for nz in assumeExtra.nonzero:</span>
<span class="term-fg31">-    nzr = zeroextra.reduce(numerator(nz))</span>
<span class="term-fg31">-    if nzr not in zeroextra:</span>
<span class="term-fg31">-      for (f,n) in nzr.factor():</span>
<span class="term-fg31">-        if zeroextra.reduce(f) not in nonzero:</span>
<span class="term-fg31">-          ret.add(&quot;%s != 0&quot; % zeroextra.reduce(f))</span>
<span class="term-fg31">-  return &quot;, &quot;.join(x for x in ret)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-def check_symbolic(R, assumeLaw, assumeAssert, assumeBranch, require):</span>
<span class="term-fg31">-  &quot;&quot;&quot;Check a set of zero and nonzero requirements, given a set of zero and nonzero assumptions&quot;&quot;&quot;</span>
<span class="term-fg31">-  assume = assumeLaw + assumeAssert + assumeBranch</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  if conflicts(R, assume):</span>
<span class="term-fg31">-    # This formula does not apply</span>
<span class="term-fg31">-    return None</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  describe = describe_extra(R, assumeLaw + assumeBranch, assumeAssert)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  ok, msg = prove_zero(R, require.zero, assume)</span>
<span class="term-fg31">-  if not ok:</span>
<span class="term-fg31">-    return &quot;FAIL, %s fails (assuming %s)&quot; % (str(msg), describe)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  res, expl = prove_nonzero(R, require.nonzero, assume)</span>
<span class="term-fg31">-  if not res:</span>
<span class="term-fg31">-    return &quot;FAIL, %s fails (assuming %s)&quot; % (str(expl), describe)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  if describe != &quot;&quot;:</span>
<span class="term-fg31">-    return &quot;OK (assuming %s)&quot; % describe</span>
<span class="term-fg31">-  else:</span>
<span class="term-fg31">-    return &quot;OK&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-def concrete_verify(c):</span>
<span class="term-fg31">-  for k in c.zero:</span>
<span class="term-fg31">-    if k != 0:</span>
<span class="term-fg31">-      return (False, c.zero[k])</span>
<span class="term-fg31">-  for k in c.nonzero:</span>
<span class="term-fg31">-    if k == 0:</span>
<span class="term-fg31">-      return (False, c.nonzero[k])</span>
<span class="term-fg31">-  return (True, None)</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-10c1f7b4de8fc6ca9c848e64" role="button"
                       aria-expanded="false" aria-controls="id-10c1f7b4de8fc6ca9c848e64">
                        <code>crypto/secp256k1/libsecp256k1/sage/secp256k1.sage</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/sage/secp256k1.sage" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-306</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-10c1f7b4de8fc6ca9c848e64"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;sage&#47;secp256k1.sage op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;sage&#47;secp256k1.sage</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index a97e732f7fa3ab681a63070eda20455cda3a6c32..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;sage&#47;secp256k1.sage</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,306 +0,0 @@</span>
<span class="term-fg31">-# Test libsecp256k1&#39; group operation implementations using prover.sage</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-import sys</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-load(&quot;group_prover.sage&quot;)</span>
<span class="term-fg31">-load(&quot;weierstrass_prover.sage&quot;)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-def formula_secp256k1_gej_double_var(a):</span>
<span class="term-fg31">-  &quot;&quot;&quot;libsecp256k1&#39;s secp256k1_gej_double_var, used by various addition functions&quot;&quot;&quot;</span>
<span class="term-fg31">-  rz = a.Z * a.Y</span>
<span class="term-fg31">-  rz = rz * 2</span>
<span class="term-fg31">-  t1 = a.X^2</span>
<span class="term-fg31">-  t1 = t1 * 3</span>
<span class="term-fg31">-  t2 = t1^2</span>
<span class="term-fg31">-  t3 = a.Y^2</span>
<span class="term-fg31">-  t3 = t3 * 2</span>
<span class="term-fg31">-  t4 = t3^2</span>
<span class="term-fg31">-  t4 = t4 * 2</span>
<span class="term-fg31">-  t3 = t3 * a.X</span>
<span class="term-fg31">-  rx = t3</span>
<span class="term-fg31">-  rx = rx * 4</span>
<span class="term-fg31">-  rx = -rx</span>
<span class="term-fg31">-  rx = rx + t2</span>
<span class="term-fg31">-  t2 = -t2</span>
<span class="term-fg31">-  t3 = t3 * 6</span>
<span class="term-fg31">-  t3 = t3 + t2</span>
<span class="term-fg31">-  ry = t1 * t3</span>
<span class="term-fg31">-  t2 = -t4</span>
<span class="term-fg31">-  ry = ry + t2</span>
<span class="term-fg31">-  return jacobianpoint(rx, ry, rz)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-def formula_secp256k1_gej_add_var(branch, a, b):</span>
<span class="term-fg31">-  &quot;&quot;&quot;libsecp256k1&#39;s secp256k1_gej_add_var&quot;&quot;&quot;</span>
<span class="term-fg31">-  if branch == 0:</span>
<span class="term-fg31">-    return (constraints(), constraints(nonzero={a.Infinity : &#39;a_infinite&#39;}), b)</span>
<span class="term-fg31">-  if branch == 1:</span>
<span class="term-fg31">-    return (constraints(), constraints(zero={a.Infinity : &#39;a_finite&#39;}, nonzero={b.Infinity : &#39;b_infinite&#39;}), a)</span>
<span class="term-fg31">-  z22 = b.Z^2</span>
<span class="term-fg31">-  z12 = a.Z^2</span>
<span class="term-fg31">-  u1 = a.X * z22</span>
<span class="term-fg31">-  u2 = b.X * z12</span>
<span class="term-fg31">-  s1 = a.Y * z22</span>
<span class="term-fg31">-  s1 = s1 * b.Z</span>
<span class="term-fg31">-  s2 = b.Y * z12</span>
<span class="term-fg31">-  s2 = s2 * a.Z</span>
<span class="term-fg31">-  h = -u1</span>
<span class="term-fg31">-  h = h + u2</span>
<span class="term-fg31">-  i = -s1</span>
<span class="term-fg31">-  i = i + s2</span>
<span class="term-fg31">-  if branch == 2:</span>
<span class="term-fg31">-    r = formula_secp256k1_gej_double_var(a)</span>
<span class="term-fg31">-    return (constraints(), constraints(zero={h : &#39;h=0&#39;, i : &#39;i=0&#39;, a.Infinity : &#39;a_finite&#39;, b.Infinity : &#39;b_finite&#39;}), r)</span>
<span class="term-fg31">-  if branch == 3:</span>
<span class="term-fg31">-    return (constraints(), constraints(zero={h : &#39;h=0&#39;, a.Infinity : &#39;a_finite&#39;, b.Infinity : &#39;b_finite&#39;}, nonzero={i : &#39;i!=0&#39;}), point_at_infinity())</span>
<span class="term-fg31">-  i2 = i^2</span>
<span class="term-fg31">-  h2 = h^2</span>
<span class="term-fg31">-  h3 = h2 * h</span>
<span class="term-fg31">-  h = h * b.Z</span>
<span class="term-fg31">-  rz = a.Z * h</span>
<span class="term-fg31">-  t = u1 * h2</span>
<span class="term-fg31">-  rx = t</span>
<span class="term-fg31">-  rx = rx * 2</span>
<span class="term-fg31">-  rx = rx + h3</span>
<span class="term-fg31">-  rx = -rx</span>
<span class="term-fg31">-  rx = rx + i2</span>
<span class="term-fg31">-  ry = -rx</span>
<span class="term-fg31">-  ry = ry + t</span>
<span class="term-fg31">-  ry = ry * i</span>
<span class="term-fg31">-  h3 = h3 * s1</span>
<span class="term-fg31">-  h3 = -h3</span>
<span class="term-fg31">-  ry = ry + h3</span>
<span class="term-fg31">-  return (constraints(), constraints(zero={a.Infinity : &#39;a_finite&#39;, b.Infinity : &#39;b_finite&#39;}, nonzero={h : &#39;h!=0&#39;}), jacobianpoint(rx, ry, rz))</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-def formula_secp256k1_gej_add_ge_var(branch, a, b):</span>
<span class="term-fg31">-  &quot;&quot;&quot;libsecp256k1&#39;s secp256k1_gej_add_ge_var, which assume bz==1&quot;&quot;&quot;</span>
<span class="term-fg31">-  if branch == 0:</span>
<span class="term-fg31">-    return (constraints(zero={b.Z - 1 : &#39;b.z=1&#39;}), constraints(nonzero={a.Infinity : &#39;a_infinite&#39;}), b)</span>
<span class="term-fg31">-  if branch == 1:</span>
<span class="term-fg31">-    return (constraints(zero={b.Z - 1 : &#39;b.z=1&#39;}), constraints(zero={a.Infinity : &#39;a_finite&#39;}, nonzero={b.Infinity : &#39;b_infinite&#39;}), a)</span>
<span class="term-fg31">-  z12 = a.Z^2</span>
<span class="term-fg31">-  u1 = a.X</span>
<span class="term-fg31">-  u2 = b.X * z12</span>
<span class="term-fg31">-  s1 = a.Y</span>
<span class="term-fg31">-  s2 = b.Y * z12</span>
<span class="term-fg31">-  s2 = s2 * a.Z</span>
<span class="term-fg31">-  h = -u1</span>
<span class="term-fg31">-  h = h + u2</span>
<span class="term-fg31">-  i = -s1</span>
<span class="term-fg31">-  i = i + s2</span>
<span class="term-fg31">-  if (branch == 2):</span>
<span class="term-fg31">-    r = formula_secp256k1_gej_double_var(a)</span>
<span class="term-fg31">-    return (constraints(zero={b.Z - 1 : &#39;b.z=1&#39;}), constraints(zero={a.Infinity : &#39;a_finite&#39;, b.Infinity : &#39;b_finite&#39;, h : &#39;h=0&#39;, i : &#39;i=0&#39;}), r)</span>
<span class="term-fg31">-  if (branch == 3):</span>
<span class="term-fg31">-    return (constraints(zero={b.Z - 1 : &#39;b.z=1&#39;}), constraints(zero={a.Infinity : &#39;a_finite&#39;, b.Infinity : &#39;b_finite&#39;, h : &#39;h=0&#39;}, nonzero={i : &#39;i!=0&#39;}), point_at_infinity())</span>
<span class="term-fg31">-  i2 = i^2</span>
<span class="term-fg31">-  h2 = h^2</span>
<span class="term-fg31">-  h3 = h * h2</span>
<span class="term-fg31">-  rz = a.Z * h</span>
<span class="term-fg31">-  t = u1 * h2</span>
<span class="term-fg31">-  rx = t</span>
<span class="term-fg31">-  rx = rx * 2</span>
<span class="term-fg31">-  rx = rx + h3</span>
<span class="term-fg31">-  rx = -rx</span>
<span class="term-fg31">-  rx = rx + i2</span>
<span class="term-fg31">-  ry = -rx</span>
<span class="term-fg31">-  ry = ry + t</span>
<span class="term-fg31">-  ry = ry * i</span>
<span class="term-fg31">-  h3 = h3 * s1</span>
<span class="term-fg31">-  h3 = -h3</span>
<span class="term-fg31">-  ry = ry + h3</span>
<span class="term-fg31">-  return (constraints(zero={b.Z - 1 : &#39;b.z=1&#39;}), constraints(zero={a.Infinity : &#39;a_finite&#39;, b.Infinity : &#39;b_finite&#39;}, nonzero={h : &#39;h!=0&#39;}), jacobianpoint(rx, ry, rz))</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-def formula_secp256k1_gej_add_zinv_var(branch, a, b):</span>
<span class="term-fg31">-  &quot;&quot;&quot;libsecp256k1&#39;s secp256k1_gej_add_zinv_var&quot;&quot;&quot;</span>
<span class="term-fg31">-  bzinv = b.Z^(-1)</span>
<span class="term-fg31">-  if branch == 0:</span>
<span class="term-fg31">-    return (constraints(), constraints(nonzero={b.Infinity : &#39;b_infinite&#39;}), a)</span>
<span class="term-fg31">-  if branch == 1:</span>
<span class="term-fg31">-    bzinv2 = bzinv^2</span>
<span class="term-fg31">-    bzinv3 = bzinv2 * bzinv</span>
<span class="term-fg31">-    rx = b.X * bzinv2</span>
<span class="term-fg31">-    ry = b.Y * bzinv3</span>
<span class="term-fg31">-    rz = 1</span>
<span class="term-fg31">-    return (constraints(), constraints(zero={b.Infinity : &#39;b_finite&#39;}, nonzero={a.Infinity : &#39;a_infinite&#39;}), jacobianpoint(rx, ry, rz))</span>
<span class="term-fg31">-  azz = a.Z * bzinv</span>
<span class="term-fg31">-  z12 = azz^2</span>
<span class="term-fg31">-  u1 = a.X</span>
<span class="term-fg31">-  u2 = b.X * z12</span>
<span class="term-fg31">-  s1 = a.Y</span>
<span class="term-fg31">-  s2 = b.Y * z12</span>
<span class="term-fg31">-  s2 = s2 * azz</span>
<span class="term-fg31">-  h = -u1</span>
<span class="term-fg31">-  h = h + u2</span>
<span class="term-fg31">-  i = -s1</span>
<span class="term-fg31">-  i = i + s2</span>
<span class="term-fg31">-  if branch == 2:</span>
<span class="term-fg31">-    r = formula_secp256k1_gej_double_var(a)</span>
<span class="term-fg31">-    return (constraints(), constraints(zero={a.Infinity : &#39;a_finite&#39;, b.Infinity : &#39;b_finite&#39;, h : &#39;h=0&#39;, i : &#39;i=0&#39;}), r)</span>
<span class="term-fg31">-  if branch == 3:</span>
<span class="term-fg31">-    return (constraints(), constraints(zero={a.Infinity : &#39;a_finite&#39;, b.Infinity : &#39;b_finite&#39;, h : &#39;h=0&#39;}, nonzero={i : &#39;i!=0&#39;}), point_at_infinity())</span>
<span class="term-fg31">-  i2 = i^2</span>
<span class="term-fg31">-  h2 = h^2</span>
<span class="term-fg31">-  h3 = h * h2</span>
<span class="term-fg31">-  rz = a.Z</span>
<span class="term-fg31">-  rz = rz * h</span>
<span class="term-fg31">-  t = u1 * h2</span>
<span class="term-fg31">-  rx = t</span>
<span class="term-fg31">-  rx = rx * 2</span>
<span class="term-fg31">-  rx = rx + h3</span>
<span class="term-fg31">-  rx = -rx</span>
<span class="term-fg31">-  rx = rx + i2</span>
<span class="term-fg31">-  ry = -rx</span>
<span class="term-fg31">-  ry = ry + t</span>
<span class="term-fg31">-  ry = ry * i</span>
<span class="term-fg31">-  h3 = h3 * s1</span>
<span class="term-fg31">-  h3 = -h3</span>
<span class="term-fg31">-  ry = ry + h3</span>
<span class="term-fg31">-  return (constraints(), constraints(zero={a.Infinity : &#39;a_finite&#39;, b.Infinity : &#39;b_finite&#39;}, nonzero={h : &#39;h!=0&#39;}), jacobianpoint(rx, ry, rz))</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-def formula_secp256k1_gej_add_ge(branch, a, b):</span>
<span class="term-fg31">-  &quot;&quot;&quot;libsecp256k1&#39;s secp256k1_gej_add_ge&quot;&quot;&quot;</span>
<span class="term-fg31">-  zeroes = {}</span>
<span class="term-fg31">-  nonzeroes = {}</span>
<span class="term-fg31">-  a_infinity = False</span>
<span class="term-fg31">-  if (branch &amp; 4) != 0:</span>
<span class="term-fg31">-    nonzeroes.update({a.Infinity : &#39;a_infinite&#39;})</span>
<span class="term-fg31">-    a_infinity = True</span>
<span class="term-fg31">-  else:</span>
<span class="term-fg31">-    zeroes.update({a.Infinity : &#39;a_finite&#39;})</span>
<span class="term-fg31">-  zz = a.Z^2</span>
<span class="term-fg31">-  u1 = a.X</span>
<span class="term-fg31">-  u2 = b.X * zz</span>
<span class="term-fg31">-  s1 = a.Y</span>
<span class="term-fg31">-  s2 = b.Y * zz</span>
<span class="term-fg31">-  s2 = s2 * a.Z</span>
<span class="term-fg31">-  t = u1</span>
<span class="term-fg31">-  t = t + u2</span>
<span class="term-fg31">-  m = s1</span>
<span class="term-fg31">-  m = m + s2</span>
<span class="term-fg31">-  rr = t^2</span>
<span class="term-fg31">-  m_alt = -u2</span>
<span class="term-fg31">-  tt = u1 * m_alt</span>
<span class="term-fg31">-  rr = rr + tt</span>
<span class="term-fg31">-  degenerate = (branch &amp; 3) == 3</span>
<span class="term-fg31">-  if (branch &amp; 1) != 0:</span>
<span class="term-fg31">-    zeroes.update({m : &#39;m_zero&#39;})</span>
<span class="term-fg31">-  else:</span>
<span class="term-fg31">-    nonzeroes.update({m : &#39;m_nonzero&#39;})</span>
<span class="term-fg31">-  if (branch &amp; 2) != 0:</span>
<span class="term-fg31">-    zeroes.update({rr : &#39;rr_zero&#39;})</span>
<span class="term-fg31">-  else:</span>
<span class="term-fg31">-    nonzeroes.update({rr : &#39;rr_nonzero&#39;})</span>
<span class="term-fg31">-  rr_alt = s1</span>
<span class="term-fg31">-  rr_alt = rr_alt * 2</span>
<span class="term-fg31">-  m_alt = m_alt + u1</span>
<span class="term-fg31">-  if not degenerate:</span>
<span class="term-fg31">-    rr_alt = rr</span>
<span class="term-fg31">-    m_alt = m</span>
<span class="term-fg31">-  n = m_alt^2</span>
<span class="term-fg31">-  q = n * t</span>
<span class="term-fg31">-  n = n^2</span>
<span class="term-fg31">-  if degenerate:</span>
<span class="term-fg31">-    n = m</span>
<span class="term-fg31">-  t = rr_alt^2</span>
<span class="term-fg31">-  rz = a.Z * m_alt</span>
<span class="term-fg31">-  infinity = False</span>
<span class="term-fg31">-  if (branch &amp; 8) != 0:</span>
<span class="term-fg31">-    if not a_infinity:</span>
<span class="term-fg31">-      infinity = True</span>
<span class="term-fg31">-    zeroes.update({rz : &#39;r.z=0&#39;})</span>
<span class="term-fg31">-  else:</span>
<span class="term-fg31">-    nonzeroes.update({rz : &#39;r.z!=0&#39;})</span>
<span class="term-fg31">-  rz = rz * 2</span>
<span class="term-fg31">-  q = -q</span>
<span class="term-fg31">-  t = t + q</span>
<span class="term-fg31">-  rx = t</span>
<span class="term-fg31">-  t = t * 2</span>
<span class="term-fg31">-  t = t + q</span>
<span class="term-fg31">-  t = t * rr_alt</span>
<span class="term-fg31">-  t = t + n</span>
<span class="term-fg31">-  ry = -t</span>
<span class="term-fg31">-  rx = rx * 4</span>
<span class="term-fg31">-  ry = ry * 4</span>
<span class="term-fg31">-  if a_infinity:</span>
<span class="term-fg31">-    rx = b.X</span>
<span class="term-fg31">-    ry = b.Y</span>
<span class="term-fg31">-    rz = 1</span>
<span class="term-fg31">-  if infinity:</span>
<span class="term-fg31">-    return (constraints(zero={b.Z - 1 : &#39;b.z=1&#39;, b.Infinity : &#39;b_finite&#39;}), constraints(zero=zeroes, nonzero=nonzeroes), point_at_infinity())</span>
<span class="term-fg31">-  return (constraints(zero={b.Z - 1 : &#39;b.z=1&#39;, b.Infinity : &#39;b_finite&#39;}), constraints(zero=zeroes, nonzero=nonzeroes), jacobianpoint(rx, ry, rz))</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-def formula_secp256k1_gej_add_ge_old(branch, a, b):</span>
<span class="term-fg31">-  &quot;&quot;&quot;libsecp256k1&#39;s old secp256k1_gej_add_ge, which fails when ay+by=0 but ax!=bx&quot;&quot;&quot;</span>
<span class="term-fg31">-  a_infinity = (branch &amp; 1) != 0</span>
<span class="term-fg31">-  zero = {}</span>
<span class="term-fg31">-  nonzero = {}</span>
<span class="term-fg31">-  if a_infinity:</span>
<span class="term-fg31">-    nonzero.update({a.Infinity : &#39;a_infinite&#39;})</span>
<span class="term-fg31">-  else:</span>
<span class="term-fg31">-    zero.update({a.Infinity : &#39;a_finite&#39;})</span>
<span class="term-fg31">-  zz = a.Z^2</span>
<span class="term-fg31">-  u1 = a.X</span>
<span class="term-fg31">-  u2 = b.X * zz</span>
<span class="term-fg31">-  s1 = a.Y</span>
<span class="term-fg31">-  s2 = b.Y * zz</span>
<span class="term-fg31">-  s2 = s2 * a.Z</span>
<span class="term-fg31">-  z = a.Z</span>
<span class="term-fg31">-  t = u1</span>
<span class="term-fg31">-  t = t + u2</span>
<span class="term-fg31">-  m = s1</span>
<span class="term-fg31">-  m = m + s2</span>
<span class="term-fg31">-  n = m^2</span>
<span class="term-fg31">-  q = n * t</span>
<span class="term-fg31">-  n = n^2</span>
<span class="term-fg31">-  rr = t^2</span>
<span class="term-fg31">-  t = u1 * u2</span>
<span class="term-fg31">-  t = -t</span>
<span class="term-fg31">-  rr = rr + t</span>
<span class="term-fg31">-  t = rr^2</span>
<span class="term-fg31">-  rz = m * z</span>
<span class="term-fg31">-  infinity = False</span>
<span class="term-fg31">-  if (branch &amp; 2) != 0:</span>
<span class="term-fg31">-    if not a_infinity:</span>
<span class="term-fg31">-      infinity = True</span>
<span class="term-fg31">-    else:</span>
<span class="term-fg31">-      return (constraints(zero={b.Z - 1 : &#39;b.z=1&#39;, b.Infinity : &#39;b_finite&#39;}), constraints(nonzero={z : &#39;conflict_a&#39;}, zero={z : &#39;conflict_b&#39;}), point_at_infinity())</span>
<span class="term-fg31">-    zero.update({rz : &#39;r.z=0&#39;})</span>
<span class="term-fg31">-  else:</span>
<span class="term-fg31">-    nonzero.update({rz : &#39;r.z!=0&#39;})</span>
<span class="term-fg31">-  rz = rz * (0 if a_infinity else 2)</span>
<span class="term-fg31">-  rx = t</span>
<span class="term-fg31">-  q = -q</span>
<span class="term-fg31">-  rx = rx + q</span>
<span class="term-fg31">-  q = q * 3</span>
<span class="term-fg31">-  t = t * 2</span>
<span class="term-fg31">-  t = t + q</span>
<span class="term-fg31">-  t = t * rr</span>
<span class="term-fg31">-  t = t + n</span>
<span class="term-fg31">-  ry = -t</span>
<span class="term-fg31">-  rx = rx * (0 if a_infinity else 4)</span>
<span class="term-fg31">-  ry = ry * (0 if a_infinity else 4)</span>
<span class="term-fg31">-  t = b.X</span>
<span class="term-fg31">-  t = t * (1 if a_infinity else 0)</span>
<span class="term-fg31">-  rx = rx + t</span>
<span class="term-fg31">-  t = b.Y</span>
<span class="term-fg31">-  t = t * (1 if a_infinity else 0)</span>
<span class="term-fg31">-  ry = ry + t</span>
<span class="term-fg31">-  t = (1 if a_infinity else 0)</span>
<span class="term-fg31">-  rz = rz + t</span>
<span class="term-fg31">-  if infinity:</span>
<span class="term-fg31">-    return (constraints(zero={b.Z - 1 : &#39;b.z=1&#39;, b.Infinity : &#39;b_finite&#39;}), constraints(zero=zero, nonzero=nonzero), point_at_infinity())</span>
<span class="term-fg31">-  return (constraints(zero={b.Z - 1 : &#39;b.z=1&#39;, b.Infinity : &#39;b_finite&#39;}), constraints(zero=zero, nonzero=nonzero), jacobianpoint(rx, ry, rz))</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-if __name__ == &quot;__main__&quot;:</span>
<span class="term-fg31">-  check_symbolic_jacobian_weierstrass(&quot;secp256k1_gej_add_var&quot;, 0, 7, 5, formula_secp256k1_gej_add_var)</span>
<span class="term-fg31">-  check_symbolic_jacobian_weierstrass(&quot;secp256k1_gej_add_ge_var&quot;, 0, 7, 5, formula_secp256k1_gej_add_ge_var)</span>
<span class="term-fg31">-  check_symbolic_jacobian_weierstrass(&quot;secp256k1_gej_add_zinv_var&quot;, 0, 7, 5, formula_secp256k1_gej_add_zinv_var)</span>
<span class="term-fg31">-  check_symbolic_jacobian_weierstrass(&quot;secp256k1_gej_add_ge&quot;, 0, 7, 16, formula_secp256k1_gej_add_ge)</span>
<span class="term-fg31">-  check_symbolic_jacobian_weierstrass(&quot;secp256k1_gej_add_ge_old [should fail]&quot;, 0, 7, 4, formula_secp256k1_gej_add_ge_old)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  if len(sys.argv) &gt;= 2 and sys.argv[1] == &quot;--exhaustive&quot;:</span>
<span class="term-fg31">-    check_exhaustive_jacobian_weierstrass(&quot;secp256k1_gej_add_var&quot;, 0, 7, 5, formula_secp256k1_gej_add_var, 43)</span>
<span class="term-fg31">-    check_exhaustive_jacobian_weierstrass(&quot;secp256k1_gej_add_ge_var&quot;, 0, 7, 5, formula_secp256k1_gej_add_ge_var, 43)</span>
<span class="term-fg31">-    check_exhaustive_jacobian_weierstrass(&quot;secp256k1_gej_add_zinv_var&quot;, 0, 7, 5, formula_secp256k1_gej_add_zinv_var, 43)</span>
<span class="term-fg31">-    check_exhaustive_jacobian_weierstrass(&quot;secp256k1_gej_add_ge&quot;, 0, 7, 16, formula_secp256k1_gej_add_ge, 43)</span>
<span class="term-fg31">-    check_exhaustive_jacobian_weierstrass(&quot;secp256k1_gej_add_ge_old [should fail]&quot;, 0, 7, 4, formula_secp256k1_gej_add_ge_old, 43)</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-db0739800a6befb0c5cb4c41" role="button"
                       aria-expanded="false" aria-controls="id-db0739800a6befb0c5cb4c41">
                        <code>crypto/secp256k1/libsecp256k1/sage/weierstrass_prover.sage</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/sage/weierstrass_prover.sage" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-264</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-db0739800a6befb0c5cb4c41"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;sage&#47;weierstrass_prover.sage op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;sage&#47;weierstrass_prover.sage</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 03ef2ec901ea9cafa47b4ccdce7bbba61279930f..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;sage&#47;weierstrass_prover.sage</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,264 +0,0 @@</span>
<span class="term-fg31">-# Prover implementation for Weierstrass curves of the form</span>
<span class="term-fg31">-# y^2 = x^3 + A * x + B, specifically with a = 0 and b = 7, with group laws</span>
<span class="term-fg31">-# operating on affine and Jacobian coordinates, including the point at infinity</span>
<span class="term-fg31">-# represented by a 4th variable in coordinates.</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-load(&quot;group_prover.sage&quot;)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-class affinepoint:</span>
<span class="term-fg31">-  def __init__(self, x, y, infinity=0):</span>
<span class="term-fg31">-    self.x = x</span>
<span class="term-fg31">-    self.y = y</span>
<span class="term-fg31">-    self.infinity = infinity</span>
<span class="term-fg31">-  def __str__(self):</span>
<span class="term-fg31">-    return &quot;affinepoint(x=%s,y=%s,inf=%s)&quot; % (self.x, self.y, self.infinity)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-class jacobianpoint:</span>
<span class="term-fg31">-  def __init__(self, x, y, z, infinity=0):</span>
<span class="term-fg31">-    self.X = x</span>
<span class="term-fg31">-    self.Y = y</span>
<span class="term-fg31">-    self.Z = z</span>
<span class="term-fg31">-    self.Infinity = infinity</span>
<span class="term-fg31">-  def __str__(self):</span>
<span class="term-fg31">-    return &quot;jacobianpoint(X=%s,Y=%s,Z=%s,inf=%s)&quot; % (self.X, self.Y, self.Z, self.Infinity)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-def point_at_infinity():</span>
<span class="term-fg31">-  return jacobianpoint(1, 1, 1, 1)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-def negate(p):</span>
<span class="term-fg31">-  if p.__class__ == affinepoint:</span>
<span class="term-fg31">-    return affinepoint(p.x, -p.y)</span>
<span class="term-fg31">-  if p.__class__ == jacobianpoint:</span>
<span class="term-fg31">-    return jacobianpoint(p.X, -p.Y, p.Z)</span>
<span class="term-fg31">-  assert(False)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-def on_weierstrass_curve(A, B, p):</span>
<span class="term-fg31">-  &quot;&quot;&quot;Return a set of zero-expressions for an affine point to be on the curve&quot;&quot;&quot;</span>
<span class="term-fg31">-  return constraints(zero={p.x^3 + A*p.x + B - p.y^2: &#39;on_curve&#39;})</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-def tangential_to_weierstrass_curve(A, B, p12, p3):</span>
<span class="term-fg31">-  &quot;&quot;&quot;Return a set of zero-expressions for ((x12,y12),(x3,y3)) to be a line that is tangential to the curve at (x12,y12)&quot;&quot;&quot;</span>
<span class="term-fg31">-  return constraints(zero={</span>
<span class="term-fg31">-    (p12.y - p3.y) * (p12.y * 2) - (p12.x^2 * 3 + A) * (p12.x - p3.x): &#39;tangential_to_curve&#39;</span>
<span class="term-fg31">-  })</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-def colinear(p1, p2, p3):</span>
<span class="term-fg31">-  &quot;&quot;&quot;Return a set of zero-expressions for ((x1,y1),(x2,y2),(x3,y3)) to be collinear&quot;&quot;&quot;</span>
<span class="term-fg31">-  return constraints(zero={</span>
<span class="term-fg31">-    (p1.y - p2.y) * (p1.x - p3.x) - (p1.y - p3.y) * (p1.x - p2.x): &#39;colinear_1&#39;,</span>
<span class="term-fg31">-    (p2.y - p3.y) * (p2.x - p1.x) - (p2.y - p1.y) * (p2.x - p3.x): &#39;colinear_2&#39;,</span>
<span class="term-fg31">-    (p3.y - p1.y) * (p3.x - p2.x) - (p3.y - p2.y) * (p3.x - p1.x): &#39;colinear_3&#39;</span>
<span class="term-fg31">-  })</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-def good_affine_point(p):</span>
<span class="term-fg31">-  return constraints(nonzero={p.x : &#39;nonzero_x&#39;, p.y : &#39;nonzero_y&#39;})</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-def good_jacobian_point(p):</span>
<span class="term-fg31">-  return constraints(nonzero={p.X : &#39;nonzero_X&#39;, p.Y : &#39;nonzero_Y&#39;, p.Z^6 : &#39;nonzero_Z&#39;})</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-def good_point(p):</span>
<span class="term-fg31">-  return constraints(nonzero={p.Z^6 : &#39;nonzero_X&#39;})</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-def finite(p, *affine_fns):</span>
<span class="term-fg31">-  con = good_point(p) + constraints(zero={p.Infinity : &#39;finite_point&#39;})</span>
<span class="term-fg31">-  if p.Z != 0:</span>
<span class="term-fg31">-    return con + reduce(lambda a, b: a + b, (f(affinepoint(p.X &#47; p.Z^2, p.Y &#47; p.Z^3)) for f in affine_fns), con)</span>
<span class="term-fg31">-  else:</span>
<span class="term-fg31">-    return con</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-def infinite(p):</span>
<span class="term-fg31">-  return constraints(nonzero={p.Infinity : &#39;infinite_point&#39;})</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-def law_jacobian_weierstrass_add(A, B, pa, pb, pA, pB, pC):</span>
<span class="term-fg31">-  &quot;&quot;&quot;Check whether the passed set of coordinates is a valid Jacobian add, given assumptions&quot;&quot;&quot;</span>
<span class="term-fg31">-  assumeLaw = (good_affine_point(pa) +</span>
<span class="term-fg31">-               good_affine_point(pb) +</span>
<span class="term-fg31">-               good_jacobian_point(pA) +</span>
<span class="term-fg31">-               good_jacobian_point(pB) +</span>
<span class="term-fg31">-               on_weierstrass_curve(A, B, pa) +</span>
<span class="term-fg31">-               on_weierstrass_curve(A, B, pb) +</span>
<span class="term-fg31">-               finite(pA) +</span>
<span class="term-fg31">-               finite(pB) +</span>
<span class="term-fg31">-               constraints(nonzero={pa.x - pb.x : &#39;different_x&#39;}))</span>
<span class="term-fg31">-  require = (finite(pC, lambda pc: on_weierstrass_curve(A, B, pc) +</span>
<span class="term-fg31">-             colinear(pa, pb, negate(pc))))</span>
<span class="term-fg31">-  return (assumeLaw, require)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-def law_jacobian_weierstrass_double(A, B, pa, pb, pA, pB, pC):</span>
<span class="term-fg31">-  &quot;&quot;&quot;Check whether the passed set of coordinates is a valid Jacobian doubling, given assumptions&quot;&quot;&quot;</span>
<span class="term-fg31">-  assumeLaw = (good_affine_point(pa) +</span>
<span class="term-fg31">-               good_affine_point(pb) +</span>
<span class="term-fg31">-               good_jacobian_point(pA) +</span>
<span class="term-fg31">-               good_jacobian_point(pB) +</span>
<span class="term-fg31">-               on_weierstrass_curve(A, B, pa) +</span>
<span class="term-fg31">-               on_weierstrass_curve(A, B, pb) +</span>
<span class="term-fg31">-               finite(pA) +</span>
<span class="term-fg31">-               finite(pB) +</span>
<span class="term-fg31">-               constraints(zero={pa.x - pb.x : &#39;equal_x&#39;, pa.y - pb.y : &#39;equal_y&#39;}))</span>
<span class="term-fg31">-  require = (finite(pC, lambda pc: on_weierstrass_curve(A, B, pc) +</span>
<span class="term-fg31">-             tangential_to_weierstrass_curve(A, B, pa, negate(pc))))</span>
<span class="term-fg31">-  return (assumeLaw, require)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-def law_jacobian_weierstrass_add_opposites(A, B, pa, pb, pA, pB, pC):</span>
<span class="term-fg31">-  assumeLaw = (good_affine_point(pa) +</span>
<span class="term-fg31">-               good_affine_point(pb) +</span>
<span class="term-fg31">-               good_jacobian_point(pA) +</span>
<span class="term-fg31">-               good_jacobian_point(pB) +</span>
<span class="term-fg31">-               on_weierstrass_curve(A, B, pa) +</span>
<span class="term-fg31">-               on_weierstrass_curve(A, B, pb) +</span>
<span class="term-fg31">-               finite(pA) +</span>
<span class="term-fg31">-               finite(pB) +</span>
<span class="term-fg31">-               constraints(zero={pa.x - pb.x : &#39;equal_x&#39;, pa.y + pb.y : &#39;opposite_y&#39;}))</span>
<span class="term-fg31">-  require = infinite(pC)</span>
<span class="term-fg31">-  return (assumeLaw, require)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-def law_jacobian_weierstrass_add_infinite_a(A, B, pa, pb, pA, pB, pC):</span>
<span class="term-fg31">-  assumeLaw = (good_affine_point(pa) +</span>
<span class="term-fg31">-               good_affine_point(pb) +</span>
<span class="term-fg31">-               good_jacobian_point(pA) +</span>
<span class="term-fg31">-               good_jacobian_point(pB) +</span>
<span class="term-fg31">-               on_weierstrass_curve(A, B, pb) +</span>
<span class="term-fg31">-               infinite(pA) +</span>
<span class="term-fg31">-               finite(pB))</span>
<span class="term-fg31">-  require = finite(pC, lambda pc: constraints(zero={pc.x - pb.x : &#39;c.x=b.x&#39;, pc.y - pb.y : &#39;c.y=b.y&#39;}))</span>
<span class="term-fg31">-  return (assumeLaw, require)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-def law_jacobian_weierstrass_add_infinite_b(A, B, pa, pb, pA, pB, pC):</span>
<span class="term-fg31">-  assumeLaw = (good_affine_point(pa) +</span>
<span class="term-fg31">-               good_affine_point(pb) +</span>
<span class="term-fg31">-               good_jacobian_point(pA) +</span>
<span class="term-fg31">-               good_jacobian_point(pB) +</span>
<span class="term-fg31">-               on_weierstrass_curve(A, B, pa) +</span>
<span class="term-fg31">-               infinite(pB) +</span>
<span class="term-fg31">-               finite(pA))</span>
<span class="term-fg31">-  require = finite(pC, lambda pc: constraints(zero={pc.x - pa.x : &#39;c.x=a.x&#39;, pc.y - pa.y : &#39;c.y=a.y&#39;}))</span>
<span class="term-fg31">-  return (assumeLaw, require)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-def law_jacobian_weierstrass_add_infinite_ab(A, B, pa, pb, pA, pB, pC):</span>
<span class="term-fg31">-  assumeLaw = (good_affine_point(pa) +</span>
<span class="term-fg31">-               good_affine_point(pb) +</span>
<span class="term-fg31">-               good_jacobian_point(pA) +</span>
<span class="term-fg31">-               good_jacobian_point(pB) +</span>
<span class="term-fg31">-               infinite(pA) +</span>
<span class="term-fg31">-               infinite(pB))</span>
<span class="term-fg31">-  require = infinite(pC)</span>
<span class="term-fg31">-  return (assumeLaw, require)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-laws_jacobian_weierstrass = {</span>
<span class="term-fg31">-  &#39;add&#39;: law_jacobian_weierstrass_add,</span>
<span class="term-fg31">-  &#39;double&#39;: law_jacobian_weierstrass_double,</span>
<span class="term-fg31">-  &#39;add_opposite&#39;: law_jacobian_weierstrass_add_opposites,</span>
<span class="term-fg31">-  &#39;add_infinite_a&#39;: law_jacobian_weierstrass_add_infinite_a,</span>
<span class="term-fg31">-  &#39;add_infinite_b&#39;: law_jacobian_weierstrass_add_infinite_b,</span>
<span class="term-fg31">-  &#39;add_infinite_ab&#39;: law_jacobian_weierstrass_add_infinite_ab</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-def check_exhaustive_jacobian_weierstrass(name, A, B, branches, formula, p):</span>
<span class="term-fg31">-  &quot;&quot;&quot;Verify an implementation of addition of Jacobian points on a Weierstrass curve, by executing and validating the result for every possible addition in a prime field&quot;&quot;&quot;</span>
<span class="term-fg31">-  F = Integers(p)</span>
<span class="term-fg31">-  print &quot;Formula %s on Z%i:&quot; % (name, p)</span>
<span class="term-fg31">-  points = []</span>
<span class="term-fg31">-  for x in xrange(0, p):</span>
<span class="term-fg31">-    for y in xrange(0, p):</span>
<span class="term-fg31">-      point = affinepoint(F(x), F(y))</span>
<span class="term-fg31">-      r, e = concrete_verify(on_weierstrass_curve(A, B, point))</span>
<span class="term-fg31">-      if r:</span>
<span class="term-fg31">-        points.append(point)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  for za in xrange(1, p):</span>
<span class="term-fg31">-    for zb in xrange(1, p):</span>
<span class="term-fg31">-      for pa in points:</span>
<span class="term-fg31">-        for pb in points:</span>
<span class="term-fg31">-          for ia in xrange(2):</span>
<span class="term-fg31">-            for ib in xrange(2):</span>
<span class="term-fg31">-              pA = jacobianpoint(pa.x * F(za)^2, pa.y * F(za)^3, F(za), ia)</span>
<span class="term-fg31">-              pB = jacobianpoint(pb.x * F(zb)^2, pb.y * F(zb)^3, F(zb), ib)</span>
<span class="term-fg31">-              for branch in xrange(0, branches):</span>
<span class="term-fg31">-                assumeAssert, assumeBranch, pC = formula(branch, pA, pB)</span>
<span class="term-fg31">-                pC.X = F(pC.X)</span>
<span class="term-fg31">-                pC.Y = F(pC.Y)</span>
<span class="term-fg31">-                pC.Z = F(pC.Z)</span>
<span class="term-fg31">-                pC.Infinity = F(pC.Infinity)</span>
<span class="term-fg31">-                r, e = concrete_verify(assumeAssert + assumeBranch)</span>
<span class="term-fg31">-                if r:</span>
<span class="term-fg31">-                  match = False</span>
<span class="term-fg31">-                  for key in laws_jacobian_weierstrass:</span>
<span class="term-fg31">-                    assumeLaw, require = laws_jacobian_weierstrass[key](A, B, pa, pb, pA, pB, pC)</span>
<span class="term-fg31">-                    r, e = concrete_verify(assumeLaw)</span>
<span class="term-fg31">-                    if r:</span>
<span class="term-fg31">-                      if match:</span>
<span class="term-fg31">-                        print &quot;  multiple branches for (%s,%s,%s,%s) + (%s,%s,%s,%s)&quot; % (pA.X, pA.Y, pA.Z, pA.Infinity, pB.X, pB.Y, pB.Z, pB.Infinity)</span>
<span class="term-fg31">-                      else:</span>
<span class="term-fg31">-                        match = True</span>
<span class="term-fg31">-                      r, e = concrete_verify(require)</span>
<span class="term-fg31">-                      if not r:</span>
<span class="term-fg31">-                        print &quot;  failure in branch %i for (%s,%s,%s,%s) + (%s,%s,%s,%s) = (%s,%s,%s,%s): %s&quot; % (branch, pA.X, pA.Y, pA.Z, pA.Infinity, pB.X, pB.Y, pB.Z, pB.Infinity, pC.X, pC.Y, pC.Z, pC.Infinity, e)</span>
<span class="term-fg31">-  print</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-def check_symbolic_function(R, assumeAssert, assumeBranch, f, A, B, pa, pb, pA, pB, pC):</span>
<span class="term-fg31">-  assumeLaw, require = f(A, B, pa, pb, pA, pB, pC)</span>
<span class="term-fg31">-  return check_symbolic(R, assumeLaw, assumeAssert, assumeBranch, require)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-def check_symbolic_jacobian_weierstrass(name, A, B, branches, formula):</span>
<span class="term-fg31">-  &quot;&quot;&quot;Verify an implementation of addition of Jacobian points on a Weierstrass curve symbolically&quot;&quot;&quot;</span>
<span class="term-fg31">-  R.&lt;ax,bx,ay,by,Az,Bz,Ai,Bi&gt; = PolynomialRing(QQ,8,order=&#39;invlex&#39;)</span>
<span class="term-fg31">-  lift = lambda x: fastfrac(R,x)</span>
<span class="term-fg31">-  ax = lift(ax)</span>
<span class="term-fg31">-  ay = lift(ay)</span>
<span class="term-fg31">-  Az = lift(Az)</span>
<span class="term-fg31">-  bx = lift(bx)</span>
<span class="term-fg31">-  by = lift(by)</span>
<span class="term-fg31">-  Bz = lift(Bz)</span>
<span class="term-fg31">-  Ai = lift(Ai)</span>
<span class="term-fg31">-  Bi = lift(Bi)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  pa = affinepoint(ax, ay, Ai)</span>
<span class="term-fg31">-  pb = affinepoint(bx, by, Bi)</span>
<span class="term-fg31">-  pA = jacobianpoint(ax * Az^2, ay * Az^3, Az, Ai)</span>
<span class="term-fg31">-  pB = jacobianpoint(bx * Bz^2, by * Bz^3, Bz, Bi)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  res = {}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  for key in laws_jacobian_weierstrass:</span>
<span class="term-fg31">-    res[key] = []</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  print (&quot;Formula &quot; + name + &quot;:&quot;)</span>
<span class="term-fg31">-  count = 0</span>
<span class="term-fg31">-  for branch in xrange(branches):</span>
<span class="term-fg31">-    assumeFormula, assumeBranch, pC = formula(branch, pA, pB)</span>
<span class="term-fg31">-    pC.X = lift(pC.X)</span>
<span class="term-fg31">-    pC.Y = lift(pC.Y)</span>
<span class="term-fg31">-    pC.Z = lift(pC.Z)</span>
<span class="term-fg31">-    pC.Infinity = lift(pC.Infinity)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    for key in laws_jacobian_weierstrass:</span>
<span class="term-fg31">-      res[key].append((check_symbolic_function(R, assumeFormula, assumeBranch, laws_jacobian_weierstrass[key], A, B, pa, pb, pA, pB, pC), branch))</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  for key in res:</span>
<span class="term-fg31">-    print &quot;  %s:&quot; % key</span>
<span class="term-fg31">-    val = res[key]</span>
<span class="term-fg31">-    for x in val:</span>
<span class="term-fg31">-      if x[0] is not None:</span>
<span class="term-fg31">-        print &quot;    branch %i: %s&quot; % (x[1], x[0])</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  print</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-27d9548ce1542062fe2c69a9" role="button"
                       aria-expanded="false" aria-controls="id-27d9548ce1542062fe2c69a9">
                        <code>crypto/secp256k1/libsecp256k1/src/asm/field_10x26_arm.s</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/asm/field_10x26_arm.s" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-919</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-27d9548ce1542062fe2c69a9"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;asm&#47;field_10x26_arm.s op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;asm&#47;field_10x26_arm.s</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 5a9cc3ffcfdaf200779eea6082b5168e8311211c..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;asm&#47;field_10x26_arm.s</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,919 +0,0 @@</span>
<span class="term-fg31">-@ vim: set tabstop=8 softtabstop=8 shiftwidth=8 noexpandtab syntax=armasm:</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2014 Wladimir J. van der Laan                        *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-&#47;*</span>
<span class="term-fg31">-ARM implementation of field_10x26 inner loops.</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-Note:</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-- To avoid unnecessary loads and make use of available registers, two</span>
<span class="term-fg31">-  &#39;passes&#39; have every time been interleaved, with the odd passes accumulating c&#39; and d&#39; </span>
<span class="term-fg31">-  which will be added to c and d respectively in the even passes</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-*&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	.syntax unified</span>
<span class="term-fg31">-	.arch armv7-a</span>
<span class="term-fg31">-	@ eabi attributes - see readelf -A</span>
<span class="term-fg31">-	.eabi_attribute 8, 1  @ Tag_ARM_ISA_use = yes</span>
<span class="term-fg31">-	.eabi_attribute 9, 0  @ Tag_Thumb_ISA_use = no</span>
<span class="term-fg31">-	.eabi_attribute 10, 0 @ Tag_FP_arch = none</span>
<span class="term-fg31">-	.eabi_attribute 24, 1 @ Tag_ABI_align_needed = 8-byte</span>
<span class="term-fg31">-	.eabi_attribute 25, 1 @ Tag_ABI_align_preserved = 8-byte, except leaf SP</span>
<span class="term-fg31">-	.eabi_attribute 30, 2 @ Tag_ABI_optimization_goals = Aggressive Speed</span>
<span class="term-fg31">-	.eabi_attribute 34, 1 @ Tag_CPU_unaligned_access = v6</span>
<span class="term-fg31">-	.text</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	@ Field constants</span>
<span class="term-fg31">-	.set field_R0, 0x3d10</span>
<span class="term-fg31">-	.set field_R1, 0x400</span>
<span class="term-fg31">-	.set field_not_M, 0xfc000000	@ ~M = ~0x3ffffff</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	.align	2</span>
<span class="term-fg31">-	.global secp256k1_fe_mul_inner</span>
<span class="term-fg31">-	.type	secp256k1_fe_mul_inner, %function</span>
<span class="term-fg31">-	@ Arguments:</span>
<span class="term-fg31">-	@  r0  r      Restrict: can overlap with a, not with b</span>
<span class="term-fg31">-	@  r1  a</span>
<span class="term-fg31">-	@  r2  b</span>
<span class="term-fg31">-	@ Stack (total 4+10*4 = 44)</span>
<span class="term-fg31">-	@  sp + #0        saved &#39;r&#39; pointer</span>
<span class="term-fg31">-	@  sp + #4 + 4*X  t0,t1,t2,t3,t4,t5,t6,t7,u8,t9</span>
<span class="term-fg31">-secp256k1_fe_mul_inner:</span>
<span class="term-fg31">-	stmfd	sp!, {r4, r5, r6, r7, r8, r9, r10, r11, r14}</span>
<span class="term-fg31">-	sub	sp, sp, #48			@ frame=44 + alignment</span>
<span class="term-fg31">-	str     r0, [sp, #0]			@ save result address, we need it only at the end</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	&#47;******************************************</span>
<span class="term-fg31">-	 * Main computation code.</span>
<span class="term-fg31">-	 ******************************************</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	Allocation:</span>
<span class="term-fg31">-	    r0,r14,r7,r8   scratch</span>
<span class="term-fg31">-	    r1       a (pointer)</span>
<span class="term-fg31">-	    r2       b (pointer)</span>
<span class="term-fg31">-	    r3:r4    c</span>
<span class="term-fg31">-	    r5:r6    d</span>
<span class="term-fg31">-	    r11:r12  c&#39;</span>
<span class="term-fg31">-	    r9:r10   d&#39;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	Note: do not write to r[] here, it may overlap with a[]</span>
<span class="term-fg31">-	*&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	&#47;* A - interleaved with B *&#47;</span>
<span class="term-fg31">-	ldr	r7, [r1, #0*4]			@ a[0]</span>
<span class="term-fg31">-	ldr	r8, [r2, #9*4]			@ b[9]</span>
<span class="term-fg31">-	ldr	r0, [r1, #1*4]			@ a[1]</span>
<span class="term-fg31">-	umull	r5, r6, r7, r8			@ d = a[0] * b[9]</span>
<span class="term-fg31">-	ldr	r14, [r2, #8*4]			@ b[8]</span>
<span class="term-fg31">-	umull	r9, r10, r0, r8			@ d&#39; = a[1] * b[9]</span>
<span class="term-fg31">-	ldr	r7, [r1, #2*4]			@ a[2]</span>
<span class="term-fg31">-	umlal	r5, r6, r0, r14			@ d += a[1] * b[8]</span>
<span class="term-fg31">-	ldr	r8, [r2, #7*4] 			@ b[7]</span>
<span class="term-fg31">-	umlal	r9, r10, r7, r14		@ d&#39; += a[2] * b[8]</span>
<span class="term-fg31">-	ldr	r0, [r1, #3*4]   		@ a[3]</span>
<span class="term-fg31">-	umlal	r5, r6, r7, r8   		@ d += a[2] * b[7]</span>
<span class="term-fg31">-	ldr	r14, [r2, #6*4]   		@ b[6]</span>
<span class="term-fg31">-	umlal	r9, r10, r0, r8  		@ d&#39; += a[3] * b[7]</span>
<span class="term-fg31">-	ldr	r7, [r1, #4*4]   		@ a[4]</span>
<span class="term-fg31">-	umlal	r5, r6, r0, r14   		@ d += a[3] * b[6]</span>
<span class="term-fg31">-	ldr	r8, [r2, #5*4]   		@ b[5]</span>
<span class="term-fg31">-	umlal	r9, r10, r7, r14  		@ d&#39; += a[4] * b[6]</span>
<span class="term-fg31">-	ldr	r0, [r1, #5*4]   		@ a[5]</span>
<span class="term-fg31">-	umlal	r5, r6, r7, r8   		@ d += a[4] * b[5]</span>
<span class="term-fg31">-	ldr	r14, [r2, #4*4]   		@ b[4]</span>
<span class="term-fg31">-	umlal	r9, r10, r0, r8  		@ d&#39; += a[5] * b[5]</span>
<span class="term-fg31">-	ldr	r7, [r1, #6*4]   		@ a[6]</span>
<span class="term-fg31">-	umlal	r5, r6, r0, r14   		@ d += a[5] * b[4]</span>
<span class="term-fg31">-	ldr	r8, [r2, #3*4]   		@ b[3]</span>
<span class="term-fg31">-	umlal	r9, r10, r7, r14  		@ d&#39; += a[6] * b[4]</span>
<span class="term-fg31">-	ldr	r0, [r1, #7*4]   		@ a[7]</span>
<span class="term-fg31">-	umlal	r5, r6, r7, r8   		@ d += a[6] * b[3]</span>
<span class="term-fg31">-	ldr	r14, [r2, #2*4]   		@ b[2]</span>
<span class="term-fg31">-	umlal	r9, r10, r0, r8  		@ d&#39; += a[7] * b[3]</span>
<span class="term-fg31">-	ldr	r7, [r1, #8*4]   		@ a[8]</span>
<span class="term-fg31">-	umlal	r5, r6, r0, r14   		@ d += a[7] * b[2]</span>
<span class="term-fg31">-	ldr	r8, [r2, #1*4]   		@ b[1]</span>
<span class="term-fg31">-	umlal	r9, r10, r7, r14  		@ d&#39; += a[8] * b[2]</span>
<span class="term-fg31">-	ldr	r0, [r1, #9*4]   		@ a[9]</span>
<span class="term-fg31">-	umlal	r5, r6, r7, r8   		@ d += a[8] * b[1]</span>
<span class="term-fg31">-	ldr	r14, [r2, #0*4]   		@ b[0]</span>
<span class="term-fg31">-	umlal	r9, r10, r0, r8  		@ d&#39; += a[9] * b[1]</span>
<span class="term-fg31">-	ldr	r7, [r1, #0*4]   		@ a[0]</span>
<span class="term-fg31">-	umlal	r5, r6, r0, r14   		@ d += a[9] * b[0]</span>
<span class="term-fg31">-	@ r7,r14 used in B</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	bic	r0, r5, field_not_M 		@ t9 = d &amp; M</span>
<span class="term-fg31">-	str     r0, [sp, #4 + 4*9]</span>
<span class="term-fg31">-	mov	r5, r5, lsr #26     		@ d &gt;&gt;= 26 </span>
<span class="term-fg31">-	orr	r5, r5, r6, asl #6</span>
<span class="term-fg31">-	mov     r6, r6, lsr #26</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	&#47;* B *&#47;</span>
<span class="term-fg31">-	umull	r3, r4, r7, r14   		@ c = a[0] * b[0]</span>
<span class="term-fg31">-	adds	r5, r5, r9       		@ d += d&#39;</span>
<span class="term-fg31">-	adc	r6, r6, r10</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	bic	r0, r5, field_not_M 		@ u0 = d &amp; M</span>
<span class="term-fg31">-	mov	r5, r5, lsr #26     		@ d &gt;&gt;= 26</span>
<span class="term-fg31">-	orr	r5, r5, r6, asl #6</span>
<span class="term-fg31">-	mov     r6, r6, lsr #26</span>
<span class="term-fg31">-	movw    r14, field_R0			@ c += u0 * R0</span>
<span class="term-fg31">-	umlal   r3, r4, r0, r14</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	bic	r14, r3, field_not_M 		@ t0 = c &amp; M</span>
<span class="term-fg31">-	str	r14, [sp, #4 + 0*4]</span>
<span class="term-fg31">-	mov	r3, r3, lsr #26     		@ c &gt;&gt;= 26</span>
<span class="term-fg31">-	orr	r3, r3, r4, asl #6</span>
<span class="term-fg31">-	mov     r4, r4, lsr #26</span>
<span class="term-fg31">-	mov     r14, field_R1			@ c += u0 * R1</span>
<span class="term-fg31">-	umlal   r3, r4, r0, r14</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	&#47;* C - interleaved with D *&#47;</span>
<span class="term-fg31">-	ldr	r7, [r1, #0*4]   		@ a[0]</span>
<span class="term-fg31">-	ldr	r8, [r2, #2*4]   		@ b[2]</span>
<span class="term-fg31">-	ldr	r14, [r2, #1*4]   		@ b[1]</span>
<span class="term-fg31">-	umull	r11, r12, r7, r8   		@ c&#39; = a[0] * b[2]</span>
<span class="term-fg31">-	ldr	r0, [r1, #1*4]   		@ a[1]</span>
<span class="term-fg31">-	umlal   r3, r4, r7, r14   		@ c += a[0] * b[1]</span>
<span class="term-fg31">-	ldr	r8, [r2, #0*4]   		@ b[0]</span>
<span class="term-fg31">-	umlal   r11, r12, r0, r14   		@ c&#39; += a[1] * b[1]</span>
<span class="term-fg31">-	ldr	r7, [r1, #2*4]   		@ a[2]</span>
<span class="term-fg31">-	umlal   r3, r4, r0, r8   		@ c += a[1] * b[0]</span>
<span class="term-fg31">-	ldr	r14, [r2, #9*4]   		@ b[9]</span>
<span class="term-fg31">-	umlal   r11, r12, r7, r8   		@ c&#39; += a[2] * b[0]</span>
<span class="term-fg31">-	ldr	r0, [r1, #3*4]   		@ a[3]</span>
<span class="term-fg31">-	umlal	r5, r6, r7, r14   		@ d += a[2] * b[9]</span>
<span class="term-fg31">-	ldr	r8, [r2, #8*4]   		@ b[8]</span>
<span class="term-fg31">-	umull	r9, r10, r0, r14   		@ d&#39; = a[3] * b[9]</span>
<span class="term-fg31">-	ldr	r7, [r1, #4*4]   		@ a[4]</span>
<span class="term-fg31">-	umlal	r5, r6, r0, r8   		@ d += a[3] * b[8]</span>
<span class="term-fg31">-	ldr	r14, [r2, #7*4]   		@ b[7]</span>
<span class="term-fg31">-	umlal	r9, r10, r7, r8   		@ d&#39; += a[4] * b[8]</span>
<span class="term-fg31">-	ldr	r0, [r1, #5*4]   		@ a[5]</span>
<span class="term-fg31">-	umlal	r5, r6, r7, r14   		@ d += a[4] * b[7]</span>
<span class="term-fg31">-	ldr	r8, [r2, #6*4]   		@ b[6]</span>
<span class="term-fg31">-	umlal	r9, r10, r0, r14   		@ d&#39; += a[5] * b[7]</span>
<span class="term-fg31">-	ldr	r7, [r1, #6*4]   		@ a[6]</span>
<span class="term-fg31">-	umlal	r5, r6, r0, r8   		@ d += a[5] * b[6]</span>
<span class="term-fg31">-	ldr	r14, [r2, #5*4]   		@ b[5]</span>
<span class="term-fg31">-	umlal	r9, r10, r7, r8   		@ d&#39; += a[6] * b[6]</span>
<span class="term-fg31">-	ldr	r0, [r1, #7*4]   		@ a[7]</span>
<span class="term-fg31">-	umlal	r5, r6, r7, r14   		@ d += a[6] * b[5]</span>
<span class="term-fg31">-	ldr	r8, [r2, #4*4]   		@ b[4]</span>
<span class="term-fg31">-	umlal	r9, r10, r0, r14   		@ d&#39; += a[7] * b[5]</span>
<span class="term-fg31">-	ldr	r7, [r1, #8*4]   		@ a[8]</span>
<span class="term-fg31">-	umlal	r5, r6, r0, r8   		@ d += a[7] * b[4]</span>
<span class="term-fg31">-	ldr	r14, [r2, #3*4]   		@ b[3]</span>
<span class="term-fg31">-	umlal	r9, r10, r7, r8   		@ d&#39; += a[8] * b[4]</span>
<span class="term-fg31">-	ldr	r0, [r1, #9*4]   		@ a[9]</span>
<span class="term-fg31">-	umlal	r5, r6, r7, r14   		@ d += a[8] * b[3]</span>
<span class="term-fg31">-	ldr	r8, [r2, #2*4]   		@ b[2]</span>
<span class="term-fg31">-	umlal	r9, r10, r0, r14   		@ d&#39; += a[9] * b[3]</span>
<span class="term-fg31">-	umlal	r5, r6, r0, r8   		@ d += a[9] * b[2]</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	bic	r0, r5, field_not_M 		@ u1 = d &amp; M</span>
<span class="term-fg31">-	mov	r5, r5, lsr #26     		@ d &gt;&gt;= 26</span>
<span class="term-fg31">-	orr	r5, r5, r6, asl #6</span>
<span class="term-fg31">-	mov     r6, r6, lsr #26</span>
<span class="term-fg31">-	movw    r14, field_R0			@ c += u1 * R0</span>
<span class="term-fg31">-	umlal   r3, r4, r0, r14</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	bic	r14, r3, field_not_M 		@ t1 = c &amp; M</span>
<span class="term-fg31">-	str	r14, [sp, #4 + 1*4]</span>
<span class="term-fg31">-	mov	r3, r3, lsr #26     		@ c &gt;&gt;= 26</span>
<span class="term-fg31">-	orr	r3, r3, r4, asl #6</span>
<span class="term-fg31">-	mov     r4, r4, lsr #26</span>
<span class="term-fg31">-	mov     r14, field_R1			@ c += u1 * R1</span>
<span class="term-fg31">-	umlal   r3, r4, r0, r14</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	&#47;* D *&#47;</span>
<span class="term-fg31">-	adds	r3, r3, r11			@ c += c&#39;</span>
<span class="term-fg31">-	adc	r4, r4, r12</span>
<span class="term-fg31">-	adds	r5, r5, r9			@ d += d&#39;</span>
<span class="term-fg31">-	adc	r6, r6, r10</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	bic	r0, r5, field_not_M 		@ u2 = d &amp; M</span>
<span class="term-fg31">-	mov	r5, r5, lsr #26     		@ d &gt;&gt;= 26</span>
<span class="term-fg31">-	orr	r5, r5, r6, asl #6</span>
<span class="term-fg31">-	mov     r6, r6, lsr #26</span>
<span class="term-fg31">-	movw    r14, field_R0			@ c += u2 * R0</span>
<span class="term-fg31">-	umlal   r3, r4, r0, r14</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	bic	r14, r3, field_not_M 		@ t2 = c &amp; M</span>
<span class="term-fg31">-	str	r14, [sp, #4 + 2*4]</span>
<span class="term-fg31">-	mov	r3, r3, lsr #26     		@ c &gt;&gt;= 26</span>
<span class="term-fg31">-	orr	r3, r3, r4, asl #6</span>
<span class="term-fg31">-	mov     r4, r4, lsr #26</span>
<span class="term-fg31">-	mov     r14, field_R1			@ c += u2 * R1</span>
<span class="term-fg31">-	umlal   r3, r4, r0, r14</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	&#47;* E - interleaved with F *&#47;</span>
<span class="term-fg31">-	ldr	r7, [r1, #0*4]   		@ a[0]</span>
<span class="term-fg31">-	ldr	r8, [r2, #4*4]   		@ b[4]</span>
<span class="term-fg31">-	umull	r11, r12, r7, r8   		@ c&#39; = a[0] * b[4]</span>
<span class="term-fg31">-	ldr	r8, [r2, #3*4]   		@ b[3]</span>
<span class="term-fg31">-	umlal   r3, r4, r7, r8   		@ c += a[0] * b[3]</span>
<span class="term-fg31">-	ldr	r7, [r1, #1*4]   		@ a[1]</span>
<span class="term-fg31">-	umlal   r11, r12, r7, r8   		@ c&#39; += a[1] * b[3]</span>
<span class="term-fg31">-	ldr	r8, [r2, #2*4]   		@ b[2]</span>
<span class="term-fg31">-	umlal   r3, r4, r7, r8   		@ c += a[1] * b[2]</span>
<span class="term-fg31">-	ldr	r7, [r1, #2*4]   		@ a[2]</span>
<span class="term-fg31">-	umlal   r11, r12, r7, r8   		@ c&#39; += a[2] * b[2]</span>
<span class="term-fg31">-	ldr	r8, [r2, #1*4]   		@ b[1]</span>
<span class="term-fg31">-	umlal   r3, r4, r7, r8   		@ c += a[2] * b[1]</span>
<span class="term-fg31">-	ldr	r7, [r1, #3*4]   		@ a[3]</span>
<span class="term-fg31">-	umlal   r11, r12, r7, r8   		@ c&#39; += a[3] * b[1]</span>
<span class="term-fg31">-	ldr	r8, [r2, #0*4]   		@ b[0]</span>
<span class="term-fg31">-	umlal   r3, r4, r7, r8   		@ c += a[3] * b[0]</span>
<span class="term-fg31">-	ldr	r7, [r1, #4*4]   		@ a[4]</span>
<span class="term-fg31">-	umlal   r11, r12, r7, r8   		@ c&#39; += a[4] * b[0]</span>
<span class="term-fg31">-	ldr	r8, [r2, #9*4]   		@ b[9]</span>
<span class="term-fg31">-	umlal	r5, r6, r7, r8   		@ d += a[4] * b[9]</span>
<span class="term-fg31">-	ldr	r7, [r1, #5*4]   		@ a[5]</span>
<span class="term-fg31">-	umull	r9, r10, r7, r8   		@ d&#39; = a[5] * b[9]</span>
<span class="term-fg31">-	ldr	r8, [r2, #8*4]   		@ b[8]</span>
<span class="term-fg31">-	umlal	r5, r6, r7, r8   		@ d += a[5] * b[8]</span>
<span class="term-fg31">-	ldr	r7, [r1, #6*4]   		@ a[6]</span>
<span class="term-fg31">-	umlal	r9, r10, r7, r8   		@ d&#39; += a[6] * b[8]</span>
<span class="term-fg31">-	ldr	r8, [r2, #7*4]   		@ b[7]</span>
<span class="term-fg31">-	umlal	r5, r6, r7, r8   		@ d += a[6] * b[7]</span>
<span class="term-fg31">-	ldr	r7, [r1, #7*4]   		@ a[7]</span>
<span class="term-fg31">-	umlal	r9, r10, r7, r8   		@ d&#39; += a[7] * b[7]</span>
<span class="term-fg31">-	ldr	r8, [r2, #6*4]   		@ b[6]</span>
<span class="term-fg31">-	umlal	r5, r6, r7, r8   		@ d += a[7] * b[6]</span>
<span class="term-fg31">-	ldr	r7, [r1, #8*4]   		@ a[8]</span>
<span class="term-fg31">-	umlal	r9, r10, r7, r8   		@ d&#39; += a[8] * b[6]</span>
<span class="term-fg31">-	ldr	r8, [r2, #5*4]   		@ b[5]</span>
<span class="term-fg31">-	umlal	r5, r6, r7, r8   		@ d += a[8] * b[5]</span>
<span class="term-fg31">-	ldr	r7, [r1, #9*4]   		@ a[9]</span>
<span class="term-fg31">-	umlal	r9, r10, r7, r8   		@ d&#39; += a[9] * b[5]</span>
<span class="term-fg31">-	ldr	r8, [r2, #4*4]   		@ b[4]</span>
<span class="term-fg31">-	umlal	r5, r6, r7, r8   		@ d += a[9] * b[4]</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	bic	r0, r5, field_not_M 		@ u3 = d &amp; M</span>
<span class="term-fg31">-	mov	r5, r5, lsr #26     		@ d &gt;&gt;= 26</span>
<span class="term-fg31">-	orr	r5, r5, r6, asl #6</span>
<span class="term-fg31">-	mov     r6, r6, lsr #26</span>
<span class="term-fg31">-	movw    r14, field_R0			@ c += u3 * R0</span>
<span class="term-fg31">-	umlal   r3, r4, r0, r14</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	bic	r14, r3, field_not_M 		@ t3 = c &amp; M</span>
<span class="term-fg31">-	str	r14, [sp, #4 + 3*4]</span>
<span class="term-fg31">-	mov	r3, r3, lsr #26     		@ c &gt;&gt;= 26</span>
<span class="term-fg31">-	orr	r3, r3, r4, asl #6</span>
<span class="term-fg31">-	mov     r4, r4, lsr #26</span>
<span class="term-fg31">-	mov     r14, field_R1			@ c += u3 * R1</span>
<span class="term-fg31">-	umlal   r3, r4, r0, r14</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	&#47;* F *&#47;</span>
<span class="term-fg31">-	adds	r3, r3, r11			@ c += c&#39;</span>
<span class="term-fg31">-	adc	r4, r4, r12</span>
<span class="term-fg31">-	adds	r5, r5, r9			@ d += d&#39;</span>
<span class="term-fg31">-	adc	r6, r6, r10</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	bic	r0, r5, field_not_M 		@ u4 = d &amp; M</span>
<span class="term-fg31">-	mov	r5, r5, lsr #26     		@ d &gt;&gt;= 26</span>
<span class="term-fg31">-	orr	r5, r5, r6, asl #6</span>
<span class="term-fg31">-	mov     r6, r6, lsr #26</span>
<span class="term-fg31">-	movw    r14, field_R0			@ c += u4 * R0</span>
<span class="term-fg31">-	umlal   r3, r4, r0, r14</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	bic	r14, r3, field_not_M 		@ t4 = c &amp; M</span>
<span class="term-fg31">-	str	r14, [sp, #4 + 4*4]</span>
<span class="term-fg31">-	mov	r3, r3, lsr #26     		@ c &gt;&gt;= 26</span>
<span class="term-fg31">-	orr	r3, r3, r4, asl #6</span>
<span class="term-fg31">-	mov     r4, r4, lsr #26</span>
<span class="term-fg31">-	mov     r14, field_R1			@ c += u4 * R1</span>
<span class="term-fg31">-	umlal   r3, r4, r0, r14</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	&#47;* G - interleaved with H *&#47;</span>
<span class="term-fg31">-	ldr	r7, [r1, #0*4]   		@ a[0]</span>
<span class="term-fg31">-	ldr	r8, [r2, #6*4]   		@ b[6]</span>
<span class="term-fg31">-	ldr	r14, [r2, #5*4]   		@ b[5]</span>
<span class="term-fg31">-	umull	r11, r12, r7, r8   		@ c&#39; = a[0] * b[6]</span>
<span class="term-fg31">-	ldr	r0, [r1, #1*4]   		@ a[1]</span>
<span class="term-fg31">-	umlal   r3, r4, r7, r14   		@ c += a[0] * b[5]</span>
<span class="term-fg31">-	ldr	r8, [r2, #4*4]   		@ b[4]</span>
<span class="term-fg31">-	umlal   r11, r12, r0, r14   		@ c&#39; += a[1] * b[5]</span>
<span class="term-fg31">-	ldr	r7, [r1, #2*4]   		@ a[2]</span>
<span class="term-fg31">-	umlal   r3, r4, r0, r8   		@ c += a[1] * b[4]</span>
<span class="term-fg31">-	ldr	r14, [r2, #3*4]   		@ b[3]</span>
<span class="term-fg31">-	umlal   r11, r12, r7, r8   		@ c&#39; += a[2] * b[4]</span>
<span class="term-fg31">-	ldr	r0, [r1, #3*4]   		@ a[3]</span>
<span class="term-fg31">-	umlal   r3, r4, r7, r14   		@ c += a[2] * b[3]</span>
<span class="term-fg31">-	ldr	r8, [r2, #2*4]   		@ b[2]</span>
<span class="term-fg31">-	umlal   r11, r12, r0, r14   		@ c&#39; += a[3] * b[3]</span>
<span class="term-fg31">-	ldr	r7, [r1, #4*4]   		@ a[4]</span>
<span class="term-fg31">-	umlal   r3, r4, r0, r8   		@ c += a[3] * b[2]</span>
<span class="term-fg31">-	ldr	r14, [r2, #1*4]   		@ b[1]</span>
<span class="term-fg31">-	umlal   r11, r12, r7, r8   		@ c&#39; += a[4] * b[2]</span>
<span class="term-fg31">-	ldr	r0, [r1, #5*4]   		@ a[5]</span>
<span class="term-fg31">-	umlal   r3, r4, r7, r14   		@ c += a[4] * b[1]</span>
<span class="term-fg31">-	ldr	r8, [r2, #0*4]   		@ b[0]</span>
<span class="term-fg31">-	umlal   r11, r12, r0, r14   		@ c&#39; += a[5] * b[1]</span>
<span class="term-fg31">-	ldr	r7, [r1, #6*4]   		@ a[6]</span>
<span class="term-fg31">-	umlal   r3, r4, r0, r8   		@ c += a[5] * b[0]</span>
<span class="term-fg31">-	ldr	r14, [r2, #9*4]   		@ b[9]</span>
<span class="term-fg31">-	umlal   r11, r12, r7, r8   		@ c&#39; += a[6] * b[0]</span>
<span class="term-fg31">-	ldr	r0, [r1, #7*4]   		@ a[7]</span>
<span class="term-fg31">-	umlal	r5, r6, r7, r14   		@ d += a[6] * b[9]</span>
<span class="term-fg31">-	ldr	r8, [r2, #8*4]   		@ b[8]</span>
<span class="term-fg31">-	umull	r9, r10, r0, r14   		@ d&#39; = a[7] * b[9]</span>
<span class="term-fg31">-	ldr	r7, [r1, #8*4]   		@ a[8]</span>
<span class="term-fg31">-	umlal	r5, r6, r0, r8   		@ d += a[7] * b[8]</span>
<span class="term-fg31">-	ldr	r14, [r2, #7*4]   		@ b[7]</span>
<span class="term-fg31">-	umlal	r9, r10, r7, r8   		@ d&#39; += a[8] * b[8]</span>
<span class="term-fg31">-	ldr	r0, [r1, #9*4]   		@ a[9]</span>
<span class="term-fg31">-	umlal	r5, r6, r7, r14   		@ d += a[8] * b[7]</span>
<span class="term-fg31">-	ldr	r8, [r2, #6*4]   		@ b[6]</span>
<span class="term-fg31">-	umlal	r9, r10, r0, r14   		@ d&#39; += a[9] * b[7]</span>
<span class="term-fg31">-	umlal	r5, r6, r0, r8   		@ d += a[9] * b[6]</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	bic	r0, r5, field_not_M 		@ u5 = d &amp; M</span>
<span class="term-fg31">-	mov	r5, r5, lsr #26     		@ d &gt;&gt;= 26</span>
<span class="term-fg31">-	orr	r5, r5, r6, asl #6</span>
<span class="term-fg31">-	mov     r6, r6, lsr #26</span>
<span class="term-fg31">-	movw    r14, field_R0			@ c += u5 * R0</span>
<span class="term-fg31">-	umlal   r3, r4, r0, r14</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	bic	r14, r3, field_not_M 		@ t5 = c &amp; M</span>
<span class="term-fg31">-	str	r14, [sp, #4 + 5*4]</span>
<span class="term-fg31">-	mov	r3, r3, lsr #26     		@ c &gt;&gt;= 26</span>
<span class="term-fg31">-	orr	r3, r3, r4, asl #6</span>
<span class="term-fg31">-	mov     r4, r4, lsr #26</span>
<span class="term-fg31">-	mov     r14, field_R1			@ c += u5 * R1</span>
<span class="term-fg31">-	umlal   r3, r4, r0, r14</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	&#47;* H *&#47;</span>
<span class="term-fg31">-	adds	r3, r3, r11			@ c += c&#39;</span>
<span class="term-fg31">-	adc	r4, r4, r12</span>
<span class="term-fg31">-	adds	r5, r5, r9			@ d += d&#39;</span>
<span class="term-fg31">-	adc	r6, r6, r10</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	bic	r0, r5, field_not_M 		@ u6 = d &amp; M</span>
<span class="term-fg31">-	mov	r5, r5, lsr #26     		@ d &gt;&gt;= 26</span>
<span class="term-fg31">-	orr	r5, r5, r6, asl #6</span>
<span class="term-fg31">-	mov     r6, r6, lsr #26</span>
<span class="term-fg31">-	movw    r14, field_R0			@ c += u6 * R0</span>
<span class="term-fg31">-	umlal   r3, r4, r0, r14</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	bic	r14, r3, field_not_M 		@ t6 = c &amp; M</span>
<span class="term-fg31">-	str	r14, [sp, #4 + 6*4]</span>
<span class="term-fg31">-	mov	r3, r3, lsr #26     		@ c &gt;&gt;= 26</span>
<span class="term-fg31">-	orr	r3, r3, r4, asl #6</span>
<span class="term-fg31">-	mov     r4, r4, lsr #26</span>
<span class="term-fg31">-	mov     r14, field_R1			@ c += u6 * R1</span>
<span class="term-fg31">-	umlal   r3, r4, r0, r14</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	&#47;* I - interleaved with J *&#47;</span>
<span class="term-fg31">-	ldr	r8, [r2, #8*4]   		@ b[8]</span>
<span class="term-fg31">-	ldr	r7, [r1, #0*4]   		@ a[0]</span>
<span class="term-fg31">-	ldr	r14, [r2, #7*4]   		@ b[7]</span>
<span class="term-fg31">-	umull   r11, r12, r7, r8   		@ c&#39; = a[0] * b[8]</span>
<span class="term-fg31">-	ldr	r0, [r1, #1*4]   		@ a[1]</span>
<span class="term-fg31">-	umlal   r3, r4, r7, r14   		@ c += a[0] * b[7]</span>
<span class="term-fg31">-	ldr	r8, [r2, #6*4]   		@ b[6]</span>
<span class="term-fg31">-	umlal   r11, r12, r0, r14   		@ c&#39; += a[1] * b[7]</span>
<span class="term-fg31">-	ldr	r7, [r1, #2*4]   		@ a[2]</span>
<span class="term-fg31">-	umlal   r3, r4, r0, r8   		@ c += a[1] * b[6]</span>
<span class="term-fg31">-	ldr	r14, [r2, #5*4]   		@ b[5]</span>
<span class="term-fg31">-	umlal   r11, r12, r7, r8   		@ c&#39; += a[2] * b[6]</span>
<span class="term-fg31">-	ldr	r0, [r1, #3*4]   		@ a[3]</span>
<span class="term-fg31">-	umlal   r3, r4, r7, r14   		@ c += a[2] * b[5]</span>
<span class="term-fg31">-	ldr	r8, [r2, #4*4]   		@ b[4]</span>
<span class="term-fg31">-	umlal   r11, r12, r0, r14   		@ c&#39; += a[3] * b[5]</span>
<span class="term-fg31">-	ldr	r7, [r1, #4*4]   		@ a[4]</span>
<span class="term-fg31">-	umlal   r3, r4, r0, r8   		@ c += a[3] * b[4]</span>
<span class="term-fg31">-	ldr	r14, [r2, #3*4]   		@ b[3]</span>
<span class="term-fg31">-	umlal   r11, r12, r7, r8   		@ c&#39; += a[4] * b[4]</span>
<span class="term-fg31">-	ldr	r0, [r1, #5*4]   		@ a[5]</span>
<span class="term-fg31">-	umlal   r3, r4, r7, r14   		@ c += a[4] * b[3]</span>
<span class="term-fg31">-	ldr	r8, [r2, #2*4]   		@ b[2]</span>
<span class="term-fg31">-	umlal   r11, r12, r0, r14   		@ c&#39; += a[5] * b[3]</span>
<span class="term-fg31">-	ldr	r7, [r1, #6*4]   		@ a[6]</span>
<span class="term-fg31">-	umlal   r3, r4, r0, r8   		@ c += a[5] * b[2]</span>
<span class="term-fg31">-	ldr	r14, [r2, #1*4]   		@ b[1]</span>
<span class="term-fg31">-	umlal   r11, r12, r7, r8   		@ c&#39; += a[6] * b[2]</span>
<span class="term-fg31">-	ldr	r0, [r1, #7*4]   		@ a[7]</span>
<span class="term-fg31">-	umlal   r3, r4, r7, r14   		@ c += a[6] * b[1]</span>
<span class="term-fg31">-	ldr	r8, [r2, #0*4]   		@ b[0]</span>
<span class="term-fg31">-	umlal   r11, r12, r0, r14   		@ c&#39; += a[7] * b[1]</span>
<span class="term-fg31">-	ldr	r7, [r1, #8*4]   		@ a[8]</span>
<span class="term-fg31">-	umlal   r3, r4, r0, r8   		@ c += a[7] * b[0]</span>
<span class="term-fg31">-	ldr	r14, [r2, #9*4]   		@ b[9]</span>
<span class="term-fg31">-	umlal   r11, r12, r7, r8   		@ c&#39; += a[8] * b[0]</span>
<span class="term-fg31">-	ldr	r0, [r1, #9*4]   		@ a[9]</span>
<span class="term-fg31">-	umlal	r5, r6, r7, r14   		@ d += a[8] * b[9]</span>
<span class="term-fg31">-	ldr	r8, [r2, #8*4]   		@ b[8]</span>
<span class="term-fg31">-	umull	r9, r10, r0, r14  		@ d&#39; = a[9] * b[9]</span>
<span class="term-fg31">-	umlal	r5, r6, r0, r8   		@ d += a[9] * b[8]</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	bic	r0, r5, field_not_M 		@ u7 = d &amp; M</span>
<span class="term-fg31">-	mov	r5, r5, lsr #26     		@ d &gt;&gt;= 26</span>
<span class="term-fg31">-	orr	r5, r5, r6, asl #6</span>
<span class="term-fg31">-	mov     r6, r6, lsr #26</span>
<span class="term-fg31">-	movw    r14, field_R0			@ c += u7 * R0</span>
<span class="term-fg31">-	umlal   r3, r4, r0, r14</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	bic	r14, r3, field_not_M 		@ t7 = c &amp; M</span>
<span class="term-fg31">-	str	r14, [sp, #4 + 7*4]</span>
<span class="term-fg31">-	mov	r3, r3, lsr #26     		@ c &gt;&gt;= 26</span>
<span class="term-fg31">-	orr	r3, r3, r4, asl #6</span>
<span class="term-fg31">-	mov     r4, r4, lsr #26</span>
<span class="term-fg31">-	mov     r14, field_R1			@ c += u7 * R1</span>
<span class="term-fg31">-	umlal   r3, r4, r0, r14</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	&#47;* J *&#47;</span>
<span class="term-fg31">-	adds	r3, r3, r11			@ c += c&#39;</span>
<span class="term-fg31">-	adc	r4, r4, r12</span>
<span class="term-fg31">-	adds	r5, r5, r9			@ d += d&#39;</span>
<span class="term-fg31">-	adc	r6, r6, r10</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	bic	r0, r5, field_not_M 		@ u8 = d &amp; M</span>
<span class="term-fg31">-	str	r0, [sp, #4 + 8*4]</span>
<span class="term-fg31">-	mov	r5, r5, lsr #26     		@ d &gt;&gt;= 26</span>
<span class="term-fg31">-	orr	r5, r5, r6, asl #6</span>
<span class="term-fg31">-	mov     r6, r6, lsr #26</span>
<span class="term-fg31">-	movw    r14, field_R0			@ c += u8 * R0</span>
<span class="term-fg31">-	umlal   r3, r4, r0, r14</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	&#47;******************************************</span>
<span class="term-fg31">-	 * compute and write back result</span>
<span class="term-fg31">-	 ******************************************</span>
<span class="term-fg31">-	Allocation:</span>
<span class="term-fg31">-	    r0    r</span>
<span class="term-fg31">-	    r3:r4 c</span>
<span class="term-fg31">-	    r5:r6 d</span>
<span class="term-fg31">-	    r7    t0</span>
<span class="term-fg31">-	    r8    t1</span>
<span class="term-fg31">-	    r9    t2</span>
<span class="term-fg31">-	    r11   u8</span>
<span class="term-fg31">-	    r12   t9</span>
<span class="term-fg31">-	    r1,r2,r10,r14 scratch</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	Note: do not read from a[] after here, it may overlap with r[]</span>
<span class="term-fg31">-	*&#47;</span>
<span class="term-fg31">-	ldr	r0, [sp, #0]</span>
<span class="term-fg31">-	add	r1, sp, #4 + 3*4		@ r[3..7] = t3..7, r11=u8, r12=t9</span>
<span class="term-fg31">-	ldmia	r1, {r2,r7,r8,r9,r10,r11,r12}</span>
<span class="term-fg31">-	add	r1, r0, #3*4</span>
<span class="term-fg31">-	stmia	r1, {r2,r7,r8,r9,r10}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	bic	r2, r3, field_not_M 		@ r[8] = c &amp; M</span>
<span class="term-fg31">-	str	r2, [r0, #8*4]</span>
<span class="term-fg31">-	mov	r3, r3, lsr #26     		@ c &gt;&gt;= 26</span>
<span class="term-fg31">-	orr	r3, r3, r4, asl #6</span>
<span class="term-fg31">-	mov     r4, r4, lsr #26</span>
<span class="term-fg31">-	mov     r14, field_R1			@ c += u8 * R1</span>
<span class="term-fg31">-	umlal   r3, r4, r11, r14</span>
<span class="term-fg31">-	movw    r14, field_R0			@ c += d * R0</span>
<span class="term-fg31">-	umlal   r3, r4, r5, r14</span>
<span class="term-fg31">-	adds	r3, r3, r12			@ c += t9</span>
<span class="term-fg31">-	adc	r4, r4, #0</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	add	r1, sp, #4 + 0*4		@ r7,r8,r9 = t0,t1,t2</span>
<span class="term-fg31">-	ldmia	r1, {r7,r8,r9}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	ubfx	r2, r3, #0, #22     		@ r[9] = c &amp; (M &gt;&gt; 4)</span>
<span class="term-fg31">-	str	r2, [r0, #9*4]</span>
<span class="term-fg31">-	mov	r3, r3, lsr #22     		@ c &gt;&gt;= 22</span>
<span class="term-fg31">-	orr	r3, r3, r4, asl #10</span>
<span class="term-fg31">-	mov     r4, r4, lsr #22</span>
<span class="term-fg31">-	movw    r14, field_R1 &lt;&lt; 4   		@ c += d * (R1 &lt;&lt; 4)</span>
<span class="term-fg31">-	umlal   r3, r4, r5, r14</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	movw    r14, field_R0 &gt;&gt; 4   		@ d = c * (R0 &gt;&gt; 4) + t0 (64x64 multiply+add)</span>
<span class="term-fg31">-	umull	r5, r6, r3, r14			@ d = c.lo * (R0 &gt;&gt; 4)</span>
<span class="term-fg31">-	adds	r5, r5, r7	    		@ d.lo += t0</span>
<span class="term-fg31">-	mla	r6, r14, r4, r6			@ d.hi += c.hi * (R0 &gt;&gt; 4)</span>
<span class="term-fg31">-	adc	r6, r6, 0	     		@ d.hi += carry</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	bic	r2, r5, field_not_M 		@ r[0] = d &amp; M</span>
<span class="term-fg31">-	str	r2, [r0, #0*4]</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	mov	r5, r5, lsr #26     		@ d &gt;&gt;= 26</span>
<span class="term-fg31">-	orr	r5, r5, r6, asl #6</span>
<span class="term-fg31">-	mov     r6, r6, lsr #26</span>
<span class="term-fg31">-	</span>
<span class="term-fg31">-	movw    r14, field_R1 &gt;&gt; 4   		@ d += c * (R1 &gt;&gt; 4) + t1 (64x64 multiply+add)</span>
<span class="term-fg31">-	umull	r1, r2, r3, r14       		@ tmp = c.lo * (R1 &gt;&gt; 4)</span>
<span class="term-fg31">-	adds	r5, r5, r8	    		@ d.lo += t1</span>
<span class="term-fg31">-	adc	r6, r6, #0	    		@ d.hi += carry</span>
<span class="term-fg31">-	adds	r5, r5, r1	    		@ d.lo += tmp.lo</span>
<span class="term-fg31">-	mla	r2, r14, r4, r2      		@ tmp.hi += c.hi * (R1 &gt;&gt; 4)</span>
<span class="term-fg31">-	adc	r6, r6, r2	   		@ d.hi += carry + tmp.hi</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	bic	r2, r5, field_not_M 		@ r[1] = d &amp; M</span>
<span class="term-fg31">-	str	r2, [r0, #1*4]</span>
<span class="term-fg31">-	mov	r5, r5, lsr #26     		@ d &gt;&gt;= 26 (ignore hi)</span>
<span class="term-fg31">-	orr	r5, r5, r6, asl #6</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	add	r5, r5, r9	  		@ d += t2</span>
<span class="term-fg31">-	str	r5, [r0, #2*4]      		@ r[2] = d</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	add	sp, sp, #48</span>
<span class="term-fg31">-	ldmfd	sp!, {r4, r5, r6, r7, r8, r9, r10, r11, pc}</span>
<span class="term-fg31">-	.size	secp256k1_fe_mul_inner, .-secp256k1_fe_mul_inner</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	.align	2</span>
<span class="term-fg31">-	.global secp256k1_fe_sqr_inner</span>
<span class="term-fg31">-	.type	secp256k1_fe_sqr_inner, %function</span>
<span class="term-fg31">-	@ Arguments:</span>
<span class="term-fg31">-	@  r0  r	 Can overlap with a</span>
<span class="term-fg31">-	@  r1  a</span>
<span class="term-fg31">-	@ Stack (total 4+10*4 = 44)</span>
<span class="term-fg31">-	@  sp + #0        saved &#39;r&#39; pointer</span>
<span class="term-fg31">-	@  sp + #4 + 4*X  t0,t1,t2,t3,t4,t5,t6,t7,u8,t9</span>
<span class="term-fg31">-secp256k1_fe_sqr_inner:</span>
<span class="term-fg31">-	stmfd	sp!, {r4, r5, r6, r7, r8, r9, r10, r11, r14}</span>
<span class="term-fg31">-	sub	sp, sp, #48			@ frame=44 + alignment</span>
<span class="term-fg31">-	str     r0, [sp, #0]			@ save result address, we need it only at the end</span>
<span class="term-fg31">-	&#47;******************************************</span>
<span class="term-fg31">-	 * Main computation code.</span>
<span class="term-fg31">-	 ******************************************</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	Allocation:</span>
<span class="term-fg31">-	    r0,r14,r2,r7,r8   scratch</span>
<span class="term-fg31">-	    r1       a (pointer)</span>
<span class="term-fg31">-	    r3:r4    c</span>
<span class="term-fg31">-	    r5:r6    d</span>
<span class="term-fg31">-	    r11:r12  c&#39;</span>
<span class="term-fg31">-	    r9:r10   d&#39;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	Note: do not write to r[] here, it may overlap with a[]</span>
<span class="term-fg31">-	*&#47;</span>
<span class="term-fg31">-	&#47;* A interleaved with B *&#47;</span>
<span class="term-fg31">-	ldr	r0, [r1, #1*4]			@ a[1]*2</span>
<span class="term-fg31">-	ldr	r7, [r1, #0*4]			@ a[0]</span>
<span class="term-fg31">-	mov	r0, r0, asl #1</span>
<span class="term-fg31">-	ldr	r14, [r1, #9*4]			@ a[9]</span>
<span class="term-fg31">-	umull	r3, r4, r7, r7			@ c = a[0] * a[0]</span>
<span class="term-fg31">-	ldr	r8, [r1, #8*4]			@ a[8]</span>
<span class="term-fg31">-	mov	r7, r7, asl #1</span>
<span class="term-fg31">-	umull	r5, r6, r7, r14			@ d = a[0]*2 * a[9]</span>
<span class="term-fg31">-	ldr	r7, [r1, #2*4]			@ a[2]*2</span>
<span class="term-fg31">-	umull	r9, r10, r0, r14		@ d&#39; = a[1]*2 * a[9]</span>
<span class="term-fg31">-	ldr	r14, [r1, #7*4]			@ a[7]</span>
<span class="term-fg31">-	umlal	r5, r6, r0, r8			@ d += a[1]*2 * a[8]</span>
<span class="term-fg31">-	mov	r7, r7, asl #1</span>
<span class="term-fg31">-	ldr	r0, [r1, #3*4]			@ a[3]*2</span>
<span class="term-fg31">-	umlal	r9, r10, r7, r8			@ d&#39; += a[2]*2 * a[8]</span>
<span class="term-fg31">-	ldr	r8, [r1, #6*4]			@ a[6]</span>
<span class="term-fg31">-	umlal	r5, r6, r7, r14			@ d += a[2]*2 * a[7]</span>
<span class="term-fg31">-	mov	r0, r0, asl #1</span>
<span class="term-fg31">-	ldr	r7, [r1, #4*4]			@ a[4]*2</span>
<span class="term-fg31">-	umlal	r9, r10, r0, r14		@ d&#39; += a[3]*2 * a[7]</span>
<span class="term-fg31">-	ldr	r14, [r1, #5*4]			@ a[5]</span>
<span class="term-fg31">-	mov	r7, r7, asl #1</span>
<span class="term-fg31">-	umlal	r5, r6, r0, r8			@ d += a[3]*2 * a[6]</span>
<span class="term-fg31">-	umlal	r9, r10, r7, r8			@ d&#39; += a[4]*2 * a[6]</span>
<span class="term-fg31">-	umlal	r5, r6, r7, r14			@ d += a[4]*2 * a[5]</span>
<span class="term-fg31">-	umlal	r9, r10, r14, r14		@ d&#39; += a[5] * a[5]</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	bic	r0, r5, field_not_M 		@ t9 = d &amp; M</span>
<span class="term-fg31">-	str     r0, [sp, #4 + 9*4]</span>
<span class="term-fg31">-	mov	r5, r5, lsr #26     		@ d &gt;&gt;= 26 </span>
<span class="term-fg31">-	orr	r5, r5, r6, asl #6</span>
<span class="term-fg31">-	mov     r6, r6, lsr #26</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	&#47;* B *&#47;</span>
<span class="term-fg31">-	adds	r5, r5, r9			@ d += d&#39;</span>
<span class="term-fg31">-	adc	r6, r6, r10</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	bic	r0, r5, field_not_M 		@ u0 = d &amp; M</span>
<span class="term-fg31">-	mov	r5, r5, lsr #26     		@ d &gt;&gt;= 26</span>
<span class="term-fg31">-	orr	r5, r5, r6, asl #6</span>
<span class="term-fg31">-	mov     r6, r6, lsr #26</span>
<span class="term-fg31">-	movw    r14, field_R0			@ c += u0 * R0</span>
<span class="term-fg31">-	umlal   r3, r4, r0, r14</span>
<span class="term-fg31">-	bic	r14, r3, field_not_M 		@ t0 = c &amp; M</span>
<span class="term-fg31">-	str	r14, [sp, #4 + 0*4]</span>
<span class="term-fg31">-	mov	r3, r3, lsr #26     		@ c &gt;&gt;= 26</span>
<span class="term-fg31">-	orr	r3, r3, r4, asl #6</span>
<span class="term-fg31">-	mov     r4, r4, lsr #26</span>
<span class="term-fg31">-	mov     r14, field_R1			@ c += u0 * R1</span>
<span class="term-fg31">-	umlal   r3, r4, r0, r14</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	&#47;* C interleaved with D *&#47;</span>
<span class="term-fg31">-	ldr	r0, [r1, #0*4]			@ a[0]*2</span>
<span class="term-fg31">-	ldr	r14, [r1, #1*4]			@ a[1]</span>
<span class="term-fg31">-	mov	r0, r0, asl #1</span>
<span class="term-fg31">-	ldr	r8, [r1, #2*4]			@ a[2]</span>
<span class="term-fg31">-	umlal	r3, r4, r0, r14			@ c += a[0]*2 * a[1]</span>
<span class="term-fg31">-	mov	r7, r8, asl #1                  @ a[2]*2</span>
<span class="term-fg31">-	umull	r11, r12, r14, r14		@ c&#39; = a[1] * a[1]</span>
<span class="term-fg31">-	ldr	r14, [r1, #9*4]			@ a[9]</span>
<span class="term-fg31">-	umlal	r11, r12, r0, r8		@ c&#39; += a[0]*2 * a[2]</span>
<span class="term-fg31">-	ldr	r0, [r1, #3*4]			@ a[3]*2</span>
<span class="term-fg31">-	ldr	r8, [r1, #8*4]			@ a[8]</span>
<span class="term-fg31">-	umlal	r5, r6, r7, r14			@ d += a[2]*2 * a[9]</span>
<span class="term-fg31">-	mov	r0, r0, asl #1</span>
<span class="term-fg31">-	ldr	r7, [r1, #4*4]			@ a[4]*2</span>
<span class="term-fg31">-	umull	r9, r10, r0, r14		@ d&#39; = a[3]*2 * a[9]</span>
<span class="term-fg31">-	ldr	r14, [r1, #7*4]			@ a[7]</span>
<span class="term-fg31">-	umlal	r5, r6, r0, r8			@ d += a[3]*2 * a[8]</span>
<span class="term-fg31">-	mov	r7, r7, asl #1</span>
<span class="term-fg31">-	ldr	r0, [r1, #5*4]			@ a[5]*2</span>
<span class="term-fg31">-	umlal	r9, r10, r7, r8			@ d&#39; += a[4]*2 * a[8]</span>
<span class="term-fg31">-	ldr	r8, [r1, #6*4]			@ a[6]</span>
<span class="term-fg31">-	mov	r0, r0, asl #1</span>
<span class="term-fg31">-	umlal	r5, r6, r7, r14			@ d += a[4]*2 * a[7]</span>
<span class="term-fg31">-	umlal	r9, r10, r0, r14		@ d&#39; += a[5]*2 * a[7]</span>
<span class="term-fg31">-	umlal	r5, r6, r0, r8			@ d += a[5]*2 * a[6]</span>
<span class="term-fg31">-	umlal	r9, r10, r8, r8			@ d&#39; += a[6] * a[6]</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	bic	r0, r5, field_not_M 		@ u1 = d &amp; M</span>
<span class="term-fg31">-	mov	r5, r5, lsr #26     		@ d &gt;&gt;= 26</span>
<span class="term-fg31">-	orr	r5, r5, r6, asl #6</span>
<span class="term-fg31">-	mov     r6, r6, lsr #26</span>
<span class="term-fg31">-	movw    r14, field_R0			@ c += u1 * R0</span>
<span class="term-fg31">-	umlal   r3, r4, r0, r14</span>
<span class="term-fg31">-	bic	r14, r3, field_not_M 		@ t1 = c &amp; M</span>
<span class="term-fg31">-	str	r14, [sp, #4 + 1*4]</span>
<span class="term-fg31">-	mov	r3, r3, lsr #26     		@ c &gt;&gt;= 26</span>
<span class="term-fg31">-	orr	r3, r3, r4, asl #6</span>
<span class="term-fg31">-	mov     r4, r4, lsr #26</span>
<span class="term-fg31">-	mov     r14, field_R1			@ c += u1 * R1</span>
<span class="term-fg31">-	umlal   r3, r4, r0, r14</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	&#47;* D *&#47;</span>
<span class="term-fg31">-	adds	r3, r3, r11			@ c += c&#39;</span>
<span class="term-fg31">-	adc	r4, r4, r12</span>
<span class="term-fg31">-	adds	r5, r5, r9			@ d += d&#39;</span>
<span class="term-fg31">-	adc	r6, r6, r10</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	bic	r0, r5, field_not_M 		@ u2 = d &amp; M</span>
<span class="term-fg31">-	mov	r5, r5, lsr #26     		@ d &gt;&gt;= 26</span>
<span class="term-fg31">-	orr	r5, r5, r6, asl #6</span>
<span class="term-fg31">-	mov     r6, r6, lsr #26</span>
<span class="term-fg31">-	movw    r14, field_R0			@ c += u2 * R0</span>
<span class="term-fg31">-	umlal   r3, r4, r0, r14</span>
<span class="term-fg31">-	bic	r14, r3, field_not_M 		@ t2 = c &amp; M</span>
<span class="term-fg31">-	str	r14, [sp, #4 + 2*4]</span>
<span class="term-fg31">-	mov	r3, r3, lsr #26     		@ c &gt;&gt;= 26</span>
<span class="term-fg31">-	orr	r3, r3, r4, asl #6</span>
<span class="term-fg31">-	mov     r4, r4, lsr #26</span>
<span class="term-fg31">-	mov     r14, field_R1			@ c += u2 * R1</span>
<span class="term-fg31">-	umlal   r3, r4, r0, r14</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	&#47;* E interleaved with F *&#47;</span>
<span class="term-fg31">-	ldr	r7, [r1, #0*4]			@ a[0]*2</span>
<span class="term-fg31">-	ldr	r0, [r1, #1*4]			@ a[1]*2</span>
<span class="term-fg31">-	ldr	r14, [r1, #2*4]			@ a[2]</span>
<span class="term-fg31">-	mov	r7, r7, asl #1</span>
<span class="term-fg31">-	ldr	r8, [r1, #3*4]			@ a[3]</span>
<span class="term-fg31">-	ldr	r2, [r1, #4*4]</span>
<span class="term-fg31">-	umlal	r3, r4, r7, r8			@ c += a[0]*2 * a[3]</span>
<span class="term-fg31">-	mov	r0, r0, asl #1</span>
<span class="term-fg31">-	umull	r11, r12, r7, r2		@ c&#39; = a[0]*2 * a[4]</span>
<span class="term-fg31">-	mov	r2, r2, asl #1			@ a[4]*2</span>
<span class="term-fg31">-	umlal	r11, r12, r0, r8		@ c&#39; += a[1]*2 * a[3]</span>
<span class="term-fg31">-	ldr	r8, [r1, #9*4]			@ a[9]</span>
<span class="term-fg31">-	umlal	r3, r4, r0, r14			@ c += a[1]*2 * a[2]</span>
<span class="term-fg31">-	ldr	r0, [r1, #5*4]			@ a[5]*2</span>
<span class="term-fg31">-	umlal	r11, r12, r14, r14		@ c&#39; += a[2] * a[2]</span>
<span class="term-fg31">-	ldr	r14, [r1, #8*4]			@ a[8]</span>
<span class="term-fg31">-	mov	r0, r0, asl #1</span>
<span class="term-fg31">-	umlal	r5, r6, r2, r8			@ d += a[4]*2 * a[9]</span>
<span class="term-fg31">-	ldr	r7, [r1, #6*4]			@ a[6]*2</span>
<span class="term-fg31">-	umull	r9, r10, r0, r8			@ d&#39; = a[5]*2 * a[9]</span>
<span class="term-fg31">-	mov	r7, r7, asl #1</span>
<span class="term-fg31">-	ldr	r8, [r1, #7*4]			@ a[7]</span>
<span class="term-fg31">-	umlal	r5, r6, r0, r14			@ d += a[5]*2 * a[8]</span>
<span class="term-fg31">-	umlal	r9, r10, r7, r14		@ d&#39; += a[6]*2 * a[8]</span>
<span class="term-fg31">-	umlal	r5, r6, r7, r8			@ d += a[6]*2 * a[7]</span>
<span class="term-fg31">-	umlal	r9, r10, r8, r8			@ d&#39; += a[7] * a[7]</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	bic	r0, r5, field_not_M 		@ u3 = d &amp; M</span>
<span class="term-fg31">-	mov	r5, r5, lsr #26     		@ d &gt;&gt;= 26</span>
<span class="term-fg31">-	orr	r5, r5, r6, asl #6</span>
<span class="term-fg31">-	mov     r6, r6, lsr #26</span>
<span class="term-fg31">-	movw    r14, field_R0			@ c += u3 * R0</span>
<span class="term-fg31">-	umlal   r3, r4, r0, r14</span>
<span class="term-fg31">-	bic	r14, r3, field_not_M 		@ t3 = c &amp; M</span>
<span class="term-fg31">-	str	r14, [sp, #4 + 3*4]</span>
<span class="term-fg31">-	mov	r3, r3, lsr #26     		@ c &gt;&gt;= 26</span>
<span class="term-fg31">-	orr	r3, r3, r4, asl #6</span>
<span class="term-fg31">-	mov     r4, r4, lsr #26</span>
<span class="term-fg31">-	mov     r14, field_R1			@ c += u3 * R1</span>
<span class="term-fg31">-	umlal   r3, r4, r0, r14</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	&#47;* F *&#47;</span>
<span class="term-fg31">-	adds	r3, r3, r11			@ c += c&#39;</span>
<span class="term-fg31">-	adc	r4, r4, r12</span>
<span class="term-fg31">-	adds	r5, r5, r9			@ d += d&#39;</span>
<span class="term-fg31">-	adc	r6, r6, r10</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	bic	r0, r5, field_not_M 		@ u4 = d &amp; M</span>
<span class="term-fg31">-	mov	r5, r5, lsr #26     		@ d &gt;&gt;= 26</span>
<span class="term-fg31">-	orr	r5, r5, r6, asl #6</span>
<span class="term-fg31">-	mov     r6, r6, lsr #26</span>
<span class="term-fg31">-	movw    r14, field_R0			@ c += u4 * R0</span>
<span class="term-fg31">-	umlal   r3, r4, r0, r14</span>
<span class="term-fg31">-	bic	r14, r3, field_not_M 		@ t4 = c &amp; M</span>
<span class="term-fg31">-	str	r14, [sp, #4 + 4*4]</span>
<span class="term-fg31">-	mov	r3, r3, lsr #26     		@ c &gt;&gt;= 26</span>
<span class="term-fg31">-	orr	r3, r3, r4, asl #6</span>
<span class="term-fg31">-	mov     r4, r4, lsr #26</span>
<span class="term-fg31">-	mov     r14, field_R1			@ c += u4 * R1</span>
<span class="term-fg31">-	umlal   r3, r4, r0, r14</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	&#47;* G interleaved with H *&#47;</span>
<span class="term-fg31">-	ldr	r7, [r1, #0*4]			@ a[0]*2</span>
<span class="term-fg31">-	ldr	r0, [r1, #1*4]			@ a[1]*2</span>
<span class="term-fg31">-	mov	r7, r7, asl #1</span>
<span class="term-fg31">-	ldr	r8, [r1, #5*4]			@ a[5]</span>
<span class="term-fg31">-	ldr	r2, [r1, #6*4]			@ a[6]</span>
<span class="term-fg31">-	umlal	r3, r4, r7, r8			@ c += a[0]*2 * a[5]</span>
<span class="term-fg31">-	ldr	r14, [r1, #4*4]			@ a[4]</span>
<span class="term-fg31">-	mov	r0, r0, asl #1</span>
<span class="term-fg31">-	umull	r11, r12, r7, r2		@ c&#39; = a[0]*2 * a[6]</span>
<span class="term-fg31">-	ldr	r7, [r1, #2*4]			@ a[2]*2</span>
<span class="term-fg31">-	umlal	r11, r12, r0, r8		@ c&#39; += a[1]*2 * a[5]</span>
<span class="term-fg31">-	mov	r7, r7, asl #1</span>
<span class="term-fg31">-	ldr	r8, [r1, #3*4]			@ a[3]</span>
<span class="term-fg31">-	umlal	r3, r4, r0, r14			@ c += a[1]*2 * a[4]</span>
<span class="term-fg31">-	mov	r0, r2, asl #1			@ a[6]*2</span>
<span class="term-fg31">-	umlal	r11, r12, r7, r14		@ c&#39; += a[2]*2 * a[4]</span>
<span class="term-fg31">-	ldr	r14, [r1, #9*4]			@ a[9]</span>
<span class="term-fg31">-	umlal	r3, r4, r7, r8			@ c += a[2]*2 * a[3]</span>
<span class="term-fg31">-	ldr	r7, [r1, #7*4]			@ a[7]*2</span>
<span class="term-fg31">-	umlal	r11, r12, r8, r8		@ c&#39; += a[3] * a[3]</span>
<span class="term-fg31">-	mov	r7, r7, asl #1</span>
<span class="term-fg31">-	ldr	r8, [r1, #8*4]			@ a[8]</span>
<span class="term-fg31">-	umlal	r5, r6, r0, r14			@ d += a[6]*2 * a[9]</span>
<span class="term-fg31">-	umull	r9, r10, r7, r14		@ d&#39; = a[7]*2 * a[9]</span>
<span class="term-fg31">-	umlal	r5, r6, r7, r8			@ d += a[7]*2 * a[8]</span>
<span class="term-fg31">-	umlal	r9, r10, r8, r8			@ d&#39; += a[8] * a[8]</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	bic	r0, r5, field_not_M 		@ u5 = d &amp; M</span>
<span class="term-fg31">-	mov	r5, r5, lsr #26     		@ d &gt;&gt;= 26</span>
<span class="term-fg31">-	orr	r5, r5, r6, asl #6</span>
<span class="term-fg31">-	mov     r6, r6, lsr #26</span>
<span class="term-fg31">-	movw    r14, field_R0			@ c += u5 * R0</span>
<span class="term-fg31">-	umlal   r3, r4, r0, r14</span>
<span class="term-fg31">-	bic	r14, r3, field_not_M 		@ t5 = c &amp; M</span>
<span class="term-fg31">-	str	r14, [sp, #4 + 5*4]</span>
<span class="term-fg31">-	mov	r3, r3, lsr #26     		@ c &gt;&gt;= 26</span>
<span class="term-fg31">-	orr	r3, r3, r4, asl #6</span>
<span class="term-fg31">-	mov     r4, r4, lsr #26</span>
<span class="term-fg31">-	mov     r14, field_R1			@ c += u5 * R1</span>
<span class="term-fg31">-	umlal   r3, r4, r0, r14</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	&#47;* H *&#47;</span>
<span class="term-fg31">-	adds	r3, r3, r11			@ c += c&#39;</span>
<span class="term-fg31">-	adc	r4, r4, r12</span>
<span class="term-fg31">-	adds	r5, r5, r9			@ d += d&#39;</span>
<span class="term-fg31">-	adc	r6, r6, r10</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	bic	r0, r5, field_not_M 		@ u6 = d &amp; M</span>
<span class="term-fg31">-	mov	r5, r5, lsr #26     		@ d &gt;&gt;= 26</span>
<span class="term-fg31">-	orr	r5, r5, r6, asl #6</span>
<span class="term-fg31">-	mov     r6, r6, lsr #26</span>
<span class="term-fg31">-	movw    r14, field_R0			@ c += u6 * R0</span>
<span class="term-fg31">-	umlal   r3, r4, r0, r14</span>
<span class="term-fg31">-	bic	r14, r3, field_not_M 		@ t6 = c &amp; M</span>
<span class="term-fg31">-	str	r14, [sp, #4 + 6*4]</span>
<span class="term-fg31">-	mov	r3, r3, lsr #26     		@ c &gt;&gt;= 26</span>
<span class="term-fg31">-	orr	r3, r3, r4, asl #6</span>
<span class="term-fg31">-	mov     r4, r4, lsr #26</span>
<span class="term-fg31">-	mov     r14, field_R1			@ c += u6 * R1</span>
<span class="term-fg31">-	umlal   r3, r4, r0, r14</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	&#47;* I interleaved with J *&#47;</span>
<span class="term-fg31">-	ldr	r7, [r1, #0*4]			@ a[0]*2</span>
<span class="term-fg31">-	ldr	r0, [r1, #1*4]			@ a[1]*2</span>
<span class="term-fg31">-	mov	r7, r7, asl #1</span>
<span class="term-fg31">-	ldr	r8, [r1, #7*4]			@ a[7]</span>
<span class="term-fg31">-	ldr	r2, [r1, #8*4]			@ a[8]</span>
<span class="term-fg31">-	umlal	r3, r4, r7, r8			@ c += a[0]*2 * a[7]</span>
<span class="term-fg31">-	ldr	r14, [r1, #6*4]			@ a[6]</span>
<span class="term-fg31">-	mov	r0, r0, asl #1</span>
<span class="term-fg31">-	umull	r11, r12, r7, r2		@ c&#39; = a[0]*2 * a[8]</span>
<span class="term-fg31">-	ldr	r7, [r1, #2*4]			@ a[2]*2</span>
<span class="term-fg31">-	umlal	r11, r12, r0, r8		@ c&#39; += a[1]*2 * a[7]</span>
<span class="term-fg31">-	ldr	r8, [r1, #5*4]			@ a[5]</span>
<span class="term-fg31">-	umlal	r3, r4, r0, r14			@ c += a[1]*2 * a[6]</span>
<span class="term-fg31">-	ldr	r0, [r1, #3*4]			@ a[3]*2</span>
<span class="term-fg31">-	mov	r7, r7, asl #1</span>
<span class="term-fg31">-	umlal	r11, r12, r7, r14		@ c&#39; += a[2]*2 * a[6]</span>
<span class="term-fg31">-	ldr	r14, [r1, #4*4]			@ a[4]</span>
<span class="term-fg31">-	mov	r0, r0, asl #1</span>
<span class="term-fg31">-	umlal	r3, r4, r7, r8			@ c += a[2]*2 * a[5]</span>
<span class="term-fg31">-	mov	r2, r2, asl #1			@ a[8]*2</span>
<span class="term-fg31">-	umlal	r11, r12, r0, r8		@ c&#39; += a[3]*2 * a[5]</span>
<span class="term-fg31">-	umlal	r3, r4, r0, r14			@ c += a[3]*2 * a[4]</span>
<span class="term-fg31">-	umlal	r11, r12, r14, r14		@ c&#39; += a[4] * a[4]</span>
<span class="term-fg31">-	ldr	r8, [r1, #9*4]			@ a[9]</span>
<span class="term-fg31">-	umlal	r5, r6, r2, r8			@ d += a[8]*2 * a[9]</span>
<span class="term-fg31">-	@ r8 will be used in J</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	bic	r0, r5, field_not_M 		@ u7 = d &amp; M</span>
<span class="term-fg31">-	mov	r5, r5, lsr #26     		@ d &gt;&gt;= 26</span>
<span class="term-fg31">-	orr	r5, r5, r6, asl #6</span>
<span class="term-fg31">-	mov     r6, r6, lsr #26</span>
<span class="term-fg31">-	movw    r14, field_R0			@ c += u7 * R0</span>
<span class="term-fg31">-	umlal   r3, r4, r0, r14</span>
<span class="term-fg31">-	bic	r14, r3, field_not_M 		@ t7 = c &amp; M</span>
<span class="term-fg31">-	str	r14, [sp, #4 + 7*4]</span>
<span class="term-fg31">-	mov	r3, r3, lsr #26     		@ c &gt;&gt;= 26</span>
<span class="term-fg31">-	orr	r3, r3, r4, asl #6</span>
<span class="term-fg31">-	mov     r4, r4, lsr #26</span>
<span class="term-fg31">-	mov     r14, field_R1			@ c += u7 * R1</span>
<span class="term-fg31">-	umlal   r3, r4, r0, r14</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	&#47;* J *&#47;</span>
<span class="term-fg31">-	adds	r3, r3, r11			@ c += c&#39;</span>
<span class="term-fg31">-	adc	r4, r4, r12</span>
<span class="term-fg31">-	umlal	r5, r6, r8, r8			@ d += a[9] * a[9]</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	bic	r0, r5, field_not_M 		@ u8 = d &amp; M</span>
<span class="term-fg31">-	str	r0, [sp, #4 + 8*4]</span>
<span class="term-fg31">-	mov	r5, r5, lsr #26     		@ d &gt;&gt;= 26</span>
<span class="term-fg31">-	orr	r5, r5, r6, asl #6</span>
<span class="term-fg31">-	mov     r6, r6, lsr #26</span>
<span class="term-fg31">-	movw    r14, field_R0			@ c += u8 * R0</span>
<span class="term-fg31">-	umlal   r3, r4, r0, r14</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	&#47;******************************************</span>
<span class="term-fg31">-	 * compute and write back result</span>
<span class="term-fg31">-	 ******************************************</span>
<span class="term-fg31">-	Allocation:</span>
<span class="term-fg31">-	    r0    r</span>
<span class="term-fg31">-	    r3:r4 c</span>
<span class="term-fg31">-	    r5:r6 d</span>
<span class="term-fg31">-	    r7    t0</span>
<span class="term-fg31">-	    r8    t1</span>
<span class="term-fg31">-	    r9    t2</span>
<span class="term-fg31">-	    r11   u8</span>
<span class="term-fg31">-	    r12   t9</span>
<span class="term-fg31">-	    r1,r2,r10,r14 scratch</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	Note: do not read from a[] after here, it may overlap with r[]</span>
<span class="term-fg31">-	*&#47;</span>
<span class="term-fg31">-	ldr	r0, [sp, #0]</span>
<span class="term-fg31">-	add	r1, sp, #4 + 3*4		@ r[3..7] = t3..7, r11=u8, r12=t9</span>
<span class="term-fg31">-	ldmia	r1, {r2,r7,r8,r9,r10,r11,r12}</span>
<span class="term-fg31">-	add	r1, r0, #3*4</span>
<span class="term-fg31">-	stmia	r1, {r2,r7,r8,r9,r10}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	bic	r2, r3, field_not_M 		@ r[8] = c &amp; M</span>
<span class="term-fg31">-	str	r2, [r0, #8*4]</span>
<span class="term-fg31">-	mov	r3, r3, lsr #26     		@ c &gt;&gt;= 26</span>
<span class="term-fg31">-	orr	r3, r3, r4, asl #6</span>
<span class="term-fg31">-	mov     r4, r4, lsr #26</span>
<span class="term-fg31">-	mov     r14, field_R1			@ c += u8 * R1</span>
<span class="term-fg31">-	umlal   r3, r4, r11, r14</span>
<span class="term-fg31">-	movw    r14, field_R0			@ c += d * R0</span>
<span class="term-fg31">-	umlal   r3, r4, r5, r14</span>
<span class="term-fg31">-	adds	r3, r3, r12			@ c += t9</span>
<span class="term-fg31">-	adc	r4, r4, #0</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	add	r1, sp, #4 + 0*4		@ r7,r8,r9 = t0,t1,t2</span>
<span class="term-fg31">-	ldmia	r1, {r7,r8,r9}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	ubfx	r2, r3, #0, #22     		@ r[9] = c &amp; (M &gt;&gt; 4)</span>
<span class="term-fg31">-	str	r2, [r0, #9*4]</span>
<span class="term-fg31">-	mov	r3, r3, lsr #22     		@ c &gt;&gt;= 22</span>
<span class="term-fg31">-	orr	r3, r3, r4, asl #10</span>
<span class="term-fg31">-	mov     r4, r4, lsr #22</span>
<span class="term-fg31">-	movw    r14, field_R1 &lt;&lt; 4   		@ c += d * (R1 &lt;&lt; 4)</span>
<span class="term-fg31">-	umlal   r3, r4, r5, r14</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	movw    r14, field_R0 &gt;&gt; 4   		@ d = c * (R0 &gt;&gt; 4) + t0 (64x64 multiply+add)</span>
<span class="term-fg31">-	umull	r5, r6, r3, r14			@ d = c.lo * (R0 &gt;&gt; 4)</span>
<span class="term-fg31">-	adds	r5, r5, r7	    		@ d.lo += t0</span>
<span class="term-fg31">-	mla	r6, r14, r4, r6			@ d.hi += c.hi * (R0 &gt;&gt; 4)</span>
<span class="term-fg31">-	adc	r6, r6, 0	     		@ d.hi += carry</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	bic	r2, r5, field_not_M 		@ r[0] = d &amp; M</span>
<span class="term-fg31">-	str	r2, [r0, #0*4]</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	mov	r5, r5, lsr #26     		@ d &gt;&gt;= 26</span>
<span class="term-fg31">-	orr	r5, r5, r6, asl #6</span>
<span class="term-fg31">-	mov     r6, r6, lsr #26</span>
<span class="term-fg31">-	</span>
<span class="term-fg31">-	movw    r14, field_R1 &gt;&gt; 4   		@ d += c * (R1 &gt;&gt; 4) + t1 (64x64 multiply+add)</span>
<span class="term-fg31">-	umull	r1, r2, r3, r14       		@ tmp = c.lo * (R1 &gt;&gt; 4)</span>
<span class="term-fg31">-	adds	r5, r5, r8	    		@ d.lo += t1</span>
<span class="term-fg31">-	adc	r6, r6, #0	    		@ d.hi += carry</span>
<span class="term-fg31">-	adds	r5, r5, r1	    		@ d.lo += tmp.lo</span>
<span class="term-fg31">-	mla	r2, r14, r4, r2      		@ tmp.hi += c.hi * (R1 &gt;&gt; 4)</span>
<span class="term-fg31">-	adc	r6, r6, r2	   		@ d.hi += carry + tmp.hi</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	bic	r2, r5, field_not_M 		@ r[1] = d &amp; M</span>
<span class="term-fg31">-	str	r2, [r0, #1*4]</span>
<span class="term-fg31">-	mov	r5, r5, lsr #26     		@ d &gt;&gt;= 26 (ignore hi)</span>
<span class="term-fg31">-	orr	r5, r5, r6, asl #6</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	add	r5, r5, r9	  		@ d += t2</span>
<span class="term-fg31">-	str	r5, [r0, #2*4]      		@ r[2] = d</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	add	sp, sp, #48</span>
<span class="term-fg31">-	ldmfd	sp!, {r4, r5, r6, r7, r8, r9, r10, r11, pc}</span>
<span class="term-fg31">-	.size	secp256k1_fe_sqr_inner, .-secp256k1_fe_sqr_inner</span>
<span class="term-fg31">-</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-5872b99909e3d07666d492f3" role="button"
                       aria-expanded="false" aria-controls="id-5872b99909e3d07666d492f3">
                        <code>crypto/secp256k1/libsecp256k1/src/basic-config.h</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/basic-config.h" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-32</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-5872b99909e3d07666d492f3"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;basic-config.h op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;basic-config.h</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index c4c16eb7ca7dc9313430809cfc964bf5055d2831..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;basic-config.h</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,32 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2013, 2014 Pieter Wuille                             *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef _SECP256K1_BASIC_CONFIG_</span>
<span class="term-fg31">-#define _SECP256K1_BASIC_CONFIG_</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef USE_BASIC_CONFIG</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#undef USE_ASM_X86_64</span>
<span class="term-fg31">-#undef USE_ENDOMORPHISM</span>
<span class="term-fg31">-#undef USE_FIELD_10X26</span>
<span class="term-fg31">-#undef USE_FIELD_5X52</span>
<span class="term-fg31">-#undef USE_FIELD_INV_BUILTIN</span>
<span class="term-fg31">-#undef USE_FIELD_INV_NUM</span>
<span class="term-fg31">-#undef USE_NUM_GMP</span>
<span class="term-fg31">-#undef USE_NUM_NONE</span>
<span class="term-fg31">-#undef USE_SCALAR_4X64</span>
<span class="term-fg31">-#undef USE_SCALAR_8X32</span>
<span class="term-fg31">-#undef USE_SCALAR_INV_BUILTIN</span>
<span class="term-fg31">-#undef USE_SCALAR_INV_NUM</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#define USE_NUM_NONE 1</span>
<span class="term-fg31">-#define USE_FIELD_INV_BUILTIN 1</span>
<span class="term-fg31">-#define USE_SCALAR_INV_BUILTIN 1</span>
<span class="term-fg31">-#define USE_FIELD_10X26 1</span>
<span class="term-fg31">-#define USE_SCALAR_8X32 1</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#endif &#47;&#47; USE_BASIC_CONFIG</span>
<span class="term-fg31">-#endif &#47;&#47; _SECP256K1_BASIC_CONFIG_</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-2a2eafc99af950207707e62e" role="button"
                       aria-expanded="false" aria-controls="id-2a2eafc99af950207707e62e">
                        <code>crypto/secp256k1/libsecp256k1/src/bench.h</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/bench.h" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-66</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-2a2eafc99af950207707e62e"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;bench.h op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;bench.h</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 3a71b4aafa048d9ba79ad1fcb432139f94550a6c..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;bench.h</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,66 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2014 Pieter Wuille                                   *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef _SECP256K1_BENCH_H_</span>
<span class="term-fg31">-#define _SECP256K1_BENCH_H_</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &lt;stdio.h&gt;</span>
<span class="term-fg31">-#include &lt;math.h&gt;</span>
<span class="term-fg31">-#include &quot;sys&#47;time.h&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static double gettimedouble(void) {</span>
<span class="term-fg31">-    struct timeval tv;</span>
<span class="term-fg31">-    gettimeofday(&amp;tv, NULL);</span>
<span class="term-fg31">-    return tv.tv_usec * 0.000001 + tv.tv_sec;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void print_number(double x) {</span>
<span class="term-fg31">-    double y = x;</span>
<span class="term-fg31">-    int c = 0;</span>
<span class="term-fg31">-    if (y &lt; 0.0) {</span>
<span class="term-fg31">-        y = -y;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    while (y &lt; 100.0) {</span>
<span class="term-fg31">-        y *= 10.0;</span>
<span class="term-fg31">-        c++;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    printf(&quot;%.*f&quot;, c, x);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void run_benchmark(char *name, void (*benchmark)(void*), void (*setup)(void*), void (*teardown)(void*), void* data, int count, int iter) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    double min = HUGE_VAL;</span>
<span class="term-fg31">-    double sum = 0.0;</span>
<span class="term-fg31">-    double max = 0.0;</span>
<span class="term-fg31">-    for (i = 0; i &lt; count; i++) {</span>
<span class="term-fg31">-        double begin, total;</span>
<span class="term-fg31">-        if (setup != NULL) {</span>
<span class="term-fg31">-            setup(data);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        begin = gettimedouble();</span>
<span class="term-fg31">-        benchmark(data);</span>
<span class="term-fg31">-        total = gettimedouble() - begin;</span>
<span class="term-fg31">-        if (teardown != NULL) {</span>
<span class="term-fg31">-            teardown(data);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        if (total &lt; min) {</span>
<span class="term-fg31">-            min = total;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        if (total &gt; max) {</span>
<span class="term-fg31">-            max = total;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        sum += total;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    printf(&quot;%s: min &quot;, name);</span>
<span class="term-fg31">-    print_number(min * 1000000.0 &#47; iter);</span>
<span class="term-fg31">-    printf(&quot;us &#47; avg &quot;);</span>
<span class="term-fg31">-    print_number((sum &#47; count) * 1000000.0 &#47; iter);</span>
<span class="term-fg31">-    printf(&quot;us &#47; max &quot;);</span>
<span class="term-fg31">-    print_number(max * 1000000.0 &#47; iter);</span>
<span class="term-fg31">-    printf(&quot;us\n&quot;);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-5f284a518f735a6c4dea941d" role="button"
                       aria-expanded="false" aria-controls="id-5f284a518f735a6c4dea941d">
                        <code>crypto/secp256k1/libsecp256k1/src/bench_ecdh.c</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/bench_ecdh.c" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-54</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-5f284a518f735a6c4dea941d"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;bench_ecdh.c op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;bench_ecdh.c</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index cde5e2dbb4e4ea1bd4fedced7ba1fecea7de8aa1..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;bench_ecdh.c</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,54 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2015 Pieter Wuille, Andrew Poelstra                  *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &lt;string.h&gt;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &quot;include&#47;secp256k1.h&quot;</span>
<span class="term-fg31">-#include &quot;include&#47;secp256k1_ecdh.h&quot;</span>
<span class="term-fg31">-#include &quot;util.h&quot;</span>
<span class="term-fg31">-#include &quot;bench.h&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-typedef struct {</span>
<span class="term-fg31">-    secp256k1_context *ctx;</span>
<span class="term-fg31">-    secp256k1_pubkey point;</span>
<span class="term-fg31">-    unsigned char scalar[32];</span>
<span class="term-fg31">-} bench_ecdh_t;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void bench_ecdh_setup(void* arg) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    bench_ecdh_t *data = (bench_ecdh_t*)arg;</span>
<span class="term-fg31">-    const unsigned char point[] = {</span>
<span class="term-fg31">-        0x03,</span>
<span class="term-fg31">-        0x54, 0x94, 0xc1, 0x5d, 0x32, 0x09, 0x97, 0x06,</span>
<span class="term-fg31">-        0xc2, 0x39, 0x5f, 0x94, 0x34, 0x87, 0x45, 0xfd,</span>
<span class="term-fg31">-        0x75, 0x7c, 0xe3, 0x0e, 0x4e, 0x8c, 0x90, 0xfb,</span>
<span class="term-fg31">-        0xa2, 0xba, 0xd1, 0x84, 0xf8, 0x83, 0xc6, 0x9f</span>
<span class="term-fg31">-    };</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* create a context with no capabilities *&#47;</span>
<span class="term-fg31">-    data-&gt;ctx = secp256k1_context_create(SECP256K1_FLAGS_TYPE_CONTEXT);</span>
<span class="term-fg31">-    for (i = 0; i &lt; 32; i++) {</span>
<span class="term-fg31">-        data-&gt;scalar[i] = i + 1;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_parse(data-&gt;ctx, &amp;data-&gt;point, point, sizeof(point)) == 1);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void bench_ecdh(void* arg) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    unsigned char res[32];</span>
<span class="term-fg31">-    bench_ecdh_t *data = (bench_ecdh_t*)arg;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    for (i = 0; i &lt; 20000; i++) {</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdh(data-&gt;ctx, res, &amp;data-&gt;point, data-&gt;scalar) == 1);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-int main(void) {</span>
<span class="term-fg31">-    bench_ecdh_t data;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    run_benchmark(&quot;ecdh&quot;, bench_ecdh, bench_ecdh_setup, NULL, &amp;data, 10, 20000);</span>
<span class="term-fg31">-    return 0;</span>
<span class="term-fg31">-}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-4f91de0522f2f86e86cf9b4c" role="button"
                       aria-expanded="false" aria-controls="id-4f91de0522f2f86e86cf9b4c">
                        <code>crypto/secp256k1/libsecp256k1/src/bench_internal.c</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/bench_internal.c" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-382</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-4f91de0522f2f86e86cf9b4c"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;bench_internal.c op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;bench_internal.c</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 0809f77bda108dacd5a9a2c6208827c985f00f54..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;bench_internal.c</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,382 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2014-2015 Pieter Wuille                              *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-#include &lt;stdio.h&gt;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &quot;include&#47;secp256k1.h&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &quot;util.h&quot;</span>
<span class="term-fg31">-#include &quot;hash_impl.h&quot;</span>
<span class="term-fg31">-#include &quot;num_impl.h&quot;</span>
<span class="term-fg31">-#include &quot;field_impl.h&quot;</span>
<span class="term-fg31">-#include &quot;group_impl.h&quot;</span>
<span class="term-fg31">-#include &quot;scalar_impl.h&quot;</span>
<span class="term-fg31">-#include &quot;ecmult_const_impl.h&quot;</span>
<span class="term-fg31">-#include &quot;ecmult_impl.h&quot;</span>
<span class="term-fg31">-#include &quot;bench.h&quot;</span>
<span class="term-fg31">-#include &quot;secp256k1.c&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-typedef struct {</span>
<span class="term-fg31">-    secp256k1_scalar scalar_x, scalar_y;</span>
<span class="term-fg31">-    secp256k1_fe fe_x, fe_y;</span>
<span class="term-fg31">-    secp256k1_ge ge_x, ge_y;</span>
<span class="term-fg31">-    secp256k1_gej gej_x, gej_y;</span>
<span class="term-fg31">-    unsigned char data[64];</span>
<span class="term-fg31">-    int wnaf[256];</span>
<span class="term-fg31">-} bench_inv_t;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void bench_setup(void* arg) {</span>
<span class="term-fg31">-    bench_inv_t *data = (bench_inv_t*)arg;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    static const unsigned char init_x[32] = {</span>
<span class="term-fg31">-        0x02, 0x03, 0x05, 0x07, 0x0b, 0x0d, 0x11, 0x13,</span>
<span class="term-fg31">-        0x17, 0x1d, 0x1f, 0x25, 0x29, 0x2b, 0x2f, 0x35,</span>
<span class="term-fg31">-        0x3b, 0x3d, 0x43, 0x47, 0x49, 0x4f, 0x53, 0x59,</span>
<span class="term-fg31">-        0x61, 0x65, 0x67, 0x6b, 0x6d, 0x71, 0x7f, 0x83</span>
<span class="term-fg31">-    };</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    static const unsigned char init_y[32] = {</span>
<span class="term-fg31">-        0x82, 0x83, 0x85, 0x87, 0x8b, 0x8d, 0x81, 0x83,</span>
<span class="term-fg31">-        0x97, 0xad, 0xaf, 0xb5, 0xb9, 0xbb, 0xbf, 0xc5,</span>
<span class="term-fg31">-        0xdb, 0xdd, 0xe3, 0xe7, 0xe9, 0xef, 0xf3, 0xf9,</span>
<span class="term-fg31">-        0x11, 0x15, 0x17, 0x1b, 0x1d, 0xb1, 0xbf, 0xd3</span>
<span class="term-fg31">-    };</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_scalar_set_b32(&amp;data-&gt;scalar_x, init_x, NULL);</span>
<span class="term-fg31">-    secp256k1_scalar_set_b32(&amp;data-&gt;scalar_y, init_y, NULL);</span>
<span class="term-fg31">-    secp256k1_fe_set_b32(&amp;data-&gt;fe_x, init_x);</span>
<span class="term-fg31">-    secp256k1_fe_set_b32(&amp;data-&gt;fe_y, init_y);</span>
<span class="term-fg31">-    CHECK(secp256k1_ge_set_xo_var(&amp;data-&gt;ge_x, &amp;data-&gt;fe_x, 0));</span>
<span class="term-fg31">-    CHECK(secp256k1_ge_set_xo_var(&amp;data-&gt;ge_y, &amp;data-&gt;fe_y, 1));</span>
<span class="term-fg31">-    secp256k1_gej_set_ge(&amp;data-&gt;gej_x, &amp;data-&gt;ge_x);</span>
<span class="term-fg31">-    secp256k1_gej_set_ge(&amp;data-&gt;gej_y, &amp;data-&gt;ge_y);</span>
<span class="term-fg31">-    memcpy(data-&gt;data, init_x, 32);</span>
<span class="term-fg31">-    memcpy(data-&gt;data + 32, init_y, 32);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void bench_scalar_add(void* arg) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    bench_inv_t *data = (bench_inv_t*)arg;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    for (i = 0; i &lt; 2000000; i++) {</span>
<span class="term-fg31">-        secp256k1_scalar_add(&amp;data-&gt;scalar_x, &amp;data-&gt;scalar_x, &amp;data-&gt;scalar_y);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void bench_scalar_negate(void* arg) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    bench_inv_t *data = (bench_inv_t*)arg;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    for (i = 0; i &lt; 2000000; i++) {</span>
<span class="term-fg31">-        secp256k1_scalar_negate(&amp;data-&gt;scalar_x, &amp;data-&gt;scalar_x);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void bench_scalar_sqr(void* arg) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    bench_inv_t *data = (bench_inv_t*)arg;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    for (i = 0; i &lt; 200000; i++) {</span>
<span class="term-fg31">-        secp256k1_scalar_sqr(&amp;data-&gt;scalar_x, &amp;data-&gt;scalar_x);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void bench_scalar_mul(void* arg) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    bench_inv_t *data = (bench_inv_t*)arg;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    for (i = 0; i &lt; 200000; i++) {</span>
<span class="term-fg31">-        secp256k1_scalar_mul(&amp;data-&gt;scalar_x, &amp;data-&gt;scalar_x, &amp;data-&gt;scalar_y);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef USE_ENDOMORPHISM</span>
<span class="term-fg31">-void bench_scalar_split(void* arg) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    bench_inv_t *data = (bench_inv_t*)arg;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    for (i = 0; i &lt; 20000; i++) {</span>
<span class="term-fg31">-        secp256k1_scalar l, r;</span>
<span class="term-fg31">-        secp256k1_scalar_split_lambda(&amp;l, &amp;r, &amp;data-&gt;scalar_x);</span>
<span class="term-fg31">-        secp256k1_scalar_add(&amp;data-&gt;scalar_x, &amp;data-&gt;scalar_x, &amp;data-&gt;scalar_y);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void bench_scalar_inverse(void* arg) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    bench_inv_t *data = (bench_inv_t*)arg;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    for (i = 0; i &lt; 2000; i++) {</span>
<span class="term-fg31">-        secp256k1_scalar_inverse(&amp;data-&gt;scalar_x, &amp;data-&gt;scalar_x);</span>
<span class="term-fg31">-        secp256k1_scalar_add(&amp;data-&gt;scalar_x, &amp;data-&gt;scalar_x, &amp;data-&gt;scalar_y);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void bench_scalar_inverse_var(void* arg) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    bench_inv_t *data = (bench_inv_t*)arg;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    for (i = 0; i &lt; 2000; i++) {</span>
<span class="term-fg31">-        secp256k1_scalar_inverse_var(&amp;data-&gt;scalar_x, &amp;data-&gt;scalar_x);</span>
<span class="term-fg31">-        secp256k1_scalar_add(&amp;data-&gt;scalar_x, &amp;data-&gt;scalar_x, &amp;data-&gt;scalar_y);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void bench_field_normalize(void* arg) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    bench_inv_t *data = (bench_inv_t*)arg;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    for (i = 0; i &lt; 2000000; i++) {</span>
<span class="term-fg31">-        secp256k1_fe_normalize(&amp;data-&gt;fe_x);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void bench_field_normalize_weak(void* arg) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    bench_inv_t *data = (bench_inv_t*)arg;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    for (i = 0; i &lt; 2000000; i++) {</span>
<span class="term-fg31">-        secp256k1_fe_normalize_weak(&amp;data-&gt;fe_x);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void bench_field_mul(void* arg) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    bench_inv_t *data = (bench_inv_t*)arg;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    for (i = 0; i &lt; 200000; i++) {</span>
<span class="term-fg31">-        secp256k1_fe_mul(&amp;data-&gt;fe_x, &amp;data-&gt;fe_x, &amp;data-&gt;fe_y);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void bench_field_sqr(void* arg) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    bench_inv_t *data = (bench_inv_t*)arg;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    for (i = 0; i &lt; 200000; i++) {</span>
<span class="term-fg31">-        secp256k1_fe_sqr(&amp;data-&gt;fe_x, &amp;data-&gt;fe_x);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void bench_field_inverse(void* arg) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    bench_inv_t *data = (bench_inv_t*)arg;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    for (i = 0; i &lt; 20000; i++) {</span>
<span class="term-fg31">-        secp256k1_fe_inv(&amp;data-&gt;fe_x, &amp;data-&gt;fe_x);</span>
<span class="term-fg31">-        secp256k1_fe_add(&amp;data-&gt;fe_x, &amp;data-&gt;fe_y);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void bench_field_inverse_var(void* arg) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    bench_inv_t *data = (bench_inv_t*)arg;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    for (i = 0; i &lt; 20000; i++) {</span>
<span class="term-fg31">-        secp256k1_fe_inv_var(&amp;data-&gt;fe_x, &amp;data-&gt;fe_x);</span>
<span class="term-fg31">-        secp256k1_fe_add(&amp;data-&gt;fe_x, &amp;data-&gt;fe_y);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void bench_field_sqrt(void* arg) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    bench_inv_t *data = (bench_inv_t*)arg;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    for (i = 0; i &lt; 20000; i++) {</span>
<span class="term-fg31">-        secp256k1_fe_sqrt(&amp;data-&gt;fe_x, &amp;data-&gt;fe_x);</span>
<span class="term-fg31">-        secp256k1_fe_add(&amp;data-&gt;fe_x, &amp;data-&gt;fe_y);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void bench_group_double_var(void* arg) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    bench_inv_t *data = (bench_inv_t*)arg;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    for (i = 0; i &lt; 200000; i++) {</span>
<span class="term-fg31">-        secp256k1_gej_double_var(&amp;data-&gt;gej_x, &amp;data-&gt;gej_x, NULL);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void bench_group_add_var(void* arg) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    bench_inv_t *data = (bench_inv_t*)arg;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    for (i = 0; i &lt; 200000; i++) {</span>
<span class="term-fg31">-        secp256k1_gej_add_var(&amp;data-&gt;gej_x, &amp;data-&gt;gej_x, &amp;data-&gt;gej_y, NULL);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void bench_group_add_affine(void* arg) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    bench_inv_t *data = (bench_inv_t*)arg;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    for (i = 0; i &lt; 200000; i++) {</span>
<span class="term-fg31">-        secp256k1_gej_add_ge(&amp;data-&gt;gej_x, &amp;data-&gt;gej_x, &amp;data-&gt;ge_y);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void bench_group_add_affine_var(void* arg) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    bench_inv_t *data = (bench_inv_t*)arg;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    for (i = 0; i &lt; 200000; i++) {</span>
<span class="term-fg31">-        secp256k1_gej_add_ge_var(&amp;data-&gt;gej_x, &amp;data-&gt;gej_x, &amp;data-&gt;ge_y, NULL);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void bench_group_jacobi_var(void* arg) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    bench_inv_t *data = (bench_inv_t*)arg;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    for (i = 0; i &lt; 20000; i++) {</span>
<span class="term-fg31">-        secp256k1_gej_has_quad_y_var(&amp;data-&gt;gej_x);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void bench_ecmult_wnaf(void* arg) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    bench_inv_t *data = (bench_inv_t*)arg;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    for (i = 0; i &lt; 20000; i++) {</span>
<span class="term-fg31">-        secp256k1_ecmult_wnaf(data-&gt;wnaf, 256, &amp;data-&gt;scalar_x, WINDOW_A);</span>
<span class="term-fg31">-        secp256k1_scalar_add(&amp;data-&gt;scalar_x, &amp;data-&gt;scalar_x, &amp;data-&gt;scalar_y);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void bench_wnaf_const(void* arg) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    bench_inv_t *data = (bench_inv_t*)arg;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    for (i = 0; i &lt; 20000; i++) {</span>
<span class="term-fg31">-        secp256k1_wnaf_const(data-&gt;wnaf, data-&gt;scalar_x, WINDOW_A);</span>
<span class="term-fg31">-        secp256k1_scalar_add(&amp;data-&gt;scalar_x, &amp;data-&gt;scalar_x, &amp;data-&gt;scalar_y);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void bench_sha256(void* arg) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    bench_inv_t *data = (bench_inv_t*)arg;</span>
<span class="term-fg31">-    secp256k1_sha256_t sha;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    for (i = 0; i &lt; 20000; i++) {</span>
<span class="term-fg31">-        secp256k1_sha256_initialize(&amp;sha);</span>
<span class="term-fg31">-        secp256k1_sha256_write(&amp;sha, data-&gt;data, 32);</span>
<span class="term-fg31">-        secp256k1_sha256_finalize(&amp;sha, data-&gt;data);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void bench_hmac_sha256(void* arg) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    bench_inv_t *data = (bench_inv_t*)arg;</span>
<span class="term-fg31">-    secp256k1_hmac_sha256_t hmac;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    for (i = 0; i &lt; 20000; i++) {</span>
<span class="term-fg31">-        secp256k1_hmac_sha256_initialize(&amp;hmac, data-&gt;data, 32);</span>
<span class="term-fg31">-        secp256k1_hmac_sha256_write(&amp;hmac, data-&gt;data, 32);</span>
<span class="term-fg31">-        secp256k1_hmac_sha256_finalize(&amp;hmac, data-&gt;data);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void bench_rfc6979_hmac_sha256(void* arg) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    bench_inv_t *data = (bench_inv_t*)arg;</span>
<span class="term-fg31">-    secp256k1_rfc6979_hmac_sha256_t rng;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    for (i = 0; i &lt; 20000; i++) {</span>
<span class="term-fg31">-        secp256k1_rfc6979_hmac_sha256_initialize(&amp;rng, data-&gt;data, 64);</span>
<span class="term-fg31">-        secp256k1_rfc6979_hmac_sha256_generate(&amp;rng, data-&gt;data, 32);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void bench_context_verify(void* arg) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    (void)arg;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 20; i++) {</span>
<span class="term-fg31">-        secp256k1_context_destroy(secp256k1_context_create(SECP256K1_CONTEXT_VERIFY));</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void bench_context_sign(void* arg) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    (void)arg;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 200; i++) {</span>
<span class="term-fg31">-        secp256k1_context_destroy(secp256k1_context_create(SECP256K1_CONTEXT_SIGN));</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef USE_NUM_NONE</span>
<span class="term-fg31">-void bench_num_jacobi(void* arg) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    bench_inv_t *data = (bench_inv_t*)arg;</span>
<span class="term-fg31">-    secp256k1_num nx, norder;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_scalar_get_num(&amp;nx, &amp;data-&gt;scalar_x);</span>
<span class="term-fg31">-    secp256k1_scalar_order_get_num(&amp;norder);</span>
<span class="term-fg31">-    secp256k1_scalar_get_num(&amp;norder, &amp;data-&gt;scalar_y);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    for (i = 0; i &lt; 200000; i++) {</span>
<span class="term-fg31">-        secp256k1_num_jacobi(&amp;nx, &amp;norder);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-int have_flag(int argc, char** argv, char *flag) {</span>
<span class="term-fg31">-    char** argm = argv + argc;</span>
<span class="term-fg31">-    argv++;</span>
<span class="term-fg31">-    if (argv == argm) {</span>
<span class="term-fg31">-        return 1;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    while (argv != NULL &amp;&amp; argv != argm) {</span>
<span class="term-fg31">-        if (strcmp(*argv, flag) == 0) {</span>
<span class="term-fg31">-            return 1;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        argv++;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    return 0;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-int main(int argc, char **argv) {</span>
<span class="term-fg31">-    bench_inv_t data;</span>
<span class="term-fg31">-    if (have_flag(argc, argv, &quot;scalar&quot;) || have_flag(argc, argv, &quot;add&quot;)) run_benchmark(&quot;scalar_add&quot;, bench_scalar_add, bench_setup, NULL, &amp;data, 10, 2000000);</span>
<span class="term-fg31">-    if (have_flag(argc, argv, &quot;scalar&quot;) || have_flag(argc, argv, &quot;negate&quot;)) run_benchmark(&quot;scalar_negate&quot;, bench_scalar_negate, bench_setup, NULL, &amp;data, 10, 2000000);</span>
<span class="term-fg31">-    if (have_flag(argc, argv, &quot;scalar&quot;) || have_flag(argc, argv, &quot;sqr&quot;)) run_benchmark(&quot;scalar_sqr&quot;, bench_scalar_sqr, bench_setup, NULL, &amp;data, 10, 200000);</span>
<span class="term-fg31">-    if (have_flag(argc, argv, &quot;scalar&quot;) || have_flag(argc, argv, &quot;mul&quot;)) run_benchmark(&quot;scalar_mul&quot;, bench_scalar_mul, bench_setup, NULL, &amp;data, 10, 200000);</span>
<span class="term-fg31">-#ifdef USE_ENDOMORPHISM</span>
<span class="term-fg31">-    if (have_flag(argc, argv, &quot;scalar&quot;) || have_flag(argc, argv, &quot;split&quot;)) run_benchmark(&quot;scalar_split&quot;, bench_scalar_split, bench_setup, NULL, &amp;data, 10, 20000);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-    if (have_flag(argc, argv, &quot;scalar&quot;) || have_flag(argc, argv, &quot;inverse&quot;)) run_benchmark(&quot;scalar_inverse&quot;, bench_scalar_inverse, bench_setup, NULL, &amp;data, 10, 2000);</span>
<span class="term-fg31">-    if (have_flag(argc, argv, &quot;scalar&quot;) || have_flag(argc, argv, &quot;inverse&quot;)) run_benchmark(&quot;scalar_inverse_var&quot;, bench_scalar_inverse_var, bench_setup, NULL, &amp;data, 10, 2000);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    if (have_flag(argc, argv, &quot;field&quot;) || have_flag(argc, argv, &quot;normalize&quot;)) run_benchmark(&quot;field_normalize&quot;, bench_field_normalize, bench_setup, NULL, &amp;data, 10, 2000000);</span>
<span class="term-fg31">-    if (have_flag(argc, argv, &quot;field&quot;) || have_flag(argc, argv, &quot;normalize&quot;)) run_benchmark(&quot;field_normalize_weak&quot;, bench_field_normalize_weak, bench_setup, NULL, &amp;data, 10, 2000000);</span>
<span class="term-fg31">-    if (have_flag(argc, argv, &quot;field&quot;) || have_flag(argc, argv, &quot;sqr&quot;)) run_benchmark(&quot;field_sqr&quot;, bench_field_sqr, bench_setup, NULL, &amp;data, 10, 200000);</span>
<span class="term-fg31">-    if (have_flag(argc, argv, &quot;field&quot;) || have_flag(argc, argv, &quot;mul&quot;)) run_benchmark(&quot;field_mul&quot;, bench_field_mul, bench_setup, NULL, &amp;data, 10, 200000);</span>
<span class="term-fg31">-    if (have_flag(argc, argv, &quot;field&quot;) || have_flag(argc, argv, &quot;inverse&quot;)) run_benchmark(&quot;field_inverse&quot;, bench_field_inverse, bench_setup, NULL, &amp;data, 10, 20000);</span>
<span class="term-fg31">-    if (have_flag(argc, argv, &quot;field&quot;) || have_flag(argc, argv, &quot;inverse&quot;)) run_benchmark(&quot;field_inverse_var&quot;, bench_field_inverse_var, bench_setup, NULL, &amp;data, 10, 20000);</span>
<span class="term-fg31">-    if (have_flag(argc, argv, &quot;field&quot;) || have_flag(argc, argv, &quot;sqrt&quot;)) run_benchmark(&quot;field_sqrt&quot;, bench_field_sqrt, bench_setup, NULL, &amp;data, 10, 20000);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    if (have_flag(argc, argv, &quot;group&quot;) || have_flag(argc, argv, &quot;double&quot;)) run_benchmark(&quot;group_double_var&quot;, bench_group_double_var, bench_setup, NULL, &amp;data, 10, 200000);</span>
<span class="term-fg31">-    if (have_flag(argc, argv, &quot;group&quot;) || have_flag(argc, argv, &quot;add&quot;)) run_benchmark(&quot;group_add_var&quot;, bench_group_add_var, bench_setup, NULL, &amp;data, 10, 200000);</span>
<span class="term-fg31">-    if (have_flag(argc, argv, &quot;group&quot;) || have_flag(argc, argv, &quot;add&quot;)) run_benchmark(&quot;group_add_affine&quot;, bench_group_add_affine, bench_setup, NULL, &amp;data, 10, 200000);</span>
<span class="term-fg31">-    if (have_flag(argc, argv, &quot;group&quot;) || have_flag(argc, argv, &quot;add&quot;)) run_benchmark(&quot;group_add_affine_var&quot;, bench_group_add_affine_var, bench_setup, NULL, &amp;data, 10, 200000);</span>
<span class="term-fg31">-    if (have_flag(argc, argv, &quot;group&quot;) || have_flag(argc, argv, &quot;jacobi&quot;)) run_benchmark(&quot;group_jacobi_var&quot;, bench_group_jacobi_var, bench_setup, NULL, &amp;data, 10, 20000);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    if (have_flag(argc, argv, &quot;ecmult&quot;) || have_flag(argc, argv, &quot;wnaf&quot;)) run_benchmark(&quot;wnaf_const&quot;, bench_wnaf_const, bench_setup, NULL, &amp;data, 10, 20000);</span>
<span class="term-fg31">-    if (have_flag(argc, argv, &quot;ecmult&quot;) || have_flag(argc, argv, &quot;wnaf&quot;)) run_benchmark(&quot;ecmult_wnaf&quot;, bench_ecmult_wnaf, bench_setup, NULL, &amp;data, 10, 20000);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    if (have_flag(argc, argv, &quot;hash&quot;) || have_flag(argc, argv, &quot;sha256&quot;)) run_benchmark(&quot;hash_sha256&quot;, bench_sha256, bench_setup, NULL, &amp;data, 10, 20000);</span>
<span class="term-fg31">-    if (have_flag(argc, argv, &quot;hash&quot;) || have_flag(argc, argv, &quot;hmac&quot;)) run_benchmark(&quot;hash_hmac_sha256&quot;, bench_hmac_sha256, bench_setup, NULL, &amp;data, 10, 20000);</span>
<span class="term-fg31">-    if (have_flag(argc, argv, &quot;hash&quot;) || have_flag(argc, argv, &quot;rng6979&quot;)) run_benchmark(&quot;hash_rfc6979_hmac_sha256&quot;, bench_rfc6979_hmac_sha256, bench_setup, NULL, &amp;data, 10, 20000);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    if (have_flag(argc, argv, &quot;context&quot;) || have_flag(argc, argv, &quot;verify&quot;)) run_benchmark(&quot;context_verify&quot;, bench_context_verify, bench_setup, NULL, &amp;data, 10, 20);</span>
<span class="term-fg31">-    if (have_flag(argc, argv, &quot;context&quot;) || have_flag(argc, argv, &quot;sign&quot;)) run_benchmark(&quot;context_sign&quot;, bench_context_sign, bench_setup, NULL, &amp;data, 10, 200);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef USE_NUM_NONE</span>
<span class="term-fg31">-    if (have_flag(argc, argv, &quot;num&quot;) || have_flag(argc, argv, &quot;jacobi&quot;)) run_benchmark(&quot;num_jacobi&quot;, bench_num_jacobi, bench_setup, NULL, &amp;data, 10, 200000);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-    return 0;</span>
<span class="term-fg31">-}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-e3c5f88c4f9881f6e9284f2d" role="button"
                       aria-expanded="false" aria-controls="id-e3c5f88c4f9881f6e9284f2d">
                        <code>crypto/secp256k1/libsecp256k1/src/bench_recover.c</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/bench_recover.c" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-60</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-e3c5f88c4f9881f6e9284f2d"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;bench_recover.c op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;bench_recover.c</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 6489378cc64ab46f79c0c35f556625ab46f5b195..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;bench_recover.c</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,60 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2014-2015 Pieter Wuille                              *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &quot;include&#47;secp256k1.h&quot;</span>
<span class="term-fg31">-#include &quot;include&#47;secp256k1_recovery.h&quot;</span>
<span class="term-fg31">-#include &quot;util.h&quot;</span>
<span class="term-fg31">-#include &quot;bench.h&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-typedef struct {</span>
<span class="term-fg31">-    secp256k1_context *ctx;</span>
<span class="term-fg31">-    unsigned char msg[32];</span>
<span class="term-fg31">-    unsigned char sig[64];</span>
<span class="term-fg31">-} bench_recover_t;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void bench_recover(void* arg) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    bench_recover_t *data = (bench_recover_t*)arg;</span>
<span class="term-fg31">-    secp256k1_pubkey pubkey;</span>
<span class="term-fg31">-    unsigned char pubkeyc[33];</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    for (i = 0; i &lt; 20000; i++) {</span>
<span class="term-fg31">-        int j;</span>
<span class="term-fg31">-        size_t pubkeylen = 33;</span>
<span class="term-fg31">-        secp256k1_ecdsa_recoverable_signature sig;</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_recoverable_signature_parse_compact(data-&gt;ctx, &amp;sig, data-&gt;sig, i % 2));</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_recover(data-&gt;ctx, &amp;pubkey, &amp;sig, data-&gt;msg));</span>
<span class="term-fg31">-        CHECK(secp256k1_ec_pubkey_serialize(data-&gt;ctx, pubkeyc, &amp;pubkeylen, &amp;pubkey, SECP256K1_EC_COMPRESSED));</span>
<span class="term-fg31">-        for (j = 0; j &lt; 32; j++) {</span>
<span class="term-fg31">-            data-&gt;sig[j + 32] = data-&gt;msg[j];    &#47;* Move former message to S. *&#47;</span>
<span class="term-fg31">-            data-&gt;msg[j] = data-&gt;sig[j];         &#47;* Move former R to message. *&#47;</span>
<span class="term-fg31">-            data-&gt;sig[j] = pubkeyc[j + 1];       &#47;* Move recovered pubkey X coordinate to R (which must be a valid X coordinate). *&#47;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void bench_recover_setup(void* arg) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    bench_recover_t *data = (bench_recover_t*)arg;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    for (i = 0; i &lt; 32; i++) {</span>
<span class="term-fg31">-        data-&gt;msg[i] = 1 + i;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    for (i = 0; i &lt; 64; i++) {</span>
<span class="term-fg31">-        data-&gt;sig[i] = 65 + i;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-int main(void) {</span>
<span class="term-fg31">-    bench_recover_t data;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    data.ctx = secp256k1_context_create(SECP256K1_CONTEXT_VERIFY);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    run_benchmark(&quot;ecdsa_recover&quot;, bench_recover, bench_recover_setup, NULL, &amp;data, 10, 20000);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_context_destroy(data.ctx);</span>
<span class="term-fg31">-    return 0;</span>
<span class="term-fg31">-}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-80b0b647d6ca9e1353457730" role="button"
                       aria-expanded="false" aria-controls="id-80b0b647d6ca9e1353457730">
                        <code>crypto/secp256k1/libsecp256k1/src/bench_schnorr_verify.c</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/bench_schnorr_verify.c" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-73</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-80b0b647d6ca9e1353457730"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;bench_schnorr_verify.c op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;bench_schnorr_verify.c</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 5f137dda23ef3a62326a6aee21cd152fa09860da..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;bench_schnorr_verify.c</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,73 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2014 Pieter Wuille                                   *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &lt;stdio.h&gt;</span>
<span class="term-fg31">-#include &lt;string.h&gt;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &quot;include&#47;secp256k1.h&quot;</span>
<span class="term-fg31">-#include &quot;include&#47;secp256k1_schnorr.h&quot;</span>
<span class="term-fg31">-#include &quot;util.h&quot;</span>
<span class="term-fg31">-#include &quot;bench.h&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-typedef struct {</span>
<span class="term-fg31">-    unsigned char key[32];</span>
<span class="term-fg31">-    unsigned char sig[64];</span>
<span class="term-fg31">-    unsigned char pubkey[33];</span>
<span class="term-fg31">-    size_t pubkeylen;</span>
<span class="term-fg31">-} benchmark_schnorr_sig_t;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-typedef struct {</span>
<span class="term-fg31">-    secp256k1_context *ctx;</span>
<span class="term-fg31">-    unsigned char msg[32];</span>
<span class="term-fg31">-    benchmark_schnorr_sig_t sigs[64];</span>
<span class="term-fg31">-    int numsigs;</span>
<span class="term-fg31">-} benchmark_schnorr_verify_t;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void benchmark_schnorr_init(void* arg) {</span>
<span class="term-fg31">-    int i, k;</span>
<span class="term-fg31">-    benchmark_schnorr_verify_t* data = (benchmark_schnorr_verify_t*)arg;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    for (i = 0; i &lt; 32; i++) {</span>
<span class="term-fg31">-        data-&gt;msg[i] = 1 + i;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    for (k = 0; k &lt; data-&gt;numsigs; k++) {</span>
<span class="term-fg31">-        secp256k1_pubkey pubkey;</span>
<span class="term-fg31">-        for (i = 0; i &lt; 32; i++) {</span>
<span class="term-fg31">-            data-&gt;sigs[k].key[i] = 33 + i + k;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        secp256k1_schnorr_sign(data-&gt;ctx, data-&gt;sigs[k].sig, data-&gt;msg, data-&gt;sigs[k].key, NULL, NULL);</span>
<span class="term-fg31">-        data-&gt;sigs[k].pubkeylen = 33;</span>
<span class="term-fg31">-        CHECK(secp256k1_ec_pubkey_create(data-&gt;ctx, &amp;pubkey, data-&gt;sigs[k].key));</span>
<span class="term-fg31">-        CHECK(secp256k1_ec_pubkey_serialize(data-&gt;ctx, data-&gt;sigs[k].pubkey, &amp;data-&gt;sigs[k].pubkeylen, &amp;pubkey, SECP256K1_EC_COMPRESSED));</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void benchmark_schnorr_verify(void* arg) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    benchmark_schnorr_verify_t* data = (benchmark_schnorr_verify_t*)arg;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    for (i = 0; i &lt; 20000 &#47; data-&gt;numsigs; i++) {</span>
<span class="term-fg31">-        secp256k1_pubkey pubkey;</span>
<span class="term-fg31">-        data-&gt;sigs[0].sig[(i &gt;&gt; 8) % 64] ^= (i &amp; 0xFF);</span>
<span class="term-fg31">-        CHECK(secp256k1_ec_pubkey_parse(data-&gt;ctx, &amp;pubkey, data-&gt;sigs[0].pubkey, data-&gt;sigs[0].pubkeylen));</span>
<span class="term-fg31">-        CHECK(secp256k1_schnorr_verify(data-&gt;ctx, data-&gt;sigs[0].sig, data-&gt;msg, &amp;pubkey) == ((i &amp; 0xFF) == 0));</span>
<span class="term-fg31">-        data-&gt;sigs[0].sig[(i &gt;&gt; 8) % 64] ^= (i &amp; 0xFF);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-int main(void) {</span>
<span class="term-fg31">-    benchmark_schnorr_verify_t data;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    data.ctx = secp256k1_context_create(SECP256K1_CONTEXT_SIGN | SECP256K1_CONTEXT_VERIFY);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    data.numsigs = 1;</span>
<span class="term-fg31">-    run_benchmark(&quot;schnorr_verify&quot;, benchmark_schnorr_verify, benchmark_schnorr_init, NULL, &amp;data, 10, 20000);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_context_destroy(data.ctx);</span>
<span class="term-fg31">-    return 0;</span>
<span class="term-fg31">-}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-534d92cb75015c37487cb9f8" role="button"
                       aria-expanded="false" aria-controls="id-534d92cb75015c37487cb9f8">
                        <code>crypto/secp256k1/libsecp256k1/src/bench_sign.c</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/bench_sign.c" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-56</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-534d92cb75015c37487cb9f8"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;bench_sign.c op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;bench_sign.c</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index ed7224d757e417cb324a3b2e15f0f3268fe68d3a..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;bench_sign.c</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,56 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2014 Pieter Wuille                                   *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &quot;include&#47;secp256k1.h&quot;</span>
<span class="term-fg31">-#include &quot;util.h&quot;</span>
<span class="term-fg31">-#include &quot;bench.h&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-typedef struct {</span>
<span class="term-fg31">-    secp256k1_context* ctx;</span>
<span class="term-fg31">-    unsigned char msg[32];</span>
<span class="term-fg31">-    unsigned char key[32];</span>
<span class="term-fg31">-} bench_sign_t;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void bench_sign_setup(void* arg) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    bench_sign_t *data = (bench_sign_t*)arg;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    for (i = 0; i &lt; 32; i++) {</span>
<span class="term-fg31">-        data-&gt;msg[i] = i + 1;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    for (i = 0; i &lt; 32; i++) {</span>
<span class="term-fg31">-        data-&gt;key[i] = i + 65;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void bench_sign(void* arg) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    bench_sign_t *data = (bench_sign_t*)arg;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    unsigned char sig[74];</span>
<span class="term-fg31">-    for (i = 0; i &lt; 20000; i++) {</span>
<span class="term-fg31">-        size_t siglen = 74;</span>
<span class="term-fg31">-        int j;</span>
<span class="term-fg31">-        secp256k1_ecdsa_signature signature;</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_sign(data-&gt;ctx, &amp;signature, data-&gt;msg, data-&gt;key, NULL, NULL));</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_signature_serialize_der(data-&gt;ctx, sig, &amp;siglen, &amp;signature));</span>
<span class="term-fg31">-        for (j = 0; j &lt; 32; j++) {</span>
<span class="term-fg31">-            data-&gt;msg[j] = sig[j];</span>
<span class="term-fg31">-            data-&gt;key[j] = sig[j + 32];</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-int main(void) {</span>
<span class="term-fg31">-    bench_sign_t data;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    data.ctx = secp256k1_context_create(SECP256K1_CONTEXT_SIGN);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    run_benchmark(&quot;ecdsa_sign&quot;, bench_sign, bench_sign_setup, NULL, &amp;data, 10, 20000);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_context_destroy(data.ctx);</span>
<span class="term-fg31">-    return 0;</span>
<span class="term-fg31">-}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-cea8248141ab453a278f0fdc" role="button"
                       aria-expanded="false" aria-controls="id-cea8248141ab453a278f0fdc">
                        <code>crypto/secp256k1/libsecp256k1/src/bench_verify.c</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/bench_verify.c" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-112</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-cea8248141ab453a278f0fdc"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;bench_verify.c op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;bench_verify.c</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 418defa0aa22a06dff07d3f1567e205235706976..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;bench_verify.c</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,112 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2014 Pieter Wuille                                   *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &lt;stdio.h&gt;</span>
<span class="term-fg31">-#include &lt;string.h&gt;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &quot;include&#47;secp256k1.h&quot;</span>
<span class="term-fg31">-#include &quot;util.h&quot;</span>
<span class="term-fg31">-#include &quot;bench.h&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef ENABLE_OPENSSL_TESTS</span>
<span class="term-fg31">-#include &lt;openssl&#47;bn.h&gt;</span>
<span class="term-fg31">-#include &lt;openssl&#47;ecdsa.h&gt;</span>
<span class="term-fg31">-#include &lt;openssl&#47;obj_mac.h&gt;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-typedef struct {</span>
<span class="term-fg31">-    secp256k1_context *ctx;</span>
<span class="term-fg31">-    unsigned char msg[32];</span>
<span class="term-fg31">-    unsigned char key[32];</span>
<span class="term-fg31">-    unsigned char sig[72];</span>
<span class="term-fg31">-    size_t siglen;</span>
<span class="term-fg31">-    unsigned char pubkey[33];</span>
<span class="term-fg31">-    size_t pubkeylen;</span>
<span class="term-fg31">-#ifdef ENABLE_OPENSSL_TESTS</span>
<span class="term-fg31">-    EC_GROUP* ec_group;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-} benchmark_verify_t;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void benchmark_verify(void* arg) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    benchmark_verify_t* data = (benchmark_verify_t*)arg;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    for (i = 0; i &lt; 20000; i++) {</span>
<span class="term-fg31">-        secp256k1_pubkey pubkey;</span>
<span class="term-fg31">-        secp256k1_ecdsa_signature sig;</span>
<span class="term-fg31">-        data-&gt;sig[data-&gt;siglen - 1] ^= (i &amp; 0xFF);</span>
<span class="term-fg31">-        data-&gt;sig[data-&gt;siglen - 2] ^= ((i &gt;&gt; 8) &amp; 0xFF);</span>
<span class="term-fg31">-        data-&gt;sig[data-&gt;siglen - 3] ^= ((i &gt;&gt; 16) &amp; 0xFF);</span>
<span class="term-fg31">-        CHECK(secp256k1_ec_pubkey_parse(data-&gt;ctx, &amp;pubkey, data-&gt;pubkey, data-&gt;pubkeylen) == 1);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_signature_parse_der(data-&gt;ctx, &amp;sig, data-&gt;sig, data-&gt;siglen) == 1);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_verify(data-&gt;ctx, &amp;sig, data-&gt;msg, &amp;pubkey) == (i == 0));</span>
<span class="term-fg31">-        data-&gt;sig[data-&gt;siglen - 1] ^= (i &amp; 0xFF);</span>
<span class="term-fg31">-        data-&gt;sig[data-&gt;siglen - 2] ^= ((i &gt;&gt; 8) &amp; 0xFF);</span>
<span class="term-fg31">-        data-&gt;sig[data-&gt;siglen - 3] ^= ((i &gt;&gt; 16) &amp; 0xFF);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef ENABLE_OPENSSL_TESTS</span>
<span class="term-fg31">-static void benchmark_verify_openssl(void* arg) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    benchmark_verify_t* data = (benchmark_verify_t*)arg;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    for (i = 0; i &lt; 20000; i++) {</span>
<span class="term-fg31">-        data-&gt;sig[data-&gt;siglen - 1] ^= (i &amp; 0xFF);</span>
<span class="term-fg31">-        data-&gt;sig[data-&gt;siglen - 2] ^= ((i &gt;&gt; 8) &amp; 0xFF);</span>
<span class="term-fg31">-        data-&gt;sig[data-&gt;siglen - 3] ^= ((i &gt;&gt; 16) &amp; 0xFF);</span>
<span class="term-fg31">-        {</span>
<span class="term-fg31">-            EC_KEY *pkey = EC_KEY_new();</span>
<span class="term-fg31">-            const unsigned char *pubkey = &amp;data-&gt;pubkey[0];</span>
<span class="term-fg31">-            int result;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-            CHECK(pkey != NULL);</span>
<span class="term-fg31">-            result = EC_KEY_set_group(pkey, data-&gt;ec_group);</span>
<span class="term-fg31">-            CHECK(result);</span>
<span class="term-fg31">-            result = (o2i_ECPublicKey(&amp;pkey, &amp;pubkey, data-&gt;pubkeylen)) != NULL;</span>
<span class="term-fg31">-            CHECK(result);</span>
<span class="term-fg31">-            result = ECDSA_verify(0, &amp;data-&gt;msg[0], sizeof(data-&gt;msg), &amp;data-&gt;sig[0], data-&gt;siglen, pkey) == (i == 0);</span>
<span class="term-fg31">-            CHECK(result);</span>
<span class="term-fg31">-            EC_KEY_free(pkey);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        data-&gt;sig[data-&gt;siglen - 1] ^= (i &amp; 0xFF);</span>
<span class="term-fg31">-        data-&gt;sig[data-&gt;siglen - 2] ^= ((i &gt;&gt; 8) &amp; 0xFF);</span>
<span class="term-fg31">-        data-&gt;sig[data-&gt;siglen - 3] ^= ((i &gt;&gt; 16) &amp; 0xFF);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-int main(void) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    secp256k1_pubkey pubkey;</span>
<span class="term-fg31">-    secp256k1_ecdsa_signature sig;</span>
<span class="term-fg31">-    benchmark_verify_t data;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    data.ctx = secp256k1_context_create(SECP256K1_CONTEXT_SIGN | SECP256K1_CONTEXT_VERIFY);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    for (i = 0; i &lt; 32; i++) {</span>
<span class="term-fg31">-        data.msg[i] = 1 + i;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    for (i = 0; i &lt; 32; i++) {</span>
<span class="term-fg31">-        data.key[i] = 33 + i;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    data.siglen = 72;</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_sign(data.ctx, &amp;sig, data.msg, data.key, NULL, NULL));</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_signature_serialize_der(data.ctx, data.sig, &amp;data.siglen, &amp;sig));</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_create(data.ctx, &amp;pubkey, data.key));</span>
<span class="term-fg31">-    data.pubkeylen = 33;</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_serialize(data.ctx, data.pubkey, &amp;data.pubkeylen, &amp;pubkey, SECP256K1_EC_COMPRESSED) == 1);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    run_benchmark(&quot;ecdsa_verify&quot;, benchmark_verify, NULL, NULL, &amp;data, 10, 20000);</span>
<span class="term-fg31">-#ifdef ENABLE_OPENSSL_TESTS</span>
<span class="term-fg31">-    data.ec_group = EC_GROUP_new_by_curve_name(NID_secp256k1);</span>
<span class="term-fg31">-    run_benchmark(&quot;ecdsa_verify_openssl&quot;, benchmark_verify_openssl, NULL, NULL, &amp;data, 10, 20000);</span>
<span class="term-fg31">-    EC_GROUP_free(data.ec_group);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_context_destroy(data.ctx);</span>
<span class="term-fg31">-    return 0;</span>
<span class="term-fg31">-}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-489ffa1a417a37dcf6b53164" role="button"
                       aria-expanded="false" aria-controls="id-489ffa1a417a37dcf6b53164">
                        <code>crypto/secp256k1/libsecp256k1/src/dummy.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/dummy.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-8</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-489ffa1a417a37dcf6b53164"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;dummy.go op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;dummy.go</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 2df270adc35e88d710f5a354f4b10bb6291f5110..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;dummy.go</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,8 +0,0 @@</span>
<span class="term-fg31">-&#47;&#47;go:build dummy</span>
<span class="term-fg31">-&#47;&#47; +build dummy</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;&#47; Package c contains only a C file.</span>
<span class="term-fg31">-&#47;&#47;</span>
<span class="term-fg31">-&#47;&#47; This Go file is part of a workaround for `go mod vendor`.</span>
<span class="term-fg31">-&#47;&#47; Please see the file crypto&#47;secp256k1&#47;dummy.go for more information.</span>
<span class="term-fg31">-package src</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-353296674abc4348aec07e77" role="button"
                       aria-expanded="false" aria-controls="id-353296674abc4348aec07e77">
                        <code>crypto/secp256k1/libsecp256k1/src/ecdsa.h</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/ecdsa.h" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-21</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-353296674abc4348aec07e77"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;ecdsa.h op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;ecdsa.h</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 54ae101b924138552080eb3fd088654ec481f6a3..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;ecdsa.h</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,21 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2013, 2014 Pieter Wuille                             *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef _SECP256K1_ECDSA_</span>
<span class="term-fg31">-#define _SECP256K1_ECDSA_</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &lt;stddef.h&gt;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &quot;scalar.h&quot;</span>
<span class="term-fg31">-#include &quot;group.h&quot;</span>
<span class="term-fg31">-#include &quot;ecmult.h&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_ecdsa_sig_parse(secp256k1_scalar *r, secp256k1_scalar *s, const unsigned char *sig, size_t size);</span>
<span class="term-fg31">-static int secp256k1_ecdsa_sig_serialize(unsigned char *sig, size_t *size, const secp256k1_scalar *r, const secp256k1_scalar *s);</span>
<span class="term-fg31">-static int secp256k1_ecdsa_sig_verify(const secp256k1_ecmult_context *ctx, const secp256k1_scalar* r, const secp256k1_scalar* s, const secp256k1_ge *pubkey, const secp256k1_scalar *message);</span>
<span class="term-fg31">-static int secp256k1_ecdsa_sig_sign(const secp256k1_ecmult_gen_context *ctx, secp256k1_scalar* r, secp256k1_scalar* s, const secp256k1_scalar *seckey, const secp256k1_scalar *message, const secp256k1_scalar *nonce, int *recid);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-e80b42230cbf8e230f80a618" role="button"
                       aria-expanded="false" aria-controls="id-e80b42230cbf8e230f80a618">
                        <code>crypto/secp256k1/libsecp256k1/src/ecdsa_impl.h</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/ecdsa_impl.h" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-315</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-e80b42230cbf8e230f80a618"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;ecdsa_impl.h op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;ecdsa_impl.h</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 453bb1188066f90f7b4648ac19c8e78212973e11..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;ecdsa_impl.h</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,315 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2013-2015 Pieter Wuille                              *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef _SECP256K1_ECDSA_IMPL_H_</span>
<span class="term-fg31">-#define _SECP256K1_ECDSA_IMPL_H_</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &quot;scalar.h&quot;</span>
<span class="term-fg31">-#include &quot;field.h&quot;</span>
<span class="term-fg31">-#include &quot;group.h&quot;</span>
<span class="term-fg31">-#include &quot;ecmult.h&quot;</span>
<span class="term-fg31">-#include &quot;ecmult_gen.h&quot;</span>
<span class="term-fg31">-#include &quot;ecdsa.h&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Group order for secp256k1 defined as &#39;n&#39; in &quot;Standards for Efficient Cryptography&quot; (SEC2) 2.7.1</span>
<span class="term-fg31">- *  sage: for t in xrange(1023, -1, -1):</span>
<span class="term-fg31">- *     ..   p = 2**256 - 2**32 - t</span>
<span class="term-fg31">- *     ..   if p.is_prime():</span>
<span class="term-fg31">- *     ..     print &#39;%x&#39;%p</span>
<span class="term-fg31">- *     ..     break</span>
<span class="term-fg31">- *   &#39;fffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f&#39;</span>
<span class="term-fg31">- *  sage: a = 0</span>
<span class="term-fg31">- *  sage: b = 7</span>
<span class="term-fg31">- *  sage: F = FiniteField (p)</span>
<span class="term-fg31">- *  sage: &#39;%x&#39; % (EllipticCurve ([F (a), F (b)]).order())</span>
<span class="term-fg31">- *   &#39;fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141&#39;</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-static const secp256k1_fe secp256k1_ecdsa_const_order_as_fe = SECP256K1_FE_CONST(</span>
<span class="term-fg31">-    0xFFFFFFFFUL, 0xFFFFFFFFUL, 0xFFFFFFFFUL, 0xFFFFFFFEUL,</span>
<span class="term-fg31">-    0xBAAEDCE6UL, 0xAF48A03BUL, 0xBFD25E8CUL, 0xD0364141UL</span>
<span class="term-fg31">-);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Difference between field and order, values &#39;p&#39; and &#39;n&#39; values defined in</span>
<span class="term-fg31">- *  &quot;Standards for Efficient Cryptography&quot; (SEC2) 2.7.1.</span>
<span class="term-fg31">- *  sage: p = 0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F</span>
<span class="term-fg31">- *  sage: a = 0</span>
<span class="term-fg31">- *  sage: b = 7</span>
<span class="term-fg31">- *  sage: F = FiniteField (p)</span>
<span class="term-fg31">- *  sage: &#39;%x&#39; % (p - EllipticCurve ([F (a), F (b)]).order())</span>
<span class="term-fg31">- *   &#39;14551231950b75fc4402da1722fc9baee&#39;</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-static const secp256k1_fe secp256k1_ecdsa_const_p_minus_order = SECP256K1_FE_CONST(</span>
<span class="term-fg31">-    0, 0, 0, 1, 0x45512319UL, 0x50B75FC4UL, 0x402DA172UL, 0x2FC9BAEEUL</span>
<span class="term-fg31">-);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_der_read_len(const unsigned char **sigp, const unsigned char *sigend) {</span>
<span class="term-fg31">-    int lenleft, b1;</span>
<span class="term-fg31">-    size_t ret = 0;</span>
<span class="term-fg31">-    if (*sigp &gt;= sigend) {</span>
<span class="term-fg31">-        return -1;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    b1 = *((*sigp)++);</span>
<span class="term-fg31">-    if (b1 == 0xFF) {</span>
<span class="term-fg31">-        &#47;* X.690-0207 8.1.3.5.c the value 0xFF shall not be used. *&#47;</span>
<span class="term-fg31">-        return -1;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    if ((b1 &amp; 0x80) == 0) {</span>
<span class="term-fg31">-        &#47;* X.690-0207 8.1.3.4 short form length octets *&#47;</span>
<span class="term-fg31">-        return b1;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    if (b1 == 0x80) {</span>
<span class="term-fg31">-        &#47;* Indefinite length is not allowed in DER. *&#47;</span>
<span class="term-fg31">-        return -1;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    &#47;* X.690-207 8.1.3.5 long form length octets *&#47;</span>
<span class="term-fg31">-    lenleft = b1 &amp; 0x7F;</span>
<span class="term-fg31">-    if (lenleft &gt; sigend - *sigp) {</span>
<span class="term-fg31">-        return -1;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    if (**sigp == 0) {</span>
<span class="term-fg31">-        &#47;* Not the shortest possible length encoding. *&#47;</span>
<span class="term-fg31">-        return -1;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    if ((size_t)lenleft &gt; sizeof(size_t)) {</span>
<span class="term-fg31">-        &#47;* The resulting length would exceed the range of a size_t, so</span>
<span class="term-fg31">-         * certainly longer than the passed array size.</span>
<span class="term-fg31">-         *&#47;</span>
<span class="term-fg31">-        return -1;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    while (lenleft &gt; 0) {</span>
<span class="term-fg31">-        if ((ret &gt;&gt; ((sizeof(size_t) - 1) * 8)) != 0) {</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        ret = (ret &lt;&lt; 8) | **sigp;</span>
<span class="term-fg31">-        if (ret + lenleft &gt; (size_t)(sigend - *sigp)) {</span>
<span class="term-fg31">-            &#47;* Result exceeds the length of the passed array. *&#47;</span>
<span class="term-fg31">-            return -1;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        (*sigp)++;</span>
<span class="term-fg31">-        lenleft--;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    if (ret &lt; 128) {</span>
<span class="term-fg31">-        &#47;* Not the shortest possible length encoding. *&#47;</span>
<span class="term-fg31">-        return -1;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    return ret;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_der_parse_integer(secp256k1_scalar *r, const unsigned char **sig, const unsigned char *sigend) {</span>
<span class="term-fg31">-    int overflow = 0;</span>
<span class="term-fg31">-    unsigned char ra[32] = {0};</span>
<span class="term-fg31">-    int rlen;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    if (*sig == sigend || **sig != 0x02) {</span>
<span class="term-fg31">-        &#47;* Not a primitive integer (X.690-0207 8.3.1). *&#47;</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    (*sig)++;</span>
<span class="term-fg31">-    rlen = secp256k1_der_read_len(sig, sigend);</span>
<span class="term-fg31">-    if (rlen &lt;= 0 || (*sig) + rlen &gt; sigend) {</span>
<span class="term-fg31">-        &#47;* Exceeds bounds or not at least length 1 (X.690-0207 8.3.1).  *&#47;</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    if (**sig == 0x00 &amp;&amp; rlen &gt; 1 &amp;&amp; (((*sig)[1]) &amp; 0x80) == 0x00) {</span>
<span class="term-fg31">-        &#47;* Excessive 0x00 padding. *&#47;</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    if (**sig == 0xFF &amp;&amp; rlen &gt; 1 &amp;&amp; (((*sig)[1]) &amp; 0x80) == 0x80) {</span>
<span class="term-fg31">-        &#47;* Excessive 0xFF padding. *&#47;</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    if ((**sig &amp; 0x80) == 0x80) {</span>
<span class="term-fg31">-        &#47;* Negative. *&#47;</span>
<span class="term-fg31">-        overflow = 1;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    while (rlen &gt; 0 &amp;&amp; **sig == 0) {</span>
<span class="term-fg31">-        &#47;* Skip leading zero bytes *&#47;</span>
<span class="term-fg31">-        rlen--;</span>
<span class="term-fg31">-        (*sig)++;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    if (rlen &gt; 32) {</span>
<span class="term-fg31">-        overflow = 1;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    if (!overflow) {</span>
<span class="term-fg31">-        memcpy(ra + 32 - rlen, *sig, rlen);</span>
<span class="term-fg31">-        secp256k1_scalar_set_b32(r, ra, &amp;overflow);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    if (overflow) {</span>
<span class="term-fg31">-        secp256k1_scalar_set_int(r, 0);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    (*sig) += rlen;</span>
<span class="term-fg31">-    return 1;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_ecdsa_sig_parse(secp256k1_scalar *rr, secp256k1_scalar *rs, const unsigned char *sig, size_t size) {</span>
<span class="term-fg31">-    const unsigned char *sigend = sig + size;</span>
<span class="term-fg31">-    int rlen;</span>
<span class="term-fg31">-    if (sig == sigend || *(sig++) != 0x30) {</span>
<span class="term-fg31">-        &#47;* The encoding doesn&#39;t start with a constructed sequence (X.690-0207 8.9.1). *&#47;</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    rlen = secp256k1_der_read_len(&amp;sig, sigend);</span>
<span class="term-fg31">-    if (rlen &lt; 0 || sig + rlen &gt; sigend) {</span>
<span class="term-fg31">-        &#47;* Tuple exceeds bounds *&#47;</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    if (sig + rlen != sigend) {</span>
<span class="term-fg31">-        &#47;* Garbage after tuple. *&#47;</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    if (!secp256k1_der_parse_integer(rr, &amp;sig, sigend)) {</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    if (!secp256k1_der_parse_integer(rs, &amp;sig, sigend)) {</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    if (sig != sigend) {</span>
<span class="term-fg31">-        &#47;* Trailing garbage inside tuple. *&#47;</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    return 1;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_ecdsa_sig_serialize(unsigned char *sig, size_t *size, const secp256k1_scalar* ar, const secp256k1_scalar* as) {</span>
<span class="term-fg31">-    unsigned char r[33] = {0}, s[33] = {0};</span>
<span class="term-fg31">-    unsigned char *rp = r, *sp = s;</span>
<span class="term-fg31">-    size_t lenR = 33, lenS = 33;</span>
<span class="term-fg31">-    secp256k1_scalar_get_b32(&amp;r[1], ar);</span>
<span class="term-fg31">-    secp256k1_scalar_get_b32(&amp;s[1], as);</span>
<span class="term-fg31">-    while (lenR &gt; 1 &amp;&amp; rp[0] == 0 &amp;&amp; rp[1] &lt; 0x80) { lenR--; rp++; }</span>
<span class="term-fg31">-    while (lenS &gt; 1 &amp;&amp; sp[0] == 0 &amp;&amp; sp[1] &lt; 0x80) { lenS--; sp++; }</span>
<span class="term-fg31">-    if (*size &lt; 6+lenS+lenR) {</span>
<span class="term-fg31">-        *size = 6 + lenS + lenR;</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    *size = 6 + lenS + lenR;</span>
<span class="term-fg31">-    sig[0] = 0x30;</span>
<span class="term-fg31">-    sig[1] = 4 + lenS + lenR;</span>
<span class="term-fg31">-    sig[2] = 0x02;</span>
<span class="term-fg31">-    sig[3] = lenR;</span>
<span class="term-fg31">-    memcpy(sig+4, rp, lenR);</span>
<span class="term-fg31">-    sig[4+lenR] = 0x02;</span>
<span class="term-fg31">-    sig[5+lenR] = lenS;</span>
<span class="term-fg31">-    memcpy(sig+lenR+6, sp, lenS);</span>
<span class="term-fg31">-    return 1;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_ecdsa_sig_verify(const secp256k1_ecmult_context *ctx, const secp256k1_scalar *sigr, const secp256k1_scalar *sigs, const secp256k1_ge *pubkey, const secp256k1_scalar *message) {</span>
<span class="term-fg31">-    unsigned char c[32];</span>
<span class="term-fg31">-    secp256k1_scalar sn, u1, u2;</span>
<span class="term-fg31">-#if !defined(EXHAUSTIVE_TEST_ORDER)</span>
<span class="term-fg31">-    secp256k1_fe xr;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-    secp256k1_gej pubkeyj;</span>
<span class="term-fg31">-    secp256k1_gej pr;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    if (secp256k1_scalar_is_zero(sigr) || secp256k1_scalar_is_zero(sigs)) {</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_scalar_inverse_var(&amp;sn, sigs);</span>
<span class="term-fg31">-    secp256k1_scalar_mul(&amp;u1, &amp;sn, message);</span>
<span class="term-fg31">-    secp256k1_scalar_mul(&amp;u2, &amp;sn, sigr);</span>
<span class="term-fg31">-    secp256k1_gej_set_ge(&amp;pubkeyj, pubkey);</span>
<span class="term-fg31">-    secp256k1_ecmult(ctx, &amp;pr, &amp;pubkeyj, &amp;u2, &amp;u1);</span>
<span class="term-fg31">-    if (secp256k1_gej_is_infinity(&amp;pr)) {</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#if defined(EXHAUSTIVE_TEST_ORDER)</span>
<span class="term-fg31">-{</span>
<span class="term-fg31">-    secp256k1_scalar computed_r;</span>
<span class="term-fg31">-    secp256k1_ge pr_ge;</span>
<span class="term-fg31">-    secp256k1_ge_set_gej(&amp;pr_ge, &amp;pr);</span>
<span class="term-fg31">-    secp256k1_fe_normalize(&amp;pr_ge.x);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_fe_get_b32(c, &amp;pr_ge.x);</span>
<span class="term-fg31">-    secp256k1_scalar_set_b32(&amp;computed_r, c, NULL);</span>
<span class="term-fg31">-    return secp256k1_scalar_eq(sigr, &amp;computed_r);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-#else</span>
<span class="term-fg31">-    secp256k1_scalar_get_b32(c, sigr);</span>
<span class="term-fg31">-    secp256k1_fe_set_b32(&amp;xr, c);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;** We now have the recomputed R point in pr, and its claimed x coordinate (modulo n)</span>
<span class="term-fg31">-     *  in xr. Naively, we would extract the x coordinate from pr (requiring a inversion modulo p),</span>
<span class="term-fg31">-     *  compute the remainder modulo n, and compare it to xr. However:</span>
<span class="term-fg31">-     *</span>
<span class="term-fg31">-     *        xr == X(pr) mod n</span>
<span class="term-fg31">-     *    &lt;=&gt; exists h. (xr + h * n &lt; p &amp;&amp; xr + h * n == X(pr))</span>
<span class="term-fg31">-     *    [Since 2 * n &gt; p, h can only be 0 or 1]</span>
<span class="term-fg31">-     *    &lt;=&gt; (xr == X(pr)) || (xr + n &lt; p &amp;&amp; xr + n == X(pr))</span>
<span class="term-fg31">-     *    [In Jacobian coordinates, X(pr) is pr.x &#47; pr.z^2 mod p]</span>
<span class="term-fg31">-     *    &lt;=&gt; (xr == pr.x &#47; pr.z^2 mod p) || (xr + n &lt; p &amp;&amp; xr + n == pr.x &#47; pr.z^2 mod p)</span>
<span class="term-fg31">-     *    [Multiplying both sides of the equations by pr.z^2 mod p]</span>
<span class="term-fg31">-     *    &lt;=&gt; (xr * pr.z^2 mod p == pr.x) || (xr + n &lt; p &amp;&amp; (xr + n) * pr.z^2 mod p == pr.x)</span>
<span class="term-fg31">-     *</span>
<span class="term-fg31">-     *  Thus, we can avoid the inversion, but we have to check both cases separately.</span>
<span class="term-fg31">-     *  secp256k1_gej_eq_x implements the (xr * pr.z^2 mod p == pr.x) test.</span>
<span class="term-fg31">-     *&#47;</span>
<span class="term-fg31">-    if (secp256k1_gej_eq_x_var(&amp;xr, &amp;pr)) {</span>
<span class="term-fg31">-        &#47;* xr * pr.z^2 mod p == pr.x, so the signature is valid. *&#47;</span>
<span class="term-fg31">-        return 1;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    if (secp256k1_fe_cmp_var(&amp;xr, &amp;secp256k1_ecdsa_const_p_minus_order) &gt;= 0) {</span>
<span class="term-fg31">-        &#47;* xr + n &gt;= p, so we can skip testing the second case. *&#47;</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_fe_add(&amp;xr, &amp;secp256k1_ecdsa_const_order_as_fe);</span>
<span class="term-fg31">-    if (secp256k1_gej_eq_x_var(&amp;xr, &amp;pr)) {</span>
<span class="term-fg31">-        &#47;* (xr + n) * pr.z^2 mod p == pr.x, so the signature is valid. *&#47;</span>
<span class="term-fg31">-        return 1;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    return 0;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_ecdsa_sig_sign(const secp256k1_ecmult_gen_context *ctx, secp256k1_scalar *sigr, secp256k1_scalar *sigs, const secp256k1_scalar *seckey, const secp256k1_scalar *message, const secp256k1_scalar *nonce, int *recid) {</span>
<span class="term-fg31">-    unsigned char b[32];</span>
<span class="term-fg31">-    secp256k1_gej rp;</span>
<span class="term-fg31">-    secp256k1_ge r;</span>
<span class="term-fg31">-    secp256k1_scalar n;</span>
<span class="term-fg31">-    int overflow = 0;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_ecmult_gen(ctx, &amp;rp, nonce);</span>
<span class="term-fg31">-    secp256k1_ge_set_gej(&amp;r, &amp;rp);</span>
<span class="term-fg31">-    secp256k1_fe_normalize(&amp;r.x);</span>
<span class="term-fg31">-    secp256k1_fe_normalize(&amp;r.y);</span>
<span class="term-fg31">-    secp256k1_fe_get_b32(b, &amp;r.x);</span>
<span class="term-fg31">-    secp256k1_scalar_set_b32(sigr, b, &amp;overflow);</span>
<span class="term-fg31">-    &#47;* These two conditions should be checked before calling *&#47;</span>
<span class="term-fg31">-    VERIFY_CHECK(!secp256k1_scalar_is_zero(sigr));</span>
<span class="term-fg31">-    VERIFY_CHECK(overflow == 0);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    if (recid) {</span>
<span class="term-fg31">-        &#47;* The overflow condition is cryptographically unreachable as hitting it requires finding the discrete log</span>
<span class="term-fg31">-         * of some P where P.x &gt;= order, and only 1 in about 2^127 points meet this criteria.</span>
<span class="term-fg31">-         *&#47;</span>
<span class="term-fg31">-        *recid = (overflow ? 2 : 0) | (secp256k1_fe_is_odd(&amp;r.y) ? 1 : 0);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_scalar_mul(&amp;n, sigr, seckey);</span>
<span class="term-fg31">-    secp256k1_scalar_add(&amp;n, &amp;n, message);</span>
<span class="term-fg31">-    secp256k1_scalar_inverse(sigs, nonce);</span>
<span class="term-fg31">-    secp256k1_scalar_mul(sigs, sigs, &amp;n);</span>
<span class="term-fg31">-    secp256k1_scalar_clear(&amp;n);</span>
<span class="term-fg31">-    secp256k1_gej_clear(&amp;rp);</span>
<span class="term-fg31">-    secp256k1_ge_clear(&amp;r);</span>
<span class="term-fg31">-    if (secp256k1_scalar_is_zero(sigs)) {</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    if (secp256k1_scalar_is_high(sigs)) {</span>
<span class="term-fg31">-        secp256k1_scalar_negate(sigs, sigs);</span>
<span class="term-fg31">-        if (recid) {</span>
<span class="term-fg31">-            *recid ^= 1;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    return 1;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-e5f527278a9d88306d2dd4bc" role="button"
                       aria-expanded="false" aria-controls="id-e5f527278a9d88306d2dd4bc">
                        <code>crypto/secp256k1/libsecp256k1/src/eckey.h</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/eckey.h" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-25</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-e5f527278a9d88306d2dd4bc"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;eckey.h op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;eckey.h</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 42739a3bea7c08abfbefb6e744a5ad904993ce18..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;eckey.h</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,25 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2013, 2014 Pieter Wuille                             *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef _SECP256K1_ECKEY_</span>
<span class="term-fg31">-#define _SECP256K1_ECKEY_</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &lt;stddef.h&gt;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &quot;group.h&quot;</span>
<span class="term-fg31">-#include &quot;scalar.h&quot;</span>
<span class="term-fg31">-#include &quot;ecmult.h&quot;</span>
<span class="term-fg31">-#include &quot;ecmult_gen.h&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_eckey_pubkey_parse(secp256k1_ge *elem, const unsigned char *pub, size_t size);</span>
<span class="term-fg31">-static int secp256k1_eckey_pubkey_serialize(secp256k1_ge *elem, unsigned char *pub, size_t *size, int compressed);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_eckey_privkey_tweak_add(secp256k1_scalar *key, const secp256k1_scalar *tweak);</span>
<span class="term-fg31">-static int secp256k1_eckey_pubkey_tweak_add(const secp256k1_ecmult_context *ctx, secp256k1_ge *key, const secp256k1_scalar *tweak);</span>
<span class="term-fg31">-static int secp256k1_eckey_privkey_tweak_mul(secp256k1_scalar *key, const secp256k1_scalar *tweak);</span>
<span class="term-fg31">-static int secp256k1_eckey_pubkey_tweak_mul(const secp256k1_ecmult_context *ctx, secp256k1_ge *key, const secp256k1_scalar *tweak);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-f81bd3f00ca2072757742998" role="button"
                       aria-expanded="false" aria-controls="id-f81bd3f00ca2072757742998">
                        <code>crypto/secp256k1/libsecp256k1/src/eckey_impl.h</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/eckey_impl.h" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-99</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-f81bd3f00ca2072757742998"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;eckey_impl.h op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;eckey_impl.h</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index ce38071ac2e599dbb70255ec3b8dbf9deadc5fa0..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;eckey_impl.h</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,99 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2013, 2014 Pieter Wuille                             *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef _SECP256K1_ECKEY_IMPL_H_</span>
<span class="term-fg31">-#define _SECP256K1_ECKEY_IMPL_H_</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &quot;eckey.h&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &quot;scalar.h&quot;</span>
<span class="term-fg31">-#include &quot;field.h&quot;</span>
<span class="term-fg31">-#include &quot;group.h&quot;</span>
<span class="term-fg31">-#include &quot;ecmult_gen.h&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_eckey_pubkey_parse(secp256k1_ge *elem, const unsigned char *pub, size_t size) {</span>
<span class="term-fg31">-    if (size == 33 &amp;&amp; (pub[0] == 0x02 || pub[0] == 0x03)) {</span>
<span class="term-fg31">-        secp256k1_fe x;</span>
<span class="term-fg31">-        return secp256k1_fe_set_b32(&amp;x, pub+1) &amp;&amp; secp256k1_ge_set_xo_var(elem, &amp;x, pub[0] == 0x03);</span>
<span class="term-fg31">-    } else if (size == 65 &amp;&amp; (pub[0] == 0x04 || pub[0] == 0x06 || pub[0] == 0x07)) {</span>
<span class="term-fg31">-        secp256k1_fe x, y;</span>
<span class="term-fg31">-        if (!secp256k1_fe_set_b32(&amp;x, pub+1) || !secp256k1_fe_set_b32(&amp;y, pub+33)) {</span>
<span class="term-fg31">-            return 0;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        secp256k1_ge_set_xy(elem, &amp;x, &amp;y);</span>
<span class="term-fg31">-        if ((pub[0] == 0x06 || pub[0] == 0x07) &amp;&amp; secp256k1_fe_is_odd(&amp;y) != (pub[0] == 0x07)) {</span>
<span class="term-fg31">-            return 0;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        return secp256k1_ge_is_valid_var(elem);</span>
<span class="term-fg31">-    } else {</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_eckey_pubkey_serialize(secp256k1_ge *elem, unsigned char *pub, size_t *size, int compressed) {</span>
<span class="term-fg31">-    if (secp256k1_ge_is_infinity(elem)) {</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_fe_normalize_var(&amp;elem-&gt;x);</span>
<span class="term-fg31">-    secp256k1_fe_normalize_var(&amp;elem-&gt;y);</span>
<span class="term-fg31">-    secp256k1_fe_get_b32(&amp;pub[1], &amp;elem-&gt;x);</span>
<span class="term-fg31">-    if (compressed) {</span>
<span class="term-fg31">-        *size = 33;</span>
<span class="term-fg31">-        pub[0] = 0x02 | (secp256k1_fe_is_odd(&amp;elem-&gt;y) ? 0x01 : 0x00);</span>
<span class="term-fg31">-    } else {</span>
<span class="term-fg31">-        *size = 65;</span>
<span class="term-fg31">-        pub[0] = 0x04;</span>
<span class="term-fg31">-        secp256k1_fe_get_b32(&amp;pub[33], &amp;elem-&gt;y);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    return 1;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_eckey_privkey_tweak_add(secp256k1_scalar *key, const secp256k1_scalar *tweak) {</span>
<span class="term-fg31">-    secp256k1_scalar_add(key, key, tweak);</span>
<span class="term-fg31">-    if (secp256k1_scalar_is_zero(key)) {</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    return 1;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_eckey_pubkey_tweak_add(const secp256k1_ecmult_context *ctx, secp256k1_ge *key, const secp256k1_scalar *tweak) {</span>
<span class="term-fg31">-    secp256k1_gej pt;</span>
<span class="term-fg31">-    secp256k1_scalar one;</span>
<span class="term-fg31">-    secp256k1_gej_set_ge(&amp;pt, key);</span>
<span class="term-fg31">-    secp256k1_scalar_set_int(&amp;one, 1);</span>
<span class="term-fg31">-    secp256k1_ecmult(ctx, &amp;pt, &amp;pt, &amp;one, tweak);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    if (secp256k1_gej_is_infinity(&amp;pt)) {</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_ge_set_gej(key, &amp;pt);</span>
<span class="term-fg31">-    return 1;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_eckey_privkey_tweak_mul(secp256k1_scalar *key, const secp256k1_scalar *tweak) {</span>
<span class="term-fg31">-    if (secp256k1_scalar_is_zero(tweak)) {</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_scalar_mul(key, key, tweak);</span>
<span class="term-fg31">-    return 1;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_eckey_pubkey_tweak_mul(const secp256k1_ecmult_context *ctx, secp256k1_ge *key, const secp256k1_scalar *tweak) {</span>
<span class="term-fg31">-    secp256k1_scalar zero;</span>
<span class="term-fg31">-    secp256k1_gej pt;</span>
<span class="term-fg31">-    if (secp256k1_scalar_is_zero(tweak)) {</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_scalar_set_int(&amp;zero, 0);</span>
<span class="term-fg31">-    secp256k1_gej_set_ge(&amp;pt, key);</span>
<span class="term-fg31">-    secp256k1_ecmult(ctx, &amp;pt, &amp;pt, tweak, &amp;zero);</span>
<span class="term-fg31">-    secp256k1_ge_set_gej(key, &amp;pt);</span>
<span class="term-fg31">-    return 1;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-5ff43141ad29d9e35b6157df" role="button"
                       aria-expanded="false" aria-controls="id-5ff43141ad29d9e35b6157df">
                        <code>crypto/secp256k1/libsecp256k1/src/ecmult.h</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/ecmult.h" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-31</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-5ff43141ad29d9e35b6157df"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;ecmult.h op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;ecmult.h</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 20484134f5241402357e99dc119bd5b921d1a478..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;ecmult.h</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,31 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2013, 2014 Pieter Wuille                             *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef _SECP256K1_ECMULT_</span>
<span class="term-fg31">-#define _SECP256K1_ECMULT_</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &quot;num.h&quot;</span>
<span class="term-fg31">-#include &quot;group.h&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-typedef struct {</span>
<span class="term-fg31">-    &#47;* For accelerating the computation of a*P + b*G: *&#47;</span>
<span class="term-fg31">-    secp256k1_ge_storage (*pre_g)[];    &#47;* odd multiples of the generator *&#47;</span>
<span class="term-fg31">-#ifdef USE_ENDOMORPHISM</span>
<span class="term-fg31">-    secp256k1_ge_storage (*pre_g_128)[]; &#47;* odd multiples of 2^128*generator *&#47;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-} secp256k1_ecmult_context;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_ecmult_context_init(secp256k1_ecmult_context *ctx);</span>
<span class="term-fg31">-static void secp256k1_ecmult_context_build(secp256k1_ecmult_context *ctx, const secp256k1_callback *cb);</span>
<span class="term-fg31">-static void secp256k1_ecmult_context_clone(secp256k1_ecmult_context *dst,</span>
<span class="term-fg31">-                                           const secp256k1_ecmult_context *src, const secp256k1_callback *cb);</span>
<span class="term-fg31">-static void secp256k1_ecmult_context_clear(secp256k1_ecmult_context *ctx);</span>
<span class="term-fg31">-static int secp256k1_ecmult_context_is_built(const secp256k1_ecmult_context *ctx);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Double multiply: R = na*A + ng*G *&#47;</span>
<span class="term-fg31">-static void secp256k1_ecmult(const secp256k1_ecmult_context *ctx, secp256k1_gej *r, const secp256k1_gej *a, const secp256k1_scalar *na, const secp256k1_scalar *ng);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-8d8d734998290b56ab355aa2" role="button"
                       aria-expanded="false" aria-controls="id-8d8d734998290b56ab355aa2">
                        <code>crypto/secp256k1/libsecp256k1/src/ecmult_const.h</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/ecmult_const.h" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-15</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-8d8d734998290b56ab355aa2"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;ecmult_const.h op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;ecmult_const.h</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 2b0097655c1945393546aeef3c3b4d52c862b771..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;ecmult_const.h</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,15 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2015 Andrew Poelstra                                 *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef _SECP256K1_ECMULT_CONST_</span>
<span class="term-fg31">-#define _SECP256K1_ECMULT_CONST_</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &quot;scalar.h&quot;</span>
<span class="term-fg31">-#include &quot;group.h&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_ecmult_const(secp256k1_gej *r, const secp256k1_ge *a, const secp256k1_scalar *q);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-be51031f51a2047e92025630" role="button"
                       aria-expanded="false" aria-controls="id-be51031f51a2047e92025630">
                        <code>crypto/secp256k1/libsecp256k1/src/ecmult_const_impl.h</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/ecmult_const_impl.h" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-239</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-be51031f51a2047e92025630"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;ecmult_const_impl.h op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;ecmult_const_impl.h</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 0db314c48e0cdc844a89cb4a6d5b4ce4c9352578..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;ecmult_const_impl.h</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,239 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2015 Pieter Wuille, Andrew Poelstra                  *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef _SECP256K1_ECMULT_CONST_IMPL_</span>
<span class="term-fg31">-#define _SECP256K1_ECMULT_CONST_IMPL_</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &quot;scalar.h&quot;</span>
<span class="term-fg31">-#include &quot;group.h&quot;</span>
<span class="term-fg31">-#include &quot;ecmult_const.h&quot;</span>
<span class="term-fg31">-#include &quot;ecmult_impl.h&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef USE_ENDOMORPHISM</span>
<span class="term-fg31">-    #define WNAF_BITS 128</span>
<span class="term-fg31">-#else</span>
<span class="term-fg31">-    #define WNAF_BITS 256</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-#define WNAF_SIZE(w) ((WNAF_BITS + (w) - 1) &#47; (w))</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;* This is like `ECMULT_TABLE_GET_GE` but is constant time *&#47;</span>
<span class="term-fg31">-#define ECMULT_CONST_TABLE_GET_GE(r,pre,n,w) do { \</span>
<span class="term-fg31">-    int m; \</span>
<span class="term-fg31">-    int abs_n = (n) * (((n) &gt; 0) * 2 - 1); \</span>
<span class="term-fg31">-    int idx_n = abs_n &#47; 2; \</span>
<span class="term-fg31">-    secp256k1_fe neg_y; \</span>
<span class="term-fg31">-    VERIFY_CHECK(((n) &amp; 1) == 1); \</span>
<span class="term-fg31">-    VERIFY_CHECK((n) &gt;= -((1 &lt;&lt; ((w)-1)) - 1)); \</span>
<span class="term-fg31">-    VERIFY_CHECK((n) &lt;=  ((1 &lt;&lt; ((w)-1)) - 1)); \</span>
<span class="term-fg31">-    VERIFY_SETUP(secp256k1_fe_clear(&amp;(r)-&gt;x)); \</span>
<span class="term-fg31">-    VERIFY_SETUP(secp256k1_fe_clear(&amp;(r)-&gt;y)); \</span>
<span class="term-fg31">-    for (m = 0; m &lt; ECMULT_TABLE_SIZE(w); m++) { \</span>
<span class="term-fg31">-        &#47;* This loop is used to avoid secret data in array indices. See</span>
<span class="term-fg31">-         * the comment in ecmult_gen_impl.h for rationale. *&#47; \</span>
<span class="term-fg31">-        secp256k1_fe_cmov(&amp;(r)-&gt;x, &amp;(pre)[m].x, m == idx_n); \</span>
<span class="term-fg31">-        secp256k1_fe_cmov(&amp;(r)-&gt;y, &amp;(pre)[m].y, m == idx_n); \</span>
<span class="term-fg31">-    } \</span>
<span class="term-fg31">-    (r)-&gt;infinity = 0; \</span>
<span class="term-fg31">-    secp256k1_fe_negate(&amp;neg_y, &amp;(r)-&gt;y, 1); \</span>
<span class="term-fg31">-    secp256k1_fe_cmov(&amp;(r)-&gt;y, &amp;neg_y, (n) != abs_n); \</span>
<span class="term-fg31">-} while(0)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Convert a number to WNAF notation. The number becomes represented by sum(2^{wi} * wnaf[i], i=0..return_val)</span>
<span class="term-fg31">- *  with the following guarantees:</span>
<span class="term-fg31">- *  - each wnaf[i] an odd integer between -(1 &lt;&lt; w) and (1 &lt;&lt; w)</span>
<span class="term-fg31">- *  - each wnaf[i] is nonzero</span>
<span class="term-fg31">- *  - the number of words set is returned; this is always (WNAF_BITS + w - 1) &#47; w</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  Adapted from `The Width-w NAF Method Provides Small Memory and Fast Elliptic Scalar</span>
<span class="term-fg31">- *  Multiplications Secure against Side Channel Attacks`, Okeya and Tagaki. M. Joye (Ed.)</span>
<span class="term-fg31">- *  CT-RSA 2003, LNCS 2612, pp. 328-443, 2003. Springer-Verlagy Berlin Heidelberg 2003</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  Numbers reference steps of `Algorithm SPA-resistant Width-w NAF with Odd Scalar` on pp. 335</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-static int secp256k1_wnaf_const(int *wnaf, secp256k1_scalar s, int w) {</span>
<span class="term-fg31">-    int global_sign;</span>
<span class="term-fg31">-    int skew = 0;</span>
<span class="term-fg31">-    int word = 0;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* 1 2 3 *&#47;</span>
<span class="term-fg31">-    int u_last;</span>
<span class="term-fg31">-    int u;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    int flip;</span>
<span class="term-fg31">-    int bit;</span>
<span class="term-fg31">-    secp256k1_scalar neg_s;</span>
<span class="term-fg31">-    int not_neg_one;</span>
<span class="term-fg31">-    &#47;* Note that we cannot handle even numbers by negating them to be odd, as is</span>
<span class="term-fg31">-     * done in other implementations, since if our scalars were specified to have</span>
<span class="term-fg31">-     * width &lt; 256 for performance reasons, their negations would have width 256</span>
<span class="term-fg31">-     * and we&#39;d lose any performance benefit. Instead, we use a technique from</span>
<span class="term-fg31">-     * Section 4.2 of the Okeya&#47;Tagaki paper, which is to add either 1 (for even)</span>
<span class="term-fg31">-     * or 2 (for odd) to the number we are encoding, returning a skew value indicating</span>
<span class="term-fg31">-     * this, and having the caller compensate after doing the multiplication. *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Negative numbers will be negated to keep their bit representation below the maximum width *&#47;</span>
<span class="term-fg31">-    flip = secp256k1_scalar_is_high(&amp;s);</span>
<span class="term-fg31">-    &#47;* We add 1 to even numbers, 2 to odd ones, noting that negation flips parity *&#47;</span>
<span class="term-fg31">-    bit = flip ^ !secp256k1_scalar_is_even(&amp;s);</span>
<span class="term-fg31">-    &#47;* We check for negative one, since adding 2 to it will cause an overflow *&#47;</span>
<span class="term-fg31">-    secp256k1_scalar_negate(&amp;neg_s, &amp;s);</span>
<span class="term-fg31">-    not_neg_one = !secp256k1_scalar_is_one(&amp;neg_s);</span>
<span class="term-fg31">-    secp256k1_scalar_cadd_bit(&amp;s, bit, not_neg_one);</span>
<span class="term-fg31">-    &#47;* If we had negative one, flip == 1, s.d[0] == 0, bit == 1, so caller expects</span>
<span class="term-fg31">-     * that we added two to it and flipped it. In fact for -1 these operations are</span>
<span class="term-fg31">-     * identical. We only flipped, but since skewing is required (in the sense that</span>
<span class="term-fg31">-     * the skew must be 1 or 2, never zero) and flipping is not, we need to change</span>
<span class="term-fg31">-     * our flags to claim that we only skewed. *&#47;</span>
<span class="term-fg31">-    global_sign = secp256k1_scalar_cond_negate(&amp;s, flip);</span>
<span class="term-fg31">-    global_sign *= not_neg_one * 2 - 1;</span>
<span class="term-fg31">-    skew = 1 &lt;&lt; bit;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* 4 *&#47;</span>
<span class="term-fg31">-    u_last = secp256k1_scalar_shr_int(&amp;s, w);</span>
<span class="term-fg31">-    while (word * w &lt; WNAF_BITS) {</span>
<span class="term-fg31">-        int sign;</span>
<span class="term-fg31">-        int even;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        &#47;* 4.1 4.4 *&#47;</span>
<span class="term-fg31">-        u = secp256k1_scalar_shr_int(&amp;s, w);</span>
<span class="term-fg31">-        &#47;* 4.2 *&#47;</span>
<span class="term-fg31">-        even = ((u &amp; 1) == 0);</span>
<span class="term-fg31">-        sign = 2 * (u_last &gt; 0) - 1;</span>
<span class="term-fg31">-        u += sign * even;</span>
<span class="term-fg31">-        u_last -= sign * even * (1 &lt;&lt; w);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        &#47;* 4.3, adapted for global sign change *&#47;</span>
<span class="term-fg31">-        wnaf[word++] = u_last * global_sign;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        u_last = u;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    wnaf[word] = u * global_sign;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    VERIFY_CHECK(secp256k1_scalar_is_zero(&amp;s));</span>
<span class="term-fg31">-    VERIFY_CHECK(word == WNAF_SIZE(w));</span>
<span class="term-fg31">-    return skew;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_ecmult_const(secp256k1_gej *r, const secp256k1_ge *a, const secp256k1_scalar *scalar) {</span>
<span class="term-fg31">-    secp256k1_ge pre_a[ECMULT_TABLE_SIZE(WINDOW_A)];</span>
<span class="term-fg31">-    secp256k1_ge tmpa;</span>
<span class="term-fg31">-    secp256k1_fe Z;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    int skew_1;</span>
<span class="term-fg31">-    int wnaf_1[1 + WNAF_SIZE(WINDOW_A - 1)];</span>
<span class="term-fg31">-#ifdef USE_ENDOMORPHISM</span>
<span class="term-fg31">-    secp256k1_ge pre_a_lam[ECMULT_TABLE_SIZE(WINDOW_A)];</span>
<span class="term-fg31">-    int wnaf_lam[1 + WNAF_SIZE(WINDOW_A - 1)];</span>
<span class="term-fg31">-    int skew_lam;</span>
<span class="term-fg31">-    secp256k1_scalar q_1, q_lam;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    secp256k1_scalar sc = *scalar;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* build wnaf representation for q. *&#47;</span>
<span class="term-fg31">-#ifdef USE_ENDOMORPHISM</span>
<span class="term-fg31">-    &#47;* split q into q_1 and q_lam (where q = q_1 + q_lam*lambda, and q_1 and q_lam are ~128 bit) *&#47;</span>
<span class="term-fg31">-    secp256k1_scalar_split_lambda(&amp;q_1, &amp;q_lam, &amp;sc);</span>
<span class="term-fg31">-    skew_1   = secp256k1_wnaf_const(wnaf_1,   q_1,   WINDOW_A - 1);</span>
<span class="term-fg31">-    skew_lam = secp256k1_wnaf_const(wnaf_lam, q_lam, WINDOW_A - 1);</span>
<span class="term-fg31">-#else</span>
<span class="term-fg31">-    skew_1   = secp256k1_wnaf_const(wnaf_1, sc, WINDOW_A - 1);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Calculate odd multiples of a.</span>
<span class="term-fg31">-     * All multiples are brought to the same Z &#39;denominator&#39;, which is stored</span>
<span class="term-fg31">-     * in Z. Due to secp256k1&#39; isomorphism we can do all operations pretending</span>
<span class="term-fg31">-     * that the Z coordinate was 1, use affine addition formulae, and correct</span>
<span class="term-fg31">-     * the Z coordinate of the result once at the end.</span>
<span class="term-fg31">-     *&#47;</span>
<span class="term-fg31">-    secp256k1_gej_set_ge(r, a);</span>
<span class="term-fg31">-    secp256k1_ecmult_odd_multiples_table_globalz_windowa(pre_a, &amp;Z, r);</span>
<span class="term-fg31">-    for (i = 0; i &lt; ECMULT_TABLE_SIZE(WINDOW_A); i++) {</span>
<span class="term-fg31">-        secp256k1_fe_normalize_weak(&amp;pre_a[i].y);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-#ifdef USE_ENDOMORPHISM</span>
<span class="term-fg31">-    for (i = 0; i &lt; ECMULT_TABLE_SIZE(WINDOW_A); i++) {</span>
<span class="term-fg31">-        secp256k1_ge_mul_lambda(&amp;pre_a_lam[i], &amp;pre_a[i]);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* first loop iteration (separated out so we can directly set r, rather</span>
<span class="term-fg31">-     * than having it start at infinity, get doubled several times, then have</span>
<span class="term-fg31">-     * its new value added to it) *&#47;</span>
<span class="term-fg31">-    i = wnaf_1[WNAF_SIZE(WINDOW_A - 1)];</span>
<span class="term-fg31">-    VERIFY_CHECK(i != 0);</span>
<span class="term-fg31">-    ECMULT_CONST_TABLE_GET_GE(&amp;tmpa, pre_a, i, WINDOW_A);</span>
<span class="term-fg31">-    secp256k1_gej_set_ge(r, &amp;tmpa);</span>
<span class="term-fg31">-#ifdef USE_ENDOMORPHISM</span>
<span class="term-fg31">-    i = wnaf_lam[WNAF_SIZE(WINDOW_A - 1)];</span>
<span class="term-fg31">-    VERIFY_CHECK(i != 0);</span>
<span class="term-fg31">-    ECMULT_CONST_TABLE_GET_GE(&amp;tmpa, pre_a_lam, i, WINDOW_A);</span>
<span class="term-fg31">-    secp256k1_gej_add_ge(r, r, &amp;tmpa);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-    &#47;* remaining loop iterations *&#47;</span>
<span class="term-fg31">-    for (i = WNAF_SIZE(WINDOW_A - 1) - 1; i &gt;= 0; i--) {</span>
<span class="term-fg31">-        int n;</span>
<span class="term-fg31">-        int j;</span>
<span class="term-fg31">-        for (j = 0; j &lt; WINDOW_A - 1; ++j) {</span>
<span class="term-fg31">-            secp256k1_gej_double_nonzero(r, r, NULL);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        n = wnaf_1[i];</span>
<span class="term-fg31">-        ECMULT_CONST_TABLE_GET_GE(&amp;tmpa, pre_a, n, WINDOW_A);</span>
<span class="term-fg31">-        VERIFY_CHECK(n != 0);</span>
<span class="term-fg31">-        secp256k1_gej_add_ge(r, r, &amp;tmpa);</span>
<span class="term-fg31">-#ifdef USE_ENDOMORPHISM</span>
<span class="term-fg31">-        n = wnaf_lam[i];</span>
<span class="term-fg31">-        ECMULT_CONST_TABLE_GET_GE(&amp;tmpa, pre_a_lam, n, WINDOW_A);</span>
<span class="term-fg31">-        VERIFY_CHECK(n != 0);</span>
<span class="term-fg31">-        secp256k1_gej_add_ge(r, r, &amp;tmpa);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;r-&gt;z, &amp;r-&gt;z, &amp;Z);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    {</span>
<span class="term-fg31">-        &#47;* Correct for wNAF skew *&#47;</span>
<span class="term-fg31">-        secp256k1_ge correction = *a;</span>
<span class="term-fg31">-        secp256k1_ge_storage correction_1_stor;</span>
<span class="term-fg31">-#ifdef USE_ENDOMORPHISM</span>
<span class="term-fg31">-        secp256k1_ge_storage correction_lam_stor;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-        secp256k1_ge_storage a2_stor;</span>
<span class="term-fg31">-        secp256k1_gej tmpj;</span>
<span class="term-fg31">-        secp256k1_gej_set_ge(&amp;tmpj, &amp;correction);</span>
<span class="term-fg31">-        secp256k1_gej_double_var(&amp;tmpj, &amp;tmpj, NULL);</span>
<span class="term-fg31">-        secp256k1_ge_set_gej(&amp;correction, &amp;tmpj);</span>
<span class="term-fg31">-        secp256k1_ge_to_storage(&amp;correction_1_stor, a);</span>
<span class="term-fg31">-#ifdef USE_ENDOMORPHISM</span>
<span class="term-fg31">-        secp256k1_ge_to_storage(&amp;correction_lam_stor, a);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-        secp256k1_ge_to_storage(&amp;a2_stor, &amp;correction);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        &#47;* For odd numbers this is 2a (so replace it), for even ones a (so no-op) *&#47;</span>
<span class="term-fg31">-        secp256k1_ge_storage_cmov(&amp;correction_1_stor, &amp;a2_stor, skew_1 == 2);</span>
<span class="term-fg31">-#ifdef USE_ENDOMORPHISM</span>
<span class="term-fg31">-        secp256k1_ge_storage_cmov(&amp;correction_lam_stor, &amp;a2_stor, skew_lam == 2);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        &#47;* Apply the correction *&#47;</span>
<span class="term-fg31">-        secp256k1_ge_from_storage(&amp;correction, &amp;correction_1_stor);</span>
<span class="term-fg31">-        secp256k1_ge_neg(&amp;correction, &amp;correction);</span>
<span class="term-fg31">-        secp256k1_gej_add_ge(r, r, &amp;correction);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef USE_ENDOMORPHISM</span>
<span class="term-fg31">-        secp256k1_ge_from_storage(&amp;correction, &amp;correction_lam_stor);</span>
<span class="term-fg31">-        secp256k1_ge_neg(&amp;correction, &amp;correction);</span>
<span class="term-fg31">-        secp256k1_ge_mul_lambda(&amp;correction, &amp;correction);</span>
<span class="term-fg31">-        secp256k1_gej_add_ge(r, r, &amp;correction);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-55a64f1acbbfe311f3364940" role="button"
                       aria-expanded="false" aria-controls="id-55a64f1acbbfe311f3364940">
                        <code>crypto/secp256k1/libsecp256k1/src/ecmult_gen.h</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/ecmult_gen.h" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-43</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-55a64f1acbbfe311f3364940"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;ecmult_gen.h op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;ecmult_gen.h</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index eb2cc9ead6ed1df81b34bb5a579d0c61f991fd38..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;ecmult_gen.h</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,43 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2013, 2014 Pieter Wuille                             *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef _SECP256K1_ECMULT_GEN_</span>
<span class="term-fg31">-#define _SECP256K1_ECMULT_GEN_</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &quot;scalar.h&quot;</span>
<span class="term-fg31">-#include &quot;group.h&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-typedef struct {</span>
<span class="term-fg31">-    &#47;* For accelerating the computation of a*G:</span>
<span class="term-fg31">-     * To harden against timing attacks, use the following mechanism:</span>
<span class="term-fg31">-     * * Break up the multiplicand into groups of 4 bits, called n_0, n_1, n_2, ..., n_63.</span>
<span class="term-fg31">-     * * Compute sum(n_i * 16^i * G + U_i, i=0..63), where:</span>
<span class="term-fg31">-     *   * U_i = U * 2^i (for i=0..62)</span>
<span class="term-fg31">-     *   * U_i = U * (1-2^63) (for i=63)</span>
<span class="term-fg31">-     *   where U is a point with no known corresponding scalar. Note that sum(U_i, i=0..63) = 0.</span>
<span class="term-fg31">-     * For each i, and each of the 16 possible values of n_i, (n_i * 16^i * G + U_i) is</span>
<span class="term-fg31">-     * precomputed (call it prec(i, n_i)). The formula now becomes sum(prec(i, n_i), i=0..63).</span>
<span class="term-fg31">-     * None of the resulting prec group elements have a known scalar, and neither do any of</span>
<span class="term-fg31">-     * the intermediate sums while computing a*G.</span>
<span class="term-fg31">-     *&#47;</span>
<span class="term-fg31">-    secp256k1_ge_storage (*prec)[64][16]; &#47;* prec[j][i] = 16^j * i * G + U_i *&#47;</span>
<span class="term-fg31">-    secp256k1_scalar blind;</span>
<span class="term-fg31">-    secp256k1_gej initial;</span>
<span class="term-fg31">-} secp256k1_ecmult_gen_context;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_ecmult_gen_context_init(secp256k1_ecmult_gen_context* ctx);</span>
<span class="term-fg31">-static void secp256k1_ecmult_gen_context_build(secp256k1_ecmult_gen_context* ctx, const secp256k1_callback* cb);</span>
<span class="term-fg31">-static void secp256k1_ecmult_gen_context_clone(secp256k1_ecmult_gen_context *dst,</span>
<span class="term-fg31">-                                               const secp256k1_ecmult_gen_context* src, const secp256k1_callback* cb);</span>
<span class="term-fg31">-static void secp256k1_ecmult_gen_context_clear(secp256k1_ecmult_gen_context* ctx);</span>
<span class="term-fg31">-static int secp256k1_ecmult_gen_context_is_built(const secp256k1_ecmult_gen_context* ctx);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Multiply with the generator: R = a*G *&#47;</span>
<span class="term-fg31">-static void secp256k1_ecmult_gen(const secp256k1_ecmult_gen_context* ctx, secp256k1_gej *r, const secp256k1_scalar *a);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_ecmult_gen_blind(secp256k1_ecmult_gen_context *ctx, const unsigned char *seed32);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-76b59ef0f1b617c30b69b95c" role="button"
                       aria-expanded="false" aria-controls="id-76b59ef0f1b617c30b69b95c">
                        <code>crypto/secp256k1/libsecp256k1/src/ecmult_gen_impl.h</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/ecmult_gen_impl.h" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-210</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-76b59ef0f1b617c30b69b95c"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;ecmult_gen_impl.h op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;ecmult_gen_impl.h</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 35f25460773f3ab1819beb6a1633ef264c83408d..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;ecmult_gen_impl.h</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,210 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2013, 2014, 2015 Pieter Wuille, Gregory Maxwell      *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef _SECP256K1_ECMULT_GEN_IMPL_H_</span>
<span class="term-fg31">-#define _SECP256K1_ECMULT_GEN_IMPL_H_</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &quot;scalar.h&quot;</span>
<span class="term-fg31">-#include &quot;group.h&quot;</span>
<span class="term-fg31">-#include &quot;ecmult_gen.h&quot;</span>
<span class="term-fg31">-#include &quot;hash_impl.h&quot;</span>
<span class="term-fg31">-#ifdef USE_ECMULT_STATIC_PRECOMPUTATION</span>
<span class="term-fg31">-#include &quot;ecmult_static_context.h&quot;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-static void secp256k1_ecmult_gen_context_init(secp256k1_ecmult_gen_context *ctx) {</span>
<span class="term-fg31">-    ctx-&gt;prec = NULL;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_ecmult_gen_context_build(secp256k1_ecmult_gen_context *ctx, const secp256k1_callback* cb) {</span>
<span class="term-fg31">-#ifndef USE_ECMULT_STATIC_PRECOMPUTATION</span>
<span class="term-fg31">-    secp256k1_ge prec[1024];</span>
<span class="term-fg31">-    secp256k1_gej gj;</span>
<span class="term-fg31">-    secp256k1_gej nums_gej;</span>
<span class="term-fg31">-    int i, j;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    if (ctx-&gt;prec != NULL) {</span>
<span class="term-fg31">-        return;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-#ifndef USE_ECMULT_STATIC_PRECOMPUTATION</span>
<span class="term-fg31">-    ctx-&gt;prec = (secp256k1_ge_storage (*)[64][16])checked_malloc(cb, sizeof(*ctx-&gt;prec));</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* get the generator *&#47;</span>
<span class="term-fg31">-    secp256k1_gej_set_ge(&amp;gj, &amp;secp256k1_ge_const_g);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Construct a group element with no known corresponding scalar (nothing up my sleeve). *&#47;</span>
<span class="term-fg31">-    {</span>
<span class="term-fg31">-        static const unsigned char nums_b32[33] = &quot;The scalar for this x is unknown&quot;;</span>
<span class="term-fg31">-        secp256k1_fe nums_x;</span>
<span class="term-fg31">-        secp256k1_ge nums_ge;</span>
<span class="term-fg31">-        int r;</span>
<span class="term-fg31">-        r = secp256k1_fe_set_b32(&amp;nums_x, nums_b32);</span>
<span class="term-fg31">-        (void)r;</span>
<span class="term-fg31">-        VERIFY_CHECK(r);</span>
<span class="term-fg31">-        r = secp256k1_ge_set_xo_var(&amp;nums_ge, &amp;nums_x, 0);</span>
<span class="term-fg31">-        (void)r;</span>
<span class="term-fg31">-        VERIFY_CHECK(r);</span>
<span class="term-fg31">-        secp256k1_gej_set_ge(&amp;nums_gej, &amp;nums_ge);</span>
<span class="term-fg31">-        &#47;* Add G to make the bits in x uniformly distributed. *&#47;</span>
<span class="term-fg31">-        secp256k1_gej_add_ge_var(&amp;nums_gej, &amp;nums_gej, &amp;secp256k1_ge_const_g, NULL);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* compute prec. *&#47;</span>
<span class="term-fg31">-    {</span>
<span class="term-fg31">-        secp256k1_gej precj[1024]; &#47;* Jacobian versions of prec. *&#47;</span>
<span class="term-fg31">-        secp256k1_gej gbase;</span>
<span class="term-fg31">-        secp256k1_gej numsbase;</span>
<span class="term-fg31">-        gbase = gj; &#47;* 16^j * G *&#47;</span>
<span class="term-fg31">-        numsbase = nums_gej; &#47;* 2^j * nums. *&#47;</span>
<span class="term-fg31">-        for (j = 0; j &lt; 64; j++) {</span>
<span class="term-fg31">-            &#47;* Set precj[j*16 .. j*16+15] to (numsbase, numsbase + gbase, ..., numsbase + 15*gbase). *&#47;</span>
<span class="term-fg31">-            precj[j*16] = numsbase;</span>
<span class="term-fg31">-            for (i = 1; i &lt; 16; i++) {</span>
<span class="term-fg31">-                secp256k1_gej_add_var(&amp;precj[j*16 + i], &amp;precj[j*16 + i - 1], &amp;gbase, NULL);</span>
<span class="term-fg31">-            }</span>
<span class="term-fg31">-            &#47;* Multiply gbase by 16. *&#47;</span>
<span class="term-fg31">-            for (i = 0; i &lt; 4; i++) {</span>
<span class="term-fg31">-                secp256k1_gej_double_var(&amp;gbase, &amp;gbase, NULL);</span>
<span class="term-fg31">-            }</span>
<span class="term-fg31">-            &#47;* Multiply numbase by 2. *&#47;</span>
<span class="term-fg31">-            secp256k1_gej_double_var(&amp;numsbase, &amp;numsbase, NULL);</span>
<span class="term-fg31">-            if (j == 62) {</span>
<span class="term-fg31">-                &#47;* In the last iteration, numsbase is (1 - 2^j) * nums instead. *&#47;</span>
<span class="term-fg31">-                secp256k1_gej_neg(&amp;numsbase, &amp;numsbase);</span>
<span class="term-fg31">-                secp256k1_gej_add_var(&amp;numsbase, &amp;numsbase, &amp;nums_gej, NULL);</span>
<span class="term-fg31">-            }</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        secp256k1_ge_set_all_gej_var(prec, precj, 1024, cb);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    for (j = 0; j &lt; 64; j++) {</span>
<span class="term-fg31">-        for (i = 0; i &lt; 16; i++) {</span>
<span class="term-fg31">-            secp256k1_ge_to_storage(&amp;(*ctx-&gt;prec)[j][i], &amp;prec[j*16 + i]);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-#else</span>
<span class="term-fg31">-    (void)cb;</span>
<span class="term-fg31">-    ctx-&gt;prec = (secp256k1_ge_storage (*)[64][16])secp256k1_ecmult_static_context;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-    secp256k1_ecmult_gen_blind(ctx, NULL);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_ecmult_gen_context_is_built(const secp256k1_ecmult_gen_context* ctx) {</span>
<span class="term-fg31">-    return ctx-&gt;prec != NULL;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_ecmult_gen_context_clone(secp256k1_ecmult_gen_context *dst,</span>
<span class="term-fg31">-                                               const secp256k1_ecmult_gen_context *src, const secp256k1_callback* cb) {</span>
<span class="term-fg31">-    if (src-&gt;prec == NULL) {</span>
<span class="term-fg31">-        dst-&gt;prec = NULL;</span>
<span class="term-fg31">-    } else {</span>
<span class="term-fg31">-#ifndef USE_ECMULT_STATIC_PRECOMPUTATION</span>
<span class="term-fg31">-        dst-&gt;prec = (secp256k1_ge_storage (*)[64][16])checked_malloc(cb, sizeof(*dst-&gt;prec));</span>
<span class="term-fg31">-        memcpy(dst-&gt;prec, src-&gt;prec, sizeof(*dst-&gt;prec));</span>
<span class="term-fg31">-#else</span>
<span class="term-fg31">-        (void)cb;</span>
<span class="term-fg31">-        dst-&gt;prec = src-&gt;prec;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-        dst-&gt;initial = src-&gt;initial;</span>
<span class="term-fg31">-        dst-&gt;blind = src-&gt;blind;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_ecmult_gen_context_clear(secp256k1_ecmult_gen_context *ctx) {</span>
<span class="term-fg31">-#ifndef USE_ECMULT_STATIC_PRECOMPUTATION</span>
<span class="term-fg31">-    free(ctx-&gt;prec);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-    secp256k1_scalar_clear(&amp;ctx-&gt;blind);</span>
<span class="term-fg31">-    secp256k1_gej_clear(&amp;ctx-&gt;initial);</span>
<span class="term-fg31">-    ctx-&gt;prec = NULL;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_ecmult_gen(const secp256k1_ecmult_gen_context *ctx, secp256k1_gej *r, const secp256k1_scalar *gn) {</span>
<span class="term-fg31">-    secp256k1_ge add;</span>
<span class="term-fg31">-    secp256k1_ge_storage adds;</span>
<span class="term-fg31">-    secp256k1_scalar gnb;</span>
<span class="term-fg31">-    int bits;</span>
<span class="term-fg31">-    int i, j;</span>
<span class="term-fg31">-    memset(&amp;adds, 0, sizeof(adds));</span>
<span class="term-fg31">-    *r = ctx-&gt;initial;</span>
<span class="term-fg31">-    &#47;* Blind scalar&#47;point multiplication by computing (n-b)G + bG instead of nG. *&#47;</span>
<span class="term-fg31">-    secp256k1_scalar_add(&amp;gnb, gn, &amp;ctx-&gt;blind);</span>
<span class="term-fg31">-    add.infinity = 0;</span>
<span class="term-fg31">-    for (j = 0; j &lt; 64; j++) {</span>
<span class="term-fg31">-        bits = secp256k1_scalar_get_bits(&amp;gnb, j * 4, 4);</span>
<span class="term-fg31">-        for (i = 0; i &lt; 16; i++) {</span>
<span class="term-fg31">-            &#47;** This uses a conditional move to avoid any secret data in array indexes.</span>
<span class="term-fg31">-             *   _Any_ use of secret indexes has been demonstrated to result in timing</span>
<span class="term-fg31">-             *   sidechannels, even when the cache-line access patterns are uniform.</span>
<span class="term-fg31">-             *  See also:</span>
<span class="term-fg31">-             *   &quot;A word of warning&quot;, CHES 2013 Rump Session, by Daniel J. Bernstein and Peter Schwabe</span>
<span class="term-fg31">-             *    (https:&#47;&#47;cryptojedi.org&#47;peter&#47;data&#47;chesrump-20130822.pdf) and</span>
<span class="term-fg31">-             *   &quot;Cache Attacks and Countermeasures: the Case of AES&quot;, RSA 2006,</span>
<span class="term-fg31">-             *    by Dag Arne Osvik, Adi Shamir, and Eran Tromer</span>
<span class="term-fg31">-             *    (http:&#47;&#47;www.tau.ac.il&#47;~tromer&#47;papers&#47;cache.pdf)</span>
<span class="term-fg31">-             *&#47;</span>
<span class="term-fg31">-            secp256k1_ge_storage_cmov(&amp;adds, &amp;(*ctx-&gt;prec)[j][i], i == bits);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        secp256k1_ge_from_storage(&amp;add, &amp;adds);</span>
<span class="term-fg31">-        secp256k1_gej_add_ge(r, r, &amp;add);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    bits = 0;</span>
<span class="term-fg31">-    secp256k1_ge_clear(&amp;add);</span>
<span class="term-fg31">-    secp256k1_scalar_clear(&amp;gnb);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;* Setup blinding values for secp256k1_ecmult_gen. *&#47;</span>
<span class="term-fg31">-static void secp256k1_ecmult_gen_blind(secp256k1_ecmult_gen_context *ctx, const unsigned char *seed32) {</span>
<span class="term-fg31">-    secp256k1_scalar b;</span>
<span class="term-fg31">-    secp256k1_gej gb;</span>
<span class="term-fg31">-    secp256k1_fe s;</span>
<span class="term-fg31">-    unsigned char nonce32[32];</span>
<span class="term-fg31">-    secp256k1_rfc6979_hmac_sha256_t rng;</span>
<span class="term-fg31">-    int retry;</span>
<span class="term-fg31">-    unsigned char keydata[64] = {0};</span>
<span class="term-fg31">-    if (seed32 == NULL) {</span>
<span class="term-fg31">-        &#47;* When seed is NULL, reset the initial point and blinding value. *&#47;</span>
<span class="term-fg31">-        secp256k1_gej_set_ge(&amp;ctx-&gt;initial, &amp;secp256k1_ge_const_g);</span>
<span class="term-fg31">-        secp256k1_gej_neg(&amp;ctx-&gt;initial, &amp;ctx-&gt;initial);</span>
<span class="term-fg31">-        secp256k1_scalar_set_int(&amp;ctx-&gt;blind, 1);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    &#47;* The prior blinding value (if not reset) is chained forward by including it in the hash. *&#47;</span>
<span class="term-fg31">-    secp256k1_scalar_get_b32(nonce32, &amp;ctx-&gt;blind);</span>
<span class="term-fg31">-    &#47;** Using a CSPRNG allows a failure free interface, avoids needing large amounts of random data,</span>
<span class="term-fg31">-     *   and guards against weak or adversarial seeds.  This is a simpler and safer interface than</span>
<span class="term-fg31">-     *   asking the caller for blinding values directly and expecting them to retry on failure.</span>
<span class="term-fg31">-     *&#47;</span>
<span class="term-fg31">-    memcpy(keydata, nonce32, 32);</span>
<span class="term-fg31">-    if (seed32 != NULL) {</span>
<span class="term-fg31">-        memcpy(keydata + 32, seed32, 32);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_rfc6979_hmac_sha256_initialize(&amp;rng, keydata, seed32 ? 64 : 32);</span>
<span class="term-fg31">-    memset(keydata, 0, sizeof(keydata));</span>
<span class="term-fg31">-    &#47;* Retry for out of range results to achieve uniformity. *&#47;</span>
<span class="term-fg31">-    do {</span>
<span class="term-fg31">-        secp256k1_rfc6979_hmac_sha256_generate(&amp;rng, nonce32, 32);</span>
<span class="term-fg31">-        retry = !secp256k1_fe_set_b32(&amp;s, nonce32);</span>
<span class="term-fg31">-        retry |= secp256k1_fe_is_zero(&amp;s);</span>
<span class="term-fg31">-    } while (retry); &#47;* This branch true is cryptographically unreachable. Requires sha256_hmac output &gt; Fp. *&#47;</span>
<span class="term-fg31">-    &#47;* Randomize the projection to defend against multiplier sidechannels. *&#47;</span>
<span class="term-fg31">-    secp256k1_gej_rescale(&amp;ctx-&gt;initial, &amp;s);</span>
<span class="term-fg31">-    secp256k1_fe_clear(&amp;s);</span>
<span class="term-fg31">-    do {</span>
<span class="term-fg31">-        secp256k1_rfc6979_hmac_sha256_generate(&amp;rng, nonce32, 32);</span>
<span class="term-fg31">-        secp256k1_scalar_set_b32(&amp;b, nonce32, &amp;retry);</span>
<span class="term-fg31">-        &#47;* A blinding value of 0 works, but would undermine the projection hardening. *&#47;</span>
<span class="term-fg31">-        retry |= secp256k1_scalar_is_zero(&amp;b);</span>
<span class="term-fg31">-    } while (retry); &#47;* This branch true is cryptographically unreachable. Requires sha256_hmac output &gt; order. *&#47;</span>
<span class="term-fg31">-    secp256k1_rfc6979_hmac_sha256_finalize(&amp;rng);</span>
<span class="term-fg31">-    memset(nonce32, 0, 32);</span>
<span class="term-fg31">-    secp256k1_ecmult_gen(ctx, &amp;gb, &amp;b);</span>
<span class="term-fg31">-    secp256k1_scalar_negate(&amp;b, &amp;b);</span>
<span class="term-fg31">-    ctx-&gt;blind = b;</span>
<span class="term-fg31">-    ctx-&gt;initial = gb;</span>
<span class="term-fg31">-    secp256k1_scalar_clear(&amp;b);</span>
<span class="term-fg31">-    secp256k1_gej_clear(&amp;gb);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-be9aaddca3b6e46ab32af0f8" role="button"
                       aria-expanded="false" aria-controls="id-be9aaddca3b6e46ab32af0f8">
                        <code>crypto/secp256k1/libsecp256k1/src/ecmult_impl.h</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/ecmult_impl.h" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-406</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-be9aaddca3b6e46ab32af0f8"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;ecmult_impl.h op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;ecmult_impl.h</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 4e40104ad43ceb12845b79994c5bd5d28f3b31a0..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;ecmult_impl.h</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,406 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2013, 2014 Pieter Wuille                             *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef _SECP256K1_ECMULT_IMPL_H_</span>
<span class="term-fg31">-#define _SECP256K1_ECMULT_IMPL_H_</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &lt;string.h&gt;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &quot;group.h&quot;</span>
<span class="term-fg31">-#include &quot;scalar.h&quot;</span>
<span class="term-fg31">-#include &quot;ecmult.h&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#if defined(EXHAUSTIVE_TEST_ORDER)</span>
<span class="term-fg31">-&#47;* We need to lower these values for exhaustive tests because</span>
<span class="term-fg31">- * the tables cannot have infinities in them (this breaks the</span>
<span class="term-fg31">- * affine-isomorphism stuff which tracks z-ratios) *&#47;</span>
<span class="term-fg31">-#  if EXHAUSTIVE_TEST_ORDER &gt; 128</span>
<span class="term-fg31">-#    define WINDOW_A 5</span>
<span class="term-fg31">-#    define WINDOW_G 8</span>
<span class="term-fg31">-#  elif EXHAUSTIVE_TEST_ORDER &gt; 8</span>
<span class="term-fg31">-#    define WINDOW_A 4</span>
<span class="term-fg31">-#    define WINDOW_G 4</span>
<span class="term-fg31">-#  else</span>
<span class="term-fg31">-#    define WINDOW_A 2</span>
<span class="term-fg31">-#    define WINDOW_G 2</span>
<span class="term-fg31">-#  endif</span>
<span class="term-fg31">-#else</span>
<span class="term-fg31">-&#47;* optimal for 128-bit and 256-bit exponents. *&#47;</span>
<span class="term-fg31">-#define WINDOW_A 5</span>
<span class="term-fg31">-&#47;** larger numbers may result in slightly better performance, at the cost of</span>
<span class="term-fg31">-    exponentially larger precomputed tables. *&#47;</span>
<span class="term-fg31">-#ifdef USE_ENDOMORPHISM</span>
<span class="term-fg31">-&#47;** Two tables for window size 15: 1.375 MiB. *&#47;</span>
<span class="term-fg31">-#define WINDOW_G 15</span>
<span class="term-fg31">-#else</span>
<span class="term-fg31">-&#47;** One table for window size 16: 1.375 MiB. *&#47;</span>
<span class="term-fg31">-#define WINDOW_G 16</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** The number of entries a table with precomputed multiples needs to have. *&#47;</span>
<span class="term-fg31">-#define ECMULT_TABLE_SIZE(w) (1 &lt;&lt; ((w)-2))</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Fill a table &#39;prej&#39; with precomputed odd multiples of a. Prej will contain</span>
<span class="term-fg31">- *  the values [1*a,3*a,...,(2*n-1)*a], so it space for n values. zr[0] will</span>
<span class="term-fg31">- *  contain prej[0].z &#47; a.z. The other zr[i] values = prej[i].z &#47; prej[i-1].z.</span>
<span class="term-fg31">- *  Prej&#39;s Z values are undefined, except for the last value.</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-static void secp256k1_ecmult_odd_multiples_table(int n, secp256k1_gej *prej, secp256k1_fe *zr, const secp256k1_gej *a) {</span>
<span class="term-fg31">-    secp256k1_gej d;</span>
<span class="term-fg31">-    secp256k1_ge a_ge, d_ge;</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    VERIFY_CHECK(!a-&gt;infinity);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_gej_double_var(&amp;d, a, NULL);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;*</span>
<span class="term-fg31">-     * Perform the additions on an isomorphism where &#39;d&#39; is affine: drop the z coordinate</span>
<span class="term-fg31">-     * of &#39;d&#39;, and scale the 1P starting value&#39;s x&#47;y coordinates without changing its z.</span>
<span class="term-fg31">-     *&#47;</span>
<span class="term-fg31">-    d_ge.x = d.x;</span>
<span class="term-fg31">-    d_ge.y = d.y;</span>
<span class="term-fg31">-    d_ge.infinity = 0;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_ge_set_gej_zinv(&amp;a_ge, a, &amp;d.z);</span>
<span class="term-fg31">-    prej[0].x = a_ge.x;</span>
<span class="term-fg31">-    prej[0].y = a_ge.y;</span>
<span class="term-fg31">-    prej[0].z = a-&gt;z;</span>
<span class="term-fg31">-    prej[0].infinity = 0;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    zr[0] = d.z;</span>
<span class="term-fg31">-    for (i = 1; i &lt; n; i++) {</span>
<span class="term-fg31">-        secp256k1_gej_add_ge_var(&amp;prej[i], &amp;prej[i-1], &amp;d_ge, &amp;zr[i]);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;*</span>
<span class="term-fg31">-     * Each point in &#39;prej&#39; has a z coordinate too small by a factor of &#39;d.z&#39;. Only</span>
<span class="term-fg31">-     * the final point&#39;s z coordinate is actually used though, so just update that.</span>
<span class="term-fg31">-     *&#47;</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;prej[n-1].z, &amp;prej[n-1].z, &amp;d.z);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Fill a table &#39;pre&#39; with precomputed odd multiples of a.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  There are two versions of this function:</span>
<span class="term-fg31">- *  - secp256k1_ecmult_odd_multiples_table_globalz_windowa which brings its</span>
<span class="term-fg31">- *    resulting point set to a single constant Z denominator, stores the X and Y</span>
<span class="term-fg31">- *    coordinates as ge_storage points in pre, and stores the global Z in rz.</span>
<span class="term-fg31">- *    It only operates on tables sized for WINDOW_A wnaf multiples.</span>
<span class="term-fg31">- *  - secp256k1_ecmult_odd_multiples_table_storage_var, which converts its</span>
<span class="term-fg31">- *    resulting point set to actually affine points, and stores those in pre.</span>
<span class="term-fg31">- *    It operates on tables of any size, but uses heap-allocated temporaries.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  To compute a*P + b*G, we compute a table for P using the first function,</span>
<span class="term-fg31">- *  and for G using the second (which requires an inverse, but it only needs to</span>
<span class="term-fg31">- *  happen once).</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-static void secp256k1_ecmult_odd_multiples_table_globalz_windowa(secp256k1_ge *pre, secp256k1_fe *globalz, const secp256k1_gej *a) {</span>
<span class="term-fg31">-    secp256k1_gej prej[ECMULT_TABLE_SIZE(WINDOW_A)];</span>
<span class="term-fg31">-    secp256k1_fe zr[ECMULT_TABLE_SIZE(WINDOW_A)];</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Compute the odd multiples in Jacobian form. *&#47;</span>
<span class="term-fg31">-    secp256k1_ecmult_odd_multiples_table(ECMULT_TABLE_SIZE(WINDOW_A), prej, zr, a);</span>
<span class="term-fg31">-    &#47;* Bring them to the same Z denominator. *&#47;</span>
<span class="term-fg31">-    secp256k1_ge_globalz_set_table_gej(ECMULT_TABLE_SIZE(WINDOW_A), pre, globalz, prej, zr);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_ecmult_odd_multiples_table_storage_var(int n, secp256k1_ge_storage *pre, const secp256k1_gej *a, const secp256k1_callback *cb) {</span>
<span class="term-fg31">-    secp256k1_gej *prej = (secp256k1_gej*)checked_malloc(cb, sizeof(secp256k1_gej) * n);</span>
<span class="term-fg31">-    secp256k1_ge *prea = (secp256k1_ge*)checked_malloc(cb, sizeof(secp256k1_ge) * n);</span>
<span class="term-fg31">-    secp256k1_fe *zr = (secp256k1_fe*)checked_malloc(cb, sizeof(secp256k1_fe) * n);</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Compute the odd multiples in Jacobian form. *&#47;</span>
<span class="term-fg31">-    secp256k1_ecmult_odd_multiples_table(n, prej, zr, a);</span>
<span class="term-fg31">-    &#47;* Convert them in batch to affine coordinates. *&#47;</span>
<span class="term-fg31">-    secp256k1_ge_set_table_gej_var(prea, prej, zr, n);</span>
<span class="term-fg31">-    &#47;* Convert them to compact storage form. *&#47;</span>
<span class="term-fg31">-    for (i = 0; i &lt; n; i++) {</span>
<span class="term-fg31">-        secp256k1_ge_to_storage(&amp;pre[i], &amp;prea[i]);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    free(prea);</span>
<span class="term-fg31">-    free(prej);</span>
<span class="term-fg31">-    free(zr);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** The following two macro retrieves a particular odd multiple from a table</span>
<span class="term-fg31">- *  of precomputed multiples. *&#47;</span>
<span class="term-fg31">-#define ECMULT_TABLE_GET_GE(r,pre,n,w) do { \</span>
<span class="term-fg31">-    VERIFY_CHECK(((n) &amp; 1) == 1); \</span>
<span class="term-fg31">-    VERIFY_CHECK((n) &gt;= -((1 &lt;&lt; ((w)-1)) - 1)); \</span>
<span class="term-fg31">-    VERIFY_CHECK((n) &lt;=  ((1 &lt;&lt; ((w)-1)) - 1)); \</span>
<span class="term-fg31">-    if ((n) &gt; 0) { \</span>
<span class="term-fg31">-        *(r) = (pre)[((n)-1)&#47;2]; \</span>
<span class="term-fg31">-    } else { \</span>
<span class="term-fg31">-        secp256k1_ge_neg((r), &amp;(pre)[(-(n)-1)&#47;2]); \</span>
<span class="term-fg31">-    } \</span>
<span class="term-fg31">-} while(0)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#define ECMULT_TABLE_GET_GE_STORAGE(r,pre,n,w) do { \</span>
<span class="term-fg31">-    VERIFY_CHECK(((n) &amp; 1) == 1); \</span>
<span class="term-fg31">-    VERIFY_CHECK((n) &gt;= -((1 &lt;&lt; ((w)-1)) - 1)); \</span>
<span class="term-fg31">-    VERIFY_CHECK((n) &lt;=  ((1 &lt;&lt; ((w)-1)) - 1)); \</span>
<span class="term-fg31">-    if ((n) &gt; 0) { \</span>
<span class="term-fg31">-        secp256k1_ge_from_storage((r), &amp;(pre)[((n)-1)&#47;2]); \</span>
<span class="term-fg31">-    } else { \</span>
<span class="term-fg31">-        secp256k1_ge_from_storage((r), &amp;(pre)[(-(n)-1)&#47;2]); \</span>
<span class="term-fg31">-        secp256k1_ge_neg((r), (r)); \</span>
<span class="term-fg31">-    } \</span>
<span class="term-fg31">-} while(0)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_ecmult_context_init(secp256k1_ecmult_context *ctx) {</span>
<span class="term-fg31">-    ctx-&gt;pre_g = NULL;</span>
<span class="term-fg31">-#ifdef USE_ENDOMORPHISM</span>
<span class="term-fg31">-    ctx-&gt;pre_g_128 = NULL;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_ecmult_context_build(secp256k1_ecmult_context *ctx, const secp256k1_callback *cb) {</span>
<span class="term-fg31">-    secp256k1_gej gj;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    if (ctx-&gt;pre_g != NULL) {</span>
<span class="term-fg31">-        return;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* get the generator *&#47;</span>
<span class="term-fg31">-    secp256k1_gej_set_ge(&amp;gj, &amp;secp256k1_ge_const_g);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    ctx-&gt;pre_g = (secp256k1_ge_storage (*)[])checked_malloc(cb, sizeof((*ctx-&gt;pre_g)[0]) * ECMULT_TABLE_SIZE(WINDOW_G));</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* precompute the tables with odd multiples *&#47;</span>
<span class="term-fg31">-    secp256k1_ecmult_odd_multiples_table_storage_var(ECMULT_TABLE_SIZE(WINDOW_G), *ctx-&gt;pre_g, &amp;gj, cb);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef USE_ENDOMORPHISM</span>
<span class="term-fg31">-    {</span>
<span class="term-fg31">-        secp256k1_gej g_128j;</span>
<span class="term-fg31">-        int i;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        ctx-&gt;pre_g_128 = (secp256k1_ge_storage (*)[])checked_malloc(cb, sizeof((*ctx-&gt;pre_g_128)[0]) * ECMULT_TABLE_SIZE(WINDOW_G));</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        &#47;* calculate 2^128*generator *&#47;</span>
<span class="term-fg31">-        g_128j = gj;</span>
<span class="term-fg31">-        for (i = 0; i &lt; 128; i++) {</span>
<span class="term-fg31">-            secp256k1_gej_double_var(&amp;g_128j, &amp;g_128j, NULL);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        secp256k1_ecmult_odd_multiples_table_storage_var(ECMULT_TABLE_SIZE(WINDOW_G), *ctx-&gt;pre_g_128, &amp;g_128j, cb);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_ecmult_context_clone(secp256k1_ecmult_context *dst,</span>
<span class="term-fg31">-                                           const secp256k1_ecmult_context *src, const secp256k1_callback *cb) {</span>
<span class="term-fg31">-    if (src-&gt;pre_g == NULL) {</span>
<span class="term-fg31">-        dst-&gt;pre_g = NULL;</span>
<span class="term-fg31">-    } else {</span>
<span class="term-fg31">-        size_t size = sizeof((*dst-&gt;pre_g)[0]) * ECMULT_TABLE_SIZE(WINDOW_G);</span>
<span class="term-fg31">-        dst-&gt;pre_g = (secp256k1_ge_storage (*)[])checked_malloc(cb, size);</span>
<span class="term-fg31">-        memcpy(dst-&gt;pre_g, src-&gt;pre_g, size);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-#ifdef USE_ENDOMORPHISM</span>
<span class="term-fg31">-    if (src-&gt;pre_g_128 == NULL) {</span>
<span class="term-fg31">-        dst-&gt;pre_g_128 = NULL;</span>
<span class="term-fg31">-    } else {</span>
<span class="term-fg31">-        size_t size = sizeof((*dst-&gt;pre_g_128)[0]) * ECMULT_TABLE_SIZE(WINDOW_G);</span>
<span class="term-fg31">-        dst-&gt;pre_g_128 = (secp256k1_ge_storage (*)[])checked_malloc(cb, size);</span>
<span class="term-fg31">-        memcpy(dst-&gt;pre_g_128, src-&gt;pre_g_128, size);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_ecmult_context_is_built(const secp256k1_ecmult_context *ctx) {</span>
<span class="term-fg31">-    return ctx-&gt;pre_g != NULL;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_ecmult_context_clear(secp256k1_ecmult_context *ctx) {</span>
<span class="term-fg31">-    free(ctx-&gt;pre_g);</span>
<span class="term-fg31">-#ifdef USE_ENDOMORPHISM</span>
<span class="term-fg31">-    free(ctx-&gt;pre_g_128);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-    secp256k1_ecmult_context_init(ctx);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Convert a number to WNAF notation. The number becomes represented by sum(2^i * wnaf[i], i=0..bits),</span>
<span class="term-fg31">- *  with the following guarantees:</span>
<span class="term-fg31">- *  - each wnaf[i] is either 0, or an odd integer between -(1&lt;&lt;(w-1) - 1) and (1&lt;&lt;(w-1) - 1)</span>
<span class="term-fg31">- *  - two non-zero entries in wnaf are separated by at least w-1 zeroes.</span>
<span class="term-fg31">- *  - the number of set values in wnaf is returned. This number is at most 256, and at most one more</span>
<span class="term-fg31">- *    than the number of bits in the (absolute value) of the input.</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-static int secp256k1_ecmult_wnaf(int *wnaf, int len, const secp256k1_scalar *a, int w) {</span>
<span class="term-fg31">-    secp256k1_scalar s = *a;</span>
<span class="term-fg31">-    int last_set_bit = -1;</span>
<span class="term-fg31">-    int bit = 0;</span>
<span class="term-fg31">-    int sign = 1;</span>
<span class="term-fg31">-    int carry = 0;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    VERIFY_CHECK(wnaf != NULL);</span>
<span class="term-fg31">-    VERIFY_CHECK(0 &lt;= len &amp;&amp; len &lt;= 256);</span>
<span class="term-fg31">-    VERIFY_CHECK(a != NULL);</span>
<span class="term-fg31">-    VERIFY_CHECK(2 &lt;= w &amp;&amp; w &lt;= 31);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    memset(wnaf, 0, len * sizeof(wnaf[0]));</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    if (secp256k1_scalar_get_bits(&amp;s, 255, 1)) {</span>
<span class="term-fg31">-        secp256k1_scalar_negate(&amp;s, &amp;s);</span>
<span class="term-fg31">-        sign = -1;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    while (bit &lt; len) {</span>
<span class="term-fg31">-        int now;</span>
<span class="term-fg31">-        int word;</span>
<span class="term-fg31">-        if (secp256k1_scalar_get_bits(&amp;s, bit, 1) == (unsigned int)carry) {</span>
<span class="term-fg31">-            bit++;</span>
<span class="term-fg31">-            continue;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        now = w;</span>
<span class="term-fg31">-        if (now &gt; len - bit) {</span>
<span class="term-fg31">-            now = len - bit;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        word = secp256k1_scalar_get_bits_var(&amp;s, bit, now) + carry;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        carry = (word &gt;&gt; (w-1)) &amp; 1;</span>
<span class="term-fg31">-        word -= carry &lt;&lt; w;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        wnaf[bit] = sign * word;</span>
<span class="term-fg31">-        last_set_bit = bit;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        bit += now;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-    CHECK(carry == 0);</span>
<span class="term-fg31">-    while (bit &lt; 256) {</span>
<span class="term-fg31">-        CHECK(secp256k1_scalar_get_bits(&amp;s, bit++, 1) == 0);</span>
<span class="term-fg31">-    } </span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-    return last_set_bit + 1;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_ecmult(const secp256k1_ecmult_context *ctx, secp256k1_gej *r, const secp256k1_gej *a, const secp256k1_scalar *na, const secp256k1_scalar *ng) {</span>
<span class="term-fg31">-    secp256k1_ge pre_a[ECMULT_TABLE_SIZE(WINDOW_A)];</span>
<span class="term-fg31">-    secp256k1_ge tmpa;</span>
<span class="term-fg31">-    secp256k1_fe Z;</span>
<span class="term-fg31">-#ifdef USE_ENDOMORPHISM</span>
<span class="term-fg31">-    secp256k1_ge pre_a_lam[ECMULT_TABLE_SIZE(WINDOW_A)];</span>
<span class="term-fg31">-    secp256k1_scalar na_1, na_lam;</span>
<span class="term-fg31">-    &#47;* Splitted G factors. *&#47;</span>
<span class="term-fg31">-    secp256k1_scalar ng_1, ng_128;</span>
<span class="term-fg31">-    int wnaf_na_1[130];</span>
<span class="term-fg31">-    int wnaf_na_lam[130];</span>
<span class="term-fg31">-    int bits_na_1;</span>
<span class="term-fg31">-    int bits_na_lam;</span>
<span class="term-fg31">-    int wnaf_ng_1[129];</span>
<span class="term-fg31">-    int bits_ng_1;</span>
<span class="term-fg31">-    int wnaf_ng_128[129];</span>
<span class="term-fg31">-    int bits_ng_128;</span>
<span class="term-fg31">-#else</span>
<span class="term-fg31">-    int wnaf_na[256];</span>
<span class="term-fg31">-    int bits_na;</span>
<span class="term-fg31">-    int wnaf_ng[256];</span>
<span class="term-fg31">-    int bits_ng;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    int bits;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef USE_ENDOMORPHISM</span>
<span class="term-fg31">-    &#47;* split na into na_1 and na_lam (where na = na_1 + na_lam*lambda, and na_1 and na_lam are ~128 bit) *&#47;</span>
<span class="term-fg31">-    secp256k1_scalar_split_lambda(&amp;na_1, &amp;na_lam, na);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* build wnaf representation for na_1 and na_lam. *&#47;</span>
<span class="term-fg31">-    bits_na_1   = secp256k1_ecmult_wnaf(wnaf_na_1,   130, &amp;na_1,   WINDOW_A);</span>
<span class="term-fg31">-    bits_na_lam = secp256k1_ecmult_wnaf(wnaf_na_lam, 130, &amp;na_lam, WINDOW_A);</span>
<span class="term-fg31">-    VERIFY_CHECK(bits_na_1 &lt;= 130);</span>
<span class="term-fg31">-    VERIFY_CHECK(bits_na_lam &lt;= 130);</span>
<span class="term-fg31">-    bits = bits_na_1;</span>
<span class="term-fg31">-    if (bits_na_lam &gt; bits) {</span>
<span class="term-fg31">-        bits = bits_na_lam;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-#else</span>
<span class="term-fg31">-    &#47;* build wnaf representation for na. *&#47;</span>
<span class="term-fg31">-    bits_na     = secp256k1_ecmult_wnaf(wnaf_na,     256, na,      WINDOW_A);</span>
<span class="term-fg31">-    bits = bits_na;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Calculate odd multiples of a.</span>
<span class="term-fg31">-     * All multiples are brought to the same Z &#39;denominator&#39;, which is stored</span>
<span class="term-fg31">-     * in Z. Due to secp256k1&#39; isomorphism we can do all operations pretending</span>
<span class="term-fg31">-     * that the Z coordinate was 1, use affine addition formulae, and correct</span>
<span class="term-fg31">-     * the Z coordinate of the result once at the end.</span>
<span class="term-fg31">-     * The exception is the precomputed G table points, which are actually</span>
<span class="term-fg31">-     * affine. Compared to the base used for other points, they have a Z ratio</span>
<span class="term-fg31">-     * of 1&#47;Z, so we can use secp256k1_gej_add_zinv_var, which uses the same</span>
<span class="term-fg31">-     * isomorphism to efficiently add with a known Z inverse.</span>
<span class="term-fg31">-     *&#47;</span>
<span class="term-fg31">-    secp256k1_ecmult_odd_multiples_table_globalz_windowa(pre_a, &amp;Z, a);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef USE_ENDOMORPHISM</span>
<span class="term-fg31">-    for (i = 0; i &lt; ECMULT_TABLE_SIZE(WINDOW_A); i++) {</span>
<span class="term-fg31">-        secp256k1_ge_mul_lambda(&amp;pre_a_lam[i], &amp;pre_a[i]);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* split ng into ng_1 and ng_128 (where gn = gn_1 + gn_128*2^128, and gn_1 and gn_128 are ~128 bit) *&#47;</span>
<span class="term-fg31">-    secp256k1_scalar_split_128(&amp;ng_1, &amp;ng_128, ng);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Build wnaf representation for ng_1 and ng_128 *&#47;</span>
<span class="term-fg31">-    bits_ng_1   = secp256k1_ecmult_wnaf(wnaf_ng_1,   129, &amp;ng_1,   WINDOW_G);</span>
<span class="term-fg31">-    bits_ng_128 = secp256k1_ecmult_wnaf(wnaf_ng_128, 129, &amp;ng_128, WINDOW_G);</span>
<span class="term-fg31">-    if (bits_ng_1 &gt; bits) {</span>
<span class="term-fg31">-        bits = bits_ng_1;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    if (bits_ng_128 &gt; bits) {</span>
<span class="term-fg31">-        bits = bits_ng_128;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-#else</span>
<span class="term-fg31">-    bits_ng     = secp256k1_ecmult_wnaf(wnaf_ng,     256, ng,      WINDOW_G);</span>
<span class="term-fg31">-    if (bits_ng &gt; bits) {</span>
<span class="term-fg31">-        bits = bits_ng;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_gej_set_infinity(r);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    for (i = bits - 1; i &gt;= 0; i--) {</span>
<span class="term-fg31">-        int n;</span>
<span class="term-fg31">-        secp256k1_gej_double_var(r, r, NULL);</span>
<span class="term-fg31">-#ifdef USE_ENDOMORPHISM</span>
<span class="term-fg31">-        if (i &lt; bits_na_1 &amp;&amp; (n = wnaf_na_1[i])) {</span>
<span class="term-fg31">-            ECMULT_TABLE_GET_GE(&amp;tmpa, pre_a, n, WINDOW_A);</span>
<span class="term-fg31">-            secp256k1_gej_add_ge_var(r, r, &amp;tmpa, NULL);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        if (i &lt; bits_na_lam &amp;&amp; (n = wnaf_na_lam[i])) {</span>
<span class="term-fg31">-            ECMULT_TABLE_GET_GE(&amp;tmpa, pre_a_lam, n, WINDOW_A);</span>
<span class="term-fg31">-            secp256k1_gej_add_ge_var(r, r, &amp;tmpa, NULL);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        if (i &lt; bits_ng_1 &amp;&amp; (n = wnaf_ng_1[i])) {</span>
<span class="term-fg31">-            ECMULT_TABLE_GET_GE_STORAGE(&amp;tmpa, *ctx-&gt;pre_g, n, WINDOW_G);</span>
<span class="term-fg31">-            secp256k1_gej_add_zinv_var(r, r, &amp;tmpa, &amp;Z);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        if (i &lt; bits_ng_128 &amp;&amp; (n = wnaf_ng_128[i])) {</span>
<span class="term-fg31">-            ECMULT_TABLE_GET_GE_STORAGE(&amp;tmpa, *ctx-&gt;pre_g_128, n, WINDOW_G);</span>
<span class="term-fg31">-            secp256k1_gej_add_zinv_var(r, r, &amp;tmpa, &amp;Z);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-#else</span>
<span class="term-fg31">-        if (i &lt; bits_na &amp;&amp; (n = wnaf_na[i])) {</span>
<span class="term-fg31">-            ECMULT_TABLE_GET_GE(&amp;tmpa, pre_a, n, WINDOW_A);</span>
<span class="term-fg31">-            secp256k1_gej_add_ge_var(r, r, &amp;tmpa, NULL);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        if (i &lt; bits_ng &amp;&amp; (n = wnaf_ng[i])) {</span>
<span class="term-fg31">-            ECMULT_TABLE_GET_GE_STORAGE(&amp;tmpa, *ctx-&gt;pre_g, n, WINDOW_G);</span>
<span class="term-fg31">-            secp256k1_gej_add_zinv_var(r, r, &amp;tmpa, &amp;Z);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    if (!r-&gt;infinity) {</span>
<span class="term-fg31">-        secp256k1_fe_mul(&amp;r-&gt;z, &amp;r-&gt;z, &amp;Z);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-5ec14a279240d33834ee30e0" role="button"
                       aria-expanded="false" aria-controls="id-5ec14a279240d33834ee30e0">
                        <code>crypto/secp256k1/libsecp256k1/src/field.h</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/field.h" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-132</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-5ec14a279240d33834ee30e0"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;field.h op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;field.h</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index bbb1ee866cc427108f03a4f94fc1da27981c29fa..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;field.h</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,132 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2013, 2014 Pieter Wuille                             *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef _SECP256K1_FIELD_</span>
<span class="term-fg31">-#define _SECP256K1_FIELD_</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Field element module.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *  Field elements can be represented in several ways, but code accessing</span>
<span class="term-fg31">- *  it (and implementations) need to take certain properties into account:</span>
<span class="term-fg31">- *  - Each field element can be normalized or not.</span>
<span class="term-fg31">- *  - Each field element has a magnitude, which represents how far away</span>
<span class="term-fg31">- *    its representation is away from normalization. Normalized elements</span>
<span class="term-fg31">- *    always have a magnitude of 1, but a magnitude of 1 doesn&#39;t imply</span>
<span class="term-fg31">- *    normality.</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#if defined HAVE_CONFIG_H</span>
<span class="term-fg31">-#include &quot;libsecp256k1-config.h&quot;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#if defined(USE_FIELD_10X26)</span>
<span class="term-fg31">-#include &quot;field_10x26.h&quot;</span>
<span class="term-fg31">-#elif defined(USE_FIELD_5X52)</span>
<span class="term-fg31">-#include &quot;field_5x52.h&quot;</span>
<span class="term-fg31">-#else</span>
<span class="term-fg31">-#error &quot;Please select field implementation&quot;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &quot;util.h&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Normalize a field element. *&#47;</span>
<span class="term-fg31">-static void secp256k1_fe_normalize(secp256k1_fe *r);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Weakly normalize a field element: reduce it magnitude to 1, but don&#39;t fully normalize. *&#47;</span>
<span class="term-fg31">-static void secp256k1_fe_normalize_weak(secp256k1_fe *r);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Normalize a field element, without constant-time guarantee. *&#47;</span>
<span class="term-fg31">-static void secp256k1_fe_normalize_var(secp256k1_fe *r);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Verify whether a field element represents zero i.e. would normalize to a zero value. The field</span>
<span class="term-fg31">- *  implementation may optionally normalize the input, but this should not be relied upon. *&#47;</span>
<span class="term-fg31">-static int secp256k1_fe_normalizes_to_zero(secp256k1_fe *r);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Verify whether a field element represents zero i.e. would normalize to a zero value. The field</span>
<span class="term-fg31">- *  implementation may optionally normalize the input, but this should not be relied upon. *&#47;</span>
<span class="term-fg31">-static int secp256k1_fe_normalizes_to_zero_var(secp256k1_fe *r);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Set a field element equal to a small integer. Resulting field element is normalized. *&#47;</span>
<span class="term-fg31">-static void secp256k1_fe_set_int(secp256k1_fe *r, int a);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Sets a field element equal to zero, initializing all fields. *&#47;</span>
<span class="term-fg31">-static void secp256k1_fe_clear(secp256k1_fe *a);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Verify whether a field element is zero. Requires the input to be normalized. *&#47;</span>
<span class="term-fg31">-static int secp256k1_fe_is_zero(const secp256k1_fe *a);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Check the &quot;oddness&quot; of a field element. Requires the input to be normalized. *&#47;</span>
<span class="term-fg31">-static int secp256k1_fe_is_odd(const secp256k1_fe *a);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Compare two field elements. Requires magnitude-1 inputs. *&#47;</span>
<span class="term-fg31">-static int secp256k1_fe_equal(const secp256k1_fe *a, const secp256k1_fe *b);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Same as secp256k1_fe_equal, but may be variable time. *&#47;</span>
<span class="term-fg31">-static int secp256k1_fe_equal_var(const secp256k1_fe *a, const secp256k1_fe *b);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Compare two field elements. Requires both inputs to be normalized *&#47;</span>
<span class="term-fg31">-static int secp256k1_fe_cmp_var(const secp256k1_fe *a, const secp256k1_fe *b);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Set a field element equal to 32-byte big endian value. If successful, the resulting field element is normalized. *&#47;</span>
<span class="term-fg31">-static int secp256k1_fe_set_b32(secp256k1_fe *r, const unsigned char *a);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Convert a field element to a 32-byte big endian value. Requires the input to be normalized *&#47;</span>
<span class="term-fg31">-static void secp256k1_fe_get_b32(unsigned char *r, const secp256k1_fe *a);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Set a field element equal to the additive inverse of another. Takes a maximum magnitude of the input</span>
<span class="term-fg31">- *  as an argument. The magnitude of the output is one higher. *&#47;</span>
<span class="term-fg31">-static void secp256k1_fe_negate(secp256k1_fe *r, const secp256k1_fe *a, int m);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Multiplies the passed field element with a small integer constant. Multiplies the magnitude by that</span>
<span class="term-fg31">- *  small integer. *&#47;</span>
<span class="term-fg31">-static void secp256k1_fe_mul_int(secp256k1_fe *r, int a);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Adds a field element to another. The result has the sum of the inputs&#39; magnitudes as magnitude. *&#47;</span>
<span class="term-fg31">-static void secp256k1_fe_add(secp256k1_fe *r, const secp256k1_fe *a);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Sets a field element to be the product of two others. Requires the inputs&#39; magnitudes to be at most 8.</span>
<span class="term-fg31">- *  The output magnitude is 1 (but not guaranteed to be normalized). *&#47;</span>
<span class="term-fg31">-static void secp256k1_fe_mul(secp256k1_fe *r, const secp256k1_fe *a, const secp256k1_fe * SECP256K1_RESTRICT b);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Sets a field element to be the square of another. Requires the input&#39;s magnitude to be at most 8.</span>
<span class="term-fg31">- *  The output magnitude is 1 (but not guaranteed to be normalized). *&#47;</span>
<span class="term-fg31">-static void secp256k1_fe_sqr(secp256k1_fe *r, const secp256k1_fe *a);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** If a has a square root, it is computed in r and 1 is returned. If a does not</span>
<span class="term-fg31">- *  have a square root, the root of its negation is computed and 0 is returned.</span>
<span class="term-fg31">- *  The input&#39;s magnitude can be at most 8. The output magnitude is 1 (but not</span>
<span class="term-fg31">- *  guaranteed to be normalized). The result in r will always be a square</span>
<span class="term-fg31">- *  itself. *&#47;</span>
<span class="term-fg31">-static int secp256k1_fe_sqrt(secp256k1_fe *r, const secp256k1_fe *a);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Checks whether a field element is a quadratic residue. *&#47;</span>
<span class="term-fg31">-static int secp256k1_fe_is_quad_var(const secp256k1_fe *a);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Sets a field element to be the (modular) inverse of another. Requires the input&#39;s magnitude to be</span>
<span class="term-fg31">- *  at most 8. The output magnitude is 1 (but not guaranteed to be normalized). *&#47;</span>
<span class="term-fg31">-static void secp256k1_fe_inv(secp256k1_fe *r, const secp256k1_fe *a);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Potentially faster version of secp256k1_fe_inv, without constant-time guarantee. *&#47;</span>
<span class="term-fg31">-static void secp256k1_fe_inv_var(secp256k1_fe *r, const secp256k1_fe *a);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Calculate the (modular) inverses of a batch of field elements. Requires the inputs&#39; magnitudes to be</span>
<span class="term-fg31">- *  at most 8. The output magnitudes are 1 (but not guaranteed to be normalized). The inputs and</span>
<span class="term-fg31">- *  outputs must not overlap in memory. *&#47;</span>
<span class="term-fg31">-static void secp256k1_fe_inv_all_var(secp256k1_fe *r, const secp256k1_fe *a, size_t len);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Convert a field element to the storage type. *&#47;</span>
<span class="term-fg31">-static void secp256k1_fe_to_storage(secp256k1_fe_storage *r, const secp256k1_fe *a);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Convert a field element back from the storage type. *&#47;</span>
<span class="term-fg31">-static void secp256k1_fe_from_storage(secp256k1_fe *r, const secp256k1_fe_storage *a);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** If flag is true, set *r equal to *a; otherwise leave it. Constant-time. *&#47;</span>
<span class="term-fg31">-static void secp256k1_fe_storage_cmov(secp256k1_fe_storage *r, const secp256k1_fe_storage *a, int flag);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** If flag is true, set *r equal to *a; otherwise leave it. Constant-time. *&#47;</span>
<span class="term-fg31">-static void secp256k1_fe_cmov(secp256k1_fe *r, const secp256k1_fe *a, int flag);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-6ec8ad03200e610630328e56" role="button"
                       aria-expanded="false" aria-controls="id-6ec8ad03200e610630328e56">
                        <code>crypto/secp256k1/libsecp256k1/src/field_10x26.h</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/field_10x26.h" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-47</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-6ec8ad03200e610630328e56"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;field_10x26.h op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;field_10x26.h</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 61ee1e09656442501ef8f16ea96dc48b19ead357..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;field_10x26.h</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,47 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2013, 2014 Pieter Wuille                             *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef _SECP256K1_FIELD_REPR_</span>
<span class="term-fg31">-#define _SECP256K1_FIELD_REPR_</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &lt;stdint.h&gt;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-typedef struct {</span>
<span class="term-fg31">-    &#47;* X = sum(i=0..9, elem[i]*2^26) mod n *&#47;</span>
<span class="term-fg31">-    uint32_t n[10];</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-    int magnitude;</span>
<span class="term-fg31">-    int normalized;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-} secp256k1_fe;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;* Unpacks a constant into a overlapping multi-limbed FE element. *&#47;</span>
<span class="term-fg31">-#define SECP256K1_FE_CONST_INNER(d7, d6, d5, d4, d3, d2, d1, d0) { \</span>
<span class="term-fg31">-    (d0) &amp; 0x3FFFFFFUL, \</span>
<span class="term-fg31">-    (((uint32_t)d0) &gt;&gt; 26) | (((uint32_t)(d1) &amp; 0xFFFFFUL) &lt;&lt; 6), \</span>
<span class="term-fg31">-    (((uint32_t)d1) &gt;&gt; 20) | (((uint32_t)(d2) &amp; 0x3FFFUL) &lt;&lt; 12), \</span>
<span class="term-fg31">-    (((uint32_t)d2) &gt;&gt; 14) | (((uint32_t)(d3) &amp; 0xFFUL) &lt;&lt; 18), \</span>
<span class="term-fg31">-    (((uint32_t)d3) &gt;&gt; 8) | (((uint32_t)(d4) &amp; 0x3UL) &lt;&lt; 24), \</span>
<span class="term-fg31">-    (((uint32_t)d4) &gt;&gt; 2) &amp; 0x3FFFFFFUL, \</span>
<span class="term-fg31">-    (((uint32_t)d4) &gt;&gt; 28) | (((uint32_t)(d5) &amp; 0x3FFFFFUL) &lt;&lt; 4), \</span>
<span class="term-fg31">-    (((uint32_t)d5) &gt;&gt; 22) | (((uint32_t)(d6) &amp; 0xFFFFUL) &lt;&lt; 10), \</span>
<span class="term-fg31">-    (((uint32_t)d6) &gt;&gt; 16) | (((uint32_t)(d7) &amp; 0x3FFUL) &lt;&lt; 16), \</span>
<span class="term-fg31">-    (((uint32_t)d7) &gt;&gt; 10) \</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-#define SECP256K1_FE_CONST(d7, d6, d5, d4, d3, d2, d1, d0) {SECP256K1_FE_CONST_INNER((d7), (d6), (d5), (d4), (d3), (d2), (d1), (d0)), 1, 1}</span>
<span class="term-fg31">-#else</span>
<span class="term-fg31">-#define SECP256K1_FE_CONST(d7, d6, d5, d4, d3, d2, d1, d0) {SECP256K1_FE_CONST_INNER((d7), (d6), (d5), (d4), (d3), (d2), (d1), (d0))}</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-typedef struct {</span>
<span class="term-fg31">-    uint32_t n[8];</span>
<span class="term-fg31">-} secp256k1_fe_storage;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#define SECP256K1_FE_STORAGE_CONST(d7, d6, d5, d4, d3, d2, d1, d0) {{ (d0), (d1), (d2), (d3), (d4), (d5), (d6), (d7) }}</span>
<span class="term-fg31">-#define SECP256K1_FE_STORAGE_CONST_GET(d) d.n[7], d.n[6], d.n[5], d.n[4],d.n[3], d.n[2], d.n[1], d.n[0]</span>
<span class="term-fg31">-#endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-c1c079291a3761f6ac4abbb2" role="button"
                       aria-expanded="false" aria-controls="id-c1c079291a3761f6ac4abbb2">
                        <code>crypto/secp256k1/libsecp256k1/src/field_10x26_impl.h</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/field_10x26_impl.h" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-1140</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-c1c079291a3761f6ac4abbb2"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;field_10x26_impl.h op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;field_10x26_impl.h</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 5fb092f1beb5cb0d07dcbe180150d14321e9ddba..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;field_10x26_impl.h</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,1140 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2013, 2014 Pieter Wuille                             *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef _SECP256K1_FIELD_REPR_IMPL_H_</span>
<span class="term-fg31">-#define _SECP256K1_FIELD_REPR_IMPL_H_</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &quot;util.h&quot;</span>
<span class="term-fg31">-#include &quot;num.h&quot;</span>
<span class="term-fg31">-#include &quot;field.h&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-static void secp256k1_fe_verify(const secp256k1_fe *a) {</span>
<span class="term-fg31">-    const uint32_t *d = a-&gt;n;</span>
<span class="term-fg31">-    int m = a-&gt;normalized ? 1 : 2 * a-&gt;magnitude, r = 1;</span>
<span class="term-fg31">-    r &amp;= (d[0] &lt;= 0x3FFFFFFUL * m);</span>
<span class="term-fg31">-    r &amp;= (d[1] &lt;= 0x3FFFFFFUL * m);</span>
<span class="term-fg31">-    r &amp;= (d[2] &lt;= 0x3FFFFFFUL * m);</span>
<span class="term-fg31">-    r &amp;= (d[3] &lt;= 0x3FFFFFFUL * m);</span>
<span class="term-fg31">-    r &amp;= (d[4] &lt;= 0x3FFFFFFUL * m);</span>
<span class="term-fg31">-    r &amp;= (d[5] &lt;= 0x3FFFFFFUL * m);</span>
<span class="term-fg31">-    r &amp;= (d[6] &lt;= 0x3FFFFFFUL * m);</span>
<span class="term-fg31">-    r &amp;= (d[7] &lt;= 0x3FFFFFFUL * m);</span>
<span class="term-fg31">-    r &amp;= (d[8] &lt;= 0x3FFFFFFUL * m);</span>
<span class="term-fg31">-    r &amp;= (d[9] &lt;= 0x03FFFFFUL * m);</span>
<span class="term-fg31">-    r &amp;= (a-&gt;magnitude &gt;= 0);</span>
<span class="term-fg31">-    r &amp;= (a-&gt;magnitude &lt;= 32);</span>
<span class="term-fg31">-    if (a-&gt;normalized) {</span>
<span class="term-fg31">-        r &amp;= (a-&gt;magnitude &lt;= 1);</span>
<span class="term-fg31">-        if (r &amp;&amp; (d[9] == 0x03FFFFFUL)) {</span>
<span class="term-fg31">-            uint32_t mid = d[8] &amp; d[7] &amp; d[6] &amp; d[5] &amp; d[4] &amp; d[3] &amp; d[2];</span>
<span class="term-fg31">-            if (mid == 0x3FFFFFFUL) {</span>
<span class="term-fg31">-                r &amp;= ((d[1] + 0x40UL + ((d[0] + 0x3D1UL) &gt;&gt; 26)) &lt;= 0x3FFFFFFUL);</span>
<span class="term-fg31">-            }</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    VERIFY_CHECK(r == 1);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_fe_normalize(secp256k1_fe *r) {</span>
<span class="term-fg31">-    uint32_t t0 = r-&gt;n[0], t1 = r-&gt;n[1], t2 = r-&gt;n[2], t3 = r-&gt;n[3], t4 = r-&gt;n[4],</span>
<span class="term-fg31">-             t5 = r-&gt;n[5], t6 = r-&gt;n[6], t7 = r-&gt;n[7], t8 = r-&gt;n[8], t9 = r-&gt;n[9];</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Reduce t9 at the start so there will be at most a single carry from the first pass *&#47;</span>
<span class="term-fg31">-    uint32_t m;</span>
<span class="term-fg31">-    uint32_t x = t9 &gt;&gt; 22; t9 &amp;= 0x03FFFFFUL;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* The first pass ensures the magnitude is 1, ... *&#47;</span>
<span class="term-fg31">-    t0 += x * 0x3D1UL; t1 += (x &lt;&lt; 6);</span>
<span class="term-fg31">-    t1 += (t0 &gt;&gt; 26); t0 &amp;= 0x3FFFFFFUL;</span>
<span class="term-fg31">-    t2 += (t1 &gt;&gt; 26); t1 &amp;= 0x3FFFFFFUL;</span>
<span class="term-fg31">-    t3 += (t2 &gt;&gt; 26); t2 &amp;= 0x3FFFFFFUL; m = t2;</span>
<span class="term-fg31">-    t4 += (t3 &gt;&gt; 26); t3 &amp;= 0x3FFFFFFUL; m &amp;= t3;</span>
<span class="term-fg31">-    t5 += (t4 &gt;&gt; 26); t4 &amp;= 0x3FFFFFFUL; m &amp;= t4;</span>
<span class="term-fg31">-    t6 += (t5 &gt;&gt; 26); t5 &amp;= 0x3FFFFFFUL; m &amp;= t5;</span>
<span class="term-fg31">-    t7 += (t6 &gt;&gt; 26); t6 &amp;= 0x3FFFFFFUL; m &amp;= t6;</span>
<span class="term-fg31">-    t8 += (t7 &gt;&gt; 26); t7 &amp;= 0x3FFFFFFUL; m &amp;= t7;</span>
<span class="term-fg31">-    t9 += (t8 &gt;&gt; 26); t8 &amp;= 0x3FFFFFFUL; m &amp;= t8;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* ... except for a possible carry at bit 22 of t9 (i.e. bit 256 of the field element) *&#47;</span>
<span class="term-fg31">-    VERIFY_CHECK(t9 &gt;&gt; 23 == 0);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* At most a single final reduction is needed; check if the value is &gt;= the field characteristic *&#47;</span>
<span class="term-fg31">-    x = (t9 &gt;&gt; 22) | ((t9 == 0x03FFFFFUL) &amp; (m == 0x3FFFFFFUL)</span>
<span class="term-fg31">-        &amp; ((t1 + 0x40UL + ((t0 + 0x3D1UL) &gt;&gt; 26)) &gt; 0x3FFFFFFUL));</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Apply the final reduction (for constant-time behaviour, we do it always) *&#47;</span>
<span class="term-fg31">-    t0 += x * 0x3D1UL; t1 += (x &lt;&lt; 6);</span>
<span class="term-fg31">-    t1 += (t0 &gt;&gt; 26); t0 &amp;= 0x3FFFFFFUL;</span>
<span class="term-fg31">-    t2 += (t1 &gt;&gt; 26); t1 &amp;= 0x3FFFFFFUL;</span>
<span class="term-fg31">-    t3 += (t2 &gt;&gt; 26); t2 &amp;= 0x3FFFFFFUL;</span>
<span class="term-fg31">-    t4 += (t3 &gt;&gt; 26); t3 &amp;= 0x3FFFFFFUL;</span>
<span class="term-fg31">-    t5 += (t4 &gt;&gt; 26); t4 &amp;= 0x3FFFFFFUL;</span>
<span class="term-fg31">-    t6 += (t5 &gt;&gt; 26); t5 &amp;= 0x3FFFFFFUL;</span>
<span class="term-fg31">-    t7 += (t6 &gt;&gt; 26); t6 &amp;= 0x3FFFFFFUL;</span>
<span class="term-fg31">-    t8 += (t7 &gt;&gt; 26); t7 &amp;= 0x3FFFFFFUL;</span>
<span class="term-fg31">-    t9 += (t8 &gt;&gt; 26); t8 &amp;= 0x3FFFFFFUL;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* If t9 didn&#39;t carry to bit 22 already, then it should have after any final reduction *&#47;</span>
<span class="term-fg31">-    VERIFY_CHECK(t9 &gt;&gt; 22 == x);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Mask off the possible multiple of 2^256 from the final reduction *&#47;</span>
<span class="term-fg31">-    t9 &amp;= 0x03FFFFFUL;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    r-&gt;n[0] = t0; r-&gt;n[1] = t1; r-&gt;n[2] = t2; r-&gt;n[3] = t3; r-&gt;n[4] = t4;</span>
<span class="term-fg31">-    r-&gt;n[5] = t5; r-&gt;n[6] = t6; r-&gt;n[7] = t7; r-&gt;n[8] = t8; r-&gt;n[9] = t9;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-    r-&gt;magnitude = 1;</span>
<span class="term-fg31">-    r-&gt;normalized = 1;</span>
<span class="term-fg31">-    secp256k1_fe_verify(r);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_fe_normalize_weak(secp256k1_fe *r) {</span>
<span class="term-fg31">-    uint32_t t0 = r-&gt;n[0], t1 = r-&gt;n[1], t2 = r-&gt;n[2], t3 = r-&gt;n[3], t4 = r-&gt;n[4],</span>
<span class="term-fg31">-             t5 = r-&gt;n[5], t6 = r-&gt;n[6], t7 = r-&gt;n[7], t8 = r-&gt;n[8], t9 = r-&gt;n[9];</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Reduce t9 at the start so there will be at most a single carry from the first pass *&#47;</span>
<span class="term-fg31">-    uint32_t x = t9 &gt;&gt; 22; t9 &amp;= 0x03FFFFFUL;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* The first pass ensures the magnitude is 1, ... *&#47;</span>
<span class="term-fg31">-    t0 += x * 0x3D1UL; t1 += (x &lt;&lt; 6);</span>
<span class="term-fg31">-    t1 += (t0 &gt;&gt; 26); t0 &amp;= 0x3FFFFFFUL;</span>
<span class="term-fg31">-    t2 += (t1 &gt;&gt; 26); t1 &amp;= 0x3FFFFFFUL;</span>
<span class="term-fg31">-    t3 += (t2 &gt;&gt; 26); t2 &amp;= 0x3FFFFFFUL;</span>
<span class="term-fg31">-    t4 += (t3 &gt;&gt; 26); t3 &amp;= 0x3FFFFFFUL;</span>
<span class="term-fg31">-    t5 += (t4 &gt;&gt; 26); t4 &amp;= 0x3FFFFFFUL;</span>
<span class="term-fg31">-    t6 += (t5 &gt;&gt; 26); t5 &amp;= 0x3FFFFFFUL;</span>
<span class="term-fg31">-    t7 += (t6 &gt;&gt; 26); t6 &amp;= 0x3FFFFFFUL;</span>
<span class="term-fg31">-    t8 += (t7 &gt;&gt; 26); t7 &amp;= 0x3FFFFFFUL;</span>
<span class="term-fg31">-    t9 += (t8 &gt;&gt; 26); t8 &amp;= 0x3FFFFFFUL;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* ... except for a possible carry at bit 22 of t9 (i.e. bit 256 of the field element) *&#47;</span>
<span class="term-fg31">-    VERIFY_CHECK(t9 &gt;&gt; 23 == 0);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    r-&gt;n[0] = t0; r-&gt;n[1] = t1; r-&gt;n[2] = t2; r-&gt;n[3] = t3; r-&gt;n[4] = t4;</span>
<span class="term-fg31">-    r-&gt;n[5] = t5; r-&gt;n[6] = t6; r-&gt;n[7] = t7; r-&gt;n[8] = t8; r-&gt;n[9] = t9;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-    r-&gt;magnitude = 1;</span>
<span class="term-fg31">-    secp256k1_fe_verify(r);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_fe_normalize_var(secp256k1_fe *r) {</span>
<span class="term-fg31">-    uint32_t t0 = r-&gt;n[0], t1 = r-&gt;n[1], t2 = r-&gt;n[2], t3 = r-&gt;n[3], t4 = r-&gt;n[4],</span>
<span class="term-fg31">-             t5 = r-&gt;n[5], t6 = r-&gt;n[6], t7 = r-&gt;n[7], t8 = r-&gt;n[8], t9 = r-&gt;n[9];</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Reduce t9 at the start so there will be at most a single carry from the first pass *&#47;</span>
<span class="term-fg31">-    uint32_t m;</span>
<span class="term-fg31">-    uint32_t x = t9 &gt;&gt; 22; t9 &amp;= 0x03FFFFFUL;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* The first pass ensures the magnitude is 1, ... *&#47;</span>
<span class="term-fg31">-    t0 += x * 0x3D1UL; t1 += (x &lt;&lt; 6);</span>
<span class="term-fg31">-    t1 += (t0 &gt;&gt; 26); t0 &amp;= 0x3FFFFFFUL;</span>
<span class="term-fg31">-    t2 += (t1 &gt;&gt; 26); t1 &amp;= 0x3FFFFFFUL;</span>
<span class="term-fg31">-    t3 += (t2 &gt;&gt; 26); t2 &amp;= 0x3FFFFFFUL; m = t2;</span>
<span class="term-fg31">-    t4 += (t3 &gt;&gt; 26); t3 &amp;= 0x3FFFFFFUL; m &amp;= t3;</span>
<span class="term-fg31">-    t5 += (t4 &gt;&gt; 26); t4 &amp;= 0x3FFFFFFUL; m &amp;= t4;</span>
<span class="term-fg31">-    t6 += (t5 &gt;&gt; 26); t5 &amp;= 0x3FFFFFFUL; m &amp;= t5;</span>
<span class="term-fg31">-    t7 += (t6 &gt;&gt; 26); t6 &amp;= 0x3FFFFFFUL; m &amp;= t6;</span>
<span class="term-fg31">-    t8 += (t7 &gt;&gt; 26); t7 &amp;= 0x3FFFFFFUL; m &amp;= t7;</span>
<span class="term-fg31">-    t9 += (t8 &gt;&gt; 26); t8 &amp;= 0x3FFFFFFUL; m &amp;= t8;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* ... except for a possible carry at bit 22 of t9 (i.e. bit 256 of the field element) *&#47;</span>
<span class="term-fg31">-    VERIFY_CHECK(t9 &gt;&gt; 23 == 0);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* At most a single final reduction is needed; check if the value is &gt;= the field characteristic *&#47;</span>
<span class="term-fg31">-    x = (t9 &gt;&gt; 22) | ((t9 == 0x03FFFFFUL) &amp; (m == 0x3FFFFFFUL)</span>
<span class="term-fg31">-        &amp; ((t1 + 0x40UL + ((t0 + 0x3D1UL) &gt;&gt; 26)) &gt; 0x3FFFFFFUL));</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    if (x) {</span>
<span class="term-fg31">-        t0 += 0x3D1UL; t1 += (x &lt;&lt; 6);</span>
<span class="term-fg31">-        t1 += (t0 &gt;&gt; 26); t0 &amp;= 0x3FFFFFFUL;</span>
<span class="term-fg31">-        t2 += (t1 &gt;&gt; 26); t1 &amp;= 0x3FFFFFFUL;</span>
<span class="term-fg31">-        t3 += (t2 &gt;&gt; 26); t2 &amp;= 0x3FFFFFFUL;</span>
<span class="term-fg31">-        t4 += (t3 &gt;&gt; 26); t3 &amp;= 0x3FFFFFFUL;</span>
<span class="term-fg31">-        t5 += (t4 &gt;&gt; 26); t4 &amp;= 0x3FFFFFFUL;</span>
<span class="term-fg31">-        t6 += (t5 &gt;&gt; 26); t5 &amp;= 0x3FFFFFFUL;</span>
<span class="term-fg31">-        t7 += (t6 &gt;&gt; 26); t6 &amp;= 0x3FFFFFFUL;</span>
<span class="term-fg31">-        t8 += (t7 &gt;&gt; 26); t7 &amp;= 0x3FFFFFFUL;</span>
<span class="term-fg31">-        t9 += (t8 &gt;&gt; 26); t8 &amp;= 0x3FFFFFFUL;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        &#47;* If t9 didn&#39;t carry to bit 22 already, then it should have after any final reduction *&#47;</span>
<span class="term-fg31">-        VERIFY_CHECK(t9 &gt;&gt; 22 == x);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        &#47;* Mask off the possible multiple of 2^256 from the final reduction *&#47;</span>
<span class="term-fg31">-        t9 &amp;= 0x03FFFFFUL;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    r-&gt;n[0] = t0; r-&gt;n[1] = t1; r-&gt;n[2] = t2; r-&gt;n[3] = t3; r-&gt;n[4] = t4;</span>
<span class="term-fg31">-    r-&gt;n[5] = t5; r-&gt;n[6] = t6; r-&gt;n[7] = t7; r-&gt;n[8] = t8; r-&gt;n[9] = t9;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-    r-&gt;magnitude = 1;</span>
<span class="term-fg31">-    r-&gt;normalized = 1;</span>
<span class="term-fg31">-    secp256k1_fe_verify(r);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_fe_normalizes_to_zero(secp256k1_fe *r) {</span>
<span class="term-fg31">-    uint32_t t0 = r-&gt;n[0], t1 = r-&gt;n[1], t2 = r-&gt;n[2], t3 = r-&gt;n[3], t4 = r-&gt;n[4],</span>
<span class="term-fg31">-             t5 = r-&gt;n[5], t6 = r-&gt;n[6], t7 = r-&gt;n[7], t8 = r-&gt;n[8], t9 = r-&gt;n[9];</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* z0 tracks a possible raw value of 0, z1 tracks a possible raw value of P *&#47;</span>
<span class="term-fg31">-    uint32_t z0, z1;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Reduce t9 at the start so there will be at most a single carry from the first pass *&#47;</span>
<span class="term-fg31">-    uint32_t x = t9 &gt;&gt; 22; t9 &amp;= 0x03FFFFFUL;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* The first pass ensures the magnitude is 1, ... *&#47;</span>
<span class="term-fg31">-    t0 += x * 0x3D1UL; t1 += (x &lt;&lt; 6);</span>
<span class="term-fg31">-    t1 += (t0 &gt;&gt; 26); t0 &amp;= 0x3FFFFFFUL; z0  = t0; z1  = t0 ^ 0x3D0UL;</span>
<span class="term-fg31">-    t2 += (t1 &gt;&gt; 26); t1 &amp;= 0x3FFFFFFUL; z0 |= t1; z1 &amp;= t1 ^ 0x40UL;</span>
<span class="term-fg31">-    t3 += (t2 &gt;&gt; 26); t2 &amp;= 0x3FFFFFFUL; z0 |= t2; z1 &amp;= t2;</span>
<span class="term-fg31">-    t4 += (t3 &gt;&gt; 26); t3 &amp;= 0x3FFFFFFUL; z0 |= t3; z1 &amp;= t3;</span>
<span class="term-fg31">-    t5 += (t4 &gt;&gt; 26); t4 &amp;= 0x3FFFFFFUL; z0 |= t4; z1 &amp;= t4;</span>
<span class="term-fg31">-    t6 += (t5 &gt;&gt; 26); t5 &amp;= 0x3FFFFFFUL; z0 |= t5; z1 &amp;= t5;</span>
<span class="term-fg31">-    t7 += (t6 &gt;&gt; 26); t6 &amp;= 0x3FFFFFFUL; z0 |= t6; z1 &amp;= t6;</span>
<span class="term-fg31">-    t8 += (t7 &gt;&gt; 26); t7 &amp;= 0x3FFFFFFUL; z0 |= t7; z1 &amp;= t7;</span>
<span class="term-fg31">-    t9 += (t8 &gt;&gt; 26); t8 &amp;= 0x3FFFFFFUL; z0 |= t8; z1 &amp;= t8;</span>
<span class="term-fg31">-                                         z0 |= t9; z1 &amp;= t9 ^ 0x3C00000UL;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* ... except for a possible carry at bit 22 of t9 (i.e. bit 256 of the field element) *&#47;</span>
<span class="term-fg31">-    VERIFY_CHECK(t9 &gt;&gt; 23 == 0);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    return (z0 == 0) | (z1 == 0x3FFFFFFUL);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_fe_normalizes_to_zero_var(secp256k1_fe *r) {</span>
<span class="term-fg31">-    uint32_t t0, t1, t2, t3, t4, t5, t6, t7, t8, t9;</span>
<span class="term-fg31">-    uint32_t z0, z1;</span>
<span class="term-fg31">-    uint32_t x;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    t0 = r-&gt;n[0];</span>
<span class="term-fg31">-    t9 = r-&gt;n[9];</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Reduce t9 at the start so there will be at most a single carry from the first pass *&#47;</span>
<span class="term-fg31">-    x = t9 &gt;&gt; 22;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* The first pass ensures the magnitude is 1, ... *&#47;</span>
<span class="term-fg31">-    t0 += x * 0x3D1UL;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* z0 tracks a possible raw value of 0, z1 tracks a possible raw value of P *&#47;</span>
<span class="term-fg31">-    z0 = t0 &amp; 0x3FFFFFFUL;</span>
<span class="term-fg31">-    z1 = z0 ^ 0x3D0UL;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Fast return path should catch the majority of cases *&#47;</span>
<span class="term-fg31">-    if ((z0 != 0UL) &amp; (z1 != 0x3FFFFFFUL)) {</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    t1 = r-&gt;n[1];</span>
<span class="term-fg31">-    t2 = r-&gt;n[2];</span>
<span class="term-fg31">-    t3 = r-&gt;n[3];</span>
<span class="term-fg31">-    t4 = r-&gt;n[4];</span>
<span class="term-fg31">-    t5 = r-&gt;n[5];</span>
<span class="term-fg31">-    t6 = r-&gt;n[6];</span>
<span class="term-fg31">-    t7 = r-&gt;n[7];</span>
<span class="term-fg31">-    t8 = r-&gt;n[8];</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    t9 &amp;= 0x03FFFFFUL;</span>
<span class="term-fg31">-    t1 += (x &lt;&lt; 6);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    t1 += (t0 &gt;&gt; 26);</span>
<span class="term-fg31">-    t2 += (t1 &gt;&gt; 26); t1 &amp;= 0x3FFFFFFUL; z0 |= t1; z1 &amp;= t1 ^ 0x40UL;</span>
<span class="term-fg31">-    t3 += (t2 &gt;&gt; 26); t2 &amp;= 0x3FFFFFFUL; z0 |= t2; z1 &amp;= t2;</span>
<span class="term-fg31">-    t4 += (t3 &gt;&gt; 26); t3 &amp;= 0x3FFFFFFUL; z0 |= t3; z1 &amp;= t3;</span>
<span class="term-fg31">-    t5 += (t4 &gt;&gt; 26); t4 &amp;= 0x3FFFFFFUL; z0 |= t4; z1 &amp;= t4;</span>
<span class="term-fg31">-    t6 += (t5 &gt;&gt; 26); t5 &amp;= 0x3FFFFFFUL; z0 |= t5; z1 &amp;= t5;</span>
<span class="term-fg31">-    t7 += (t6 &gt;&gt; 26); t6 &amp;= 0x3FFFFFFUL; z0 |= t6; z1 &amp;= t6;</span>
<span class="term-fg31">-    t8 += (t7 &gt;&gt; 26); t7 &amp;= 0x3FFFFFFUL; z0 |= t7; z1 &amp;= t7;</span>
<span class="term-fg31">-    t9 += (t8 &gt;&gt; 26); t8 &amp;= 0x3FFFFFFUL; z0 |= t8; z1 &amp;= t8;</span>
<span class="term-fg31">-                                         z0 |= t9; z1 &amp;= t9 ^ 0x3C00000UL;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* ... except for a possible carry at bit 22 of t9 (i.e. bit 256 of the field element) *&#47;</span>
<span class="term-fg31">-    VERIFY_CHECK(t9 &gt;&gt; 23 == 0);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    return (z0 == 0) | (z1 == 0x3FFFFFFUL);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static void secp256k1_fe_set_int(secp256k1_fe *r, int a) {</span>
<span class="term-fg31">-    r-&gt;n[0] = a;</span>
<span class="term-fg31">-    r-&gt;n[1] = r-&gt;n[2] = r-&gt;n[3] = r-&gt;n[4] = r-&gt;n[5] = r-&gt;n[6] = r-&gt;n[7] = r-&gt;n[8] = r-&gt;n[9] = 0;</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-    r-&gt;magnitude = 1;</span>
<span class="term-fg31">-    r-&gt;normalized = 1;</span>
<span class="term-fg31">-    secp256k1_fe_verify(r);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static int secp256k1_fe_is_zero(const secp256k1_fe *a) {</span>
<span class="term-fg31">-    const uint32_t *t = a-&gt;n;</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-    VERIFY_CHECK(a-&gt;normalized);</span>
<span class="term-fg31">-    secp256k1_fe_verify(a);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-    return (t[0] | t[1] | t[2] | t[3] | t[4] | t[5] | t[6] | t[7] | t[8] | t[9]) == 0;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static int secp256k1_fe_is_odd(const secp256k1_fe *a) {</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-    VERIFY_CHECK(a-&gt;normalized);</span>
<span class="term-fg31">-    secp256k1_fe_verify(a);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-    return a-&gt;n[0] &amp; 1;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static void secp256k1_fe_clear(secp256k1_fe *a) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-    a-&gt;magnitude = 0;</span>
<span class="term-fg31">-    a-&gt;normalized = 1;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-    for (i=0; i&lt;10; i++) {</span>
<span class="term-fg31">-        a-&gt;n[i] = 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_fe_cmp_var(const secp256k1_fe *a, const secp256k1_fe *b) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-    VERIFY_CHECK(a-&gt;normalized);</span>
<span class="term-fg31">-    VERIFY_CHECK(b-&gt;normalized);</span>
<span class="term-fg31">-    secp256k1_fe_verify(a);</span>
<span class="term-fg31">-    secp256k1_fe_verify(b);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-    for (i = 9; i &gt;= 0; i--) {</span>
<span class="term-fg31">-        if (a-&gt;n[i] &gt; b-&gt;n[i]) {</span>
<span class="term-fg31">-            return 1;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        if (a-&gt;n[i] &lt; b-&gt;n[i]) {</span>
<span class="term-fg31">-            return -1;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    return 0;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_fe_set_b32(secp256k1_fe *r, const unsigned char *a) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    r-&gt;n[0] = r-&gt;n[1] = r-&gt;n[2] = r-&gt;n[3] = r-&gt;n[4] = 0;</span>
<span class="term-fg31">-    r-&gt;n[5] = r-&gt;n[6] = r-&gt;n[7] = r-&gt;n[8] = r-&gt;n[9] = 0;</span>
<span class="term-fg31">-    for (i=0; i&lt;32; i++) {</span>
<span class="term-fg31">-        int j;</span>
<span class="term-fg31">-        for (j=0; j&lt;4; j++) {</span>
<span class="term-fg31">-            int limb = (8*i+2*j)&#47;26;</span>
<span class="term-fg31">-            int shift = (8*i+2*j)%26;</span>
<span class="term-fg31">-            r-&gt;n[limb] |= (uint32_t)((a[31-i] &gt;&gt; (2*j)) &amp; 0x3) &lt;&lt; shift;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    if (r-&gt;n[9] == 0x3FFFFFUL &amp;&amp; (r-&gt;n[8] &amp; r-&gt;n[7] &amp; r-&gt;n[6] &amp; r-&gt;n[5] &amp; r-&gt;n[4] &amp; r-&gt;n[3] &amp; r-&gt;n[2]) == 0x3FFFFFFUL &amp;&amp; (r-&gt;n[1] + 0x40UL + ((r-&gt;n[0] + 0x3D1UL) &gt;&gt; 26)) &gt; 0x3FFFFFFUL) {</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-    r-&gt;magnitude = 1;</span>
<span class="term-fg31">-    r-&gt;normalized = 1;</span>
<span class="term-fg31">-    secp256k1_fe_verify(r);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-    return 1;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Convert a field element to a 32-byte big endian value. Requires the input to be normalized *&#47;</span>
<span class="term-fg31">-static void secp256k1_fe_get_b32(unsigned char *r, const secp256k1_fe *a) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-    VERIFY_CHECK(a-&gt;normalized);</span>
<span class="term-fg31">-    secp256k1_fe_verify(a);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-    for (i=0; i&lt;32; i++) {</span>
<span class="term-fg31">-        int j;</span>
<span class="term-fg31">-        int c = 0;</span>
<span class="term-fg31">-        for (j=0; j&lt;4; j++) {</span>
<span class="term-fg31">-            int limb = (8*i+2*j)&#47;26;</span>
<span class="term-fg31">-            int shift = (8*i+2*j)%26;</span>
<span class="term-fg31">-            c |= ((a-&gt;n[limb] &gt;&gt; shift) &amp; 0x3) &lt;&lt; (2 * j);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        r[31-i] = c;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static void secp256k1_fe_negate(secp256k1_fe *r, const secp256k1_fe *a, int m) {</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-    VERIFY_CHECK(a-&gt;magnitude &lt;= m);</span>
<span class="term-fg31">-    secp256k1_fe_verify(a);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-    r-&gt;n[0] = 0x3FFFC2FUL * 2 * (m + 1) - a-&gt;n[0];</span>
<span class="term-fg31">-    r-&gt;n[1] = 0x3FFFFBFUL * 2 * (m + 1) - a-&gt;n[1];</span>
<span class="term-fg31">-    r-&gt;n[2] = 0x3FFFFFFUL * 2 * (m + 1) - a-&gt;n[2];</span>
<span class="term-fg31">-    r-&gt;n[3] = 0x3FFFFFFUL * 2 * (m + 1) - a-&gt;n[3];</span>
<span class="term-fg31">-    r-&gt;n[4] = 0x3FFFFFFUL * 2 * (m + 1) - a-&gt;n[4];</span>
<span class="term-fg31">-    r-&gt;n[5] = 0x3FFFFFFUL * 2 * (m + 1) - a-&gt;n[5];</span>
<span class="term-fg31">-    r-&gt;n[6] = 0x3FFFFFFUL * 2 * (m + 1) - a-&gt;n[6];</span>
<span class="term-fg31">-    r-&gt;n[7] = 0x3FFFFFFUL * 2 * (m + 1) - a-&gt;n[7];</span>
<span class="term-fg31">-    r-&gt;n[8] = 0x3FFFFFFUL * 2 * (m + 1) - a-&gt;n[8];</span>
<span class="term-fg31">-    r-&gt;n[9] = 0x03FFFFFUL * 2 * (m + 1) - a-&gt;n[9];</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-    r-&gt;magnitude = m + 1;</span>
<span class="term-fg31">-    r-&gt;normalized = 0;</span>
<span class="term-fg31">-    secp256k1_fe_verify(r);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static void secp256k1_fe_mul_int(secp256k1_fe *r, int a) {</span>
<span class="term-fg31">-    r-&gt;n[0] *= a;</span>
<span class="term-fg31">-    r-&gt;n[1] *= a;</span>
<span class="term-fg31">-    r-&gt;n[2] *= a;</span>
<span class="term-fg31">-    r-&gt;n[3] *= a;</span>
<span class="term-fg31">-    r-&gt;n[4] *= a;</span>
<span class="term-fg31">-    r-&gt;n[5] *= a;</span>
<span class="term-fg31">-    r-&gt;n[6] *= a;</span>
<span class="term-fg31">-    r-&gt;n[7] *= a;</span>
<span class="term-fg31">-    r-&gt;n[8] *= a;</span>
<span class="term-fg31">-    r-&gt;n[9] *= a;</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-    r-&gt;magnitude *= a;</span>
<span class="term-fg31">-    r-&gt;normalized = 0;</span>
<span class="term-fg31">-    secp256k1_fe_verify(r);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static void secp256k1_fe_add(secp256k1_fe *r, const secp256k1_fe *a) {</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-    secp256k1_fe_verify(a);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-    r-&gt;n[0] += a-&gt;n[0];</span>
<span class="term-fg31">-    r-&gt;n[1] += a-&gt;n[1];</span>
<span class="term-fg31">-    r-&gt;n[2] += a-&gt;n[2];</span>
<span class="term-fg31">-    r-&gt;n[3] += a-&gt;n[3];</span>
<span class="term-fg31">-    r-&gt;n[4] += a-&gt;n[4];</span>
<span class="term-fg31">-    r-&gt;n[5] += a-&gt;n[5];</span>
<span class="term-fg31">-    r-&gt;n[6] += a-&gt;n[6];</span>
<span class="term-fg31">-    r-&gt;n[7] += a-&gt;n[7];</span>
<span class="term-fg31">-    r-&gt;n[8] += a-&gt;n[8];</span>
<span class="term-fg31">-    r-&gt;n[9] += a-&gt;n[9];</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-    r-&gt;magnitude += a-&gt;magnitude;</span>
<span class="term-fg31">-    r-&gt;normalized = 0;</span>
<span class="term-fg31">-    secp256k1_fe_verify(r);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#if defined(USE_EXTERNAL_ASM)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;* External assembler implementation *&#47;</span>
<span class="term-fg31">-void secp256k1_fe_mul_inner(uint32_t *r, const uint32_t *a, const uint32_t * SECP256K1_RESTRICT b);</span>
<span class="term-fg31">-void secp256k1_fe_sqr_inner(uint32_t *r, const uint32_t *a);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#else</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-#define VERIFY_BITS(x, n) VERIFY_CHECK(((x) &gt;&gt; (n)) == 0)</span>
<span class="term-fg31">-#else</span>
<span class="term-fg31">-#define VERIFY_BITS(x, n) do { } while(0)</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static void secp256k1_fe_mul_inner(uint32_t *r, const uint32_t *a, const uint32_t * SECP256K1_RESTRICT b) {</span>
<span class="term-fg31">-    uint64_t c, d;</span>
<span class="term-fg31">-    uint64_t u0, u1, u2, u3, u4, u5, u6, u7, u8;</span>
<span class="term-fg31">-    uint32_t t9, t1, t0, t2, t3, t4, t5, t6, t7;</span>
<span class="term-fg31">-    const uint32_t M = 0x3FFFFFFUL, R0 = 0x3D10UL, R1 = 0x400UL;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    VERIFY_BITS(a[0], 30);</span>
<span class="term-fg31">-    VERIFY_BITS(a[1], 30);</span>
<span class="term-fg31">-    VERIFY_BITS(a[2], 30);</span>
<span class="term-fg31">-    VERIFY_BITS(a[3], 30);</span>
<span class="term-fg31">-    VERIFY_BITS(a[4], 30);</span>
<span class="term-fg31">-    VERIFY_BITS(a[5], 30);</span>
<span class="term-fg31">-    VERIFY_BITS(a[6], 30);</span>
<span class="term-fg31">-    VERIFY_BITS(a[7], 30);</span>
<span class="term-fg31">-    VERIFY_BITS(a[8], 30);</span>
<span class="term-fg31">-    VERIFY_BITS(a[9], 26);</span>
<span class="term-fg31">-    VERIFY_BITS(b[0], 30);</span>
<span class="term-fg31">-    VERIFY_BITS(b[1], 30);</span>
<span class="term-fg31">-    VERIFY_BITS(b[2], 30);</span>
<span class="term-fg31">-    VERIFY_BITS(b[3], 30);</span>
<span class="term-fg31">-    VERIFY_BITS(b[4], 30);</span>
<span class="term-fg31">-    VERIFY_BITS(b[5], 30);</span>
<span class="term-fg31">-    VERIFY_BITS(b[6], 30);</span>
<span class="term-fg31">-    VERIFY_BITS(b[7], 30);</span>
<span class="term-fg31">-    VERIFY_BITS(b[8], 30);</span>
<span class="term-fg31">-    VERIFY_BITS(b[9], 26);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;** [... a b c] is a shorthand for ... + a&lt;&lt;52 + b&lt;&lt;26 + c&lt;&lt;0 mod n.</span>
<span class="term-fg31">-     *  px is a shorthand for sum(a[i]*b[x-i], i=0..x).</span>
<span class="term-fg31">-     *  Note that [x 0 0 0 0 0 0 0 0 0 0] = [x*R1 x*R0].</span>
<span class="term-fg31">-     *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    d  = (uint64_t)a[0] * b[9]</span>
<span class="term-fg31">-       + (uint64_t)a[1] * b[8]</span>
<span class="term-fg31">-       + (uint64_t)a[2] * b[7]</span>
<span class="term-fg31">-       + (uint64_t)a[3] * b[6]</span>
<span class="term-fg31">-       + (uint64_t)a[4] * b[5]</span>
<span class="term-fg31">-       + (uint64_t)a[5] * b[4]</span>
<span class="term-fg31">-       + (uint64_t)a[6] * b[3]</span>
<span class="term-fg31">-       + (uint64_t)a[7] * b[2]</span>
<span class="term-fg31">-       + (uint64_t)a[8] * b[1]</span>
<span class="term-fg31">-       + (uint64_t)a[9] * b[0];</span>
<span class="term-fg31">-    &#47;* VERIFY_BITS(d, 64); *&#47;</span>
<span class="term-fg31">-    &#47;* [d 0 0 0 0 0 0 0 0 0] = [p9 0 0 0 0 0 0 0 0 0] *&#47;</span>
<span class="term-fg31">-    t9 = d &amp; M; d &gt;&gt;= 26;</span>
<span class="term-fg31">-    VERIFY_BITS(t9, 26);</span>
<span class="term-fg31">-    VERIFY_BITS(d, 38);</span>
<span class="term-fg31">-    &#47;* [d t9 0 0 0 0 0 0 0 0 0] = [p9 0 0 0 0 0 0 0 0 0] *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    c  = (uint64_t)a[0] * b[0];</span>
<span class="term-fg31">-    VERIFY_BITS(c, 60);</span>
<span class="term-fg31">-    &#47;* [d t9 0 0 0 0 0 0 0 0 c] = [p9 0 0 0 0 0 0 0 0 p0] *&#47;</span>
<span class="term-fg31">-    d += (uint64_t)a[1] * b[9]</span>
<span class="term-fg31">-       + (uint64_t)a[2] * b[8]</span>
<span class="term-fg31">-       + (uint64_t)a[3] * b[7]</span>
<span class="term-fg31">-       + (uint64_t)a[4] * b[6]</span>
<span class="term-fg31">-       + (uint64_t)a[5] * b[5]</span>
<span class="term-fg31">-       + (uint64_t)a[6] * b[4]</span>
<span class="term-fg31">-       + (uint64_t)a[7] * b[3]</span>
<span class="term-fg31">-       + (uint64_t)a[8] * b[2]</span>
<span class="term-fg31">-       + (uint64_t)a[9] * b[1];</span>
<span class="term-fg31">-    VERIFY_BITS(d, 63);</span>
<span class="term-fg31">-    &#47;* [d t9 0 0 0 0 0 0 0 0 c] = [p10 p9 0 0 0 0 0 0 0 0 p0] *&#47;</span>
<span class="term-fg31">-    u0 = d &amp; M; d &gt;&gt;= 26; c += u0 * R0;</span>
<span class="term-fg31">-    VERIFY_BITS(u0, 26);</span>
<span class="term-fg31">-    VERIFY_BITS(d, 37);</span>
<span class="term-fg31">-    VERIFY_BITS(c, 61);</span>
<span class="term-fg31">-    &#47;* [d u0 t9 0 0 0 0 0 0 0 0 c-u0*R0] = [p10 p9 0 0 0 0 0 0 0 0 p0] *&#47;</span>
<span class="term-fg31">-    t0 = c &amp; M; c &gt;&gt;= 26; c += u0 * R1;</span>
<span class="term-fg31">-    VERIFY_BITS(t0, 26);</span>
<span class="term-fg31">-    VERIFY_BITS(c, 37);</span>
<span class="term-fg31">-    &#47;* [d u0 t9 0 0 0 0 0 0 0 c-u0*R1 t0-u0*R0] = [p10 p9 0 0 0 0 0 0 0 0 p0] *&#47;</span>
<span class="term-fg31">-    &#47;* [d 0 t9 0 0 0 0 0 0 0 c t0] = [p10 p9 0 0 0 0 0 0 0 0 p0] *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    c += (uint64_t)a[0] * b[1]</span>
<span class="term-fg31">-       + (uint64_t)a[1] * b[0];</span>
<span class="term-fg31">-    VERIFY_BITS(c, 62);</span>
<span class="term-fg31">-    &#47;* [d 0 t9 0 0 0 0 0 0 0 c t0] = [p10 p9 0 0 0 0 0 0 0 p1 p0] *&#47;</span>
<span class="term-fg31">-    d += (uint64_t)a[2] * b[9]</span>
<span class="term-fg31">-       + (uint64_t)a[3] * b[8]</span>
<span class="term-fg31">-       + (uint64_t)a[4] * b[7]</span>
<span class="term-fg31">-       + (uint64_t)a[5] * b[6]</span>
<span class="term-fg31">-       + (uint64_t)a[6] * b[5]</span>
<span class="term-fg31">-       + (uint64_t)a[7] * b[4]</span>
<span class="term-fg31">-       + (uint64_t)a[8] * b[3]</span>
<span class="term-fg31">-       + (uint64_t)a[9] * b[2];</span>
<span class="term-fg31">-    VERIFY_BITS(d, 63);</span>
<span class="term-fg31">-    &#47;* [d 0 t9 0 0 0 0 0 0 0 c t0] = [p11 p10 p9 0 0 0 0 0 0 0 p1 p0] *&#47;</span>
<span class="term-fg31">-    u1 = d &amp; M; d &gt;&gt;= 26; c += u1 * R0;</span>
<span class="term-fg31">-    VERIFY_BITS(u1, 26);</span>
<span class="term-fg31">-    VERIFY_BITS(d, 37);</span>
<span class="term-fg31">-    VERIFY_BITS(c, 63);</span>
<span class="term-fg31">-    &#47;* [d u1 0 t9 0 0 0 0 0 0 0 c-u1*R0 t0] = [p11 p10 p9 0 0 0 0 0 0 0 p1 p0] *&#47;</span>
<span class="term-fg31">-    t1 = c &amp; M; c &gt;&gt;= 26; c += u1 * R1;</span>
<span class="term-fg31">-    VERIFY_BITS(t1, 26);</span>
<span class="term-fg31">-    VERIFY_BITS(c, 38);</span>
<span class="term-fg31">-    &#47;* [d u1 0 t9 0 0 0 0 0 0 c-u1*R1 t1-u1*R0 t0] = [p11 p10 p9 0 0 0 0 0 0 0 p1 p0] *&#47;</span>
<span class="term-fg31">-    &#47;* [d 0 0 t9 0 0 0 0 0 0 c t1 t0] = [p11 p10 p9 0 0 0 0 0 0 0 p1 p0] *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    c += (uint64_t)a[0] * b[2]</span>
<span class="term-fg31">-       + (uint64_t)a[1] * b[1]</span>
<span class="term-fg31">-       + (uint64_t)a[2] * b[0];</span>
<span class="term-fg31">-    VERIFY_BITS(c, 62);</span>
<span class="term-fg31">-    &#47;* [d 0 0 t9 0 0 0 0 0 0 c t1 t0] = [p11 p10 p9 0 0 0 0 0 0 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    d += (uint64_t)a[3] * b[9]</span>
<span class="term-fg31">-       + (uint64_t)a[4] * b[8]</span>
<span class="term-fg31">-       + (uint64_t)a[5] * b[7]</span>
<span class="term-fg31">-       + (uint64_t)a[6] * b[6]</span>
<span class="term-fg31">-       + (uint64_t)a[7] * b[5]</span>
<span class="term-fg31">-       + (uint64_t)a[8] * b[4]</span>
<span class="term-fg31">-       + (uint64_t)a[9] * b[3];</span>
<span class="term-fg31">-    VERIFY_BITS(d, 63);</span>
<span class="term-fg31">-    &#47;* [d 0 0 t9 0 0 0 0 0 0 c t1 t0] = [p12 p11 p10 p9 0 0 0 0 0 0 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    u2 = d &amp; M; d &gt;&gt;= 26; c += u2 * R0;</span>
<span class="term-fg31">-    VERIFY_BITS(u2, 26);</span>
<span class="term-fg31">-    VERIFY_BITS(d, 37);</span>
<span class="term-fg31">-    VERIFY_BITS(c, 63);</span>
<span class="term-fg31">-    &#47;* [d u2 0 0 t9 0 0 0 0 0 0 c-u2*R0 t1 t0] = [p12 p11 p10 p9 0 0 0 0 0 0 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    t2 = c &amp; M; c &gt;&gt;= 26; c += u2 * R1;</span>
<span class="term-fg31">-    VERIFY_BITS(t2, 26);</span>
<span class="term-fg31">-    VERIFY_BITS(c, 38);</span>
<span class="term-fg31">-    &#47;* [d u2 0 0 t9 0 0 0 0 0 c-u2*R1 t2-u2*R0 t1 t0] = [p12 p11 p10 p9 0 0 0 0 0 0 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    &#47;* [d 0 0 0 t9 0 0 0 0 0 c t2 t1 t0] = [p12 p11 p10 p9 0 0 0 0 0 0 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    c += (uint64_t)a[0] * b[3]</span>
<span class="term-fg31">-       + (uint64_t)a[1] * b[2]</span>
<span class="term-fg31">-       + (uint64_t)a[2] * b[1]</span>
<span class="term-fg31">-       + (uint64_t)a[3] * b[0];</span>
<span class="term-fg31">-    VERIFY_BITS(c, 63);</span>
<span class="term-fg31">-    &#47;* [d 0 0 0 t9 0 0 0 0 0 c t2 t1 t0] = [p12 p11 p10 p9 0 0 0 0 0 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    d += (uint64_t)a[4] * b[9]</span>
<span class="term-fg31">-       + (uint64_t)a[5] * b[8]</span>
<span class="term-fg31">-       + (uint64_t)a[6] * b[7]</span>
<span class="term-fg31">-       + (uint64_t)a[7] * b[6]</span>
<span class="term-fg31">-       + (uint64_t)a[8] * b[5]</span>
<span class="term-fg31">-       + (uint64_t)a[9] * b[4];</span>
<span class="term-fg31">-    VERIFY_BITS(d, 63);</span>
<span class="term-fg31">-    &#47;* [d 0 0 0 t9 0 0 0 0 0 c t2 t1 t0] = [p13 p12 p11 p10 p9 0 0 0 0 0 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    u3 = d &amp; M; d &gt;&gt;= 26; c += u3 * R0;</span>
<span class="term-fg31">-    VERIFY_BITS(u3, 26);</span>
<span class="term-fg31">-    VERIFY_BITS(d, 37);</span>
<span class="term-fg31">-    &#47;* VERIFY_BITS(c, 64); *&#47;</span>
<span class="term-fg31">-    &#47;* [d u3 0 0 0 t9 0 0 0 0 0 c-u3*R0 t2 t1 t0] = [p13 p12 p11 p10 p9 0 0 0 0 0 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    t3 = c &amp; M; c &gt;&gt;= 26; c += u3 * R1;</span>
<span class="term-fg31">-    VERIFY_BITS(t3, 26);</span>
<span class="term-fg31">-    VERIFY_BITS(c, 39);</span>
<span class="term-fg31">-    &#47;* [d u3 0 0 0 t9 0 0 0 0 c-u3*R1 t3-u3*R0 t2 t1 t0] = [p13 p12 p11 p10 p9 0 0 0 0 0 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    &#47;* [d 0 0 0 0 t9 0 0 0 0 c t3 t2 t1 t0] = [p13 p12 p11 p10 p9 0 0 0 0 0 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    c += (uint64_t)a[0] * b[4]</span>
<span class="term-fg31">-       + (uint64_t)a[1] * b[3]</span>
<span class="term-fg31">-       + (uint64_t)a[2] * b[2]</span>
<span class="term-fg31">-       + (uint64_t)a[3] * b[1]</span>
<span class="term-fg31">-       + (uint64_t)a[4] * b[0];</span>
<span class="term-fg31">-    VERIFY_BITS(c, 63);</span>
<span class="term-fg31">-    &#47;* [d 0 0 0 0 t9 0 0 0 0 c t3 t2 t1 t0] = [p13 p12 p11 p10 p9 0 0 0 0 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    d += (uint64_t)a[5] * b[9]</span>
<span class="term-fg31">-       + (uint64_t)a[6] * b[8]</span>
<span class="term-fg31">-       + (uint64_t)a[7] * b[7]</span>
<span class="term-fg31">-       + (uint64_t)a[8] * b[6]</span>
<span class="term-fg31">-       + (uint64_t)a[9] * b[5];</span>
<span class="term-fg31">-    VERIFY_BITS(d, 62);</span>
<span class="term-fg31">-    &#47;* [d 0 0 0 0 t9 0 0 0 0 c t3 t2 t1 t0] = [p14 p13 p12 p11 p10 p9 0 0 0 0 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    u4 = d &amp; M; d &gt;&gt;= 26; c += u4 * R0;</span>
<span class="term-fg31">-    VERIFY_BITS(u4, 26);</span>
<span class="term-fg31">-    VERIFY_BITS(d, 36);</span>
<span class="term-fg31">-    &#47;* VERIFY_BITS(c, 64); *&#47;</span>
<span class="term-fg31">-    &#47;* [d u4 0 0 0 0 t9 0 0 0 0 c-u4*R0 t3 t2 t1 t0] = [p14 p13 p12 p11 p10 p9 0 0 0 0 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    t4 = c &amp; M; c &gt;&gt;= 26; c += u4 * R1;</span>
<span class="term-fg31">-    VERIFY_BITS(t4, 26);</span>
<span class="term-fg31">-    VERIFY_BITS(c, 39);</span>
<span class="term-fg31">-    &#47;* [d u4 0 0 0 0 t9 0 0 0 c-u4*R1 t4-u4*R0 t3 t2 t1 t0] = [p14 p13 p12 p11 p10 p9 0 0 0 0 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    &#47;* [d 0 0 0 0 0 t9 0 0 0 c t4 t3 t2 t1 t0] = [p14 p13 p12 p11 p10 p9 0 0 0 0 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    c += (uint64_t)a[0] * b[5]</span>
<span class="term-fg31">-       + (uint64_t)a[1] * b[4]</span>
<span class="term-fg31">-       + (uint64_t)a[2] * b[3]</span>
<span class="term-fg31">-       + (uint64_t)a[3] * b[2]</span>
<span class="term-fg31">-       + (uint64_t)a[4] * b[1]</span>
<span class="term-fg31">-       + (uint64_t)a[5] * b[0];</span>
<span class="term-fg31">-    VERIFY_BITS(c, 63);</span>
<span class="term-fg31">-    &#47;* [d 0 0 0 0 0 t9 0 0 0 c t4 t3 t2 t1 t0] = [p14 p13 p12 p11 p10 p9 0 0 0 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    d += (uint64_t)a[6] * b[9]</span>
<span class="term-fg31">-       + (uint64_t)a[7] * b[8]</span>
<span class="term-fg31">-       + (uint64_t)a[8] * b[7]</span>
<span class="term-fg31">-       + (uint64_t)a[9] * b[6];</span>
<span class="term-fg31">-    VERIFY_BITS(d, 62);</span>
<span class="term-fg31">-    &#47;* [d 0 0 0 0 0 t9 0 0 0 c t4 t3 t2 t1 t0] = [p15 p14 p13 p12 p11 p10 p9 0 0 0 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    u5 = d &amp; M; d &gt;&gt;= 26; c += u5 * R0;</span>
<span class="term-fg31">-    VERIFY_BITS(u5, 26);</span>
<span class="term-fg31">-    VERIFY_BITS(d, 36);</span>
<span class="term-fg31">-    &#47;* VERIFY_BITS(c, 64); *&#47;</span>
<span class="term-fg31">-    &#47;* [d u5 0 0 0 0 0 t9 0 0 0 c-u5*R0 t4 t3 t2 t1 t0] = [p15 p14 p13 p12 p11 p10 p9 0 0 0 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    t5 = c &amp; M; c &gt;&gt;= 26; c += u5 * R1;</span>
<span class="term-fg31">-    VERIFY_BITS(t5, 26);</span>
<span class="term-fg31">-    VERIFY_BITS(c, 39);</span>
<span class="term-fg31">-    &#47;* [d u5 0 0 0 0 0 t9 0 0 c-u5*R1 t5-u5*R0 t4 t3 t2 t1 t0] = [p15 p14 p13 p12 p11 p10 p9 0 0 0 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    &#47;* [d 0 0 0 0 0 0 t9 0 0 c t5 t4 t3 t2 t1 t0] = [p15 p14 p13 p12 p11 p10 p9 0 0 0 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    c += (uint64_t)a[0] * b[6]</span>
<span class="term-fg31">-       + (uint64_t)a[1] * b[5]</span>
<span class="term-fg31">-       + (uint64_t)a[2] * b[4]</span>
<span class="term-fg31">-       + (uint64_t)a[3] * b[3]</span>
<span class="term-fg31">-       + (uint64_t)a[4] * b[2]</span>
<span class="term-fg31">-       + (uint64_t)a[5] * b[1]</span>
<span class="term-fg31">-       + (uint64_t)a[6] * b[0];</span>
<span class="term-fg31">-    VERIFY_BITS(c, 63);</span>
<span class="term-fg31">-    &#47;* [d 0 0 0 0 0 0 t9 0 0 c t5 t4 t3 t2 t1 t0] = [p15 p14 p13 p12 p11 p10 p9 0 0 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    d += (uint64_t)a[7] * b[9]</span>
<span class="term-fg31">-       + (uint64_t)a[8] * b[8]</span>
<span class="term-fg31">-       + (uint64_t)a[9] * b[7];</span>
<span class="term-fg31">-    VERIFY_BITS(d, 61);</span>
<span class="term-fg31">-    &#47;* [d 0 0 0 0 0 0 t9 0 0 c t5 t4 t3 t2 t1 t0] = [p16 p15 p14 p13 p12 p11 p10 p9 0 0 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    u6 = d &amp; M; d &gt;&gt;= 26; c += u6 * R0;</span>
<span class="term-fg31">-    VERIFY_BITS(u6, 26);</span>
<span class="term-fg31">-    VERIFY_BITS(d, 35);</span>
<span class="term-fg31">-    &#47;* VERIFY_BITS(c, 64); *&#47;</span>
<span class="term-fg31">-    &#47;* [d u6 0 0 0 0 0 0 t9 0 0 c-u6*R0 t5 t4 t3 t2 t1 t0] = [p16 p15 p14 p13 p12 p11 p10 p9 0 0 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    t6 = c &amp; M; c &gt;&gt;= 26; c += u6 * R1;</span>
<span class="term-fg31">-    VERIFY_BITS(t6, 26);</span>
<span class="term-fg31">-    VERIFY_BITS(c, 39);</span>
<span class="term-fg31">-    &#47;* [d u6 0 0 0 0 0 0 t9 0 c-u6*R1 t6-u6*R0 t5 t4 t3 t2 t1 t0] = [p16 p15 p14 p13 p12 p11 p10 p9 0 0 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    &#47;* [d 0 0 0 0 0 0 0 t9 0 c t6 t5 t4 t3 t2 t1 t0] = [p16 p15 p14 p13 p12 p11 p10 p9 0 0 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    c += (uint64_t)a[0] * b[7]</span>
<span class="term-fg31">-       + (uint64_t)a[1] * b[6]</span>
<span class="term-fg31">-       + (uint64_t)a[2] * b[5]</span>
<span class="term-fg31">-       + (uint64_t)a[3] * b[4]</span>
<span class="term-fg31">-       + (uint64_t)a[4] * b[3]</span>
<span class="term-fg31">-       + (uint64_t)a[5] * b[2]</span>
<span class="term-fg31">-       + (uint64_t)a[6] * b[1]</span>
<span class="term-fg31">-       + (uint64_t)a[7] * b[0];</span>
<span class="term-fg31">-    &#47;* VERIFY_BITS(c, 64); *&#47;</span>
<span class="term-fg31">-    VERIFY_CHECK(c &lt;= 0x8000007C00000007ULL);</span>
<span class="term-fg31">-    &#47;* [d 0 0 0 0 0 0 0 t9 0 c t6 t5 t4 t3 t2 t1 t0] = [p16 p15 p14 p13 p12 p11 p10 p9 0 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    d += (uint64_t)a[8] * b[9]</span>
<span class="term-fg31">-       + (uint64_t)a[9] * b[8];</span>
<span class="term-fg31">-    VERIFY_BITS(d, 58);</span>
<span class="term-fg31">-    &#47;* [d 0 0 0 0 0 0 0 t9 0 c t6 t5 t4 t3 t2 t1 t0] = [p17 p16 p15 p14 p13 p12 p11 p10 p9 0 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    u7 = d &amp; M; d &gt;&gt;= 26; c += u7 * R0;</span>
<span class="term-fg31">-    VERIFY_BITS(u7, 26);</span>
<span class="term-fg31">-    VERIFY_BITS(d, 32);</span>
<span class="term-fg31">-    &#47;* VERIFY_BITS(c, 64); *&#47;</span>
<span class="term-fg31">-    VERIFY_CHECK(c &lt;= 0x800001703FFFC2F7ULL);</span>
<span class="term-fg31">-    &#47;* [d u7 0 0 0 0 0 0 0 t9 0 c-u7*R0 t6 t5 t4 t3 t2 t1 t0] = [p17 p16 p15 p14 p13 p12 p11 p10 p9 0 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    t7 = c &amp; M; c &gt;&gt;= 26; c += u7 * R1;</span>
<span class="term-fg31">-    VERIFY_BITS(t7, 26);</span>
<span class="term-fg31">-    VERIFY_BITS(c, 38);</span>
<span class="term-fg31">-    &#47;* [d u7 0 0 0 0 0 0 0 t9 c-u7*R1 t7-u7*R0 t6 t5 t4 t3 t2 t1 t0] = [p17 p16 p15 p14 p13 p12 p11 p10 p9 0 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    &#47;* [d 0 0 0 0 0 0 0 0 t9 c t7 t6 t5 t4 t3 t2 t1 t0] = [p17 p16 p15 p14 p13 p12 p11 p10 p9 0 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    c += (uint64_t)a[0] * b[8]</span>
<span class="term-fg31">-       + (uint64_t)a[1] * b[7]</span>
<span class="term-fg31">-       + (uint64_t)a[2] * b[6]</span>
<span class="term-fg31">-       + (uint64_t)a[3] * b[5]</span>
<span class="term-fg31">-       + (uint64_t)a[4] * b[4]</span>
<span class="term-fg31">-       + (uint64_t)a[5] * b[3]</span>
<span class="term-fg31">-       + (uint64_t)a[6] * b[2]</span>
<span class="term-fg31">-       + (uint64_t)a[7] * b[1]</span>
<span class="term-fg31">-       + (uint64_t)a[8] * b[0];</span>
<span class="term-fg31">-    &#47;* VERIFY_BITS(c, 64); *&#47;</span>
<span class="term-fg31">-    VERIFY_CHECK(c &lt;= 0x9000007B80000008ULL);</span>
<span class="term-fg31">-    &#47;* [d 0 0 0 0 0 0 0 0 t9 c t7 t6 t5 t4 t3 t2 t1 t0] = [p17 p16 p15 p14 p13 p12 p11 p10 p9 p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    d += (uint64_t)a[9] * b[9];</span>
<span class="term-fg31">-    VERIFY_BITS(d, 57);</span>
<span class="term-fg31">-    &#47;* [d 0 0 0 0 0 0 0 0 t9 c t7 t6 t5 t4 t3 t2 t1 t0] = [p18 p17 p16 p15 p14 p13 p12 p11 p10 p9 p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    u8 = d &amp; M; d &gt;&gt;= 26; c += u8 * R0;</span>
<span class="term-fg31">-    VERIFY_BITS(u8, 26);</span>
<span class="term-fg31">-    VERIFY_BITS(d, 31);</span>
<span class="term-fg31">-    &#47;* VERIFY_BITS(c, 64); *&#47;</span>
<span class="term-fg31">-    VERIFY_CHECK(c &lt;= 0x9000016FBFFFC2F8ULL);</span>
<span class="term-fg31">-    &#47;* [d u8 0 0 0 0 0 0 0 0 t9 c-u8*R0 t7 t6 t5 t4 t3 t2 t1 t0] = [p18 p17 p16 p15 p14 p13 p12 p11 p10 p9 p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    r[3] = t3;</span>
<span class="term-fg31">-    VERIFY_BITS(r[3], 26);</span>
<span class="term-fg31">-    &#47;* [d u8 0 0 0 0 0 0 0 0 t9 c-u8*R0 t7 t6 t5 t4 r3 t2 t1 t0] = [p18 p17 p16 p15 p14 p13 p12 p11 p10 p9 p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    r[4] = t4;</span>
<span class="term-fg31">-    VERIFY_BITS(r[4], 26);</span>
<span class="term-fg31">-    &#47;* [d u8 0 0 0 0 0 0 0 0 t9 c-u8*R0 t7 t6 t5 r4 r3 t2 t1 t0] = [p18 p17 p16 p15 p14 p13 p12 p11 p10 p9 p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    r[5] = t5;</span>
<span class="term-fg31">-    VERIFY_BITS(r[5], 26);</span>
<span class="term-fg31">-    &#47;* [d u8 0 0 0 0 0 0 0 0 t9 c-u8*R0 t7 t6 r5 r4 r3 t2 t1 t0] = [p18 p17 p16 p15 p14 p13 p12 p11 p10 p9 p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    r[6] = t6;</span>
<span class="term-fg31">-    VERIFY_BITS(r[6], 26);</span>
<span class="term-fg31">-    &#47;* [d u8 0 0 0 0 0 0 0 0 t9 c-u8*R0 t7 r6 r5 r4 r3 t2 t1 t0] = [p18 p17 p16 p15 p14 p13 p12 p11 p10 p9 p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    r[7] = t7;</span>
<span class="term-fg31">-    VERIFY_BITS(r[7], 26);</span>
<span class="term-fg31">-    &#47;* [d u8 0 0 0 0 0 0 0 0 t9 c-u8*R0 r7 r6 r5 r4 r3 t2 t1 t0] = [p18 p17 p16 p15 p14 p13 p12 p11 p10 p9 p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    r[8] = c &amp; M; c &gt;&gt;= 26; c += u8 * R1;</span>
<span class="term-fg31">-    VERIFY_BITS(r[8], 26);</span>
<span class="term-fg31">-    VERIFY_BITS(c, 39);</span>
<span class="term-fg31">-    &#47;* [d u8 0 0 0 0 0 0 0 0 t9+c-u8*R1 r8-u8*R0 r7 r6 r5 r4 r3 t2 t1 t0] = [p18 p17 p16 p15 p14 p13 p12 p11 p10 p9 p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    &#47;* [d 0 0 0 0 0 0 0 0 0 t9+c r8 r7 r6 r5 r4 r3 t2 t1 t0] = [p18 p17 p16 p15 p14 p13 p12 p11 p10 p9 p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    c   += d * R0 + t9;</span>
<span class="term-fg31">-    VERIFY_BITS(c, 45);</span>
<span class="term-fg31">-    &#47;* [d 0 0 0 0 0 0 0 0 0 c-d*R0 r8 r7 r6 r5 r4 r3 t2 t1 t0] = [p18 p17 p16 p15 p14 p13 p12 p11 p10 p9 p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    r[9] = c &amp; (M &gt;&gt; 4); c &gt;&gt;= 22; c += d * (R1 &lt;&lt; 4);</span>
<span class="term-fg31">-    VERIFY_BITS(r[9], 22);</span>
<span class="term-fg31">-    VERIFY_BITS(c, 46);</span>
<span class="term-fg31">-    &#47;* [d 0 0 0 0 0 0 0 0 r9+((c-d*R1&lt;&lt;4)&lt;&lt;22)-d*R0 r8 r7 r6 r5 r4 r3 t2 t1 t0] = [p18 p17 p16 p15 p14 p13 p12 p11 p10 p9 p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    &#47;* [d 0 0 0 0 0 0 0 -d*R1 r9+(c&lt;&lt;22)-d*R0 r8 r7 r6 r5 r4 r3 t2 t1 t0] = [p18 p17 p16 p15 p14 p13 p12 p11 p10 p9 p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    &#47;* [r9+(c&lt;&lt;22) r8 r7 r6 r5 r4 r3 t2 t1 t0] = [p18 p17 p16 p15 p14 p13 p12 p11 p10 p9 p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    d    = c * (R0 &gt;&gt; 4) + t0;</span>
<span class="term-fg31">-    VERIFY_BITS(d, 56);</span>
<span class="term-fg31">-    &#47;* [r9+(c&lt;&lt;22) r8 r7 r6 r5 r4 r3 t2 t1 d-c*R0&gt;&gt;4] = [p18 p17 p16 p15 p14 p13 p12 p11 p10 p9 p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    r[0] = d &amp; M; d &gt;&gt;= 26;</span>
<span class="term-fg31">-    VERIFY_BITS(r[0], 26);</span>
<span class="term-fg31">-    VERIFY_BITS(d, 30);</span>
<span class="term-fg31">-    &#47;* [r9+(c&lt;&lt;22) r8 r7 r6 r5 r4 r3 t2 t1+d r0-c*R0&gt;&gt;4] = [p18 p17 p16 p15 p14 p13 p12 p11 p10 p9 p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    d   += c * (R1 &gt;&gt; 4) + t1;</span>
<span class="term-fg31">-    VERIFY_BITS(d, 53);</span>
<span class="term-fg31">-    VERIFY_CHECK(d &lt;= 0x10000003FFFFBFULL);</span>
<span class="term-fg31">-    &#47;* [r9+(c&lt;&lt;22) r8 r7 r6 r5 r4 r3 t2 d-c*R1&gt;&gt;4 r0-c*R0&gt;&gt;4] = [p18 p17 p16 p15 p14 p13 p12 p11 p10 p9 p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    &#47;* [r9 r8 r7 r6 r5 r4 r3 t2 d r0] = [p18 p17 p16 p15 p14 p13 p12 p11 p10 p9 p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    r[1] = d &amp; M; d &gt;&gt;= 26;</span>
<span class="term-fg31">-    VERIFY_BITS(r[1], 26);</span>
<span class="term-fg31">-    VERIFY_BITS(d, 27);</span>
<span class="term-fg31">-    VERIFY_CHECK(d &lt;= 0x4000000ULL);</span>
<span class="term-fg31">-    &#47;* [r9 r8 r7 r6 r5 r4 r3 t2+d r1 r0] = [p18 p17 p16 p15 p14 p13 p12 p11 p10 p9 p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    d   += t2;</span>
<span class="term-fg31">-    VERIFY_BITS(d, 27);</span>
<span class="term-fg31">-    &#47;* [r9 r8 r7 r6 r5 r4 r3 d r1 r0] = [p18 p17 p16 p15 p14 p13 p12 p11 p10 p9 p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    r[2] = d;</span>
<span class="term-fg31">-    VERIFY_BITS(r[2], 27);</span>
<span class="term-fg31">-    &#47;* [r9 r8 r7 r6 r5 r4 r3 r2 r1 r0] = [p18 p17 p16 p15 p14 p13 p12 p11 p10 p9 p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static void secp256k1_fe_sqr_inner(uint32_t *r, const uint32_t *a) {</span>
<span class="term-fg31">-    uint64_t c, d;</span>
<span class="term-fg31">-    uint64_t u0, u1, u2, u3, u4, u5, u6, u7, u8;</span>
<span class="term-fg31">-    uint32_t t9, t0, t1, t2, t3, t4, t5, t6, t7;</span>
<span class="term-fg31">-    const uint32_t M = 0x3FFFFFFUL, R0 = 0x3D10UL, R1 = 0x400UL;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    VERIFY_BITS(a[0], 30);</span>
<span class="term-fg31">-    VERIFY_BITS(a[1], 30);</span>
<span class="term-fg31">-    VERIFY_BITS(a[2], 30);</span>
<span class="term-fg31">-    VERIFY_BITS(a[3], 30);</span>
<span class="term-fg31">-    VERIFY_BITS(a[4], 30);</span>
<span class="term-fg31">-    VERIFY_BITS(a[5], 30);</span>
<span class="term-fg31">-    VERIFY_BITS(a[6], 30);</span>
<span class="term-fg31">-    VERIFY_BITS(a[7], 30);</span>
<span class="term-fg31">-    VERIFY_BITS(a[8], 30);</span>
<span class="term-fg31">-    VERIFY_BITS(a[9], 26);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;** [... a b c] is a shorthand for ... + a&lt;&lt;52 + b&lt;&lt;26 + c&lt;&lt;0 mod n.</span>
<span class="term-fg31">-     *  px is a shorthand for sum(a[i]*a[x-i], i=0..x).</span>
<span class="term-fg31">-     *  Note that [x 0 0 0 0 0 0 0 0 0 0] = [x*R1 x*R0].</span>
<span class="term-fg31">-     *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    d  = (uint64_t)(a[0]*2) * a[9]</span>
<span class="term-fg31">-       + (uint64_t)(a[1]*2) * a[8]</span>
<span class="term-fg31">-       + (uint64_t)(a[2]*2) * a[7]</span>
<span class="term-fg31">-       + (uint64_t)(a[3]*2) * a[6]</span>
<span class="term-fg31">-       + (uint64_t)(a[4]*2) * a[5];</span>
<span class="term-fg31">-    &#47;* VERIFY_BITS(d, 64); *&#47;</span>
<span class="term-fg31">-    &#47;* [d 0 0 0 0 0 0 0 0 0] = [p9 0 0 0 0 0 0 0 0 0] *&#47;</span>
<span class="term-fg31">-    t9 = d &amp; M; d &gt;&gt;= 26;</span>
<span class="term-fg31">-    VERIFY_BITS(t9, 26);</span>
<span class="term-fg31">-    VERIFY_BITS(d, 38);</span>
<span class="term-fg31">-    &#47;* [d t9 0 0 0 0 0 0 0 0 0] = [p9 0 0 0 0 0 0 0 0 0] *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    c  = (uint64_t)a[0] * a[0];</span>
<span class="term-fg31">-    VERIFY_BITS(c, 60);</span>
<span class="term-fg31">-    &#47;* [d t9 0 0 0 0 0 0 0 0 c] = [p9 0 0 0 0 0 0 0 0 p0] *&#47;</span>
<span class="term-fg31">-    d += (uint64_t)(a[1]*2) * a[9]</span>
<span class="term-fg31">-       + (uint64_t)(a[2]*2) * a[8]</span>
<span class="term-fg31">-       + (uint64_t)(a[3]*2) * a[7]</span>
<span class="term-fg31">-       + (uint64_t)(a[4]*2) * a[6]</span>
<span class="term-fg31">-       + (uint64_t)a[5] * a[5];</span>
<span class="term-fg31">-    VERIFY_BITS(d, 63);</span>
<span class="term-fg31">-    &#47;* [d t9 0 0 0 0 0 0 0 0 c] = [p10 p9 0 0 0 0 0 0 0 0 p0] *&#47;</span>
<span class="term-fg31">-    u0 = d &amp; M; d &gt;&gt;= 26; c += u0 * R0;</span>
<span class="term-fg31">-    VERIFY_BITS(u0, 26);</span>
<span class="term-fg31">-    VERIFY_BITS(d, 37);</span>
<span class="term-fg31">-    VERIFY_BITS(c, 61);</span>
<span class="term-fg31">-    &#47;* [d u0 t9 0 0 0 0 0 0 0 0 c-u0*R0] = [p10 p9 0 0 0 0 0 0 0 0 p0] *&#47;</span>
<span class="term-fg31">-    t0 = c &amp; M; c &gt;&gt;= 26; c += u0 * R1;</span>
<span class="term-fg31">-    VERIFY_BITS(t0, 26);</span>
<span class="term-fg31">-    VERIFY_BITS(c, 37);</span>
<span class="term-fg31">-    &#47;* [d u0 t9 0 0 0 0 0 0 0 c-u0*R1 t0-u0*R0] = [p10 p9 0 0 0 0 0 0 0 0 p0] *&#47;</span>
<span class="term-fg31">-    &#47;* [d 0 t9 0 0 0 0 0 0 0 c t0] = [p10 p9 0 0 0 0 0 0 0 0 p0] *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    c += (uint64_t)(a[0]*2) * a[1];</span>
<span class="term-fg31">-    VERIFY_BITS(c, 62);</span>
<span class="term-fg31">-    &#47;* [d 0 t9 0 0 0 0 0 0 0 c t0] = [p10 p9 0 0 0 0 0 0 0 p1 p0] *&#47;</span>
<span class="term-fg31">-    d += (uint64_t)(a[2]*2) * a[9]</span>
<span class="term-fg31">-       + (uint64_t)(a[3]*2) * a[8]</span>
<span class="term-fg31">-       + (uint64_t)(a[4]*2) * a[7]</span>
<span class="term-fg31">-       + (uint64_t)(a[5]*2) * a[6];</span>
<span class="term-fg31">-    VERIFY_BITS(d, 63);</span>
<span class="term-fg31">-    &#47;* [d 0 t9 0 0 0 0 0 0 0 c t0] = [p11 p10 p9 0 0 0 0 0 0 0 p1 p0] *&#47;</span>
<span class="term-fg31">-    u1 = d &amp; M; d &gt;&gt;= 26; c += u1 * R0;</span>
<span class="term-fg31">-    VERIFY_BITS(u1, 26);</span>
<span class="term-fg31">-    VERIFY_BITS(d, 37);</span>
<span class="term-fg31">-    VERIFY_BITS(c, 63);</span>
<span class="term-fg31">-    &#47;* [d u1 0 t9 0 0 0 0 0 0 0 c-u1*R0 t0] = [p11 p10 p9 0 0 0 0 0 0 0 p1 p0] *&#47;</span>
<span class="term-fg31">-    t1 = c &amp; M; c &gt;&gt;= 26; c += u1 * R1;</span>
<span class="term-fg31">-    VERIFY_BITS(t1, 26);</span>
<span class="term-fg31">-    VERIFY_BITS(c, 38);</span>
<span class="term-fg31">-    &#47;* [d u1 0 t9 0 0 0 0 0 0 c-u1*R1 t1-u1*R0 t0] = [p11 p10 p9 0 0 0 0 0 0 0 p1 p0] *&#47;</span>
<span class="term-fg31">-    &#47;* [d 0 0 t9 0 0 0 0 0 0 c t1 t0] = [p11 p10 p9 0 0 0 0 0 0 0 p1 p0] *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    c += (uint64_t)(a[0]*2) * a[2]</span>
<span class="term-fg31">-       + (uint64_t)a[1] * a[1];</span>
<span class="term-fg31">-    VERIFY_BITS(c, 62);</span>
<span class="term-fg31">-    &#47;* [d 0 0 t9 0 0 0 0 0 0 c t1 t0] = [p11 p10 p9 0 0 0 0 0 0 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    d += (uint64_t)(a[3]*2) * a[9]</span>
<span class="term-fg31">-       + (uint64_t)(a[4]*2) * a[8]</span>
<span class="term-fg31">-       + (uint64_t)(a[5]*2) * a[7]</span>
<span class="term-fg31">-       + (uint64_t)a[6] * a[6];</span>
<span class="term-fg31">-    VERIFY_BITS(d, 63);</span>
<span class="term-fg31">-    &#47;* [d 0 0 t9 0 0 0 0 0 0 c t1 t0] = [p12 p11 p10 p9 0 0 0 0 0 0 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    u2 = d &amp; M; d &gt;&gt;= 26; c += u2 * R0;</span>
<span class="term-fg31">-    VERIFY_BITS(u2, 26);</span>
<span class="term-fg31">-    VERIFY_BITS(d, 37);</span>
<span class="term-fg31">-    VERIFY_BITS(c, 63);</span>
<span class="term-fg31">-    &#47;* [d u2 0 0 t9 0 0 0 0 0 0 c-u2*R0 t1 t0] = [p12 p11 p10 p9 0 0 0 0 0 0 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    t2 = c &amp; M; c &gt;&gt;= 26; c += u2 * R1;</span>
<span class="term-fg31">-    VERIFY_BITS(t2, 26);</span>
<span class="term-fg31">-    VERIFY_BITS(c, 38);</span>
<span class="term-fg31">-    &#47;* [d u2 0 0 t9 0 0 0 0 0 c-u2*R1 t2-u2*R0 t1 t0] = [p12 p11 p10 p9 0 0 0 0 0 0 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    &#47;* [d 0 0 0 t9 0 0 0 0 0 c t2 t1 t0] = [p12 p11 p10 p9 0 0 0 0 0 0 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    c += (uint64_t)(a[0]*2) * a[3]</span>
<span class="term-fg31">-       + (uint64_t)(a[1]*2) * a[2];</span>
<span class="term-fg31">-    VERIFY_BITS(c, 63);</span>
<span class="term-fg31">-    &#47;* [d 0 0 0 t9 0 0 0 0 0 c t2 t1 t0] = [p12 p11 p10 p9 0 0 0 0 0 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    d += (uint64_t)(a[4]*2) * a[9]</span>
<span class="term-fg31">-       + (uint64_t)(a[5]*2) * a[8]</span>
<span class="term-fg31">-       + (uint64_t)(a[6]*2) * a[7];</span>
<span class="term-fg31">-    VERIFY_BITS(d, 63);</span>
<span class="term-fg31">-    &#47;* [d 0 0 0 t9 0 0 0 0 0 c t2 t1 t0] = [p13 p12 p11 p10 p9 0 0 0 0 0 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    u3 = d &amp; M; d &gt;&gt;= 26; c += u3 * R0;</span>
<span class="term-fg31">-    VERIFY_BITS(u3, 26);</span>
<span class="term-fg31">-    VERIFY_BITS(d, 37);</span>
<span class="term-fg31">-    &#47;* VERIFY_BITS(c, 64); *&#47;</span>
<span class="term-fg31">-    &#47;* [d u3 0 0 0 t9 0 0 0 0 0 c-u3*R0 t2 t1 t0] = [p13 p12 p11 p10 p9 0 0 0 0 0 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    t3 = c &amp; M; c &gt;&gt;= 26; c += u3 * R1;</span>
<span class="term-fg31">-    VERIFY_BITS(t3, 26);</span>
<span class="term-fg31">-    VERIFY_BITS(c, 39);</span>
<span class="term-fg31">-    &#47;* [d u3 0 0 0 t9 0 0 0 0 c-u3*R1 t3-u3*R0 t2 t1 t0] = [p13 p12 p11 p10 p9 0 0 0 0 0 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    &#47;* [d 0 0 0 0 t9 0 0 0 0 c t3 t2 t1 t0] = [p13 p12 p11 p10 p9 0 0 0 0 0 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    c += (uint64_t)(a[0]*2) * a[4]</span>
<span class="term-fg31">-       + (uint64_t)(a[1]*2) * a[3]</span>
<span class="term-fg31">-       + (uint64_t)a[2] * a[2];</span>
<span class="term-fg31">-    VERIFY_BITS(c, 63);</span>
<span class="term-fg31">-    &#47;* [d 0 0 0 0 t9 0 0 0 0 c t3 t2 t1 t0] = [p13 p12 p11 p10 p9 0 0 0 0 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    d += (uint64_t)(a[5]*2) * a[9]</span>
<span class="term-fg31">-       + (uint64_t)(a[6]*2) * a[8]</span>
<span class="term-fg31">-       + (uint64_t)a[7] * a[7];</span>
<span class="term-fg31">-    VERIFY_BITS(d, 62);</span>
<span class="term-fg31">-    &#47;* [d 0 0 0 0 t9 0 0 0 0 c t3 t2 t1 t0] = [p14 p13 p12 p11 p10 p9 0 0 0 0 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    u4 = d &amp; M; d &gt;&gt;= 26; c += u4 * R0;</span>
<span class="term-fg31">-    VERIFY_BITS(u4, 26);</span>
<span class="term-fg31">-    VERIFY_BITS(d, 36);</span>
<span class="term-fg31">-    &#47;* VERIFY_BITS(c, 64); *&#47;</span>
<span class="term-fg31">-    &#47;* [d u4 0 0 0 0 t9 0 0 0 0 c-u4*R0 t3 t2 t1 t0] = [p14 p13 p12 p11 p10 p9 0 0 0 0 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    t4 = c &amp; M; c &gt;&gt;= 26; c += u4 * R1;</span>
<span class="term-fg31">-    VERIFY_BITS(t4, 26);</span>
<span class="term-fg31">-    VERIFY_BITS(c, 39);</span>
<span class="term-fg31">-    &#47;* [d u4 0 0 0 0 t9 0 0 0 c-u4*R1 t4-u4*R0 t3 t2 t1 t0] = [p14 p13 p12 p11 p10 p9 0 0 0 0 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    &#47;* [d 0 0 0 0 0 t9 0 0 0 c t4 t3 t2 t1 t0] = [p14 p13 p12 p11 p10 p9 0 0 0 0 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    c += (uint64_t)(a[0]*2) * a[5]</span>
<span class="term-fg31">-       + (uint64_t)(a[1]*2) * a[4]</span>
<span class="term-fg31">-       + (uint64_t)(a[2]*2) * a[3];</span>
<span class="term-fg31">-    VERIFY_BITS(c, 63);</span>
<span class="term-fg31">-    &#47;* [d 0 0 0 0 0 t9 0 0 0 c t4 t3 t2 t1 t0] = [p14 p13 p12 p11 p10 p9 0 0 0 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    d += (uint64_t)(a[6]*2) * a[9]</span>
<span class="term-fg31">-       + (uint64_t)(a[7]*2) * a[8];</span>
<span class="term-fg31">-    VERIFY_BITS(d, 62);</span>
<span class="term-fg31">-    &#47;* [d 0 0 0 0 0 t9 0 0 0 c t4 t3 t2 t1 t0] = [p15 p14 p13 p12 p11 p10 p9 0 0 0 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    u5 = d &amp; M; d &gt;&gt;= 26; c += u5 * R0;</span>
<span class="term-fg31">-    VERIFY_BITS(u5, 26);</span>
<span class="term-fg31">-    VERIFY_BITS(d, 36);</span>
<span class="term-fg31">-    &#47;* VERIFY_BITS(c, 64); *&#47;</span>
<span class="term-fg31">-    &#47;* [d u5 0 0 0 0 0 t9 0 0 0 c-u5*R0 t4 t3 t2 t1 t0] = [p15 p14 p13 p12 p11 p10 p9 0 0 0 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    t5 = c &amp; M; c &gt;&gt;= 26; c += u5 * R1;</span>
<span class="term-fg31">-    VERIFY_BITS(t5, 26);</span>
<span class="term-fg31">-    VERIFY_BITS(c, 39);</span>
<span class="term-fg31">-    &#47;* [d u5 0 0 0 0 0 t9 0 0 c-u5*R1 t5-u5*R0 t4 t3 t2 t1 t0] = [p15 p14 p13 p12 p11 p10 p9 0 0 0 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    &#47;* [d 0 0 0 0 0 0 t9 0 0 c t5 t4 t3 t2 t1 t0] = [p15 p14 p13 p12 p11 p10 p9 0 0 0 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    c += (uint64_t)(a[0]*2) * a[6]</span>
<span class="term-fg31">-       + (uint64_t)(a[1]*2) * a[5]</span>
<span class="term-fg31">-       + (uint64_t)(a[2]*2) * a[4]</span>
<span class="term-fg31">-       + (uint64_t)a[3] * a[3];</span>
<span class="term-fg31">-    VERIFY_BITS(c, 63);</span>
<span class="term-fg31">-    &#47;* [d 0 0 0 0 0 0 t9 0 0 c t5 t4 t3 t2 t1 t0] = [p15 p14 p13 p12 p11 p10 p9 0 0 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    d += (uint64_t)(a[7]*2) * a[9]</span>
<span class="term-fg31">-       + (uint64_t)a[8] * a[8];</span>
<span class="term-fg31">-    VERIFY_BITS(d, 61);</span>
<span class="term-fg31">-    &#47;* [d 0 0 0 0 0 0 t9 0 0 c t5 t4 t3 t2 t1 t0] = [p16 p15 p14 p13 p12 p11 p10 p9 0 0 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    u6 = d &amp; M; d &gt;&gt;= 26; c += u6 * R0;</span>
<span class="term-fg31">-    VERIFY_BITS(u6, 26);</span>
<span class="term-fg31">-    VERIFY_BITS(d, 35);</span>
<span class="term-fg31">-    &#47;* VERIFY_BITS(c, 64); *&#47;</span>
<span class="term-fg31">-    &#47;* [d u6 0 0 0 0 0 0 t9 0 0 c-u6*R0 t5 t4 t3 t2 t1 t0] = [p16 p15 p14 p13 p12 p11 p10 p9 0 0 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    t6 = c &amp; M; c &gt;&gt;= 26; c += u6 * R1;</span>
<span class="term-fg31">-    VERIFY_BITS(t6, 26);</span>
<span class="term-fg31">-    VERIFY_BITS(c, 39);</span>
<span class="term-fg31">-    &#47;* [d u6 0 0 0 0 0 0 t9 0 c-u6*R1 t6-u6*R0 t5 t4 t3 t2 t1 t0] = [p16 p15 p14 p13 p12 p11 p10 p9 0 0 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    &#47;* [d 0 0 0 0 0 0 0 t9 0 c t6 t5 t4 t3 t2 t1 t0] = [p16 p15 p14 p13 p12 p11 p10 p9 0 0 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    c += (uint64_t)(a[0]*2) * a[7]</span>
<span class="term-fg31">-       + (uint64_t)(a[1]*2) * a[6]</span>
<span class="term-fg31">-       + (uint64_t)(a[2]*2) * a[5]</span>
<span class="term-fg31">-       + (uint64_t)(a[3]*2) * a[4];</span>
<span class="term-fg31">-    &#47;* VERIFY_BITS(c, 64); *&#47;</span>
<span class="term-fg31">-    VERIFY_CHECK(c &lt;= 0x8000007C00000007ULL);</span>
<span class="term-fg31">-    &#47;* [d 0 0 0 0 0 0 0 t9 0 c t6 t5 t4 t3 t2 t1 t0] = [p16 p15 p14 p13 p12 p11 p10 p9 0 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    d += (uint64_t)(a[8]*2) * a[9];</span>
<span class="term-fg31">-    VERIFY_BITS(d, 58);</span>
<span class="term-fg31">-    &#47;* [d 0 0 0 0 0 0 0 t9 0 c t6 t5 t4 t3 t2 t1 t0] = [p17 p16 p15 p14 p13 p12 p11 p10 p9 0 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    u7 = d &amp; M; d &gt;&gt;= 26; c += u7 * R0;</span>
<span class="term-fg31">-    VERIFY_BITS(u7, 26);</span>
<span class="term-fg31">-    VERIFY_BITS(d, 32);</span>
<span class="term-fg31">-    &#47;* VERIFY_BITS(c, 64); *&#47;</span>
<span class="term-fg31">-    VERIFY_CHECK(c &lt;= 0x800001703FFFC2F7ULL);</span>
<span class="term-fg31">-    &#47;* [d u7 0 0 0 0 0 0 0 t9 0 c-u7*R0 t6 t5 t4 t3 t2 t1 t0] = [p17 p16 p15 p14 p13 p12 p11 p10 p9 0 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    t7 = c &amp; M; c &gt;&gt;= 26; c += u7 * R1;</span>
<span class="term-fg31">-    VERIFY_BITS(t7, 26);</span>
<span class="term-fg31">-    VERIFY_BITS(c, 38);</span>
<span class="term-fg31">-    &#47;* [d u7 0 0 0 0 0 0 0 t9 c-u7*R1 t7-u7*R0 t6 t5 t4 t3 t2 t1 t0] = [p17 p16 p15 p14 p13 p12 p11 p10 p9 0 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    &#47;* [d 0 0 0 0 0 0 0 0 t9 c t7 t6 t5 t4 t3 t2 t1 t0] = [p17 p16 p15 p14 p13 p12 p11 p10 p9 0 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    c += (uint64_t)(a[0]*2) * a[8]</span>
<span class="term-fg31">-       + (uint64_t)(a[1]*2) * a[7]</span>
<span class="term-fg31">-       + (uint64_t)(a[2]*2) * a[6]</span>
<span class="term-fg31">-       + (uint64_t)(a[3]*2) * a[5]</span>
<span class="term-fg31">-       + (uint64_t)a[4] * a[4];</span>
<span class="term-fg31">-    &#47;* VERIFY_BITS(c, 64); *&#47;</span>
<span class="term-fg31">-    VERIFY_CHECK(c &lt;= 0x9000007B80000008ULL);</span>
<span class="term-fg31">-    &#47;* [d 0 0 0 0 0 0 0 0 t9 c t7 t6 t5 t4 t3 t2 t1 t0] = [p17 p16 p15 p14 p13 p12 p11 p10 p9 p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    d += (uint64_t)a[9] * a[9];</span>
<span class="term-fg31">-    VERIFY_BITS(d, 57);</span>
<span class="term-fg31">-    &#47;* [d 0 0 0 0 0 0 0 0 t9 c t7 t6 t5 t4 t3 t2 t1 t0] = [p18 p17 p16 p15 p14 p13 p12 p11 p10 p9 p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    u8 = d &amp; M; d &gt;&gt;= 26; c += u8 * R0;</span>
<span class="term-fg31">-    VERIFY_BITS(u8, 26);</span>
<span class="term-fg31">-    VERIFY_BITS(d, 31);</span>
<span class="term-fg31">-    &#47;* VERIFY_BITS(c, 64); *&#47;</span>
<span class="term-fg31">-    VERIFY_CHECK(c &lt;= 0x9000016FBFFFC2F8ULL);</span>
<span class="term-fg31">-    &#47;* [d u8 0 0 0 0 0 0 0 0 t9 c-u8*R0 t7 t6 t5 t4 t3 t2 t1 t0] = [p18 p17 p16 p15 p14 p13 p12 p11 p10 p9 p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    r[3] = t3;</span>
<span class="term-fg31">-    VERIFY_BITS(r[3], 26);</span>
<span class="term-fg31">-    &#47;* [d u8 0 0 0 0 0 0 0 0 t9 c-u8*R0 t7 t6 t5 t4 r3 t2 t1 t0] = [p18 p17 p16 p15 p14 p13 p12 p11 p10 p9 p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    r[4] = t4;</span>
<span class="term-fg31">-    VERIFY_BITS(r[4], 26);</span>
<span class="term-fg31">-    &#47;* [d u8 0 0 0 0 0 0 0 0 t9 c-u8*R0 t7 t6 t5 r4 r3 t2 t1 t0] = [p18 p17 p16 p15 p14 p13 p12 p11 p10 p9 p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    r[5] = t5;</span>
<span class="term-fg31">-    VERIFY_BITS(r[5], 26);</span>
<span class="term-fg31">-    &#47;* [d u8 0 0 0 0 0 0 0 0 t9 c-u8*R0 t7 t6 r5 r4 r3 t2 t1 t0] = [p18 p17 p16 p15 p14 p13 p12 p11 p10 p9 p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    r[6] = t6;</span>
<span class="term-fg31">-    VERIFY_BITS(r[6], 26);</span>
<span class="term-fg31">-    &#47;* [d u8 0 0 0 0 0 0 0 0 t9 c-u8*R0 t7 r6 r5 r4 r3 t2 t1 t0] = [p18 p17 p16 p15 p14 p13 p12 p11 p10 p9 p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    r[7] = t7;</span>
<span class="term-fg31">-    VERIFY_BITS(r[7], 26);</span>
<span class="term-fg31">-    &#47;* [d u8 0 0 0 0 0 0 0 0 t9 c-u8*R0 r7 r6 r5 r4 r3 t2 t1 t0] = [p18 p17 p16 p15 p14 p13 p12 p11 p10 p9 p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    r[8] = c &amp; M; c &gt;&gt;= 26; c += u8 * R1;</span>
<span class="term-fg31">-    VERIFY_BITS(r[8], 26);</span>
<span class="term-fg31">-    VERIFY_BITS(c, 39);</span>
<span class="term-fg31">-    &#47;* [d u8 0 0 0 0 0 0 0 0 t9+c-u8*R1 r8-u8*R0 r7 r6 r5 r4 r3 t2 t1 t0] = [p18 p17 p16 p15 p14 p13 p12 p11 p10 p9 p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    &#47;* [d 0 0 0 0 0 0 0 0 0 t9+c r8 r7 r6 r5 r4 r3 t2 t1 t0] = [p18 p17 p16 p15 p14 p13 p12 p11 p10 p9 p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    c   += d * R0 + t9;</span>
<span class="term-fg31">-    VERIFY_BITS(c, 45);</span>
<span class="term-fg31">-    &#47;* [d 0 0 0 0 0 0 0 0 0 c-d*R0 r8 r7 r6 r5 r4 r3 t2 t1 t0] = [p18 p17 p16 p15 p14 p13 p12 p11 p10 p9 p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    r[9] = c &amp; (M &gt;&gt; 4); c &gt;&gt;= 22; c += d * (R1 &lt;&lt; 4);</span>
<span class="term-fg31">-    VERIFY_BITS(r[9], 22);</span>
<span class="term-fg31">-    VERIFY_BITS(c, 46);</span>
<span class="term-fg31">-    &#47;* [d 0 0 0 0 0 0 0 0 r9+((c-d*R1&lt;&lt;4)&lt;&lt;22)-d*R0 r8 r7 r6 r5 r4 r3 t2 t1 t0] = [p18 p17 p16 p15 p14 p13 p12 p11 p10 p9 p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    &#47;* [d 0 0 0 0 0 0 0 -d*R1 r9+(c&lt;&lt;22)-d*R0 r8 r7 r6 r5 r4 r3 t2 t1 t0] = [p18 p17 p16 p15 p14 p13 p12 p11 p10 p9 p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    &#47;* [r9+(c&lt;&lt;22) r8 r7 r6 r5 r4 r3 t2 t1 t0] = [p18 p17 p16 p15 p14 p13 p12 p11 p10 p9 p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    d    = c * (R0 &gt;&gt; 4) + t0;</span>
<span class="term-fg31">-    VERIFY_BITS(d, 56);</span>
<span class="term-fg31">-    &#47;* [r9+(c&lt;&lt;22) r8 r7 r6 r5 r4 r3 t2 t1 d-c*R0&gt;&gt;4] = [p18 p17 p16 p15 p14 p13 p12 p11 p10 p9 p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    r[0] = d &amp; M; d &gt;&gt;= 26;</span>
<span class="term-fg31">-    VERIFY_BITS(r[0], 26);</span>
<span class="term-fg31">-    VERIFY_BITS(d, 30);</span>
<span class="term-fg31">-    &#47;* [r9+(c&lt;&lt;22) r8 r7 r6 r5 r4 r3 t2 t1+d r0-c*R0&gt;&gt;4] = [p18 p17 p16 p15 p14 p13 p12 p11 p10 p9 p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    d   += c * (R1 &gt;&gt; 4) + t1;</span>
<span class="term-fg31">-    VERIFY_BITS(d, 53);</span>
<span class="term-fg31">-    VERIFY_CHECK(d &lt;= 0x10000003FFFFBFULL);</span>
<span class="term-fg31">-    &#47;* [r9+(c&lt;&lt;22) r8 r7 r6 r5 r4 r3 t2 d-c*R1&gt;&gt;4 r0-c*R0&gt;&gt;4] = [p18 p17 p16 p15 p14 p13 p12 p11 p10 p9 p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    &#47;* [r9 r8 r7 r6 r5 r4 r3 t2 d r0] = [p18 p17 p16 p15 p14 p13 p12 p11 p10 p9 p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    r[1] = d &amp; M; d &gt;&gt;= 26;</span>
<span class="term-fg31">-    VERIFY_BITS(r[1], 26);</span>
<span class="term-fg31">-    VERIFY_BITS(d, 27);</span>
<span class="term-fg31">-    VERIFY_CHECK(d &lt;= 0x4000000ULL);</span>
<span class="term-fg31">-    &#47;* [r9 r8 r7 r6 r5 r4 r3 t2+d r1 r0] = [p18 p17 p16 p15 p14 p13 p12 p11 p10 p9 p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    d   += t2;</span>
<span class="term-fg31">-    VERIFY_BITS(d, 27);</span>
<span class="term-fg31">-    &#47;* [r9 r8 r7 r6 r5 r4 r3 d r1 r0] = [p18 p17 p16 p15 p14 p13 p12 p11 p10 p9 p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    r[2] = d;</span>
<span class="term-fg31">-    VERIFY_BITS(r[2], 27);</span>
<span class="term-fg31">-    &#47;* [r9 r8 r7 r6 r5 r4 r3 r2 r1 r0] = [p18 p17 p16 p15 p14 p13 p12 p11 p10 p9 p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_fe_mul(secp256k1_fe *r, const secp256k1_fe *a, const secp256k1_fe * SECP256K1_RESTRICT b) {</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-    VERIFY_CHECK(a-&gt;magnitude &lt;= 8);</span>
<span class="term-fg31">-    VERIFY_CHECK(b-&gt;magnitude &lt;= 8);</span>
<span class="term-fg31">-    secp256k1_fe_verify(a);</span>
<span class="term-fg31">-    secp256k1_fe_verify(b);</span>
<span class="term-fg31">-    VERIFY_CHECK(r != b);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-    secp256k1_fe_mul_inner(r-&gt;n, a-&gt;n, b-&gt;n);</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-    r-&gt;magnitude = 1;</span>
<span class="term-fg31">-    r-&gt;normalized = 0;</span>
<span class="term-fg31">-    secp256k1_fe_verify(r);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_fe_sqr(secp256k1_fe *r, const secp256k1_fe *a) {</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-    VERIFY_CHECK(a-&gt;magnitude &lt;= 8);</span>
<span class="term-fg31">-    secp256k1_fe_verify(a);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-    secp256k1_fe_sqr_inner(r-&gt;n, a-&gt;n);</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-    r-&gt;magnitude = 1;</span>
<span class="term-fg31">-    r-&gt;normalized = 0;</span>
<span class="term-fg31">-    secp256k1_fe_verify(r);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static SECP256K1_INLINE void secp256k1_fe_cmov(secp256k1_fe *r, const secp256k1_fe *a, int flag) {</span>
<span class="term-fg31">-    uint32_t mask0, mask1;</span>
<span class="term-fg31">-    mask0 = flag + ~((uint32_t)0);</span>
<span class="term-fg31">-    mask1 = ~mask0;</span>
<span class="term-fg31">-    r-&gt;n[0] = (r-&gt;n[0] &amp; mask0) | (a-&gt;n[0] &amp; mask1);</span>
<span class="term-fg31">-    r-&gt;n[1] = (r-&gt;n[1] &amp; mask0) | (a-&gt;n[1] &amp; mask1);</span>
<span class="term-fg31">-    r-&gt;n[2] = (r-&gt;n[2] &amp; mask0) | (a-&gt;n[2] &amp; mask1);</span>
<span class="term-fg31">-    r-&gt;n[3] = (r-&gt;n[3] &amp; mask0) | (a-&gt;n[3] &amp; mask1);</span>
<span class="term-fg31">-    r-&gt;n[4] = (r-&gt;n[4] &amp; mask0) | (a-&gt;n[4] &amp; mask1);</span>
<span class="term-fg31">-    r-&gt;n[5] = (r-&gt;n[5] &amp; mask0) | (a-&gt;n[5] &amp; mask1);</span>
<span class="term-fg31">-    r-&gt;n[6] = (r-&gt;n[6] &amp; mask0) | (a-&gt;n[6] &amp; mask1);</span>
<span class="term-fg31">-    r-&gt;n[7] = (r-&gt;n[7] &amp; mask0) | (a-&gt;n[7] &amp; mask1);</span>
<span class="term-fg31">-    r-&gt;n[8] = (r-&gt;n[8] &amp; mask0) | (a-&gt;n[8] &amp; mask1);</span>
<span class="term-fg31">-    r-&gt;n[9] = (r-&gt;n[9] &amp; mask0) | (a-&gt;n[9] &amp; mask1);</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-    if (a-&gt;magnitude &gt; r-&gt;magnitude) {</span>
<span class="term-fg31">-        r-&gt;magnitude = a-&gt;magnitude;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    r-&gt;normalized &amp;= a-&gt;normalized;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static SECP256K1_INLINE void secp256k1_fe_storage_cmov(secp256k1_fe_storage *r, const secp256k1_fe_storage *a, int flag) {</span>
<span class="term-fg31">-    uint32_t mask0, mask1;</span>
<span class="term-fg31">-    mask0 = flag + ~((uint32_t)0);</span>
<span class="term-fg31">-    mask1 = ~mask0;</span>
<span class="term-fg31">-    r-&gt;n[0] = (r-&gt;n[0] &amp; mask0) | (a-&gt;n[0] &amp; mask1);</span>
<span class="term-fg31">-    r-&gt;n[1] = (r-&gt;n[1] &amp; mask0) | (a-&gt;n[1] &amp; mask1);</span>
<span class="term-fg31">-    r-&gt;n[2] = (r-&gt;n[2] &amp; mask0) | (a-&gt;n[2] &amp; mask1);</span>
<span class="term-fg31">-    r-&gt;n[3] = (r-&gt;n[3] &amp; mask0) | (a-&gt;n[3] &amp; mask1);</span>
<span class="term-fg31">-    r-&gt;n[4] = (r-&gt;n[4] &amp; mask0) | (a-&gt;n[4] &amp; mask1);</span>
<span class="term-fg31">-    r-&gt;n[5] = (r-&gt;n[5] &amp; mask0) | (a-&gt;n[5] &amp; mask1);</span>
<span class="term-fg31">-    r-&gt;n[6] = (r-&gt;n[6] &amp; mask0) | (a-&gt;n[6] &amp; mask1);</span>
<span class="term-fg31">-    r-&gt;n[7] = (r-&gt;n[7] &amp; mask0) | (a-&gt;n[7] &amp; mask1);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_fe_to_storage(secp256k1_fe_storage *r, const secp256k1_fe *a) {</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-    VERIFY_CHECK(a-&gt;normalized);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-    r-&gt;n[0] = a-&gt;n[0] | a-&gt;n[1] &lt;&lt; 26;</span>
<span class="term-fg31">-    r-&gt;n[1] = a-&gt;n[1] &gt;&gt; 6 | a-&gt;n[2] &lt;&lt; 20;</span>
<span class="term-fg31">-    r-&gt;n[2] = a-&gt;n[2] &gt;&gt; 12 | a-&gt;n[3] &lt;&lt; 14;</span>
<span class="term-fg31">-    r-&gt;n[3] = a-&gt;n[3] &gt;&gt; 18 | a-&gt;n[4] &lt;&lt; 8;</span>
<span class="term-fg31">-    r-&gt;n[4] = a-&gt;n[4] &gt;&gt; 24 | a-&gt;n[5] &lt;&lt; 2 | a-&gt;n[6] &lt;&lt; 28;</span>
<span class="term-fg31">-    r-&gt;n[5] = a-&gt;n[6] &gt;&gt; 4 | a-&gt;n[7] &lt;&lt; 22;</span>
<span class="term-fg31">-    r-&gt;n[6] = a-&gt;n[7] &gt;&gt; 10 | a-&gt;n[8] &lt;&lt; 16;</span>
<span class="term-fg31">-    r-&gt;n[7] = a-&gt;n[8] &gt;&gt; 16 | a-&gt;n[9] &lt;&lt; 10;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static SECP256K1_INLINE void secp256k1_fe_from_storage(secp256k1_fe *r, const secp256k1_fe_storage *a) {</span>
<span class="term-fg31">-    r-&gt;n[0] = a-&gt;n[0] &amp; 0x3FFFFFFUL;</span>
<span class="term-fg31">-    r-&gt;n[1] = a-&gt;n[0] &gt;&gt; 26 | ((a-&gt;n[1] &lt;&lt; 6) &amp; 0x3FFFFFFUL);</span>
<span class="term-fg31">-    r-&gt;n[2] = a-&gt;n[1] &gt;&gt; 20 | ((a-&gt;n[2] &lt;&lt; 12) &amp; 0x3FFFFFFUL);</span>
<span class="term-fg31">-    r-&gt;n[3] = a-&gt;n[2] &gt;&gt; 14 | ((a-&gt;n[3] &lt;&lt; 18) &amp; 0x3FFFFFFUL);</span>
<span class="term-fg31">-    r-&gt;n[4] = a-&gt;n[3] &gt;&gt; 8 | ((a-&gt;n[4] &lt;&lt; 24) &amp; 0x3FFFFFFUL);</span>
<span class="term-fg31">-    r-&gt;n[5] = (a-&gt;n[4] &gt;&gt; 2) &amp; 0x3FFFFFFUL;</span>
<span class="term-fg31">-    r-&gt;n[6] = a-&gt;n[4] &gt;&gt; 28 | ((a-&gt;n[5] &lt;&lt; 4) &amp; 0x3FFFFFFUL);</span>
<span class="term-fg31">-    r-&gt;n[7] = a-&gt;n[5] &gt;&gt; 22 | ((a-&gt;n[6] &lt;&lt; 10) &amp; 0x3FFFFFFUL);</span>
<span class="term-fg31">-    r-&gt;n[8] = a-&gt;n[6] &gt;&gt; 16 | ((a-&gt;n[7] &lt;&lt; 16) &amp; 0x3FFFFFFUL);</span>
<span class="term-fg31">-    r-&gt;n[9] = a-&gt;n[7] &gt;&gt; 10;</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-    r-&gt;magnitude = 1;</span>
<span class="term-fg31">-    r-&gt;normalized = 1;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-87f4870bc1960e36cb5ab619" role="button"
                       aria-expanded="false" aria-controls="id-87f4870bc1960e36cb5ab619">
                        <code>crypto/secp256k1/libsecp256k1/src/field_5x52.h</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/field_5x52.h" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-47</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-87f4870bc1960e36cb5ab619"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;field_5x52.h op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;field_5x52.h</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 8e69a560dccb6c99621dee52f67a2502343453ca..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;field_5x52.h</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,47 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2013, 2014 Pieter Wuille                             *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef _SECP256K1_FIELD_REPR_</span>
<span class="term-fg31">-#define _SECP256K1_FIELD_REPR_</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &lt;stdint.h&gt;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-typedef struct {</span>
<span class="term-fg31">-    &#47;* X = sum(i=0..4, elem[i]*2^52) mod n *&#47;</span>
<span class="term-fg31">-    uint64_t n[5];</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-    int magnitude;</span>
<span class="term-fg31">-    int normalized;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-} secp256k1_fe;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;* Unpacks a constant into a overlapping multi-limbed FE element. *&#47;</span>
<span class="term-fg31">-#define SECP256K1_FE_CONST_INNER(d7, d6, d5, d4, d3, d2, d1, d0) { \</span>
<span class="term-fg31">-    (d0) | (((uint64_t)(d1) &amp; 0xFFFFFUL) &lt;&lt; 32), \</span>
<span class="term-fg31">-    ((uint64_t)(d1) &gt;&gt; 20) | (((uint64_t)(d2)) &lt;&lt; 12) | (((uint64_t)(d3) &amp; 0xFFUL) &lt;&lt; 44), \</span>
<span class="term-fg31">-    ((uint64_t)(d3) &gt;&gt; 8) | (((uint64_t)(d4) &amp; 0xFFFFFFFUL) &lt;&lt; 24), \</span>
<span class="term-fg31">-    ((uint64_t)(d4) &gt;&gt; 28) | (((uint64_t)(d5)) &lt;&lt; 4) | (((uint64_t)(d6) &amp; 0xFFFFUL) &lt;&lt; 36), \</span>
<span class="term-fg31">-    ((uint64_t)(d6) &gt;&gt; 16) | (((uint64_t)(d7)) &lt;&lt; 16) \</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-#define SECP256K1_FE_CONST(d7, d6, d5, d4, d3, d2, d1, d0) {SECP256K1_FE_CONST_INNER((d7), (d6), (d5), (d4), (d3), (d2), (d1), (d0)), 1, 1}</span>
<span class="term-fg31">-#else</span>
<span class="term-fg31">-#define SECP256K1_FE_CONST(d7, d6, d5, d4, d3, d2, d1, d0) {SECP256K1_FE_CONST_INNER((d7), (d6), (d5), (d4), (d3), (d2), (d1), (d0))}</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-typedef struct {</span>
<span class="term-fg31">-    uint64_t n[4];</span>
<span class="term-fg31">-} secp256k1_fe_storage;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#define SECP256K1_FE_STORAGE_CONST(d7, d6, d5, d4, d3, d2, d1, d0) {{ \</span>
<span class="term-fg31">-    (d0) | (((uint64_t)(d1)) &lt;&lt; 32), \</span>
<span class="term-fg31">-    (d2) | (((uint64_t)(d3)) &lt;&lt; 32), \</span>
<span class="term-fg31">-    (d4) | (((uint64_t)(d5)) &lt;&lt; 32), \</span>
<span class="term-fg31">-    (d6) | (((uint64_t)(d7)) &lt;&lt; 32) \</span>
<span class="term-fg31">-}}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-94dd1c0b4f1c6e9bd54a2f10" role="button"
                       aria-expanded="false" aria-controls="id-94dd1c0b4f1c6e9bd54a2f10">
                        <code>crypto/secp256k1/libsecp256k1/src/field_5x52_asm_impl.h</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/field_5x52_asm_impl.h" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-502</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-94dd1c0b4f1c6e9bd54a2f10"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;field_5x52_asm_impl.h op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;field_5x52_asm_impl.h</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 98cc004bf04a69c201c996a7f1c3ccac68354b5e..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;field_5x52_asm_impl.h</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,502 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2013-2014 Diederik Huys, Pieter Wuille               *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;**</span>
<span class="term-fg31">- * Changelog:</span>
<span class="term-fg31">- * - March 2013, Diederik Huys:    original version</span>
<span class="term-fg31">- * - November 2014, Pieter Wuille: updated to use Peter Dettman&#39;s parallel multiplication algorithm</span>
<span class="term-fg31">- * - December 2014, Pieter Wuille: converted from YASM to GCC inline assembly</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef _SECP256K1_FIELD_INNER5X52_IMPL_H_</span>
<span class="term-fg31">-#define _SECP256K1_FIELD_INNER5X52_IMPL_H_</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static void secp256k1_fe_mul_inner(uint64_t *r, const uint64_t *a, const uint64_t * SECP256K1_RESTRICT b) {</span>
<span class="term-fg31">-&#47;**</span>
<span class="term-fg31">- * Registers: rdx:rax = multiplication accumulator</span>
<span class="term-fg31">- *            r9:r8   = c</span>
<span class="term-fg31">- *            r15:rcx = d</span>
<span class="term-fg31">- *            r10-r14 = a0-a4</span>
<span class="term-fg31">- *            rbx     = b</span>
<span class="term-fg31">- *            rdi     = r</span>
<span class="term-fg31">- *            rsi     = a &#47; t?</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-  uint64_t tmp1, tmp2, tmp3;</span>
<span class="term-fg31">-__asm__ __volatile__(</span>
<span class="term-fg31">-    &quot;movq 0(%%rsi),%%r10\n&quot;</span>
<span class="term-fg31">-    &quot;movq 8(%%rsi),%%r11\n&quot;</span>
<span class="term-fg31">-    &quot;movq 16(%%rsi),%%r12\n&quot;</span>
<span class="term-fg31">-    &quot;movq 24(%%rsi),%%r13\n&quot;</span>
<span class="term-fg31">-    &quot;movq 32(%%rsi),%%r14\n&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* d += a3 * b0 *&#47;</span>
<span class="term-fg31">-    &quot;movq 0(%%rbx),%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r13\n&quot;</span>
<span class="term-fg31">-    &quot;movq %%rax,%%rcx\n&quot;</span>
<span class="term-fg31">-    &quot;movq %%rdx,%%r15\n&quot;</span>
<span class="term-fg31">-    &#47;* d += a2 * b1 *&#47;</span>
<span class="term-fg31">-    &quot;movq 8(%%rbx),%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r12\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax,%%rcx\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx,%%r15\n&quot;</span>
<span class="term-fg31">-    &#47;* d += a1 * b2 *&#47;</span>
<span class="term-fg31">-    &quot;movq 16(%%rbx),%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r11\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax,%%rcx\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx,%%r15\n&quot;</span>
<span class="term-fg31">-    &#47;* d = a0 * b3 *&#47;</span>
<span class="term-fg31">-    &quot;movq 24(%%rbx),%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r10\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax,%%rcx\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx,%%r15\n&quot;</span>
<span class="term-fg31">-    &#47;* c = a4 * b4 *&#47;</span>
<span class="term-fg31">-    &quot;movq 32(%%rbx),%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r14\n&quot;</span>
<span class="term-fg31">-    &quot;movq %%rax,%%r8\n&quot;</span>
<span class="term-fg31">-    &quot;movq %%rdx,%%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* d += (c &amp; M) * R *&#47;</span>
<span class="term-fg31">-    &quot;movq $0xfffffffffffff,%%rdx\n&quot;</span>
<span class="term-fg31">-    &quot;andq %%rdx,%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;movq $0x1000003d10,%%rdx\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%rdx\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax,%%rcx\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx,%%r15\n&quot;</span>
<span class="term-fg31">-    &#47;* c &gt;&gt;= 52 (%%r8 only) *&#47;</span>
<span class="term-fg31">-    &quot;shrdq $52,%%r9,%%r8\n&quot;</span>
<span class="term-fg31">-    &#47;* t3 (tmp1) = d &amp; M *&#47;</span>
<span class="term-fg31">-    &quot;movq %%rcx,%%rsi\n&quot;</span>
<span class="term-fg31">-    &quot;movq $0xfffffffffffff,%%rdx\n&quot;</span>
<span class="term-fg31">-    &quot;andq %%rdx,%%rsi\n&quot;</span>
<span class="term-fg31">-    &quot;movq %%rsi,%q1\n&quot;</span>
<span class="term-fg31">-    &#47;* d &gt;&gt;= 52 *&#47;</span>
<span class="term-fg31">-    &quot;shrdq $52,%%r15,%%rcx\n&quot;</span>
<span class="term-fg31">-    &quot;xorq %%r15,%%r15\n&quot;</span>
<span class="term-fg31">-    &#47;* d += a4 * b0 *&#47;</span>
<span class="term-fg31">-    &quot;movq 0(%%rbx),%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r14\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax,%%rcx\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx,%%r15\n&quot;</span>
<span class="term-fg31">-    &#47;* d += a3 * b1 *&#47;</span>
<span class="term-fg31">-    &quot;movq 8(%%rbx),%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r13\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax,%%rcx\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx,%%r15\n&quot;</span>
<span class="term-fg31">-    &#47;* d += a2 * b2 *&#47;</span>
<span class="term-fg31">-    &quot;movq 16(%%rbx),%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r12\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax,%%rcx\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx,%%r15\n&quot;</span>
<span class="term-fg31">-    &#47;* d += a1 * b3 *&#47;</span>
<span class="term-fg31">-    &quot;movq 24(%%rbx),%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r11\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax,%%rcx\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx,%%r15\n&quot;</span>
<span class="term-fg31">-    &#47;* d += a0 * b4 *&#47;</span>
<span class="term-fg31">-    &quot;movq 32(%%rbx),%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r10\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax,%%rcx\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx,%%r15\n&quot;</span>
<span class="term-fg31">-    &#47;* d += c * R *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r8,%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;movq $0x1000003d10,%%rdx\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%rdx\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax,%%rcx\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx,%%r15\n&quot;</span>
<span class="term-fg31">-    &#47;* t4 = d &amp; M (%%rsi) *&#47;</span>
<span class="term-fg31">-    &quot;movq %%rcx,%%rsi\n&quot;</span>
<span class="term-fg31">-    &quot;movq $0xfffffffffffff,%%rdx\n&quot;</span>
<span class="term-fg31">-    &quot;andq %%rdx,%%rsi\n&quot;</span>
<span class="term-fg31">-    &#47;* d &gt;&gt;= 52 *&#47;</span>
<span class="term-fg31">-    &quot;shrdq $52,%%r15,%%rcx\n&quot;</span>
<span class="term-fg31">-    &quot;xorq %%r15,%%r15\n&quot;</span>
<span class="term-fg31">-    &#47;* tx = t4 &gt;&gt; 48 (tmp3) *&#47;</span>
<span class="term-fg31">-    &quot;movq %%rsi,%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;shrq $48,%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;movq %%rax,%q3\n&quot;</span>
<span class="term-fg31">-    &#47;* t4 &amp;= (M &gt;&gt; 4) (tmp2) *&#47;</span>
<span class="term-fg31">-    &quot;movq $0xffffffffffff,%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;andq %%rax,%%rsi\n&quot;</span>
<span class="term-fg31">-    &quot;movq %%rsi,%q2\n&quot;</span>
<span class="term-fg31">-    &#47;* c = a0 * b0 *&#47;</span>
<span class="term-fg31">-    &quot;movq 0(%%rbx),%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r10\n&quot;</span>
<span class="term-fg31">-    &quot;movq %%rax,%%r8\n&quot;</span>
<span class="term-fg31">-    &quot;movq %%rdx,%%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* d += a4 * b1 *&#47;</span>
<span class="term-fg31">-    &quot;movq 8(%%rbx),%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r14\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax,%%rcx\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx,%%r15\n&quot;</span>
<span class="term-fg31">-    &#47;* d += a3 * b2 *&#47;</span>
<span class="term-fg31">-    &quot;movq 16(%%rbx),%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r13\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax,%%rcx\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx,%%r15\n&quot;</span>
<span class="term-fg31">-    &#47;* d += a2 * b3 *&#47;</span>
<span class="term-fg31">-    &quot;movq 24(%%rbx),%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r12\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax,%%rcx\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx,%%r15\n&quot;</span>
<span class="term-fg31">-    &#47;* d += a1 * b4 *&#47;</span>
<span class="term-fg31">-    &quot;movq 32(%%rbx),%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r11\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax,%%rcx\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx,%%r15\n&quot;</span>
<span class="term-fg31">-    &#47;* u0 = d &amp; M (%%rsi) *&#47;</span>
<span class="term-fg31">-    &quot;movq %%rcx,%%rsi\n&quot;</span>
<span class="term-fg31">-    &quot;movq $0xfffffffffffff,%%rdx\n&quot;</span>
<span class="term-fg31">-    &quot;andq %%rdx,%%rsi\n&quot;</span>
<span class="term-fg31">-    &#47;* d &gt;&gt;= 52 *&#47;</span>
<span class="term-fg31">-    &quot;shrdq $52,%%r15,%%rcx\n&quot;</span>
<span class="term-fg31">-    &quot;xorq %%r15,%%r15\n&quot;</span>
<span class="term-fg31">-    &#47;* u0 = (u0 &lt;&lt; 4) | tx (%%rsi) *&#47;</span>
<span class="term-fg31">-    &quot;shlq $4,%%rsi\n&quot;</span>
<span class="term-fg31">-    &quot;movq %q3,%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;orq %%rax,%%rsi\n&quot;</span>
<span class="term-fg31">-    &#47;* c += u0 * (R &gt;&gt; 4) *&#47;</span>
<span class="term-fg31">-    &quot;movq $0x1000003d1,%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%rsi\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax,%%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx,%%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* r[0] = c &amp; M *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r8,%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;movq $0xfffffffffffff,%%rdx\n&quot;</span>
<span class="term-fg31">-    &quot;andq %%rdx,%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;movq %%rax,0(%%rdi)\n&quot;</span>
<span class="term-fg31">-    &#47;* c &gt;&gt;= 52 *&#47;</span>
<span class="term-fg31">-    &quot;shrdq $52,%%r9,%%r8\n&quot;</span>
<span class="term-fg31">-    &quot;xorq %%r9,%%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* c += a1 * b0 *&#47;</span>
<span class="term-fg31">-    &quot;movq 0(%%rbx),%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r11\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax,%%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx,%%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* c += a0 * b1 *&#47;</span>
<span class="term-fg31">-    &quot;movq 8(%%rbx),%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r10\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax,%%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx,%%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* d += a4 * b2 *&#47;</span>
<span class="term-fg31">-    &quot;movq 16(%%rbx),%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r14\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax,%%rcx\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx,%%r15\n&quot;</span>
<span class="term-fg31">-    &#47;* d += a3 * b3 *&#47;</span>
<span class="term-fg31">-    &quot;movq 24(%%rbx),%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r13\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax,%%rcx\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx,%%r15\n&quot;</span>
<span class="term-fg31">-    &#47;* d += a2 * b4 *&#47;</span>
<span class="term-fg31">-    &quot;movq 32(%%rbx),%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r12\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax,%%rcx\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx,%%r15\n&quot;</span>
<span class="term-fg31">-    &#47;* c += (d &amp; M) * R *&#47;</span>
<span class="term-fg31">-    &quot;movq %%rcx,%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;movq $0xfffffffffffff,%%rdx\n&quot;</span>
<span class="term-fg31">-    &quot;andq %%rdx,%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;movq $0x1000003d10,%%rdx\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%rdx\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax,%%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx,%%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* d &gt;&gt;= 52 *&#47;</span>
<span class="term-fg31">-    &quot;shrdq $52,%%r15,%%rcx\n&quot;</span>
<span class="term-fg31">-    &quot;xorq %%r15,%%r15\n&quot;</span>
<span class="term-fg31">-    &#47;* r[1] = c &amp; M *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r8,%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;movq $0xfffffffffffff,%%rdx\n&quot;</span>
<span class="term-fg31">-    &quot;andq %%rdx,%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;movq %%rax,8(%%rdi)\n&quot;</span>
<span class="term-fg31">-    &#47;* c &gt;&gt;= 52 *&#47;</span>
<span class="term-fg31">-    &quot;shrdq $52,%%r9,%%r8\n&quot;</span>
<span class="term-fg31">-    &quot;xorq %%r9,%%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* c += a2 * b0 *&#47;</span>
<span class="term-fg31">-    &quot;movq 0(%%rbx),%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r12\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax,%%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx,%%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* c += a1 * b1 *&#47;</span>
<span class="term-fg31">-    &quot;movq 8(%%rbx),%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r11\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax,%%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx,%%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* c += a0 * b2 (last use of %%r10 = a0) *&#47;</span>
<span class="term-fg31">-    &quot;movq 16(%%rbx),%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r10\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax,%%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx,%%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* fetch t3 (%%r10, overwrites a0), t4 (%%rsi) *&#47;</span>
<span class="term-fg31">-    &quot;movq %q2,%%rsi\n&quot;</span>
<span class="term-fg31">-    &quot;movq %q1,%%r10\n&quot;</span>
<span class="term-fg31">-    &#47;* d += a4 * b3 *&#47;</span>
<span class="term-fg31">-    &quot;movq 24(%%rbx),%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r14\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax,%%rcx\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx,%%r15\n&quot;</span>
<span class="term-fg31">-    &#47;* d += a3 * b4 *&#47;</span>
<span class="term-fg31">-    &quot;movq 32(%%rbx),%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r13\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax,%%rcx\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx,%%r15\n&quot;</span>
<span class="term-fg31">-    &#47;* c += (d &amp; M) * R *&#47;</span>
<span class="term-fg31">-    &quot;movq %%rcx,%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;movq $0xfffffffffffff,%%rdx\n&quot;</span>
<span class="term-fg31">-    &quot;andq %%rdx,%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;movq $0x1000003d10,%%rdx\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%rdx\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax,%%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx,%%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* d &gt;&gt;= 52 (%%rcx only) *&#47;</span>
<span class="term-fg31">-    &quot;shrdq $52,%%r15,%%rcx\n&quot;</span>
<span class="term-fg31">-    &#47;* r[2] = c &amp; M *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r8,%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;movq $0xfffffffffffff,%%rdx\n&quot;</span>
<span class="term-fg31">-    &quot;andq %%rdx,%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;movq %%rax,16(%%rdi)\n&quot;</span>
<span class="term-fg31">-    &#47;* c &gt;&gt;= 52 *&#47;</span>
<span class="term-fg31">-    &quot;shrdq $52,%%r9,%%r8\n&quot;</span>
<span class="term-fg31">-    &quot;xorq %%r9,%%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* c += t3 *&#47;</span>
<span class="term-fg31">-    &quot;addq %%r10,%%r8\n&quot;</span>
<span class="term-fg31">-    &#47;* c += d * R *&#47;</span>
<span class="term-fg31">-    &quot;movq %%rcx,%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;movq $0x1000003d10,%%rdx\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%rdx\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax,%%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx,%%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* r[3] = c &amp; M *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r8,%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;movq $0xfffffffffffff,%%rdx\n&quot;</span>
<span class="term-fg31">-    &quot;andq %%rdx,%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;movq %%rax,24(%%rdi)\n&quot;</span>
<span class="term-fg31">-    &#47;* c &gt;&gt;= 52 (%%r8 only) *&#47;</span>
<span class="term-fg31">-    &quot;shrdq $52,%%r9,%%r8\n&quot;</span>
<span class="term-fg31">-    &#47;* c += t4 (%%r8 only) *&#47;</span>
<span class="term-fg31">-    &quot;addq %%rsi,%%r8\n&quot;</span>
<span class="term-fg31">-    &#47;* r[4] = c *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r8,32(%%rdi)\n&quot;</span>
<span class="term-fg31">-: &quot;+S&quot;(a), &quot;=m&quot;(tmp1), &quot;=m&quot;(tmp2), &quot;=m&quot;(tmp3)</span>
<span class="term-fg31">-: &quot;b&quot;(b), &quot;D&quot;(r)</span>
<span class="term-fg31">-: &quot;%rax&quot;, &quot;%rcx&quot;, &quot;%rdx&quot;, &quot;%r8&quot;, &quot;%r9&quot;, &quot;%r10&quot;, &quot;%r11&quot;, &quot;%r12&quot;, &quot;%r13&quot;, &quot;%r14&quot;, &quot;%r15&quot;, &quot;cc&quot;, &quot;memory&quot;</span>
<span class="term-fg31">-);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static void secp256k1_fe_sqr_inner(uint64_t *r, const uint64_t *a) {</span>
<span class="term-fg31">-&#47;**</span>
<span class="term-fg31">- * Registers: rdx:rax = multiplication accumulator</span>
<span class="term-fg31">- *            r9:r8   = c</span>
<span class="term-fg31">- *            rcx:rbx = d</span>
<span class="term-fg31">- *            r10-r14 = a0-a4</span>
<span class="term-fg31">- *            r15     = M (0xfffffffffffff)</span>
<span class="term-fg31">- *            rdi     = r</span>
<span class="term-fg31">- *            rsi     = a &#47; t?</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-  uint64_t tmp1, tmp2, tmp3;</span>
<span class="term-fg31">-__asm__ __volatile__(</span>
<span class="term-fg31">-    &quot;movq 0(%%rsi),%%r10\n&quot;</span>
<span class="term-fg31">-    &quot;movq 8(%%rsi),%%r11\n&quot;</span>
<span class="term-fg31">-    &quot;movq 16(%%rsi),%%r12\n&quot;</span>
<span class="term-fg31">-    &quot;movq 24(%%rsi),%%r13\n&quot;</span>
<span class="term-fg31">-    &quot;movq 32(%%rsi),%%r14\n&quot;</span>
<span class="term-fg31">-    &quot;movq $0xfffffffffffff,%%r15\n&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* d = (a0*2) * a3 *&#47;</span>
<span class="term-fg31">-    &quot;leaq (%%r10,%%r10,1),%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r13\n&quot;</span>
<span class="term-fg31">-    &quot;movq %%rax,%%rbx\n&quot;</span>
<span class="term-fg31">-    &quot;movq %%rdx,%%rcx\n&quot;</span>
<span class="term-fg31">-    &#47;* d += (a1*2) * a2 *&#47;</span>
<span class="term-fg31">-    &quot;leaq (%%r11,%%r11,1),%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r12\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax,%%rbx\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx,%%rcx\n&quot;</span>
<span class="term-fg31">-    &#47;* c = a4 * a4 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r14,%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r14\n&quot;</span>
<span class="term-fg31">-    &quot;movq %%rax,%%r8\n&quot;</span>
<span class="term-fg31">-    &quot;movq %%rdx,%%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* d += (c &amp; M) * R *&#47;</span>
<span class="term-fg31">-    &quot;andq %%r15,%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;movq $0x1000003d10,%%rdx\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%rdx\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax,%%rbx\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx,%%rcx\n&quot;</span>
<span class="term-fg31">-    &#47;* c &gt;&gt;= 52 (%%r8 only) *&#47;</span>
<span class="term-fg31">-    &quot;shrdq $52,%%r9,%%r8\n&quot;</span>
<span class="term-fg31">-    &#47;* t3 (tmp1) = d &amp; M *&#47;</span>
<span class="term-fg31">-    &quot;movq %%rbx,%%rsi\n&quot;</span>
<span class="term-fg31">-    &quot;andq %%r15,%%rsi\n&quot;</span>
<span class="term-fg31">-    &quot;movq %%rsi,%q1\n&quot;</span>
<span class="term-fg31">-    &#47;* d &gt;&gt;= 52 *&#47;</span>
<span class="term-fg31">-    &quot;shrdq $52,%%rcx,%%rbx\n&quot;</span>
<span class="term-fg31">-    &quot;xorq %%rcx,%%rcx\n&quot;</span>
<span class="term-fg31">-    &#47;* a4 *= 2 *&#47;</span>
<span class="term-fg31">-    &quot;addq %%r14,%%r14\n&quot;</span>
<span class="term-fg31">-    &#47;* d += a0 * a4 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r10,%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r14\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax,%%rbx\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx,%%rcx\n&quot;</span>
<span class="term-fg31">-    &#47;* d+= (a1*2) * a3 *&#47;</span>
<span class="term-fg31">-    &quot;leaq (%%r11,%%r11,1),%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r13\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax,%%rbx\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx,%%rcx\n&quot;</span>
<span class="term-fg31">-    &#47;* d += a2 * a2 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r12,%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r12\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax,%%rbx\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx,%%rcx\n&quot;</span>
<span class="term-fg31">-    &#47;* d += c * R *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r8,%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;movq $0x1000003d10,%%rdx\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%rdx\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax,%%rbx\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx,%%rcx\n&quot;</span>
<span class="term-fg31">-    &#47;* t4 = d &amp; M (%%rsi) *&#47;</span>
<span class="term-fg31">-    &quot;movq %%rbx,%%rsi\n&quot;</span>
<span class="term-fg31">-    &quot;andq %%r15,%%rsi\n&quot;</span>
<span class="term-fg31">-    &#47;* d &gt;&gt;= 52 *&#47;</span>
<span class="term-fg31">-    &quot;shrdq $52,%%rcx,%%rbx\n&quot;</span>
<span class="term-fg31">-    &quot;xorq %%rcx,%%rcx\n&quot;</span>
<span class="term-fg31">-    &#47;* tx = t4 &gt;&gt; 48 (tmp3) *&#47;</span>
<span class="term-fg31">-    &quot;movq %%rsi,%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;shrq $48,%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;movq %%rax,%q3\n&quot;</span>
<span class="term-fg31">-    &#47;* t4 &amp;= (M &gt;&gt; 4) (tmp2) *&#47;</span>
<span class="term-fg31">-    &quot;movq $0xffffffffffff,%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;andq %%rax,%%rsi\n&quot;</span>
<span class="term-fg31">-    &quot;movq %%rsi,%q2\n&quot;</span>
<span class="term-fg31">-    &#47;* c = a0 * a0 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r10,%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r10\n&quot;</span>
<span class="term-fg31">-    &quot;movq %%rax,%%r8\n&quot;</span>
<span class="term-fg31">-    &quot;movq %%rdx,%%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* d += a1 * a4 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r11,%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r14\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax,%%rbx\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx,%%rcx\n&quot;</span>
<span class="term-fg31">-    &#47;* d += (a2*2) * a3 *&#47;</span>
<span class="term-fg31">-    &quot;leaq (%%r12,%%r12,1),%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r13\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax,%%rbx\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx,%%rcx\n&quot;</span>
<span class="term-fg31">-    &#47;* u0 = d &amp; M (%%rsi) *&#47;</span>
<span class="term-fg31">-    &quot;movq %%rbx,%%rsi\n&quot;</span>
<span class="term-fg31">-    &quot;andq %%r15,%%rsi\n&quot;</span>
<span class="term-fg31">-    &#47;* d &gt;&gt;= 52 *&#47;</span>
<span class="term-fg31">-    &quot;shrdq $52,%%rcx,%%rbx\n&quot;</span>
<span class="term-fg31">-    &quot;xorq %%rcx,%%rcx\n&quot;</span>
<span class="term-fg31">-    &#47;* u0 = (u0 &lt;&lt; 4) | tx (%%rsi) *&#47;</span>
<span class="term-fg31">-    &quot;shlq $4,%%rsi\n&quot;</span>
<span class="term-fg31">-    &quot;movq %q3,%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;orq %%rax,%%rsi\n&quot;</span>
<span class="term-fg31">-    &#47;* c += u0 * (R &gt;&gt; 4) *&#47;</span>
<span class="term-fg31">-    &quot;movq $0x1000003d1,%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%rsi\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax,%%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx,%%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* r[0] = c &amp; M *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r8,%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;andq %%r15,%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;movq %%rax,0(%%rdi)\n&quot;</span>
<span class="term-fg31">-    &#47;* c &gt;&gt;= 52 *&#47;</span>
<span class="term-fg31">-    &quot;shrdq $52,%%r9,%%r8\n&quot;</span>
<span class="term-fg31">-    &quot;xorq %%r9,%%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* a0 *= 2 *&#47;</span>
<span class="term-fg31">-    &quot;addq %%r10,%%r10\n&quot;</span>
<span class="term-fg31">-    &#47;* c += a0 * a1 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r10,%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r11\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax,%%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx,%%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* d += a2 * a4 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r12,%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r14\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax,%%rbx\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx,%%rcx\n&quot;</span>
<span class="term-fg31">-    &#47;* d += a3 * a3 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r13,%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r13\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax,%%rbx\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx,%%rcx\n&quot;</span>
<span class="term-fg31">-    &#47;* c += (d &amp; M) * R *&#47;</span>
<span class="term-fg31">-    &quot;movq %%rbx,%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;andq %%r15,%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;movq $0x1000003d10,%%rdx\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%rdx\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax,%%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx,%%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* d &gt;&gt;= 52 *&#47;</span>
<span class="term-fg31">-    &quot;shrdq $52,%%rcx,%%rbx\n&quot;</span>
<span class="term-fg31">-    &quot;xorq %%rcx,%%rcx\n&quot;</span>
<span class="term-fg31">-    &#47;* r[1] = c &amp; M *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r8,%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;andq %%r15,%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;movq %%rax,8(%%rdi)\n&quot;</span>
<span class="term-fg31">-    &#47;* c &gt;&gt;= 52 *&#47;</span>
<span class="term-fg31">-    &quot;shrdq $52,%%r9,%%r8\n&quot;</span>
<span class="term-fg31">-    &quot;xorq %%r9,%%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* c += a0 * a2 (last use of %%r10) *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r10,%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r12\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax,%%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx,%%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* fetch t3 (%%r10, overwrites a0),t4 (%%rsi) *&#47;</span>
<span class="term-fg31">-    &quot;movq %q2,%%rsi\n&quot;</span>
<span class="term-fg31">-    &quot;movq %q1,%%r10\n&quot;</span>
<span class="term-fg31">-    &#47;* c += a1 * a1 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r11,%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r11\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax,%%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx,%%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* d += a3 * a4 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r13,%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r14\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax,%%rbx\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx,%%rcx\n&quot;</span>
<span class="term-fg31">-    &#47;* c += (d &amp; M) * R *&#47;</span>
<span class="term-fg31">-    &quot;movq %%rbx,%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;andq %%r15,%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;movq $0x1000003d10,%%rdx\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%rdx\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax,%%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx,%%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* d &gt;&gt;= 52 (%%rbx only) *&#47;</span>
<span class="term-fg31">-    &quot;shrdq $52,%%rcx,%%rbx\n&quot;</span>
<span class="term-fg31">-    &#47;* r[2] = c &amp; M *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r8,%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;andq %%r15,%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;movq %%rax,16(%%rdi)\n&quot;</span>
<span class="term-fg31">-    &#47;* c &gt;&gt;= 52 *&#47;</span>
<span class="term-fg31">-    &quot;shrdq $52,%%r9,%%r8\n&quot;</span>
<span class="term-fg31">-    &quot;xorq %%r9,%%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* c += t3 *&#47;</span>
<span class="term-fg31">-    &quot;addq %%r10,%%r8\n&quot;</span>
<span class="term-fg31">-    &#47;* c += d * R *&#47;</span>
<span class="term-fg31">-    &quot;movq %%rbx,%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;movq $0x1000003d10,%%rdx\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%rdx\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax,%%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx,%%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* r[3] = c &amp; M *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r8,%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;andq %%r15,%%rax\n&quot;</span>
<span class="term-fg31">-    &quot;movq %%rax,24(%%rdi)\n&quot;</span>
<span class="term-fg31">-    &#47;* c &gt;&gt;= 52 (%%r8 only) *&#47;</span>
<span class="term-fg31">-    &quot;shrdq $52,%%r9,%%r8\n&quot;</span>
<span class="term-fg31">-    &#47;* c += t4 (%%r8 only) *&#47;</span>
<span class="term-fg31">-    &quot;addq %%rsi,%%r8\n&quot;</span>
<span class="term-fg31">-    &#47;* r[4] = c *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r8,32(%%rdi)\n&quot;</span>
<span class="term-fg31">-: &quot;+S&quot;(a), &quot;=m&quot;(tmp1), &quot;=m&quot;(tmp2), &quot;=m&quot;(tmp3)</span>
<span class="term-fg31">-: &quot;D&quot;(r)</span>
<span class="term-fg31">-: &quot;%rax&quot;, &quot;%rbx&quot;, &quot;%rcx&quot;, &quot;%rdx&quot;, &quot;%r8&quot;, &quot;%r9&quot;, &quot;%r10&quot;, &quot;%r11&quot;, &quot;%r12&quot;, &quot;%r13&quot;, &quot;%r14&quot;, &quot;%r15&quot;, &quot;cc&quot;, &quot;memory&quot;</span>
<span class="term-fg31">-);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-062b808f48340b82ad3a0e20" role="button"
                       aria-expanded="false" aria-controls="id-062b808f48340b82ad3a0e20">
                        <code>crypto/secp256k1/libsecp256k1/src/field_5x52_impl.h</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/field_5x52_impl.h" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-451</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-062b808f48340b82ad3a0e20"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;field_5x52_impl.h op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;field_5x52_impl.h</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index dd88f38c77bbc5f0b86772b8d680c3f769e05a11..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;field_5x52_impl.h</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,451 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2013, 2014 Pieter Wuille                             *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef _SECP256K1_FIELD_REPR_IMPL_H_</span>
<span class="term-fg31">-#define _SECP256K1_FIELD_REPR_IMPL_H_</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#if defined HAVE_CONFIG_H</span>
<span class="term-fg31">-#include &quot;libsecp256k1-config.h&quot;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &quot;util.h&quot;</span>
<span class="term-fg31">-#include &quot;num.h&quot;</span>
<span class="term-fg31">-#include &quot;field.h&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#if defined(USE_ASM_X86_64)</span>
<span class="term-fg31">-#include &quot;field_5x52_asm_impl.h&quot;</span>
<span class="term-fg31">-#else</span>
<span class="term-fg31">-#include &quot;field_5x52_int128_impl.h&quot;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Implements arithmetic modulo FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFE FFFFFC2F,</span>
<span class="term-fg31">- *  represented as 5 uint64_t&#39;s in base 2^52. The values are allowed to contain &gt;52 each. In particular,</span>
<span class="term-fg31">- *  each FieldElem has a &#39;magnitude&#39; associated with it. Internally, a magnitude M means each element</span>
<span class="term-fg31">- *  is at most M*(2^53-1), except the most significant one, which is limited to M*(2^49-1). All operations</span>
<span class="term-fg31">- *  accept any input with magnitude at most M, and have different rules for propagating magnitude to their</span>
<span class="term-fg31">- *  output.</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-static void secp256k1_fe_verify(const secp256k1_fe *a) {</span>
<span class="term-fg31">-    const uint64_t *d = a-&gt;n;</span>
<span class="term-fg31">-    int m = a-&gt;normalized ? 1 : 2 * a-&gt;magnitude, r = 1;</span>
<span class="term-fg31">-   &#47;* secp256k1 &#39;p&#39; value defined in &quot;Standards for Efficient Cryptography&quot; (SEC2) 2.7.1. *&#47;</span>
<span class="term-fg31">-    r &amp;= (d[0] &lt;= 0xFFFFFFFFFFFFFULL * m);</span>
<span class="term-fg31">-    r &amp;= (d[1] &lt;= 0xFFFFFFFFFFFFFULL * m);</span>
<span class="term-fg31">-    r &amp;= (d[2] &lt;= 0xFFFFFFFFFFFFFULL * m);</span>
<span class="term-fg31">-    r &amp;= (d[3] &lt;= 0xFFFFFFFFFFFFFULL * m);</span>
<span class="term-fg31">-    r &amp;= (d[4] &lt;= 0x0FFFFFFFFFFFFULL * m);</span>
<span class="term-fg31">-    r &amp;= (a-&gt;magnitude &gt;= 0);</span>
<span class="term-fg31">-    r &amp;= (a-&gt;magnitude &lt;= 2048);</span>
<span class="term-fg31">-    if (a-&gt;normalized) {</span>
<span class="term-fg31">-        r &amp;= (a-&gt;magnitude &lt;= 1);</span>
<span class="term-fg31">-        if (r &amp;&amp; (d[4] == 0x0FFFFFFFFFFFFULL) &amp;&amp; ((d[3] &amp; d[2] &amp; d[1]) == 0xFFFFFFFFFFFFFULL)) {</span>
<span class="term-fg31">-            r &amp;= (d[0] &lt; 0xFFFFEFFFFFC2FULL);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    VERIFY_CHECK(r == 1);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_fe_normalize(secp256k1_fe *r) {</span>
<span class="term-fg31">-    uint64_t t0 = r-&gt;n[0], t1 = r-&gt;n[1], t2 = r-&gt;n[2], t3 = r-&gt;n[3], t4 = r-&gt;n[4];</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Reduce t4 at the start so there will be at most a single carry from the first pass *&#47;</span>
<span class="term-fg31">-    uint64_t m;</span>
<span class="term-fg31">-    uint64_t x = t4 &gt;&gt; 48; t4 &amp;= 0x0FFFFFFFFFFFFULL;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* The first pass ensures the magnitude is 1, ... *&#47;</span>
<span class="term-fg31">-    t0 += x * 0x1000003D1ULL;</span>
<span class="term-fg31">-    t1 += (t0 &gt;&gt; 52); t0 &amp;= 0xFFFFFFFFFFFFFULL;</span>
<span class="term-fg31">-    t2 += (t1 &gt;&gt; 52); t1 &amp;= 0xFFFFFFFFFFFFFULL; m = t1;</span>
<span class="term-fg31">-    t3 += (t2 &gt;&gt; 52); t2 &amp;= 0xFFFFFFFFFFFFFULL; m &amp;= t2;</span>
<span class="term-fg31">-    t4 += (t3 &gt;&gt; 52); t3 &amp;= 0xFFFFFFFFFFFFFULL; m &amp;= t3;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* ... except for a possible carry at bit 48 of t4 (i.e. bit 256 of the field element) *&#47;</span>
<span class="term-fg31">-    VERIFY_CHECK(t4 &gt;&gt; 49 == 0);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* At most a single final reduction is needed; check if the value is &gt;= the field characteristic *&#47;</span>
<span class="term-fg31">-    x = (t4 &gt;&gt; 48) | ((t4 == 0x0FFFFFFFFFFFFULL) &amp; (m == 0xFFFFFFFFFFFFFULL)</span>
<span class="term-fg31">-        &amp; (t0 &gt;= 0xFFFFEFFFFFC2FULL));</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Apply the final reduction (for constant-time behaviour, we do it always) *&#47;</span>
<span class="term-fg31">-    t0 += x * 0x1000003D1ULL;</span>
<span class="term-fg31">-    t1 += (t0 &gt;&gt; 52); t0 &amp;= 0xFFFFFFFFFFFFFULL;</span>
<span class="term-fg31">-    t2 += (t1 &gt;&gt; 52); t1 &amp;= 0xFFFFFFFFFFFFFULL;</span>
<span class="term-fg31">-    t3 += (t2 &gt;&gt; 52); t2 &amp;= 0xFFFFFFFFFFFFFULL;</span>
<span class="term-fg31">-    t4 += (t3 &gt;&gt; 52); t3 &amp;= 0xFFFFFFFFFFFFFULL;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* If t4 didn&#39;t carry to bit 48 already, then it should have after any final reduction *&#47;</span>
<span class="term-fg31">-    VERIFY_CHECK(t4 &gt;&gt; 48 == x);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Mask off the possible multiple of 2^256 from the final reduction *&#47;</span>
<span class="term-fg31">-    t4 &amp;= 0x0FFFFFFFFFFFFULL;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    r-&gt;n[0] = t0; r-&gt;n[1] = t1; r-&gt;n[2] = t2; r-&gt;n[3] = t3; r-&gt;n[4] = t4;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-    r-&gt;magnitude = 1;</span>
<span class="term-fg31">-    r-&gt;normalized = 1;</span>
<span class="term-fg31">-    secp256k1_fe_verify(r);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_fe_normalize_weak(secp256k1_fe *r) {</span>
<span class="term-fg31">-    uint64_t t0 = r-&gt;n[0], t1 = r-&gt;n[1], t2 = r-&gt;n[2], t3 = r-&gt;n[3], t4 = r-&gt;n[4];</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Reduce t4 at the start so there will be at most a single carry from the first pass *&#47;</span>
<span class="term-fg31">-    uint64_t x = t4 &gt;&gt; 48; t4 &amp;= 0x0FFFFFFFFFFFFULL;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* The first pass ensures the magnitude is 1, ... *&#47;</span>
<span class="term-fg31">-    t0 += x * 0x1000003D1ULL;</span>
<span class="term-fg31">-    t1 += (t0 &gt;&gt; 52); t0 &amp;= 0xFFFFFFFFFFFFFULL;</span>
<span class="term-fg31">-    t2 += (t1 &gt;&gt; 52); t1 &amp;= 0xFFFFFFFFFFFFFULL;</span>
<span class="term-fg31">-    t3 += (t2 &gt;&gt; 52); t2 &amp;= 0xFFFFFFFFFFFFFULL;</span>
<span class="term-fg31">-    t4 += (t3 &gt;&gt; 52); t3 &amp;= 0xFFFFFFFFFFFFFULL;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* ... except for a possible carry at bit 48 of t4 (i.e. bit 256 of the field element) *&#47;</span>
<span class="term-fg31">-    VERIFY_CHECK(t4 &gt;&gt; 49 == 0);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    r-&gt;n[0] = t0; r-&gt;n[1] = t1; r-&gt;n[2] = t2; r-&gt;n[3] = t3; r-&gt;n[4] = t4;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-    r-&gt;magnitude = 1;</span>
<span class="term-fg31">-    secp256k1_fe_verify(r);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_fe_normalize_var(secp256k1_fe *r) {</span>
<span class="term-fg31">-    uint64_t t0 = r-&gt;n[0], t1 = r-&gt;n[1], t2 = r-&gt;n[2], t3 = r-&gt;n[3], t4 = r-&gt;n[4];</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Reduce t4 at the start so there will be at most a single carry from the first pass *&#47;</span>
<span class="term-fg31">-    uint64_t m;</span>
<span class="term-fg31">-    uint64_t x = t4 &gt;&gt; 48; t4 &amp;= 0x0FFFFFFFFFFFFULL;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* The first pass ensures the magnitude is 1, ... *&#47;</span>
<span class="term-fg31">-    t0 += x * 0x1000003D1ULL;</span>
<span class="term-fg31">-    t1 += (t0 &gt;&gt; 52); t0 &amp;= 0xFFFFFFFFFFFFFULL;</span>
<span class="term-fg31">-    t2 += (t1 &gt;&gt; 52); t1 &amp;= 0xFFFFFFFFFFFFFULL; m = t1;</span>
<span class="term-fg31">-    t3 += (t2 &gt;&gt; 52); t2 &amp;= 0xFFFFFFFFFFFFFULL; m &amp;= t2;</span>
<span class="term-fg31">-    t4 += (t3 &gt;&gt; 52); t3 &amp;= 0xFFFFFFFFFFFFFULL; m &amp;= t3;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* ... except for a possible carry at bit 48 of t4 (i.e. bit 256 of the field element) *&#47;</span>
<span class="term-fg31">-    VERIFY_CHECK(t4 &gt;&gt; 49 == 0);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* At most a single final reduction is needed; check if the value is &gt;= the field characteristic *&#47;</span>
<span class="term-fg31">-    x = (t4 &gt;&gt; 48) | ((t4 == 0x0FFFFFFFFFFFFULL) &amp; (m == 0xFFFFFFFFFFFFFULL)</span>
<span class="term-fg31">-        &amp; (t0 &gt;= 0xFFFFEFFFFFC2FULL));</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    if (x) {</span>
<span class="term-fg31">-        t0 += 0x1000003D1ULL;</span>
<span class="term-fg31">-        t1 += (t0 &gt;&gt; 52); t0 &amp;= 0xFFFFFFFFFFFFFULL;</span>
<span class="term-fg31">-        t2 += (t1 &gt;&gt; 52); t1 &amp;= 0xFFFFFFFFFFFFFULL;</span>
<span class="term-fg31">-        t3 += (t2 &gt;&gt; 52); t2 &amp;= 0xFFFFFFFFFFFFFULL;</span>
<span class="term-fg31">-        t4 += (t3 &gt;&gt; 52); t3 &amp;= 0xFFFFFFFFFFFFFULL;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        &#47;* If t4 didn&#39;t carry to bit 48 already, then it should have after any final reduction *&#47;</span>
<span class="term-fg31">-        VERIFY_CHECK(t4 &gt;&gt; 48 == x);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        &#47;* Mask off the possible multiple of 2^256 from the final reduction *&#47;</span>
<span class="term-fg31">-        t4 &amp;= 0x0FFFFFFFFFFFFULL;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    r-&gt;n[0] = t0; r-&gt;n[1] = t1; r-&gt;n[2] = t2; r-&gt;n[3] = t3; r-&gt;n[4] = t4;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-    r-&gt;magnitude = 1;</span>
<span class="term-fg31">-    r-&gt;normalized = 1;</span>
<span class="term-fg31">-    secp256k1_fe_verify(r);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_fe_normalizes_to_zero(secp256k1_fe *r) {</span>
<span class="term-fg31">-    uint64_t t0 = r-&gt;n[0], t1 = r-&gt;n[1], t2 = r-&gt;n[2], t3 = r-&gt;n[3], t4 = r-&gt;n[4];</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* z0 tracks a possible raw value of 0, z1 tracks a possible raw value of P *&#47;</span>
<span class="term-fg31">-    uint64_t z0, z1;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Reduce t4 at the start so there will be at most a single carry from the first pass *&#47;</span>
<span class="term-fg31">-    uint64_t x = t4 &gt;&gt; 48; t4 &amp;= 0x0FFFFFFFFFFFFULL;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* The first pass ensures the magnitude is 1, ... *&#47;</span>
<span class="term-fg31">-    t0 += x * 0x1000003D1ULL;</span>
<span class="term-fg31">-    t1 += (t0 &gt;&gt; 52); t0 &amp;= 0xFFFFFFFFFFFFFULL; z0  = t0; z1  = t0 ^ 0x1000003D0ULL;</span>
<span class="term-fg31">-    t2 += (t1 &gt;&gt; 52); t1 &amp;= 0xFFFFFFFFFFFFFULL; z0 |= t1; z1 &amp;= t1;</span>
<span class="term-fg31">-    t3 += (t2 &gt;&gt; 52); t2 &amp;= 0xFFFFFFFFFFFFFULL; z0 |= t2; z1 &amp;= t2;</span>
<span class="term-fg31">-    t4 += (t3 &gt;&gt; 52); t3 &amp;= 0xFFFFFFFFFFFFFULL; z0 |= t3; z1 &amp;= t3;</span>
<span class="term-fg31">-                                                z0 |= t4; z1 &amp;= t4 ^ 0xF000000000000ULL;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* ... except for a possible carry at bit 48 of t4 (i.e. bit 256 of the field element) *&#47;</span>
<span class="term-fg31">-    VERIFY_CHECK(t4 &gt;&gt; 49 == 0);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    return (z0 == 0) | (z1 == 0xFFFFFFFFFFFFFULL);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_fe_normalizes_to_zero_var(secp256k1_fe *r) {</span>
<span class="term-fg31">-    uint64_t t0, t1, t2, t3, t4;</span>
<span class="term-fg31">-    uint64_t z0, z1;</span>
<span class="term-fg31">-    uint64_t x;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    t0 = r-&gt;n[0];</span>
<span class="term-fg31">-    t4 = r-&gt;n[4];</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Reduce t4 at the start so there will be at most a single carry from the first pass *&#47;</span>
<span class="term-fg31">-    x = t4 &gt;&gt; 48;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* The first pass ensures the magnitude is 1, ... *&#47;</span>
<span class="term-fg31">-    t0 += x * 0x1000003D1ULL;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* z0 tracks a possible raw value of 0, z1 tracks a possible raw value of P *&#47;</span>
<span class="term-fg31">-    z0 = t0 &amp; 0xFFFFFFFFFFFFFULL;</span>
<span class="term-fg31">-    z1 = z0 ^ 0x1000003D0ULL;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Fast return path should catch the majority of cases *&#47;</span>
<span class="term-fg31">-    if ((z0 != 0ULL) &amp; (z1 != 0xFFFFFFFFFFFFFULL)) {</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    t1 = r-&gt;n[1];</span>
<span class="term-fg31">-    t2 = r-&gt;n[2];</span>
<span class="term-fg31">-    t3 = r-&gt;n[3];</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    t4 &amp;= 0x0FFFFFFFFFFFFULL;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    t1 += (t0 &gt;&gt; 52);</span>
<span class="term-fg31">-    t2 += (t1 &gt;&gt; 52); t1 &amp;= 0xFFFFFFFFFFFFFULL; z0 |= t1; z1 &amp;= t1;</span>
<span class="term-fg31">-    t3 += (t2 &gt;&gt; 52); t2 &amp;= 0xFFFFFFFFFFFFFULL; z0 |= t2; z1 &amp;= t2;</span>
<span class="term-fg31">-    t4 += (t3 &gt;&gt; 52); t3 &amp;= 0xFFFFFFFFFFFFFULL; z0 |= t3; z1 &amp;= t3;</span>
<span class="term-fg31">-                                                z0 |= t4; z1 &amp;= t4 ^ 0xF000000000000ULL;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* ... except for a possible carry at bit 48 of t4 (i.e. bit 256 of the field element) *&#47;</span>
<span class="term-fg31">-    VERIFY_CHECK(t4 &gt;&gt; 49 == 0);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    return (z0 == 0) | (z1 == 0xFFFFFFFFFFFFFULL);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static void secp256k1_fe_set_int(secp256k1_fe *r, int a) {</span>
<span class="term-fg31">-    r-&gt;n[0] = a;</span>
<span class="term-fg31">-    r-&gt;n[1] = r-&gt;n[2] = r-&gt;n[3] = r-&gt;n[4] = 0;</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-    r-&gt;magnitude = 1;</span>
<span class="term-fg31">-    r-&gt;normalized = 1;</span>
<span class="term-fg31">-    secp256k1_fe_verify(r);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static int secp256k1_fe_is_zero(const secp256k1_fe *a) {</span>
<span class="term-fg31">-    const uint64_t *t = a-&gt;n;</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-    VERIFY_CHECK(a-&gt;normalized);</span>
<span class="term-fg31">-    secp256k1_fe_verify(a);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-    return (t[0] | t[1] | t[2] | t[3] | t[4]) == 0;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static int secp256k1_fe_is_odd(const secp256k1_fe *a) {</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-    VERIFY_CHECK(a-&gt;normalized);</span>
<span class="term-fg31">-    secp256k1_fe_verify(a);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-    return a-&gt;n[0] &amp; 1;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static void secp256k1_fe_clear(secp256k1_fe *a) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-    a-&gt;magnitude = 0;</span>
<span class="term-fg31">-    a-&gt;normalized = 1;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-    for (i=0; i&lt;5; i++) {</span>
<span class="term-fg31">-        a-&gt;n[i] = 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_fe_cmp_var(const secp256k1_fe *a, const secp256k1_fe *b) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-    VERIFY_CHECK(a-&gt;normalized);</span>
<span class="term-fg31">-    VERIFY_CHECK(b-&gt;normalized);</span>
<span class="term-fg31">-    secp256k1_fe_verify(a);</span>
<span class="term-fg31">-    secp256k1_fe_verify(b);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-    for (i = 4; i &gt;= 0; i--) {</span>
<span class="term-fg31">-        if (a-&gt;n[i] &gt; b-&gt;n[i]) {</span>
<span class="term-fg31">-            return 1;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        if (a-&gt;n[i] &lt; b-&gt;n[i]) {</span>
<span class="term-fg31">-            return -1;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    return 0;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_fe_set_b32(secp256k1_fe *r, const unsigned char *a) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    r-&gt;n[0] = r-&gt;n[1] = r-&gt;n[2] = r-&gt;n[3] = r-&gt;n[4] = 0;</span>
<span class="term-fg31">-    for (i=0; i&lt;32; i++) {</span>
<span class="term-fg31">-        int j;</span>
<span class="term-fg31">-        for (j=0; j&lt;2; j++) {</span>
<span class="term-fg31">-            int limb = (8*i+4*j)&#47;52;</span>
<span class="term-fg31">-            int shift = (8*i+4*j)%52;</span>
<span class="term-fg31">-            r-&gt;n[limb] |= (uint64_t)((a[31-i] &gt;&gt; (4*j)) &amp; 0xF) &lt;&lt; shift;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    if (r-&gt;n[4] == 0x0FFFFFFFFFFFFULL &amp;&amp; (r-&gt;n[3] &amp; r-&gt;n[2] &amp; r-&gt;n[1]) == 0xFFFFFFFFFFFFFULL &amp;&amp; r-&gt;n[0] &gt;= 0xFFFFEFFFFFC2FULL) {</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-    r-&gt;magnitude = 1;</span>
<span class="term-fg31">-    r-&gt;normalized = 1;</span>
<span class="term-fg31">-    secp256k1_fe_verify(r);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-    return 1;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Convert a field element to a 32-byte big endian value. Requires the input to be normalized *&#47;</span>
<span class="term-fg31">-static void secp256k1_fe_get_b32(unsigned char *r, const secp256k1_fe *a) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-    VERIFY_CHECK(a-&gt;normalized);</span>
<span class="term-fg31">-    secp256k1_fe_verify(a);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-    for (i=0; i&lt;32; i++) {</span>
<span class="term-fg31">-        int j;</span>
<span class="term-fg31">-        int c = 0;</span>
<span class="term-fg31">-        for (j=0; j&lt;2; j++) {</span>
<span class="term-fg31">-            int limb = (8*i+4*j)&#47;52;</span>
<span class="term-fg31">-            int shift = (8*i+4*j)%52;</span>
<span class="term-fg31">-            c |= ((a-&gt;n[limb] &gt;&gt; shift) &amp; 0xF) &lt;&lt; (4 * j);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        r[31-i] = c;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static void secp256k1_fe_negate(secp256k1_fe *r, const secp256k1_fe *a, int m) {</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-    VERIFY_CHECK(a-&gt;magnitude &lt;= m);</span>
<span class="term-fg31">-    secp256k1_fe_verify(a);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-    r-&gt;n[0] = 0xFFFFEFFFFFC2FULL * 2 * (m + 1) - a-&gt;n[0];</span>
<span class="term-fg31">-    r-&gt;n[1] = 0xFFFFFFFFFFFFFULL * 2 * (m + 1) - a-&gt;n[1];</span>
<span class="term-fg31">-    r-&gt;n[2] = 0xFFFFFFFFFFFFFULL * 2 * (m + 1) - a-&gt;n[2];</span>
<span class="term-fg31">-    r-&gt;n[3] = 0xFFFFFFFFFFFFFULL * 2 * (m + 1) - a-&gt;n[3];</span>
<span class="term-fg31">-    r-&gt;n[4] = 0x0FFFFFFFFFFFFULL * 2 * (m + 1) - a-&gt;n[4];</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-    r-&gt;magnitude = m + 1;</span>
<span class="term-fg31">-    r-&gt;normalized = 0;</span>
<span class="term-fg31">-    secp256k1_fe_verify(r);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static void secp256k1_fe_mul_int(secp256k1_fe *r, int a) {</span>
<span class="term-fg31">-    r-&gt;n[0] *= a;</span>
<span class="term-fg31">-    r-&gt;n[1] *= a;</span>
<span class="term-fg31">-    r-&gt;n[2] *= a;</span>
<span class="term-fg31">-    r-&gt;n[3] *= a;</span>
<span class="term-fg31">-    r-&gt;n[4] *= a;</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-    r-&gt;magnitude *= a;</span>
<span class="term-fg31">-    r-&gt;normalized = 0;</span>
<span class="term-fg31">-    secp256k1_fe_verify(r);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static void secp256k1_fe_add(secp256k1_fe *r, const secp256k1_fe *a) {</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-    secp256k1_fe_verify(a);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-    r-&gt;n[0] += a-&gt;n[0];</span>
<span class="term-fg31">-    r-&gt;n[1] += a-&gt;n[1];</span>
<span class="term-fg31">-    r-&gt;n[2] += a-&gt;n[2];</span>
<span class="term-fg31">-    r-&gt;n[3] += a-&gt;n[3];</span>
<span class="term-fg31">-    r-&gt;n[4] += a-&gt;n[4];</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-    r-&gt;magnitude += a-&gt;magnitude;</span>
<span class="term-fg31">-    r-&gt;normalized = 0;</span>
<span class="term-fg31">-    secp256k1_fe_verify(r);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_fe_mul(secp256k1_fe *r, const secp256k1_fe *a, const secp256k1_fe * SECP256K1_RESTRICT b) {</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-    VERIFY_CHECK(a-&gt;magnitude &lt;= 8);</span>
<span class="term-fg31">-    VERIFY_CHECK(b-&gt;magnitude &lt;= 8);</span>
<span class="term-fg31">-    secp256k1_fe_verify(a);</span>
<span class="term-fg31">-    secp256k1_fe_verify(b);</span>
<span class="term-fg31">-    VERIFY_CHECK(r != b);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-    secp256k1_fe_mul_inner(r-&gt;n, a-&gt;n, b-&gt;n);</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-    r-&gt;magnitude = 1;</span>
<span class="term-fg31">-    r-&gt;normalized = 0;</span>
<span class="term-fg31">-    secp256k1_fe_verify(r);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_fe_sqr(secp256k1_fe *r, const secp256k1_fe *a) {</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-    VERIFY_CHECK(a-&gt;magnitude &lt;= 8);</span>
<span class="term-fg31">-    secp256k1_fe_verify(a);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-    secp256k1_fe_sqr_inner(r-&gt;n, a-&gt;n);</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-    r-&gt;magnitude = 1;</span>
<span class="term-fg31">-    r-&gt;normalized = 0;</span>
<span class="term-fg31">-    secp256k1_fe_verify(r);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static SECP256K1_INLINE void secp256k1_fe_cmov(secp256k1_fe *r, const secp256k1_fe *a, int flag) {</span>
<span class="term-fg31">-    uint64_t mask0, mask1;</span>
<span class="term-fg31">-    mask0 = flag + ~((uint64_t)0);</span>
<span class="term-fg31">-    mask1 = ~mask0;</span>
<span class="term-fg31">-    r-&gt;n[0] = (r-&gt;n[0] &amp; mask0) | (a-&gt;n[0] &amp; mask1);</span>
<span class="term-fg31">-    r-&gt;n[1] = (r-&gt;n[1] &amp; mask0) | (a-&gt;n[1] &amp; mask1);</span>
<span class="term-fg31">-    r-&gt;n[2] = (r-&gt;n[2] &amp; mask0) | (a-&gt;n[2] &amp; mask1);</span>
<span class="term-fg31">-    r-&gt;n[3] = (r-&gt;n[3] &amp; mask0) | (a-&gt;n[3] &amp; mask1);</span>
<span class="term-fg31">-    r-&gt;n[4] = (r-&gt;n[4] &amp; mask0) | (a-&gt;n[4] &amp; mask1);</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-    if (a-&gt;magnitude &gt; r-&gt;magnitude) {</span>
<span class="term-fg31">-        r-&gt;magnitude = a-&gt;magnitude;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    r-&gt;normalized &amp;= a-&gt;normalized;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static SECP256K1_INLINE void secp256k1_fe_storage_cmov(secp256k1_fe_storage *r, const secp256k1_fe_storage *a, int flag) {</span>
<span class="term-fg31">-    uint64_t mask0, mask1;</span>
<span class="term-fg31">-    mask0 = flag + ~((uint64_t)0);</span>
<span class="term-fg31">-    mask1 = ~mask0;</span>
<span class="term-fg31">-    r-&gt;n[0] = (r-&gt;n[0] &amp; mask0) | (a-&gt;n[0] &amp; mask1);</span>
<span class="term-fg31">-    r-&gt;n[1] = (r-&gt;n[1] &amp; mask0) | (a-&gt;n[1] &amp; mask1);</span>
<span class="term-fg31">-    r-&gt;n[2] = (r-&gt;n[2] &amp; mask0) | (a-&gt;n[2] &amp; mask1);</span>
<span class="term-fg31">-    r-&gt;n[3] = (r-&gt;n[3] &amp; mask0) | (a-&gt;n[3] &amp; mask1);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_fe_to_storage(secp256k1_fe_storage *r, const secp256k1_fe *a) {</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-    VERIFY_CHECK(a-&gt;normalized);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-    r-&gt;n[0] = a-&gt;n[0] | a-&gt;n[1] &lt;&lt; 52;</span>
<span class="term-fg31">-    r-&gt;n[1] = a-&gt;n[1] &gt;&gt; 12 | a-&gt;n[2] &lt;&lt; 40;</span>
<span class="term-fg31">-    r-&gt;n[2] = a-&gt;n[2] &gt;&gt; 24 | a-&gt;n[3] &lt;&lt; 28;</span>
<span class="term-fg31">-    r-&gt;n[3] = a-&gt;n[3] &gt;&gt; 36 | a-&gt;n[4] &lt;&lt; 16;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static SECP256K1_INLINE void secp256k1_fe_from_storage(secp256k1_fe *r, const secp256k1_fe_storage *a) {</span>
<span class="term-fg31">-    r-&gt;n[0] = a-&gt;n[0] &amp; 0xFFFFFFFFFFFFFULL;</span>
<span class="term-fg31">-    r-&gt;n[1] = a-&gt;n[0] &gt;&gt; 52 | ((a-&gt;n[1] &lt;&lt; 12) &amp; 0xFFFFFFFFFFFFFULL);</span>
<span class="term-fg31">-    r-&gt;n[2] = a-&gt;n[1] &gt;&gt; 40 | ((a-&gt;n[2] &lt;&lt; 24) &amp; 0xFFFFFFFFFFFFFULL);</span>
<span class="term-fg31">-    r-&gt;n[3] = a-&gt;n[2] &gt;&gt; 28 | ((a-&gt;n[3] &lt;&lt; 36) &amp; 0xFFFFFFFFFFFFFULL);</span>
<span class="term-fg31">-    r-&gt;n[4] = a-&gt;n[3] &gt;&gt; 16;</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-    r-&gt;magnitude = 1;</span>
<span class="term-fg31">-    r-&gt;normalized = 1;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-223acd7ff7fe24ca2272c548" role="button"
                       aria-expanded="false" aria-controls="id-223acd7ff7fe24ca2272c548">
                        <code>crypto/secp256k1/libsecp256k1/src/field_5x52_int128_impl.h</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/field_5x52_int128_impl.h" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-277</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-223acd7ff7fe24ca2272c548"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;field_5x52_int128_impl.h op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;field_5x52_int128_impl.h</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 0bf22bdd3ec887251346dac826291fd1432c13ce..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;field_5x52_int128_impl.h</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,277 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2013, 2014 Pieter Wuille                             *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef _SECP256K1_FIELD_INNER5X52_IMPL_H_</span>
<span class="term-fg31">-#define _SECP256K1_FIELD_INNER5X52_IMPL_H_</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &lt;stdint.h&gt;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-#define VERIFY_BITS(x, n) VERIFY_CHECK(((x) &gt;&gt; (n)) == 0)</span>
<span class="term-fg31">-#else</span>
<span class="term-fg31">-#define VERIFY_BITS(x, n) do { } while(0)</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static void secp256k1_fe_mul_inner(uint64_t *r, const uint64_t *a, const uint64_t * SECP256K1_RESTRICT b) {</span>
<span class="term-fg31">-    uint128_t c, d;</span>
<span class="term-fg31">-    uint64_t t3, t4, tx, u0;</span>
<span class="term-fg31">-    uint64_t a0 = a[0], a1 = a[1], a2 = a[2], a3 = a[3], a4 = a[4];</span>
<span class="term-fg31">-    const uint64_t M = 0xFFFFFFFFFFFFFULL, R = 0x1000003D10ULL;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    VERIFY_BITS(a[0], 56);</span>
<span class="term-fg31">-    VERIFY_BITS(a[1], 56);</span>
<span class="term-fg31">-    VERIFY_BITS(a[2], 56);</span>
<span class="term-fg31">-    VERIFY_BITS(a[3], 56);</span>
<span class="term-fg31">-    VERIFY_BITS(a[4], 52);</span>
<span class="term-fg31">-    VERIFY_BITS(b[0], 56);</span>
<span class="term-fg31">-    VERIFY_BITS(b[1], 56);</span>
<span class="term-fg31">-    VERIFY_BITS(b[2], 56);</span>
<span class="term-fg31">-    VERIFY_BITS(b[3], 56);</span>
<span class="term-fg31">-    VERIFY_BITS(b[4], 52);</span>
<span class="term-fg31">-    VERIFY_CHECK(r != b);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;*  [... a b c] is a shorthand for ... + a&lt;&lt;104 + b&lt;&lt;52 + c&lt;&lt;0 mod n.</span>
<span class="term-fg31">-     *  px is a shorthand for sum(a[i]*b[x-i], i=0..x).</span>
<span class="term-fg31">-     *  Note that [x 0 0 0 0 0] = [x*R].</span>
<span class="term-fg31">-     *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    d  = (uint128_t)a0 * b[3]</span>
<span class="term-fg31">-       + (uint128_t)a1 * b[2]</span>
<span class="term-fg31">-       + (uint128_t)a2 * b[1]</span>
<span class="term-fg31">-       + (uint128_t)a3 * b[0];</span>
<span class="term-fg31">-    VERIFY_BITS(d, 114);</span>
<span class="term-fg31">-    &#47;* [d 0 0 0] = [p3 0 0 0] *&#47;</span>
<span class="term-fg31">-    c  = (uint128_t)a4 * b[4];</span>
<span class="term-fg31">-    VERIFY_BITS(c, 112);</span>
<span class="term-fg31">-    &#47;* [c 0 0 0 0 d 0 0 0] = [p8 0 0 0 0 p3 0 0 0] *&#47;</span>
<span class="term-fg31">-    d += (c &amp; M) * R; c &gt;&gt;= 52;</span>
<span class="term-fg31">-    VERIFY_BITS(d, 115);</span>
<span class="term-fg31">-    VERIFY_BITS(c, 60);</span>
<span class="term-fg31">-    &#47;* [c 0 0 0 0 0 d 0 0 0] = [p8 0 0 0 0 p3 0 0 0] *&#47;</span>
<span class="term-fg31">-    t3 = d &amp; M; d &gt;&gt;= 52;</span>
<span class="term-fg31">-    VERIFY_BITS(t3, 52);</span>
<span class="term-fg31">-    VERIFY_BITS(d, 63);</span>
<span class="term-fg31">-    &#47;* [c 0 0 0 0 d t3 0 0 0] = [p8 0 0 0 0 p3 0 0 0] *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    d += (uint128_t)a0 * b[4]</span>
<span class="term-fg31">-       + (uint128_t)a1 * b[3]</span>
<span class="term-fg31">-       + (uint128_t)a2 * b[2]</span>
<span class="term-fg31">-       + (uint128_t)a3 * b[1]</span>
<span class="term-fg31">-       + (uint128_t)a4 * b[0];</span>
<span class="term-fg31">-    VERIFY_BITS(d, 115);</span>
<span class="term-fg31">-    &#47;* [c 0 0 0 0 d t3 0 0 0] = [p8 0 0 0 p4 p3 0 0 0] *&#47;</span>
<span class="term-fg31">-    d += c * R;</span>
<span class="term-fg31">-    VERIFY_BITS(d, 116);</span>
<span class="term-fg31">-    &#47;* [d t3 0 0 0] = [p8 0 0 0 p4 p3 0 0 0] *&#47;</span>
<span class="term-fg31">-    t4 = d &amp; M; d &gt;&gt;= 52;</span>
<span class="term-fg31">-    VERIFY_BITS(t4, 52);</span>
<span class="term-fg31">-    VERIFY_BITS(d, 64);</span>
<span class="term-fg31">-    &#47;* [d t4 t3 0 0 0] = [p8 0 0 0 p4 p3 0 0 0] *&#47;</span>
<span class="term-fg31">-    tx = (t4 &gt;&gt; 48); t4 &amp;= (M &gt;&gt; 4);</span>
<span class="term-fg31">-    VERIFY_BITS(tx, 4);</span>
<span class="term-fg31">-    VERIFY_BITS(t4, 48);</span>
<span class="term-fg31">-    &#47;* [d t4+(tx&lt;&lt;48) t3 0 0 0] = [p8 0 0 0 p4 p3 0 0 0] *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    c  = (uint128_t)a0 * b[0];</span>
<span class="term-fg31">-    VERIFY_BITS(c, 112);</span>
<span class="term-fg31">-    &#47;* [d t4+(tx&lt;&lt;48) t3 0 0 c] = [p8 0 0 0 p4 p3 0 0 p0] *&#47;</span>
<span class="term-fg31">-    d += (uint128_t)a1 * b[4]</span>
<span class="term-fg31">-       + (uint128_t)a2 * b[3]</span>
<span class="term-fg31">-       + (uint128_t)a3 * b[2]</span>
<span class="term-fg31">-       + (uint128_t)a4 * b[1];</span>
<span class="term-fg31">-    VERIFY_BITS(d, 115);</span>
<span class="term-fg31">-    &#47;* [d t4+(tx&lt;&lt;48) t3 0 0 c] = [p8 0 0 p5 p4 p3 0 0 p0] *&#47;</span>
<span class="term-fg31">-    u0 = d &amp; M; d &gt;&gt;= 52;</span>
<span class="term-fg31">-    VERIFY_BITS(u0, 52);</span>
<span class="term-fg31">-    VERIFY_BITS(d, 63);</span>
<span class="term-fg31">-    &#47;* [d u0 t4+(tx&lt;&lt;48) t3 0 0 c] = [p8 0 0 p5 p4 p3 0 0 p0] *&#47;</span>
<span class="term-fg31">-    &#47;* [d 0 t4+(tx&lt;&lt;48)+(u0&lt;&lt;52) t3 0 0 c] = [p8 0 0 p5 p4 p3 0 0 p0] *&#47;</span>
<span class="term-fg31">-    u0 = (u0 &lt;&lt; 4) | tx;</span>
<span class="term-fg31">-    VERIFY_BITS(u0, 56);</span>
<span class="term-fg31">-    &#47;* [d 0 t4+(u0&lt;&lt;48) t3 0 0 c] = [p8 0 0 p5 p4 p3 0 0 p0] *&#47;</span>
<span class="term-fg31">-    c += (uint128_t)u0 * (R &gt;&gt; 4);</span>
<span class="term-fg31">-    VERIFY_BITS(c, 115);</span>
<span class="term-fg31">-    &#47;* [d 0 t4 t3 0 0 c] = [p8 0 0 p5 p4 p3 0 0 p0] *&#47;</span>
<span class="term-fg31">-    r[0] = c &amp; M; c &gt;&gt;= 52;</span>
<span class="term-fg31">-    VERIFY_BITS(r[0], 52);</span>
<span class="term-fg31">-    VERIFY_BITS(c, 61);</span>
<span class="term-fg31">-    &#47;* [d 0 t4 t3 0 c r0] = [p8 0 0 p5 p4 p3 0 0 p0] *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    c += (uint128_t)a0 * b[1]</span>
<span class="term-fg31">-       + (uint128_t)a1 * b[0];</span>
<span class="term-fg31">-    VERIFY_BITS(c, 114);</span>
<span class="term-fg31">-    &#47;* [d 0 t4 t3 0 c r0] = [p8 0 0 p5 p4 p3 0 p1 p0] *&#47;</span>
<span class="term-fg31">-    d += (uint128_t)a2 * b[4]</span>
<span class="term-fg31">-       + (uint128_t)a3 * b[3]</span>
<span class="term-fg31">-       + (uint128_t)a4 * b[2];</span>
<span class="term-fg31">-    VERIFY_BITS(d, 114);</span>
<span class="term-fg31">-    &#47;* [d 0 t4 t3 0 c r0] = [p8 0 p6 p5 p4 p3 0 p1 p0] *&#47;</span>
<span class="term-fg31">-    c += (d &amp; M) * R; d &gt;&gt;= 52;</span>
<span class="term-fg31">-    VERIFY_BITS(c, 115);</span>
<span class="term-fg31">-    VERIFY_BITS(d, 62);</span>
<span class="term-fg31">-    &#47;* [d 0 0 t4 t3 0 c r0] = [p8 0 p6 p5 p4 p3 0 p1 p0] *&#47;</span>
<span class="term-fg31">-    r[1] = c &amp; M; c &gt;&gt;= 52;</span>
<span class="term-fg31">-    VERIFY_BITS(r[1], 52);</span>
<span class="term-fg31">-    VERIFY_BITS(c, 63);</span>
<span class="term-fg31">-    &#47;* [d 0 0 t4 t3 c r1 r0] = [p8 0 p6 p5 p4 p3 0 p1 p0] *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    c += (uint128_t)a0 * b[2]</span>
<span class="term-fg31">-       + (uint128_t)a1 * b[1]</span>
<span class="term-fg31">-       + (uint128_t)a2 * b[0];</span>
<span class="term-fg31">-    VERIFY_BITS(c, 114);</span>
<span class="term-fg31">-    &#47;* [d 0 0 t4 t3 c r1 r0] = [p8 0 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    d += (uint128_t)a3 * b[4]</span>
<span class="term-fg31">-       + (uint128_t)a4 * b[3];</span>
<span class="term-fg31">-    VERIFY_BITS(d, 114);</span>
<span class="term-fg31">-    &#47;* [d 0 0 t4 t3 c t1 r0] = [p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    c += (d &amp; M) * R; d &gt;&gt;= 52;</span>
<span class="term-fg31">-    VERIFY_BITS(c, 115);</span>
<span class="term-fg31">-    VERIFY_BITS(d, 62);</span>
<span class="term-fg31">-    &#47;* [d 0 0 0 t4 t3 c r1 r0] = [p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* [d 0 0 0 t4 t3 c r1 r0] = [p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    r[2] = c &amp; M; c &gt;&gt;= 52;</span>
<span class="term-fg31">-    VERIFY_BITS(r[2], 52);</span>
<span class="term-fg31">-    VERIFY_BITS(c, 63);</span>
<span class="term-fg31">-    &#47;* [d 0 0 0 t4 t3+c r2 r1 r0] = [p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    c   += d * R + t3;</span>
<span class="term-fg31">-    VERIFY_BITS(c, 100);</span>
<span class="term-fg31">-    &#47;* [t4 c r2 r1 r0] = [p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    r[3] = c &amp; M; c &gt;&gt;= 52;</span>
<span class="term-fg31">-    VERIFY_BITS(r[3], 52);</span>
<span class="term-fg31">-    VERIFY_BITS(c, 48);</span>
<span class="term-fg31">-    &#47;* [t4+c r3 r2 r1 r0] = [p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    c   += t4;</span>
<span class="term-fg31">-    VERIFY_BITS(c, 49);</span>
<span class="term-fg31">-    &#47;* [c r3 r2 r1 r0] = [p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    r[4] = c;</span>
<span class="term-fg31">-    VERIFY_BITS(r[4], 49);</span>
<span class="term-fg31">-    &#47;* [r4 r3 r2 r1 r0] = [p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static void secp256k1_fe_sqr_inner(uint64_t *r, const uint64_t *a) {</span>
<span class="term-fg31">-    uint128_t c, d;</span>
<span class="term-fg31">-    uint64_t a0 = a[0], a1 = a[1], a2 = a[2], a3 = a[3], a4 = a[4];</span>
<span class="term-fg31">-    int64_t t3, t4, tx, u0;</span>
<span class="term-fg31">-    const uint64_t M = 0xFFFFFFFFFFFFFULL, R = 0x1000003D10ULL;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    VERIFY_BITS(a[0], 56);</span>
<span class="term-fg31">-    VERIFY_BITS(a[1], 56);</span>
<span class="term-fg31">-    VERIFY_BITS(a[2], 56);</span>
<span class="term-fg31">-    VERIFY_BITS(a[3], 56);</span>
<span class="term-fg31">-    VERIFY_BITS(a[4], 52);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;**  [... a b c] is a shorthand for ... + a&lt;&lt;104 + b&lt;&lt;52 + c&lt;&lt;0 mod n.</span>
<span class="term-fg31">-     *  px is a shorthand for sum(a[i]*a[x-i], i=0..x).</span>
<span class="term-fg31">-     *  Note that [x 0 0 0 0 0] = [x*R].</span>
<span class="term-fg31">-     *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    d  = (uint128_t)(a0*2) * a3</span>
<span class="term-fg31">-       + (uint128_t)(a1*2) * a2;</span>
<span class="term-fg31">-    VERIFY_BITS(d, 114);</span>
<span class="term-fg31">-    &#47;* [d 0 0 0] = [p3 0 0 0] *&#47;</span>
<span class="term-fg31">-    c  = (uint128_t)a4 * a4;</span>
<span class="term-fg31">-    VERIFY_BITS(c, 112);</span>
<span class="term-fg31">-    &#47;* [c 0 0 0 0 d 0 0 0] = [p8 0 0 0 0 p3 0 0 0] *&#47;</span>
<span class="term-fg31">-    d += (c &amp; M) * R; c &gt;&gt;= 52;</span>
<span class="term-fg31">-    VERIFY_BITS(d, 115);</span>
<span class="term-fg31">-    VERIFY_BITS(c, 60);</span>
<span class="term-fg31">-    &#47;* [c 0 0 0 0 0 d 0 0 0] = [p8 0 0 0 0 p3 0 0 0] *&#47;</span>
<span class="term-fg31">-    t3 = d &amp; M; d &gt;&gt;= 52;</span>
<span class="term-fg31">-    VERIFY_BITS(t3, 52);</span>
<span class="term-fg31">-    VERIFY_BITS(d, 63);</span>
<span class="term-fg31">-    &#47;* [c 0 0 0 0 d t3 0 0 0] = [p8 0 0 0 0 p3 0 0 0] *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    a4 *= 2;</span>
<span class="term-fg31">-    d += (uint128_t)a0 * a4</span>
<span class="term-fg31">-       + (uint128_t)(a1*2) * a3</span>
<span class="term-fg31">-       + (uint128_t)a2 * a2;</span>
<span class="term-fg31">-    VERIFY_BITS(d, 115);</span>
<span class="term-fg31">-    &#47;* [c 0 0 0 0 d t3 0 0 0] = [p8 0 0 0 p4 p3 0 0 0] *&#47;</span>
<span class="term-fg31">-    d += c * R;</span>
<span class="term-fg31">-    VERIFY_BITS(d, 116);</span>
<span class="term-fg31">-    &#47;* [d t3 0 0 0] = [p8 0 0 0 p4 p3 0 0 0] *&#47;</span>
<span class="term-fg31">-    t4 = d &amp; M; d &gt;&gt;= 52;</span>
<span class="term-fg31">-    VERIFY_BITS(t4, 52);</span>
<span class="term-fg31">-    VERIFY_BITS(d, 64);</span>
<span class="term-fg31">-    &#47;* [d t4 t3 0 0 0] = [p8 0 0 0 p4 p3 0 0 0] *&#47;</span>
<span class="term-fg31">-    tx = (t4 &gt;&gt; 48); t4 &amp;= (M &gt;&gt; 4);</span>
<span class="term-fg31">-    VERIFY_BITS(tx, 4);</span>
<span class="term-fg31">-    VERIFY_BITS(t4, 48);</span>
<span class="term-fg31">-    &#47;* [d t4+(tx&lt;&lt;48) t3 0 0 0] = [p8 0 0 0 p4 p3 0 0 0] *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    c  = (uint128_t)a0 * a0;</span>
<span class="term-fg31">-    VERIFY_BITS(c, 112);</span>
<span class="term-fg31">-    &#47;* [d t4+(tx&lt;&lt;48) t3 0 0 c] = [p8 0 0 0 p4 p3 0 0 p0] *&#47;</span>
<span class="term-fg31">-    d += (uint128_t)a1 * a4</span>
<span class="term-fg31">-       + (uint128_t)(a2*2) * a3;</span>
<span class="term-fg31">-    VERIFY_BITS(d, 114);</span>
<span class="term-fg31">-    &#47;* [d t4+(tx&lt;&lt;48) t3 0 0 c] = [p8 0 0 p5 p4 p3 0 0 p0] *&#47;</span>
<span class="term-fg31">-    u0 = d &amp; M; d &gt;&gt;= 52;</span>
<span class="term-fg31">-    VERIFY_BITS(u0, 52);</span>
<span class="term-fg31">-    VERIFY_BITS(d, 62);</span>
<span class="term-fg31">-    &#47;* [d u0 t4+(tx&lt;&lt;48) t3 0 0 c] = [p8 0 0 p5 p4 p3 0 0 p0] *&#47;</span>
<span class="term-fg31">-    &#47;* [d 0 t4+(tx&lt;&lt;48)+(u0&lt;&lt;52) t3 0 0 c] = [p8 0 0 p5 p4 p3 0 0 p0] *&#47;</span>
<span class="term-fg31">-    u0 = (u0 &lt;&lt; 4) | tx;</span>
<span class="term-fg31">-    VERIFY_BITS(u0, 56);</span>
<span class="term-fg31">-    &#47;* [d 0 t4+(u0&lt;&lt;48) t3 0 0 c] = [p8 0 0 p5 p4 p3 0 0 p0] *&#47;</span>
<span class="term-fg31">-    c += (uint128_t)u0 * (R &gt;&gt; 4);</span>
<span class="term-fg31">-    VERIFY_BITS(c, 113);</span>
<span class="term-fg31">-    &#47;* [d 0 t4 t3 0 0 c] = [p8 0 0 p5 p4 p3 0 0 p0] *&#47;</span>
<span class="term-fg31">-    r[0] = c &amp; M; c &gt;&gt;= 52;</span>
<span class="term-fg31">-    VERIFY_BITS(r[0], 52);</span>
<span class="term-fg31">-    VERIFY_BITS(c, 61);</span>
<span class="term-fg31">-    &#47;* [d 0 t4 t3 0 c r0] = [p8 0 0 p5 p4 p3 0 0 p0] *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    a0 *= 2;</span>
<span class="term-fg31">-    c += (uint128_t)a0 * a1;</span>
<span class="term-fg31">-    VERIFY_BITS(c, 114);</span>
<span class="term-fg31">-    &#47;* [d 0 t4 t3 0 c r0] = [p8 0 0 p5 p4 p3 0 p1 p0] *&#47;</span>
<span class="term-fg31">-    d += (uint128_t)a2 * a4</span>
<span class="term-fg31">-       + (uint128_t)a3 * a3;</span>
<span class="term-fg31">-    VERIFY_BITS(d, 114);</span>
<span class="term-fg31">-    &#47;* [d 0 t4 t3 0 c r0] = [p8 0 p6 p5 p4 p3 0 p1 p0] *&#47;</span>
<span class="term-fg31">-    c += (d &amp; M) * R; d &gt;&gt;= 52;</span>
<span class="term-fg31">-    VERIFY_BITS(c, 115);</span>
<span class="term-fg31">-    VERIFY_BITS(d, 62);</span>
<span class="term-fg31">-    &#47;* [d 0 0 t4 t3 0 c r0] = [p8 0 p6 p5 p4 p3 0 p1 p0] *&#47;</span>
<span class="term-fg31">-    r[1] = c &amp; M; c &gt;&gt;= 52;</span>
<span class="term-fg31">-    VERIFY_BITS(r[1], 52);</span>
<span class="term-fg31">-    VERIFY_BITS(c, 63);</span>
<span class="term-fg31">-    &#47;* [d 0 0 t4 t3 c r1 r0] = [p8 0 p6 p5 p4 p3 0 p1 p0] *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    c += (uint128_t)a0 * a2</span>
<span class="term-fg31">-       + (uint128_t)a1 * a1;</span>
<span class="term-fg31">-    VERIFY_BITS(c, 114);</span>
<span class="term-fg31">-    &#47;* [d 0 0 t4 t3 c r1 r0] = [p8 0 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    d += (uint128_t)a3 * a4;</span>
<span class="term-fg31">-    VERIFY_BITS(d, 114);</span>
<span class="term-fg31">-    &#47;* [d 0 0 t4 t3 c r1 r0] = [p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    c += (d &amp; M) * R; d &gt;&gt;= 52;</span>
<span class="term-fg31">-    VERIFY_BITS(c, 115);</span>
<span class="term-fg31">-    VERIFY_BITS(d, 62);</span>
<span class="term-fg31">-    &#47;* [d 0 0 0 t4 t3 c r1 r0] = [p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    r[2] = c &amp; M; c &gt;&gt;= 52;</span>
<span class="term-fg31">-    VERIFY_BITS(r[2], 52);</span>
<span class="term-fg31">-    VERIFY_BITS(c, 63);</span>
<span class="term-fg31">-    &#47;* [d 0 0 0 t4 t3+c r2 r1 r0] = [p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    c   += d * R + t3;</span>
<span class="term-fg31">-    VERIFY_BITS(c, 100);</span>
<span class="term-fg31">-    &#47;* [t4 c r2 r1 r0] = [p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    r[3] = c &amp; M; c &gt;&gt;= 52;</span>
<span class="term-fg31">-    VERIFY_BITS(r[3], 52);</span>
<span class="term-fg31">-    VERIFY_BITS(c, 48);</span>
<span class="term-fg31">-    &#47;* [t4+c r3 r2 r1 r0] = [p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    c   += t4;</span>
<span class="term-fg31">-    VERIFY_BITS(c, 49);</span>
<span class="term-fg31">-    &#47;* [c r3 r2 r1 r0] = [p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-    r[4] = c;</span>
<span class="term-fg31">-    VERIFY_BITS(r[4], 49);</span>
<span class="term-fg31">-    &#47;* [r4 r3 r2 r1 r0] = [p8 p7 p6 p5 p4 p3 p2 p1 p0] *&#47;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-7817fbf85a6826b08ff2b37a" role="button"
                       aria-expanded="false" aria-controls="id-7817fbf85a6826b08ff2b37a">
                        <code>crypto/secp256k1/libsecp256k1/src/field_impl.h</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/field_impl.h" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-315</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-7817fbf85a6826b08ff2b37a"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;field_impl.h op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;field_impl.h</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 5127b279bc7f56b621042d9f79bfc200dd7086c7..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;field_impl.h</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,315 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2013, 2014 Pieter Wuille                             *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef _SECP256K1_FIELD_IMPL_H_</span>
<span class="term-fg31">-#define _SECP256K1_FIELD_IMPL_H_</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#if defined HAVE_CONFIG_H</span>
<span class="term-fg31">-#include &quot;libsecp256k1-config.h&quot;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &quot;util.h&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#if defined(USE_FIELD_10X26)</span>
<span class="term-fg31">-#include &quot;field_10x26_impl.h&quot;</span>
<span class="term-fg31">-#elif defined(USE_FIELD_5X52)</span>
<span class="term-fg31">-#include &quot;field_5x52_impl.h&quot;</span>
<span class="term-fg31">-#else</span>
<span class="term-fg31">-#error &quot;Please select field implementation&quot;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static int secp256k1_fe_equal(const secp256k1_fe *a, const secp256k1_fe *b) {</span>
<span class="term-fg31">-    secp256k1_fe na;</span>
<span class="term-fg31">-    secp256k1_fe_negate(&amp;na, a, 1);</span>
<span class="term-fg31">-    secp256k1_fe_add(&amp;na, b);</span>
<span class="term-fg31">-    return secp256k1_fe_normalizes_to_zero(&amp;na);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static int secp256k1_fe_equal_var(const secp256k1_fe *a, const secp256k1_fe *b) {</span>
<span class="term-fg31">-    secp256k1_fe na;</span>
<span class="term-fg31">-    secp256k1_fe_negate(&amp;na, a, 1);</span>
<span class="term-fg31">-    secp256k1_fe_add(&amp;na, b);</span>
<span class="term-fg31">-    return secp256k1_fe_normalizes_to_zero_var(&amp;na);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_fe_sqrt(secp256k1_fe *r, const secp256k1_fe *a) {</span>
<span class="term-fg31">-    &#47;** Given that p is congruent to 3 mod 4, we can compute the square root of</span>
<span class="term-fg31">-     *  a mod p as the (p+1)&#47;4&#39;th power of a.</span>
<span class="term-fg31">-     *</span>
<span class="term-fg31">-     *  As (p+1)&#47;4 is an even number, it will have the same result for a and for</span>
<span class="term-fg31">-     *  (-a). Only one of these two numbers actually has a square root however,</span>
<span class="term-fg31">-     *  so we test at the end by squaring and comparing to the input.</span>
<span class="term-fg31">-     *  Also because (p+1)&#47;4 is an even number, the computed square root is</span>
<span class="term-fg31">-     *  itself always a square (a ** ((p+1)&#47;4) is the square of a ** ((p+1)&#47;8)).</span>
<span class="term-fg31">-     *&#47;</span>
<span class="term-fg31">-    secp256k1_fe x2, x3, x6, x9, x11, x22, x44, x88, x176, x220, x223, t1;</span>
<span class="term-fg31">-    int j;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;** The binary representation of (p + 1)&#47;4 has 3 blocks of 1s, with lengths in</span>
<span class="term-fg31">-     *  { 2, 22, 223 }. Use an addition chain to calculate 2^n - 1 for each block:</span>
<span class="term-fg31">-     *  1, [2], 3, 6, 9, 11, [22], 44, 88, 176, 220, [223]</span>
<span class="term-fg31">-     *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_fe_sqr(&amp;x2, a);</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;x2, &amp;x2, a);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_fe_sqr(&amp;x3, &amp;x2);</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;x3, &amp;x3, a);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    x6 = x3;</span>
<span class="term-fg31">-    for (j=0; j&lt;3; j++) {</span>
<span class="term-fg31">-        secp256k1_fe_sqr(&amp;x6, &amp;x6);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;x6, &amp;x6, &amp;x3);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    x9 = x6;</span>
<span class="term-fg31">-    for (j=0; j&lt;3; j++) {</span>
<span class="term-fg31">-        secp256k1_fe_sqr(&amp;x9, &amp;x9);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;x9, &amp;x9, &amp;x3);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    x11 = x9;</span>
<span class="term-fg31">-    for (j=0; j&lt;2; j++) {</span>
<span class="term-fg31">-        secp256k1_fe_sqr(&amp;x11, &amp;x11);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;x11, &amp;x11, &amp;x2);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    x22 = x11;</span>
<span class="term-fg31">-    for (j=0; j&lt;11; j++) {</span>
<span class="term-fg31">-        secp256k1_fe_sqr(&amp;x22, &amp;x22);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;x22, &amp;x22, &amp;x11);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    x44 = x22;</span>
<span class="term-fg31">-    for (j=0; j&lt;22; j++) {</span>
<span class="term-fg31">-        secp256k1_fe_sqr(&amp;x44, &amp;x44);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;x44, &amp;x44, &amp;x22);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    x88 = x44;</span>
<span class="term-fg31">-    for (j=0; j&lt;44; j++) {</span>
<span class="term-fg31">-        secp256k1_fe_sqr(&amp;x88, &amp;x88);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;x88, &amp;x88, &amp;x44);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    x176 = x88;</span>
<span class="term-fg31">-    for (j=0; j&lt;88; j++) {</span>
<span class="term-fg31">-        secp256k1_fe_sqr(&amp;x176, &amp;x176);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;x176, &amp;x176, &amp;x88);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    x220 = x176;</span>
<span class="term-fg31">-    for (j=0; j&lt;44; j++) {</span>
<span class="term-fg31">-        secp256k1_fe_sqr(&amp;x220, &amp;x220);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;x220, &amp;x220, &amp;x44);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    x223 = x220;</span>
<span class="term-fg31">-    for (j=0; j&lt;3; j++) {</span>
<span class="term-fg31">-        secp256k1_fe_sqr(&amp;x223, &amp;x223);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;x223, &amp;x223, &amp;x3);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* The final result is then assembled using a sliding window over the blocks. *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    t1 = x223;</span>
<span class="term-fg31">-    for (j=0; j&lt;23; j++) {</span>
<span class="term-fg31">-        secp256k1_fe_sqr(&amp;t1, &amp;t1);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;t1, &amp;t1, &amp;x22);</span>
<span class="term-fg31">-    for (j=0; j&lt;6; j++) {</span>
<span class="term-fg31">-        secp256k1_fe_sqr(&amp;t1, &amp;t1);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;t1, &amp;t1, &amp;x2);</span>
<span class="term-fg31">-    secp256k1_fe_sqr(&amp;t1, &amp;t1);</span>
<span class="term-fg31">-    secp256k1_fe_sqr(r, &amp;t1);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Check that a square root was actually calculated *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_fe_sqr(&amp;t1, r);</span>
<span class="term-fg31">-    return secp256k1_fe_equal(&amp;t1, a);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_fe_inv(secp256k1_fe *r, const secp256k1_fe *a) {</span>
<span class="term-fg31">-    secp256k1_fe x2, x3, x6, x9, x11, x22, x44, x88, x176, x220, x223, t1;</span>
<span class="term-fg31">-    int j;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;** The binary representation of (p - 2) has 5 blocks of 1s, with lengths in</span>
<span class="term-fg31">-     *  { 1, 2, 22, 223 }. Use an addition chain to calculate 2^n - 1 for each block:</span>
<span class="term-fg31">-     *  [1], [2], 3, 6, 9, 11, [22], 44, 88, 176, 220, [223]</span>
<span class="term-fg31">-     *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_fe_sqr(&amp;x2, a);</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;x2, &amp;x2, a);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_fe_sqr(&amp;x3, &amp;x2);</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;x3, &amp;x3, a);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    x6 = x3;</span>
<span class="term-fg31">-    for (j=0; j&lt;3; j++) {</span>
<span class="term-fg31">-        secp256k1_fe_sqr(&amp;x6, &amp;x6);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;x6, &amp;x6, &amp;x3);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    x9 = x6;</span>
<span class="term-fg31">-    for (j=0; j&lt;3; j++) {</span>
<span class="term-fg31">-        secp256k1_fe_sqr(&amp;x9, &amp;x9);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;x9, &amp;x9, &amp;x3);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    x11 = x9;</span>
<span class="term-fg31">-    for (j=0; j&lt;2; j++) {</span>
<span class="term-fg31">-        secp256k1_fe_sqr(&amp;x11, &amp;x11);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;x11, &amp;x11, &amp;x2);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    x22 = x11;</span>
<span class="term-fg31">-    for (j=0; j&lt;11; j++) {</span>
<span class="term-fg31">-        secp256k1_fe_sqr(&amp;x22, &amp;x22);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;x22, &amp;x22, &amp;x11);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    x44 = x22;</span>
<span class="term-fg31">-    for (j=0; j&lt;22; j++) {</span>
<span class="term-fg31">-        secp256k1_fe_sqr(&amp;x44, &amp;x44);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;x44, &amp;x44, &amp;x22);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    x88 = x44;</span>
<span class="term-fg31">-    for (j=0; j&lt;44; j++) {</span>
<span class="term-fg31">-        secp256k1_fe_sqr(&amp;x88, &amp;x88);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;x88, &amp;x88, &amp;x44);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    x176 = x88;</span>
<span class="term-fg31">-    for (j=0; j&lt;88; j++) {</span>
<span class="term-fg31">-        secp256k1_fe_sqr(&amp;x176, &amp;x176);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;x176, &amp;x176, &amp;x88);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    x220 = x176;</span>
<span class="term-fg31">-    for (j=0; j&lt;44; j++) {</span>
<span class="term-fg31">-        secp256k1_fe_sqr(&amp;x220, &amp;x220);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;x220, &amp;x220, &amp;x44);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    x223 = x220;</span>
<span class="term-fg31">-    for (j=0; j&lt;3; j++) {</span>
<span class="term-fg31">-        secp256k1_fe_sqr(&amp;x223, &amp;x223);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;x223, &amp;x223, &amp;x3);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* The final result is then assembled using a sliding window over the blocks. *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    t1 = x223;</span>
<span class="term-fg31">-    for (j=0; j&lt;23; j++) {</span>
<span class="term-fg31">-        secp256k1_fe_sqr(&amp;t1, &amp;t1);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;t1, &amp;t1, &amp;x22);</span>
<span class="term-fg31">-    for (j=0; j&lt;5; j++) {</span>
<span class="term-fg31">-        secp256k1_fe_sqr(&amp;t1, &amp;t1);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;t1, &amp;t1, a);</span>
<span class="term-fg31">-    for (j=0; j&lt;3; j++) {</span>
<span class="term-fg31">-        secp256k1_fe_sqr(&amp;t1, &amp;t1);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;t1, &amp;t1, &amp;x2);</span>
<span class="term-fg31">-    for (j=0; j&lt;2; j++) {</span>
<span class="term-fg31">-        secp256k1_fe_sqr(&amp;t1, &amp;t1);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_fe_mul(r, a, &amp;t1);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_fe_inv_var(secp256k1_fe *r, const secp256k1_fe *a) {</span>
<span class="term-fg31">-#if defined(USE_FIELD_INV_BUILTIN)</span>
<span class="term-fg31">-    secp256k1_fe_inv(r, a);</span>
<span class="term-fg31">-#elif defined(USE_FIELD_INV_NUM)</span>
<span class="term-fg31">-    secp256k1_num n, m;</span>
<span class="term-fg31">-    static const secp256k1_fe negone = SECP256K1_FE_CONST(</span>
<span class="term-fg31">-        0xFFFFFFFFUL, 0xFFFFFFFFUL, 0xFFFFFFFFUL, 0xFFFFFFFFUL,</span>
<span class="term-fg31">-        0xFFFFFFFFUL, 0xFFFFFFFFUL, 0xFFFFFFFEUL, 0xFFFFFC2EUL</span>
<span class="term-fg31">-    );</span>
<span class="term-fg31">-    &#47;* secp256k1 field prime, value p defined in &quot;Standards for Efficient Cryptography&quot; (SEC2) 2.7.1. *&#47;</span>
<span class="term-fg31">-    static const unsigned char prime[32] = {</span>
<span class="term-fg31">-        0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,</span>
<span class="term-fg31">-        0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,</span>
<span class="term-fg31">-        0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,</span>
<span class="term-fg31">-        0xFF,0xFF,0xFF,0xFE,0xFF,0xFF,0xFC,0x2F</span>
<span class="term-fg31">-    };</span>
<span class="term-fg31">-    unsigned char b[32];</span>
<span class="term-fg31">-    int res;</span>
<span class="term-fg31">-    secp256k1_fe c = *a;</span>
<span class="term-fg31">-    secp256k1_fe_normalize_var(&amp;c);</span>
<span class="term-fg31">-    secp256k1_fe_get_b32(b, &amp;c);</span>
<span class="term-fg31">-    secp256k1_num_set_bin(&amp;n, b, 32);</span>
<span class="term-fg31">-    secp256k1_num_set_bin(&amp;m, prime, 32);</span>
<span class="term-fg31">-    secp256k1_num_mod_inverse(&amp;n, &amp;n, &amp;m);</span>
<span class="term-fg31">-    secp256k1_num_get_bin(b, 32, &amp;n);</span>
<span class="term-fg31">-    res = secp256k1_fe_set_b32(r, b);</span>
<span class="term-fg31">-    (void)res;</span>
<span class="term-fg31">-    VERIFY_CHECK(res);</span>
<span class="term-fg31">-    &#47;* Verify the result is the (unique) valid inverse using non-GMP code. *&#47;</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;c, &amp;c, r);</span>
<span class="term-fg31">-    secp256k1_fe_add(&amp;c, &amp;negone);</span>
<span class="term-fg31">-    CHECK(secp256k1_fe_normalizes_to_zero_var(&amp;c));</span>
<span class="term-fg31">-#else</span>
<span class="term-fg31">-#error &quot;Please select field inverse implementation&quot;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_fe_inv_all_var(secp256k1_fe *r, const secp256k1_fe *a, size_t len) {</span>
<span class="term-fg31">-    secp256k1_fe u;</span>
<span class="term-fg31">-    size_t i;</span>
<span class="term-fg31">-    if (len &lt; 1) {</span>
<span class="term-fg31">-        return;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    VERIFY_CHECK((r + len &lt;= a) || (a + len &lt;= r));</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    r[0] = a[0];</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    i = 0;</span>
<span class="term-fg31">-    while (++i &lt; len) {</span>
<span class="term-fg31">-        secp256k1_fe_mul(&amp;r[i], &amp;r[i - 1], &amp;a[i]);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_fe_inv_var(&amp;u, &amp;r[--i]);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    while (i &gt; 0) {</span>
<span class="term-fg31">-        size_t j = i--;</span>
<span class="term-fg31">-        secp256k1_fe_mul(&amp;r[j], &amp;r[i], &amp;u);</span>
<span class="term-fg31">-        secp256k1_fe_mul(&amp;u, &amp;u, &amp;a[j]);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    r[0] = u;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_fe_is_quad_var(const secp256k1_fe *a) {</span>
<span class="term-fg31">-#ifndef USE_NUM_NONE</span>
<span class="term-fg31">-    unsigned char b[32];</span>
<span class="term-fg31">-    secp256k1_num n;</span>
<span class="term-fg31">-    secp256k1_num m;</span>
<span class="term-fg31">-    &#47;* secp256k1 field prime, value p defined in &quot;Standards for Efficient Cryptography&quot; (SEC2) 2.7.1. *&#47;</span>
<span class="term-fg31">-    static const unsigned char prime[32] = {</span>
<span class="term-fg31">-        0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,</span>
<span class="term-fg31">-        0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,</span>
<span class="term-fg31">-        0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,</span>
<span class="term-fg31">-        0xFF,0xFF,0xFF,0xFE,0xFF,0xFF,0xFC,0x2F</span>
<span class="term-fg31">-    };</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_fe c = *a;</span>
<span class="term-fg31">-    secp256k1_fe_normalize_var(&amp;c);</span>
<span class="term-fg31">-    secp256k1_fe_get_b32(b, &amp;c);</span>
<span class="term-fg31">-    secp256k1_num_set_bin(&amp;n, b, 32);</span>
<span class="term-fg31">-    secp256k1_num_set_bin(&amp;m, prime, 32);</span>
<span class="term-fg31">-    return secp256k1_num_jacobi(&amp;n, &amp;m) &gt;= 0;</span>
<span class="term-fg31">-#else</span>
<span class="term-fg31">-    secp256k1_fe r;</span>
<span class="term-fg31">-    return secp256k1_fe_sqrt(&amp;r, a);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-61ffc353c60700310b8e2b58" role="button"
                       aria-expanded="false" aria-controls="id-61ffc353c60700310b8e2b58">
                        <code>crypto/secp256k1/libsecp256k1/src/gen_context.c</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/gen_context.c" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-74</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-61ffc353c60700310b8e2b58"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;gen_context.c op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;gen_context.c</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 1835fd491d16b7d8f4774327f25994a79ea1986a..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;gen_context.c</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,74 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2013, 2014, 2015 Thomas Daede, Cory Fields           *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#define USE_BASIC_CONFIG 1</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &quot;basic-config.h&quot;</span>
<span class="term-fg31">-#include &quot;include&#47;secp256k1.h&quot;</span>
<span class="term-fg31">-#include &quot;field_impl.h&quot;</span>
<span class="term-fg31">-#include &quot;scalar_impl.h&quot;</span>
<span class="term-fg31">-#include &quot;group_impl.h&quot;</span>
<span class="term-fg31">-#include &quot;ecmult_gen_impl.h&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void default_error_callback_fn(const char* str, void* data) {</span>
<span class="term-fg31">-    (void)data;</span>
<span class="term-fg31">-    fprintf(stderr, &quot;[libsecp256k1] internal consistency check failed: %s\n&quot;, str);</span>
<span class="term-fg31">-    abort();</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static const secp256k1_callback default_error_callback = {</span>
<span class="term-fg31">-    default_error_callback_fn,</span>
<span class="term-fg31">-    NULL</span>
<span class="term-fg31">-};</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-int main(int argc, char **argv) {</span>
<span class="term-fg31">-    secp256k1_ecmult_gen_context ctx;</span>
<span class="term-fg31">-    int inner;</span>
<span class="term-fg31">-    int outer;</span>
<span class="term-fg31">-    FILE* fp;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    (void)argc;</span>
<span class="term-fg31">-    (void)argv;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    fp = fopen(&quot;src&#47;ecmult_static_context.h&quot;,&quot;w&quot;);</span>
<span class="term-fg31">-    if (fp == NULL) {</span>
<span class="term-fg31">-        fprintf(stderr, &quot;Could not open src&#47;ecmult_static_context.h for writing!\n&quot;);</span>
<span class="term-fg31">-        return -1;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    </span>
<span class="term-fg31">-    fprintf(fp, &quot;#ifndef _SECP256K1_ECMULT_STATIC_CONTEXT_\n&quot;);</span>
<span class="term-fg31">-    fprintf(fp, &quot;#define _SECP256K1_ECMULT_STATIC_CONTEXT_\n&quot;);</span>
<span class="term-fg31">-    fprintf(fp, &quot;#include \&quot;group.h\&quot;\n&quot;);</span>
<span class="term-fg31">-    fprintf(fp, &quot;#define SC SECP256K1_GE_STORAGE_CONST\n&quot;);</span>
<span class="term-fg31">-    fprintf(fp, &quot;static const secp256k1_ge_storage secp256k1_ecmult_static_context[64][16] = {\n&quot;);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_ecmult_gen_context_init(&amp;ctx);</span>
<span class="term-fg31">-    secp256k1_ecmult_gen_context_build(&amp;ctx, &amp;default_error_callback);</span>
<span class="term-fg31">-    for(outer = 0; outer != 64; outer++) {</span>
<span class="term-fg31">-        fprintf(fp,&quot;{\n&quot;);</span>
<span class="term-fg31">-        for(inner = 0; inner != 16; inner++) {</span>
<span class="term-fg31">-            fprintf(fp,&quot;    SC(%uu, %uu, %uu, %uu, %uu, %uu, %uu, %uu, %uu, %uu, %uu, %uu, %uu, %uu, %uu, %uu)&quot;, SECP256K1_GE_STORAGE_CONST_GET((*ctx.prec)[outer][inner]));</span>
<span class="term-fg31">-            if (inner != 15) {</span>
<span class="term-fg31">-                fprintf(fp,&quot;,\n&quot;);</span>
<span class="term-fg31">-            } else {</span>
<span class="term-fg31">-                fprintf(fp,&quot;\n&quot;);</span>
<span class="term-fg31">-            }</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        if (outer != 63) {</span>
<span class="term-fg31">-            fprintf(fp,&quot;},\n&quot;);</span>
<span class="term-fg31">-        } else {</span>
<span class="term-fg31">-            fprintf(fp,&quot;}\n&quot;);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    fprintf(fp,&quot;};\n&quot;);</span>
<span class="term-fg31">-    secp256k1_ecmult_gen_context_clear(&amp;ctx);</span>
<span class="term-fg31">-    </span>
<span class="term-fg31">-    fprintf(fp, &quot;#undef SC\n&quot;);</span>
<span class="term-fg31">-    fprintf(fp, &quot;#endif\n&quot;);</span>
<span class="term-fg31">-    fclose(fp);</span>
<span class="term-fg31">-    </span>
<span class="term-fg31">-    return 0;</span>
<span class="term-fg31">-}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-08c8ff5b7d821477851403ac" role="button"
                       aria-expanded="false" aria-controls="id-08c8ff5b7d821477851403ac">
                        <code>crypto/secp256k1/libsecp256k1/src/group.h</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/group.h" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-144</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-08c8ff5b7d821477851403ac"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;group.h op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;group.h</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 4957b248fe6a608b8ae825b9b200b263415f36c4..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;group.h</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,144 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2013, 2014 Pieter Wuille                             *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef _SECP256K1_GROUP_</span>
<span class="term-fg31">-#define _SECP256K1_GROUP_</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &quot;num.h&quot;</span>
<span class="term-fg31">-#include &quot;field.h&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** A group element of the secp256k1 curve, in affine coordinates. *&#47;</span>
<span class="term-fg31">-typedef struct {</span>
<span class="term-fg31">-    secp256k1_fe x;</span>
<span class="term-fg31">-    secp256k1_fe y;</span>
<span class="term-fg31">-    int infinity; &#47;* whether this represents the point at infinity *&#47;</span>
<span class="term-fg31">-} secp256k1_ge;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#define SECP256K1_GE_CONST(a, b, c, d, e, f, g, h, i, j, k, l, m, n, o, p) {SECP256K1_FE_CONST((a),(b),(c),(d),(e),(f),(g),(h)), SECP256K1_FE_CONST((i),(j),(k),(l),(m),(n),(o),(p)), 0}</span>
<span class="term-fg31">-#define SECP256K1_GE_CONST_INFINITY {SECP256K1_FE_CONST(0, 0, 0, 0, 0, 0, 0, 0), SECP256K1_FE_CONST(0, 0, 0, 0, 0, 0, 0, 0), 1}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** A group element of the secp256k1 curve, in jacobian coordinates. *&#47;</span>
<span class="term-fg31">-typedef struct {</span>
<span class="term-fg31">-    secp256k1_fe x; &#47;* actual X: x&#47;z^2 *&#47;</span>
<span class="term-fg31">-    secp256k1_fe y; &#47;* actual Y: y&#47;z^3 *&#47;</span>
<span class="term-fg31">-    secp256k1_fe z;</span>
<span class="term-fg31">-    int infinity; &#47;* whether this represents the point at infinity *&#47;</span>
<span class="term-fg31">-} secp256k1_gej;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#define SECP256K1_GEJ_CONST(a, b, c, d, e, f, g, h, i, j, k, l, m, n, o, p) {SECP256K1_FE_CONST((a),(b),(c),(d),(e),(f),(g),(h)), SECP256K1_FE_CONST((i),(j),(k),(l),(m),(n),(o),(p)), SECP256K1_FE_CONST(0, 0, 0, 0, 0, 0, 0, 1), 0}</span>
<span class="term-fg31">-#define SECP256K1_GEJ_CONST_INFINITY {SECP256K1_FE_CONST(0, 0, 0, 0, 0, 0, 0, 0), SECP256K1_FE_CONST(0, 0, 0, 0, 0, 0, 0, 0), SECP256K1_FE_CONST(0, 0, 0, 0, 0, 0, 0, 0), 1}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-typedef struct {</span>
<span class="term-fg31">-    secp256k1_fe_storage x;</span>
<span class="term-fg31">-    secp256k1_fe_storage y;</span>
<span class="term-fg31">-} secp256k1_ge_storage;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#define SECP256K1_GE_STORAGE_CONST(a, b, c, d, e, f, g, h, i, j, k, l, m, n, o, p) {SECP256K1_FE_STORAGE_CONST((a),(b),(c),(d),(e),(f),(g),(h)), SECP256K1_FE_STORAGE_CONST((i),(j),(k),(l),(m),(n),(o),(p))}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#define SECP256K1_GE_STORAGE_CONST_GET(t) SECP256K1_FE_STORAGE_CONST_GET(t.x), SECP256K1_FE_STORAGE_CONST_GET(t.y)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Set a group element equal to the point with given X and Y coordinates *&#47;</span>
<span class="term-fg31">-static void secp256k1_ge_set_xy(secp256k1_ge *r, const secp256k1_fe *x, const secp256k1_fe *y);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Set a group element (affine) equal to the point with the given X coordinate</span>
<span class="term-fg31">- *  and a Y coordinate that is a quadratic residue modulo p. The return value</span>
<span class="term-fg31">- *  is true iff a coordinate with the given X coordinate exists.</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-static int secp256k1_ge_set_xquad(secp256k1_ge *r, const secp256k1_fe *x);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Set a group element (affine) equal to the point with the given X coordinate, and given oddness</span>
<span class="term-fg31">- *  for Y. Return value indicates whether the result is valid. *&#47;</span>
<span class="term-fg31">-static int secp256k1_ge_set_xo_var(secp256k1_ge *r, const secp256k1_fe *x, int odd);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Check whether a group element is the point at infinity. *&#47;</span>
<span class="term-fg31">-static int secp256k1_ge_is_infinity(const secp256k1_ge *a);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Check whether a group element is valid (i.e., on the curve). *&#47;</span>
<span class="term-fg31">-static int secp256k1_ge_is_valid_var(const secp256k1_ge *a);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_ge_neg(secp256k1_ge *r, const secp256k1_ge *a);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Set a group element equal to another which is given in jacobian coordinates *&#47;</span>
<span class="term-fg31">-static void secp256k1_ge_set_gej(secp256k1_ge *r, secp256k1_gej *a);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Set a batch of group elements equal to the inputs given in jacobian coordinates *&#47;</span>
<span class="term-fg31">-static void secp256k1_ge_set_all_gej_var(secp256k1_ge *r, const secp256k1_gej *a, size_t len, const secp256k1_callback *cb);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Set a batch of group elements equal to the inputs given in jacobian</span>
<span class="term-fg31">- *  coordinates (with known z-ratios). zr must contain the known z-ratios such</span>
<span class="term-fg31">- *  that mul(a[i].z, zr[i+1]) == a[i+1].z. zr[0] is ignored. *&#47;</span>
<span class="term-fg31">-static void secp256k1_ge_set_table_gej_var(secp256k1_ge *r, const secp256k1_gej *a, const secp256k1_fe *zr, size_t len);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Bring a batch inputs given in jacobian coordinates (with known z-ratios) to</span>
<span class="term-fg31">- *  the same global z &quot;denominator&quot;. zr must contain the known z-ratios such</span>
<span class="term-fg31">- *  that mul(a[i].z, zr[i+1]) == a[i+1].z. zr[0] is ignored. The x and y</span>
<span class="term-fg31">- *  coordinates of the result are stored in r, the common z coordinate is</span>
<span class="term-fg31">- *  stored in globalz. *&#47;</span>
<span class="term-fg31">-static void secp256k1_ge_globalz_set_table_gej(size_t len, secp256k1_ge *r, secp256k1_fe *globalz, const secp256k1_gej *a, const secp256k1_fe *zr);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Set a group element (jacobian) equal to the point at infinity. *&#47;</span>
<span class="term-fg31">-static void secp256k1_gej_set_infinity(secp256k1_gej *r);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Set a group element (jacobian) equal to another which is given in affine coordinates. *&#47;</span>
<span class="term-fg31">-static void secp256k1_gej_set_ge(secp256k1_gej *r, const secp256k1_ge *a);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Compare the X coordinate of a group element (jacobian). *&#47;</span>
<span class="term-fg31">-static int secp256k1_gej_eq_x_var(const secp256k1_fe *x, const secp256k1_gej *a);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Set r equal to the inverse of a (i.e., mirrored around the X axis) *&#47;</span>
<span class="term-fg31">-static void secp256k1_gej_neg(secp256k1_gej *r, const secp256k1_gej *a);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Check whether a group element is the point at infinity. *&#47;</span>
<span class="term-fg31">-static int secp256k1_gej_is_infinity(const secp256k1_gej *a);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Check whether a group element&#39;s y coordinate is a quadratic residue. *&#47;</span>
<span class="term-fg31">-static int secp256k1_gej_has_quad_y_var(const secp256k1_gej *a);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Set r equal to the double of a. If rzr is not-NULL, r-&gt;z = a-&gt;z * *rzr (where infinity means an implicit z = 0).</span>
<span class="term-fg31">- * a may not be zero. Constant time. *&#47;</span>
<span class="term-fg31">-static void secp256k1_gej_double_nonzero(secp256k1_gej *r, const secp256k1_gej *a, secp256k1_fe *rzr);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Set r equal to the double of a. If rzr is not-NULL, r-&gt;z = a-&gt;z * *rzr (where infinity means an implicit z = 0). *&#47;</span>
<span class="term-fg31">-static void secp256k1_gej_double_var(secp256k1_gej *r, const secp256k1_gej *a, secp256k1_fe *rzr);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Set r equal to the sum of a and b. If rzr is non-NULL, r-&gt;z = a-&gt;z * *rzr (a cannot be infinity in that case). *&#47;</span>
<span class="term-fg31">-static void secp256k1_gej_add_var(secp256k1_gej *r, const secp256k1_gej *a, const secp256k1_gej *b, secp256k1_fe *rzr);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Set r equal to the sum of a and b (with b given in affine coordinates, and not infinity). *&#47;</span>
<span class="term-fg31">-static void secp256k1_gej_add_ge(secp256k1_gej *r, const secp256k1_gej *a, const secp256k1_ge *b);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Set r equal to the sum of a and b (with b given in affine coordinates). This is more efficient</span>
<span class="term-fg31">-    than secp256k1_gej_add_var. It is identical to secp256k1_gej_add_ge but without constant-time</span>
<span class="term-fg31">-    guarantee, and b is allowed to be infinity. If rzr is non-NULL, r-&gt;z = a-&gt;z * *rzr (a cannot be infinity in that case). *&#47;</span>
<span class="term-fg31">-static void secp256k1_gej_add_ge_var(secp256k1_gej *r, const secp256k1_gej *a, const secp256k1_ge *b, secp256k1_fe *rzr);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Set r equal to the sum of a and b (with the inverse of b&#39;s Z coordinate passed as bzinv). *&#47;</span>
<span class="term-fg31">-static void secp256k1_gej_add_zinv_var(secp256k1_gej *r, const secp256k1_gej *a, const secp256k1_ge *b, const secp256k1_fe *bzinv);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef USE_ENDOMORPHISM</span>
<span class="term-fg31">-&#47;** Set r to be equal to lambda times a, where lambda is chosen in a way such that this is very fast. *&#47;</span>
<span class="term-fg31">-static void secp256k1_ge_mul_lambda(secp256k1_ge *r, const secp256k1_ge *a);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Clear a secp256k1_gej to prevent leaking sensitive information. *&#47;</span>
<span class="term-fg31">-static void secp256k1_gej_clear(secp256k1_gej *r);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Clear a secp256k1_ge to prevent leaking sensitive information. *&#47;</span>
<span class="term-fg31">-static void secp256k1_ge_clear(secp256k1_ge *r);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Convert a group element to the storage type. *&#47;</span>
<span class="term-fg31">-static void secp256k1_ge_to_storage(secp256k1_ge_storage *r, const secp256k1_ge *a);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Convert a group element back from the storage type. *&#47;</span>
<span class="term-fg31">-static void secp256k1_ge_from_storage(secp256k1_ge *r, const secp256k1_ge_storage *a);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** If flag is true, set *r equal to *a; otherwise leave it. Constant-time. *&#47;</span>
<span class="term-fg31">-static void secp256k1_ge_storage_cmov(secp256k1_ge_storage *r, const secp256k1_ge_storage *a, int flag);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Rescale a jacobian point by b which must be non-zero. Constant-time. *&#47;</span>
<span class="term-fg31">-static void secp256k1_gej_rescale(secp256k1_gej *r, const secp256k1_fe *b);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-cb5fdca246a101484ee0dd6a" role="button"
                       aria-expanded="false" aria-controls="id-cb5fdca246a101484ee0dd6a">
                        <code>crypto/secp256k1/libsecp256k1/src/group_impl.h</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/group_impl.h" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-700</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-cb5fdca246a101484ee0dd6a"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;group_impl.h op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;group_impl.h</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 7d723532ff3e12c1767540d019e35ede17a7c6c4..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;group_impl.h</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,700 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2013, 2014 Pieter Wuille                             *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef _SECP256K1_GROUP_IMPL_H_</span>
<span class="term-fg31">-#define _SECP256K1_GROUP_IMPL_H_</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &quot;num.h&quot;</span>
<span class="term-fg31">-#include &quot;field.h&quot;</span>
<span class="term-fg31">-#include &quot;group.h&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;* These points can be generated in sage as follows:</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- * 0. Setup a worksheet with the following parameters.</span>
<span class="term-fg31">- *   b = 4  # whatever CURVE_B will be set to</span>
<span class="term-fg31">- *   F = FiniteField (0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F)</span>
<span class="term-fg31">- *   C = EllipticCurve ([F (0), F (b)])</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- * 1. Determine all the small orders available to you. (If there are</span>
<span class="term-fg31">- *    no satisfactory ones, go back and change b.)</span>
<span class="term-fg31">- *   print C.order().factor(limit=1000)</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- * 2. Choose an order as one of the prime factors listed in the above step.</span>
<span class="term-fg31">- *    (You can also multiply some to get a composite order, though the</span>
<span class="term-fg31">- *    tests will crash trying to invert scalars during signing.) We take a</span>
<span class="term-fg31">- *    random point and scale it to drop its order to the desired value.</span>
<span class="term-fg31">- *    There is some probability this won&#39;t work; just try again.</span>
<span class="term-fg31">- *   order = 199</span>
<span class="term-fg31">- *   P = C.random_point()</span>
<span class="term-fg31">- *   P = (int(P.order()) &#47; int(order)) * P</span>
<span class="term-fg31">- *   assert(P.order() == order)</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- * 3. Print the values. You&#39;ll need to use a vim macro or something to</span>
<span class="term-fg31">- *    split the hex output into 4-byte chunks.</span>
<span class="term-fg31">- *   print &quot;%x %x&quot; % P.xy()</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-#if defined(EXHAUSTIVE_TEST_ORDER)</span>
<span class="term-fg31">-#  if EXHAUSTIVE_TEST_ORDER == 199</span>
<span class="term-fg31">-const secp256k1_ge secp256k1_ge_const_g = SECP256K1_GE_CONST(</span>
<span class="term-fg31">-    0xFA7CC9A7, 0x0737F2DB, 0xA749DD39, 0x2B4FB069,</span>
<span class="term-fg31">-    0x3B017A7D, 0xA808C2F1, 0xFB12940C, 0x9EA66C18,</span>
<span class="term-fg31">-    0x78AC123A, 0x5ED8AEF3, 0x8732BC91, 0x1F3A2868,</span>
<span class="term-fg31">-    0x48DF246C, 0x808DAE72, 0xCFE52572, 0x7F0501ED</span>
<span class="term-fg31">-);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-const int CURVE_B = 4;</span>
<span class="term-fg31">-#  elif EXHAUSTIVE_TEST_ORDER == 13</span>
<span class="term-fg31">-const secp256k1_ge secp256k1_ge_const_g = SECP256K1_GE_CONST(</span>
<span class="term-fg31">-    0xedc60018, 0xa51a786b, 0x2ea91f4d, 0x4c9416c0,</span>
<span class="term-fg31">-    0x9de54c3b, 0xa1316554, 0x6cf4345c, 0x7277ef15,</span>
<span class="term-fg31">-    0x54cb1b6b, 0xdc8c1273, 0x087844ea, 0x43f4603e,</span>
<span class="term-fg31">-    0x0eaf9a43, 0xf6effe55, 0x939f806d, 0x37adf8ac</span>
<span class="term-fg31">-);</span>
<span class="term-fg31">-const int CURVE_B = 2;</span>
<span class="term-fg31">-#  else</span>
<span class="term-fg31">-#    error No known generator for the specified exhaustive test group order.</span>
<span class="term-fg31">-#  endif</span>
<span class="term-fg31">-#else</span>
<span class="term-fg31">-&#47;** Generator for secp256k1, value &#39;g&#39; defined in</span>
<span class="term-fg31">- *  &quot;Standards for Efficient Cryptography&quot; (SEC2) 2.7.1.</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-static const secp256k1_ge secp256k1_ge_const_g = SECP256K1_GE_CONST(</span>
<span class="term-fg31">-    0x79BE667EUL, 0xF9DCBBACUL, 0x55A06295UL, 0xCE870B07UL,</span>
<span class="term-fg31">-    0x029BFCDBUL, 0x2DCE28D9UL, 0x59F2815BUL, 0x16F81798UL,</span>
<span class="term-fg31">-    0x483ADA77UL, 0x26A3C465UL, 0x5DA4FBFCUL, 0x0E1108A8UL,</span>
<span class="term-fg31">-    0xFD17B448UL, 0xA6855419UL, 0x9C47D08FUL, 0xFB10D4B8UL</span>
<span class="term-fg31">-);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-const int CURVE_B = 7;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_ge_set_gej_zinv(secp256k1_ge *r, const secp256k1_gej *a, const secp256k1_fe *zi) {</span>
<span class="term-fg31">-    secp256k1_fe zi2;</span>
<span class="term-fg31">-    secp256k1_fe zi3;</span>
<span class="term-fg31">-    secp256k1_fe_sqr(&amp;zi2, zi);</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;zi3, &amp;zi2, zi);</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;r-&gt;x, &amp;a-&gt;x, &amp;zi2);</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;r-&gt;y, &amp;a-&gt;y, &amp;zi3);</span>
<span class="term-fg31">-    r-&gt;infinity = a-&gt;infinity;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_ge_set_xy(secp256k1_ge *r, const secp256k1_fe *x, const secp256k1_fe *y) {</span>
<span class="term-fg31">-    r-&gt;infinity = 0;</span>
<span class="term-fg31">-    r-&gt;x = *x;</span>
<span class="term-fg31">-    r-&gt;y = *y;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_ge_is_infinity(const secp256k1_ge *a) {</span>
<span class="term-fg31">-    return a-&gt;infinity;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_ge_neg(secp256k1_ge *r, const secp256k1_ge *a) {</span>
<span class="term-fg31">-    *r = *a;</span>
<span class="term-fg31">-    secp256k1_fe_normalize_weak(&amp;r-&gt;y);</span>
<span class="term-fg31">-    secp256k1_fe_negate(&amp;r-&gt;y, &amp;r-&gt;y, 1);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_ge_set_gej(secp256k1_ge *r, secp256k1_gej *a) {</span>
<span class="term-fg31">-    secp256k1_fe z2, z3;</span>
<span class="term-fg31">-    r-&gt;infinity = a-&gt;infinity;</span>
<span class="term-fg31">-    secp256k1_fe_inv(&amp;a-&gt;z, &amp;a-&gt;z);</span>
<span class="term-fg31">-    secp256k1_fe_sqr(&amp;z2, &amp;a-&gt;z);</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;z3, &amp;a-&gt;z, &amp;z2);</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;a-&gt;x, &amp;a-&gt;x, &amp;z2);</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;a-&gt;y, &amp;a-&gt;y, &amp;z3);</span>
<span class="term-fg31">-    secp256k1_fe_set_int(&amp;a-&gt;z, 1);</span>
<span class="term-fg31">-    r-&gt;x = a-&gt;x;</span>
<span class="term-fg31">-    r-&gt;y = a-&gt;y;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_ge_set_gej_var(secp256k1_ge *r, secp256k1_gej *a) {</span>
<span class="term-fg31">-    secp256k1_fe z2, z3;</span>
<span class="term-fg31">-    r-&gt;infinity = a-&gt;infinity;</span>
<span class="term-fg31">-    if (a-&gt;infinity) {</span>
<span class="term-fg31">-        return;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_fe_inv_var(&amp;a-&gt;z, &amp;a-&gt;z);</span>
<span class="term-fg31">-    secp256k1_fe_sqr(&amp;z2, &amp;a-&gt;z);</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;z3, &amp;a-&gt;z, &amp;z2);</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;a-&gt;x, &amp;a-&gt;x, &amp;z2);</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;a-&gt;y, &amp;a-&gt;y, &amp;z3);</span>
<span class="term-fg31">-    secp256k1_fe_set_int(&amp;a-&gt;z, 1);</span>
<span class="term-fg31">-    r-&gt;x = a-&gt;x;</span>
<span class="term-fg31">-    r-&gt;y = a-&gt;y;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_ge_set_all_gej_var(secp256k1_ge *r, const secp256k1_gej *a, size_t len, const secp256k1_callback *cb) {</span>
<span class="term-fg31">-    secp256k1_fe *az;</span>
<span class="term-fg31">-    secp256k1_fe *azi;</span>
<span class="term-fg31">-    size_t i;</span>
<span class="term-fg31">-    size_t count = 0;</span>
<span class="term-fg31">-    az = (secp256k1_fe *)checked_malloc(cb, sizeof(secp256k1_fe) * len);</span>
<span class="term-fg31">-    for (i = 0; i &lt; len; i++) {</span>
<span class="term-fg31">-        if (!a[i].infinity) {</span>
<span class="term-fg31">-            az[count++] = a[i].z;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    azi = (secp256k1_fe *)checked_malloc(cb, sizeof(secp256k1_fe) * count);</span>
<span class="term-fg31">-    secp256k1_fe_inv_all_var(azi, az, count);</span>
<span class="term-fg31">-    free(az);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    count = 0;</span>
<span class="term-fg31">-    for (i = 0; i &lt; len; i++) {</span>
<span class="term-fg31">-        r[i].infinity = a[i].infinity;</span>
<span class="term-fg31">-        if (!a[i].infinity) {</span>
<span class="term-fg31">-            secp256k1_ge_set_gej_zinv(&amp;r[i], &amp;a[i], &amp;azi[count++]);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    free(azi);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_ge_set_table_gej_var(secp256k1_ge *r, const secp256k1_gej *a, const secp256k1_fe *zr, size_t len) {</span>
<span class="term-fg31">-    size_t i = len - 1;</span>
<span class="term-fg31">-    secp256k1_fe zi;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    if (len &gt; 0) {</span>
<span class="term-fg31">-        &#47;* Compute the inverse of the last z coordinate, and use it to compute the last affine output. *&#47;</span>
<span class="term-fg31">-        secp256k1_fe_inv(&amp;zi, &amp;a[i].z);</span>
<span class="term-fg31">-        secp256k1_ge_set_gej_zinv(&amp;r[i], &amp;a[i], &amp;zi);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        &#47;* Work out way backwards, using the z-ratios to scale the x&#47;y values. *&#47;</span>
<span class="term-fg31">-        while (i &gt; 0) {</span>
<span class="term-fg31">-            secp256k1_fe_mul(&amp;zi, &amp;zi, &amp;zr[i]);</span>
<span class="term-fg31">-            i--;</span>
<span class="term-fg31">-            secp256k1_ge_set_gej_zinv(&amp;r[i], &amp;a[i], &amp;zi);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_ge_globalz_set_table_gej(size_t len, secp256k1_ge *r, secp256k1_fe *globalz, const secp256k1_gej *a, const secp256k1_fe *zr) {</span>
<span class="term-fg31">-    size_t i = len - 1;</span>
<span class="term-fg31">-    secp256k1_fe zs;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    if (len &gt; 0) {</span>
<span class="term-fg31">-        &#47;* The z of the final point gives us the &quot;global Z&quot; for the table. *&#47;</span>
<span class="term-fg31">-        r[i].x = a[i].x;</span>
<span class="term-fg31">-        r[i].y = a[i].y;</span>
<span class="term-fg31">-        *globalz = a[i].z;</span>
<span class="term-fg31">-        r[i].infinity = 0;</span>
<span class="term-fg31">-        zs = zr[i];</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        &#47;* Work our way backwards, using the z-ratios to scale the x&#47;y values. *&#47;</span>
<span class="term-fg31">-        while (i &gt; 0) {</span>
<span class="term-fg31">-            if (i != len - 1) {</span>
<span class="term-fg31">-                secp256k1_fe_mul(&amp;zs, &amp;zs, &amp;zr[i]);</span>
<span class="term-fg31">-            }</span>
<span class="term-fg31">-            i--;</span>
<span class="term-fg31">-            secp256k1_ge_set_gej_zinv(&amp;r[i], &amp;a[i], &amp;zs);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_gej_set_infinity(secp256k1_gej *r) {</span>
<span class="term-fg31">-    r-&gt;infinity = 1;</span>
<span class="term-fg31">-    secp256k1_fe_clear(&amp;r-&gt;x);</span>
<span class="term-fg31">-    secp256k1_fe_clear(&amp;r-&gt;y);</span>
<span class="term-fg31">-    secp256k1_fe_clear(&amp;r-&gt;z);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_gej_clear(secp256k1_gej *r) {</span>
<span class="term-fg31">-    r-&gt;infinity = 0;</span>
<span class="term-fg31">-    secp256k1_fe_clear(&amp;r-&gt;x);</span>
<span class="term-fg31">-    secp256k1_fe_clear(&amp;r-&gt;y);</span>
<span class="term-fg31">-    secp256k1_fe_clear(&amp;r-&gt;z);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_ge_clear(secp256k1_ge *r) {</span>
<span class="term-fg31">-    r-&gt;infinity = 0;</span>
<span class="term-fg31">-    secp256k1_fe_clear(&amp;r-&gt;x);</span>
<span class="term-fg31">-    secp256k1_fe_clear(&amp;r-&gt;y);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_ge_set_xquad(secp256k1_ge *r, const secp256k1_fe *x) {</span>
<span class="term-fg31">-    secp256k1_fe x2, x3, c;</span>
<span class="term-fg31">-    r-&gt;x = *x;</span>
<span class="term-fg31">-    secp256k1_fe_sqr(&amp;x2, x);</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;x3, x, &amp;x2);</span>
<span class="term-fg31">-    r-&gt;infinity = 0;</span>
<span class="term-fg31">-    secp256k1_fe_set_int(&amp;c, CURVE_B);</span>
<span class="term-fg31">-    secp256k1_fe_add(&amp;c, &amp;x3);</span>
<span class="term-fg31">-    return secp256k1_fe_sqrt(&amp;r-&gt;y, &amp;c);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_ge_set_xo_var(secp256k1_ge *r, const secp256k1_fe *x, int odd) {</span>
<span class="term-fg31">-    if (!secp256k1_ge_set_xquad(r, x)) {</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_fe_normalize_var(&amp;r-&gt;y);</span>
<span class="term-fg31">-    if (secp256k1_fe_is_odd(&amp;r-&gt;y) != odd) {</span>
<span class="term-fg31">-        secp256k1_fe_negate(&amp;r-&gt;y, &amp;r-&gt;y, 1);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    return 1;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_gej_set_ge(secp256k1_gej *r, const secp256k1_ge *a) {</span>
<span class="term-fg31">-   r-&gt;infinity = a-&gt;infinity;</span>
<span class="term-fg31">-   r-&gt;x = a-&gt;x;</span>
<span class="term-fg31">-   r-&gt;y = a-&gt;y;</span>
<span class="term-fg31">-   secp256k1_fe_set_int(&amp;r-&gt;z, 1);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_gej_eq_x_var(const secp256k1_fe *x, const secp256k1_gej *a) {</span>
<span class="term-fg31">-    secp256k1_fe r, r2;</span>
<span class="term-fg31">-    VERIFY_CHECK(!a-&gt;infinity);</span>
<span class="term-fg31">-    secp256k1_fe_sqr(&amp;r, &amp;a-&gt;z); secp256k1_fe_mul(&amp;r, &amp;r, x);</span>
<span class="term-fg31">-    r2 = a-&gt;x; secp256k1_fe_normalize_weak(&amp;r2);</span>
<span class="term-fg31">-    return secp256k1_fe_equal_var(&amp;r, &amp;r2);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_gej_neg(secp256k1_gej *r, const secp256k1_gej *a) {</span>
<span class="term-fg31">-    r-&gt;infinity = a-&gt;infinity;</span>
<span class="term-fg31">-    r-&gt;x = a-&gt;x;</span>
<span class="term-fg31">-    r-&gt;y = a-&gt;y;</span>
<span class="term-fg31">-    r-&gt;z = a-&gt;z;</span>
<span class="term-fg31">-    secp256k1_fe_normalize_weak(&amp;r-&gt;y);</span>
<span class="term-fg31">-    secp256k1_fe_negate(&amp;r-&gt;y, &amp;r-&gt;y, 1);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_gej_is_infinity(const secp256k1_gej *a) {</span>
<span class="term-fg31">-    return a-&gt;infinity;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_gej_is_valid_var(const secp256k1_gej *a) {</span>
<span class="term-fg31">-    secp256k1_fe y2, x3, z2, z6;</span>
<span class="term-fg31">-    if (a-&gt;infinity) {</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    &#47;** y^2 = x^3 + 7</span>
<span class="term-fg31">-     *  (Y&#47;Z^3)^2 = (X&#47;Z^2)^3 + 7</span>
<span class="term-fg31">-     *  Y^2 &#47; Z^6 = X^3 &#47; Z^6 + 7</span>
<span class="term-fg31">-     *  Y^2 = X^3 + 7*Z^6</span>
<span class="term-fg31">-     *&#47;</span>
<span class="term-fg31">-    secp256k1_fe_sqr(&amp;y2, &amp;a-&gt;y);</span>
<span class="term-fg31">-    secp256k1_fe_sqr(&amp;x3, &amp;a-&gt;x); secp256k1_fe_mul(&amp;x3, &amp;x3, &amp;a-&gt;x);</span>
<span class="term-fg31">-    secp256k1_fe_sqr(&amp;z2, &amp;a-&gt;z);</span>
<span class="term-fg31">-    secp256k1_fe_sqr(&amp;z6, &amp;z2); secp256k1_fe_mul(&amp;z6, &amp;z6, &amp;z2);</span>
<span class="term-fg31">-    secp256k1_fe_mul_int(&amp;z6, CURVE_B);</span>
<span class="term-fg31">-    secp256k1_fe_add(&amp;x3, &amp;z6);</span>
<span class="term-fg31">-    secp256k1_fe_normalize_weak(&amp;x3);</span>
<span class="term-fg31">-    return secp256k1_fe_equal_var(&amp;y2, &amp;x3);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_ge_is_valid_var(const secp256k1_ge *a) {</span>
<span class="term-fg31">-    secp256k1_fe y2, x3, c;</span>
<span class="term-fg31">-    if (a-&gt;infinity) {</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    &#47;* y^2 = x^3 + 7 *&#47;</span>
<span class="term-fg31">-    secp256k1_fe_sqr(&amp;y2, &amp;a-&gt;y);</span>
<span class="term-fg31">-    secp256k1_fe_sqr(&amp;x3, &amp;a-&gt;x); secp256k1_fe_mul(&amp;x3, &amp;x3, &amp;a-&gt;x);</span>
<span class="term-fg31">-    secp256k1_fe_set_int(&amp;c, CURVE_B);</span>
<span class="term-fg31">-    secp256k1_fe_add(&amp;x3, &amp;c);</span>
<span class="term-fg31">-    secp256k1_fe_normalize_weak(&amp;x3);</span>
<span class="term-fg31">-    return secp256k1_fe_equal_var(&amp;y2, &amp;x3);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_gej_double_var(secp256k1_gej *r, const secp256k1_gej *a, secp256k1_fe *rzr) {</span>
<span class="term-fg31">-    &#47;* Operations: 3 mul, 4 sqr, 0 normalize, 12 mul_int&#47;add&#47;negate.</span>
<span class="term-fg31">-     *</span>
<span class="term-fg31">-     * Note that there is an implementation described at</span>
<span class="term-fg31">-     *     https:&#47;&#47;hyperelliptic.org&#47;EFD&#47;g1p&#47;auto-shortw-jacobian-0.html#doubling-dbl-2009-l</span>
<span class="term-fg31">-     * which trades a multiply for a square, but in practice this is actually slower,</span>
<span class="term-fg31">-     * mainly because it requires more normalizations.</span>
<span class="term-fg31">-     *&#47;</span>
<span class="term-fg31">-    secp256k1_fe t1,t2,t3,t4;</span>
<span class="term-fg31">-    &#47;** For secp256k1, 2Q is infinity if and only if Q is infinity. This is because if 2Q = infinity,</span>
<span class="term-fg31">-     *  Q must equal -Q, or that Q.y == -(Q.y), or Q.y is 0. For a point on y^2 = x^3 + 7 to have</span>
<span class="term-fg31">-     *  y=0, x^3 must be -7 mod p. However, -7 has no cube root mod p.</span>
<span class="term-fg31">-     *</span>
<span class="term-fg31">-     *  Having said this, if this function receives a point on a sextic twist, e.g. by</span>
<span class="term-fg31">-     *  a fault attack, it is possible for y to be 0. This happens for y^2 = x^3 + 6,</span>
<span class="term-fg31">-     *  since -6 does have a cube root mod p. For this point, this function will not set</span>
<span class="term-fg31">-     *  the infinity flag even though the point doubles to infinity, and the result</span>
<span class="term-fg31">-     *  point will be gibberish (z = 0 but infinity = 0).</span>
<span class="term-fg31">-     *&#47;</span>
<span class="term-fg31">-    r-&gt;infinity = a-&gt;infinity;</span>
<span class="term-fg31">-    if (r-&gt;infinity) {</span>
<span class="term-fg31">-        if (rzr != NULL) {</span>
<span class="term-fg31">-            secp256k1_fe_set_int(rzr, 1);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        return;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    if (rzr != NULL) {</span>
<span class="term-fg31">-        *rzr = a-&gt;y;</span>
<span class="term-fg31">-        secp256k1_fe_normalize_weak(rzr);</span>
<span class="term-fg31">-        secp256k1_fe_mul_int(rzr, 2);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;r-&gt;z, &amp;a-&gt;z, &amp;a-&gt;y);</span>
<span class="term-fg31">-    secp256k1_fe_mul_int(&amp;r-&gt;z, 2);       &#47;* Z&#39; = 2*Y*Z (2) *&#47;</span>
<span class="term-fg31">-    secp256k1_fe_sqr(&amp;t1, &amp;a-&gt;x);</span>
<span class="term-fg31">-    secp256k1_fe_mul_int(&amp;t1, 3);         &#47;* T1 = 3*X^2 (3) *&#47;</span>
<span class="term-fg31">-    secp256k1_fe_sqr(&amp;t2, &amp;t1);           &#47;* T2 = 9*X^4 (1) *&#47;</span>
<span class="term-fg31">-    secp256k1_fe_sqr(&amp;t3, &amp;a-&gt;y);</span>
<span class="term-fg31">-    secp256k1_fe_mul_int(&amp;t3, 2);         &#47;* T3 = 2*Y^2 (2) *&#47;</span>
<span class="term-fg31">-    secp256k1_fe_sqr(&amp;t4, &amp;t3);</span>
<span class="term-fg31">-    secp256k1_fe_mul_int(&amp;t4, 2);         &#47;* T4 = 8*Y^4 (2) *&#47;</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;t3, &amp;t3, &amp;a-&gt;x);    &#47;* T3 = 2*X*Y^2 (1) *&#47;</span>
<span class="term-fg31">-    r-&gt;x = t3;</span>
<span class="term-fg31">-    secp256k1_fe_mul_int(&amp;r-&gt;x, 4);       &#47;* X&#39; = 8*X*Y^2 (4) *&#47;</span>
<span class="term-fg31">-    secp256k1_fe_negate(&amp;r-&gt;x, &amp;r-&gt;x, 4); &#47;* X&#39; = -8*X*Y^2 (5) *&#47;</span>
<span class="term-fg31">-    secp256k1_fe_add(&amp;r-&gt;x, &amp;t2);         &#47;* X&#39; = 9*X^4 - 8*X*Y^2 (6) *&#47;</span>
<span class="term-fg31">-    secp256k1_fe_negate(&amp;t2, &amp;t2, 1);     &#47;* T2 = -9*X^4 (2) *&#47;</span>
<span class="term-fg31">-    secp256k1_fe_mul_int(&amp;t3, 6);         &#47;* T3 = 12*X*Y^2 (6) *&#47;</span>
<span class="term-fg31">-    secp256k1_fe_add(&amp;t3, &amp;t2);           &#47;* T3 = 12*X*Y^2 - 9*X^4 (8) *&#47;</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;r-&gt;y, &amp;t1, &amp;t3);    &#47;* Y&#39; = 36*X^3*Y^2 - 27*X^6 (1) *&#47;</span>
<span class="term-fg31">-    secp256k1_fe_negate(&amp;t2, &amp;t4, 2);     &#47;* T2 = -8*Y^4 (3) *&#47;</span>
<span class="term-fg31">-    secp256k1_fe_add(&amp;r-&gt;y, &amp;t2);         &#47;* Y&#39; = 36*X^3*Y^2 - 27*X^6 - 8*Y^4 (4) *&#47;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static SECP256K1_INLINE void secp256k1_gej_double_nonzero(secp256k1_gej *r, const secp256k1_gej *a, secp256k1_fe *rzr) {</span>
<span class="term-fg31">-    VERIFY_CHECK(!secp256k1_gej_is_infinity(a));</span>
<span class="term-fg31">-    secp256k1_gej_double_var(r, a, rzr);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_gej_add_var(secp256k1_gej *r, const secp256k1_gej *a, const secp256k1_gej *b, secp256k1_fe *rzr) {</span>
<span class="term-fg31">-    &#47;* Operations: 12 mul, 4 sqr, 2 normalize, 12 mul_int&#47;add&#47;negate *&#47;</span>
<span class="term-fg31">-    secp256k1_fe z22, z12, u1, u2, s1, s2, h, i, i2, h2, h3, t;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    if (a-&gt;infinity) {</span>
<span class="term-fg31">-        VERIFY_CHECK(rzr == NULL);</span>
<span class="term-fg31">-        *r = *b;</span>
<span class="term-fg31">-        return;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    if (b-&gt;infinity) {</span>
<span class="term-fg31">-        if (rzr != NULL) {</span>
<span class="term-fg31">-            secp256k1_fe_set_int(rzr, 1);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        *r = *a;</span>
<span class="term-fg31">-        return;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    r-&gt;infinity = 0;</span>
<span class="term-fg31">-    secp256k1_fe_sqr(&amp;z22, &amp;b-&gt;z);</span>
<span class="term-fg31">-    secp256k1_fe_sqr(&amp;z12, &amp;a-&gt;z);</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;u1, &amp;a-&gt;x, &amp;z22);</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;u2, &amp;b-&gt;x, &amp;z12);</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;s1, &amp;a-&gt;y, &amp;z22); secp256k1_fe_mul(&amp;s1, &amp;s1, &amp;b-&gt;z);</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;s2, &amp;b-&gt;y, &amp;z12); secp256k1_fe_mul(&amp;s2, &amp;s2, &amp;a-&gt;z);</span>
<span class="term-fg31">-    secp256k1_fe_negate(&amp;h, &amp;u1, 1); secp256k1_fe_add(&amp;h, &amp;u2);</span>
<span class="term-fg31">-    secp256k1_fe_negate(&amp;i, &amp;s1, 1); secp256k1_fe_add(&amp;i, &amp;s2);</span>
<span class="term-fg31">-    if (secp256k1_fe_normalizes_to_zero_var(&amp;h)) {</span>
<span class="term-fg31">-        if (secp256k1_fe_normalizes_to_zero_var(&amp;i)) {</span>
<span class="term-fg31">-            secp256k1_gej_double_var(r, a, rzr);</span>
<span class="term-fg31">-        } else {</span>
<span class="term-fg31">-            if (rzr != NULL) {</span>
<span class="term-fg31">-                secp256k1_fe_set_int(rzr, 0);</span>
<span class="term-fg31">-            }</span>
<span class="term-fg31">-            r-&gt;infinity = 1;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        return;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_fe_sqr(&amp;i2, &amp;i);</span>
<span class="term-fg31">-    secp256k1_fe_sqr(&amp;h2, &amp;h);</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;h3, &amp;h, &amp;h2);</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;h, &amp;h, &amp;b-&gt;z);</span>
<span class="term-fg31">-    if (rzr != NULL) {</span>
<span class="term-fg31">-        *rzr = h;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;r-&gt;z, &amp;a-&gt;z, &amp;h);</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;t, &amp;u1, &amp;h2);</span>
<span class="term-fg31">-    r-&gt;x = t; secp256k1_fe_mul_int(&amp;r-&gt;x, 2); secp256k1_fe_add(&amp;r-&gt;x, &amp;h3); secp256k1_fe_negate(&amp;r-&gt;x, &amp;r-&gt;x, 3); secp256k1_fe_add(&amp;r-&gt;x, &amp;i2);</span>
<span class="term-fg31">-    secp256k1_fe_negate(&amp;r-&gt;y, &amp;r-&gt;x, 5); secp256k1_fe_add(&amp;r-&gt;y, &amp;t); secp256k1_fe_mul(&amp;r-&gt;y, &amp;r-&gt;y, &amp;i);</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;h3, &amp;h3, &amp;s1); secp256k1_fe_negate(&amp;h3, &amp;h3, 1);</span>
<span class="term-fg31">-    secp256k1_fe_add(&amp;r-&gt;y, &amp;h3);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_gej_add_ge_var(secp256k1_gej *r, const secp256k1_gej *a, const secp256k1_ge *b, secp256k1_fe *rzr) {</span>
<span class="term-fg31">-    &#47;* 8 mul, 3 sqr, 4 normalize, 12 mul_int&#47;add&#47;negate *&#47;</span>
<span class="term-fg31">-    secp256k1_fe z12, u1, u2, s1, s2, h, i, i2, h2, h3, t;</span>
<span class="term-fg31">-    if (a-&gt;infinity) {</span>
<span class="term-fg31">-        VERIFY_CHECK(rzr == NULL);</span>
<span class="term-fg31">-        secp256k1_gej_set_ge(r, b);</span>
<span class="term-fg31">-        return;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    if (b-&gt;infinity) {</span>
<span class="term-fg31">-        if (rzr != NULL) {</span>
<span class="term-fg31">-            secp256k1_fe_set_int(rzr, 1);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        *r = *a;</span>
<span class="term-fg31">-        return;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    r-&gt;infinity = 0;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_fe_sqr(&amp;z12, &amp;a-&gt;z);</span>
<span class="term-fg31">-    u1 = a-&gt;x; secp256k1_fe_normalize_weak(&amp;u1);</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;u2, &amp;b-&gt;x, &amp;z12);</span>
<span class="term-fg31">-    s1 = a-&gt;y; secp256k1_fe_normalize_weak(&amp;s1);</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;s2, &amp;b-&gt;y, &amp;z12); secp256k1_fe_mul(&amp;s2, &amp;s2, &amp;a-&gt;z);</span>
<span class="term-fg31">-    secp256k1_fe_negate(&amp;h, &amp;u1, 1); secp256k1_fe_add(&amp;h, &amp;u2);</span>
<span class="term-fg31">-    secp256k1_fe_negate(&amp;i, &amp;s1, 1); secp256k1_fe_add(&amp;i, &amp;s2);</span>
<span class="term-fg31">-    if (secp256k1_fe_normalizes_to_zero_var(&amp;h)) {</span>
<span class="term-fg31">-        if (secp256k1_fe_normalizes_to_zero_var(&amp;i)) {</span>
<span class="term-fg31">-            secp256k1_gej_double_var(r, a, rzr);</span>
<span class="term-fg31">-        } else {</span>
<span class="term-fg31">-            if (rzr != NULL) {</span>
<span class="term-fg31">-                secp256k1_fe_set_int(rzr, 0);</span>
<span class="term-fg31">-            }</span>
<span class="term-fg31">-            r-&gt;infinity = 1;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        return;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_fe_sqr(&amp;i2, &amp;i);</span>
<span class="term-fg31">-    secp256k1_fe_sqr(&amp;h2, &amp;h);</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;h3, &amp;h, &amp;h2);</span>
<span class="term-fg31">-    if (rzr != NULL) {</span>
<span class="term-fg31">-        *rzr = h;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;r-&gt;z, &amp;a-&gt;z, &amp;h);</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;t, &amp;u1, &amp;h2);</span>
<span class="term-fg31">-    r-&gt;x = t; secp256k1_fe_mul_int(&amp;r-&gt;x, 2); secp256k1_fe_add(&amp;r-&gt;x, &amp;h3); secp256k1_fe_negate(&amp;r-&gt;x, &amp;r-&gt;x, 3); secp256k1_fe_add(&amp;r-&gt;x, &amp;i2);</span>
<span class="term-fg31">-    secp256k1_fe_negate(&amp;r-&gt;y, &amp;r-&gt;x, 5); secp256k1_fe_add(&amp;r-&gt;y, &amp;t); secp256k1_fe_mul(&amp;r-&gt;y, &amp;r-&gt;y, &amp;i);</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;h3, &amp;h3, &amp;s1); secp256k1_fe_negate(&amp;h3, &amp;h3, 1);</span>
<span class="term-fg31">-    secp256k1_fe_add(&amp;r-&gt;y, &amp;h3);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_gej_add_zinv_var(secp256k1_gej *r, const secp256k1_gej *a, const secp256k1_ge *b, const secp256k1_fe *bzinv) {</span>
<span class="term-fg31">-    &#47;* 9 mul, 3 sqr, 4 normalize, 12 mul_int&#47;add&#47;negate *&#47;</span>
<span class="term-fg31">-    secp256k1_fe az, z12, u1, u2, s1, s2, h, i, i2, h2, h3, t;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    if (b-&gt;infinity) {</span>
<span class="term-fg31">-        *r = *a;</span>
<span class="term-fg31">-        return;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    if (a-&gt;infinity) {</span>
<span class="term-fg31">-        secp256k1_fe bzinv2, bzinv3;</span>
<span class="term-fg31">-        r-&gt;infinity = b-&gt;infinity;</span>
<span class="term-fg31">-        secp256k1_fe_sqr(&amp;bzinv2, bzinv);</span>
<span class="term-fg31">-        secp256k1_fe_mul(&amp;bzinv3, &amp;bzinv2, bzinv);</span>
<span class="term-fg31">-        secp256k1_fe_mul(&amp;r-&gt;x, &amp;b-&gt;x, &amp;bzinv2);</span>
<span class="term-fg31">-        secp256k1_fe_mul(&amp;r-&gt;y, &amp;b-&gt;y, &amp;bzinv3);</span>
<span class="term-fg31">-        secp256k1_fe_set_int(&amp;r-&gt;z, 1);</span>
<span class="term-fg31">-        return;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    r-&gt;infinity = 0;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;** We need to calculate (rx,ry,rz) = (ax,ay,az) + (bx,by,1&#47;bzinv). Due to</span>
<span class="term-fg31">-     *  secp256k1&#39;s isomorphism we can multiply the Z coordinates on both sides</span>
<span class="term-fg31">-     *  by bzinv, and get: (rx,ry,rz*bzinv) = (ax,ay,az*bzinv) + (bx,by,1).</span>
<span class="term-fg31">-     *  This means that (rx,ry,rz) can be calculated as</span>
<span class="term-fg31">-     *  (ax,ay,az*bzinv) + (bx,by,1), when not applying the bzinv factor to rz.</span>
<span class="term-fg31">-     *  The variable az below holds the modified Z coordinate for a, which is used</span>
<span class="term-fg31">-     *  for the computation of rx and ry, but not for rz.</span>
<span class="term-fg31">-     *&#47;</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;az, &amp;a-&gt;z, bzinv);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_fe_sqr(&amp;z12, &amp;az);</span>
<span class="term-fg31">-    u1 = a-&gt;x; secp256k1_fe_normalize_weak(&amp;u1);</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;u2, &amp;b-&gt;x, &amp;z12);</span>
<span class="term-fg31">-    s1 = a-&gt;y; secp256k1_fe_normalize_weak(&amp;s1);</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;s2, &amp;b-&gt;y, &amp;z12); secp256k1_fe_mul(&amp;s2, &amp;s2, &amp;az);</span>
<span class="term-fg31">-    secp256k1_fe_negate(&amp;h, &amp;u1, 1); secp256k1_fe_add(&amp;h, &amp;u2);</span>
<span class="term-fg31">-    secp256k1_fe_negate(&amp;i, &amp;s1, 1); secp256k1_fe_add(&amp;i, &amp;s2);</span>
<span class="term-fg31">-    if (secp256k1_fe_normalizes_to_zero_var(&amp;h)) {</span>
<span class="term-fg31">-        if (secp256k1_fe_normalizes_to_zero_var(&amp;i)) {</span>
<span class="term-fg31">-            secp256k1_gej_double_var(r, a, NULL);</span>
<span class="term-fg31">-        } else {</span>
<span class="term-fg31">-            r-&gt;infinity = 1;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        return;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_fe_sqr(&amp;i2, &amp;i);</span>
<span class="term-fg31">-    secp256k1_fe_sqr(&amp;h2, &amp;h);</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;h3, &amp;h, &amp;h2);</span>
<span class="term-fg31">-    r-&gt;z = a-&gt;z; secp256k1_fe_mul(&amp;r-&gt;z, &amp;r-&gt;z, &amp;h);</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;t, &amp;u1, &amp;h2);</span>
<span class="term-fg31">-    r-&gt;x = t; secp256k1_fe_mul_int(&amp;r-&gt;x, 2); secp256k1_fe_add(&amp;r-&gt;x, &amp;h3); secp256k1_fe_negate(&amp;r-&gt;x, &amp;r-&gt;x, 3); secp256k1_fe_add(&amp;r-&gt;x, &amp;i2);</span>
<span class="term-fg31">-    secp256k1_fe_negate(&amp;r-&gt;y, &amp;r-&gt;x, 5); secp256k1_fe_add(&amp;r-&gt;y, &amp;t); secp256k1_fe_mul(&amp;r-&gt;y, &amp;r-&gt;y, &amp;i);</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;h3, &amp;h3, &amp;s1); secp256k1_fe_negate(&amp;h3, &amp;h3, 1);</span>
<span class="term-fg31">-    secp256k1_fe_add(&amp;r-&gt;y, &amp;h3);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_gej_add_ge(secp256k1_gej *r, const secp256k1_gej *a, const secp256k1_ge *b) {</span>
<span class="term-fg31">-    &#47;* Operations: 7 mul, 5 sqr, 4 normalize, 21 mul_int&#47;add&#47;negate&#47;cmov *&#47;</span>
<span class="term-fg31">-    static const secp256k1_fe fe_1 = SECP256K1_FE_CONST(0, 0, 0, 0, 0, 0, 0, 1);</span>
<span class="term-fg31">-    secp256k1_fe zz, u1, u2, s1, s2, t, tt, m, n, q, rr;</span>
<span class="term-fg31">-    secp256k1_fe m_alt, rr_alt;</span>
<span class="term-fg31">-    int infinity, degenerate;</span>
<span class="term-fg31">-    VERIFY_CHECK(!b-&gt;infinity);</span>
<span class="term-fg31">-    VERIFY_CHECK(a-&gt;infinity == 0 || a-&gt;infinity == 1);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;** In:</span>
<span class="term-fg31">-     *    Eric Brier and Marc Joye, Weierstrass Elliptic Curves and Side-Channel Attacks.</span>
<span class="term-fg31">-     *    In D. Naccache and P. Paillier, Eds., Public Key Cryptography, vol. 2274 of Lecture Notes in Computer Science, pages 335-345. Springer-Verlag, 2002.</span>
<span class="term-fg31">-     *  we find as solution for a unified addition&#47;doubling formula:</span>
<span class="term-fg31">-     *    lambda = ((x1 + x2)^2 - x1 * x2 + a) &#47; (y1 + y2), with a = 0 for secp256k1&#39;s curve equation.</span>
<span class="term-fg31">-     *    x3 = lambda^2 - (x1 + x2)</span>
<span class="term-fg31">-     *    2*y3 = lambda * (x1 + x2 - 2 * x3) - (y1 + y2).</span>
<span class="term-fg31">-     *</span>
<span class="term-fg31">-     *  Substituting x_i = Xi &#47; Zi^2 and yi = Yi &#47; Zi^3, for i=1,2,3, gives:</span>
<span class="term-fg31">-     *    U1 = X1*Z2^2, U2 = X2*Z1^2</span>
<span class="term-fg31">-     *    S1 = Y1*Z2^3, S2 = Y2*Z1^3</span>
<span class="term-fg31">-     *    Z = Z1*Z2</span>
<span class="term-fg31">-     *    T = U1+U2</span>
<span class="term-fg31">-     *    M = S1+S2</span>
<span class="term-fg31">-     *    Q = T*M^2</span>
<span class="term-fg31">-     *    R = T^2-U1*U2</span>
<span class="term-fg31">-     *    X3 = 4*(R^2-Q)</span>
<span class="term-fg31">-     *    Y3 = 4*(R*(3*Q-2*R^2)-M^4)</span>
<span class="term-fg31">-     *    Z3 = 2*M*Z</span>
<span class="term-fg31">-     *  (Note that the paper uses xi = Xi &#47; Zi and yi = Yi &#47; Zi instead.)</span>
<span class="term-fg31">-     *</span>
<span class="term-fg31">-     *  This formula has the benefit of being the same for both addition</span>
<span class="term-fg31">-     *  of distinct points and doubling. However, it breaks down in the</span>
<span class="term-fg31">-     *  case that either point is infinity, or that y1 = -y2. We handle</span>
<span class="term-fg31">-     *  these cases in the following ways:</span>
<span class="term-fg31">-     *</span>
<span class="term-fg31">-     *    - If b is infinity we simply bail by means of a VERIFY_CHECK.</span>
<span class="term-fg31">-     *</span>
<span class="term-fg31">-     *    - If a is infinity, we detect this, and at the end of the</span>
<span class="term-fg31">-     *      computation replace the result (which will be meaningless,</span>
<span class="term-fg31">-     *      but we compute to be constant-time) with b.x : b.y : 1.</span>
<span class="term-fg31">-     *</span>
<span class="term-fg31">-     *    - If a = -b, we have y1 = -y2, which is a degenerate case.</span>
<span class="term-fg31">-     *      But here the answer is infinity, so we simply set the</span>
<span class="term-fg31">-     *      infinity flag of the result, overriding the computed values</span>
<span class="term-fg31">-     *      without even needing to cmov.</span>
<span class="term-fg31">-     *</span>
<span class="term-fg31">-     *    - If y1 = -y2 but x1 != x2, which does occur thanks to certain</span>
<span class="term-fg31">-     *      properties of our curve (specifically, 1 has nontrivial cube</span>
<span class="term-fg31">-     *      roots in our field, and the curve equation has no x coefficient)</span>
<span class="term-fg31">-     *      then the answer is not infinity but also not given by the above</span>
<span class="term-fg31">-     *      equation. In this case, we cmov in place an alternate expression</span>
<span class="term-fg31">-     *      for lambda. Specifically (y1 - y2)&#47;(x1 - x2). Where both these</span>
<span class="term-fg31">-     *      expressions for lambda are defined, they are equal, and can be</span>
<span class="term-fg31">-     *      obtained from each other by multiplication by (y1 + y2)&#47;(y1 + y2)</span>
<span class="term-fg31">-     *      then substitution of x^3 + 7 for y^2 (using the curve equation).</span>
<span class="term-fg31">-     *      For all pairs of nonzero points (a, b) at least one is defined,</span>
<span class="term-fg31">-     *      so this covers everything.</span>
<span class="term-fg31">-     *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_fe_sqr(&amp;zz, &amp;a-&gt;z);                       &#47;* z = Z1^2 *&#47;</span>
<span class="term-fg31">-    u1 = a-&gt;x; secp256k1_fe_normalize_weak(&amp;u1);        &#47;* u1 = U1 = X1*Z2^2 (1) *&#47;</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;u2, &amp;b-&gt;x, &amp;zz);                  &#47;* u2 = U2 = X2*Z1^2 (1) *&#47;</span>
<span class="term-fg31">-    s1 = a-&gt;y; secp256k1_fe_normalize_weak(&amp;s1);        &#47;* s1 = S1 = Y1*Z2^3 (1) *&#47;</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;s2, &amp;b-&gt;y, &amp;zz);                  &#47;* s2 = Y2*Z1^2 (1) *&#47;</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;s2, &amp;s2, &amp;a-&gt;z);                  &#47;* s2 = S2 = Y2*Z1^3 (1) *&#47;</span>
<span class="term-fg31">-    t = u1; secp256k1_fe_add(&amp;t, &amp;u2);                  &#47;* t = T = U1+U2 (2) *&#47;</span>
<span class="term-fg31">-    m = s1; secp256k1_fe_add(&amp;m, &amp;s2);                  &#47;* m = M = S1+S2 (2) *&#47;</span>
<span class="term-fg31">-    secp256k1_fe_sqr(&amp;rr, &amp;t);                          &#47;* rr = T^2 (1) *&#47;</span>
<span class="term-fg31">-    secp256k1_fe_negate(&amp;m_alt, &amp;u2, 1);                &#47;* Malt = -X2*Z1^2 *&#47;</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;tt, &amp;u1, &amp;m_alt);                 &#47;* tt = -U1*U2 (2) *&#47;</span>
<span class="term-fg31">-    secp256k1_fe_add(&amp;rr, &amp;tt);                         &#47;* rr = R = T^2-U1*U2 (3) *&#47;</span>
<span class="term-fg31">-    &#47;** If lambda = R&#47;M = 0&#47;0 we have a problem (except in the &quot;trivial&quot;</span>
<span class="term-fg31">-     *  case that Z = z1z2 = 0, and this is special-cased later on). *&#47;</span>
<span class="term-fg31">-    degenerate = secp256k1_fe_normalizes_to_zero(&amp;m) &amp;</span>
<span class="term-fg31">-                 secp256k1_fe_normalizes_to_zero(&amp;rr);</span>
<span class="term-fg31">-    &#47;* This only occurs when y1 == -y2 and x1^3 == x2^3, but x1 != x2.</span>
<span class="term-fg31">-     * This means either x1 == beta*x2 or beta*x1 == x2, where beta is</span>
<span class="term-fg31">-     * a nontrivial cube root of one. In either case, an alternate</span>
<span class="term-fg31">-     * non-indeterminate expression for lambda is (y1 - y2)&#47;(x1 - x2),</span>
<span class="term-fg31">-     * so we set R&#47;M equal to this. *&#47;</span>
<span class="term-fg31">-    rr_alt = s1;</span>
<span class="term-fg31">-    secp256k1_fe_mul_int(&amp;rr_alt, 2);       &#47;* rr = Y1*Z2^3 - Y2*Z1^3 (2) *&#47;</span>
<span class="term-fg31">-    secp256k1_fe_add(&amp;m_alt, &amp;u1);          &#47;* Malt = X1*Z2^2 - X2*Z1^2 *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_fe_cmov(&amp;rr_alt, &amp;rr, !degenerate);</span>
<span class="term-fg31">-    secp256k1_fe_cmov(&amp;m_alt, &amp;m, !degenerate);</span>
<span class="term-fg31">-    &#47;* Now Ralt &#47; Malt = lambda and is guaranteed not to be 0&#47;0.</span>
<span class="term-fg31">-     * From here on out Ralt and Malt represent the numerator</span>
<span class="term-fg31">-     * and denominator of lambda; R and M represent the explicit</span>
<span class="term-fg31">-     * expressions x1^2 + x2^2 + x1x2 and y1 + y2. *&#47;</span>
<span class="term-fg31">-    secp256k1_fe_sqr(&amp;n, &amp;m_alt);                       &#47;* n = Malt^2 (1) *&#47;</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;q, &amp;n, &amp;t);                       &#47;* q = Q = T*Malt^2 (1) *&#47;</span>
<span class="term-fg31">-    &#47;* These two lines use the observation that either M == Malt or M == 0,</span>
<span class="term-fg31">-     * so M^3 * Malt is either Malt^4 (which is computed by squaring), or</span>
<span class="term-fg31">-     * zero (which is &quot;computed&quot; by cmov). So the cost is one squaring</span>
<span class="term-fg31">-     * versus two multiplications. *&#47;</span>
<span class="term-fg31">-    secp256k1_fe_sqr(&amp;n, &amp;n);</span>
<span class="term-fg31">-    secp256k1_fe_cmov(&amp;n, &amp;m, degenerate);              &#47;* n = M^3 * Malt (2) *&#47;</span>
<span class="term-fg31">-    secp256k1_fe_sqr(&amp;t, &amp;rr_alt);                      &#47;* t = Ralt^2 (1) *&#47;</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;r-&gt;z, &amp;a-&gt;z, &amp;m_alt);             &#47;* r-&gt;z = Malt*Z (1) *&#47;</span>
<span class="term-fg31">-    infinity = secp256k1_fe_normalizes_to_zero(&amp;r-&gt;z) * (1 - a-&gt;infinity);</span>
<span class="term-fg31">-    secp256k1_fe_mul_int(&amp;r-&gt;z, 2);                     &#47;* r-&gt;z = Z3 = 2*Malt*Z (2) *&#47;</span>
<span class="term-fg31">-    secp256k1_fe_negate(&amp;q, &amp;q, 1);                     &#47;* q = -Q (2) *&#47;</span>
<span class="term-fg31">-    secp256k1_fe_add(&amp;t, &amp;q);                           &#47;* t = Ralt^2-Q (3) *&#47;</span>
<span class="term-fg31">-    secp256k1_fe_normalize_weak(&amp;t);</span>
<span class="term-fg31">-    r-&gt;x = t;                                           &#47;* r-&gt;x = Ralt^2-Q (1) *&#47;</span>
<span class="term-fg31">-    secp256k1_fe_mul_int(&amp;t, 2);                        &#47;* t = 2*x3 (2) *&#47;</span>
<span class="term-fg31">-    secp256k1_fe_add(&amp;t, &amp;q);                           &#47;* t = 2*x3 - Q: (4) *&#47;</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;t, &amp;t, &amp;rr_alt);                  &#47;* t = Ralt*(2*x3 - Q) (1) *&#47;</span>
<span class="term-fg31">-    secp256k1_fe_add(&amp;t, &amp;n);                           &#47;* t = Ralt*(2*x3 - Q) + M^3*Malt (3) *&#47;</span>
<span class="term-fg31">-    secp256k1_fe_negate(&amp;r-&gt;y, &amp;t, 3);                  &#47;* r-&gt;y = Ralt*(Q - 2x3) - M^3*Malt (4) *&#47;</span>
<span class="term-fg31">-    secp256k1_fe_normalize_weak(&amp;r-&gt;y);</span>
<span class="term-fg31">-    secp256k1_fe_mul_int(&amp;r-&gt;x, 4);                     &#47;* r-&gt;x = X3 = 4*(Ralt^2-Q) *&#47;</span>
<span class="term-fg31">-    secp256k1_fe_mul_int(&amp;r-&gt;y, 4);                     &#47;* r-&gt;y = Y3 = 4*Ralt*(Q - 2x3) - 4*M^3*Malt (4) *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;** In case a-&gt;infinity == 1, replace r with (b-&gt;x, b-&gt;y, 1). *&#47;</span>
<span class="term-fg31">-    secp256k1_fe_cmov(&amp;r-&gt;x, &amp;b-&gt;x, a-&gt;infinity);</span>
<span class="term-fg31">-    secp256k1_fe_cmov(&amp;r-&gt;y, &amp;b-&gt;y, a-&gt;infinity);</span>
<span class="term-fg31">-    secp256k1_fe_cmov(&amp;r-&gt;z, &amp;fe_1, a-&gt;infinity);</span>
<span class="term-fg31">-    r-&gt;infinity = infinity;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_gej_rescale(secp256k1_gej *r, const secp256k1_fe *s) {</span>
<span class="term-fg31">-    &#47;* Operations: 4 mul, 1 sqr *&#47;</span>
<span class="term-fg31">-    secp256k1_fe zz;</span>
<span class="term-fg31">-    VERIFY_CHECK(!secp256k1_fe_is_zero(s));</span>
<span class="term-fg31">-    secp256k1_fe_sqr(&amp;zz, s);</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;r-&gt;x, &amp;r-&gt;x, &amp;zz);                &#47;* r-&gt;x *= s^2 *&#47;</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;r-&gt;y, &amp;r-&gt;y, &amp;zz);</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;r-&gt;y, &amp;r-&gt;y, s);                  &#47;* r-&gt;y *= s^3 *&#47;</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;r-&gt;z, &amp;r-&gt;z, s);                  &#47;* r-&gt;z *= s   *&#47;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_ge_to_storage(secp256k1_ge_storage *r, const secp256k1_ge *a) {</span>
<span class="term-fg31">-    secp256k1_fe x, y;</span>
<span class="term-fg31">-    VERIFY_CHECK(!a-&gt;infinity);</span>
<span class="term-fg31">-    x = a-&gt;x;</span>
<span class="term-fg31">-    secp256k1_fe_normalize(&amp;x);</span>
<span class="term-fg31">-    y = a-&gt;y;</span>
<span class="term-fg31">-    secp256k1_fe_normalize(&amp;y);</span>
<span class="term-fg31">-    secp256k1_fe_to_storage(&amp;r-&gt;x, &amp;x);</span>
<span class="term-fg31">-    secp256k1_fe_to_storage(&amp;r-&gt;y, &amp;y);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_ge_from_storage(secp256k1_ge *r, const secp256k1_ge_storage *a) {</span>
<span class="term-fg31">-    secp256k1_fe_from_storage(&amp;r-&gt;x, &amp;a-&gt;x);</span>
<span class="term-fg31">-    secp256k1_fe_from_storage(&amp;r-&gt;y, &amp;a-&gt;y);</span>
<span class="term-fg31">-    r-&gt;infinity = 0;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static SECP256K1_INLINE void secp256k1_ge_storage_cmov(secp256k1_ge_storage *r, const secp256k1_ge_storage *a, int flag) {</span>
<span class="term-fg31">-    secp256k1_fe_storage_cmov(&amp;r-&gt;x, &amp;a-&gt;x, flag);</span>
<span class="term-fg31">-    secp256k1_fe_storage_cmov(&amp;r-&gt;y, &amp;a-&gt;y, flag);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef USE_ENDOMORPHISM</span>
<span class="term-fg31">-static void secp256k1_ge_mul_lambda(secp256k1_ge *r, const secp256k1_ge *a) {</span>
<span class="term-fg31">-    static const secp256k1_fe beta = SECP256K1_FE_CONST(</span>
<span class="term-fg31">-        0x7ae96a2bul, 0x657c0710ul, 0x6e64479eul, 0xac3434e9ul,</span>
<span class="term-fg31">-        0x9cf04975ul, 0x12f58995ul, 0xc1396c28ul, 0x719501eeul</span>
<span class="term-fg31">-    );</span>
<span class="term-fg31">-    *r = *a;</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;r-&gt;x, &amp;r-&gt;x, &amp;beta);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_gej_has_quad_y_var(const secp256k1_gej *a) {</span>
<span class="term-fg31">-    secp256k1_fe yz;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    if (a-&gt;infinity) {</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* We rely on the fact that the Jacobi symbol of 1 &#47; a-&gt;z^3 is the same as</span>
<span class="term-fg31">-     * that of a-&gt;z. Thus a-&gt;y &#47; a-&gt;z^3 is a quadratic residue iff a-&gt;y * a-&gt;z</span>
<span class="term-fg31">-       is *&#47;</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;yz, &amp;a-&gt;y, &amp;a-&gt;z);</span>
<span class="term-fg31">-    return secp256k1_fe_is_quad_var(&amp;yz);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-2fd540ed07136a76f9d01a4d" role="button"
                       aria-expanded="false" aria-controls="id-2fd540ed07136a76f9d01a4d">
                        <code>crypto/secp256k1/libsecp256k1/src/hash.h</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/hash.h" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-41</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-2fd540ed07136a76f9d01a4d"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;hash.h op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;hash.h</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index fca98cab9f8315bd4fa5c165d9f8e2f16dc2a493..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;hash.h</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,41 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2014 Pieter Wuille                                   *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef _SECP256K1_HASH_</span>
<span class="term-fg31">-#define _SECP256K1_HASH_</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &lt;stdlib.h&gt;</span>
<span class="term-fg31">-#include &lt;stdint.h&gt;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-typedef struct {</span>
<span class="term-fg31">-    uint32_t s[8];</span>
<span class="term-fg31">-    uint32_t buf[16]; &#47;* In big endian *&#47;</span>
<span class="term-fg31">-    size_t bytes;</span>
<span class="term-fg31">-} secp256k1_sha256_t;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_sha256_initialize(secp256k1_sha256_t *hash);</span>
<span class="term-fg31">-static void secp256k1_sha256_write(secp256k1_sha256_t *hash, const unsigned char *data, size_t size);</span>
<span class="term-fg31">-static void secp256k1_sha256_finalize(secp256k1_sha256_t *hash, unsigned char *out32);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-typedef struct {</span>
<span class="term-fg31">-    secp256k1_sha256_t inner, outer;</span>
<span class="term-fg31">-} secp256k1_hmac_sha256_t;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_hmac_sha256_initialize(secp256k1_hmac_sha256_t *hash, const unsigned char *key, size_t size);</span>
<span class="term-fg31">-static void secp256k1_hmac_sha256_write(secp256k1_hmac_sha256_t *hash, const unsigned char *data, size_t size);</span>
<span class="term-fg31">-static void secp256k1_hmac_sha256_finalize(secp256k1_hmac_sha256_t *hash, unsigned char *out32);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-typedef struct {</span>
<span class="term-fg31">-    unsigned char v[32];</span>
<span class="term-fg31">-    unsigned char k[32];</span>
<span class="term-fg31">-    int retry;</span>
<span class="term-fg31">-} secp256k1_rfc6979_hmac_sha256_t;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_rfc6979_hmac_sha256_initialize(secp256k1_rfc6979_hmac_sha256_t *rng, const unsigned char *key, size_t keylen);</span>
<span class="term-fg31">-static void secp256k1_rfc6979_hmac_sha256_generate(secp256k1_rfc6979_hmac_sha256_t *rng, unsigned char *out, size_t outlen);</span>
<span class="term-fg31">-static void secp256k1_rfc6979_hmac_sha256_finalize(secp256k1_rfc6979_hmac_sha256_t *rng);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-d227c8eacb05c2a1631e91da" role="button"
                       aria-expanded="false" aria-controls="id-d227c8eacb05c2a1631e91da">
                        <code>crypto/secp256k1/libsecp256k1/src/hash_impl.h</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/hash_impl.h" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-281</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-d227c8eacb05c2a1631e91da"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;hash_impl.h op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;hash_impl.h</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index b47e65f830a906fc0eb9ff7939d62966823202b1..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;hash_impl.h</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,281 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2014 Pieter Wuille                                   *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef _SECP256K1_HASH_IMPL_H_</span>
<span class="term-fg31">-#define _SECP256K1_HASH_IMPL_H_</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &quot;hash.h&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &lt;stdlib.h&gt;</span>
<span class="term-fg31">-#include &lt;stdint.h&gt;</span>
<span class="term-fg31">-#include &lt;string.h&gt;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#define Ch(x,y,z) ((z) ^ ((x) &amp; ((y) ^ (z))))</span>
<span class="term-fg31">-#define Maj(x,y,z) (((x) &amp; (y)) | ((z) &amp; ((x) | (y))))</span>
<span class="term-fg31">-#define Sigma0(x) (((x) &gt;&gt; 2 | (x) &lt;&lt; 30) ^ ((x) &gt;&gt; 13 | (x) &lt;&lt; 19) ^ ((x) &gt;&gt; 22 | (x) &lt;&lt; 10))</span>
<span class="term-fg31">-#define Sigma1(x) (((x) &gt;&gt; 6 | (x) &lt;&lt; 26) ^ ((x) &gt;&gt; 11 | (x) &lt;&lt; 21) ^ ((x) &gt;&gt; 25 | (x) &lt;&lt; 7))</span>
<span class="term-fg31">-#define sigma0(x) (((x) &gt;&gt; 7 | (x) &lt;&lt; 25) ^ ((x) &gt;&gt; 18 | (x) &lt;&lt; 14) ^ ((x) &gt;&gt; 3))</span>
<span class="term-fg31">-#define sigma1(x) (((x) &gt;&gt; 17 | (x) &lt;&lt; 15) ^ ((x) &gt;&gt; 19 | (x) &lt;&lt; 13) ^ ((x) &gt;&gt; 10))</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#define Round(a,b,c,d,e,f,g,h,k,w) do { \</span>
<span class="term-fg31">-    uint32_t t1 = (h) + Sigma1(e) + Ch((e), (f), (g)) + (k) + (w); \</span>
<span class="term-fg31">-    uint32_t t2 = Sigma0(a) + Maj((a), (b), (c)); \</span>
<span class="term-fg31">-    (d) += t1; \</span>
<span class="term-fg31">-    (h) = t1 + t2; \</span>
<span class="term-fg31">-} while(0)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef WORDS_BIGENDIAN</span>
<span class="term-fg31">-#define BE32(x) (x)</span>
<span class="term-fg31">-#else</span>
<span class="term-fg31">-#define BE32(p) ((((p) &amp; 0xFF) &lt;&lt; 24) | (((p) &amp; 0xFF00) &lt;&lt; 8) | (((p) &amp; 0xFF0000) &gt;&gt; 8) | (((p) &amp; 0xFF000000) &gt;&gt; 24))</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_sha256_initialize(secp256k1_sha256_t *hash) {</span>
<span class="term-fg31">-    hash-&gt;s[0] = 0x6a09e667ul;</span>
<span class="term-fg31">-    hash-&gt;s[1] = 0xbb67ae85ul;</span>
<span class="term-fg31">-    hash-&gt;s[2] = 0x3c6ef372ul;</span>
<span class="term-fg31">-    hash-&gt;s[3] = 0xa54ff53aul;</span>
<span class="term-fg31">-    hash-&gt;s[4] = 0x510e527ful;</span>
<span class="term-fg31">-    hash-&gt;s[5] = 0x9b05688cul;</span>
<span class="term-fg31">-    hash-&gt;s[6] = 0x1f83d9abul;</span>
<span class="term-fg31">-    hash-&gt;s[7] = 0x5be0cd19ul;</span>
<span class="term-fg31">-    hash-&gt;bytes = 0;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Perform one SHA-256 transformation, processing 16 big endian 32-bit words. *&#47;</span>
<span class="term-fg31">-static void secp256k1_sha256_transform(uint32_t* s, const uint32_t* chunk) {</span>
<span class="term-fg31">-    uint32_t a = s[0], b = s[1], c = s[2], d = s[3], e = s[4], f = s[5], g = s[6], h = s[7];</span>
<span class="term-fg31">-    uint32_t w0, w1, w2, w3, w4, w5, w6, w7, w8, w9, w10, w11, w12, w13, w14, w15;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    Round(a, b, c, d, e, f, g, h, 0x428a2f98, w0 = BE32(chunk[0]));</span>
<span class="term-fg31">-    Round(h, a, b, c, d, e, f, g, 0x71374491, w1 = BE32(chunk[1]));</span>
<span class="term-fg31">-    Round(g, h, a, b, c, d, e, f, 0xb5c0fbcf, w2 = BE32(chunk[2]));</span>
<span class="term-fg31">-    Round(f, g, h, a, b, c, d, e, 0xe9b5dba5, w3 = BE32(chunk[3]));</span>
<span class="term-fg31">-    Round(e, f, g, h, a, b, c, d, 0x3956c25b, w4 = BE32(chunk[4]));</span>
<span class="term-fg31">-    Round(d, e, f, g, h, a, b, c, 0x59f111f1, w5 = BE32(chunk[5]));</span>
<span class="term-fg31">-    Round(c, d, e, f, g, h, a, b, 0x923f82a4, w6 = BE32(chunk[6]));</span>
<span class="term-fg31">-    Round(b, c, d, e, f, g, h, a, 0xab1c5ed5, w7 = BE32(chunk[7]));</span>
<span class="term-fg31">-    Round(a, b, c, d, e, f, g, h, 0xd807aa98, w8 = BE32(chunk[8]));</span>
<span class="term-fg31">-    Round(h, a, b, c, d, e, f, g, 0x12835b01, w9 = BE32(chunk[9]));</span>
<span class="term-fg31">-    Round(g, h, a, b, c, d, e, f, 0x243185be, w10 = BE32(chunk[10]));</span>
<span class="term-fg31">-    Round(f, g, h, a, b, c, d, e, 0x550c7dc3, w11 = BE32(chunk[11]));</span>
<span class="term-fg31">-    Round(e, f, g, h, a, b, c, d, 0x72be5d74, w12 = BE32(chunk[12]));</span>
<span class="term-fg31">-    Round(d, e, f, g, h, a, b, c, 0x80deb1fe, w13 = BE32(chunk[13]));</span>
<span class="term-fg31">-    Round(c, d, e, f, g, h, a, b, 0x9bdc06a7, w14 = BE32(chunk[14]));</span>
<span class="term-fg31">-    Round(b, c, d, e, f, g, h, a, 0xc19bf174, w15 = BE32(chunk[15]));</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    Round(a, b, c, d, e, f, g, h, 0xe49b69c1, w0 += sigma1(w14) + w9 + sigma0(w1));</span>
<span class="term-fg31">-    Round(h, a, b, c, d, e, f, g, 0xefbe4786, w1 += sigma1(w15) + w10 + sigma0(w2));</span>
<span class="term-fg31">-    Round(g, h, a, b, c, d, e, f, 0x0fc19dc6, w2 += sigma1(w0) + w11 + sigma0(w3));</span>
<span class="term-fg31">-    Round(f, g, h, a, b, c, d, e, 0x240ca1cc, w3 += sigma1(w1) + w12 + sigma0(w4));</span>
<span class="term-fg31">-    Round(e, f, g, h, a, b, c, d, 0x2de92c6f, w4 += sigma1(w2) + w13 + sigma0(w5));</span>
<span class="term-fg31">-    Round(d, e, f, g, h, a, b, c, 0x4a7484aa, w5 += sigma1(w3) + w14 + sigma0(w6));</span>
<span class="term-fg31">-    Round(c, d, e, f, g, h, a, b, 0x5cb0a9dc, w6 += sigma1(w4) + w15 + sigma0(w7));</span>
<span class="term-fg31">-    Round(b, c, d, e, f, g, h, a, 0x76f988da, w7 += sigma1(w5) + w0 + sigma0(w8));</span>
<span class="term-fg31">-    Round(a, b, c, d, e, f, g, h, 0x983e5152, w8 += sigma1(w6) + w1 + sigma0(w9));</span>
<span class="term-fg31">-    Round(h, a, b, c, d, e, f, g, 0xa831c66d, w9 += sigma1(w7) + w2 + sigma0(w10));</span>
<span class="term-fg31">-    Round(g, h, a, b, c, d, e, f, 0xb00327c8, w10 += sigma1(w8) + w3 + sigma0(w11));</span>
<span class="term-fg31">-    Round(f, g, h, a, b, c, d, e, 0xbf597fc7, w11 += sigma1(w9) + w4 + sigma0(w12));</span>
<span class="term-fg31">-    Round(e, f, g, h, a, b, c, d, 0xc6e00bf3, w12 += sigma1(w10) + w5 + sigma0(w13));</span>
<span class="term-fg31">-    Round(d, e, f, g, h, a, b, c, 0xd5a79147, w13 += sigma1(w11) + w6 + sigma0(w14));</span>
<span class="term-fg31">-    Round(c, d, e, f, g, h, a, b, 0x06ca6351, w14 += sigma1(w12) + w7 + sigma0(w15));</span>
<span class="term-fg31">-    Round(b, c, d, e, f, g, h, a, 0x14292967, w15 += sigma1(w13) + w8 + sigma0(w0));</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    Round(a, b, c, d, e, f, g, h, 0x27b70a85, w0 += sigma1(w14) + w9 + sigma0(w1));</span>
<span class="term-fg31">-    Round(h, a, b, c, d, e, f, g, 0x2e1b2138, w1 += sigma1(w15) + w10 + sigma0(w2));</span>
<span class="term-fg31">-    Round(g, h, a, b, c, d, e, f, 0x4d2c6dfc, w2 += sigma1(w0) + w11 + sigma0(w3));</span>
<span class="term-fg31">-    Round(f, g, h, a, b, c, d, e, 0x53380d13, w3 += sigma1(w1) + w12 + sigma0(w4));</span>
<span class="term-fg31">-    Round(e, f, g, h, a, b, c, d, 0x650a7354, w4 += sigma1(w2) + w13 + sigma0(w5));</span>
<span class="term-fg31">-    Round(d, e, f, g, h, a, b, c, 0x766a0abb, w5 += sigma1(w3) + w14 + sigma0(w6));</span>
<span class="term-fg31">-    Round(c, d, e, f, g, h, a, b, 0x81c2c92e, w6 += sigma1(w4) + w15 + sigma0(w7));</span>
<span class="term-fg31">-    Round(b, c, d, e, f, g, h, a, 0x92722c85, w7 += sigma1(w5) + w0 + sigma0(w8));</span>
<span class="term-fg31">-    Round(a, b, c, d, e, f, g, h, 0xa2bfe8a1, w8 += sigma1(w6) + w1 + sigma0(w9));</span>
<span class="term-fg31">-    Round(h, a, b, c, d, e, f, g, 0xa81a664b, w9 += sigma1(w7) + w2 + sigma0(w10));</span>
<span class="term-fg31">-    Round(g, h, a, b, c, d, e, f, 0xc24b8b70, w10 += sigma1(w8) + w3 + sigma0(w11));</span>
<span class="term-fg31">-    Round(f, g, h, a, b, c, d, e, 0xc76c51a3, w11 += sigma1(w9) + w4 + sigma0(w12));</span>
<span class="term-fg31">-    Round(e, f, g, h, a, b, c, d, 0xd192e819, w12 += sigma1(w10) + w5 + sigma0(w13));</span>
<span class="term-fg31">-    Round(d, e, f, g, h, a, b, c, 0xd6990624, w13 += sigma1(w11) + w6 + sigma0(w14));</span>
<span class="term-fg31">-    Round(c, d, e, f, g, h, a, b, 0xf40e3585, w14 += sigma1(w12) + w7 + sigma0(w15));</span>
<span class="term-fg31">-    Round(b, c, d, e, f, g, h, a, 0x106aa070, w15 += sigma1(w13) + w8 + sigma0(w0));</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    Round(a, b, c, d, e, f, g, h, 0x19a4c116, w0 += sigma1(w14) + w9 + sigma0(w1));</span>
<span class="term-fg31">-    Round(h, a, b, c, d, e, f, g, 0x1e376c08, w1 += sigma1(w15) + w10 + sigma0(w2));</span>
<span class="term-fg31">-    Round(g, h, a, b, c, d, e, f, 0x2748774c, w2 += sigma1(w0) + w11 + sigma0(w3));</span>
<span class="term-fg31">-    Round(f, g, h, a, b, c, d, e, 0x34b0bcb5, w3 += sigma1(w1) + w12 + sigma0(w4));</span>
<span class="term-fg31">-    Round(e, f, g, h, a, b, c, d, 0x391c0cb3, w4 += sigma1(w2) + w13 + sigma0(w5));</span>
<span class="term-fg31">-    Round(d, e, f, g, h, a, b, c, 0x4ed8aa4a, w5 += sigma1(w3) + w14 + sigma0(w6));</span>
<span class="term-fg31">-    Round(c, d, e, f, g, h, a, b, 0x5b9cca4f, w6 += sigma1(w4) + w15 + sigma0(w7));</span>
<span class="term-fg31">-    Round(b, c, d, e, f, g, h, a, 0x682e6ff3, w7 += sigma1(w5) + w0 + sigma0(w8));</span>
<span class="term-fg31">-    Round(a, b, c, d, e, f, g, h, 0x748f82ee, w8 += sigma1(w6) + w1 + sigma0(w9));</span>
<span class="term-fg31">-    Round(h, a, b, c, d, e, f, g, 0x78a5636f, w9 += sigma1(w7) + w2 + sigma0(w10));</span>
<span class="term-fg31">-    Round(g, h, a, b, c, d, e, f, 0x84c87814, w10 += sigma1(w8) + w3 + sigma0(w11));</span>
<span class="term-fg31">-    Round(f, g, h, a, b, c, d, e, 0x8cc70208, w11 += sigma1(w9) + w4 + sigma0(w12));</span>
<span class="term-fg31">-    Round(e, f, g, h, a, b, c, d, 0x90befffa, w12 += sigma1(w10) + w5 + sigma0(w13));</span>
<span class="term-fg31">-    Round(d, e, f, g, h, a, b, c, 0xa4506ceb, w13 += sigma1(w11) + w6 + sigma0(w14));</span>
<span class="term-fg31">-    Round(c, d, e, f, g, h, a, b, 0xbef9a3f7, w14 + sigma1(w12) + w7 + sigma0(w15));</span>
<span class="term-fg31">-    Round(b, c, d, e, f, g, h, a, 0xc67178f2, w15 + sigma1(w13) + w8 + sigma0(w0));</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    s[0] += a;</span>
<span class="term-fg31">-    s[1] += b;</span>
<span class="term-fg31">-    s[2] += c;</span>
<span class="term-fg31">-    s[3] += d;</span>
<span class="term-fg31">-    s[4] += e;</span>
<span class="term-fg31">-    s[5] += f;</span>
<span class="term-fg31">-    s[6] += g;</span>
<span class="term-fg31">-    s[7] += h;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_sha256_write(secp256k1_sha256_t *hash, const unsigned char *data, size_t len) {</span>
<span class="term-fg31">-    size_t bufsize = hash-&gt;bytes &amp; 0x3F;</span>
<span class="term-fg31">-    hash-&gt;bytes += len;</span>
<span class="term-fg31">-    while (bufsize + len &gt;= 64) {</span>
<span class="term-fg31">-        &#47;* Fill the buffer, and process it. *&#47;</span>
<span class="term-fg31">-        memcpy(((unsigned char*)hash-&gt;buf) + bufsize, data, 64 - bufsize);</span>
<span class="term-fg31">-        data += 64 - bufsize;</span>
<span class="term-fg31">-        len -= 64 - bufsize;</span>
<span class="term-fg31">-        secp256k1_sha256_transform(hash-&gt;s, hash-&gt;buf);</span>
<span class="term-fg31">-        bufsize = 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    if (len) {</span>
<span class="term-fg31">-        &#47;* Fill the buffer with what remains. *&#47;</span>
<span class="term-fg31">-        memcpy(((unsigned char*)hash-&gt;buf) + bufsize, data, len);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_sha256_finalize(secp256k1_sha256_t *hash, unsigned char *out32) {</span>
<span class="term-fg31">-    static const unsigned char pad[64] = {0x80, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};</span>
<span class="term-fg31">-    uint32_t sizedesc[2];</span>
<span class="term-fg31">-    uint32_t out[8];</span>
<span class="term-fg31">-    int i = 0;</span>
<span class="term-fg31">-    sizedesc[0] = BE32(hash-&gt;bytes &gt;&gt; 29);</span>
<span class="term-fg31">-    sizedesc[1] = BE32(hash-&gt;bytes &lt;&lt; 3);</span>
<span class="term-fg31">-    secp256k1_sha256_write(hash, pad, 1 + ((119 - (hash-&gt;bytes % 64)) % 64));</span>
<span class="term-fg31">-    secp256k1_sha256_write(hash, (const unsigned char*)sizedesc, 8);</span>
<span class="term-fg31">-    for (i = 0; i &lt; 8; i++) {</span>
<span class="term-fg31">-        out[i] = BE32(hash-&gt;s[i]);</span>
<span class="term-fg31">-        hash-&gt;s[i] = 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    memcpy(out32, (const unsigned char*)out, 32);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_hmac_sha256_initialize(secp256k1_hmac_sha256_t *hash, const unsigned char *key, size_t keylen) {</span>
<span class="term-fg31">-    int n;</span>
<span class="term-fg31">-    unsigned char rkey[64];</span>
<span class="term-fg31">-    if (keylen &lt;= 64) {</span>
<span class="term-fg31">-        memcpy(rkey, key, keylen);</span>
<span class="term-fg31">-        memset(rkey + keylen, 0, 64 - keylen);</span>
<span class="term-fg31">-    } else {</span>
<span class="term-fg31">-        secp256k1_sha256_t sha256;</span>
<span class="term-fg31">-        secp256k1_sha256_initialize(&amp;sha256);</span>
<span class="term-fg31">-        secp256k1_sha256_write(&amp;sha256, key, keylen);</span>
<span class="term-fg31">-        secp256k1_sha256_finalize(&amp;sha256, rkey);</span>
<span class="term-fg31">-        memset(rkey + 32, 0, 32);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_sha256_initialize(&amp;hash-&gt;outer);</span>
<span class="term-fg31">-    for (n = 0; n &lt; 64; n++) {</span>
<span class="term-fg31">-        rkey[n] ^= 0x5c;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_sha256_write(&amp;hash-&gt;outer, rkey, 64);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_sha256_initialize(&amp;hash-&gt;inner);</span>
<span class="term-fg31">-    for (n = 0; n &lt; 64; n++) {</span>
<span class="term-fg31">-        rkey[n] ^= 0x5c ^ 0x36;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_sha256_write(&amp;hash-&gt;inner, rkey, 64);</span>
<span class="term-fg31">-    memset(rkey, 0, 64);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_hmac_sha256_write(secp256k1_hmac_sha256_t *hash, const unsigned char *data, size_t size) {</span>
<span class="term-fg31">-    secp256k1_sha256_write(&amp;hash-&gt;inner, data, size);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_hmac_sha256_finalize(secp256k1_hmac_sha256_t *hash, unsigned char *out32) {</span>
<span class="term-fg31">-    unsigned char temp[32];</span>
<span class="term-fg31">-    secp256k1_sha256_finalize(&amp;hash-&gt;inner, temp);</span>
<span class="term-fg31">-    secp256k1_sha256_write(&amp;hash-&gt;outer, temp, 32);</span>
<span class="term-fg31">-    memset(temp, 0, 32);</span>
<span class="term-fg31">-    secp256k1_sha256_finalize(&amp;hash-&gt;outer, out32);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_rfc6979_hmac_sha256_initialize(secp256k1_rfc6979_hmac_sha256_t *rng, const unsigned char *key, size_t keylen) {</span>
<span class="term-fg31">-    secp256k1_hmac_sha256_t hmac;</span>
<span class="term-fg31">-    static const unsigned char zero[1] = {0x00};</span>
<span class="term-fg31">-    static const unsigned char one[1] = {0x01};</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    memset(rng-&gt;v, 0x01, 32); &#47;* RFC6979 3.2.b. *&#47;</span>
<span class="term-fg31">-    memset(rng-&gt;k, 0x00, 32); &#47;* RFC6979 3.2.c. *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* RFC6979 3.2.d. *&#47;</span>
<span class="term-fg31">-    secp256k1_hmac_sha256_initialize(&amp;hmac, rng-&gt;k, 32);</span>
<span class="term-fg31">-    secp256k1_hmac_sha256_write(&amp;hmac, rng-&gt;v, 32);</span>
<span class="term-fg31">-    secp256k1_hmac_sha256_write(&amp;hmac, zero, 1);</span>
<span class="term-fg31">-    secp256k1_hmac_sha256_write(&amp;hmac, key, keylen);</span>
<span class="term-fg31">-    secp256k1_hmac_sha256_finalize(&amp;hmac, rng-&gt;k);</span>
<span class="term-fg31">-    secp256k1_hmac_sha256_initialize(&amp;hmac, rng-&gt;k, 32);</span>
<span class="term-fg31">-    secp256k1_hmac_sha256_write(&amp;hmac, rng-&gt;v, 32);</span>
<span class="term-fg31">-    secp256k1_hmac_sha256_finalize(&amp;hmac, rng-&gt;v);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* RFC6979 3.2.f. *&#47;</span>
<span class="term-fg31">-    secp256k1_hmac_sha256_initialize(&amp;hmac, rng-&gt;k, 32);</span>
<span class="term-fg31">-    secp256k1_hmac_sha256_write(&amp;hmac, rng-&gt;v, 32);</span>
<span class="term-fg31">-    secp256k1_hmac_sha256_write(&amp;hmac, one, 1);</span>
<span class="term-fg31">-    secp256k1_hmac_sha256_write(&amp;hmac, key, keylen);</span>
<span class="term-fg31">-    secp256k1_hmac_sha256_finalize(&amp;hmac, rng-&gt;k);</span>
<span class="term-fg31">-    secp256k1_hmac_sha256_initialize(&amp;hmac, rng-&gt;k, 32);</span>
<span class="term-fg31">-    secp256k1_hmac_sha256_write(&amp;hmac, rng-&gt;v, 32);</span>
<span class="term-fg31">-    secp256k1_hmac_sha256_finalize(&amp;hmac, rng-&gt;v);</span>
<span class="term-fg31">-    rng-&gt;retry = 0;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_rfc6979_hmac_sha256_generate(secp256k1_rfc6979_hmac_sha256_t *rng, unsigned char *out, size_t outlen) {</span>
<span class="term-fg31">-    &#47;* RFC6979 3.2.h. *&#47;</span>
<span class="term-fg31">-    static const unsigned char zero[1] = {0x00};</span>
<span class="term-fg31">-    if (rng-&gt;retry) {</span>
<span class="term-fg31">-        secp256k1_hmac_sha256_t hmac;</span>
<span class="term-fg31">-        secp256k1_hmac_sha256_initialize(&amp;hmac, rng-&gt;k, 32);</span>
<span class="term-fg31">-        secp256k1_hmac_sha256_write(&amp;hmac, rng-&gt;v, 32);</span>
<span class="term-fg31">-        secp256k1_hmac_sha256_write(&amp;hmac, zero, 1);</span>
<span class="term-fg31">-        secp256k1_hmac_sha256_finalize(&amp;hmac, rng-&gt;k);</span>
<span class="term-fg31">-        secp256k1_hmac_sha256_initialize(&amp;hmac, rng-&gt;k, 32);</span>
<span class="term-fg31">-        secp256k1_hmac_sha256_write(&amp;hmac, rng-&gt;v, 32);</span>
<span class="term-fg31">-        secp256k1_hmac_sha256_finalize(&amp;hmac, rng-&gt;v);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    while (outlen &gt; 0) {</span>
<span class="term-fg31">-        secp256k1_hmac_sha256_t hmac;</span>
<span class="term-fg31">-        int now = outlen;</span>
<span class="term-fg31">-        secp256k1_hmac_sha256_initialize(&amp;hmac, rng-&gt;k, 32);</span>
<span class="term-fg31">-        secp256k1_hmac_sha256_write(&amp;hmac, rng-&gt;v, 32);</span>
<span class="term-fg31">-        secp256k1_hmac_sha256_finalize(&amp;hmac, rng-&gt;v);</span>
<span class="term-fg31">-        if (now &gt; 32) {</span>
<span class="term-fg31">-            now = 32;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        memcpy(out, rng-&gt;v, now);</span>
<span class="term-fg31">-        out += now;</span>
<span class="term-fg31">-        outlen -= now;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    rng-&gt;retry = 1;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_rfc6979_hmac_sha256_finalize(secp256k1_rfc6979_hmac_sha256_t *rng) {</span>
<span class="term-fg31">-    memset(rng-&gt;k, 0, 32);</span>
<span class="term-fg31">-    memset(rng-&gt;v, 0, 32);</span>
<span class="term-fg31">-    rng-&gt;retry = 0;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#undef BE32</span>
<span class="term-fg31">-#undef Round</span>
<span class="term-fg31">-#undef sigma1</span>
<span class="term-fg31">-#undef sigma0</span>
<span class="term-fg31">-#undef Sigma1</span>
<span class="term-fg31">-#undef Sigma0</span>
<span class="term-fg31">-#undef Maj</span>
<span class="term-fg31">-#undef Ch</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-b42187ed4f6bf646a618ef63" role="button"
                       aria-expanded="false" aria-controls="id-b42187ed4f6bf646a618ef63">
                        <code>crypto/secp256k1/libsecp256k1/src/java/org/bitcoin/NativeSecp256k1.java</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/java/org/bitcoin/NativeSecp256k1.java" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-446</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-b42187ed4f6bf646a618ef63"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;java&#47;org&#47;bitcoin&#47;NativeSecp256k1.java op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;java&#47;org&#47;bitcoin&#47;NativeSecp256k1.java</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 1c67802fba82e60498c560473e9966c161939ffb..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;java&#47;org&#47;bitcoin&#47;NativeSecp256k1.java</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,446 +0,0 @@</span>
<span class="term-fg31">-&#47;*</span>
<span class="term-fg31">- * Copyright 2013 Google Inc.</span>
<span class="term-fg31">- * Copyright 2014-2016 the libsecp256k1 contributors</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="term-fg31">- * you may not use this file except in compliance with the License.</span>
<span class="term-fg31">- * You may obtain a copy of the License at</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *    http:&#47;&#47;www.apache.org&#47;licenses&#47;LICENSE-2.0</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- * Unless required by applicable law or agreed to in writing, software</span>
<span class="term-fg31">- * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="term-fg31">- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="term-fg31">- * See the License for the specific language governing permissions and</span>
<span class="term-fg31">- * limitations under the License.</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-package org.bitcoin;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-import java.nio.ByteBuffer;</span>
<span class="term-fg31">-import java.nio.ByteOrder;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-import java.math.BigInteger;</span>
<span class="term-fg31">-import com.google.common.base.Preconditions;</span>
<span class="term-fg31">-import java.util.concurrent.locks.Lock;</span>
<span class="term-fg31">-import java.util.concurrent.locks.ReentrantReadWriteLock;</span>
<span class="term-fg31">-import static org.bitcoin.NativeSecp256k1Util.*;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;**</span>
<span class="term-fg31">- * &lt;p&gt;This class holds native methods to handle ECDSA verification.&lt;&#47;p&gt;</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- * &lt;p&gt;You can find an example library that can be used for this at https:&#47;&#47;github.com&#47;bitcoin&#47;secp256k1&lt;&#47;p&gt;</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- * &lt;p&gt;To build secp256k1 for use with bitcoinj, run</span>
<span class="term-fg31">- * `.&#47;configure --enable-jni --enable-experimental --enable-module-ecdh`</span>
<span class="term-fg31">- * and `make` then copy `.libs&#47;libsecp256k1.so` to your system library path</span>
<span class="term-fg31">- * or point the JVM to the folder containing it with -Djava.library.path</span>
<span class="term-fg31">- * &lt;&#47;p&gt;</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-public class NativeSecp256k1 {</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    private static final ReentrantReadWriteLock rwl = new ReentrantReadWriteLock();</span>
<span class="term-fg31">-    private static final Lock r = rwl.readLock();</span>
<span class="term-fg31">-    private static final Lock w = rwl.writeLock();</span>
<span class="term-fg31">-    private static ThreadLocal&lt;ByteBuffer&gt; nativeECDSABuffer = new ThreadLocal&lt;ByteBuffer&gt;();</span>
<span class="term-fg31">-    &#47;**</span>
<span class="term-fg31">-     * Verifies the given secp256k1 signature in native code.</span>
<span class="term-fg31">-     * Calling when enabled == false is undefined (probably library not loaded)</span>
<span class="term-fg31">-     *</span>
<span class="term-fg31">-     * @param data The data which was signed, must be exactly 32 bytes</span>
<span class="term-fg31">-     * @param signature The signature</span>
<span class="term-fg31">-     * @param pub The public key which did the signing</span>
<span class="term-fg31">-     *&#47;</span>
<span class="term-fg31">-    public static boolean verify(byte[] data, byte[] signature, byte[] pub) throws AssertFailException{</span>
<span class="term-fg31">-        Preconditions.checkArgument(data.length == 32 &amp;&amp; signature.length &lt;= 520 &amp;&amp; pub.length &lt;= 520);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        ByteBuffer byteBuff = nativeECDSABuffer.get();</span>
<span class="term-fg31">-        if (byteBuff == null || byteBuff.capacity() &lt; 520) {</span>
<span class="term-fg31">-            byteBuff = ByteBuffer.allocateDirect(520);</span>
<span class="term-fg31">-            byteBuff.order(ByteOrder.nativeOrder());</span>
<span class="term-fg31">-            nativeECDSABuffer.set(byteBuff);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        byteBuff.rewind();</span>
<span class="term-fg31">-        byteBuff.put(data);</span>
<span class="term-fg31">-        byteBuff.put(signature);</span>
<span class="term-fg31">-        byteBuff.put(pub);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        byte[][] retByteArray;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        r.lock();</span>
<span class="term-fg31">-        try {</span>
<span class="term-fg31">-          return secp256k1_ecdsa_verify(byteBuff, Secp256k1Context.getContext(), signature.length, pub.length) == 1;</span>
<span class="term-fg31">-        } finally {</span>
<span class="term-fg31">-          r.unlock();</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;**</span>
<span class="term-fg31">-     * libsecp256k1 Create an ECDSA signature.</span>
<span class="term-fg31">-     *</span>
<span class="term-fg31">-     * @param data Message hash, 32 bytes</span>
<span class="term-fg31">-     * @param key Secret key, 32 bytes</span>
<span class="term-fg31">-     *</span>
<span class="term-fg31">-     * Return values</span>
<span class="term-fg31">-     * @param sig byte array of signature</span>
<span class="term-fg31">-     *&#47;</span>
<span class="term-fg31">-    public static byte[] sign(byte[] data, byte[] sec) throws AssertFailException{</span>
<span class="term-fg31">-        Preconditions.checkArgument(data.length == 32 &amp;&amp; sec.length &lt;= 32);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        ByteBuffer byteBuff = nativeECDSABuffer.get();</span>
<span class="term-fg31">-        if (byteBuff == null || byteBuff.capacity() &lt; 32 + 32) {</span>
<span class="term-fg31">-            byteBuff = ByteBuffer.allocateDirect(32 + 32);</span>
<span class="term-fg31">-            byteBuff.order(ByteOrder.nativeOrder());</span>
<span class="term-fg31">-            nativeECDSABuffer.set(byteBuff);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        byteBuff.rewind();</span>
<span class="term-fg31">-        byteBuff.put(data);</span>
<span class="term-fg31">-        byteBuff.put(sec);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        byte[][] retByteArray;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        r.lock();</span>
<span class="term-fg31">-        try {</span>
<span class="term-fg31">-          retByteArray = secp256k1_ecdsa_sign(byteBuff, Secp256k1Context.getContext());</span>
<span class="term-fg31">-        } finally {</span>
<span class="term-fg31">-          r.unlock();</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        byte[] sigArr = retByteArray[0];</span>
<span class="term-fg31">-        int sigLen = new BigInteger(new byte[] { retByteArray[1][0] }).intValue();</span>
<span class="term-fg31">-        int retVal = new BigInteger(new byte[] { retByteArray[1][1] }).intValue();</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        assertEquals(sigArr.length, sigLen, &quot;Got bad signature length.&quot;);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        return retVal == 0 ? new byte[0] : sigArr;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;**</span>
<span class="term-fg31">-     * libsecp256k1 Seckey Verify - returns 1 if valid, 0 if invalid</span>
<span class="term-fg31">-     *</span>
<span class="term-fg31">-     * @param seckey ECDSA Secret key, 32 bytes</span>
<span class="term-fg31">-     *&#47;</span>
<span class="term-fg31">-    public static boolean secKeyVerify(byte[] seckey) {</span>
<span class="term-fg31">-        Preconditions.checkArgument(seckey.length == 32);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        ByteBuffer byteBuff = nativeECDSABuffer.get();</span>
<span class="term-fg31">-        if (byteBuff == null || byteBuff.capacity() &lt; seckey.length) {</span>
<span class="term-fg31">-            byteBuff = ByteBuffer.allocateDirect(seckey.length);</span>
<span class="term-fg31">-            byteBuff.order(ByteOrder.nativeOrder());</span>
<span class="term-fg31">-            nativeECDSABuffer.set(byteBuff);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        byteBuff.rewind();</span>
<span class="term-fg31">-        byteBuff.put(seckey);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        r.lock();</span>
<span class="term-fg31">-        try {</span>
<span class="term-fg31">-          return secp256k1_ec_seckey_verify(byteBuff,Secp256k1Context.getContext()) == 1;</span>
<span class="term-fg31">-        } finally {</span>
<span class="term-fg31">-          r.unlock();</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;**</span>
<span class="term-fg31">-     * libsecp256k1 Compute Pubkey - computes public key from secret key</span>
<span class="term-fg31">-     *</span>
<span class="term-fg31">-     * @param seckey ECDSA Secret key, 32 bytes</span>
<span class="term-fg31">-     *</span>
<span class="term-fg31">-     * Return values</span>
<span class="term-fg31">-     * @param pubkey ECDSA Public key, 33 or 65 bytes</span>
<span class="term-fg31">-     *&#47;</span>
<span class="term-fg31">-    &#47;&#47;TODO add a &#39;compressed&#39; arg</span>
<span class="term-fg31">-    public static byte[] computePubkey(byte[] seckey) throws AssertFailException{</span>
<span class="term-fg31">-        Preconditions.checkArgument(seckey.length == 32);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        ByteBuffer byteBuff = nativeECDSABuffer.get();</span>
<span class="term-fg31">-        if (byteBuff == null || byteBuff.capacity() &lt; seckey.length) {</span>
<span class="term-fg31">-            byteBuff = ByteBuffer.allocateDirect(seckey.length);</span>
<span class="term-fg31">-            byteBuff.order(ByteOrder.nativeOrder());</span>
<span class="term-fg31">-            nativeECDSABuffer.set(byteBuff);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        byteBuff.rewind();</span>
<span class="term-fg31">-        byteBuff.put(seckey);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        byte[][] retByteArray;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        r.lock();</span>
<span class="term-fg31">-        try {</span>
<span class="term-fg31">-          retByteArray = secp256k1_ec_pubkey_create(byteBuff, Secp256k1Context.getContext());</span>
<span class="term-fg31">-        } finally {</span>
<span class="term-fg31">-          r.unlock();</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        byte[] pubArr = retByteArray[0];</span>
<span class="term-fg31">-        int pubLen = new BigInteger(new byte[] { retByteArray[1][0] }).intValue();</span>
<span class="term-fg31">-        int retVal = new BigInteger(new byte[] { retByteArray[1][1] }).intValue();</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        assertEquals(pubArr.length, pubLen, &quot;Got bad pubkey length.&quot;);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        return retVal == 0 ? new byte[0]: pubArr;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;**</span>
<span class="term-fg31">-     * libsecp256k1 Cleanup - This destroys the secp256k1 context object</span>
<span class="term-fg31">-     * This should be called at the end of the program for proper cleanup of the context.</span>
<span class="term-fg31">-     *&#47;</span>
<span class="term-fg31">-    public static synchronized void cleanup() {</span>
<span class="term-fg31">-        w.lock();</span>
<span class="term-fg31">-        try {</span>
<span class="term-fg31">-          secp256k1_destroy_context(Secp256k1Context.getContext());</span>
<span class="term-fg31">-        } finally {</span>
<span class="term-fg31">-          w.unlock();</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    public static long cloneContext() {</span>
<span class="term-fg31">-       r.lock();</span>
<span class="term-fg31">-       try {</span>
<span class="term-fg31">-        return secp256k1_ctx_clone(Secp256k1Context.getContext());</span>
<span class="term-fg31">-       } finally { r.unlock(); }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;**</span>
<span class="term-fg31">-     * libsecp256k1 PrivKey Tweak-Mul - Tweak privkey by multiplying to it</span>
<span class="term-fg31">-     *</span>
<span class="term-fg31">-     * @param tweak some bytes to tweak with</span>
<span class="term-fg31">-     * @param seckey 32-byte seckey</span>
<span class="term-fg31">-     *&#47;</span>
<span class="term-fg31">-    public static byte[] privKeyTweakMul(byte[] privkey, byte[] tweak) throws AssertFailException{</span>
<span class="term-fg31">-        Preconditions.checkArgument(privkey.length == 32);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        ByteBuffer byteBuff = nativeECDSABuffer.get();</span>
<span class="term-fg31">-        if (byteBuff == null || byteBuff.capacity() &lt; privkey.length + tweak.length) {</span>
<span class="term-fg31">-            byteBuff = ByteBuffer.allocateDirect(privkey.length + tweak.length);</span>
<span class="term-fg31">-            byteBuff.order(ByteOrder.nativeOrder());</span>
<span class="term-fg31">-            nativeECDSABuffer.set(byteBuff);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        byteBuff.rewind();</span>
<span class="term-fg31">-        byteBuff.put(privkey);</span>
<span class="term-fg31">-        byteBuff.put(tweak);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        byte[][] retByteArray;</span>
<span class="term-fg31">-        r.lock();</span>
<span class="term-fg31">-        try {</span>
<span class="term-fg31">-          retByteArray = secp256k1_privkey_tweak_mul(byteBuff,Secp256k1Context.getContext());</span>
<span class="term-fg31">-        } finally {</span>
<span class="term-fg31">-          r.unlock();</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        byte[] privArr = retByteArray[0];</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        int privLen = (byte) new BigInteger(new byte[] { retByteArray[1][0] }).intValue() &amp; 0xFF;</span>
<span class="term-fg31">-        int retVal = new BigInteger(new byte[] { retByteArray[1][1] }).intValue();</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        assertEquals(privArr.length, privLen, &quot;Got bad pubkey length.&quot;);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        assertEquals(retVal, 1, &quot;Failed return value check.&quot;);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        return privArr;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;**</span>
<span class="term-fg31">-     * libsecp256k1 PrivKey Tweak-Add - Tweak privkey by adding to it</span>
<span class="term-fg31">-     *</span>
<span class="term-fg31">-     * @param tweak some bytes to tweak with</span>
<span class="term-fg31">-     * @param seckey 32-byte seckey</span>
<span class="term-fg31">-     *&#47;</span>
<span class="term-fg31">-    public static byte[] privKeyTweakAdd(byte[] privkey, byte[] tweak) throws AssertFailException{</span>
<span class="term-fg31">-        Preconditions.checkArgument(privkey.length == 32);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        ByteBuffer byteBuff = nativeECDSABuffer.get();</span>
<span class="term-fg31">-        if (byteBuff == null || byteBuff.capacity() &lt; privkey.length + tweak.length) {</span>
<span class="term-fg31">-            byteBuff = ByteBuffer.allocateDirect(privkey.length + tweak.length);</span>
<span class="term-fg31">-            byteBuff.order(ByteOrder.nativeOrder());</span>
<span class="term-fg31">-            nativeECDSABuffer.set(byteBuff);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        byteBuff.rewind();</span>
<span class="term-fg31">-        byteBuff.put(privkey);</span>
<span class="term-fg31">-        byteBuff.put(tweak);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        byte[][] retByteArray;</span>
<span class="term-fg31">-        r.lock();</span>
<span class="term-fg31">-        try {</span>
<span class="term-fg31">-          retByteArray = secp256k1_privkey_tweak_add(byteBuff,Secp256k1Context.getContext());</span>
<span class="term-fg31">-        } finally {</span>
<span class="term-fg31">-          r.unlock();</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        byte[] privArr = retByteArray[0];</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        int privLen = (byte) new BigInteger(new byte[] { retByteArray[1][0] }).intValue() &amp; 0xFF;</span>
<span class="term-fg31">-        int retVal = new BigInteger(new byte[] { retByteArray[1][1] }).intValue();</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        assertEquals(privArr.length, privLen, &quot;Got bad pubkey length.&quot;);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        assertEquals(retVal, 1, &quot;Failed return value check.&quot;);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        return privArr;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;**</span>
<span class="term-fg31">-     * libsecp256k1 PubKey Tweak-Add - Tweak pubkey by adding to it</span>
<span class="term-fg31">-     *</span>
<span class="term-fg31">-     * @param tweak some bytes to tweak with</span>
<span class="term-fg31">-     * @param pubkey 32-byte seckey</span>
<span class="term-fg31">-     *&#47;</span>
<span class="term-fg31">-    public static byte[] pubKeyTweakAdd(byte[] pubkey, byte[] tweak) throws AssertFailException{</span>
<span class="term-fg31">-        Preconditions.checkArgument(pubkey.length == 33 || pubkey.length == 65);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        ByteBuffer byteBuff = nativeECDSABuffer.get();</span>
<span class="term-fg31">-        if (byteBuff == null || byteBuff.capacity() &lt; pubkey.length + tweak.length) {</span>
<span class="term-fg31">-            byteBuff = ByteBuffer.allocateDirect(pubkey.length + tweak.length);</span>
<span class="term-fg31">-            byteBuff.order(ByteOrder.nativeOrder());</span>
<span class="term-fg31">-            nativeECDSABuffer.set(byteBuff);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        byteBuff.rewind();</span>
<span class="term-fg31">-        byteBuff.put(pubkey);</span>
<span class="term-fg31">-        byteBuff.put(tweak);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        byte[][] retByteArray;</span>
<span class="term-fg31">-        r.lock();</span>
<span class="term-fg31">-        try {</span>
<span class="term-fg31">-          retByteArray = secp256k1_pubkey_tweak_add(byteBuff,Secp256k1Context.getContext(), pubkey.length);</span>
<span class="term-fg31">-        } finally {</span>
<span class="term-fg31">-          r.unlock();</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        byte[] pubArr = retByteArray[0];</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        int pubLen = (byte) new BigInteger(new byte[] { retByteArray[1][0] }).intValue() &amp; 0xFF;</span>
<span class="term-fg31">-        int retVal = new BigInteger(new byte[] { retByteArray[1][1] }).intValue();</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        assertEquals(pubArr.length, pubLen, &quot;Got bad pubkey length.&quot;);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        assertEquals(retVal, 1, &quot;Failed return value check.&quot;);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        return pubArr;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;**</span>
<span class="term-fg31">-     * libsecp256k1 PubKey Tweak-Mul - Tweak pubkey by multiplying to it</span>
<span class="term-fg31">-     *</span>
<span class="term-fg31">-     * @param tweak some bytes to tweak with</span>
<span class="term-fg31">-     * @param pubkey 32-byte seckey</span>
<span class="term-fg31">-     *&#47;</span>
<span class="term-fg31">-    public static byte[] pubKeyTweakMul(byte[] pubkey, byte[] tweak) throws AssertFailException{</span>
<span class="term-fg31">-        Preconditions.checkArgument(pubkey.length == 33 || pubkey.length == 65);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        ByteBuffer byteBuff = nativeECDSABuffer.get();</span>
<span class="term-fg31">-        if (byteBuff == null || byteBuff.capacity() &lt; pubkey.length + tweak.length) {</span>
<span class="term-fg31">-            byteBuff = ByteBuffer.allocateDirect(pubkey.length + tweak.length);</span>
<span class="term-fg31">-            byteBuff.order(ByteOrder.nativeOrder());</span>
<span class="term-fg31">-            nativeECDSABuffer.set(byteBuff);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        byteBuff.rewind();</span>
<span class="term-fg31">-        byteBuff.put(pubkey);</span>
<span class="term-fg31">-        byteBuff.put(tweak);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        byte[][] retByteArray;</span>
<span class="term-fg31">-        r.lock();</span>
<span class="term-fg31">-        try {</span>
<span class="term-fg31">-          retByteArray = secp256k1_pubkey_tweak_mul(byteBuff,Secp256k1Context.getContext(), pubkey.length);</span>
<span class="term-fg31">-        } finally {</span>
<span class="term-fg31">-          r.unlock();</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        byte[] pubArr = retByteArray[0];</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        int pubLen = (byte) new BigInteger(new byte[] { retByteArray[1][0] }).intValue() &amp; 0xFF;</span>
<span class="term-fg31">-        int retVal = new BigInteger(new byte[] { retByteArray[1][1] }).intValue();</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        assertEquals(pubArr.length, pubLen, &quot;Got bad pubkey length.&quot;);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        assertEquals(retVal, 1, &quot;Failed return value check.&quot;);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        return pubArr;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;**</span>
<span class="term-fg31">-     * libsecp256k1 create ECDH secret - constant time ECDH calculation</span>
<span class="term-fg31">-     *</span>
<span class="term-fg31">-     * @param seckey byte array of secret key used in exponentiaion</span>
<span class="term-fg31">-     * @param pubkey byte array of public key used in exponentiaion</span>
<span class="term-fg31">-     *&#47;</span>
<span class="term-fg31">-    public static byte[] createECDHSecret(byte[] seckey, byte[] pubkey) throws AssertFailException{</span>
<span class="term-fg31">-        Preconditions.checkArgument(seckey.length &lt;= 32 &amp;&amp; pubkey.length &lt;= 65);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        ByteBuffer byteBuff = nativeECDSABuffer.get();</span>
<span class="term-fg31">-        if (byteBuff == null || byteBuff.capacity() &lt; 32 + pubkey.length) {</span>
<span class="term-fg31">-            byteBuff = ByteBuffer.allocateDirect(32 + pubkey.length);</span>
<span class="term-fg31">-            byteBuff.order(ByteOrder.nativeOrder());</span>
<span class="term-fg31">-            nativeECDSABuffer.set(byteBuff);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        byteBuff.rewind();</span>
<span class="term-fg31">-        byteBuff.put(seckey);</span>
<span class="term-fg31">-        byteBuff.put(pubkey);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        byte[][] retByteArray;</span>
<span class="term-fg31">-        r.lock();</span>
<span class="term-fg31">-        try {</span>
<span class="term-fg31">-          retByteArray = secp256k1_ecdh(byteBuff, Secp256k1Context.getContext(), pubkey.length);</span>
<span class="term-fg31">-        } finally {</span>
<span class="term-fg31">-          r.unlock();</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        byte[] resArr = retByteArray[0];</span>
<span class="term-fg31">-        int retVal = new BigInteger(new byte[] { retByteArray[1][0] }).intValue();</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        assertEquals(resArr.length, 32, &quot;Got bad result length.&quot;);</span>
<span class="term-fg31">-        assertEquals(retVal, 1, &quot;Failed return value check.&quot;);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        return resArr;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;**</span>
<span class="term-fg31">-     * libsecp256k1 randomize - updates the context randomization</span>
<span class="term-fg31">-     *</span>
<span class="term-fg31">-     * @param seed 32-byte random seed</span>
<span class="term-fg31">-     *&#47;</span>
<span class="term-fg31">-    public static synchronized boolean randomize(byte[] seed) throws AssertFailException{</span>
<span class="term-fg31">-        Preconditions.checkArgument(seed.length == 32 || seed == null);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        ByteBuffer byteBuff = nativeECDSABuffer.get();</span>
<span class="term-fg31">-        if (byteBuff == null || byteBuff.capacity() &lt; seed.length) {</span>
<span class="term-fg31">-            byteBuff = ByteBuffer.allocateDirect(seed.length);</span>
<span class="term-fg31">-            byteBuff.order(ByteOrder.nativeOrder());</span>
<span class="term-fg31">-            nativeECDSABuffer.set(byteBuff);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        byteBuff.rewind();</span>
<span class="term-fg31">-        byteBuff.put(seed);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        w.lock();</span>
<span class="term-fg31">-        try {</span>
<span class="term-fg31">-          return secp256k1_context_randomize(byteBuff, Secp256k1Context.getContext()) == 1;</span>
<span class="term-fg31">-        } finally {</span>
<span class="term-fg31">-          w.unlock();</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    private static native long secp256k1_ctx_clone(long context);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    private static native int secp256k1_context_randomize(ByteBuffer byteBuff, long context);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    private static native byte[][] secp256k1_privkey_tweak_add(ByteBuffer byteBuff, long context);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    private static native byte[][] secp256k1_privkey_tweak_mul(ByteBuffer byteBuff, long context);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    private static native byte[][] secp256k1_pubkey_tweak_add(ByteBuffer byteBuff, long context, int pubLen);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    private static native byte[][] secp256k1_pubkey_tweak_mul(ByteBuffer byteBuff, long context, int pubLen);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    private static native void secp256k1_destroy_context(long context);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    private static native int secp256k1_ecdsa_verify(ByteBuffer byteBuff, long context, int sigLen, int pubLen);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    private static native byte[][] secp256k1_ecdsa_sign(ByteBuffer byteBuff, long context);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    private static native int secp256k1_ec_seckey_verify(ByteBuffer byteBuff, long context);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    private static native byte[][] secp256k1_ec_pubkey_create(ByteBuffer byteBuff, long context);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    private static native byte[][] secp256k1_ec_pubkey_parse(ByteBuffer byteBuff, long context, int inputLen);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    private static native byte[][] secp256k1_ecdh(ByteBuffer byteBuff, long context, int inputLen);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-78fd0ffe13630643a2141e6c" role="button"
                       aria-expanded="false" aria-controls="id-78fd0ffe13630643a2141e6c">
                        <code>crypto/secp256k1/libsecp256k1/src/java/org/bitcoin/NativeSecp256k1Test.java</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/java/org/bitcoin/NativeSecp256k1Test.java" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-226</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-78fd0ffe13630643a2141e6c"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;java&#47;org&#47;bitcoin&#47;NativeSecp256k1Test.java op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;java&#47;org&#47;bitcoin&#47;NativeSecp256k1Test.java</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index c00d08899b9b004af75a4e98569c460ad83395a1..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;java&#47;org&#47;bitcoin&#47;NativeSecp256k1Test.java</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,226 +0,0 @@</span>
<span class="term-fg31">-package org.bitcoin;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-import com.google.common.io.BaseEncoding;</span>
<span class="term-fg31">-import java.util.Arrays;</span>
<span class="term-fg31">-import java.math.BigInteger;</span>
<span class="term-fg31">-import javax.xml.bind.DatatypeConverter;</span>
<span class="term-fg31">-import static org.bitcoin.NativeSecp256k1Util.*;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;**</span>
<span class="term-fg31">- * This class holds test cases defined for testing this library.</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-public class NativeSecp256k1Test {</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;&#47;TODO improve comments&#47;add more tests</span>
<span class="term-fg31">-    &#47;**</span>
<span class="term-fg31">-      * This tests verify() for a valid signature</span>
<span class="term-fg31">-      *&#47;</span>
<span class="term-fg31">-    public static void testVerifyPos() throws AssertFailException{</span>
<span class="term-fg31">-        boolean result = false;</span>
<span class="term-fg31">-        byte[] data = BaseEncoding.base16().lowerCase().decode(&quot;CF80CD8AED482D5D1527D7DC72FCEFF84E6326592848447D2DC0B0E87DFC9A90&quot;.toLowerCase()); &#47;&#47;sha256hash of &quot;testing&quot;</span>
<span class="term-fg31">-        byte[] sig = BaseEncoding.base16().lowerCase().decode(&quot;3044022079BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F817980220294F14E883B3F525B5367756C2A11EF6CF84B730B36C17CB0C56F0AAB2C98589&quot;.toLowerCase());</span>
<span class="term-fg31">-        byte[] pub = BaseEncoding.base16().lowerCase().decode(&quot;040A629506E1B65CD9D2E0BA9C75DF9C4FED0DB16DC9625ED14397F0AFC836FAE595DC53F8B0EFE61E703075BD9B143BAC75EC0E19F82A2208CAEB32BE53414C40&quot;.toLowerCase());</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        result = NativeSecp256k1.verify( data, sig, pub);</span>
<span class="term-fg31">-        assertEquals( result, true , &quot;testVerifyPos&quot;);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;**</span>
<span class="term-fg31">-      * This tests verify() for a non-valid signature</span>
<span class="term-fg31">-      *&#47;</span>
<span class="term-fg31">-    public static void testVerifyNeg() throws AssertFailException{</span>
<span class="term-fg31">-        boolean result = false;</span>
<span class="term-fg31">-        byte[] data = BaseEncoding.base16().lowerCase().decode(&quot;CF80CD8AED482D5D1527D7DC72FCEFF84E6326592848447D2DC0B0E87DFC9A91&quot;.toLowerCase()); &#47;&#47;sha256hash of &quot;testing&quot;</span>
<span class="term-fg31">-        byte[] sig = BaseEncoding.base16().lowerCase().decode(&quot;3044022079BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F817980220294F14E883B3F525B5367756C2A11EF6CF84B730B36C17CB0C56F0AAB2C98589&quot;.toLowerCase());</span>
<span class="term-fg31">-        byte[] pub = BaseEncoding.base16().lowerCase().decode(&quot;040A629506E1B65CD9D2E0BA9C75DF9C4FED0DB16DC9625ED14397F0AFC836FAE595DC53F8B0EFE61E703075BD9B143BAC75EC0E19F82A2208CAEB32BE53414C40&quot;.toLowerCase());</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        result = NativeSecp256k1.verify( data, sig, pub);</span>
<span class="term-fg31">-        &#47;&#47;System.out.println(&quot; TEST &quot; + new BigInteger(1, resultbytes).toString(16));</span>
<span class="term-fg31">-        assertEquals( result, false , &quot;testVerifyNeg&quot;);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;**</span>
<span class="term-fg31">-      * This tests secret key verify() for a valid secretkey</span>
<span class="term-fg31">-      *&#47;</span>
<span class="term-fg31">-    public static void testSecKeyVerifyPos() throws AssertFailException{</span>
<span class="term-fg31">-        boolean result = false;</span>
<span class="term-fg31">-        byte[] sec = BaseEncoding.base16().lowerCase().decode(&quot;67E56582298859DDAE725F972992A07C6C4FB9F62A8FFF58CE3CA926A1063530&quot;.toLowerCase());</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        result = NativeSecp256k1.secKeyVerify( sec );</span>
<span class="term-fg31">-        &#47;&#47;System.out.println(&quot; TEST &quot; + new BigInteger(1, resultbytes).toString(16));</span>
<span class="term-fg31">-        assertEquals( result, true , &quot;testSecKeyVerifyPos&quot;);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;**</span>
<span class="term-fg31">-      * This tests secret key verify() for a invalid secretkey</span>
<span class="term-fg31">-      *&#47;</span>
<span class="term-fg31">-    public static void testSecKeyVerifyNeg() throws AssertFailException{</span>
<span class="term-fg31">-        boolean result = false;</span>
<span class="term-fg31">-        byte[] sec = BaseEncoding.base16().lowerCase().decode(&quot;FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF&quot;.toLowerCase());</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        result = NativeSecp256k1.secKeyVerify( sec );</span>
<span class="term-fg31">-        &#47;&#47;System.out.println(&quot; TEST &quot; + new BigInteger(1, resultbytes).toString(16));</span>
<span class="term-fg31">-        assertEquals( result, false , &quot;testSecKeyVerifyNeg&quot;);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;**</span>
<span class="term-fg31">-      * This tests public key create() for a valid secretkey</span>
<span class="term-fg31">-      *&#47;</span>
<span class="term-fg31">-    public static void testPubKeyCreatePos() throws AssertFailException{</span>
<span class="term-fg31">-        byte[] sec = BaseEncoding.base16().lowerCase().decode(&quot;67E56582298859DDAE725F972992A07C6C4FB9F62A8FFF58CE3CA926A1063530&quot;.toLowerCase());</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        byte[] resultArr = NativeSecp256k1.computePubkey( sec);</span>
<span class="term-fg31">-        String pubkeyString = javax.xml.bind.DatatypeConverter.printHexBinary(resultArr);</span>
<span class="term-fg31">-        assertEquals( pubkeyString , &quot;04C591A8FF19AC9C4E4E5793673B83123437E975285E7B442F4EE2654DFFCA5E2D2103ED494718C697AC9AEBCFD19612E224DB46661011863ED2FC54E71861E2A6&quot; , &quot;testPubKeyCreatePos&quot;);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;**</span>
<span class="term-fg31">-      * This tests public key create() for a invalid secretkey</span>
<span class="term-fg31">-      *&#47;</span>
<span class="term-fg31">-    public static void testPubKeyCreateNeg() throws AssertFailException{</span>
<span class="term-fg31">-       byte[] sec = BaseEncoding.base16().lowerCase().decode(&quot;FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF&quot;.toLowerCase());</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-       byte[] resultArr = NativeSecp256k1.computePubkey( sec);</span>
<span class="term-fg31">-       String pubkeyString = javax.xml.bind.DatatypeConverter.printHexBinary(resultArr);</span>
<span class="term-fg31">-       assertEquals( pubkeyString, &quot;&quot; , &quot;testPubKeyCreateNeg&quot;);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;**</span>
<span class="term-fg31">-      * This tests sign() for a valid secretkey</span>
<span class="term-fg31">-      *&#47;</span>
<span class="term-fg31">-    public static void testSignPos() throws AssertFailException{</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        byte[] data = BaseEncoding.base16().lowerCase().decode(&quot;CF80CD8AED482D5D1527D7DC72FCEFF84E6326592848447D2DC0B0E87DFC9A90&quot;.toLowerCase()); &#47;&#47;sha256hash of &quot;testing&quot;</span>
<span class="term-fg31">-        byte[] sec = BaseEncoding.base16().lowerCase().decode(&quot;67E56582298859DDAE725F972992A07C6C4FB9F62A8FFF58CE3CA926A1063530&quot;.toLowerCase());</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        byte[] resultArr = NativeSecp256k1.sign(data, sec);</span>
<span class="term-fg31">-        String sigString = javax.xml.bind.DatatypeConverter.printHexBinary(resultArr);</span>
<span class="term-fg31">-        assertEquals( sigString, &quot;30440220182A108E1448DC8F1FB467D06A0F3BB8EA0533584CB954EF8DA112F1D60E39A202201C66F36DA211C087F3AF88B50EDF4F9BDAA6CF5FD6817E74DCA34DB12390C6E9&quot; , &quot;testSignPos&quot;);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;**</span>
<span class="term-fg31">-      * This tests sign() for a invalid secretkey</span>
<span class="term-fg31">-      *&#47;</span>
<span class="term-fg31">-    public static void testSignNeg() throws AssertFailException{</span>
<span class="term-fg31">-        byte[] data = BaseEncoding.base16().lowerCase().decode(&quot;CF80CD8AED482D5D1527D7DC72FCEFF84E6326592848447D2DC0B0E87DFC9A90&quot;.toLowerCase()); &#47;&#47;sha256hash of &quot;testing&quot;</span>
<span class="term-fg31">-        byte[] sec = BaseEncoding.base16().lowerCase().decode(&quot;FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF&quot;.toLowerCase());</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        byte[] resultArr = NativeSecp256k1.sign(data, sec);</span>
<span class="term-fg31">-        String sigString = javax.xml.bind.DatatypeConverter.printHexBinary(resultArr);</span>
<span class="term-fg31">-        assertEquals( sigString, &quot;&quot; , &quot;testSignNeg&quot;);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;**</span>
<span class="term-fg31">-      * This tests private key tweak-add</span>
<span class="term-fg31">-      *&#47;</span>
<span class="term-fg31">-    public static void testPrivKeyTweakAdd_1() throws AssertFailException {</span>
<span class="term-fg31">-        byte[] sec = BaseEncoding.base16().lowerCase().decode(&quot;67E56582298859DDAE725F972992A07C6C4FB9F62A8FFF58CE3CA926A1063530&quot;.toLowerCase());</span>
<span class="term-fg31">-        byte[] data = BaseEncoding.base16().lowerCase().decode(&quot;3982F19BEF1615BCCFBB05E321C10E1D4CBA3DF0E841C2E41EEB6016347653C3&quot;.toLowerCase()); &#47;&#47;sha256hash of &quot;tweak&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        byte[] resultArr = NativeSecp256k1.privKeyTweakAdd( sec , data );</span>
<span class="term-fg31">-        String sigString = javax.xml.bind.DatatypeConverter.printHexBinary(resultArr);</span>
<span class="term-fg31">-        assertEquals( sigString , &quot;A168571E189E6F9A7E2D657A4B53AE99B909F7E712D1C23CED28093CD57C88F3&quot; , &quot;testPrivKeyAdd_1&quot;);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;**</span>
<span class="term-fg31">-      * This tests private key tweak-mul</span>
<span class="term-fg31">-      *&#47;</span>
<span class="term-fg31">-    public static void testPrivKeyTweakMul_1() throws AssertFailException {</span>
<span class="term-fg31">-        byte[] sec = BaseEncoding.base16().lowerCase().decode(&quot;67E56582298859DDAE725F972992A07C6C4FB9F62A8FFF58CE3CA926A1063530&quot;.toLowerCase());</span>
<span class="term-fg31">-        byte[] data = BaseEncoding.base16().lowerCase().decode(&quot;3982F19BEF1615BCCFBB05E321C10E1D4CBA3DF0E841C2E41EEB6016347653C3&quot;.toLowerCase()); &#47;&#47;sha256hash of &quot;tweak&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        byte[] resultArr = NativeSecp256k1.privKeyTweakMul( sec , data );</span>
<span class="term-fg31">-        String sigString = javax.xml.bind.DatatypeConverter.printHexBinary(resultArr);</span>
<span class="term-fg31">-        assertEquals( sigString , &quot;97F8184235F101550F3C71C927507651BD3F1CDB4A5A33B8986ACF0DEE20FFFC&quot; , &quot;testPrivKeyMul_1&quot;);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;**</span>
<span class="term-fg31">-      * This tests private key tweak-add uncompressed</span>
<span class="term-fg31">-      *&#47;</span>
<span class="term-fg31">-    public static void testPrivKeyTweakAdd_2() throws AssertFailException {</span>
<span class="term-fg31">-        byte[] pub = BaseEncoding.base16().lowerCase().decode(&quot;040A629506E1B65CD9D2E0BA9C75DF9C4FED0DB16DC9625ED14397F0AFC836FAE595DC53F8B0EFE61E703075BD9B143BAC75EC0E19F82A2208CAEB32BE53414C40&quot;.toLowerCase());</span>
<span class="term-fg31">-        byte[] data = BaseEncoding.base16().lowerCase().decode(&quot;3982F19BEF1615BCCFBB05E321C10E1D4CBA3DF0E841C2E41EEB6016347653C3&quot;.toLowerCase()); &#47;&#47;sha256hash of &quot;tweak&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        byte[] resultArr = NativeSecp256k1.pubKeyTweakAdd( pub , data );</span>
<span class="term-fg31">-        String sigString = javax.xml.bind.DatatypeConverter.printHexBinary(resultArr);</span>
<span class="term-fg31">-        assertEquals( sigString , &quot;0411C6790F4B663CCE607BAAE08C43557EDC1A4D11D88DFCB3D841D0C6A941AF525A268E2A863C148555C48FB5FBA368E88718A46E205FABC3DBA2CCFFAB0796EF&quot; , &quot;testPrivKeyAdd_2&quot;);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;**</span>
<span class="term-fg31">-      * This tests private key tweak-mul uncompressed</span>
<span class="term-fg31">-      *&#47;</span>
<span class="term-fg31">-    public static void testPrivKeyTweakMul_2() throws AssertFailException {</span>
<span class="term-fg31">-        byte[] pub = BaseEncoding.base16().lowerCase().decode(&quot;040A629506E1B65CD9D2E0BA9C75DF9C4FED0DB16DC9625ED14397F0AFC836FAE595DC53F8B0EFE61E703075BD9B143BAC75EC0E19F82A2208CAEB32BE53414C40&quot;.toLowerCase());</span>
<span class="term-fg31">-        byte[] data = BaseEncoding.base16().lowerCase().decode(&quot;3982F19BEF1615BCCFBB05E321C10E1D4CBA3DF0E841C2E41EEB6016347653C3&quot;.toLowerCase()); &#47;&#47;sha256hash of &quot;tweak&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        byte[] resultArr = NativeSecp256k1.pubKeyTweakMul( pub , data );</span>
<span class="term-fg31">-        String sigString = javax.xml.bind.DatatypeConverter.printHexBinary(resultArr);</span>
<span class="term-fg31">-        assertEquals( sigString , &quot;04E0FE6FE55EBCA626B98A807F6CAF654139E14E5E3698F01A9A658E21DC1D2791EC060D4F412A794D5370F672BC94B722640B5F76914151CFCA6E712CA48CC589&quot; , &quot;testPrivKeyMul_2&quot;);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;**</span>
<span class="term-fg31">-      * This tests seed randomization</span>
<span class="term-fg31">-      *&#47;</span>
<span class="term-fg31">-    public static void testRandomize() throws AssertFailException {</span>
<span class="term-fg31">-        byte[] seed = BaseEncoding.base16().lowerCase().decode(&quot;A441B15FE9A3CF56661190A0B93B9DEC7D04127288CC87250967CF3B52894D11&quot;.toLowerCase()); &#47;&#47;sha256hash of &quot;random&quot;</span>
<span class="term-fg31">-        boolean result = NativeSecp256k1.randomize(seed);</span>
<span class="term-fg31">-        assertEquals( result, true, &quot;testRandomize&quot;);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    public static void testCreateECDHSecret() throws AssertFailException{</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        byte[] sec = BaseEncoding.base16().lowerCase().decode(&quot;67E56582298859DDAE725F972992A07C6C4FB9F62A8FFF58CE3CA926A1063530&quot;.toLowerCase());</span>
<span class="term-fg31">-        byte[] pub = BaseEncoding.base16().lowerCase().decode(&quot;040A629506E1B65CD9D2E0BA9C75DF9C4FED0DB16DC9625ED14397F0AFC836FAE595DC53F8B0EFE61E703075BD9B143BAC75EC0E19F82A2208CAEB32BE53414C40&quot;.toLowerCase());</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        byte[] resultArr = NativeSecp256k1.createECDHSecret(sec, pub);</span>
<span class="term-fg31">-        String ecdhString = javax.xml.bind.DatatypeConverter.printHexBinary(resultArr);</span>
<span class="term-fg31">-        assertEquals( ecdhString, &quot;2A2A67007A926E6594AF3EB564FC74005B37A9C8AEF2033C4552051B5C87F043&quot; , &quot;testCreateECDHSecret&quot;);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    public static void main(String[] args) throws AssertFailException{</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        System.out.println(&quot;\n libsecp256k1 enabled: &quot; + Secp256k1Context.isEnabled() + &quot;\n&quot;);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        assertEquals( Secp256k1Context.isEnabled(), true, &quot;isEnabled&quot; );</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        &#47;&#47;Test verify() success&#47;fail</span>
<span class="term-fg31">-        testVerifyPos();</span>
<span class="term-fg31">-        testVerifyNeg();</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        &#47;&#47;Test secKeyVerify() success&#47;fail</span>
<span class="term-fg31">-        testSecKeyVerifyPos();</span>
<span class="term-fg31">-        testSecKeyVerifyNeg();</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        &#47;&#47;Test computePubkey() success&#47;fail</span>
<span class="term-fg31">-        testPubKeyCreatePos();</span>
<span class="term-fg31">-        testPubKeyCreateNeg();</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        &#47;&#47;Test sign() success&#47;fail</span>
<span class="term-fg31">-        testSignPos();</span>
<span class="term-fg31">-        testSignNeg();</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        &#47;&#47;Test privKeyTweakAdd() 1</span>
<span class="term-fg31">-        testPrivKeyTweakAdd_1();</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        &#47;&#47;Test privKeyTweakMul() 2</span>
<span class="term-fg31">-        testPrivKeyTweakMul_1();</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        &#47;&#47;Test privKeyTweakAdd() 3</span>
<span class="term-fg31">-        testPrivKeyTweakAdd_2();</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        &#47;&#47;Test privKeyTweakMul() 4</span>
<span class="term-fg31">-        testPrivKeyTweakMul_2();</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        &#47;&#47;Test randomize()</span>
<span class="term-fg31">-        testRandomize();</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        &#47;&#47;Test ECDH</span>
<span class="term-fg31">-        testCreateECDHSecret();</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        NativeSecp256k1.cleanup();</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        System.out.println(&quot; All tests passed.&quot; );</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-30417f9d80e2a252642b1cd0" role="button"
                       aria-expanded="false" aria-controls="id-30417f9d80e2a252642b1cd0">
                        <code>crypto/secp256k1/libsecp256k1/src/java/org/bitcoin/NativeSecp256k1Util.java</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/java/org/bitcoin/NativeSecp256k1Util.java" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-45</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-30417f9d80e2a252642b1cd0"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;java&#47;org&#47;bitcoin&#47;NativeSecp256k1Util.java op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;java&#47;org&#47;bitcoin&#47;NativeSecp256k1Util.java</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 04732ba044363a5dc5c525661a090c1bdf1d077f..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;java&#47;org&#47;bitcoin&#47;NativeSecp256k1Util.java</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,45 +0,0 @@</span>
<span class="term-fg31">-&#47;*</span>
<span class="term-fg31">- * Copyright 2014-2016 the libsecp256k1 contributors</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="term-fg31">- * you may not use this file except in compliance with the License.</span>
<span class="term-fg31">- * You may obtain a copy of the License at</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *    http:&#47;&#47;www.apache.org&#47;licenses&#47;LICENSE-2.0</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- * Unless required by applicable law or agreed to in writing, software</span>
<span class="term-fg31">- * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="term-fg31">- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="term-fg31">- * See the License for the specific language governing permissions and</span>
<span class="term-fg31">- * limitations under the License.</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-package org.bitcoin;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-public class NativeSecp256k1Util{</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    public static void assertEquals( int val, int val2, String message ) throws AssertFailException{</span>
<span class="term-fg31">-      if( val != val2 )</span>
<span class="term-fg31">-        throw new AssertFailException(&quot;FAIL: &quot; + message);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    public static void assertEquals( boolean val, boolean val2, String message ) throws AssertFailException{</span>
<span class="term-fg31">-      if( val != val2 )</span>
<span class="term-fg31">-        throw new AssertFailException(&quot;FAIL: &quot; + message);</span>
<span class="term-fg31">-      else</span>
<span class="term-fg31">-        System.out.println(&quot;PASS: &quot; + message);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    public static void assertEquals( String val, String val2, String message ) throws AssertFailException{</span>
<span class="term-fg31">-      if( !val.equals(val2) )</span>
<span class="term-fg31">-        throw new AssertFailException(&quot;FAIL: &quot; + message);</span>
<span class="term-fg31">-      else</span>
<span class="term-fg31">-        System.out.println(&quot;PASS: &quot; + message);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    public static class AssertFailException extends Exception {</span>
<span class="term-fg31">-      public AssertFailException(String message) {</span>
<span class="term-fg31">-        super( message );</span>
<span class="term-fg31">-      }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-66a338e41108d583d407898b" role="button"
                       aria-expanded="false" aria-controls="id-66a338e41108d583d407898b">
                        <code>crypto/secp256k1/libsecp256k1/src/java/org/bitcoin/Secp256k1Context.java</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/java/org/bitcoin/Secp256k1Context.java" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-51</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-66a338e41108d583d407898b"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;java&#47;org&#47;bitcoin&#47;Secp256k1Context.java op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;java&#47;org&#47;bitcoin&#47;Secp256k1Context.java</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 216c986a8b564d49b01243d513bdd182339e51b6..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;java&#47;org&#47;bitcoin&#47;Secp256k1Context.java</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,51 +0,0 @@</span>
<span class="term-fg31">-&#47;*</span>
<span class="term-fg31">- * Copyright 2014-2016 the libsecp256k1 contributors</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="term-fg31">- * you may not use this file except in compliance with the License.</span>
<span class="term-fg31">- * You may obtain a copy of the License at</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- *    http:&#47;&#47;www.apache.org&#47;licenses&#47;LICENSE-2.0</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- * Unless required by applicable law or agreed to in writing, software</span>
<span class="term-fg31">- * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="term-fg31">- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="term-fg31">- * See the License for the specific language governing permissions and</span>
<span class="term-fg31">- * limitations under the License.</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-package org.bitcoin;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;**</span>
<span class="term-fg31">- * This class holds the context reference used in native methods </span>
<span class="term-fg31">- * to handle ECDSA operations.</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-public class Secp256k1Context {</span>
<span class="term-fg31">-  private static final boolean enabled; &#47;&#47;true if the library is loaded</span>
<span class="term-fg31">-  private static final long context; &#47;&#47;ref to pointer to context obj</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  static { &#47;&#47;static initializer</span>
<span class="term-fg31">-      boolean isEnabled = true;</span>
<span class="term-fg31">-      long contextRef = -1;</span>
<span class="term-fg31">-      try {</span>
<span class="term-fg31">-          System.loadLibrary(&quot;secp256k1&quot;);</span>
<span class="term-fg31">-          contextRef = secp256k1_init_context();</span>
<span class="term-fg31">-      } catch (UnsatisfiedLinkError e) {</span>
<span class="term-fg31">-          System.out.println(&quot;UnsatisfiedLinkError: &quot; + e.toString());</span>
<span class="term-fg31">-          isEnabled = false;</span>
<span class="term-fg31">-      }</span>
<span class="term-fg31">-      enabled = isEnabled;</span>
<span class="term-fg31">-      context = contextRef;</span>
<span class="term-fg31">-  }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  public static boolean isEnabled() {</span>
<span class="term-fg31">-     return enabled;</span>
<span class="term-fg31">-  }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  public static long getContext() {</span>
<span class="term-fg31">-     if(!enabled) return -1; &#47;&#47;sanity check</span>
<span class="term-fg31">-     return context;</span>
<span class="term-fg31">-  }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  private static native long secp256k1_init_context();</span>
<span class="term-fg31">-}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-0ac6fd80f38e43d45765f521" role="button"
                       aria-expanded="false" aria-controls="id-0ac6fd80f38e43d45765f521">
                        <code>crypto/secp256k1/libsecp256k1/src/java/org_bitcoin_NativeSecp256k1.c</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/java/org_bitcoin_NativeSecp256k1.c" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-377</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-0ac6fd80f38e43d45765f521"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;java&#47;org_bitcoin_NativeSecp256k1.c op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;java&#47;org_bitcoin_NativeSecp256k1.c</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index bcef7b32ce3e7fe1587f15dac2e7c56fef998a8a..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;java&#47;org_bitcoin_NativeSecp256k1.c</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,377 +0,0 @@</span>
<span class="term-fg31">-#include &lt;stdlib.h&gt;</span>
<span class="term-fg31">-#include &lt;stdint.h&gt;</span>
<span class="term-fg31">-#include &lt;string.h&gt;</span>
<span class="term-fg31">-#include &quot;org_bitcoin_NativeSecp256k1.h&quot;</span>
<span class="term-fg31">-#include &quot;include&#47;secp256k1.h&quot;</span>
<span class="term-fg31">-#include &quot;include&#47;secp256k1_ecdh.h&quot;</span>
<span class="term-fg31">-#include &quot;include&#47;secp256k1_recovery.h&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_API jlong JNICALL Java_org_bitcoin_NativeSecp256k1_secp256k1_1ctx_1clone</span>
<span class="term-fg31">-  (JNIEnv* env, jclass classObject, jlong ctx_l)</span>
<span class="term-fg31">-{</span>
<span class="term-fg31">-  const secp256k1_context *ctx = (secp256k1_context*)(uintptr_t)ctx_l;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  jlong ctx_clone_l = (uintptr_t) secp256k1_context_clone(ctx);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  (void)classObject;(void)env;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  return ctx_clone_l;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_API jint JNICALL Java_org_bitcoin_NativeSecp256k1_secp256k1_1context_1randomize</span>
<span class="term-fg31">-  (JNIEnv* env, jclass classObject, jobject byteBufferObject, jlong ctx_l)</span>
<span class="term-fg31">-{</span>
<span class="term-fg31">-  secp256k1_context *ctx = (secp256k1_context*)(uintptr_t)ctx_l;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  const unsigned char* seed = (unsigned char*) (*env)-&gt;GetDirectBufferAddress(env, byteBufferObject);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  (void)classObject;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  return secp256k1_context_randomize(ctx, seed);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_API void JNICALL Java_org_bitcoin_NativeSecp256k1_secp256k1_1destroy_1context</span>
<span class="term-fg31">-  (JNIEnv* env, jclass classObject, jlong ctx_l)</span>
<span class="term-fg31">-{</span>
<span class="term-fg31">-  secp256k1_context *ctx = (secp256k1_context*)(uintptr_t)ctx_l;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  secp256k1_context_destroy(ctx);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  (void)classObject;(void)env;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_API jint JNICALL Java_org_bitcoin_NativeSecp256k1_secp256k1_1ecdsa_1verify</span>
<span class="term-fg31">-  (JNIEnv* env, jclass classObject, jobject byteBufferObject, jlong ctx_l, jint siglen, jint publen)</span>
<span class="term-fg31">-{</span>
<span class="term-fg31">-  secp256k1_context *ctx = (secp256k1_context*)(uintptr_t)ctx_l;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  unsigned char* data = (unsigned char*) (*env)-&gt;GetDirectBufferAddress(env, byteBufferObject);</span>
<span class="term-fg31">-  const unsigned char* sigdata = {  (unsigned char*) (data + 32) };</span>
<span class="term-fg31">-  const unsigned char* pubdata = { (unsigned char*) (data + siglen + 32) };</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  secp256k1_ecdsa_signature sig;</span>
<span class="term-fg31">-  secp256k1_pubkey pubkey;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  int ret = secp256k1_ecdsa_signature_parse_der(ctx, &amp;sig, sigdata, siglen);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  if( ret ) {</span>
<span class="term-fg31">-    ret = secp256k1_ec_pubkey_parse(ctx, &amp;pubkey, pubdata, publen);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    if( ret ) {</span>
<span class="term-fg31">-      ret = secp256k1_ecdsa_verify(ctx, &amp;sig, data, &amp;pubkey);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-  }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  (void)classObject;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  return ret;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_API jobjectArray JNICALL Java_org_bitcoin_NativeSecp256k1_secp256k1_1ecdsa_1sign</span>
<span class="term-fg31">-  (JNIEnv* env, jclass classObject, jobject byteBufferObject, jlong ctx_l)</span>
<span class="term-fg31">-{</span>
<span class="term-fg31">-  secp256k1_context *ctx = (secp256k1_context*)(uintptr_t)ctx_l;</span>
<span class="term-fg31">-  unsigned char* data = (unsigned char*) (*env)-&gt;GetDirectBufferAddress(env, byteBufferObject);</span>
<span class="term-fg31">-  unsigned char* secKey = (unsigned char*) (data + 32);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  jobjectArray retArray;</span>
<span class="term-fg31">-  jbyteArray sigArray, intsByteArray;</span>
<span class="term-fg31">-  unsigned char intsarray[2];</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  secp256k1_ecdsa_signature sig[72];</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  int ret = secp256k1_ecdsa_sign(ctx, sig, data, secKey, NULL, NULL );</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  unsigned char outputSer[72];</span>
<span class="term-fg31">-  size_t outputLen = 72;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  if( ret ) {</span>
<span class="term-fg31">-    int ret2 = secp256k1_ecdsa_signature_serialize_der(ctx,outputSer, &amp;outputLen, sig ); (void)ret2;</span>
<span class="term-fg31">-  }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  intsarray[0] = outputLen;</span>
<span class="term-fg31">-  intsarray[1] = ret;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  retArray = (*env)-&gt;NewObjectArray(env, 2,</span>
<span class="term-fg31">-    (*env)-&gt;FindClass(env, &quot;[B&quot;),</span>
<span class="term-fg31">-    (*env)-&gt;NewByteArray(env, 1));</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  sigArray = (*env)-&gt;NewByteArray(env, outputLen);</span>
<span class="term-fg31">-  (*env)-&gt;SetByteArrayRegion(env, sigArray, 0, outputLen, (jbyte*)outputSer);</span>
<span class="term-fg31">-  (*env)-&gt;SetObjectArrayElement(env, retArray, 0, sigArray);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  intsByteArray = (*env)-&gt;NewByteArray(env, 2);</span>
<span class="term-fg31">-  (*env)-&gt;SetByteArrayRegion(env, intsByteArray, 0, 2, (jbyte*)intsarray);</span>
<span class="term-fg31">-  (*env)-&gt;SetObjectArrayElement(env, retArray, 1, intsByteArray);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  (void)classObject;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  return retArray;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_API jint JNICALL Java_org_bitcoin_NativeSecp256k1_secp256k1_1ec_1seckey_1verify</span>
<span class="term-fg31">-  (JNIEnv* env, jclass classObject, jobject byteBufferObject, jlong ctx_l)</span>
<span class="term-fg31">-{</span>
<span class="term-fg31">-  secp256k1_context *ctx = (secp256k1_context*)(uintptr_t)ctx_l;</span>
<span class="term-fg31">-  unsigned char* secKey = (unsigned char*) (*env)-&gt;GetDirectBufferAddress(env, byteBufferObject);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  (void)classObject;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  return secp256k1_ec_seckey_verify(ctx, secKey);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_API jobjectArray JNICALL Java_org_bitcoin_NativeSecp256k1_secp256k1_1ec_1pubkey_1create</span>
<span class="term-fg31">-  (JNIEnv* env, jclass classObject, jobject byteBufferObject, jlong ctx_l)</span>
<span class="term-fg31">-{</span>
<span class="term-fg31">-  secp256k1_context *ctx = (secp256k1_context*)(uintptr_t)ctx_l;</span>
<span class="term-fg31">-  const unsigned char* secKey = (unsigned char*) (*env)-&gt;GetDirectBufferAddress(env, byteBufferObject);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  secp256k1_pubkey pubkey;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  jobjectArray retArray;</span>
<span class="term-fg31">-  jbyteArray pubkeyArray, intsByteArray;</span>
<span class="term-fg31">-  unsigned char intsarray[2];</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  int ret = secp256k1_ec_pubkey_create(ctx, &amp;pubkey, secKey);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  unsigned char outputSer[65];</span>
<span class="term-fg31">-  size_t outputLen = 65;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  if( ret ) {</span>
<span class="term-fg31">-    int ret2 = secp256k1_ec_pubkey_serialize(ctx,outputSer, &amp;outputLen, &amp;pubkey,SECP256K1_EC_UNCOMPRESSED );(void)ret2;</span>
<span class="term-fg31">-  }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  intsarray[0] = outputLen;</span>
<span class="term-fg31">-  intsarray[1] = ret;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  retArray = (*env)-&gt;NewObjectArray(env, 2,</span>
<span class="term-fg31">-    (*env)-&gt;FindClass(env, &quot;[B&quot;),</span>
<span class="term-fg31">-    (*env)-&gt;NewByteArray(env, 1));</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  pubkeyArray = (*env)-&gt;NewByteArray(env, outputLen);</span>
<span class="term-fg31">-  (*env)-&gt;SetByteArrayRegion(env, pubkeyArray, 0, outputLen, (jbyte*)outputSer);</span>
<span class="term-fg31">-  (*env)-&gt;SetObjectArrayElement(env, retArray, 0, pubkeyArray);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  intsByteArray = (*env)-&gt;NewByteArray(env, 2);</span>
<span class="term-fg31">-  (*env)-&gt;SetByteArrayRegion(env, intsByteArray, 0, 2, (jbyte*)intsarray);</span>
<span class="term-fg31">-  (*env)-&gt;SetObjectArrayElement(env, retArray, 1, intsByteArray);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  (void)classObject;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  return retArray;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_API jobjectArray JNICALL Java_org_bitcoin_NativeSecp256k1_secp256k1_1privkey_1tweak_1add</span>
<span class="term-fg31">-  (JNIEnv* env, jclass classObject, jobject byteBufferObject, jlong ctx_l)</span>
<span class="term-fg31">-{</span>
<span class="term-fg31">-  secp256k1_context *ctx = (secp256k1_context*)(uintptr_t)ctx_l;</span>
<span class="term-fg31">-  unsigned char* privkey = (unsigned char*) (*env)-&gt;GetDirectBufferAddress(env, byteBufferObject);</span>
<span class="term-fg31">-  const unsigned char* tweak = (unsigned char*) (privkey + 32);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  jobjectArray retArray;</span>
<span class="term-fg31">-  jbyteArray privArray, intsByteArray;</span>
<span class="term-fg31">-  unsigned char intsarray[2];</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  int privkeylen = 32;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  int ret = secp256k1_ec_privkey_tweak_add(ctx, privkey, tweak);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  intsarray[0] = privkeylen;</span>
<span class="term-fg31">-  intsarray[1] = ret;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  retArray = (*env)-&gt;NewObjectArray(env, 2,</span>
<span class="term-fg31">-    (*env)-&gt;FindClass(env, &quot;[B&quot;),</span>
<span class="term-fg31">-    (*env)-&gt;NewByteArray(env, 1));</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  privArray = (*env)-&gt;NewByteArray(env, privkeylen);</span>
<span class="term-fg31">-  (*env)-&gt;SetByteArrayRegion(env, privArray, 0, privkeylen, (jbyte*)privkey);</span>
<span class="term-fg31">-  (*env)-&gt;SetObjectArrayElement(env, retArray, 0, privArray);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  intsByteArray = (*env)-&gt;NewByteArray(env, 2);</span>
<span class="term-fg31">-  (*env)-&gt;SetByteArrayRegion(env, intsByteArray, 0, 2, (jbyte*)intsarray);</span>
<span class="term-fg31">-  (*env)-&gt;SetObjectArrayElement(env, retArray, 1, intsByteArray);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  (void)classObject;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  return retArray;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_API jobjectArray JNICALL Java_org_bitcoin_NativeSecp256k1_secp256k1_1privkey_1tweak_1mul</span>
<span class="term-fg31">-  (JNIEnv* env, jclass classObject, jobject byteBufferObject, jlong ctx_l)</span>
<span class="term-fg31">-{</span>
<span class="term-fg31">-  secp256k1_context *ctx = (secp256k1_context*)(uintptr_t)ctx_l;</span>
<span class="term-fg31">-  unsigned char* privkey = (unsigned char*) (*env)-&gt;GetDirectBufferAddress(env, byteBufferObject);</span>
<span class="term-fg31">-  const unsigned char* tweak = (unsigned char*) (privkey + 32);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  jobjectArray retArray;</span>
<span class="term-fg31">-  jbyteArray privArray, intsByteArray;</span>
<span class="term-fg31">-  unsigned char intsarray[2];</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  int privkeylen = 32;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  int ret = secp256k1_ec_privkey_tweak_mul(ctx, privkey, tweak);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  intsarray[0] = privkeylen;</span>
<span class="term-fg31">-  intsarray[1] = ret;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  retArray = (*env)-&gt;NewObjectArray(env, 2,</span>
<span class="term-fg31">-    (*env)-&gt;FindClass(env, &quot;[B&quot;),</span>
<span class="term-fg31">-    (*env)-&gt;NewByteArray(env, 1));</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  privArray = (*env)-&gt;NewByteArray(env, privkeylen);</span>
<span class="term-fg31">-  (*env)-&gt;SetByteArrayRegion(env, privArray, 0, privkeylen, (jbyte*)privkey);</span>
<span class="term-fg31">-  (*env)-&gt;SetObjectArrayElement(env, retArray, 0, privArray);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  intsByteArray = (*env)-&gt;NewByteArray(env, 2);</span>
<span class="term-fg31">-  (*env)-&gt;SetByteArrayRegion(env, intsByteArray, 0, 2, (jbyte*)intsarray);</span>
<span class="term-fg31">-  (*env)-&gt;SetObjectArrayElement(env, retArray, 1, intsByteArray);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  (void)classObject;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  return retArray;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_API jobjectArray JNICALL Java_org_bitcoin_NativeSecp256k1_secp256k1_1pubkey_1tweak_1add</span>
<span class="term-fg31">-  (JNIEnv* env, jclass classObject, jobject byteBufferObject, jlong ctx_l, jint publen)</span>
<span class="term-fg31">-{</span>
<span class="term-fg31">-  secp256k1_context *ctx = (secp256k1_context*)(uintptr_t)ctx_l;</span>
<span class="term-fg31">-&#47;*  secp256k1_pubkey* pubkey = (secp256k1_pubkey*) (*env)-&gt;GetDirectBufferAddress(env, byteBufferObject);*&#47;</span>
<span class="term-fg31">-  unsigned char* pkey = (*env)-&gt;GetDirectBufferAddress(env, byteBufferObject);</span>
<span class="term-fg31">-  const unsigned char* tweak = (unsigned char*) (pkey + publen);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  jobjectArray retArray;</span>
<span class="term-fg31">-  jbyteArray pubArray, intsByteArray;</span>
<span class="term-fg31">-  unsigned char intsarray[2];</span>
<span class="term-fg31">-  unsigned char outputSer[65];</span>
<span class="term-fg31">-  size_t outputLen = 65;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  secp256k1_pubkey pubkey;</span>
<span class="term-fg31">-  int ret = secp256k1_ec_pubkey_parse(ctx, &amp;pubkey, pkey, publen);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  if( ret ) {</span>
<span class="term-fg31">-    ret = secp256k1_ec_pubkey_tweak_add(ctx, &amp;pubkey, tweak);</span>
<span class="term-fg31">-  }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  if( ret ) {</span>
<span class="term-fg31">-    int ret2 = secp256k1_ec_pubkey_serialize(ctx,outputSer, &amp;outputLen, &amp;pubkey,SECP256K1_EC_UNCOMPRESSED );(void)ret2;</span>
<span class="term-fg31">-  }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  intsarray[0] = outputLen;</span>
<span class="term-fg31">-  intsarray[1] = ret;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  retArray = (*env)-&gt;NewObjectArray(env, 2,</span>
<span class="term-fg31">-    (*env)-&gt;FindClass(env, &quot;[B&quot;),</span>
<span class="term-fg31">-    (*env)-&gt;NewByteArray(env, 1));</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  pubArray = (*env)-&gt;NewByteArray(env, outputLen);</span>
<span class="term-fg31">-  (*env)-&gt;SetByteArrayRegion(env, pubArray, 0, outputLen, (jbyte*)outputSer);</span>
<span class="term-fg31">-  (*env)-&gt;SetObjectArrayElement(env, retArray, 0, pubArray);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  intsByteArray = (*env)-&gt;NewByteArray(env, 2);</span>
<span class="term-fg31">-  (*env)-&gt;SetByteArrayRegion(env, intsByteArray, 0, 2, (jbyte*)intsarray);</span>
<span class="term-fg31">-  (*env)-&gt;SetObjectArrayElement(env, retArray, 1, intsByteArray);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  (void)classObject;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  return retArray;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_API jobjectArray JNICALL Java_org_bitcoin_NativeSecp256k1_secp256k1_1pubkey_1tweak_1mul</span>
<span class="term-fg31">-  (JNIEnv* env, jclass classObject, jobject byteBufferObject, jlong ctx_l, jint publen)</span>
<span class="term-fg31">-{</span>
<span class="term-fg31">-  secp256k1_context *ctx = (secp256k1_context*)(uintptr_t)ctx_l;</span>
<span class="term-fg31">-  unsigned char* pkey = (*env)-&gt;GetDirectBufferAddress(env, byteBufferObject);</span>
<span class="term-fg31">-  const unsigned char* tweak = (unsigned char*) (pkey + publen);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  jobjectArray retArray;</span>
<span class="term-fg31">-  jbyteArray pubArray, intsByteArray;</span>
<span class="term-fg31">-  unsigned char intsarray[2];</span>
<span class="term-fg31">-  unsigned char outputSer[65];</span>
<span class="term-fg31">-  size_t outputLen = 65;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  secp256k1_pubkey pubkey;</span>
<span class="term-fg31">-  int ret = secp256k1_ec_pubkey_parse(ctx, &amp;pubkey, pkey, publen);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  if ( ret ) {</span>
<span class="term-fg31">-    ret = secp256k1_ec_pubkey_tweak_mul(ctx, &amp;pubkey, tweak);</span>
<span class="term-fg31">-  }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  if( ret ) {</span>
<span class="term-fg31">-    int ret2 = secp256k1_ec_pubkey_serialize(ctx,outputSer, &amp;outputLen, &amp;pubkey,SECP256K1_EC_UNCOMPRESSED );(void)ret2;</span>
<span class="term-fg31">-  }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  intsarray[0] = outputLen;</span>
<span class="term-fg31">-  intsarray[1] = ret;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  retArray = (*env)-&gt;NewObjectArray(env, 2,</span>
<span class="term-fg31">-    (*env)-&gt;FindClass(env, &quot;[B&quot;),</span>
<span class="term-fg31">-    (*env)-&gt;NewByteArray(env, 1));</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  pubArray = (*env)-&gt;NewByteArray(env, outputLen);</span>
<span class="term-fg31">-  (*env)-&gt;SetByteArrayRegion(env, pubArray, 0, outputLen, (jbyte*)outputSer);</span>
<span class="term-fg31">-  (*env)-&gt;SetObjectArrayElement(env, retArray, 0, pubArray);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  intsByteArray = (*env)-&gt;NewByteArray(env, 2);</span>
<span class="term-fg31">-  (*env)-&gt;SetByteArrayRegion(env, intsByteArray, 0, 2, (jbyte*)intsarray);</span>
<span class="term-fg31">-  (*env)-&gt;SetObjectArrayElement(env, retArray, 1, intsByteArray);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  (void)classObject;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  return retArray;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_API jlong JNICALL Java_org_bitcoin_NativeSecp256k1_secp256k1_1ecdsa_1pubkey_1combine</span>
<span class="term-fg31">-  (JNIEnv * env, jclass classObject, jobject byteBufferObject, jlong ctx_l, jint numkeys)</span>
<span class="term-fg31">-{</span>
<span class="term-fg31">-  (void)classObject;(void)env;(void)byteBufferObject;(void)ctx_l;(void)numkeys;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  return 0;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_API jobjectArray JNICALL Java_org_bitcoin_NativeSecp256k1_secp256k1_1ecdh</span>
<span class="term-fg31">-  (JNIEnv* env, jclass classObject, jobject byteBufferObject, jlong ctx_l, jint publen)</span>
<span class="term-fg31">-{</span>
<span class="term-fg31">-  secp256k1_context *ctx = (secp256k1_context*)(uintptr_t)ctx_l;</span>
<span class="term-fg31">-  const unsigned char* secdata = (*env)-&gt;GetDirectBufferAddress(env, byteBufferObject);</span>
<span class="term-fg31">-  const unsigned char* pubdata = (const unsigned char*) (secdata + 32);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  jobjectArray retArray;</span>
<span class="term-fg31">-  jbyteArray outArray, intsByteArray;</span>
<span class="term-fg31">-  unsigned char intsarray[1];</span>
<span class="term-fg31">-  secp256k1_pubkey pubkey;</span>
<span class="term-fg31">-  unsigned char nonce_res[32];</span>
<span class="term-fg31">-  size_t outputLen = 32;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  int ret = secp256k1_ec_pubkey_parse(ctx, &amp;pubkey, pubdata, publen);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  if (ret) {</span>
<span class="term-fg31">-    ret = secp256k1_ecdh(</span>
<span class="term-fg31">-      ctx,</span>
<span class="term-fg31">-      nonce_res,</span>
<span class="term-fg31">-      &amp;pubkey,</span>
<span class="term-fg31">-      secdata</span>
<span class="term-fg31">-    );</span>
<span class="term-fg31">-  }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  intsarray[0] = ret;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  retArray = (*env)-&gt;NewObjectArray(env, 2,</span>
<span class="term-fg31">-    (*env)-&gt;FindClass(env, &quot;[B&quot;),</span>
<span class="term-fg31">-    (*env)-&gt;NewByteArray(env, 1));</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  outArray = (*env)-&gt;NewByteArray(env, outputLen);</span>
<span class="term-fg31">-  (*env)-&gt;SetByteArrayRegion(env, outArray, 0, 32, (jbyte*)nonce_res);</span>
<span class="term-fg31">-  (*env)-&gt;SetObjectArrayElement(env, retArray, 0, outArray);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  intsByteArray = (*env)-&gt;NewByteArray(env, 1);</span>
<span class="term-fg31">-  (*env)-&gt;SetByteArrayRegion(env, intsByteArray, 0, 1, (jbyte*)intsarray);</span>
<span class="term-fg31">-  (*env)-&gt;SetObjectArrayElement(env, retArray, 1, intsByteArray);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  (void)classObject;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  return retArray;</span>
<span class="term-fg31">-}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-b0f0aceb1bef4b91e6d75b89" role="button"
                       aria-expanded="false" aria-controls="id-b0f0aceb1bef4b91e6d75b89">
                        <code>crypto/secp256k1/libsecp256k1/src/java/org_bitcoin_NativeSecp256k1.h</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/java/org_bitcoin_NativeSecp256k1.h" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-119</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-b0f0aceb1bef4b91e6d75b89"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;java&#47;org_bitcoin_NativeSecp256k1.h op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;java&#47;org_bitcoin_NativeSecp256k1.h</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index fe613c9e9e77eddb18e0b0d8422948678f3408a8..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;java&#47;org_bitcoin_NativeSecp256k1.h</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,119 +0,0 @@</span>
<span class="term-fg31">-&#47;* DO NOT EDIT THIS FILE - it is machine generated *&#47;</span>
<span class="term-fg31">-#include &lt;jni.h&gt;</span>
<span class="term-fg31">-#include &quot;include&#47;secp256k1.h&quot;</span>
<span class="term-fg31">-&#47;* Header for class org_bitcoin_NativeSecp256k1 *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef _Included_org_bitcoin_NativeSecp256k1</span>
<span class="term-fg31">-#define _Included_org_bitcoin_NativeSecp256k1</span>
<span class="term-fg31">-#ifdef __cplusplus</span>
<span class="term-fg31">-extern &quot;C&quot; {</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-&#47;*</span>
<span class="term-fg31">- * Class:     org_bitcoin_NativeSecp256k1</span>
<span class="term-fg31">- * Method:    secp256k1_ctx_clone</span>
<span class="term-fg31">- * Signature: (J)J</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-SECP256K1_API jlong JNICALL Java_org_bitcoin_NativeSecp256k1_secp256k1_1ctx_1clone</span>
<span class="term-fg31">-  (JNIEnv *, jclass, jlong);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;*</span>
<span class="term-fg31">- * Class:     org_bitcoin_NativeSecp256k1</span>
<span class="term-fg31">- * Method:    secp256k1_context_randomize</span>
<span class="term-fg31">- * Signature: (Ljava&#47;nio&#47;ByteBuffer;J)I</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-SECP256K1_API jint JNICALL Java_org_bitcoin_NativeSecp256k1_secp256k1_1context_1randomize</span>
<span class="term-fg31">-  (JNIEnv *, jclass, jobject, jlong);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;*</span>
<span class="term-fg31">- * Class:     org_bitcoin_NativeSecp256k1</span>
<span class="term-fg31">- * Method:    secp256k1_privkey_tweak_add</span>
<span class="term-fg31">- * Signature: (Ljava&#47;nio&#47;ByteBuffer;J)[[B</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-SECP256K1_API jobjectArray JNICALL Java_org_bitcoin_NativeSecp256k1_secp256k1_1privkey_1tweak_1add</span>
<span class="term-fg31">-  (JNIEnv *, jclass, jobject, jlong);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;*</span>
<span class="term-fg31">- * Class:     org_bitcoin_NativeSecp256k1</span>
<span class="term-fg31">- * Method:    secp256k1_privkey_tweak_mul</span>
<span class="term-fg31">- * Signature: (Ljava&#47;nio&#47;ByteBuffer;J)[[B</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-SECP256K1_API jobjectArray JNICALL Java_org_bitcoin_NativeSecp256k1_secp256k1_1privkey_1tweak_1mul</span>
<span class="term-fg31">-  (JNIEnv *, jclass, jobject, jlong);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;*</span>
<span class="term-fg31">- * Class:     org_bitcoin_NativeSecp256k1</span>
<span class="term-fg31">- * Method:    secp256k1_pubkey_tweak_add</span>
<span class="term-fg31">- * Signature: (Ljava&#47;nio&#47;ByteBuffer;JI)[[B</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-SECP256K1_API jobjectArray JNICALL Java_org_bitcoin_NativeSecp256k1_secp256k1_1pubkey_1tweak_1add</span>
<span class="term-fg31">-  (JNIEnv *, jclass, jobject, jlong, jint);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;*</span>
<span class="term-fg31">- * Class:     org_bitcoin_NativeSecp256k1</span>
<span class="term-fg31">- * Method:    secp256k1_pubkey_tweak_mul</span>
<span class="term-fg31">- * Signature: (Ljava&#47;nio&#47;ByteBuffer;JI)[[B</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-SECP256K1_API jobjectArray JNICALL Java_org_bitcoin_NativeSecp256k1_secp256k1_1pubkey_1tweak_1mul</span>
<span class="term-fg31">-  (JNIEnv *, jclass, jobject, jlong, jint);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;*</span>
<span class="term-fg31">- * Class:     org_bitcoin_NativeSecp256k1</span>
<span class="term-fg31">- * Method:    secp256k1_destroy_context</span>
<span class="term-fg31">- * Signature: (J)V</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-SECP256K1_API void JNICALL Java_org_bitcoin_NativeSecp256k1_secp256k1_1destroy_1context</span>
<span class="term-fg31">-  (JNIEnv *, jclass, jlong);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;*</span>
<span class="term-fg31">- * Class:     org_bitcoin_NativeSecp256k1</span>
<span class="term-fg31">- * Method:    secp256k1_ecdsa_verify</span>
<span class="term-fg31">- * Signature: (Ljava&#47;nio&#47;ByteBuffer;JII)I</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-SECP256K1_API jint JNICALL Java_org_bitcoin_NativeSecp256k1_secp256k1_1ecdsa_1verify</span>
<span class="term-fg31">-  (JNIEnv *, jclass, jobject, jlong, jint, jint);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;*</span>
<span class="term-fg31">- * Class:     org_bitcoin_NativeSecp256k1</span>
<span class="term-fg31">- * Method:    secp256k1_ecdsa_sign</span>
<span class="term-fg31">- * Signature: (Ljava&#47;nio&#47;ByteBuffer;J)[[B</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-SECP256K1_API jobjectArray JNICALL Java_org_bitcoin_NativeSecp256k1_secp256k1_1ecdsa_1sign</span>
<span class="term-fg31">-  (JNIEnv *, jclass, jobject, jlong);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;*</span>
<span class="term-fg31">- * Class:     org_bitcoin_NativeSecp256k1</span>
<span class="term-fg31">- * Method:    secp256k1_ec_seckey_verify</span>
<span class="term-fg31">- * Signature: (Ljava&#47;nio&#47;ByteBuffer;J)I</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-SECP256K1_API jint JNICALL Java_org_bitcoin_NativeSecp256k1_secp256k1_1ec_1seckey_1verify</span>
<span class="term-fg31">-  (JNIEnv *, jclass, jobject, jlong);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;*</span>
<span class="term-fg31">- * Class:     org_bitcoin_NativeSecp256k1</span>
<span class="term-fg31">- * Method:    secp256k1_ec_pubkey_create</span>
<span class="term-fg31">- * Signature: (Ljava&#47;nio&#47;ByteBuffer;J)[[B</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-SECP256K1_API jobjectArray JNICALL Java_org_bitcoin_NativeSecp256k1_secp256k1_1ec_1pubkey_1create</span>
<span class="term-fg31">-  (JNIEnv *, jclass, jobject, jlong);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;*</span>
<span class="term-fg31">- * Class:     org_bitcoin_NativeSecp256k1</span>
<span class="term-fg31">- * Method:    secp256k1_ec_pubkey_parse</span>
<span class="term-fg31">- * Signature: (Ljava&#47;nio&#47;ByteBuffer;JI)[[B</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-SECP256K1_API jobjectArray JNICALL Java_org_bitcoin_NativeSecp256k1_secp256k1_1ec_1pubkey_1parse</span>
<span class="term-fg31">-  (JNIEnv *, jclass, jobject, jlong, jint);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;*</span>
<span class="term-fg31">- * Class:     org_bitcoin_NativeSecp256k1</span>
<span class="term-fg31">- * Method:    secp256k1_ecdh</span>
<span class="term-fg31">- * Signature: (Ljava&#47;nio&#47;ByteBuffer;JI)[[B</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-SECP256K1_API jobjectArray JNICALL Java_org_bitcoin_NativeSecp256k1_secp256k1_1ecdh</span>
<span class="term-fg31">-  (JNIEnv* env, jclass classObject, jobject byteBufferObject, jlong ctx_l, jint publen);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef __cplusplus</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-#endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-bb5a6b528b108b7c7240d213" role="button"
                       aria-expanded="false" aria-controls="id-bb5a6b528b108b7c7240d213">
                        <code>crypto/secp256k1/libsecp256k1/src/java/org_bitcoin_Secp256k1Context.c</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/java/org_bitcoin_Secp256k1Context.c" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-15</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-bb5a6b528b108b7c7240d213"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;java&#47;org_bitcoin_Secp256k1Context.c op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;java&#47;org_bitcoin_Secp256k1Context.c</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index a52939e7e7dacda374ec879d69b29ebb9add2dbc..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;java&#47;org_bitcoin_Secp256k1Context.c</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,15 +0,0 @@</span>
<span class="term-fg31">-#include &lt;stdlib.h&gt;</span>
<span class="term-fg31">-#include &lt;stdint.h&gt;</span>
<span class="term-fg31">-#include &quot;org_bitcoin_Secp256k1Context.h&quot;</span>
<span class="term-fg31">-#include &quot;include&#47;secp256k1.h&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_API jlong JNICALL Java_org_bitcoin_Secp256k1Context_secp256k1_1init_1context</span>
<span class="term-fg31">-  (JNIEnv* env, jclass classObject)</span>
<span class="term-fg31">-{</span>
<span class="term-fg31">-  secp256k1_context *ctx = secp256k1_context_create(SECP256K1_CONTEXT_SIGN | SECP256K1_CONTEXT_VERIFY);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  (void)classObject;(void)env;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-  return (uintptr_t)ctx;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-fd868c1b188f4cb39c75656b" role="button"
                       aria-expanded="false" aria-controls="id-fd868c1b188f4cb39c75656b">
                        <code>crypto/secp256k1/libsecp256k1/src/java/org_bitcoin_Secp256k1Context.h</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/java/org_bitcoin_Secp256k1Context.h" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-22</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-fd868c1b188f4cb39c75656b"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;java&#47;org_bitcoin_Secp256k1Context.h op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;java&#47;org_bitcoin_Secp256k1Context.h</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 0d2bc84b7f3fde84f81115a037be6de105f0472b..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;java&#47;org_bitcoin_Secp256k1Context.h</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,22 +0,0 @@</span>
<span class="term-fg31">-&#47;* DO NOT EDIT THIS FILE - it is machine generated *&#47;</span>
<span class="term-fg31">-#include &lt;jni.h&gt;</span>
<span class="term-fg31">-#include &quot;include&#47;secp256k1.h&quot;</span>
<span class="term-fg31">-&#47;* Header for class org_bitcoin_Secp256k1Context *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef _Included_org_bitcoin_Secp256k1Context</span>
<span class="term-fg31">-#define _Included_org_bitcoin_Secp256k1Context</span>
<span class="term-fg31">-#ifdef __cplusplus</span>
<span class="term-fg31">-extern &quot;C&quot; {</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-&#47;*</span>
<span class="term-fg31">- * Class:     org_bitcoin_Secp256k1Context</span>
<span class="term-fg31">- * Method:    secp256k1_init_context</span>
<span class="term-fg31">- * Signature: ()J</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-SECP256K1_API jlong JNICALL Java_org_bitcoin_Secp256k1Context_secp256k1_1init_1context</span>
<span class="term-fg31">-  (JNIEnv *, jclass);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef __cplusplus</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-#endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-20866a03570dcc49cf253a8b" role="button"
                       aria-expanded="false" aria-controls="id-20866a03570dcc49cf253a8b">
                        <code>crypto/secp256k1/libsecp256k1/src/modules/dummy.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/modules/dummy.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-8</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-20866a03570dcc49cf253a8b"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;modules&#47;dummy.go op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;modules&#47;dummy.go</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 99c538db51b042dcacaa0ff5396495ac52438a4b..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;modules&#47;dummy.go</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,8 +0,0 @@</span>
<span class="term-fg31">-&#47;&#47;go:build dummy</span>
<span class="term-fg31">-&#47;&#47; +build dummy</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;&#47; Package c contains only a C file.</span>
<span class="term-fg31">-&#47;&#47;</span>
<span class="term-fg31">-&#47;&#47; This Go file is part of a workaround for `go mod vendor`.</span>
<span class="term-fg31">-&#47;&#47; Please see the file crypto&#47;secp256k1&#47;dummy.go for more information.</span>
<span class="term-fg31">-package module</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-5313e2adfec30626df656250" role="button"
                       aria-expanded="false" aria-controls="id-5313e2adfec30626df656250">
                        <code>crypto/secp256k1/libsecp256k1/src/modules/ecdh/Makefile.am.include</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/modules/ecdh/Makefile.am.include" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-8</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-5313e2adfec30626df656250"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;modules&#47;ecdh&#47;Makefile.am.include op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;modules&#47;ecdh&#47;Makefile.am.include</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index e3088b469790bdc14b8982931d5729a7eabde69b..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;modules&#47;ecdh&#47;Makefile.am.include</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,8 +0,0 @@</span>
<span class="term-fg31">-include_HEADERS += include&#47;secp256k1_ecdh.h</span>
<span class="term-fg31">-noinst_HEADERS += src&#47;modules&#47;ecdh&#47;main_impl.h</span>
<span class="term-fg31">-noinst_HEADERS += src&#47;modules&#47;ecdh&#47;tests_impl.h</span>
<span class="term-fg31">-if USE_BENCHMARK</span>
<span class="term-fg31">-noinst_PROGRAMS += bench_ecdh</span>
<span class="term-fg31">-bench_ecdh_SOURCES = src&#47;bench_ecdh.c</span>
<span class="term-fg31">-bench_ecdh_LDADD = libsecp256k1.la $(SECP_LIBS) $(COMMON_LIB)</span>
<span class="term-fg31">-endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-037b2405b2b77fb0979a2af6" role="button"
                       aria-expanded="false" aria-controls="id-037b2405b2b77fb0979a2af6">
                        <code>crypto/secp256k1/libsecp256k1/src/modules/ecdh/dummy.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/modules/ecdh/dummy.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-8</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-037b2405b2b77fb0979a2af6"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;modules&#47;ecdh&#47;dummy.go op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;modules&#47;ecdh&#47;dummy.go</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 48c2e0aa545363ee95a70f3e563a6630693baf46..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;modules&#47;ecdh&#47;dummy.go</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,8 +0,0 @@</span>
<span class="term-fg31">-&#47;&#47;go:build dummy</span>
<span class="term-fg31">-&#47;&#47; +build dummy</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;&#47; Package c contains only a C file.</span>
<span class="term-fg31">-&#47;&#47;</span>
<span class="term-fg31">-&#47;&#47; This Go file is part of a workaround for `go mod vendor`.</span>
<span class="term-fg31">-&#47;&#47; Please see the file crypto&#47;secp256k1&#47;dummy.go for more information.</span>
<span class="term-fg31">-package ecdh</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-519f0fdd44487bbd9890fe02" role="button"
                       aria-expanded="false" aria-controls="id-519f0fdd44487bbd9890fe02">
                        <code>crypto/secp256k1/libsecp256k1/src/modules/ecdh/main_impl.h</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/modules/ecdh/main_impl.h" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-54</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-519f0fdd44487bbd9890fe02"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;modules&#47;ecdh&#47;main_impl.h op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;modules&#47;ecdh&#47;main_impl.h</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 9e30fb73dd7fb98b6e860cfb9054f1d66fb4089a..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;modules&#47;ecdh&#47;main_impl.h</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,54 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2015 Andrew Poelstra                                 *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef _SECP256K1_MODULE_ECDH_MAIN_</span>
<span class="term-fg31">-#define _SECP256K1_MODULE_ECDH_MAIN_</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &quot;include&#47;secp256k1_ecdh.h&quot;</span>
<span class="term-fg31">-#include &quot;ecmult_const_impl.h&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-int secp256k1_ecdh(const secp256k1_context* ctx, unsigned char *result, const secp256k1_pubkey *point, const unsigned char *scalar) {</span>
<span class="term-fg31">-    int ret = 0;</span>
<span class="term-fg31">-    int overflow = 0;</span>
<span class="term-fg31">-    secp256k1_gej res;</span>
<span class="term-fg31">-    secp256k1_ge pt;</span>
<span class="term-fg31">-    secp256k1_scalar s;</span>
<span class="term-fg31">-    VERIFY_CHECK(ctx != NULL);</span>
<span class="term-fg31">-    ARG_CHECK(result != NULL);</span>
<span class="term-fg31">-    ARG_CHECK(point != NULL);</span>
<span class="term-fg31">-    ARG_CHECK(scalar != NULL);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_pubkey_load(ctx, &amp;pt, point);</span>
<span class="term-fg31">-    secp256k1_scalar_set_b32(&amp;s, scalar, &amp;overflow);</span>
<span class="term-fg31">-    if (overflow || secp256k1_scalar_is_zero(&amp;s)) {</span>
<span class="term-fg31">-        ret = 0;</span>
<span class="term-fg31">-    } else {</span>
<span class="term-fg31">-        unsigned char x[32];</span>
<span class="term-fg31">-        unsigned char y[1];</span>
<span class="term-fg31">-        secp256k1_sha256_t sha;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        secp256k1_ecmult_const(&amp;res, &amp;pt, &amp;s);</span>
<span class="term-fg31">-        secp256k1_ge_set_gej(&amp;pt, &amp;res);</span>
<span class="term-fg31">-        &#47;* Compute a hash of the point in compressed form</span>
<span class="term-fg31">-         * Note we cannot use secp256k1_eckey_pubkey_serialize here since it does not</span>
<span class="term-fg31">-         * expect its output to be secret and has a timing sidechannel. *&#47;</span>
<span class="term-fg31">-        secp256k1_fe_normalize(&amp;pt.x);</span>
<span class="term-fg31">-        secp256k1_fe_normalize(&amp;pt.y);</span>
<span class="term-fg31">-        secp256k1_fe_get_b32(x, &amp;pt.x);</span>
<span class="term-fg31">-        y[0] = 0x02 | secp256k1_fe_is_odd(&amp;pt.y);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        secp256k1_sha256_initialize(&amp;sha);</span>
<span class="term-fg31">-        secp256k1_sha256_write(&amp;sha, y, sizeof(y));</span>
<span class="term-fg31">-        secp256k1_sha256_write(&amp;sha, x, sizeof(x));</span>
<span class="term-fg31">-        secp256k1_sha256_finalize(&amp;sha, result);</span>
<span class="term-fg31">-        ret = 1;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_scalar_clear(&amp;s);</span>
<span class="term-fg31">-    return ret;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-fc46f62272af373223eded59" role="button"
                       aria-expanded="false" aria-controls="id-fc46f62272af373223eded59">
                        <code>crypto/secp256k1/libsecp256k1/src/modules/ecdh/tests_impl.h</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/modules/ecdh/tests_impl.h" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-105</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-fc46f62272af373223eded59"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;modules&#47;ecdh&#47;tests_impl.h op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;modules&#47;ecdh&#47;tests_impl.h</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 85a5d0a9a69e10d585c2bc2ad4df03f14cf0def6..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;modules&#47;ecdh&#47;tests_impl.h</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,105 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2015 Andrew Poelstra                                 *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef _SECP256K1_MODULE_ECDH_TESTS_</span>
<span class="term-fg31">-#define _SECP256K1_MODULE_ECDH_TESTS_</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void test_ecdh_api(void) {</span>
<span class="term-fg31">-    &#47;* Setup context that just counts errors *&#47;</span>
<span class="term-fg31">-    secp256k1_context *tctx = secp256k1_context_create(SECP256K1_CONTEXT_SIGN);</span>
<span class="term-fg31">-    secp256k1_pubkey point;</span>
<span class="term-fg31">-    unsigned char res[32];</span>
<span class="term-fg31">-    unsigned char s_one[32] = { 0 };</span>
<span class="term-fg31">-    int32_t ecount = 0;</span>
<span class="term-fg31">-    s_one[31] = 1;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_context_set_error_callback(tctx, counting_illegal_callback_fn, &amp;ecount);</span>
<span class="term-fg31">-    secp256k1_context_set_illegal_callback(tctx, counting_illegal_callback_fn, &amp;ecount);</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_create(tctx, &amp;point, s_one) == 1);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Check all NULLs are detected *&#47;</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdh(tctx, res, &amp;point, s_one) == 1);</span>
<span class="term-fg31">-    CHECK(ecount == 0);</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdh(tctx, NULL, &amp;point, s_one) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 1);</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdh(tctx, res, NULL, s_one) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 2);</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdh(tctx, res, &amp;point, NULL) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 3);</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdh(tctx, res, &amp;point, s_one) == 1);</span>
<span class="term-fg31">-    CHECK(ecount == 3);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Cleanup *&#47;</span>
<span class="term-fg31">-    secp256k1_context_destroy(tctx);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void test_ecdh_generator_basepoint(void) {</span>
<span class="term-fg31">-    unsigned char s_one[32] = { 0 };</span>
<span class="term-fg31">-    secp256k1_pubkey point[2];</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    s_one[31] = 1;</span>
<span class="term-fg31">-    &#47;* Check against pubkey creation when the basepoint is the generator *&#47;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 100; ++i) {</span>
<span class="term-fg31">-        secp256k1_sha256_t sha;</span>
<span class="term-fg31">-        unsigned char s_b32[32];</span>
<span class="term-fg31">-        unsigned char output_ecdh[32];</span>
<span class="term-fg31">-        unsigned char output_ser[32];</span>
<span class="term-fg31">-        unsigned char point_ser[33];</span>
<span class="term-fg31">-        size_t point_ser_len = sizeof(point_ser);</span>
<span class="term-fg31">-        secp256k1_scalar s;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        random_scalar_order(&amp;s);</span>
<span class="term-fg31">-        secp256k1_scalar_get_b32(s_b32, &amp;s);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        &#47;* compute using ECDH function *&#47;</span>
<span class="term-fg31">-        CHECK(secp256k1_ec_pubkey_create(ctx, &amp;point[0], s_one) == 1);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdh(ctx, output_ecdh, &amp;point[0], s_b32) == 1);</span>
<span class="term-fg31">-        &#47;* compute &quot;explicitly&quot; *&#47;</span>
<span class="term-fg31">-        CHECK(secp256k1_ec_pubkey_create(ctx, &amp;point[1], s_b32) == 1);</span>
<span class="term-fg31">-        CHECK(secp256k1_ec_pubkey_serialize(ctx, point_ser, &amp;point_ser_len, &amp;point[1], SECP256K1_EC_COMPRESSED) == 1);</span>
<span class="term-fg31">-        CHECK(point_ser_len == sizeof(point_ser));</span>
<span class="term-fg31">-        secp256k1_sha256_initialize(&amp;sha);</span>
<span class="term-fg31">-        secp256k1_sha256_write(&amp;sha, point_ser, point_ser_len);</span>
<span class="term-fg31">-        secp256k1_sha256_finalize(&amp;sha, output_ser);</span>
<span class="term-fg31">-        &#47;* compare *&#47;</span>
<span class="term-fg31">-        CHECK(memcmp(output_ecdh, output_ser, sizeof(output_ser)) == 0);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void test_bad_scalar(void) {</span>
<span class="term-fg31">-    unsigned char s_zero[32] = { 0 };</span>
<span class="term-fg31">-    unsigned char s_overflow[32] = {</span>
<span class="term-fg31">-        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xfe,</span>
<span class="term-fg31">-        0xba, 0xae, 0xdc, 0xe6, 0xaf, 0x48, 0xa0, 0x3b,</span>
<span class="term-fg31">-        0xbf, 0xd2, 0x5e, 0x8c, 0xd0, 0x36, 0x41, 0x41</span>
<span class="term-fg31">-    };</span>
<span class="term-fg31">-    unsigned char s_rand[32] = { 0 };</span>
<span class="term-fg31">-    unsigned char output[32];</span>
<span class="term-fg31">-    secp256k1_scalar rand;</span>
<span class="term-fg31">-    secp256k1_pubkey point;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Create random point *&#47;</span>
<span class="term-fg31">-    random_scalar_order(&amp;rand);</span>
<span class="term-fg31">-    secp256k1_scalar_get_b32(s_rand, &amp;rand);</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_create(ctx, &amp;point, s_rand) == 1);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Try to multiply it by bad values *&#47;</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdh(ctx, output, &amp;point, s_zero) == 0);</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdh(ctx, output, &amp;point, s_overflow) == 0);</span>
<span class="term-fg31">-    &#47;* ...and a good one *&#47;</span>
<span class="term-fg31">-    s_overflow[31] -= 1;</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdh(ctx, output, &amp;point, s_overflow) == 1);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void run_ecdh_tests(void) {</span>
<span class="term-fg31">-    test_ecdh_api();</span>
<span class="term-fg31">-    test_ecdh_generator_basepoint();</span>
<span class="term-fg31">-    test_bad_scalar();</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-49d36902ff849b069d350671" role="button"
                       aria-expanded="false" aria-controls="id-49d36902ff849b069d350671">
                        <code>crypto/secp256k1/libsecp256k1/src/modules/recovery/Makefile.am.include</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/modules/recovery/Makefile.am.include" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-8</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-49d36902ff849b069d350671"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;modules&#47;recovery&#47;Makefile.am.include op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;modules&#47;recovery&#47;Makefile.am.include</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index bf23c26e71c5dd88df965141295bb33144007147..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;modules&#47;recovery&#47;Makefile.am.include</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,8 +0,0 @@</span>
<span class="term-fg31">-include_HEADERS += include&#47;secp256k1_recovery.h</span>
<span class="term-fg31">-noinst_HEADERS += src&#47;modules&#47;recovery&#47;main_impl.h</span>
<span class="term-fg31">-noinst_HEADERS += src&#47;modules&#47;recovery&#47;tests_impl.h</span>
<span class="term-fg31">-if USE_BENCHMARK</span>
<span class="term-fg31">-noinst_PROGRAMS += bench_recover</span>
<span class="term-fg31">-bench_recover_SOURCES = src&#47;bench_recover.c</span>
<span class="term-fg31">-bench_recover_LDADD = libsecp256k1.la $(SECP_LIBS) $(COMMON_LIB)</span>
<span class="term-fg31">-endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-d8be169029471a1e1f59ece3" role="button"
                       aria-expanded="false" aria-controls="id-d8be169029471a1e1f59ece3">
                        <code>crypto/secp256k1/libsecp256k1/src/modules/recovery/dummy.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/modules/recovery/dummy.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-8</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-d8be169029471a1e1f59ece3"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;modules&#47;recovery&#47;dummy.go op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;modules&#47;recovery&#47;dummy.go</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 8efbd7abe71bdaa73fae314de40c03916edbaaa8..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;modules&#47;recovery&#47;dummy.go</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,8 +0,0 @@</span>
<span class="term-fg31">-&#47;&#47;go:build dummy</span>
<span class="term-fg31">-&#47;&#47; +build dummy</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;&#47; Package c contains only a C file.</span>
<span class="term-fg31">-&#47;&#47;</span>
<span class="term-fg31">-&#47;&#47; This Go file is part of a workaround for `go mod vendor`.</span>
<span class="term-fg31">-&#47;&#47; Please see the file crypto&#47;secp256k1&#47;dummy.go for more information.</span>
<span class="term-fg31">-package recovery</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-dd38d88a7ffec1512d0d2ba7" role="button"
                       aria-expanded="false" aria-controls="id-dd38d88a7ffec1512d0d2ba7">
                        <code>crypto/secp256k1/libsecp256k1/src/modules/recovery/main_impl.h</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/modules/recovery/main_impl.h" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-193</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-dd38d88a7ffec1512d0d2ba7"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;modules&#47;recovery&#47;main_impl.h op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;modules&#47;recovery&#47;main_impl.h</span>
<span class="term-fg1">deleted file mode 100755</span>
<span class="term-fg1">index c6fbe239813a3e45559bd36098d3d2ca2dac145a..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;modules&#47;recovery&#47;main_impl.h</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,193 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2013-2015 Pieter Wuille                              *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef _SECP256K1_MODULE_RECOVERY_MAIN_</span>
<span class="term-fg31">-#define _SECP256K1_MODULE_RECOVERY_MAIN_</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &quot;include&#47;secp256k1_recovery.h&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_ecdsa_recoverable_signature_load(const secp256k1_context* ctx, secp256k1_scalar* r, secp256k1_scalar* s, int* recid, const secp256k1_ecdsa_recoverable_signature* sig) {</span>
<span class="term-fg31">-    (void)ctx;</span>
<span class="term-fg31">-    if (sizeof(secp256k1_scalar) == 32) {</span>
<span class="term-fg31">-        &#47;* When the secp256k1_scalar type is exactly 32 byte, use its</span>
<span class="term-fg31">-         * representation inside secp256k1_ecdsa_signature, as conversion is very fast.</span>
<span class="term-fg31">-         * Note that secp256k1_ecdsa_signature_save must use the same representation. *&#47;</span>
<span class="term-fg31">-        memcpy(r, &amp;sig-&gt;data[0], 32);</span>
<span class="term-fg31">-        memcpy(s, &amp;sig-&gt;data[32], 32);</span>
<span class="term-fg31">-    } else {</span>
<span class="term-fg31">-        secp256k1_scalar_set_b32(r, &amp;sig-&gt;data[0], NULL);</span>
<span class="term-fg31">-        secp256k1_scalar_set_b32(s, &amp;sig-&gt;data[32], NULL);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    *recid = sig-&gt;data[64];</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_ecdsa_recoverable_signature_save(secp256k1_ecdsa_recoverable_signature* sig, const secp256k1_scalar* r, const secp256k1_scalar* s, int recid) {</span>
<span class="term-fg31">-    if (sizeof(secp256k1_scalar) == 32) {</span>
<span class="term-fg31">-        memcpy(&amp;sig-&gt;data[0], r, 32);</span>
<span class="term-fg31">-        memcpy(&amp;sig-&gt;data[32], s, 32);</span>
<span class="term-fg31">-    } else {</span>
<span class="term-fg31">-        secp256k1_scalar_get_b32(&amp;sig-&gt;data[0], r);</span>
<span class="term-fg31">-        secp256k1_scalar_get_b32(&amp;sig-&gt;data[32], s);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    sig-&gt;data[64] = recid;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-int secp256k1_ecdsa_recoverable_signature_parse_compact(const secp256k1_context* ctx, secp256k1_ecdsa_recoverable_signature* sig, const unsigned char *input64, int recid) {</span>
<span class="term-fg31">-    secp256k1_scalar r, s;</span>
<span class="term-fg31">-    int ret = 1;</span>
<span class="term-fg31">-    int overflow = 0;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    (void)ctx;</span>
<span class="term-fg31">-    ARG_CHECK(sig != NULL);</span>
<span class="term-fg31">-    ARG_CHECK(input64 != NULL);</span>
<span class="term-fg31">-    ARG_CHECK(recid &gt;= 0 &amp;&amp; recid &lt;= 3);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_scalar_set_b32(&amp;r, &amp;input64[0], &amp;overflow);</span>
<span class="term-fg31">-    ret &amp;= !overflow;</span>
<span class="term-fg31">-    secp256k1_scalar_set_b32(&amp;s, &amp;input64[32], &amp;overflow);</span>
<span class="term-fg31">-    ret &amp;= !overflow;</span>
<span class="term-fg31">-    if (ret) {</span>
<span class="term-fg31">-        secp256k1_ecdsa_recoverable_signature_save(sig, &amp;r, &amp;s, recid);</span>
<span class="term-fg31">-    } else {</span>
<span class="term-fg31">-        memset(sig, 0, sizeof(*sig));</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    return ret;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-int secp256k1_ecdsa_recoverable_signature_serialize_compact(const secp256k1_context* ctx, unsigned char *output64, int *recid, const secp256k1_ecdsa_recoverable_signature* sig) {</span>
<span class="term-fg31">-    secp256k1_scalar r, s;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    (void)ctx;</span>
<span class="term-fg31">-    ARG_CHECK(output64 != NULL);</span>
<span class="term-fg31">-    ARG_CHECK(sig != NULL);</span>
<span class="term-fg31">-    ARG_CHECK(recid != NULL);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_ecdsa_recoverable_signature_load(ctx, &amp;r, &amp;s, recid, sig);</span>
<span class="term-fg31">-    secp256k1_scalar_get_b32(&amp;output64[0], &amp;r);</span>
<span class="term-fg31">-    secp256k1_scalar_get_b32(&amp;output64[32], &amp;s);</span>
<span class="term-fg31">-    return 1;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-int secp256k1_ecdsa_recoverable_signature_convert(const secp256k1_context* ctx, secp256k1_ecdsa_signature* sig, const secp256k1_ecdsa_recoverable_signature* sigin) {</span>
<span class="term-fg31">-    secp256k1_scalar r, s;</span>
<span class="term-fg31">-    int recid;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    (void)ctx;</span>
<span class="term-fg31">-    ARG_CHECK(sig != NULL);</span>
<span class="term-fg31">-    ARG_CHECK(sigin != NULL);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_ecdsa_recoverable_signature_load(ctx, &amp;r, &amp;s, &amp;recid, sigin);</span>
<span class="term-fg31">-    secp256k1_ecdsa_signature_save(sig, &amp;r, &amp;s);</span>
<span class="term-fg31">-    return 1;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_ecdsa_sig_recover(const secp256k1_ecmult_context *ctx, const secp256k1_scalar *sigr, const secp256k1_scalar* sigs, secp256k1_ge *pubkey, const secp256k1_scalar *message, int recid) {</span>
<span class="term-fg31">-    unsigned char brx[32];</span>
<span class="term-fg31">-    secp256k1_fe fx;</span>
<span class="term-fg31">-    secp256k1_ge x;</span>
<span class="term-fg31">-    secp256k1_gej xj;</span>
<span class="term-fg31">-    secp256k1_scalar rn, u1, u2;</span>
<span class="term-fg31">-    secp256k1_gej qj;</span>
<span class="term-fg31">-    int r;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    if (secp256k1_scalar_is_zero(sigr) || secp256k1_scalar_is_zero(sigs)) {</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_scalar_get_b32(brx, sigr);</span>
<span class="term-fg31">-    r = secp256k1_fe_set_b32(&amp;fx, brx);</span>
<span class="term-fg31">-    (void)r;</span>
<span class="term-fg31">-    VERIFY_CHECK(r); &#47;* brx comes from a scalar, so is less than the order; certainly less than p *&#47;</span>
<span class="term-fg31">-    if (recid &amp; 2) {</span>
<span class="term-fg31">-        if (secp256k1_fe_cmp_var(&amp;fx, &amp;secp256k1_ecdsa_const_p_minus_order) &gt;= 0) {</span>
<span class="term-fg31">-            return 0;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        secp256k1_fe_add(&amp;fx, &amp;secp256k1_ecdsa_const_order_as_fe);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    if (!secp256k1_ge_set_xo_var(&amp;x, &amp;fx, recid &amp; 1)) {</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_gej_set_ge(&amp;xj, &amp;x);</span>
<span class="term-fg31">-    secp256k1_scalar_inverse_var(&amp;rn, sigr);</span>
<span class="term-fg31">-    secp256k1_scalar_mul(&amp;u1, &amp;rn, message);</span>
<span class="term-fg31">-    secp256k1_scalar_negate(&amp;u1, &amp;u1);</span>
<span class="term-fg31">-    secp256k1_scalar_mul(&amp;u2, &amp;rn, sigs);</span>
<span class="term-fg31">-    secp256k1_ecmult(ctx, &amp;qj, &amp;xj, &amp;u2, &amp;u1);</span>
<span class="term-fg31">-    secp256k1_ge_set_gej_var(pubkey, &amp;qj);</span>
<span class="term-fg31">-    return !secp256k1_gej_is_infinity(&amp;qj);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-int secp256k1_ecdsa_sign_recoverable(const secp256k1_context* ctx, secp256k1_ecdsa_recoverable_signature *signature, const unsigned char *msg32, const unsigned char *seckey, secp256k1_nonce_function noncefp, const void* noncedata) {</span>
<span class="term-fg31">-    secp256k1_scalar r, s;</span>
<span class="term-fg31">-    secp256k1_scalar sec, non, msg;</span>
<span class="term-fg31">-    int recid;</span>
<span class="term-fg31">-    int ret = 0;</span>
<span class="term-fg31">-    int overflow = 0;</span>
<span class="term-fg31">-    VERIFY_CHECK(ctx != NULL);</span>
<span class="term-fg31">-    ARG_CHECK(secp256k1_ecmult_gen_context_is_built(&amp;ctx-&gt;ecmult_gen_ctx));</span>
<span class="term-fg31">-    ARG_CHECK(msg32 != NULL);</span>
<span class="term-fg31">-    ARG_CHECK(signature != NULL);</span>
<span class="term-fg31">-    ARG_CHECK(seckey != NULL);</span>
<span class="term-fg31">-    if (noncefp == NULL) {</span>
<span class="term-fg31">-        noncefp = secp256k1_nonce_function_default;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_scalar_set_b32(&amp;sec, seckey, &amp;overflow);</span>
<span class="term-fg31">-    &#47;* Fail if the secret key is invalid. *&#47;</span>
<span class="term-fg31">-    if (!overflow &amp;&amp; !secp256k1_scalar_is_zero(&amp;sec)) {</span>
<span class="term-fg31">-        unsigned char nonce32[32];</span>
<span class="term-fg31">-        unsigned int count = 0;</span>
<span class="term-fg31">-        secp256k1_scalar_set_b32(&amp;msg, msg32, NULL);</span>
<span class="term-fg31">-        while (1) {</span>
<span class="term-fg31">-            ret = noncefp(nonce32, msg32, seckey, NULL, (void*)noncedata, count);</span>
<span class="term-fg31">-            if (!ret) {</span>
<span class="term-fg31">-                break;</span>
<span class="term-fg31">-            }</span>
<span class="term-fg31">-            secp256k1_scalar_set_b32(&amp;non, nonce32, &amp;overflow);</span>
<span class="term-fg31">-            if (!secp256k1_scalar_is_zero(&amp;non) &amp;&amp; !overflow) {</span>
<span class="term-fg31">-                if (secp256k1_ecdsa_sig_sign(&amp;ctx-&gt;ecmult_gen_ctx, &amp;r, &amp;s, &amp;sec, &amp;msg, &amp;non, &amp;recid)) {</span>
<span class="term-fg31">-                    break;</span>
<span class="term-fg31">-                }</span>
<span class="term-fg31">-            }</span>
<span class="term-fg31">-            count++;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        memset(nonce32, 0, 32);</span>
<span class="term-fg31">-        secp256k1_scalar_clear(&amp;msg);</span>
<span class="term-fg31">-        secp256k1_scalar_clear(&amp;non);</span>
<span class="term-fg31">-        secp256k1_scalar_clear(&amp;sec);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    if (ret) {</span>
<span class="term-fg31">-        secp256k1_ecdsa_recoverable_signature_save(signature, &amp;r, &amp;s, recid);</span>
<span class="term-fg31">-    } else {</span>
<span class="term-fg31">-        memset(signature, 0, sizeof(*signature));</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    return ret;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-int secp256k1_ecdsa_recover(const secp256k1_context* ctx, secp256k1_pubkey *pubkey, const secp256k1_ecdsa_recoverable_signature *signature, const unsigned char *msg32) {</span>
<span class="term-fg31">-    secp256k1_ge q;</span>
<span class="term-fg31">-    secp256k1_scalar r, s;</span>
<span class="term-fg31">-    secp256k1_scalar m;</span>
<span class="term-fg31">-    int recid;</span>
<span class="term-fg31">-    VERIFY_CHECK(ctx != NULL);</span>
<span class="term-fg31">-    ARG_CHECK(secp256k1_ecmult_context_is_built(&amp;ctx-&gt;ecmult_ctx));</span>
<span class="term-fg31">-    ARG_CHECK(msg32 != NULL);</span>
<span class="term-fg31">-    ARG_CHECK(signature != NULL);</span>
<span class="term-fg31">-    ARG_CHECK(pubkey != NULL);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_ecdsa_recoverable_signature_load(ctx, &amp;r, &amp;s, &amp;recid, signature);</span>
<span class="term-fg31">-    VERIFY_CHECK(recid &gt;= 0 &amp;&amp; recid &lt; 4);  &#47;* should have been caught in parse_compact *&#47;</span>
<span class="term-fg31">-    secp256k1_scalar_set_b32(&amp;m, msg32, NULL);</span>
<span class="term-fg31">-    if (secp256k1_ecdsa_sig_recover(&amp;ctx-&gt;ecmult_ctx, &amp;r, &amp;s, &amp;q, &amp;m, recid)) {</span>
<span class="term-fg31">-        secp256k1_pubkey_save(pubkey, &amp;q);</span>
<span class="term-fg31">-        return 1;</span>
<span class="term-fg31">-    } else {</span>
<span class="term-fg31">-        memset(pubkey, 0, sizeof(*pubkey));</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-ba91c2452373908a366fade6" role="button"
                       aria-expanded="false" aria-controls="id-ba91c2452373908a366fade6">
                        <code>crypto/secp256k1/libsecp256k1/src/modules/recovery/tests_impl.h</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/modules/recovery/tests_impl.h" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-393</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-ba91c2452373908a366fade6"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;modules&#47;recovery&#47;tests_impl.h op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;modules&#47;recovery&#47;tests_impl.h</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 765c7dd81e958c9ca37ee50117b286e90b6c7f7f..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;modules&#47;recovery&#47;tests_impl.h</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,393 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2013-2015 Pieter Wuille                              *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef _SECP256K1_MODULE_RECOVERY_TESTS_</span>
<span class="term-fg31">-#define _SECP256K1_MODULE_RECOVERY_TESTS_</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int recovery_test_nonce_function(unsigned char *nonce32, const unsigned char *msg32, const unsigned char *key32, const unsigned char *algo16, void *data, unsigned int counter) {</span>
<span class="term-fg31">-    (void) msg32;</span>
<span class="term-fg31">-    (void) key32;</span>
<span class="term-fg31">-    (void) algo16;</span>
<span class="term-fg31">-    (void) data;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* On the first run, return 0 to force a second run *&#47;</span>
<span class="term-fg31">-    if (counter == 0) {</span>
<span class="term-fg31">-        memset(nonce32, 0, 32);</span>
<span class="term-fg31">-        return 1;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    &#47;* On the second run, return an overflow to force a third run *&#47;</span>
<span class="term-fg31">-    if (counter == 1) {</span>
<span class="term-fg31">-        memset(nonce32, 0xff, 32);</span>
<span class="term-fg31">-        return 1;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    &#47;* On the next run, return a valid nonce, but flip a coin as to whether or not to fail signing. *&#47;</span>
<span class="term-fg31">-    memset(nonce32, 1, 32);</span>
<span class="term-fg31">-    return secp256k1_rand_bits(1);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void test_ecdsa_recovery_api(void) {</span>
<span class="term-fg31">-    &#47;* Setup contexts that just count errors *&#47;</span>
<span class="term-fg31">-    secp256k1_context *none = secp256k1_context_create(SECP256K1_CONTEXT_NONE);</span>
<span class="term-fg31">-    secp256k1_context *sign = secp256k1_context_create(SECP256K1_CONTEXT_SIGN);</span>
<span class="term-fg31">-    secp256k1_context *vrfy = secp256k1_context_create(SECP256K1_CONTEXT_VERIFY);</span>
<span class="term-fg31">-    secp256k1_context *both = secp256k1_context_create(SECP256K1_CONTEXT_SIGN | SECP256K1_CONTEXT_VERIFY);</span>
<span class="term-fg31">-    secp256k1_pubkey pubkey;</span>
<span class="term-fg31">-    secp256k1_pubkey recpubkey;</span>
<span class="term-fg31">-    secp256k1_ecdsa_signature normal_sig;</span>
<span class="term-fg31">-    secp256k1_ecdsa_recoverable_signature recsig;</span>
<span class="term-fg31">-    unsigned char privkey[32] = { 1 };</span>
<span class="term-fg31">-    unsigned char message[32] = { 2 };</span>
<span class="term-fg31">-    int32_t ecount = 0;</span>
<span class="term-fg31">-    int recid = 0;</span>
<span class="term-fg31">-    unsigned char sig[74];</span>
<span class="term-fg31">-    unsigned char zero_privkey[32] = { 0 };</span>
<span class="term-fg31">-    unsigned char over_privkey[32] = { 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-                                       0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-                                       0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-                                       0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff };</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_context_set_error_callback(none, counting_illegal_callback_fn, &amp;ecount);</span>
<span class="term-fg31">-    secp256k1_context_set_error_callback(sign, counting_illegal_callback_fn, &amp;ecount);</span>
<span class="term-fg31">-    secp256k1_context_set_error_callback(vrfy, counting_illegal_callback_fn, &amp;ecount);</span>
<span class="term-fg31">-    secp256k1_context_set_error_callback(both, counting_illegal_callback_fn, &amp;ecount);</span>
<span class="term-fg31">-    secp256k1_context_set_illegal_callback(none, counting_illegal_callback_fn, &amp;ecount);</span>
<span class="term-fg31">-    secp256k1_context_set_illegal_callback(sign, counting_illegal_callback_fn, &amp;ecount);</span>
<span class="term-fg31">-    secp256k1_context_set_illegal_callback(vrfy, counting_illegal_callback_fn, &amp;ecount);</span>
<span class="term-fg31">-    secp256k1_context_set_illegal_callback(both, counting_illegal_callback_fn, &amp;ecount);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Construct and verify corresponding public key. *&#47;</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_seckey_verify(ctx, privkey) == 1);</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_create(ctx, &amp;pubkey, privkey) == 1);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Check bad contexts and NULLs for signing *&#47;</span>
<span class="term-fg31">-    ecount = 0;</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_sign_recoverable(none, &amp;recsig, message, privkey, NULL, NULL) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 1);</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_sign_recoverable(sign, &amp;recsig, message, privkey, NULL, NULL) == 1);</span>
<span class="term-fg31">-    CHECK(ecount == 1);</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_sign_recoverable(vrfy, &amp;recsig, message, privkey, NULL, NULL) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 2);</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_sign_recoverable(both, &amp;recsig, message, privkey, NULL, NULL) == 1);</span>
<span class="term-fg31">-    CHECK(ecount == 2);</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_sign_recoverable(both, NULL, message, privkey, NULL, NULL) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 3);</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_sign_recoverable(both, &amp;recsig, NULL, privkey, NULL, NULL) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 4);</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_sign_recoverable(both, &amp;recsig, message, NULL, NULL, NULL) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 5);</span>
<span class="term-fg31">-    &#47;* This will fail or succeed randomly, and in either case will not ARG_CHECK failure *&#47;</span>
<span class="term-fg31">-    secp256k1_ecdsa_sign_recoverable(both, &amp;recsig, message, privkey, recovery_test_nonce_function, NULL);</span>
<span class="term-fg31">-    CHECK(ecount == 5);</span>
<span class="term-fg31">-    &#47;* These will all fail, but not in ARG_CHECK way *&#47;</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_sign_recoverable(both, &amp;recsig, message, zero_privkey, NULL, NULL) == 0);</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_sign_recoverable(both, &amp;recsig, message, over_privkey, NULL, NULL) == 0);</span>
<span class="term-fg31">-    &#47;* This one will succeed. *&#47;</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_sign_recoverable(both, &amp;recsig, message, privkey, NULL, NULL) == 1);</span>
<span class="term-fg31">-    CHECK(ecount == 5);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Check signing with a goofy nonce function *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Check bad contexts and NULLs for recovery *&#47;</span>
<span class="term-fg31">-    ecount = 0;</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_recover(none, &amp;recpubkey, &amp;recsig, message) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 1);</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_recover(sign, &amp;recpubkey, &amp;recsig, message) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 2);</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_recover(vrfy, &amp;recpubkey, &amp;recsig, message) == 1);</span>
<span class="term-fg31">-    CHECK(ecount == 2);</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_recover(both, &amp;recpubkey, &amp;recsig, message) == 1);</span>
<span class="term-fg31">-    CHECK(ecount == 2);</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_recover(both, NULL, &amp;recsig, message) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 3);</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_recover(both, &amp;recpubkey, NULL, message) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 4);</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_recover(both, &amp;recpubkey, &amp;recsig, NULL) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 5);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Check NULLs for conversion *&#47;</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_sign(both, &amp;normal_sig, message, privkey, NULL, NULL) == 1);</span>
<span class="term-fg31">-    ecount = 0;</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_recoverable_signature_convert(both, NULL, &amp;recsig) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 1);</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_recoverable_signature_convert(both, &amp;normal_sig, NULL) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 2);</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_recoverable_signature_convert(both, &amp;normal_sig, &amp;recsig) == 1);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Check NULLs for de&#47;serialization *&#47;</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_sign_recoverable(both, &amp;recsig, message, privkey, NULL, NULL) == 1);</span>
<span class="term-fg31">-    ecount = 0;</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_recoverable_signature_serialize_compact(both, NULL, &amp;recid, &amp;recsig) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 1);</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_recoverable_signature_serialize_compact(both, sig, NULL, &amp;recsig) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 2);</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_recoverable_signature_serialize_compact(both, sig, &amp;recid, NULL) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 3);</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_recoverable_signature_serialize_compact(both, sig, &amp;recid, &amp;recsig) == 1);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_recoverable_signature_parse_compact(both, NULL, sig, recid) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 4);</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_recoverable_signature_parse_compact(both, &amp;recsig, NULL, recid) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 5);</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_recoverable_signature_parse_compact(both, &amp;recsig, sig, -1) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 6);</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_recoverable_signature_parse_compact(both, &amp;recsig, sig, 5) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 7);</span>
<span class="term-fg31">-    &#47;* overflow in signature will fail but not affect ecount *&#47;</span>
<span class="term-fg31">-    memcpy(sig, over_privkey, 32);</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_recoverable_signature_parse_compact(both, &amp;recsig, sig, recid) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 7);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* cleanup *&#47;</span>
<span class="term-fg31">-    secp256k1_context_destroy(none);</span>
<span class="term-fg31">-    secp256k1_context_destroy(sign);</span>
<span class="term-fg31">-    secp256k1_context_destroy(vrfy);</span>
<span class="term-fg31">-    secp256k1_context_destroy(both);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void test_ecdsa_recovery_end_to_end(void) {</span>
<span class="term-fg31">-    unsigned char extra[32] = {0x00};</span>
<span class="term-fg31">-    unsigned char privkey[32];</span>
<span class="term-fg31">-    unsigned char message[32];</span>
<span class="term-fg31">-    secp256k1_ecdsa_signature signature[5];</span>
<span class="term-fg31">-    secp256k1_ecdsa_recoverable_signature rsignature[5];</span>
<span class="term-fg31">-    unsigned char sig[74];</span>
<span class="term-fg31">-    secp256k1_pubkey pubkey;</span>
<span class="term-fg31">-    secp256k1_pubkey recpubkey;</span>
<span class="term-fg31">-    int recid = 0;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Generate a random key and message. *&#47;</span>
<span class="term-fg31">-    {</span>
<span class="term-fg31">-        secp256k1_scalar msg, key;</span>
<span class="term-fg31">-        random_scalar_order_test(&amp;msg);</span>
<span class="term-fg31">-        random_scalar_order_test(&amp;key);</span>
<span class="term-fg31">-        secp256k1_scalar_get_b32(privkey, &amp;key);</span>
<span class="term-fg31">-        secp256k1_scalar_get_b32(message, &amp;msg);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Construct and verify corresponding public key. *&#47;</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_seckey_verify(ctx, privkey) == 1);</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_create(ctx, &amp;pubkey, privkey) == 1);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Serialize&#47;parse compact and verify&#47;recover. *&#47;</span>
<span class="term-fg31">-    extra[0] = 0;</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_sign_recoverable(ctx, &amp;rsignature[0], message, privkey, NULL, NULL) == 1);</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_sign(ctx, &amp;signature[0], message, privkey, NULL, NULL) == 1);</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_sign_recoverable(ctx, &amp;rsignature[4], message, privkey, NULL, NULL) == 1);</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_sign_recoverable(ctx, &amp;rsignature[1], message, privkey, NULL, extra) == 1);</span>
<span class="term-fg31">-    extra[31] = 1;</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_sign_recoverable(ctx, &amp;rsignature[2], message, privkey, NULL, extra) == 1);</span>
<span class="term-fg31">-    extra[31] = 0;</span>
<span class="term-fg31">-    extra[0] = 1;</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_sign_recoverable(ctx, &amp;rsignature[3], message, privkey, NULL, extra) == 1);</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_recoverable_signature_serialize_compact(ctx, sig, &amp;recid, &amp;rsignature[4]) == 1);</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_recoverable_signature_convert(ctx, &amp;signature[4], &amp;rsignature[4]) == 1);</span>
<span class="term-fg31">-    CHECK(memcmp(&amp;signature[4], &amp;signature[0], 64) == 0);</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_verify(ctx, &amp;signature[4], message, &amp;pubkey) == 1);</span>
<span class="term-fg31">-    memset(&amp;rsignature[4], 0, sizeof(rsignature[4]));</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_recoverable_signature_parse_compact(ctx, &amp;rsignature[4], sig, recid) == 1);</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_recoverable_signature_convert(ctx, &amp;signature[4], &amp;rsignature[4]) == 1);</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_verify(ctx, &amp;signature[4], message, &amp;pubkey) == 1);</span>
<span class="term-fg31">-    &#47;* Parse compact (with recovery id) and recover. *&#47;</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_recoverable_signature_parse_compact(ctx, &amp;rsignature[4], sig, recid) == 1);</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_recover(ctx, &amp;recpubkey, &amp;rsignature[4], message) == 1);</span>
<span class="term-fg31">-    CHECK(memcmp(&amp;pubkey, &amp;recpubkey, sizeof(pubkey)) == 0);</span>
<span class="term-fg31">-    &#47;* Serialize&#47;destroy&#47;parse signature and verify again. *&#47;</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_recoverable_signature_serialize_compact(ctx, sig, &amp;recid, &amp;rsignature[4]) == 1);</span>
<span class="term-fg31">-    sig[secp256k1_rand_bits(6)] += 1 + secp256k1_rand_int(255);</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_recoverable_signature_parse_compact(ctx, &amp;rsignature[4], sig, recid) == 1);</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_recoverable_signature_convert(ctx, &amp;signature[4], &amp;rsignature[4]) == 1);</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_verify(ctx, &amp;signature[4], message, &amp;pubkey) == 0);</span>
<span class="term-fg31">-    &#47;* Recover again *&#47;</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_recover(ctx, &amp;recpubkey, &amp;rsignature[4], message) == 0 ||</span>
<span class="term-fg31">-          memcmp(&amp;pubkey, &amp;recpubkey, sizeof(pubkey)) != 0);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;* Tests several edge cases. *&#47;</span>
<span class="term-fg31">-void test_ecdsa_recovery_edge_cases(void) {</span>
<span class="term-fg31">-    const unsigned char msg32[32] = {</span>
<span class="term-fg31">-        &#39;T&#39;, &#39;h&#39;, &#39;i&#39;, &#39;s&#39;, &#39; &#39;, &#39;i&#39;, &#39;s&#39;, &#39; &#39;,</span>
<span class="term-fg31">-        &#39;a&#39;, &#39; &#39;, &#39;v&#39;, &#39;e&#39;, &#39;r&#39;, &#39;y&#39;, &#39; &#39;, &#39;s&#39;,</span>
<span class="term-fg31">-        &#39;e&#39;, &#39;c&#39;, &#39;r&#39;, &#39;e&#39;, &#39;t&#39;, &#39; &#39;, &#39;m&#39;, &#39;e&#39;,</span>
<span class="term-fg31">-        &#39;s&#39;, &#39;s&#39;, &#39;a&#39;, &#39;g&#39;, &#39;e&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;</span>
<span class="term-fg31">-    };</span>
<span class="term-fg31">-    const unsigned char sig64[64] = {</span>
<span class="term-fg31">-        &#47;* Generated by signing the above message with nonce &#39;This is the nonce we will use...&#39;</span>
<span class="term-fg31">-         * and secret key 0 (which is not valid), resulting in recid 0. *&#47;</span>
<span class="term-fg31">-        0x67, 0xCB, 0x28, 0x5F, 0x9C, 0xD1, 0x94, 0xE8,</span>
<span class="term-fg31">-        0x40, 0xD6, 0x29, 0x39, 0x7A, 0xF5, 0x56, 0x96,</span>
<span class="term-fg31">-        0x62, 0xFD, 0xE4, 0x46, 0x49, 0x99, 0x59, 0x63,</span>
<span class="term-fg31">-        0x17, 0x9A, 0x7D, 0xD1, 0x7B, 0xD2, 0x35, 0x32,</span>
<span class="term-fg31">-        0x4B, 0x1B, 0x7D, 0xF3, 0x4C, 0xE1, 0xF6, 0x8E,</span>
<span class="term-fg31">-        0x69, 0x4F, 0xF6, 0xF1, 0x1A, 0xC7, 0x51, 0xDD,</span>
<span class="term-fg31">-        0x7D, 0xD7, 0x3E, 0x38, 0x7E, 0xE4, 0xFC, 0x86,</span>
<span class="term-fg31">-        0x6E, 0x1B, 0xE8, 0xEC, 0xC7, 0xDD, 0x95, 0x57</span>
<span class="term-fg31">-    };</span>
<span class="term-fg31">-    secp256k1_pubkey pubkey;</span>
<span class="term-fg31">-    &#47;* signature (r,s) = (4,4), which can be recovered with all 4 recids. *&#47;</span>
<span class="term-fg31">-    const unsigned char sigb64[64] = {</span>
<span class="term-fg31">-        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x04,</span>
<span class="term-fg31">-        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x04,</span>
<span class="term-fg31">-    };</span>
<span class="term-fg31">-    secp256k1_pubkey pubkeyb;</span>
<span class="term-fg31">-    secp256k1_ecdsa_recoverable_signature rsig;</span>
<span class="term-fg31">-    secp256k1_ecdsa_signature sig;</span>
<span class="term-fg31">-    int recid;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_recoverable_signature_parse_compact(ctx, &amp;rsig, sig64, 0));</span>
<span class="term-fg31">-    CHECK(!secp256k1_ecdsa_recover(ctx, &amp;pubkey, &amp;rsig, msg32));</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_recoverable_signature_parse_compact(ctx, &amp;rsig, sig64, 1));</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_recover(ctx, &amp;pubkey, &amp;rsig, msg32));</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_recoverable_signature_parse_compact(ctx, &amp;rsig, sig64, 2));</span>
<span class="term-fg31">-    CHECK(!secp256k1_ecdsa_recover(ctx, &amp;pubkey, &amp;rsig, msg32));</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_recoverable_signature_parse_compact(ctx, &amp;rsig, sig64, 3));</span>
<span class="term-fg31">-    CHECK(!secp256k1_ecdsa_recover(ctx, &amp;pubkey, &amp;rsig, msg32));</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    for (recid = 0; recid &lt; 4; recid++) {</span>
<span class="term-fg31">-        int i;</span>
<span class="term-fg31">-        int recid2;</span>
<span class="term-fg31">-        &#47;* (4,4) encoded in DER. *&#47;</span>
<span class="term-fg31">-        unsigned char sigbder[8] = {0x30, 0x06, 0x02, 0x01, 0x04, 0x02, 0x01, 0x04};</span>
<span class="term-fg31">-        unsigned char sigcder_zr[7] = {0x30, 0x05, 0x02, 0x00, 0x02, 0x01, 0x01};</span>
<span class="term-fg31">-        unsigned char sigcder_zs[7] = {0x30, 0x05, 0x02, 0x01, 0x01, 0x02, 0x00};</span>
<span class="term-fg31">-        unsigned char sigbderalt1[39] = {</span>
<span class="term-fg31">-            0x30, 0x25, 0x02, 0x20, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x04, 0x02, 0x01, 0x04,</span>
<span class="term-fg31">-        };</span>
<span class="term-fg31">-        unsigned char sigbderalt2[39] = {</span>
<span class="term-fg31">-            0x30, 0x25, 0x02, 0x01, 0x04, 0x02, 0x20, 0x00,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x04,</span>
<span class="term-fg31">-        };</span>
<span class="term-fg31">-        unsigned char sigbderalt3[40] = {</span>
<span class="term-fg31">-            0x30, 0x26, 0x02, 0x21, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x04, 0x02, 0x01, 0x04,</span>
<span class="term-fg31">-        };</span>
<span class="term-fg31">-        unsigned char sigbderalt4[40] = {</span>
<span class="term-fg31">-            0x30, 0x26, 0x02, 0x01, 0x04, 0x02, 0x21, 0x00,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x04,</span>
<span class="term-fg31">-        };</span>
<span class="term-fg31">-        &#47;* (order + r,4) encoded in DER. *&#47;</span>
<span class="term-fg31">-        unsigned char sigbderlong[40] = {</span>
<span class="term-fg31">-            0x30, 0x26, 0x02, 0x21, 0x00, 0xFF, 0xFF, 0xFF,</span>
<span class="term-fg31">-            0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,</span>
<span class="term-fg31">-            0xFF, 0xFF, 0xFF, 0xFF, 0xFE, 0xBA, 0xAE, 0xDC,</span>
<span class="term-fg31">-            0xE6, 0xAF, 0x48, 0xA0, 0x3B, 0xBF, 0xD2, 0x5E,</span>
<span class="term-fg31">-            0x8C, 0xD0, 0x36, 0x41, 0x45, 0x02, 0x01, 0x04</span>
<span class="term-fg31">-        };</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_recoverable_signature_parse_compact(ctx, &amp;rsig, sigb64, recid) == 1);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_recover(ctx, &amp;pubkeyb, &amp;rsig, msg32) == 1);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_signature_parse_der(ctx, &amp;sig, sigbder, sizeof(sigbder)) == 1);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_verify(ctx, &amp;sig, msg32, &amp;pubkeyb) == 1);</span>
<span class="term-fg31">-        for (recid2 = 0; recid2 &lt; 4; recid2++) {</span>
<span class="term-fg31">-            secp256k1_pubkey pubkey2b;</span>
<span class="term-fg31">-            CHECK(secp256k1_ecdsa_recoverable_signature_parse_compact(ctx, &amp;rsig, sigb64, recid2) == 1);</span>
<span class="term-fg31">-            CHECK(secp256k1_ecdsa_recover(ctx, &amp;pubkey2b, &amp;rsig, msg32) == 1);</span>
<span class="term-fg31">-            &#47;* Verifying with (order + r,4) should always fail. *&#47;</span>
<span class="term-fg31">-            CHECK(secp256k1_ecdsa_signature_parse_der(ctx, &amp;sig, sigbderlong, sizeof(sigbderlong)) == 1);</span>
<span class="term-fg31">-            CHECK(secp256k1_ecdsa_verify(ctx, &amp;sig, msg32, &amp;pubkeyb) == 0);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        &#47;* DER parsing tests. *&#47;</span>
<span class="term-fg31">-        &#47;* Zero length r&#47;s. *&#47;</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_signature_parse_der(ctx, &amp;sig, sigcder_zr, sizeof(sigcder_zr)) == 0);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_signature_parse_der(ctx, &amp;sig, sigcder_zs, sizeof(sigcder_zs)) == 0);</span>
<span class="term-fg31">-        &#47;* Leading zeros. *&#47;</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_signature_parse_der(ctx, &amp;sig, sigbderalt1, sizeof(sigbderalt1)) == 0);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_signature_parse_der(ctx, &amp;sig, sigbderalt2, sizeof(sigbderalt2)) == 0);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_signature_parse_der(ctx, &amp;sig, sigbderalt3, sizeof(sigbderalt3)) == 0);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_signature_parse_der(ctx, &amp;sig, sigbderalt4, sizeof(sigbderalt4)) == 0);</span>
<span class="term-fg31">-        sigbderalt3[4] = 1;</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_signature_parse_der(ctx, &amp;sig, sigbderalt3, sizeof(sigbderalt3)) == 1);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_verify(ctx, &amp;sig, msg32, &amp;pubkeyb) == 0);</span>
<span class="term-fg31">-        sigbderalt4[7] = 1;</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_signature_parse_der(ctx, &amp;sig, sigbderalt4, sizeof(sigbderalt4)) == 1);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_verify(ctx, &amp;sig, msg32, &amp;pubkeyb) == 0);</span>
<span class="term-fg31">-        &#47;* Damage signature. *&#47;</span>
<span class="term-fg31">-        sigbder[7]++;</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_signature_parse_der(ctx, &amp;sig, sigbder, sizeof(sigbder)) == 1);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_verify(ctx, &amp;sig, msg32, &amp;pubkeyb) == 0);</span>
<span class="term-fg31">-        sigbder[7]--;</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_signature_parse_der(ctx, &amp;sig, sigbder, 6) == 0);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_signature_parse_der(ctx, &amp;sig, sigbder, sizeof(sigbder) - 1) == 0);</span>
<span class="term-fg31">-        for(i = 0; i &lt; 8; i++) {</span>
<span class="term-fg31">-            int c;</span>
<span class="term-fg31">-            unsigned char orig = sigbder[i];</span>
<span class="term-fg31">-            &#47;*Try every single-byte change.*&#47;</span>
<span class="term-fg31">-            for (c = 0; c &lt; 256; c++) {</span>
<span class="term-fg31">-                if (c == orig ) {</span>
<span class="term-fg31">-                    continue;</span>
<span class="term-fg31">-                }</span>
<span class="term-fg31">-                sigbder[i] = c;</span>
<span class="term-fg31">-                CHECK(secp256k1_ecdsa_signature_parse_der(ctx, &amp;sig, sigbder, sizeof(sigbder)) == 0 || secp256k1_ecdsa_verify(ctx, &amp;sig, msg32, &amp;pubkeyb) == 0);</span>
<span class="term-fg31">-            }</span>
<span class="term-fg31">-            sigbder[i] = orig;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Test r&#47;s equal to zero *&#47;</span>
<span class="term-fg31">-    {</span>
<span class="term-fg31">-        &#47;* (1,1) encoded in DER. *&#47;</span>
<span class="term-fg31">-        unsigned char sigcder[8] = {0x30, 0x06, 0x02, 0x01, 0x01, 0x02, 0x01, 0x01};</span>
<span class="term-fg31">-        unsigned char sigc64[64] = {</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01,</span>
<span class="term-fg31">-        };</span>
<span class="term-fg31">-        secp256k1_pubkey pubkeyc;</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_recoverable_signature_parse_compact(ctx, &amp;rsig, sigc64, 0) == 1);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_recover(ctx, &amp;pubkeyc, &amp;rsig, msg32) == 1);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_signature_parse_der(ctx, &amp;sig, sigcder, sizeof(sigcder)) == 1);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_verify(ctx, &amp;sig, msg32, &amp;pubkeyc) == 1);</span>
<span class="term-fg31">-        sigcder[4] = 0;</span>
<span class="term-fg31">-        sigc64[31] = 0;</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_recoverable_signature_parse_compact(ctx, &amp;rsig, sigc64, 0) == 1);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_recover(ctx, &amp;pubkeyb, &amp;rsig, msg32) == 0);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_signature_parse_der(ctx, &amp;sig, sigcder, sizeof(sigcder)) == 1);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_verify(ctx, &amp;sig, msg32, &amp;pubkeyc) == 0);</span>
<span class="term-fg31">-        sigcder[4] = 1;</span>
<span class="term-fg31">-        sigcder[7] = 0;</span>
<span class="term-fg31">-        sigc64[31] = 1;</span>
<span class="term-fg31">-        sigc64[63] = 0;</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_recoverable_signature_parse_compact(ctx, &amp;rsig, sigc64, 0) == 1);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_recover(ctx, &amp;pubkeyb, &amp;rsig, msg32) == 0);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_signature_parse_der(ctx, &amp;sig, sigcder, sizeof(sigcder)) == 1);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_verify(ctx, &amp;sig, msg32, &amp;pubkeyc) == 0);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void run_recovery_tests(void) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    for (i = 0; i &lt; count; i++) {</span>
<span class="term-fg31">-        test_ecdsa_recovery_api();</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    for (i = 0; i &lt; 64*count; i++) {</span>
<span class="term-fg31">-        test_ecdsa_recovery_end_to_end();</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    test_ecdsa_recovery_edge_cases();</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-d6f045dbc509777cd5633384" role="button"
                       aria-expanded="false" aria-controls="id-d6f045dbc509777cd5633384">
                        <code>crypto/secp256k1/libsecp256k1/src/num.h</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/num.h" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-74</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-d6f045dbc509777cd5633384"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;num.h op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;num.h</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index eff842200fea1dd239a6dd458d82333ba0be3e76..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;num.h</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,74 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2013, 2014 Pieter Wuille                             *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef _SECP256K1_NUM_</span>
<span class="term-fg31">-#define _SECP256K1_NUM_</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef USE_NUM_NONE</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#if defined HAVE_CONFIG_H</span>
<span class="term-fg31">-#include &quot;libsecp256k1-config.h&quot;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#if defined(USE_NUM_GMP)</span>
<span class="term-fg31">-#include &quot;num_gmp.h&quot;</span>
<span class="term-fg31">-#else</span>
<span class="term-fg31">-#error &quot;Please select num implementation&quot;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Copy a number. *&#47;</span>
<span class="term-fg31">-static void secp256k1_num_copy(secp256k1_num *r, const secp256k1_num *a);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Convert a number&#39;s absolute value to a binary big-endian string.</span>
<span class="term-fg31">- *  There must be enough place. *&#47;</span>
<span class="term-fg31">-static void secp256k1_num_get_bin(unsigned char *r, unsigned int rlen, const secp256k1_num *a);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Set a number to the value of a binary big-endian string. *&#47;</span>
<span class="term-fg31">-static void secp256k1_num_set_bin(secp256k1_num *r, const unsigned char *a, unsigned int alen);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Compute a modular inverse. The input must be less than the modulus. *&#47;</span>
<span class="term-fg31">-static void secp256k1_num_mod_inverse(secp256k1_num *r, const secp256k1_num *a, const secp256k1_num *m);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Compute the jacobi symbol (a|b). b must be positive and odd. *&#47;</span>
<span class="term-fg31">-static int secp256k1_num_jacobi(const secp256k1_num *a, const secp256k1_num *b);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Compare the absolute value of two numbers. *&#47;</span>
<span class="term-fg31">-static int secp256k1_num_cmp(const secp256k1_num *a, const secp256k1_num *b);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Test whether two number are equal (including sign). *&#47;</span>
<span class="term-fg31">-static int secp256k1_num_eq(const secp256k1_num *a, const secp256k1_num *b);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Add two (signed) numbers. *&#47;</span>
<span class="term-fg31">-static void secp256k1_num_add(secp256k1_num *r, const secp256k1_num *a, const secp256k1_num *b);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Subtract two (signed) numbers. *&#47;</span>
<span class="term-fg31">-static void secp256k1_num_sub(secp256k1_num *r, const secp256k1_num *a, const secp256k1_num *b);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Multiply two (signed) numbers. *&#47;</span>
<span class="term-fg31">-static void secp256k1_num_mul(secp256k1_num *r, const secp256k1_num *a, const secp256k1_num *b);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Replace a number by its remainder modulo m. M&#39;s sign is ignored. The result is a number between 0 and m-1,</span>
<span class="term-fg31">-    even if r was negative. *&#47;</span>
<span class="term-fg31">-static void secp256k1_num_mod(secp256k1_num *r, const secp256k1_num *m);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Right-shift the passed number by bits. *&#47;</span>
<span class="term-fg31">-static void secp256k1_num_shift(secp256k1_num *r, int bits);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Check whether a number is zero. *&#47;</span>
<span class="term-fg31">-static int secp256k1_num_is_zero(const secp256k1_num *a);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Check whether a number is one. *&#47;</span>
<span class="term-fg31">-static int secp256k1_num_is_one(const secp256k1_num *a);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Check whether a number is strictly negative. *&#47;</span>
<span class="term-fg31">-static int secp256k1_num_is_neg(const secp256k1_num *a);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Change a number&#39;s sign. *&#47;</span>
<span class="term-fg31">-static void secp256k1_num_negate(secp256k1_num *r);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-19da4492d417b15e8ec49e1f" role="button"
                       aria-expanded="false" aria-controls="id-19da4492d417b15e8ec49e1f">
                        <code>crypto/secp256k1/libsecp256k1/src/num_gmp.h</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/num_gmp.h" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-20</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-19da4492d417b15e8ec49e1f"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;num_gmp.h op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;num_gmp.h</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 7dd813088afc94ab54e2281d17edbc709e4b5c3d..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;num_gmp.h</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,20 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2013, 2014 Pieter Wuille                             *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef _SECP256K1_NUM_REPR_</span>
<span class="term-fg31">-#define _SECP256K1_NUM_REPR_</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &lt;gmp.h&gt;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#define NUM_LIMBS ((256+GMP_NUMB_BITS-1)&#47;GMP_NUMB_BITS)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-typedef struct {</span>
<span class="term-fg31">-    mp_limb_t data[2*NUM_LIMBS];</span>
<span class="term-fg31">-    int neg;</span>
<span class="term-fg31">-    int limbs;</span>
<span class="term-fg31">-} secp256k1_num;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-e81a0833cdfdbec6c8d9c910" role="button"
                       aria-expanded="false" aria-controls="id-e81a0833cdfdbec6c8d9c910">
                        <code>crypto/secp256k1/libsecp256k1/src/num_gmp_impl.h</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/num_gmp_impl.h" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-288</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-e81a0833cdfdbec6c8d9c910"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;num_gmp_impl.h op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;num_gmp_impl.h</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 3a46495eeac7d979a87871ca20ce30c2010a54ce..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;num_gmp_impl.h</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,288 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2013, 2014 Pieter Wuille                             *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef _SECP256K1_NUM_REPR_IMPL_H_</span>
<span class="term-fg31">-#define _SECP256K1_NUM_REPR_IMPL_H_</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &lt;string.h&gt;</span>
<span class="term-fg31">-#include &lt;stdlib.h&gt;</span>
<span class="term-fg31">-#include &lt;gmp.h&gt;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &quot;util.h&quot;</span>
<span class="term-fg31">-#include &quot;num.h&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-static void secp256k1_num_sanity(const secp256k1_num *a) {</span>
<span class="term-fg31">-    VERIFY_CHECK(a-&gt;limbs == 1 || (a-&gt;limbs &gt; 1 &amp;&amp; a-&gt;data[a-&gt;limbs-1] != 0));</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-#else</span>
<span class="term-fg31">-#define secp256k1_num_sanity(a) do { } while(0)</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_num_copy(secp256k1_num *r, const secp256k1_num *a) {</span>
<span class="term-fg31">-    *r = *a;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_num_get_bin(unsigned char *r, unsigned int rlen, const secp256k1_num *a) {</span>
<span class="term-fg31">-    unsigned char tmp[65];</span>
<span class="term-fg31">-    int len = 0;</span>
<span class="term-fg31">-    int shift = 0;</span>
<span class="term-fg31">-    if (a-&gt;limbs&gt;1 || a-&gt;data[0] != 0) {</span>
<span class="term-fg31">-        len = mpn_get_str(tmp, 256, (mp_limb_t*)a-&gt;data, a-&gt;limbs);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    while (shift &lt; len &amp;&amp; tmp[shift] == 0) shift++;</span>
<span class="term-fg31">-    VERIFY_CHECK(len-shift &lt;= (int)rlen);</span>
<span class="term-fg31">-    memset(r, 0, rlen - len + shift);</span>
<span class="term-fg31">-    if (len &gt; shift) {</span>
<span class="term-fg31">-        memcpy(r + rlen - len + shift, tmp + shift, len - shift);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    memset(tmp, 0, sizeof(tmp));</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_num_set_bin(secp256k1_num *r, const unsigned char *a, unsigned int alen) {</span>
<span class="term-fg31">-    int len;</span>
<span class="term-fg31">-    VERIFY_CHECK(alen &gt; 0);</span>
<span class="term-fg31">-    VERIFY_CHECK(alen &lt;= 64);</span>
<span class="term-fg31">-    len = mpn_set_str(r-&gt;data, a, alen, 256);</span>
<span class="term-fg31">-    if (len == 0) {</span>
<span class="term-fg31">-        r-&gt;data[0] = 0;</span>
<span class="term-fg31">-        len = 1;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    VERIFY_CHECK(len &lt;= NUM_LIMBS*2);</span>
<span class="term-fg31">-    r-&gt;limbs = len;</span>
<span class="term-fg31">-    r-&gt;neg = 0;</span>
<span class="term-fg31">-    while (r-&gt;limbs &gt; 1 &amp;&amp; r-&gt;data[r-&gt;limbs-1]==0) {</span>
<span class="term-fg31">-        r-&gt;limbs--;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_num_add_abs(secp256k1_num *r, const secp256k1_num *a, const secp256k1_num *b) {</span>
<span class="term-fg31">-    mp_limb_t c = mpn_add(r-&gt;data, a-&gt;data, a-&gt;limbs, b-&gt;data, b-&gt;limbs);</span>
<span class="term-fg31">-    r-&gt;limbs = a-&gt;limbs;</span>
<span class="term-fg31">-    if (c != 0) {</span>
<span class="term-fg31">-        VERIFY_CHECK(r-&gt;limbs &lt; 2*NUM_LIMBS);</span>
<span class="term-fg31">-        r-&gt;data[r-&gt;limbs++] = c;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_num_sub_abs(secp256k1_num *r, const secp256k1_num *a, const secp256k1_num *b) {</span>
<span class="term-fg31">-    mp_limb_t c = mpn_sub(r-&gt;data, a-&gt;data, a-&gt;limbs, b-&gt;data, b-&gt;limbs);</span>
<span class="term-fg31">-    (void)c;</span>
<span class="term-fg31">-    VERIFY_CHECK(c == 0);</span>
<span class="term-fg31">-    r-&gt;limbs = a-&gt;limbs;</span>
<span class="term-fg31">-    while (r-&gt;limbs &gt; 1 &amp;&amp; r-&gt;data[r-&gt;limbs-1]==0) {</span>
<span class="term-fg31">-        r-&gt;limbs--;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_num_mod(secp256k1_num *r, const secp256k1_num *m) {</span>
<span class="term-fg31">-    secp256k1_num_sanity(r);</span>
<span class="term-fg31">-    secp256k1_num_sanity(m);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    if (r-&gt;limbs &gt;= m-&gt;limbs) {</span>
<span class="term-fg31">-        mp_limb_t t[2*NUM_LIMBS];</span>
<span class="term-fg31">-        mpn_tdiv_qr(t, r-&gt;data, 0, r-&gt;data, r-&gt;limbs, m-&gt;data, m-&gt;limbs);</span>
<span class="term-fg31">-        memset(t, 0, sizeof(t));</span>
<span class="term-fg31">-        r-&gt;limbs = m-&gt;limbs;</span>
<span class="term-fg31">-        while (r-&gt;limbs &gt; 1 &amp;&amp; r-&gt;data[r-&gt;limbs-1]==0) {</span>
<span class="term-fg31">-            r-&gt;limbs--;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    if (r-&gt;neg &amp;&amp; (r-&gt;limbs &gt; 1 || r-&gt;data[0] != 0)) {</span>
<span class="term-fg31">-        secp256k1_num_sub_abs(r, m, r);</span>
<span class="term-fg31">-        r-&gt;neg = 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_num_mod_inverse(secp256k1_num *r, const secp256k1_num *a, const secp256k1_num *m) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    mp_limb_t g[NUM_LIMBS+1];</span>
<span class="term-fg31">-    mp_limb_t u[NUM_LIMBS+1];</span>
<span class="term-fg31">-    mp_limb_t v[NUM_LIMBS+1];</span>
<span class="term-fg31">-    mp_size_t sn;</span>
<span class="term-fg31">-    mp_size_t gn;</span>
<span class="term-fg31">-    secp256k1_num_sanity(a);</span>
<span class="term-fg31">-    secp256k1_num_sanity(m);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;** mpn_gcdext computes: (G,S) = gcdext(U,V), where</span>
<span class="term-fg31">-     *  * G = gcd(U,V)</span>
<span class="term-fg31">-     *  * G = U*S + V*T</span>
<span class="term-fg31">-     *  * U has equal or more limbs than V, and V has no padding</span>
<span class="term-fg31">-     *  If we set U to be (a padded version of) a, and V = m:</span>
<span class="term-fg31">-     *    G = a*S + m*T</span>
<span class="term-fg31">-     *    G = a*S mod m</span>
<span class="term-fg31">-     *  Assuming G=1:</span>
<span class="term-fg31">-     *    S = 1&#47;a mod m</span>
<span class="term-fg31">-     *&#47;</span>
<span class="term-fg31">-    VERIFY_CHECK(m-&gt;limbs &lt;= NUM_LIMBS);</span>
<span class="term-fg31">-    VERIFY_CHECK(m-&gt;data[m-&gt;limbs-1] != 0);</span>
<span class="term-fg31">-    for (i = 0; i &lt; m-&gt;limbs; i++) {</span>
<span class="term-fg31">-        u[i] = (i &lt; a-&gt;limbs) ? a-&gt;data[i] : 0;</span>
<span class="term-fg31">-        v[i] = m-&gt;data[i];</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    sn = NUM_LIMBS+1;</span>
<span class="term-fg31">-    gn = mpn_gcdext(g, r-&gt;data, &amp;sn, u, m-&gt;limbs, v, m-&gt;limbs);</span>
<span class="term-fg31">-    (void)gn;</span>
<span class="term-fg31">-    VERIFY_CHECK(gn == 1);</span>
<span class="term-fg31">-    VERIFY_CHECK(g[0] == 1);</span>
<span class="term-fg31">-    r-&gt;neg = a-&gt;neg ^ m-&gt;neg;</span>
<span class="term-fg31">-    if (sn &lt; 0) {</span>
<span class="term-fg31">-        mpn_sub(r-&gt;data, m-&gt;data, m-&gt;limbs, r-&gt;data, -sn);</span>
<span class="term-fg31">-        r-&gt;limbs = m-&gt;limbs;</span>
<span class="term-fg31">-        while (r-&gt;limbs &gt; 1 &amp;&amp; r-&gt;data[r-&gt;limbs-1]==0) {</span>
<span class="term-fg31">-            r-&gt;limbs--;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    } else {</span>
<span class="term-fg31">-        r-&gt;limbs = sn;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    memset(g, 0, sizeof(g));</span>
<span class="term-fg31">-    memset(u, 0, sizeof(u));</span>
<span class="term-fg31">-    memset(v, 0, sizeof(v));</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_num_jacobi(const secp256k1_num *a, const secp256k1_num *b) {</span>
<span class="term-fg31">-    int ret;</span>
<span class="term-fg31">-    mpz_t ga, gb;</span>
<span class="term-fg31">-    secp256k1_num_sanity(a);</span>
<span class="term-fg31">-    secp256k1_num_sanity(b);</span>
<span class="term-fg31">-    VERIFY_CHECK(!b-&gt;neg &amp;&amp; (b-&gt;limbs &gt; 0) &amp;&amp; (b-&gt;data[0] &amp; 1));</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    mpz_inits(ga, gb, NULL);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    mpz_import(gb, b-&gt;limbs, -1, sizeof(mp_limb_t), 0, 0, b-&gt;data);</span>
<span class="term-fg31">-    mpz_import(ga, a-&gt;limbs, -1, sizeof(mp_limb_t), 0, 0, a-&gt;data);</span>
<span class="term-fg31">-    if (a-&gt;neg) {</span>
<span class="term-fg31">-        mpz_neg(ga, ga);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    ret = mpz_jacobi(ga, gb);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    mpz_clears(ga, gb, NULL);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    return ret;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_num_is_one(const secp256k1_num *a) {</span>
<span class="term-fg31">-    return (a-&gt;limbs == 1 &amp;&amp; a-&gt;data[0] == 1);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_num_is_zero(const secp256k1_num *a) {</span>
<span class="term-fg31">-    return (a-&gt;limbs == 1 &amp;&amp; a-&gt;data[0] == 0);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_num_is_neg(const secp256k1_num *a) {</span>
<span class="term-fg31">-    return (a-&gt;limbs &gt; 1 || a-&gt;data[0] != 0) &amp;&amp; a-&gt;neg;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_num_cmp(const secp256k1_num *a, const secp256k1_num *b) {</span>
<span class="term-fg31">-    if (a-&gt;limbs &gt; b-&gt;limbs) {</span>
<span class="term-fg31">-        return 1;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    if (a-&gt;limbs &lt; b-&gt;limbs) {</span>
<span class="term-fg31">-        return -1;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    return mpn_cmp(a-&gt;data, b-&gt;data, a-&gt;limbs);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_num_eq(const secp256k1_num *a, const secp256k1_num *b) {</span>
<span class="term-fg31">-    if (a-&gt;limbs &gt; b-&gt;limbs) {</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    if (a-&gt;limbs &lt; b-&gt;limbs) {</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    if ((a-&gt;neg &amp;&amp; !secp256k1_num_is_zero(a)) != (b-&gt;neg &amp;&amp; !secp256k1_num_is_zero(b))) {</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    return mpn_cmp(a-&gt;data, b-&gt;data, a-&gt;limbs) == 0;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_num_subadd(secp256k1_num *r, const secp256k1_num *a, const secp256k1_num *b, int bneg) {</span>
<span class="term-fg31">-    if (!(b-&gt;neg ^ bneg ^ a-&gt;neg)) { &#47;* a and b have the same sign *&#47;</span>
<span class="term-fg31">-        r-&gt;neg = a-&gt;neg;</span>
<span class="term-fg31">-        if (a-&gt;limbs &gt;= b-&gt;limbs) {</span>
<span class="term-fg31">-            secp256k1_num_add_abs(r, a, b);</span>
<span class="term-fg31">-        } else {</span>
<span class="term-fg31">-            secp256k1_num_add_abs(r, b, a);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    } else {</span>
<span class="term-fg31">-        if (secp256k1_num_cmp(a, b) &gt; 0) {</span>
<span class="term-fg31">-            r-&gt;neg = a-&gt;neg;</span>
<span class="term-fg31">-            secp256k1_num_sub_abs(r, a, b);</span>
<span class="term-fg31">-        } else {</span>
<span class="term-fg31">-            r-&gt;neg = b-&gt;neg ^ bneg;</span>
<span class="term-fg31">-            secp256k1_num_sub_abs(r, b, a);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_num_add(secp256k1_num *r, const secp256k1_num *a, const secp256k1_num *b) {</span>
<span class="term-fg31">-    secp256k1_num_sanity(a);</span>
<span class="term-fg31">-    secp256k1_num_sanity(b);</span>
<span class="term-fg31">-    secp256k1_num_subadd(r, a, b, 0);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_num_sub(secp256k1_num *r, const secp256k1_num *a, const secp256k1_num *b) {</span>
<span class="term-fg31">-    secp256k1_num_sanity(a);</span>
<span class="term-fg31">-    secp256k1_num_sanity(b);</span>
<span class="term-fg31">-    secp256k1_num_subadd(r, a, b, 1);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_num_mul(secp256k1_num *r, const secp256k1_num *a, const secp256k1_num *b) {</span>
<span class="term-fg31">-    mp_limb_t tmp[2*NUM_LIMBS+1];</span>
<span class="term-fg31">-    secp256k1_num_sanity(a);</span>
<span class="term-fg31">-    secp256k1_num_sanity(b);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    VERIFY_CHECK(a-&gt;limbs + b-&gt;limbs &lt;= 2*NUM_LIMBS+1);</span>
<span class="term-fg31">-    if ((a-&gt;limbs==1 &amp;&amp; a-&gt;data[0]==0) || (b-&gt;limbs==1 &amp;&amp; b-&gt;data[0]==0)) {</span>
<span class="term-fg31">-        r-&gt;limbs = 1;</span>
<span class="term-fg31">-        r-&gt;neg = 0;</span>
<span class="term-fg31">-        r-&gt;data[0] = 0;</span>
<span class="term-fg31">-        return;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    if (a-&gt;limbs &gt;= b-&gt;limbs) {</span>
<span class="term-fg31">-        mpn_mul(tmp, a-&gt;data, a-&gt;limbs, b-&gt;data, b-&gt;limbs);</span>
<span class="term-fg31">-    } else {</span>
<span class="term-fg31">-        mpn_mul(tmp, b-&gt;data, b-&gt;limbs, a-&gt;data, a-&gt;limbs);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    r-&gt;limbs = a-&gt;limbs + b-&gt;limbs;</span>
<span class="term-fg31">-    if (r-&gt;limbs &gt; 1 &amp;&amp; tmp[r-&gt;limbs - 1]==0) {</span>
<span class="term-fg31">-        r-&gt;limbs--;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    VERIFY_CHECK(r-&gt;limbs &lt;= 2*NUM_LIMBS);</span>
<span class="term-fg31">-    mpn_copyi(r-&gt;data, tmp, r-&gt;limbs);</span>
<span class="term-fg31">-    r-&gt;neg = a-&gt;neg ^ b-&gt;neg;</span>
<span class="term-fg31">-    memset(tmp, 0, sizeof(tmp));</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_num_shift(secp256k1_num *r, int bits) {</span>
<span class="term-fg31">-    if (bits % GMP_NUMB_BITS) {</span>
<span class="term-fg31">-        &#47;* Shift within limbs. *&#47;</span>
<span class="term-fg31">-        mpn_rshift(r-&gt;data, r-&gt;data, r-&gt;limbs, bits % GMP_NUMB_BITS);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    if (bits &gt;= GMP_NUMB_BITS) {</span>
<span class="term-fg31">-        int i;</span>
<span class="term-fg31">-        &#47;* Shift full limbs. *&#47;</span>
<span class="term-fg31">-        for (i = 0; i &lt; r-&gt;limbs; i++) {</span>
<span class="term-fg31">-            int index = i + (bits &#47; GMP_NUMB_BITS);</span>
<span class="term-fg31">-            if (index &lt; r-&gt;limbs &amp;&amp; index &lt; 2*NUM_LIMBS) {</span>
<span class="term-fg31">-                r-&gt;data[i] = r-&gt;data[index];</span>
<span class="term-fg31">-            } else {</span>
<span class="term-fg31">-                r-&gt;data[i] = 0;</span>
<span class="term-fg31">-            }</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    while (r-&gt;limbs&gt;1 &amp;&amp; r-&gt;data[r-&gt;limbs-1]==0) {</span>
<span class="term-fg31">-        r-&gt;limbs--;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_num_negate(secp256k1_num *r) {</span>
<span class="term-fg31">-    r-&gt;neg ^= 1;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-1c5c0ccca3d9b02106f63983" role="button"
                       aria-expanded="false" aria-controls="id-1c5c0ccca3d9b02106f63983">
                        <code>crypto/secp256k1/libsecp256k1/src/num_impl.h</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/num_impl.h" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-24</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-1c5c0ccca3d9b02106f63983"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;num_impl.h op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;num_impl.h</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 0b0e3a072a15ac5ddd1575d1968578c0ffce9400..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;num_impl.h</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,24 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2013, 2014 Pieter Wuille                             *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef _SECP256K1_NUM_IMPL_H_</span>
<span class="term-fg31">-#define _SECP256K1_NUM_IMPL_H_</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#if defined HAVE_CONFIG_H</span>
<span class="term-fg31">-#include &quot;libsecp256k1-config.h&quot;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &quot;num.h&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#if defined(USE_NUM_GMP)</span>
<span class="term-fg31">-#include &quot;num_gmp_impl.h&quot;</span>
<span class="term-fg31">-#elif defined(USE_NUM_NONE)</span>
<span class="term-fg31">-&#47;* Nothing. *&#47;</span>
<span class="term-fg31">-#else</span>
<span class="term-fg31">-#error &quot;Please select num implementation&quot;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-71a76b37ea36439efba4ef99" role="button"
                       aria-expanded="false" aria-controls="id-71a76b37ea36439efba4ef99">
                        <code>crypto/secp256k1/libsecp256k1/src/scalar.h</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/scalar.h" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-106</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-71a76b37ea36439efba4ef99"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;scalar.h op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;scalar.h</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 27e9d8375e8b0dc9977d8b037fb1b4344d027d4c..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;scalar.h</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,106 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2014 Pieter Wuille                                   *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef _SECP256K1_SCALAR_</span>
<span class="term-fg31">-#define _SECP256K1_SCALAR_</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &quot;num.h&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#if defined HAVE_CONFIG_H</span>
<span class="term-fg31">-#include &quot;libsecp256k1-config.h&quot;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#if defined(EXHAUSTIVE_TEST_ORDER)</span>
<span class="term-fg31">-#include &quot;scalar_low.h&quot;</span>
<span class="term-fg31">-#elif defined(USE_SCALAR_4X64)</span>
<span class="term-fg31">-#include &quot;scalar_4x64.h&quot;</span>
<span class="term-fg31">-#elif defined(USE_SCALAR_8X32)</span>
<span class="term-fg31">-#include &quot;scalar_8x32.h&quot;</span>
<span class="term-fg31">-#else</span>
<span class="term-fg31">-#error &quot;Please select scalar implementation&quot;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Clear a scalar to prevent the leak of sensitive data. *&#47;</span>
<span class="term-fg31">-static void secp256k1_scalar_clear(secp256k1_scalar *r);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Access bits from a scalar. All requested bits must belong to the same 32-bit limb. *&#47;</span>
<span class="term-fg31">-static unsigned int secp256k1_scalar_get_bits(const secp256k1_scalar *a, unsigned int offset, unsigned int count);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Access bits from a scalar. Not constant time. *&#47;</span>
<span class="term-fg31">-static unsigned int secp256k1_scalar_get_bits_var(const secp256k1_scalar *a, unsigned int offset, unsigned int count);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Set a scalar from a big endian byte array. *&#47;</span>
<span class="term-fg31">-static void secp256k1_scalar_set_b32(secp256k1_scalar *r, const unsigned char *bin, int *overflow);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Set a scalar to an unsigned integer. *&#47;</span>
<span class="term-fg31">-static void secp256k1_scalar_set_int(secp256k1_scalar *r, unsigned int v);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Convert a scalar to a byte array. *&#47;</span>
<span class="term-fg31">-static void secp256k1_scalar_get_b32(unsigned char *bin, const secp256k1_scalar* a);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Add two scalars together (modulo the group order). Returns whether it overflowed. *&#47;</span>
<span class="term-fg31">-static int secp256k1_scalar_add(secp256k1_scalar *r, const secp256k1_scalar *a, const secp256k1_scalar *b);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Conditionally add a power of two to a scalar. The result is not allowed to overflow. *&#47;</span>
<span class="term-fg31">-static void secp256k1_scalar_cadd_bit(secp256k1_scalar *r, unsigned int bit, int flag);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Multiply two scalars (modulo the group order). *&#47;</span>
<span class="term-fg31">-static void secp256k1_scalar_mul(secp256k1_scalar *r, const secp256k1_scalar *a, const secp256k1_scalar *b);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Shift a scalar right by some amount strictly between 0 and 16, returning</span>
<span class="term-fg31">- *  the low bits that were shifted off *&#47;</span>
<span class="term-fg31">-static int secp256k1_scalar_shr_int(secp256k1_scalar *r, int n);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Compute the square of a scalar (modulo the group order). *&#47;</span>
<span class="term-fg31">-static void secp256k1_scalar_sqr(secp256k1_scalar *r, const secp256k1_scalar *a);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Compute the inverse of a scalar (modulo the group order). *&#47;</span>
<span class="term-fg31">-static void secp256k1_scalar_inverse(secp256k1_scalar *r, const secp256k1_scalar *a);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Compute the inverse of a scalar (modulo the group order), without constant-time guarantee. *&#47;</span>
<span class="term-fg31">-static void secp256k1_scalar_inverse_var(secp256k1_scalar *r, const secp256k1_scalar *a);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Compute the complement of a scalar (modulo the group order). *&#47;</span>
<span class="term-fg31">-static void secp256k1_scalar_negate(secp256k1_scalar *r, const secp256k1_scalar *a);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Check whether a scalar equals zero. *&#47;</span>
<span class="term-fg31">-static int secp256k1_scalar_is_zero(const secp256k1_scalar *a);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Check whether a scalar equals one. *&#47;</span>
<span class="term-fg31">-static int secp256k1_scalar_is_one(const secp256k1_scalar *a);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Check whether a scalar, considered as an nonnegative integer, is even. *&#47;</span>
<span class="term-fg31">-static int secp256k1_scalar_is_even(const secp256k1_scalar *a);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Check whether a scalar is higher than the group order divided by 2. *&#47;</span>
<span class="term-fg31">-static int secp256k1_scalar_is_high(const secp256k1_scalar *a);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Conditionally negate a number, in constant time.</span>
<span class="term-fg31">- * Returns -1 if the number was negated, 1 otherwise *&#47;</span>
<span class="term-fg31">-static int secp256k1_scalar_cond_negate(secp256k1_scalar *a, int flag);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef USE_NUM_NONE</span>
<span class="term-fg31">-&#47;** Convert a scalar to a number. *&#47;</span>
<span class="term-fg31">-static void secp256k1_scalar_get_num(secp256k1_num *r, const secp256k1_scalar *a);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Get the order of the group as a number. *&#47;</span>
<span class="term-fg31">-static void secp256k1_scalar_order_get_num(secp256k1_num *r);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Compare two scalars. *&#47;</span>
<span class="term-fg31">-static int secp256k1_scalar_eq(const secp256k1_scalar *a, const secp256k1_scalar *b);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef USE_ENDOMORPHISM</span>
<span class="term-fg31">-&#47;** Find r1 and r2 such that r1+r2*2^128 = a. *&#47;</span>
<span class="term-fg31">-static void secp256k1_scalar_split_128(secp256k1_scalar *r1, secp256k1_scalar *r2, const secp256k1_scalar *a);</span>
<span class="term-fg31">-&#47;** Find r1 and r2 such that r1+r2*lambda = a, and r1 and r2 are maximum 128 bits long (see secp256k1_gej_mul_lambda). *&#47;</span>
<span class="term-fg31">-static void secp256k1_scalar_split_lambda(secp256k1_scalar *r1, secp256k1_scalar *r2, const secp256k1_scalar *a);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Multiply a and b (without taking the modulus!), divide by 2**shift, and round to the nearest integer. Shift must be at least 256. *&#47;</span>
<span class="term-fg31">-static void secp256k1_scalar_mul_shift_var(secp256k1_scalar *r, const secp256k1_scalar *a, const secp256k1_scalar *b, unsigned int shift);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-525faea0356830d26b617d0c" role="button"
                       aria-expanded="false" aria-controls="id-525faea0356830d26b617d0c">
                        <code>crypto/secp256k1/libsecp256k1/src/scalar_4x64.h</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/scalar_4x64.h" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-19</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-525faea0356830d26b617d0c"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;scalar_4x64.h op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;scalar_4x64.h</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index cff406038fbee85395fe88332bdd4fdefab8b8e2..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;scalar_4x64.h</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,19 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2014 Pieter Wuille                                   *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef _SECP256K1_SCALAR_REPR_</span>
<span class="term-fg31">-#define _SECP256K1_SCALAR_REPR_</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &lt;stdint.h&gt;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** A scalar modulo the group order of the secp256k1 curve. *&#47;</span>
<span class="term-fg31">-typedef struct {</span>
<span class="term-fg31">-    uint64_t d[4];</span>
<span class="term-fg31">-} secp256k1_scalar;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#define SECP256K1_SCALAR_CONST(d7, d6, d5, d4, d3, d2, d1, d0) {{((uint64_t)(d1)) &lt;&lt; 32 | (d0), ((uint64_t)(d3)) &lt;&lt; 32 | (d2), ((uint64_t)(d5)) &lt;&lt; 32 | (d4), ((uint64_t)(d7)) &lt;&lt; 32 | (d6)}}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-db44409832f2f3770d156c7d" role="button"
                       aria-expanded="false" aria-controls="id-db44409832f2f3770d156c7d">
                        <code>crypto/secp256k1/libsecp256k1/src/scalar_4x64_impl.h</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/scalar_4x64_impl.h" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-949</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-db44409832f2f3770d156c7d"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;scalar_4x64_impl.h op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;scalar_4x64_impl.h</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 56e7bd82afd630b107c080b5c96cf50cdbb722f9..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;scalar_4x64_impl.h</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,949 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2013, 2014 Pieter Wuille                             *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef _SECP256K1_SCALAR_REPR_IMPL_H_</span>
<span class="term-fg31">-#define _SECP256K1_SCALAR_REPR_IMPL_H_</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;* Limbs of the secp256k1 order. *&#47;</span>
<span class="term-fg31">-#define SECP256K1_N_0 ((uint64_t)0xBFD25E8CD0364141ULL)</span>
<span class="term-fg31">-#define SECP256K1_N_1 ((uint64_t)0xBAAEDCE6AF48A03BULL)</span>
<span class="term-fg31">-#define SECP256K1_N_2 ((uint64_t)0xFFFFFFFFFFFFFFFEULL)</span>
<span class="term-fg31">-#define SECP256K1_N_3 ((uint64_t)0xFFFFFFFFFFFFFFFFULL)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;* Limbs of 2^256 minus the secp256k1 order. *&#47;</span>
<span class="term-fg31">-#define SECP256K1_N_C_0 (~SECP256K1_N_0 + 1)</span>
<span class="term-fg31">-#define SECP256K1_N_C_1 (~SECP256K1_N_1)</span>
<span class="term-fg31">-#define SECP256K1_N_C_2 (1)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;* Limbs of half the secp256k1 order. *&#47;</span>
<span class="term-fg31">-#define SECP256K1_N_H_0 ((uint64_t)0xDFE92F46681B20A0ULL)</span>
<span class="term-fg31">-#define SECP256K1_N_H_1 ((uint64_t)0x5D576E7357A4501DULL)</span>
<span class="term-fg31">-#define SECP256K1_N_H_2 ((uint64_t)0xFFFFFFFFFFFFFFFFULL)</span>
<span class="term-fg31">-#define SECP256K1_N_H_3 ((uint64_t)0x7FFFFFFFFFFFFFFFULL)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static void secp256k1_scalar_clear(secp256k1_scalar *r) {</span>
<span class="term-fg31">-    r-&gt;d[0] = 0;</span>
<span class="term-fg31">-    r-&gt;d[1] = 0;</span>
<span class="term-fg31">-    r-&gt;d[2] = 0;</span>
<span class="term-fg31">-    r-&gt;d[3] = 0;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static void secp256k1_scalar_set_int(secp256k1_scalar *r, unsigned int v) {</span>
<span class="term-fg31">-    r-&gt;d[0] = v;</span>
<span class="term-fg31">-    r-&gt;d[1] = 0;</span>
<span class="term-fg31">-    r-&gt;d[2] = 0;</span>
<span class="term-fg31">-    r-&gt;d[3] = 0;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static unsigned int secp256k1_scalar_get_bits(const secp256k1_scalar *a, unsigned int offset, unsigned int count) {</span>
<span class="term-fg31">-    VERIFY_CHECK((offset + count - 1) &gt;&gt; 6 == offset &gt;&gt; 6);</span>
<span class="term-fg31">-    return (a-&gt;d[offset &gt;&gt; 6] &gt;&gt; (offset &amp; 0x3F)) &amp; ((((uint64_t)1) &lt;&lt; count) - 1);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static unsigned int secp256k1_scalar_get_bits_var(const secp256k1_scalar *a, unsigned int offset, unsigned int count) {</span>
<span class="term-fg31">-    VERIFY_CHECK(count &lt; 32);</span>
<span class="term-fg31">-    VERIFY_CHECK(offset + count &lt;= 256);</span>
<span class="term-fg31">-    if ((offset + count - 1) &gt;&gt; 6 == offset &gt;&gt; 6) {</span>
<span class="term-fg31">-        return secp256k1_scalar_get_bits(a, offset, count);</span>
<span class="term-fg31">-    } else {</span>
<span class="term-fg31">-        VERIFY_CHECK((offset &gt;&gt; 6) + 1 &lt; 4);</span>
<span class="term-fg31">-        return ((a-&gt;d[offset &gt;&gt; 6] &gt;&gt; (offset &amp; 0x3F)) | (a-&gt;d[(offset &gt;&gt; 6) + 1] &lt;&lt; (64 - (offset &amp; 0x3F)))) &amp; ((((uint64_t)1) &lt;&lt; count) - 1);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static int secp256k1_scalar_check_overflow(const secp256k1_scalar *a) {</span>
<span class="term-fg31">-    int yes = 0;</span>
<span class="term-fg31">-    int no = 0;</span>
<span class="term-fg31">-    no |= (a-&gt;d[3] &lt; SECP256K1_N_3); &#47;* No need for a &gt; check. *&#47;</span>
<span class="term-fg31">-    no |= (a-&gt;d[2] &lt; SECP256K1_N_2);</span>
<span class="term-fg31">-    yes |= (a-&gt;d[2] &gt; SECP256K1_N_2) &amp; ~no;</span>
<span class="term-fg31">-    no |= (a-&gt;d[1] &lt; SECP256K1_N_1);</span>
<span class="term-fg31">-    yes |= (a-&gt;d[1] &gt; SECP256K1_N_1) &amp; ~no;</span>
<span class="term-fg31">-    yes |= (a-&gt;d[0] &gt;= SECP256K1_N_0) &amp; ~no;</span>
<span class="term-fg31">-    return yes;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static int secp256k1_scalar_reduce(secp256k1_scalar *r, unsigned int overflow) {</span>
<span class="term-fg31">-    uint128_t t;</span>
<span class="term-fg31">-    VERIFY_CHECK(overflow &lt;= 1);</span>
<span class="term-fg31">-    t = (uint128_t)r-&gt;d[0] + overflow * SECP256K1_N_C_0;</span>
<span class="term-fg31">-    r-&gt;d[0] = t &amp; 0xFFFFFFFFFFFFFFFFULL; t &gt;&gt;= 64;</span>
<span class="term-fg31">-    t += (uint128_t)r-&gt;d[1] + overflow * SECP256K1_N_C_1;</span>
<span class="term-fg31">-    r-&gt;d[1] = t &amp; 0xFFFFFFFFFFFFFFFFULL; t &gt;&gt;= 64;</span>
<span class="term-fg31">-    t += (uint128_t)r-&gt;d[2] + overflow * SECP256K1_N_C_2;</span>
<span class="term-fg31">-    r-&gt;d[2] = t &amp; 0xFFFFFFFFFFFFFFFFULL; t &gt;&gt;= 64;</span>
<span class="term-fg31">-    t += (uint64_t)r-&gt;d[3];</span>
<span class="term-fg31">-    r-&gt;d[3] = t &amp; 0xFFFFFFFFFFFFFFFFULL;</span>
<span class="term-fg31">-    return overflow;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_scalar_add(secp256k1_scalar *r, const secp256k1_scalar *a, const secp256k1_scalar *b) {</span>
<span class="term-fg31">-    int overflow;</span>
<span class="term-fg31">-    uint128_t t = (uint128_t)a-&gt;d[0] + b-&gt;d[0];</span>
<span class="term-fg31">-    r-&gt;d[0] = t &amp; 0xFFFFFFFFFFFFFFFFULL; t &gt;&gt;= 64;</span>
<span class="term-fg31">-    t += (uint128_t)a-&gt;d[1] + b-&gt;d[1];</span>
<span class="term-fg31">-    r-&gt;d[1] = t &amp; 0xFFFFFFFFFFFFFFFFULL; t &gt;&gt;= 64;</span>
<span class="term-fg31">-    t += (uint128_t)a-&gt;d[2] + b-&gt;d[2];</span>
<span class="term-fg31">-    r-&gt;d[2] = t &amp; 0xFFFFFFFFFFFFFFFFULL; t &gt;&gt;= 64;</span>
<span class="term-fg31">-    t += (uint128_t)a-&gt;d[3] + b-&gt;d[3];</span>
<span class="term-fg31">-    r-&gt;d[3] = t &amp; 0xFFFFFFFFFFFFFFFFULL; t &gt;&gt;= 64;</span>
<span class="term-fg31">-    overflow = t + secp256k1_scalar_check_overflow(r);</span>
<span class="term-fg31">-    VERIFY_CHECK(overflow == 0 || overflow == 1);</span>
<span class="term-fg31">-    secp256k1_scalar_reduce(r, overflow);</span>
<span class="term-fg31">-    return overflow;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_scalar_cadd_bit(secp256k1_scalar *r, unsigned int bit, int flag) {</span>
<span class="term-fg31">-    uint128_t t;</span>
<span class="term-fg31">-    VERIFY_CHECK(bit &lt; 256);</span>
<span class="term-fg31">-    bit += ((uint32_t) flag - 1) &amp; 0x100;  &#47;* forcing (bit &gt;&gt; 6) &gt; 3 makes this a noop *&#47;</span>
<span class="term-fg31">-    t = (uint128_t)r-&gt;d[0] + (((uint64_t)((bit &gt;&gt; 6) == 0)) &lt;&lt; (bit &amp; 0x3F));</span>
<span class="term-fg31">-    r-&gt;d[0] = t &amp; 0xFFFFFFFFFFFFFFFFULL; t &gt;&gt;= 64;</span>
<span class="term-fg31">-    t += (uint128_t)r-&gt;d[1] + (((uint64_t)((bit &gt;&gt; 6) == 1)) &lt;&lt; (bit &amp; 0x3F));</span>
<span class="term-fg31">-    r-&gt;d[1] = t &amp; 0xFFFFFFFFFFFFFFFFULL; t &gt;&gt;= 64;</span>
<span class="term-fg31">-    t += (uint128_t)r-&gt;d[2] + (((uint64_t)((bit &gt;&gt; 6) == 2)) &lt;&lt; (bit &amp; 0x3F));</span>
<span class="term-fg31">-    r-&gt;d[2] = t &amp; 0xFFFFFFFFFFFFFFFFULL; t &gt;&gt;= 64;</span>
<span class="term-fg31">-    t += (uint128_t)r-&gt;d[3] + (((uint64_t)((bit &gt;&gt; 6) == 3)) &lt;&lt; (bit &amp; 0x3F));</span>
<span class="term-fg31">-    r-&gt;d[3] = t &amp; 0xFFFFFFFFFFFFFFFFULL;</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-    VERIFY_CHECK((t &gt;&gt; 64) == 0);</span>
<span class="term-fg31">-    VERIFY_CHECK(secp256k1_scalar_check_overflow(r) == 0);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_scalar_set_b32(secp256k1_scalar *r, const unsigned char *b32, int *overflow) {</span>
<span class="term-fg31">-    int over;</span>
<span class="term-fg31">-    r-&gt;d[0] = (uint64_t)b32[31] | (uint64_t)b32[30] &lt;&lt; 8 | (uint64_t)b32[29] &lt;&lt; 16 | (uint64_t)b32[28] &lt;&lt; 24 | (uint64_t)b32[27] &lt;&lt; 32 | (uint64_t)b32[26] &lt;&lt; 40 | (uint64_t)b32[25] &lt;&lt; 48 | (uint64_t)b32[24] &lt;&lt; 56;</span>
<span class="term-fg31">-    r-&gt;d[1] = (uint64_t)b32[23] | (uint64_t)b32[22] &lt;&lt; 8 | (uint64_t)b32[21] &lt;&lt; 16 | (uint64_t)b32[20] &lt;&lt; 24 | (uint64_t)b32[19] &lt;&lt; 32 | (uint64_t)b32[18] &lt;&lt; 40 | (uint64_t)b32[17] &lt;&lt; 48 | (uint64_t)b32[16] &lt;&lt; 56;</span>
<span class="term-fg31">-    r-&gt;d[2] = (uint64_t)b32[15] | (uint64_t)b32[14] &lt;&lt; 8 | (uint64_t)b32[13] &lt;&lt; 16 | (uint64_t)b32[12] &lt;&lt; 24 | (uint64_t)b32[11] &lt;&lt; 32 | (uint64_t)b32[10] &lt;&lt; 40 | (uint64_t)b32[9] &lt;&lt; 48 | (uint64_t)b32[8] &lt;&lt; 56;</span>
<span class="term-fg31">-    r-&gt;d[3] = (uint64_t)b32[7] | (uint64_t)b32[6] &lt;&lt; 8 | (uint64_t)b32[5] &lt;&lt; 16 | (uint64_t)b32[4] &lt;&lt; 24 | (uint64_t)b32[3] &lt;&lt; 32 | (uint64_t)b32[2] &lt;&lt; 40 | (uint64_t)b32[1] &lt;&lt; 48 | (uint64_t)b32[0] &lt;&lt; 56;</span>
<span class="term-fg31">-    over = secp256k1_scalar_reduce(r, secp256k1_scalar_check_overflow(r));</span>
<span class="term-fg31">-    if (overflow) {</span>
<span class="term-fg31">-        *overflow = over;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_scalar_get_b32(unsigned char *bin, const secp256k1_scalar* a) {</span>
<span class="term-fg31">-    bin[0] = a-&gt;d[3] &gt;&gt; 56; bin[1] = a-&gt;d[3] &gt;&gt; 48; bin[2] = a-&gt;d[3] &gt;&gt; 40; bin[3] = a-&gt;d[3] &gt;&gt; 32; bin[4] = a-&gt;d[3] &gt;&gt; 24; bin[5] = a-&gt;d[3] &gt;&gt; 16; bin[6] = a-&gt;d[3] &gt;&gt; 8; bin[7] = a-&gt;d[3];</span>
<span class="term-fg31">-    bin[8] = a-&gt;d[2] &gt;&gt; 56; bin[9] = a-&gt;d[2] &gt;&gt; 48; bin[10] = a-&gt;d[2] &gt;&gt; 40; bin[11] = a-&gt;d[2] &gt;&gt; 32; bin[12] = a-&gt;d[2] &gt;&gt; 24; bin[13] = a-&gt;d[2] &gt;&gt; 16; bin[14] = a-&gt;d[2] &gt;&gt; 8; bin[15] = a-&gt;d[2];</span>
<span class="term-fg31">-    bin[16] = a-&gt;d[1] &gt;&gt; 56; bin[17] = a-&gt;d[1] &gt;&gt; 48; bin[18] = a-&gt;d[1] &gt;&gt; 40; bin[19] = a-&gt;d[1] &gt;&gt; 32; bin[20] = a-&gt;d[1] &gt;&gt; 24; bin[21] = a-&gt;d[1] &gt;&gt; 16; bin[22] = a-&gt;d[1] &gt;&gt; 8; bin[23] = a-&gt;d[1];</span>
<span class="term-fg31">-    bin[24] = a-&gt;d[0] &gt;&gt; 56; bin[25] = a-&gt;d[0] &gt;&gt; 48; bin[26] = a-&gt;d[0] &gt;&gt; 40; bin[27] = a-&gt;d[0] &gt;&gt; 32; bin[28] = a-&gt;d[0] &gt;&gt; 24; bin[29] = a-&gt;d[0] &gt;&gt; 16; bin[30] = a-&gt;d[0] &gt;&gt; 8; bin[31] = a-&gt;d[0];</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static int secp256k1_scalar_is_zero(const secp256k1_scalar *a) {</span>
<span class="term-fg31">-    return (a-&gt;d[0] | a-&gt;d[1] | a-&gt;d[2] | a-&gt;d[3]) == 0;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_scalar_negate(secp256k1_scalar *r, const secp256k1_scalar *a) {</span>
<span class="term-fg31">-    uint64_t nonzero = 0xFFFFFFFFFFFFFFFFULL * (secp256k1_scalar_is_zero(a) == 0);</span>
<span class="term-fg31">-    uint128_t t = (uint128_t)(~a-&gt;d[0]) + SECP256K1_N_0 + 1;</span>
<span class="term-fg31">-    r-&gt;d[0] = t &amp; nonzero; t &gt;&gt;= 64;</span>
<span class="term-fg31">-    t += (uint128_t)(~a-&gt;d[1]) + SECP256K1_N_1;</span>
<span class="term-fg31">-    r-&gt;d[1] = t &amp; nonzero; t &gt;&gt;= 64;</span>
<span class="term-fg31">-    t += (uint128_t)(~a-&gt;d[2]) + SECP256K1_N_2;</span>
<span class="term-fg31">-    r-&gt;d[2] = t &amp; nonzero; t &gt;&gt;= 64;</span>
<span class="term-fg31">-    t += (uint128_t)(~a-&gt;d[3]) + SECP256K1_N_3;</span>
<span class="term-fg31">-    r-&gt;d[3] = t &amp; nonzero;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static int secp256k1_scalar_is_one(const secp256k1_scalar *a) {</span>
<span class="term-fg31">-    return ((a-&gt;d[0] ^ 1) | a-&gt;d[1] | a-&gt;d[2] | a-&gt;d[3]) == 0;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_scalar_is_high(const secp256k1_scalar *a) {</span>
<span class="term-fg31">-    int yes = 0;</span>
<span class="term-fg31">-    int no = 0;</span>
<span class="term-fg31">-    no |= (a-&gt;d[3] &lt; SECP256K1_N_H_3);</span>
<span class="term-fg31">-    yes |= (a-&gt;d[3] &gt; SECP256K1_N_H_3) &amp; ~no;</span>
<span class="term-fg31">-    no |= (a-&gt;d[2] &lt; SECP256K1_N_H_2) &amp; ~yes; &#47;* No need for a &gt; check. *&#47;</span>
<span class="term-fg31">-    no |= (a-&gt;d[1] &lt; SECP256K1_N_H_1) &amp; ~yes;</span>
<span class="term-fg31">-    yes |= (a-&gt;d[1] &gt; SECP256K1_N_H_1) &amp; ~no;</span>
<span class="term-fg31">-    yes |= (a-&gt;d[0] &gt; SECP256K1_N_H_0) &amp; ~no;</span>
<span class="term-fg31">-    return yes;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_scalar_cond_negate(secp256k1_scalar *r, int flag) {</span>
<span class="term-fg31">-    &#47;* If we are flag = 0, mask = 00...00 and this is a no-op;</span>
<span class="term-fg31">-     * if we are flag = 1, mask = 11...11 and this is identical to secp256k1_scalar_negate *&#47;</span>
<span class="term-fg31">-    uint64_t mask = !flag - 1;</span>
<span class="term-fg31">-    uint64_t nonzero = (secp256k1_scalar_is_zero(r) != 0) - 1;</span>
<span class="term-fg31">-    uint128_t t = (uint128_t)(r-&gt;d[0] ^ mask) + ((SECP256K1_N_0 + 1) &amp; mask);</span>
<span class="term-fg31">-    r-&gt;d[0] = t &amp; nonzero; t &gt;&gt;= 64;</span>
<span class="term-fg31">-    t += (uint128_t)(r-&gt;d[1] ^ mask) + (SECP256K1_N_1 &amp; mask);</span>
<span class="term-fg31">-    r-&gt;d[1] = t &amp; nonzero; t &gt;&gt;= 64;</span>
<span class="term-fg31">-    t += (uint128_t)(r-&gt;d[2] ^ mask) + (SECP256K1_N_2 &amp; mask);</span>
<span class="term-fg31">-    r-&gt;d[2] = t &amp; nonzero; t &gt;&gt;= 64;</span>
<span class="term-fg31">-    t += (uint128_t)(r-&gt;d[3] ^ mask) + (SECP256K1_N_3 &amp; mask);</span>
<span class="term-fg31">-    r-&gt;d[3] = t &amp; nonzero;</span>
<span class="term-fg31">-    return 2 * (mask == 0) - 1;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;* Inspired by the macros in OpenSSL&#39;s crypto&#47;bn&#47;asm&#47;x86_64-gcc.c. *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Add a*b to the number defined by (c0,c1,c2). c2 must never overflow. *&#47;</span>
<span class="term-fg31">-#define muladd(a,b) { \</span>
<span class="term-fg31">-    uint64_t tl, th; \</span>
<span class="term-fg31">-    { \</span>
<span class="term-fg31">-        uint128_t t = (uint128_t)a * b; \</span>
<span class="term-fg31">-        th = t &gt;&gt; 64;         &#47;* at most 0xFFFFFFFFFFFFFFFE *&#47; \</span>
<span class="term-fg31">-        tl = t; \</span>
<span class="term-fg31">-    } \</span>
<span class="term-fg31">-    c0 += tl;                 &#47;* overflow is handled on the next line *&#47; \</span>
<span class="term-fg31">-    th += (c0 &lt; tl) ? 1 : 0;  &#47;* at most 0xFFFFFFFFFFFFFFFF *&#47; \</span>
<span class="term-fg31">-    c1 += th;                 &#47;* overflow is handled on the next line *&#47; \</span>
<span class="term-fg31">-    c2 += (c1 &lt; th) ? 1 : 0;  &#47;* never overflows by contract (verified in the next line) *&#47; \</span>
<span class="term-fg31">-    VERIFY_CHECK((c1 &gt;= th) || (c2 != 0)); \</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Add a*b to the number defined by (c0,c1). c1 must never overflow. *&#47;</span>
<span class="term-fg31">-#define muladd_fast(a,b) { \</span>
<span class="term-fg31">-    uint64_t tl, th; \</span>
<span class="term-fg31">-    { \</span>
<span class="term-fg31">-        uint128_t t = (uint128_t)a * b; \</span>
<span class="term-fg31">-        th = t &gt;&gt; 64;         &#47;* at most 0xFFFFFFFFFFFFFFFE *&#47; \</span>
<span class="term-fg31">-        tl = t; \</span>
<span class="term-fg31">-    } \</span>
<span class="term-fg31">-    c0 += tl;                 &#47;* overflow is handled on the next line *&#47; \</span>
<span class="term-fg31">-    th += (c0 &lt; tl) ? 1 : 0;  &#47;* at most 0xFFFFFFFFFFFFFFFF *&#47; \</span>
<span class="term-fg31">-    c1 += th;                 &#47;* never overflows by contract (verified in the next line) *&#47; \</span>
<span class="term-fg31">-    VERIFY_CHECK(c1 &gt;= th); \</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Add 2*a*b to the number defined by (c0,c1,c2). c2 must never overflow. *&#47;</span>
<span class="term-fg31">-#define muladd2(a,b) { \</span>
<span class="term-fg31">-    uint64_t tl, th, th2, tl2; \</span>
<span class="term-fg31">-    { \</span>
<span class="term-fg31">-        uint128_t t = (uint128_t)a * b; \</span>
<span class="term-fg31">-        th = t &gt;&gt; 64;               &#47;* at most 0xFFFFFFFFFFFFFFFE *&#47; \</span>
<span class="term-fg31">-        tl = t; \</span>
<span class="term-fg31">-    } \</span>
<span class="term-fg31">-    th2 = th + th;                  &#47;* at most 0xFFFFFFFFFFFFFFFE (in case th was 0x7FFFFFFFFFFFFFFF) *&#47; \</span>
<span class="term-fg31">-    c2 += (th2 &lt; th) ? 1 : 0;       &#47;* never overflows by contract (verified the next line) *&#47; \</span>
<span class="term-fg31">-    VERIFY_CHECK((th2 &gt;= th) || (c2 != 0)); \</span>
<span class="term-fg31">-    tl2 = tl + tl;                  &#47;* at most 0xFFFFFFFFFFFFFFFE (in case the lowest 63 bits of tl were 0x7FFFFFFFFFFFFFFF) *&#47; \</span>
<span class="term-fg31">-    th2 += (tl2 &lt; tl) ? 1 : 0;      &#47;* at most 0xFFFFFFFFFFFFFFFF *&#47; \</span>
<span class="term-fg31">-    c0 += tl2;                      &#47;* overflow is handled on the next line *&#47; \</span>
<span class="term-fg31">-    th2 += (c0 &lt; tl2) ? 1 : 0;      &#47;* second overflow is handled on the next line *&#47; \</span>
<span class="term-fg31">-    c2 += (c0 &lt; tl2) &amp; (th2 == 0);  &#47;* never overflows by contract (verified the next line) *&#47; \</span>
<span class="term-fg31">-    VERIFY_CHECK((c0 &gt;= tl2) || (th2 != 0) || (c2 != 0)); \</span>
<span class="term-fg31">-    c1 += th2;                      &#47;* overflow is handled on the next line *&#47; \</span>
<span class="term-fg31">-    c2 += (c1 &lt; th2) ? 1 : 0;       &#47;* never overflows by contract (verified the next line) *&#47; \</span>
<span class="term-fg31">-    VERIFY_CHECK((c1 &gt;= th2) || (c2 != 0)); \</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Add a to the number defined by (c0,c1,c2). c2 must never overflow. *&#47;</span>
<span class="term-fg31">-#define sumadd(a) { \</span>
<span class="term-fg31">-    unsigned int over; \</span>
<span class="term-fg31">-    c0 += (a);                  &#47;* overflow is handled on the next line *&#47; \</span>
<span class="term-fg31">-    over = (c0 &lt; (a)) ? 1 : 0; \</span>
<span class="term-fg31">-    c1 += over;                 &#47;* overflow is handled on the next line *&#47; \</span>
<span class="term-fg31">-    c2 += (c1 &lt; over) ? 1 : 0;  &#47;* never overflows by contract *&#47; \</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Add a to the number defined by (c0,c1). c1 must never overflow, c2 must be zero. *&#47;</span>
<span class="term-fg31">-#define sumadd_fast(a) { \</span>
<span class="term-fg31">-    c0 += (a);                 &#47;* overflow is handled on the next line *&#47; \</span>
<span class="term-fg31">-    c1 += (c0 &lt; (a)) ? 1 : 0;  &#47;* never overflows by contract (verified the next line) *&#47; \</span>
<span class="term-fg31">-    VERIFY_CHECK((c1 != 0) | (c0 &gt;= (a))); \</span>
<span class="term-fg31">-    VERIFY_CHECK(c2 == 0); \</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Extract the lowest 64 bits of (c0,c1,c2) into n, and left shift the number 64 bits. *&#47;</span>
<span class="term-fg31">-#define extract(n) { \</span>
<span class="term-fg31">-    (n) = c0; \</span>
<span class="term-fg31">-    c0 = c1; \</span>
<span class="term-fg31">-    c1 = c2; \</span>
<span class="term-fg31">-    c2 = 0; \</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Extract the lowest 64 bits of (c0,c1,c2) into n, and left shift the number 64 bits. c2 is required to be zero. *&#47;</span>
<span class="term-fg31">-#define extract_fast(n) { \</span>
<span class="term-fg31">-    (n) = c0; \</span>
<span class="term-fg31">-    c0 = c1; \</span>
<span class="term-fg31">-    c1 = 0; \</span>
<span class="term-fg31">-    VERIFY_CHECK(c2 == 0); \</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_scalar_reduce_512(secp256k1_scalar *r, const uint64_t *l) {</span>
<span class="term-fg31">-#ifdef USE_ASM_X86_64</span>
<span class="term-fg31">-    &#47;* Reduce 512 bits into 385. *&#47;</span>
<span class="term-fg31">-    uint64_t m0, m1, m2, m3, m4, m5, m6;</span>
<span class="term-fg31">-    uint64_t p0, p1, p2, p3, p4;</span>
<span class="term-fg31">-    uint64_t c;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    __asm__ __volatile__(</span>
<span class="term-fg31">-    &#47;* Preload. *&#47;</span>
<span class="term-fg31">-    &quot;movq 32(%%rsi), %%r11\n&quot;</span>
<span class="term-fg31">-    &quot;movq 40(%%rsi), %%r12\n&quot;</span>
<span class="term-fg31">-    &quot;movq 48(%%rsi), %%r13\n&quot;</span>
<span class="term-fg31">-    &quot;movq 56(%%rsi), %%r14\n&quot;</span>
<span class="term-fg31">-    &#47;* Initialize r8,r9,r10 *&#47;</span>
<span class="term-fg31">-    &quot;movq 0(%%rsi), %%r8\n&quot;</span>
<span class="term-fg31">-    &quot;xorq %%r9, %%r9\n&quot;</span>
<span class="term-fg31">-    &quot;xorq %%r10, %%r10\n&quot;</span>
<span class="term-fg31">-    &#47;* (r8,r9) += n0 * c0 *&#47;</span>
<span class="term-fg31">-    &quot;movq %8, %%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r11\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax, %%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx, %%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* extract m0 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r8, %q0\n&quot;</span>
<span class="term-fg31">-    &quot;xorq %%r8, %%r8\n&quot;</span>
<span class="term-fg31">-    &#47;* (r9,r10) += l1 *&#47;</span>
<span class="term-fg31">-    &quot;addq 8(%%rsi), %%r9\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r10\n&quot;</span>
<span class="term-fg31">-    &#47;* (r9,r10,r8) += n1 * c0 *&#47;</span>
<span class="term-fg31">-    &quot;movq %8, %%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r12\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax, %%r9\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx, %%r10\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r8\n&quot;</span>
<span class="term-fg31">-    &#47;* (r9,r10,r8) += n0 * c1 *&#47;</span>
<span class="term-fg31">-    &quot;movq %9, %%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r11\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax, %%r9\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx, %%r10\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r8\n&quot;</span>
<span class="term-fg31">-    &#47;* extract m1 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r9, %q1\n&quot;</span>
<span class="term-fg31">-    &quot;xorq %%r9, %%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* (r10,r8,r9) += l2 *&#47;</span>
<span class="term-fg31">-    &quot;addq 16(%%rsi), %%r10\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* (r10,r8,r9) += n2 * c0 *&#47;</span>
<span class="term-fg31">-    &quot;movq %8, %%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r13\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax, %%r10\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx, %%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* (r10,r8,r9) += n1 * c1 *&#47;</span>
<span class="term-fg31">-    &quot;movq %9, %%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r12\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax, %%r10\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx, %%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* (r10,r8,r9) += n0 *&#47;</span>
<span class="term-fg31">-    &quot;addq %%r11, %%r10\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* extract m2 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r10, %q2\n&quot;</span>
<span class="term-fg31">-    &quot;xorq %%r10, %%r10\n&quot;</span>
<span class="term-fg31">-    &#47;* (r8,r9,r10) += l3 *&#47;</span>
<span class="term-fg31">-    &quot;addq 24(%%rsi), %%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r9\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r10\n&quot;</span>
<span class="term-fg31">-    &#47;* (r8,r9,r10) += n3 * c0 *&#47;</span>
<span class="term-fg31">-    &quot;movq %8, %%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r14\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax, %%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx, %%r9\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r10\n&quot;</span>
<span class="term-fg31">-    &#47;* (r8,r9,r10) += n2 * c1 *&#47;</span>
<span class="term-fg31">-    &quot;movq %9, %%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r13\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax, %%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx, %%r9\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r10\n&quot;</span>
<span class="term-fg31">-    &#47;* (r8,r9,r10) += n1 *&#47;</span>
<span class="term-fg31">-    &quot;addq %%r12, %%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r9\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r10\n&quot;</span>
<span class="term-fg31">-    &#47;* extract m3 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r8, %q3\n&quot;</span>
<span class="term-fg31">-    &quot;xorq %%r8, %%r8\n&quot;</span>
<span class="term-fg31">-    &#47;* (r9,r10,r8) += n3 * c1 *&#47;</span>
<span class="term-fg31">-    &quot;movq %9, %%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r14\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax, %%r9\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx, %%r10\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r8\n&quot;</span>
<span class="term-fg31">-    &#47;* (r9,r10,r8) += n2 *&#47;</span>
<span class="term-fg31">-    &quot;addq %%r13, %%r9\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r10\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r8\n&quot;</span>
<span class="term-fg31">-    &#47;* extract m4 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r9, %q4\n&quot;</span>
<span class="term-fg31">-    &#47;* (r10,r8) += n3 *&#47;</span>
<span class="term-fg31">-    &quot;addq %%r14, %%r10\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r8\n&quot;</span>
<span class="term-fg31">-    &#47;* extract m5 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r10, %q5\n&quot;</span>
<span class="term-fg31">-    &#47;* extract m6 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r8, %q6\n&quot;</span>
<span class="term-fg31">-    : &quot;=g&quot;(m0), &quot;=g&quot;(m1), &quot;=g&quot;(m2), &quot;=g&quot;(m3), &quot;=g&quot;(m4), &quot;=g&quot;(m5), &quot;=g&quot;(m6)</span>
<span class="term-fg31">-    : &quot;S&quot;(l), &quot;n&quot;(SECP256K1_N_C_0), &quot;n&quot;(SECP256K1_N_C_1)</span>
<span class="term-fg31">-    : &quot;rax&quot;, &quot;rdx&quot;, &quot;r8&quot;, &quot;r9&quot;, &quot;r10&quot;, &quot;r11&quot;, &quot;r12&quot;, &quot;r13&quot;, &quot;r14&quot;, &quot;cc&quot;);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Reduce 385 bits into 258. *&#47;</span>
<span class="term-fg31">-    __asm__ __volatile__(</span>
<span class="term-fg31">-    &#47;* Preload *&#47;</span>
<span class="term-fg31">-    &quot;movq %q9, %%r11\n&quot;</span>
<span class="term-fg31">-    &quot;movq %q10, %%r12\n&quot;</span>
<span class="term-fg31">-    &quot;movq %q11, %%r13\n&quot;</span>
<span class="term-fg31">-    &#47;* Initialize (r8,r9,r10) *&#47;</span>
<span class="term-fg31">-    &quot;movq %q5, %%r8\n&quot;</span>
<span class="term-fg31">-    &quot;xorq %%r9, %%r9\n&quot;</span>
<span class="term-fg31">-    &quot;xorq %%r10, %%r10\n&quot;</span>
<span class="term-fg31">-    &#47;* (r8,r9) += m4 * c0 *&#47;</span>
<span class="term-fg31">-    &quot;movq %12, %%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r11\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax, %%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx, %%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* extract p0 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r8, %q0\n&quot;</span>
<span class="term-fg31">-    &quot;xorq %%r8, %%r8\n&quot;</span>
<span class="term-fg31">-    &#47;* (r9,r10) += m1 *&#47;</span>
<span class="term-fg31">-    &quot;addq %q6, %%r9\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r10\n&quot;</span>
<span class="term-fg31">-    &#47;* (r9,r10,r8) += m5 * c0 *&#47;</span>
<span class="term-fg31">-    &quot;movq %12, %%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r12\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax, %%r9\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx, %%r10\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r8\n&quot;</span>
<span class="term-fg31">-    &#47;* (r9,r10,r8) += m4 * c1 *&#47;</span>
<span class="term-fg31">-    &quot;movq %13, %%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r11\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax, %%r9\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx, %%r10\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r8\n&quot;</span>
<span class="term-fg31">-    &#47;* extract p1 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r9, %q1\n&quot;</span>
<span class="term-fg31">-    &quot;xorq %%r9, %%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* (r10,r8,r9) += m2 *&#47;</span>
<span class="term-fg31">-    &quot;addq %q7, %%r10\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* (r10,r8,r9) += m6 * c0 *&#47;</span>
<span class="term-fg31">-    &quot;movq %12, %%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r13\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax, %%r10\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx, %%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* (r10,r8,r9) += m5 * c1 *&#47;</span>
<span class="term-fg31">-    &quot;movq %13, %%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r12\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax, %%r10\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx, %%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* (r10,r8,r9) += m4 *&#47;</span>
<span class="term-fg31">-    &quot;addq %%r11, %%r10\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* extract p2 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r10, %q2\n&quot;</span>
<span class="term-fg31">-    &#47;* (r8,r9) += m3 *&#47;</span>
<span class="term-fg31">-    &quot;addq %q8, %%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* (r8,r9) += m6 * c1 *&#47;</span>
<span class="term-fg31">-    &quot;movq %13, %%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r13\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax, %%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx, %%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* (r8,r9) += m5 *&#47;</span>
<span class="term-fg31">-    &quot;addq %%r12, %%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* extract p3 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r8, %q3\n&quot;</span>
<span class="term-fg31">-    &#47;* (r9) += m6 *&#47;</span>
<span class="term-fg31">-    &quot;addq %%r13, %%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* extract p4 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r9, %q4\n&quot;</span>
<span class="term-fg31">-    : &quot;=&amp;g&quot;(p0), &quot;=&amp;g&quot;(p1), &quot;=&amp;g&quot;(p2), &quot;=g&quot;(p3), &quot;=g&quot;(p4)</span>
<span class="term-fg31">-    : &quot;g&quot;(m0), &quot;g&quot;(m1), &quot;g&quot;(m2), &quot;g&quot;(m3), &quot;g&quot;(m4), &quot;g&quot;(m5), &quot;g&quot;(m6), &quot;n&quot;(SECP256K1_N_C_0), &quot;n&quot;(SECP256K1_N_C_1)</span>
<span class="term-fg31">-    : &quot;rax&quot;, &quot;rdx&quot;, &quot;r8&quot;, &quot;r9&quot;, &quot;r10&quot;, &quot;r11&quot;, &quot;r12&quot;, &quot;r13&quot;, &quot;cc&quot;);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Reduce 258 bits into 256. *&#47;</span>
<span class="term-fg31">-    __asm__ __volatile__(</span>
<span class="term-fg31">-    &#47;* Preload *&#47;</span>
<span class="term-fg31">-    &quot;movq %q5, %%r10\n&quot;</span>
<span class="term-fg31">-    &#47;* (rax,rdx) = p4 * c0 *&#47;</span>
<span class="term-fg31">-    &quot;movq %7, %%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r10\n&quot;</span>
<span class="term-fg31">-    &#47;* (rax,rdx) += p0 *&#47;</span>
<span class="term-fg31">-    &quot;addq %q1, %%rax\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%rdx\n&quot;</span>
<span class="term-fg31">-    &#47;* extract r0 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%rax, 0(%q6)\n&quot;</span>
<span class="term-fg31">-    &#47;* Move to (r8,r9) *&#47;</span>
<span class="term-fg31">-    &quot;movq %%rdx, %%r8\n&quot;</span>
<span class="term-fg31">-    &quot;xorq %%r9, %%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* (r8,r9) += p1 *&#47;</span>
<span class="term-fg31">-    &quot;addq %q2, %%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* (r8,r9) += p4 * c1 *&#47;</span>
<span class="term-fg31">-    &quot;movq %8, %%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r10\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax, %%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx, %%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* Extract r1 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r8, 8(%q6)\n&quot;</span>
<span class="term-fg31">-    &quot;xorq %%r8, %%r8\n&quot;</span>
<span class="term-fg31">-    &#47;* (r9,r8) += p4 *&#47;</span>
<span class="term-fg31">-    &quot;addq %%r10, %%r9\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r8\n&quot;</span>
<span class="term-fg31">-    &#47;* (r9,r8) += p2 *&#47;</span>
<span class="term-fg31">-    &quot;addq %q3, %%r9\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r8\n&quot;</span>
<span class="term-fg31">-    &#47;* Extract r2 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r9, 16(%q6)\n&quot;</span>
<span class="term-fg31">-    &quot;xorq %%r9, %%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* (r8,r9) += p3 *&#47;</span>
<span class="term-fg31">-    &quot;addq %q4, %%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* Extract r3 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r8, 24(%q6)\n&quot;</span>
<span class="term-fg31">-    &#47;* Extract c *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r9, %q0\n&quot;</span>
<span class="term-fg31">-    : &quot;=g&quot;(c)</span>
<span class="term-fg31">-    : &quot;g&quot;(p0), &quot;g&quot;(p1), &quot;g&quot;(p2), &quot;g&quot;(p3), &quot;g&quot;(p4), &quot;D&quot;(r), &quot;n&quot;(SECP256K1_N_C_0), &quot;n&quot;(SECP256K1_N_C_1)</span>
<span class="term-fg31">-    : &quot;rax&quot;, &quot;rdx&quot;, &quot;r8&quot;, &quot;r9&quot;, &quot;r10&quot;, &quot;cc&quot;, &quot;memory&quot;);</span>
<span class="term-fg31">-#else</span>
<span class="term-fg31">-    uint128_t c;</span>
<span class="term-fg31">-    uint64_t c0, c1, c2;</span>
<span class="term-fg31">-    uint64_t n0 = l[4], n1 = l[5], n2 = l[6], n3 = l[7];</span>
<span class="term-fg31">-    uint64_t m0, m1, m2, m3, m4, m5;</span>
<span class="term-fg31">-    uint32_t m6;</span>
<span class="term-fg31">-    uint64_t p0, p1, p2, p3;</span>
<span class="term-fg31">-    uint32_t p4;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Reduce 512 bits into 385. *&#47;</span>
<span class="term-fg31">-    &#47;* m[0..6] = l[0..3] + n[0..3] * SECP256K1_N_C. *&#47;</span>
<span class="term-fg31">-    c0 = l[0]; c1 = 0; c2 = 0;</span>
<span class="term-fg31">-    muladd_fast(n0, SECP256K1_N_C_0);</span>
<span class="term-fg31">-    extract_fast(m0);</span>
<span class="term-fg31">-    sumadd_fast(l[1]);</span>
<span class="term-fg31">-    muladd(n1, SECP256K1_N_C_0);</span>
<span class="term-fg31">-    muladd(n0, SECP256K1_N_C_1);</span>
<span class="term-fg31">-    extract(m1);</span>
<span class="term-fg31">-    sumadd(l[2]);</span>
<span class="term-fg31">-    muladd(n2, SECP256K1_N_C_0);</span>
<span class="term-fg31">-    muladd(n1, SECP256K1_N_C_1);</span>
<span class="term-fg31">-    sumadd(n0);</span>
<span class="term-fg31">-    extract(m2);</span>
<span class="term-fg31">-    sumadd(l[3]);</span>
<span class="term-fg31">-    muladd(n3, SECP256K1_N_C_0);</span>
<span class="term-fg31">-    muladd(n2, SECP256K1_N_C_1);</span>
<span class="term-fg31">-    sumadd(n1);</span>
<span class="term-fg31">-    extract(m3);</span>
<span class="term-fg31">-    muladd(n3, SECP256K1_N_C_1);</span>
<span class="term-fg31">-    sumadd(n2);</span>
<span class="term-fg31">-    extract(m4);</span>
<span class="term-fg31">-    sumadd_fast(n3);</span>
<span class="term-fg31">-    extract_fast(m5);</span>
<span class="term-fg31">-    VERIFY_CHECK(c0 &lt;= 1);</span>
<span class="term-fg31">-    m6 = c0;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Reduce 385 bits into 258. *&#47;</span>
<span class="term-fg31">-    &#47;* p[0..4] = m[0..3] + m[4..6] * SECP256K1_N_C. *&#47;</span>
<span class="term-fg31">-    c0 = m0; c1 = 0; c2 = 0;</span>
<span class="term-fg31">-    muladd_fast(m4, SECP256K1_N_C_0);</span>
<span class="term-fg31">-    extract_fast(p0);</span>
<span class="term-fg31">-    sumadd_fast(m1);</span>
<span class="term-fg31">-    muladd(m5, SECP256K1_N_C_0);</span>
<span class="term-fg31">-    muladd(m4, SECP256K1_N_C_1);</span>
<span class="term-fg31">-    extract(p1);</span>
<span class="term-fg31">-    sumadd(m2);</span>
<span class="term-fg31">-    muladd(m6, SECP256K1_N_C_0);</span>
<span class="term-fg31">-    muladd(m5, SECP256K1_N_C_1);</span>
<span class="term-fg31">-    sumadd(m4);</span>
<span class="term-fg31">-    extract(p2);</span>
<span class="term-fg31">-    sumadd_fast(m3);</span>
<span class="term-fg31">-    muladd_fast(m6, SECP256K1_N_C_1);</span>
<span class="term-fg31">-    sumadd_fast(m5);</span>
<span class="term-fg31">-    extract_fast(p3);</span>
<span class="term-fg31">-    p4 = c0 + m6;</span>
<span class="term-fg31">-    VERIFY_CHECK(p4 &lt;= 2);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Reduce 258 bits into 256. *&#47;</span>
<span class="term-fg31">-    &#47;* r[0..3] = p[0..3] + p[4] * SECP256K1_N_C. *&#47;</span>
<span class="term-fg31">-    c = p0 + (uint128_t)SECP256K1_N_C_0 * p4;</span>
<span class="term-fg31">-    r-&gt;d[0] = c &amp; 0xFFFFFFFFFFFFFFFFULL; c &gt;&gt;= 64;</span>
<span class="term-fg31">-    c += p1 + (uint128_t)SECP256K1_N_C_1 * p4;</span>
<span class="term-fg31">-    r-&gt;d[1] = c &amp; 0xFFFFFFFFFFFFFFFFULL; c &gt;&gt;= 64;</span>
<span class="term-fg31">-    c += p2 + (uint128_t)p4;</span>
<span class="term-fg31">-    r-&gt;d[2] = c &amp; 0xFFFFFFFFFFFFFFFFULL; c &gt;&gt;= 64;</span>
<span class="term-fg31">-    c += p3;</span>
<span class="term-fg31">-    r-&gt;d[3] = c &amp; 0xFFFFFFFFFFFFFFFFULL; c &gt;&gt;= 64;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Final reduction of r. *&#47;</span>
<span class="term-fg31">-    secp256k1_scalar_reduce(r, c + secp256k1_scalar_check_overflow(r));</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_scalar_mul_512(uint64_t l[8], const secp256k1_scalar *a, const secp256k1_scalar *b) {</span>
<span class="term-fg31">-#ifdef USE_ASM_X86_64</span>
<span class="term-fg31">-    const uint64_t *pb = b-&gt;d;</span>
<span class="term-fg31">-    __asm__ __volatile__(</span>
<span class="term-fg31">-    &#47;* Preload *&#47;</span>
<span class="term-fg31">-    &quot;movq 0(%%rdi), %%r15\n&quot;</span>
<span class="term-fg31">-    &quot;movq 8(%%rdi), %%rbx\n&quot;</span>
<span class="term-fg31">-    &quot;movq 16(%%rdi), %%rcx\n&quot;</span>
<span class="term-fg31">-    &quot;movq 0(%%rdx), %%r11\n&quot;</span>
<span class="term-fg31">-    &quot;movq 8(%%rdx), %%r12\n&quot;</span>
<span class="term-fg31">-    &quot;movq 16(%%rdx), %%r13\n&quot;</span>
<span class="term-fg31">-    &quot;movq 24(%%rdx), %%r14\n&quot;</span>
<span class="term-fg31">-    &#47;* (rax,rdx) = a0 * b0 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r15, %%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r11\n&quot;</span>
<span class="term-fg31">-    &#47;* Extract l0 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%rax, 0(%%rsi)\n&quot;</span>
<span class="term-fg31">-    &#47;* (r8,r9,r10) = (rdx) *&#47;</span>
<span class="term-fg31">-    &quot;movq %%rdx, %%r8\n&quot;</span>
<span class="term-fg31">-    &quot;xorq %%r9, %%r9\n&quot;</span>
<span class="term-fg31">-    &quot;xorq %%r10, %%r10\n&quot;</span>
<span class="term-fg31">-    &#47;* (r8,r9,r10) += a0 * b1 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r15, %%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r12\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax, %%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx, %%r9\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r10\n&quot;</span>
<span class="term-fg31">-    &#47;* (r8,r9,r10) += a1 * b0 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%rbx, %%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r11\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax, %%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx, %%r9\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r10\n&quot;</span>
<span class="term-fg31">-    &#47;* Extract l1 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r8, 8(%%rsi)\n&quot;</span>
<span class="term-fg31">-    &quot;xorq %%r8, %%r8\n&quot;</span>
<span class="term-fg31">-    &#47;* (r9,r10,r8) += a0 * b2 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r15, %%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r13\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax, %%r9\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx, %%r10\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r8\n&quot;</span>
<span class="term-fg31">-    &#47;* (r9,r10,r8) += a1 * b1 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%rbx, %%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r12\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax, %%r9\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx, %%r10\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r8\n&quot;</span>
<span class="term-fg31">-    &#47;* (r9,r10,r8) += a2 * b0 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%rcx, %%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r11\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax, %%r9\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx, %%r10\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r8\n&quot;</span>
<span class="term-fg31">-    &#47;* Extract l2 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r9, 16(%%rsi)\n&quot;</span>
<span class="term-fg31">-    &quot;xorq %%r9, %%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* (r10,r8,r9) += a0 * b3 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r15, %%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r14\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax, %%r10\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx, %%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* Preload a3 *&#47;</span>
<span class="term-fg31">-    &quot;movq 24(%%rdi), %%r15\n&quot;</span>
<span class="term-fg31">-    &#47;* (r10,r8,r9) += a1 * b2 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%rbx, %%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r13\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax, %%r10\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx, %%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* (r10,r8,r9) += a2 * b1 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%rcx, %%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r12\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax, %%r10\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx, %%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* (r10,r8,r9) += a3 * b0 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r15, %%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r11\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax, %%r10\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx, %%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* Extract l3 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r10, 24(%%rsi)\n&quot;</span>
<span class="term-fg31">-    &quot;xorq %%r10, %%r10\n&quot;</span>
<span class="term-fg31">-    &#47;* (r8,r9,r10) += a1 * b3 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%rbx, %%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r14\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax, %%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx, %%r9\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r10\n&quot;</span>
<span class="term-fg31">-    &#47;* (r8,r9,r10) += a2 * b2 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%rcx, %%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r13\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax, %%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx, %%r9\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r10\n&quot;</span>
<span class="term-fg31">-    &#47;* (r8,r9,r10) += a3 * b1 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r15, %%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r12\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax, %%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx, %%r9\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r10\n&quot;</span>
<span class="term-fg31">-    &#47;* Extract l4 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r8, 32(%%rsi)\n&quot;</span>
<span class="term-fg31">-    &quot;xorq %%r8, %%r8\n&quot;</span>
<span class="term-fg31">-    &#47;* (r9,r10,r8) += a2 * b3 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%rcx, %%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r14\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax, %%r9\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx, %%r10\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r8\n&quot;</span>
<span class="term-fg31">-    &#47;* (r9,r10,r8) += a3 * b2 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r15, %%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r13\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax, %%r9\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx, %%r10\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r8\n&quot;</span>
<span class="term-fg31">-    &#47;* Extract l5 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r9, 40(%%rsi)\n&quot;</span>
<span class="term-fg31">-    &#47;* (r10,r8) += a3 * b3 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r15, %%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r14\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax, %%r10\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx, %%r8\n&quot;</span>
<span class="term-fg31">-    &#47;* Extract l6 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r10, 48(%%rsi)\n&quot;</span>
<span class="term-fg31">-    &#47;* Extract l7 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r8, 56(%%rsi)\n&quot;</span>
<span class="term-fg31">-    : &quot;+d&quot;(pb)</span>
<span class="term-fg31">-    : &quot;S&quot;(l), &quot;D&quot;(a-&gt;d)</span>
<span class="term-fg31">-    : &quot;rax&quot;, &quot;rbx&quot;, &quot;rcx&quot;, &quot;r8&quot;, &quot;r9&quot;, &quot;r10&quot;, &quot;r11&quot;, &quot;r12&quot;, &quot;r13&quot;, &quot;r14&quot;, &quot;r15&quot;, &quot;cc&quot;, &quot;memory&quot;);</span>
<span class="term-fg31">-#else</span>
<span class="term-fg31">-    &#47;* 160 bit accumulator. *&#47;</span>
<span class="term-fg31">-    uint64_t c0 = 0, c1 = 0;</span>
<span class="term-fg31">-    uint32_t c2 = 0;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* l[0..7] = a[0..3] * b[0..3]. *&#47;</span>
<span class="term-fg31">-    muladd_fast(a-&gt;d[0], b-&gt;d[0]);</span>
<span class="term-fg31">-    extract_fast(l[0]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[0], b-&gt;d[1]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[1], b-&gt;d[0]);</span>
<span class="term-fg31">-    extract(l[1]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[0], b-&gt;d[2]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[1], b-&gt;d[1]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[2], b-&gt;d[0]);</span>
<span class="term-fg31">-    extract(l[2]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[0], b-&gt;d[3]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[1], b-&gt;d[2]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[2], b-&gt;d[1]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[3], b-&gt;d[0]);</span>
<span class="term-fg31">-    extract(l[3]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[1], b-&gt;d[3]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[2], b-&gt;d[2]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[3], b-&gt;d[1]);</span>
<span class="term-fg31">-    extract(l[4]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[2], b-&gt;d[3]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[3], b-&gt;d[2]);</span>
<span class="term-fg31">-    extract(l[5]);</span>
<span class="term-fg31">-    muladd_fast(a-&gt;d[3], b-&gt;d[3]);</span>
<span class="term-fg31">-    extract_fast(l[6]);</span>
<span class="term-fg31">-    VERIFY_CHECK(c1 == 0);</span>
<span class="term-fg31">-    l[7] = c0;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_scalar_sqr_512(uint64_t l[8], const secp256k1_scalar *a) {</span>
<span class="term-fg31">-#ifdef USE_ASM_X86_64</span>
<span class="term-fg31">-    __asm__ __volatile__(</span>
<span class="term-fg31">-    &#47;* Preload *&#47;</span>
<span class="term-fg31">-    &quot;movq 0(%%rdi), %%r11\n&quot;</span>
<span class="term-fg31">-    &quot;movq 8(%%rdi), %%r12\n&quot;</span>
<span class="term-fg31">-    &quot;movq 16(%%rdi), %%r13\n&quot;</span>
<span class="term-fg31">-    &quot;movq 24(%%rdi), %%r14\n&quot;</span>
<span class="term-fg31">-    &#47;* (rax,rdx) = a0 * a0 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r11, %%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r11\n&quot;</span>
<span class="term-fg31">-    &#47;* Extract l0 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%rax, 0(%%rsi)\n&quot;</span>
<span class="term-fg31">-    &#47;* (r8,r9,r10) = (rdx,0) *&#47;</span>
<span class="term-fg31">-    &quot;movq %%rdx, %%r8\n&quot;</span>
<span class="term-fg31">-    &quot;xorq %%r9, %%r9\n&quot;</span>
<span class="term-fg31">-    &quot;xorq %%r10, %%r10\n&quot;</span>
<span class="term-fg31">-    &#47;* (r8,r9,r10) += 2 * a0 * a1 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r11, %%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r12\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax, %%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx, %%r9\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r10\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax, %%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx, %%r9\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r10\n&quot;</span>
<span class="term-fg31">-    &#47;* Extract l1 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r8, 8(%%rsi)\n&quot;</span>
<span class="term-fg31">-    &quot;xorq %%r8, %%r8\n&quot;</span>
<span class="term-fg31">-    &#47;* (r9,r10,r8) += 2 * a0 * a2 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r11, %%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r13\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax, %%r9\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx, %%r10\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r8\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax, %%r9\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx, %%r10\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r8\n&quot;</span>
<span class="term-fg31">-    &#47;* (r9,r10,r8) += a1 * a1 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r12, %%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r12\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax, %%r9\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx, %%r10\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r8\n&quot;</span>
<span class="term-fg31">-    &#47;* Extract l2 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r9, 16(%%rsi)\n&quot;</span>
<span class="term-fg31">-    &quot;xorq %%r9, %%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* (r10,r8,r9) += 2 * a0 * a3 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r11, %%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r14\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax, %%r10\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx, %%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r9\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax, %%r10\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx, %%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* (r10,r8,r9) += 2 * a1 * a2 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r12, %%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r13\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax, %%r10\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx, %%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r9\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax, %%r10\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx, %%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r9\n&quot;</span>
<span class="term-fg31">-    &#47;* Extract l3 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r10, 24(%%rsi)\n&quot;</span>
<span class="term-fg31">-    &quot;xorq %%r10, %%r10\n&quot;</span>
<span class="term-fg31">-    &#47;* (r8,r9,r10) += 2 * a1 * a3 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r12, %%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r14\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax, %%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx, %%r9\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r10\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax, %%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx, %%r9\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r10\n&quot;</span>
<span class="term-fg31">-    &#47;* (r8,r9,r10) += a2 * a2 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r13, %%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r13\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax, %%r8\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx, %%r9\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r10\n&quot;</span>
<span class="term-fg31">-    &#47;* Extract l4 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r8, 32(%%rsi)\n&quot;</span>
<span class="term-fg31">-    &quot;xorq %%r8, %%r8\n&quot;</span>
<span class="term-fg31">-    &#47;* (r9,r10,r8) += 2 * a2 * a3 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r13, %%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r14\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax, %%r9\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx, %%r10\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r8\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax, %%r9\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx, %%r10\n&quot;</span>
<span class="term-fg31">-    &quot;adcq $0, %%r8\n&quot;</span>
<span class="term-fg31">-    &#47;* Extract l5 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r9, 40(%%rsi)\n&quot;</span>
<span class="term-fg31">-    &#47;* (r10,r8) += a3 * a3 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r14, %%rax\n&quot;</span>
<span class="term-fg31">-    &quot;mulq %%r14\n&quot;</span>
<span class="term-fg31">-    &quot;addq %%rax, %%r10\n&quot;</span>
<span class="term-fg31">-    &quot;adcq %%rdx, %%r8\n&quot;</span>
<span class="term-fg31">-    &#47;* Extract l6 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r10, 48(%%rsi)\n&quot;</span>
<span class="term-fg31">-    &#47;* Extract l7 *&#47;</span>
<span class="term-fg31">-    &quot;movq %%r8, 56(%%rsi)\n&quot;</span>
<span class="term-fg31">-    :</span>
<span class="term-fg31">-    : &quot;S&quot;(l), &quot;D&quot;(a-&gt;d)</span>
<span class="term-fg31">-    : &quot;rax&quot;, &quot;rdx&quot;, &quot;r8&quot;, &quot;r9&quot;, &quot;r10&quot;, &quot;r11&quot;, &quot;r12&quot;, &quot;r13&quot;, &quot;r14&quot;, &quot;cc&quot;, &quot;memory&quot;);</span>
<span class="term-fg31">-#else</span>
<span class="term-fg31">-    &#47;* 160 bit accumulator. *&#47;</span>
<span class="term-fg31">-    uint64_t c0 = 0, c1 = 0;</span>
<span class="term-fg31">-    uint32_t c2 = 0;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* l[0..7] = a[0..3] * b[0..3]. *&#47;</span>
<span class="term-fg31">-    muladd_fast(a-&gt;d[0], a-&gt;d[0]);</span>
<span class="term-fg31">-    extract_fast(l[0]);</span>
<span class="term-fg31">-    muladd2(a-&gt;d[0], a-&gt;d[1]);</span>
<span class="term-fg31">-    extract(l[1]);</span>
<span class="term-fg31">-    muladd2(a-&gt;d[0], a-&gt;d[2]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[1], a-&gt;d[1]);</span>
<span class="term-fg31">-    extract(l[2]);</span>
<span class="term-fg31">-    muladd2(a-&gt;d[0], a-&gt;d[3]);</span>
<span class="term-fg31">-    muladd2(a-&gt;d[1], a-&gt;d[2]);</span>
<span class="term-fg31">-    extract(l[3]);</span>
<span class="term-fg31">-    muladd2(a-&gt;d[1], a-&gt;d[3]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[2], a-&gt;d[2]);</span>
<span class="term-fg31">-    extract(l[4]);</span>
<span class="term-fg31">-    muladd2(a-&gt;d[2], a-&gt;d[3]);</span>
<span class="term-fg31">-    extract(l[5]);</span>
<span class="term-fg31">-    muladd_fast(a-&gt;d[3], a-&gt;d[3]);</span>
<span class="term-fg31">-    extract_fast(l[6]);</span>
<span class="term-fg31">-    VERIFY_CHECK(c1 == 0);</span>
<span class="term-fg31">-    l[7] = c0;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#undef sumadd</span>
<span class="term-fg31">-#undef sumadd_fast</span>
<span class="term-fg31">-#undef muladd</span>
<span class="term-fg31">-#undef muladd_fast</span>
<span class="term-fg31">-#undef muladd2</span>
<span class="term-fg31">-#undef extract</span>
<span class="term-fg31">-#undef extract_fast</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_scalar_mul(secp256k1_scalar *r, const secp256k1_scalar *a, const secp256k1_scalar *b) {</span>
<span class="term-fg31">-    uint64_t l[8];</span>
<span class="term-fg31">-    secp256k1_scalar_mul_512(l, a, b);</span>
<span class="term-fg31">-    secp256k1_scalar_reduce_512(r, l);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_scalar_shr_int(secp256k1_scalar *r, int n) {</span>
<span class="term-fg31">-    int ret;</span>
<span class="term-fg31">-    VERIFY_CHECK(n &gt; 0);</span>
<span class="term-fg31">-    VERIFY_CHECK(n &lt; 16);</span>
<span class="term-fg31">-    ret = r-&gt;d[0] &amp; ((1 &lt;&lt; n) - 1);</span>
<span class="term-fg31">-    r-&gt;d[0] = (r-&gt;d[0] &gt;&gt; n) + (r-&gt;d[1] &lt;&lt; (64 - n));</span>
<span class="term-fg31">-    r-&gt;d[1] = (r-&gt;d[1] &gt;&gt; n) + (r-&gt;d[2] &lt;&lt; (64 - n));</span>
<span class="term-fg31">-    r-&gt;d[2] = (r-&gt;d[2] &gt;&gt; n) + (r-&gt;d[3] &lt;&lt; (64 - n));</span>
<span class="term-fg31">-    r-&gt;d[3] = (r-&gt;d[3] &gt;&gt; n);</span>
<span class="term-fg31">-    return ret;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_scalar_sqr(secp256k1_scalar *r, const secp256k1_scalar *a) {</span>
<span class="term-fg31">-    uint64_t l[8];</span>
<span class="term-fg31">-    secp256k1_scalar_sqr_512(l, a);</span>
<span class="term-fg31">-    secp256k1_scalar_reduce_512(r, l);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef USE_ENDOMORPHISM</span>
<span class="term-fg31">-static void secp256k1_scalar_split_128(secp256k1_scalar *r1, secp256k1_scalar *r2, const secp256k1_scalar *a) {</span>
<span class="term-fg31">-    r1-&gt;d[0] = a-&gt;d[0];</span>
<span class="term-fg31">-    r1-&gt;d[1] = a-&gt;d[1];</span>
<span class="term-fg31">-    r1-&gt;d[2] = 0;</span>
<span class="term-fg31">-    r1-&gt;d[3] = 0;</span>
<span class="term-fg31">-    r2-&gt;d[0] = a-&gt;d[2];</span>
<span class="term-fg31">-    r2-&gt;d[1] = a-&gt;d[3];</span>
<span class="term-fg31">-    r2-&gt;d[2] = 0;</span>
<span class="term-fg31">-    r2-&gt;d[3] = 0;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static int secp256k1_scalar_eq(const secp256k1_scalar *a, const secp256k1_scalar *b) {</span>
<span class="term-fg31">-    return ((a-&gt;d[0] ^ b-&gt;d[0]) | (a-&gt;d[1] ^ b-&gt;d[1]) | (a-&gt;d[2] ^ b-&gt;d[2]) | (a-&gt;d[3] ^ b-&gt;d[3])) == 0;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static void secp256k1_scalar_mul_shift_var(secp256k1_scalar *r, const secp256k1_scalar *a, const secp256k1_scalar *b, unsigned int shift) {</span>
<span class="term-fg31">-    uint64_t l[8];</span>
<span class="term-fg31">-    unsigned int shiftlimbs;</span>
<span class="term-fg31">-    unsigned int shiftlow;</span>
<span class="term-fg31">-    unsigned int shifthigh;</span>
<span class="term-fg31">-    VERIFY_CHECK(shift &gt;= 256);</span>
<span class="term-fg31">-    secp256k1_scalar_mul_512(l, a, b);</span>
<span class="term-fg31">-    shiftlimbs = shift &gt;&gt; 6;</span>
<span class="term-fg31">-    shiftlow = shift &amp; 0x3F;</span>
<span class="term-fg31">-    shifthigh = 64 - shiftlow;</span>
<span class="term-fg31">-    r-&gt;d[0] = shift &lt; 512 ? (l[0 + shiftlimbs] &gt;&gt; shiftlow | (shift &lt; 448 &amp;&amp; shiftlow ? (l[1 + shiftlimbs] &lt;&lt; shifthigh) : 0)) : 0;</span>
<span class="term-fg31">-    r-&gt;d[1] = shift &lt; 448 ? (l[1 + shiftlimbs] &gt;&gt; shiftlow | (shift &lt; 384 &amp;&amp; shiftlow ? (l[2 + shiftlimbs] &lt;&lt; shifthigh) : 0)) : 0;</span>
<span class="term-fg31">-    r-&gt;d[2] = shift &lt; 384 ? (l[2 + shiftlimbs] &gt;&gt; shiftlow | (shift &lt; 320 &amp;&amp; shiftlow ? (l[3 + shiftlimbs] &lt;&lt; shifthigh) : 0)) : 0;</span>
<span class="term-fg31">-    r-&gt;d[3] = shift &lt; 320 ? (l[3 + shiftlimbs] &gt;&gt; shiftlow) : 0;</span>
<span class="term-fg31">-    secp256k1_scalar_cadd_bit(r, 0, (l[(shift - 1) &gt;&gt; 6] &gt;&gt; ((shift - 1) &amp; 0x3f)) &amp; 1);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-3772b7368b6983258501a2d8" role="button"
                       aria-expanded="false" aria-controls="id-3772b7368b6983258501a2d8">
                        <code>crypto/secp256k1/libsecp256k1/src/scalar_8x32.h</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/scalar_8x32.h" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-19</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-3772b7368b6983258501a2d8"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;scalar_8x32.h op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;scalar_8x32.h</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 1319664f654994b79cf1d50e18eb1fcd8e0026f5..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;scalar_8x32.h</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,19 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2014 Pieter Wuille                                   *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef _SECP256K1_SCALAR_REPR_</span>
<span class="term-fg31">-#define _SECP256K1_SCALAR_REPR_</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &lt;stdint.h&gt;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** A scalar modulo the group order of the secp256k1 curve. *&#47;</span>
<span class="term-fg31">-typedef struct {</span>
<span class="term-fg31">-    uint32_t d[8];</span>
<span class="term-fg31">-} secp256k1_scalar;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#define SECP256K1_SCALAR_CONST(d7, d6, d5, d4, d3, d2, d1, d0) {{(d0), (d1), (d2), (d3), (d4), (d5), (d6), (d7)}}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-03fd3af7bf89fecc9fc5d554" role="button"
                       aria-expanded="false" aria-controls="id-03fd3af7bf89fecc9fc5d554">
                        <code>crypto/secp256k1/libsecp256k1/src/scalar_8x32_impl.h</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/scalar_8x32_impl.h" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-721</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-03fd3af7bf89fecc9fc5d554"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;scalar_8x32_impl.h op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;scalar_8x32_impl.h</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index aae4f35c0856eb3bd0a1fd35d572a461bb0c7a35..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;scalar_8x32_impl.h</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,721 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2014 Pieter Wuille                                   *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef _SECP256K1_SCALAR_REPR_IMPL_H_</span>
<span class="term-fg31">-#define _SECP256K1_SCALAR_REPR_IMPL_H_</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;* Limbs of the secp256k1 order. *&#47;</span>
<span class="term-fg31">-#define SECP256K1_N_0 ((uint32_t)0xD0364141UL)</span>
<span class="term-fg31">-#define SECP256K1_N_1 ((uint32_t)0xBFD25E8CUL)</span>
<span class="term-fg31">-#define SECP256K1_N_2 ((uint32_t)0xAF48A03BUL)</span>
<span class="term-fg31">-#define SECP256K1_N_3 ((uint32_t)0xBAAEDCE6UL)</span>
<span class="term-fg31">-#define SECP256K1_N_4 ((uint32_t)0xFFFFFFFEUL)</span>
<span class="term-fg31">-#define SECP256K1_N_5 ((uint32_t)0xFFFFFFFFUL)</span>
<span class="term-fg31">-#define SECP256K1_N_6 ((uint32_t)0xFFFFFFFFUL)</span>
<span class="term-fg31">-#define SECP256K1_N_7 ((uint32_t)0xFFFFFFFFUL)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;* Limbs of 2^256 minus the secp256k1 order. *&#47;</span>
<span class="term-fg31">-#define SECP256K1_N_C_0 (~SECP256K1_N_0 + 1)</span>
<span class="term-fg31">-#define SECP256K1_N_C_1 (~SECP256K1_N_1)</span>
<span class="term-fg31">-#define SECP256K1_N_C_2 (~SECP256K1_N_2)</span>
<span class="term-fg31">-#define SECP256K1_N_C_3 (~SECP256K1_N_3)</span>
<span class="term-fg31">-#define SECP256K1_N_C_4 (1)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;* Limbs of half the secp256k1 order. *&#47;</span>
<span class="term-fg31">-#define SECP256K1_N_H_0 ((uint32_t)0x681B20A0UL)</span>
<span class="term-fg31">-#define SECP256K1_N_H_1 ((uint32_t)0xDFE92F46UL)</span>
<span class="term-fg31">-#define SECP256K1_N_H_2 ((uint32_t)0x57A4501DUL)</span>
<span class="term-fg31">-#define SECP256K1_N_H_3 ((uint32_t)0x5D576E73UL)</span>
<span class="term-fg31">-#define SECP256K1_N_H_4 ((uint32_t)0xFFFFFFFFUL)</span>
<span class="term-fg31">-#define SECP256K1_N_H_5 ((uint32_t)0xFFFFFFFFUL)</span>
<span class="term-fg31">-#define SECP256K1_N_H_6 ((uint32_t)0xFFFFFFFFUL)</span>
<span class="term-fg31">-#define SECP256K1_N_H_7 ((uint32_t)0x7FFFFFFFUL)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static void secp256k1_scalar_clear(secp256k1_scalar *r) {</span>
<span class="term-fg31">-    r-&gt;d[0] = 0;</span>
<span class="term-fg31">-    r-&gt;d[1] = 0;</span>
<span class="term-fg31">-    r-&gt;d[2] = 0;</span>
<span class="term-fg31">-    r-&gt;d[3] = 0;</span>
<span class="term-fg31">-    r-&gt;d[4] = 0;</span>
<span class="term-fg31">-    r-&gt;d[5] = 0;</span>
<span class="term-fg31">-    r-&gt;d[6] = 0;</span>
<span class="term-fg31">-    r-&gt;d[7] = 0;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static void secp256k1_scalar_set_int(secp256k1_scalar *r, unsigned int v) {</span>
<span class="term-fg31">-    r-&gt;d[0] = v;</span>
<span class="term-fg31">-    r-&gt;d[1] = 0;</span>
<span class="term-fg31">-    r-&gt;d[2] = 0;</span>
<span class="term-fg31">-    r-&gt;d[3] = 0;</span>
<span class="term-fg31">-    r-&gt;d[4] = 0;</span>
<span class="term-fg31">-    r-&gt;d[5] = 0;</span>
<span class="term-fg31">-    r-&gt;d[6] = 0;</span>
<span class="term-fg31">-    r-&gt;d[7] = 0;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static unsigned int secp256k1_scalar_get_bits(const secp256k1_scalar *a, unsigned int offset, unsigned int count) {</span>
<span class="term-fg31">-    VERIFY_CHECK((offset + count - 1) &gt;&gt; 5 == offset &gt;&gt; 5);</span>
<span class="term-fg31">-    return (a-&gt;d[offset &gt;&gt; 5] &gt;&gt; (offset &amp; 0x1F)) &amp; ((1 &lt;&lt; count) - 1);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static unsigned int secp256k1_scalar_get_bits_var(const secp256k1_scalar *a, unsigned int offset, unsigned int count) {</span>
<span class="term-fg31">-    VERIFY_CHECK(count &lt; 32);</span>
<span class="term-fg31">-    VERIFY_CHECK(offset + count &lt;= 256);</span>
<span class="term-fg31">-    if ((offset + count - 1) &gt;&gt; 5 == offset &gt;&gt; 5) {</span>
<span class="term-fg31">-        return secp256k1_scalar_get_bits(a, offset, count);</span>
<span class="term-fg31">-    } else {</span>
<span class="term-fg31">-        VERIFY_CHECK((offset &gt;&gt; 5) + 1 &lt; 8);</span>
<span class="term-fg31">-        return ((a-&gt;d[offset &gt;&gt; 5] &gt;&gt; (offset &amp; 0x1F)) | (a-&gt;d[(offset &gt;&gt; 5) + 1] &lt;&lt; (32 - (offset &amp; 0x1F)))) &amp; ((((uint32_t)1) &lt;&lt; count) - 1);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static int secp256k1_scalar_check_overflow(const secp256k1_scalar *a) {</span>
<span class="term-fg31">-    int yes = 0;</span>
<span class="term-fg31">-    int no = 0;</span>
<span class="term-fg31">-    no |= (a-&gt;d[7] &lt; SECP256K1_N_7); &#47;* No need for a &gt; check. *&#47;</span>
<span class="term-fg31">-    no |= (a-&gt;d[6] &lt; SECP256K1_N_6); &#47;* No need for a &gt; check. *&#47;</span>
<span class="term-fg31">-    no |= (a-&gt;d[5] &lt; SECP256K1_N_5); &#47;* No need for a &gt; check. *&#47;</span>
<span class="term-fg31">-    no |= (a-&gt;d[4] &lt; SECP256K1_N_4);</span>
<span class="term-fg31">-    yes |= (a-&gt;d[4] &gt; SECP256K1_N_4) &amp; ~no;</span>
<span class="term-fg31">-    no |= (a-&gt;d[3] &lt; SECP256K1_N_3) &amp; ~yes;</span>
<span class="term-fg31">-    yes |= (a-&gt;d[3] &gt; SECP256K1_N_3) &amp; ~no;</span>
<span class="term-fg31">-    no |= (a-&gt;d[2] &lt; SECP256K1_N_2) &amp; ~yes;</span>
<span class="term-fg31">-    yes |= (a-&gt;d[2] &gt; SECP256K1_N_2) &amp; ~no;</span>
<span class="term-fg31">-    no |= (a-&gt;d[1] &lt; SECP256K1_N_1) &amp; ~yes;</span>
<span class="term-fg31">-    yes |= (a-&gt;d[1] &gt; SECP256K1_N_1) &amp; ~no;</span>
<span class="term-fg31">-    yes |= (a-&gt;d[0] &gt;= SECP256K1_N_0) &amp; ~no;</span>
<span class="term-fg31">-    return yes;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static int secp256k1_scalar_reduce(secp256k1_scalar *r, uint32_t overflow) {</span>
<span class="term-fg31">-    uint64_t t;</span>
<span class="term-fg31">-    VERIFY_CHECK(overflow &lt;= 1);</span>
<span class="term-fg31">-    t = (uint64_t)r-&gt;d[0] + overflow * SECP256K1_N_C_0;</span>
<span class="term-fg31">-    r-&gt;d[0] = t &amp; 0xFFFFFFFFUL; t &gt;&gt;= 32;</span>
<span class="term-fg31">-    t += (uint64_t)r-&gt;d[1] + overflow * SECP256K1_N_C_1;</span>
<span class="term-fg31">-    r-&gt;d[1] = t &amp; 0xFFFFFFFFUL; t &gt;&gt;= 32;</span>
<span class="term-fg31">-    t += (uint64_t)r-&gt;d[2] + overflow * SECP256K1_N_C_2;</span>
<span class="term-fg31">-    r-&gt;d[2] = t &amp; 0xFFFFFFFFUL; t &gt;&gt;= 32;</span>
<span class="term-fg31">-    t += (uint64_t)r-&gt;d[3] + overflow * SECP256K1_N_C_3;</span>
<span class="term-fg31">-    r-&gt;d[3] = t &amp; 0xFFFFFFFFUL; t &gt;&gt;= 32;</span>
<span class="term-fg31">-    t += (uint64_t)r-&gt;d[4] + overflow * SECP256K1_N_C_4;</span>
<span class="term-fg31">-    r-&gt;d[4] = t &amp; 0xFFFFFFFFUL; t &gt;&gt;= 32;</span>
<span class="term-fg31">-    t += (uint64_t)r-&gt;d[5];</span>
<span class="term-fg31">-    r-&gt;d[5] = t &amp; 0xFFFFFFFFUL; t &gt;&gt;= 32;</span>
<span class="term-fg31">-    t += (uint64_t)r-&gt;d[6];</span>
<span class="term-fg31">-    r-&gt;d[6] = t &amp; 0xFFFFFFFFUL; t &gt;&gt;= 32;</span>
<span class="term-fg31">-    t += (uint64_t)r-&gt;d[7];</span>
<span class="term-fg31">-    r-&gt;d[7] = t &amp; 0xFFFFFFFFUL;</span>
<span class="term-fg31">-    return overflow;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_scalar_add(secp256k1_scalar *r, const secp256k1_scalar *a, const secp256k1_scalar *b) {</span>
<span class="term-fg31">-    int overflow;</span>
<span class="term-fg31">-    uint64_t t = (uint64_t)a-&gt;d[0] + b-&gt;d[0];</span>
<span class="term-fg31">-    r-&gt;d[0] = t &amp; 0xFFFFFFFFULL; t &gt;&gt;= 32;</span>
<span class="term-fg31">-    t += (uint64_t)a-&gt;d[1] + b-&gt;d[1];</span>
<span class="term-fg31">-    r-&gt;d[1] = t &amp; 0xFFFFFFFFULL; t &gt;&gt;= 32;</span>
<span class="term-fg31">-    t += (uint64_t)a-&gt;d[2] + b-&gt;d[2];</span>
<span class="term-fg31">-    r-&gt;d[2] = t &amp; 0xFFFFFFFFULL; t &gt;&gt;= 32;</span>
<span class="term-fg31">-    t += (uint64_t)a-&gt;d[3] + b-&gt;d[3];</span>
<span class="term-fg31">-    r-&gt;d[3] = t &amp; 0xFFFFFFFFULL; t &gt;&gt;= 32;</span>
<span class="term-fg31">-    t += (uint64_t)a-&gt;d[4] + b-&gt;d[4];</span>
<span class="term-fg31">-    r-&gt;d[4] = t &amp; 0xFFFFFFFFULL; t &gt;&gt;= 32;</span>
<span class="term-fg31">-    t += (uint64_t)a-&gt;d[5] + b-&gt;d[5];</span>
<span class="term-fg31">-    r-&gt;d[5] = t &amp; 0xFFFFFFFFULL; t &gt;&gt;= 32;</span>
<span class="term-fg31">-    t += (uint64_t)a-&gt;d[6] + b-&gt;d[6];</span>
<span class="term-fg31">-    r-&gt;d[6] = t &amp; 0xFFFFFFFFULL; t &gt;&gt;= 32;</span>
<span class="term-fg31">-    t += (uint64_t)a-&gt;d[7] + b-&gt;d[7];</span>
<span class="term-fg31">-    r-&gt;d[7] = t &amp; 0xFFFFFFFFULL; t &gt;&gt;= 32;</span>
<span class="term-fg31">-    overflow = t + secp256k1_scalar_check_overflow(r);</span>
<span class="term-fg31">-    VERIFY_CHECK(overflow == 0 || overflow == 1);</span>
<span class="term-fg31">-    secp256k1_scalar_reduce(r, overflow);</span>
<span class="term-fg31">-    return overflow;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_scalar_cadd_bit(secp256k1_scalar *r, unsigned int bit, int flag) {</span>
<span class="term-fg31">-    uint64_t t;</span>
<span class="term-fg31">-    VERIFY_CHECK(bit &lt; 256);</span>
<span class="term-fg31">-    bit += ((uint32_t) flag - 1) &amp; 0x100;  &#47;* forcing (bit &gt;&gt; 5) &gt; 7 makes this a noop *&#47;</span>
<span class="term-fg31">-    t = (uint64_t)r-&gt;d[0] + (((uint32_t)((bit &gt;&gt; 5) == 0)) &lt;&lt; (bit &amp; 0x1F));</span>
<span class="term-fg31">-    r-&gt;d[0] = t &amp; 0xFFFFFFFFULL; t &gt;&gt;= 32;</span>
<span class="term-fg31">-    t += (uint64_t)r-&gt;d[1] + (((uint32_t)((bit &gt;&gt; 5) == 1)) &lt;&lt; (bit &amp; 0x1F));</span>
<span class="term-fg31">-    r-&gt;d[1] = t &amp; 0xFFFFFFFFULL; t &gt;&gt;= 32;</span>
<span class="term-fg31">-    t += (uint64_t)r-&gt;d[2] + (((uint32_t)((bit &gt;&gt; 5) == 2)) &lt;&lt; (bit &amp; 0x1F));</span>
<span class="term-fg31">-    r-&gt;d[2] = t &amp; 0xFFFFFFFFULL; t &gt;&gt;= 32;</span>
<span class="term-fg31">-    t += (uint64_t)r-&gt;d[3] + (((uint32_t)((bit &gt;&gt; 5) == 3)) &lt;&lt; (bit &amp; 0x1F));</span>
<span class="term-fg31">-    r-&gt;d[3] = t &amp; 0xFFFFFFFFULL; t &gt;&gt;= 32;</span>
<span class="term-fg31">-    t += (uint64_t)r-&gt;d[4] + (((uint32_t)((bit &gt;&gt; 5) == 4)) &lt;&lt; (bit &amp; 0x1F));</span>
<span class="term-fg31">-    r-&gt;d[4] = t &amp; 0xFFFFFFFFULL; t &gt;&gt;= 32;</span>
<span class="term-fg31">-    t += (uint64_t)r-&gt;d[5] + (((uint32_t)((bit &gt;&gt; 5) == 5)) &lt;&lt; (bit &amp; 0x1F));</span>
<span class="term-fg31">-    r-&gt;d[5] = t &amp; 0xFFFFFFFFULL; t &gt;&gt;= 32;</span>
<span class="term-fg31">-    t += (uint64_t)r-&gt;d[6] + (((uint32_t)((bit &gt;&gt; 5) == 6)) &lt;&lt; (bit &amp; 0x1F));</span>
<span class="term-fg31">-    r-&gt;d[6] = t &amp; 0xFFFFFFFFULL; t &gt;&gt;= 32;</span>
<span class="term-fg31">-    t += (uint64_t)r-&gt;d[7] + (((uint32_t)((bit &gt;&gt; 5) == 7)) &lt;&lt; (bit &amp; 0x1F));</span>
<span class="term-fg31">-    r-&gt;d[7] = t &amp; 0xFFFFFFFFULL;</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-    VERIFY_CHECK((t &gt;&gt; 32) == 0);</span>
<span class="term-fg31">-    VERIFY_CHECK(secp256k1_scalar_check_overflow(r) == 0);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_scalar_set_b32(secp256k1_scalar *r, const unsigned char *b32, int *overflow) {</span>
<span class="term-fg31">-    int over;</span>
<span class="term-fg31">-    r-&gt;d[0] = (uint32_t)b32[31] | (uint32_t)b32[30] &lt;&lt; 8 | (uint32_t)b32[29] &lt;&lt; 16 | (uint32_t)b32[28] &lt;&lt; 24;</span>
<span class="term-fg31">-    r-&gt;d[1] = (uint32_t)b32[27] | (uint32_t)b32[26] &lt;&lt; 8 | (uint32_t)b32[25] &lt;&lt; 16 | (uint32_t)b32[24] &lt;&lt; 24;</span>
<span class="term-fg31">-    r-&gt;d[2] = (uint32_t)b32[23] | (uint32_t)b32[22] &lt;&lt; 8 | (uint32_t)b32[21] &lt;&lt; 16 | (uint32_t)b32[20] &lt;&lt; 24;</span>
<span class="term-fg31">-    r-&gt;d[3] = (uint32_t)b32[19] | (uint32_t)b32[18] &lt;&lt; 8 | (uint32_t)b32[17] &lt;&lt; 16 | (uint32_t)b32[16] &lt;&lt; 24;</span>
<span class="term-fg31">-    r-&gt;d[4] = (uint32_t)b32[15] | (uint32_t)b32[14] &lt;&lt; 8 | (uint32_t)b32[13] &lt;&lt; 16 | (uint32_t)b32[12] &lt;&lt; 24;</span>
<span class="term-fg31">-    r-&gt;d[5] = (uint32_t)b32[11] | (uint32_t)b32[10] &lt;&lt; 8 | (uint32_t)b32[9] &lt;&lt; 16 | (uint32_t)b32[8] &lt;&lt; 24;</span>
<span class="term-fg31">-    r-&gt;d[6] = (uint32_t)b32[7] | (uint32_t)b32[6] &lt;&lt; 8 | (uint32_t)b32[5] &lt;&lt; 16 | (uint32_t)b32[4] &lt;&lt; 24;</span>
<span class="term-fg31">-    r-&gt;d[7] = (uint32_t)b32[3] | (uint32_t)b32[2] &lt;&lt; 8 | (uint32_t)b32[1] &lt;&lt; 16 | (uint32_t)b32[0] &lt;&lt; 24;</span>
<span class="term-fg31">-    over = secp256k1_scalar_reduce(r, secp256k1_scalar_check_overflow(r));</span>
<span class="term-fg31">-    if (overflow) {</span>
<span class="term-fg31">-        *overflow = over;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_scalar_get_b32(unsigned char *bin, const secp256k1_scalar* a) {</span>
<span class="term-fg31">-    bin[0] = a-&gt;d[7] &gt;&gt; 24; bin[1] = a-&gt;d[7] &gt;&gt; 16; bin[2] = a-&gt;d[7] &gt;&gt; 8; bin[3] = a-&gt;d[7];</span>
<span class="term-fg31">-    bin[4] = a-&gt;d[6] &gt;&gt; 24; bin[5] = a-&gt;d[6] &gt;&gt; 16; bin[6] = a-&gt;d[6] &gt;&gt; 8; bin[7] = a-&gt;d[6];</span>
<span class="term-fg31">-    bin[8] = a-&gt;d[5] &gt;&gt; 24; bin[9] = a-&gt;d[5] &gt;&gt; 16; bin[10] = a-&gt;d[5] &gt;&gt; 8; bin[11] = a-&gt;d[5];</span>
<span class="term-fg31">-    bin[12] = a-&gt;d[4] &gt;&gt; 24; bin[13] = a-&gt;d[4] &gt;&gt; 16; bin[14] = a-&gt;d[4] &gt;&gt; 8; bin[15] = a-&gt;d[4];</span>
<span class="term-fg31">-    bin[16] = a-&gt;d[3] &gt;&gt; 24; bin[17] = a-&gt;d[3] &gt;&gt; 16; bin[18] = a-&gt;d[3] &gt;&gt; 8; bin[19] = a-&gt;d[3];</span>
<span class="term-fg31">-    bin[20] = a-&gt;d[2] &gt;&gt; 24; bin[21] = a-&gt;d[2] &gt;&gt; 16; bin[22] = a-&gt;d[2] &gt;&gt; 8; bin[23] = a-&gt;d[2];</span>
<span class="term-fg31">-    bin[24] = a-&gt;d[1] &gt;&gt; 24; bin[25] = a-&gt;d[1] &gt;&gt; 16; bin[26] = a-&gt;d[1] &gt;&gt; 8; bin[27] = a-&gt;d[1];</span>
<span class="term-fg31">-    bin[28] = a-&gt;d[0] &gt;&gt; 24; bin[29] = a-&gt;d[0] &gt;&gt; 16; bin[30] = a-&gt;d[0] &gt;&gt; 8; bin[31] = a-&gt;d[0];</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static int secp256k1_scalar_is_zero(const secp256k1_scalar *a) {</span>
<span class="term-fg31">-    return (a-&gt;d[0] | a-&gt;d[1] | a-&gt;d[2] | a-&gt;d[3] | a-&gt;d[4] | a-&gt;d[5] | a-&gt;d[6] | a-&gt;d[7]) == 0;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_scalar_negate(secp256k1_scalar *r, const secp256k1_scalar *a) {</span>
<span class="term-fg31">-    uint32_t nonzero = 0xFFFFFFFFUL * (secp256k1_scalar_is_zero(a) == 0);</span>
<span class="term-fg31">-    uint64_t t = (uint64_t)(~a-&gt;d[0]) + SECP256K1_N_0 + 1;</span>
<span class="term-fg31">-    r-&gt;d[0] = t &amp; nonzero; t &gt;&gt;= 32;</span>
<span class="term-fg31">-    t += (uint64_t)(~a-&gt;d[1]) + SECP256K1_N_1;</span>
<span class="term-fg31">-    r-&gt;d[1] = t &amp; nonzero; t &gt;&gt;= 32;</span>
<span class="term-fg31">-    t += (uint64_t)(~a-&gt;d[2]) + SECP256K1_N_2;</span>
<span class="term-fg31">-    r-&gt;d[2] = t &amp; nonzero; t &gt;&gt;= 32;</span>
<span class="term-fg31">-    t += (uint64_t)(~a-&gt;d[3]) + SECP256K1_N_3;</span>
<span class="term-fg31">-    r-&gt;d[3] = t &amp; nonzero; t &gt;&gt;= 32;</span>
<span class="term-fg31">-    t += (uint64_t)(~a-&gt;d[4]) + SECP256K1_N_4;</span>
<span class="term-fg31">-    r-&gt;d[4] = t &amp; nonzero; t &gt;&gt;= 32;</span>
<span class="term-fg31">-    t += (uint64_t)(~a-&gt;d[5]) + SECP256K1_N_5;</span>
<span class="term-fg31">-    r-&gt;d[5] = t &amp; nonzero; t &gt;&gt;= 32;</span>
<span class="term-fg31">-    t += (uint64_t)(~a-&gt;d[6]) + SECP256K1_N_6;</span>
<span class="term-fg31">-    r-&gt;d[6] = t &amp; nonzero; t &gt;&gt;= 32;</span>
<span class="term-fg31">-    t += (uint64_t)(~a-&gt;d[7]) + SECP256K1_N_7;</span>
<span class="term-fg31">-    r-&gt;d[7] = t &amp; nonzero;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static int secp256k1_scalar_is_one(const secp256k1_scalar *a) {</span>
<span class="term-fg31">-    return ((a-&gt;d[0] ^ 1) | a-&gt;d[1] | a-&gt;d[2] | a-&gt;d[3] | a-&gt;d[4] | a-&gt;d[5] | a-&gt;d[6] | a-&gt;d[7]) == 0;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_scalar_is_high(const secp256k1_scalar *a) {</span>
<span class="term-fg31">-    int yes = 0;</span>
<span class="term-fg31">-    int no = 0;</span>
<span class="term-fg31">-    no |= (a-&gt;d[7] &lt; SECP256K1_N_H_7);</span>
<span class="term-fg31">-    yes |= (a-&gt;d[7] &gt; SECP256K1_N_H_7) &amp; ~no;</span>
<span class="term-fg31">-    no |= (a-&gt;d[6] &lt; SECP256K1_N_H_6) &amp; ~yes; &#47;* No need for a &gt; check. *&#47;</span>
<span class="term-fg31">-    no |= (a-&gt;d[5] &lt; SECP256K1_N_H_5) &amp; ~yes; &#47;* No need for a &gt; check. *&#47;</span>
<span class="term-fg31">-    no |= (a-&gt;d[4] &lt; SECP256K1_N_H_4) &amp; ~yes; &#47;* No need for a &gt; check. *&#47;</span>
<span class="term-fg31">-    no |= (a-&gt;d[3] &lt; SECP256K1_N_H_3) &amp; ~yes;</span>
<span class="term-fg31">-    yes |= (a-&gt;d[3] &gt; SECP256K1_N_H_3) &amp; ~no;</span>
<span class="term-fg31">-    no |= (a-&gt;d[2] &lt; SECP256K1_N_H_2) &amp; ~yes;</span>
<span class="term-fg31">-    yes |= (a-&gt;d[2] &gt; SECP256K1_N_H_2) &amp; ~no;</span>
<span class="term-fg31">-    no |= (a-&gt;d[1] &lt; SECP256K1_N_H_1) &amp; ~yes;</span>
<span class="term-fg31">-    yes |= (a-&gt;d[1] &gt; SECP256K1_N_H_1) &amp; ~no;</span>
<span class="term-fg31">-    yes |= (a-&gt;d[0] &gt; SECP256K1_N_H_0) &amp; ~no;</span>
<span class="term-fg31">-    return yes;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_scalar_cond_negate(secp256k1_scalar *r, int flag) {</span>
<span class="term-fg31">-    &#47;* If we are flag = 0, mask = 00...00 and this is a no-op;</span>
<span class="term-fg31">-     * if we are flag = 1, mask = 11...11 and this is identical to secp256k1_scalar_negate *&#47;</span>
<span class="term-fg31">-    uint32_t mask = !flag - 1;</span>
<span class="term-fg31">-    uint32_t nonzero = 0xFFFFFFFFUL * (secp256k1_scalar_is_zero(r) == 0);</span>
<span class="term-fg31">-    uint64_t t = (uint64_t)(r-&gt;d[0] ^ mask) + ((SECP256K1_N_0 + 1) &amp; mask);</span>
<span class="term-fg31">-    r-&gt;d[0] = t &amp; nonzero; t &gt;&gt;= 32;</span>
<span class="term-fg31">-    t += (uint64_t)(r-&gt;d[1] ^ mask) + (SECP256K1_N_1 &amp; mask);</span>
<span class="term-fg31">-    r-&gt;d[1] = t &amp; nonzero; t &gt;&gt;= 32;</span>
<span class="term-fg31">-    t += (uint64_t)(r-&gt;d[2] ^ mask) + (SECP256K1_N_2 &amp; mask);</span>
<span class="term-fg31">-    r-&gt;d[2] = t &amp; nonzero; t &gt;&gt;= 32;</span>
<span class="term-fg31">-    t += (uint64_t)(r-&gt;d[3] ^ mask) + (SECP256K1_N_3 &amp; mask);</span>
<span class="term-fg31">-    r-&gt;d[3] = t &amp; nonzero; t &gt;&gt;= 32;</span>
<span class="term-fg31">-    t += (uint64_t)(r-&gt;d[4] ^ mask) + (SECP256K1_N_4 &amp; mask);</span>
<span class="term-fg31">-    r-&gt;d[4] = t &amp; nonzero; t &gt;&gt;= 32;</span>
<span class="term-fg31">-    t += (uint64_t)(r-&gt;d[5] ^ mask) + (SECP256K1_N_5 &amp; mask);</span>
<span class="term-fg31">-    r-&gt;d[5] = t &amp; nonzero; t &gt;&gt;= 32;</span>
<span class="term-fg31">-    t += (uint64_t)(r-&gt;d[6] ^ mask) + (SECP256K1_N_6 &amp; mask);</span>
<span class="term-fg31">-    r-&gt;d[6] = t &amp; nonzero; t &gt;&gt;= 32;</span>
<span class="term-fg31">-    t += (uint64_t)(r-&gt;d[7] ^ mask) + (SECP256K1_N_7 &amp; mask);</span>
<span class="term-fg31">-    r-&gt;d[7] = t &amp; nonzero;</span>
<span class="term-fg31">-    return 2 * (mask == 0) - 1;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;* Inspired by the macros in OpenSSL&#39;s crypto&#47;bn&#47;asm&#47;x86_64-gcc.c. *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Add a*b to the number defined by (c0,c1,c2). c2 must never overflow. *&#47;</span>
<span class="term-fg31">-#define muladd(a,b) { \</span>
<span class="term-fg31">-    uint32_t tl, th; \</span>
<span class="term-fg31">-    { \</span>
<span class="term-fg31">-        uint64_t t = (uint64_t)a * b; \</span>
<span class="term-fg31">-        th = t &gt;&gt; 32;         &#47;* at most 0xFFFFFFFE *&#47; \</span>
<span class="term-fg31">-        tl = t; \</span>
<span class="term-fg31">-    } \</span>
<span class="term-fg31">-    c0 += tl;                 &#47;* overflow is handled on the next line *&#47; \</span>
<span class="term-fg31">-    th += (c0 &lt; tl) ? 1 : 0;  &#47;* at most 0xFFFFFFFF *&#47; \</span>
<span class="term-fg31">-    c1 += th;                 &#47;* overflow is handled on the next line *&#47; \</span>
<span class="term-fg31">-    c2 += (c1 &lt; th) ? 1 : 0;  &#47;* never overflows by contract (verified in the next line) *&#47; \</span>
<span class="term-fg31">-    VERIFY_CHECK((c1 &gt;= th) || (c2 != 0)); \</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Add a*b to the number defined by (c0,c1). c1 must never overflow. *&#47;</span>
<span class="term-fg31">-#define muladd_fast(a,b) { \</span>
<span class="term-fg31">-    uint32_t tl, th; \</span>
<span class="term-fg31">-    { \</span>
<span class="term-fg31">-        uint64_t t = (uint64_t)a * b; \</span>
<span class="term-fg31">-        th = t &gt;&gt; 32;         &#47;* at most 0xFFFFFFFE *&#47; \</span>
<span class="term-fg31">-        tl = t; \</span>
<span class="term-fg31">-    } \</span>
<span class="term-fg31">-    c0 += tl;                 &#47;* overflow is handled on the next line *&#47; \</span>
<span class="term-fg31">-    th += (c0 &lt; tl) ? 1 : 0;  &#47;* at most 0xFFFFFFFF *&#47; \</span>
<span class="term-fg31">-    c1 += th;                 &#47;* never overflows by contract (verified in the next line) *&#47; \</span>
<span class="term-fg31">-    VERIFY_CHECK(c1 &gt;= th); \</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Add 2*a*b to the number defined by (c0,c1,c2). c2 must never overflow. *&#47;</span>
<span class="term-fg31">-#define muladd2(a,b) { \</span>
<span class="term-fg31">-    uint32_t tl, th, th2, tl2; \</span>
<span class="term-fg31">-    { \</span>
<span class="term-fg31">-        uint64_t t = (uint64_t)a * b; \</span>
<span class="term-fg31">-        th = t &gt;&gt; 32;               &#47;* at most 0xFFFFFFFE *&#47; \</span>
<span class="term-fg31">-        tl = t; \</span>
<span class="term-fg31">-    } \</span>
<span class="term-fg31">-    th2 = th + th;                  &#47;* at most 0xFFFFFFFE (in case th was 0x7FFFFFFF) *&#47; \</span>
<span class="term-fg31">-    c2 += (th2 &lt; th) ? 1 : 0;       &#47;* never overflows by contract (verified the next line) *&#47; \</span>
<span class="term-fg31">-    VERIFY_CHECK((th2 &gt;= th) || (c2 != 0)); \</span>
<span class="term-fg31">-    tl2 = tl + tl;                  &#47;* at most 0xFFFFFFFE (in case the lowest 63 bits of tl were 0x7FFFFFFF) *&#47; \</span>
<span class="term-fg31">-    th2 += (tl2 &lt; tl) ? 1 : 0;      &#47;* at most 0xFFFFFFFF *&#47; \</span>
<span class="term-fg31">-    c0 += tl2;                      &#47;* overflow is handled on the next line *&#47; \</span>
<span class="term-fg31">-    th2 += (c0 &lt; tl2) ? 1 : 0;      &#47;* second overflow is handled on the next line *&#47; \</span>
<span class="term-fg31">-    c2 += (c0 &lt; tl2) &amp; (th2 == 0);  &#47;* never overflows by contract (verified the next line) *&#47; \</span>
<span class="term-fg31">-    VERIFY_CHECK((c0 &gt;= tl2) || (th2 != 0) || (c2 != 0)); \</span>
<span class="term-fg31">-    c1 += th2;                      &#47;* overflow is handled on the next line *&#47; \</span>
<span class="term-fg31">-    c2 += (c1 &lt; th2) ? 1 : 0;       &#47;* never overflows by contract (verified the next line) *&#47; \</span>
<span class="term-fg31">-    VERIFY_CHECK((c1 &gt;= th2) || (c2 != 0)); \</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Add a to the number defined by (c0,c1,c2). c2 must never overflow. *&#47;</span>
<span class="term-fg31">-#define sumadd(a) { \</span>
<span class="term-fg31">-    unsigned int over; \</span>
<span class="term-fg31">-    c0 += (a);                  &#47;* overflow is handled on the next line *&#47; \</span>
<span class="term-fg31">-    over = (c0 &lt; (a)) ? 1 : 0; \</span>
<span class="term-fg31">-    c1 += over;                 &#47;* overflow is handled on the next line *&#47; \</span>
<span class="term-fg31">-    c2 += (c1 &lt; over) ? 1 : 0;  &#47;* never overflows by contract *&#47; \</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Add a to the number defined by (c0,c1). c1 must never overflow, c2 must be zero. *&#47;</span>
<span class="term-fg31">-#define sumadd_fast(a) { \</span>
<span class="term-fg31">-    c0 += (a);                 &#47;* overflow is handled on the next line *&#47; \</span>
<span class="term-fg31">-    c1 += (c0 &lt; (a)) ? 1 : 0;  &#47;* never overflows by contract (verified the next line) *&#47; \</span>
<span class="term-fg31">-    VERIFY_CHECK((c1 != 0) | (c0 &gt;= (a))); \</span>
<span class="term-fg31">-    VERIFY_CHECK(c2 == 0); \</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Extract the lowest 32 bits of (c0,c1,c2) into n, and left shift the number 32 bits. *&#47;</span>
<span class="term-fg31">-#define extract(n) { \</span>
<span class="term-fg31">-    (n) = c0; \</span>
<span class="term-fg31">-    c0 = c1; \</span>
<span class="term-fg31">-    c1 = c2; \</span>
<span class="term-fg31">-    c2 = 0; \</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Extract the lowest 32 bits of (c0,c1,c2) into n, and left shift the number 32 bits. c2 is required to be zero. *&#47;</span>
<span class="term-fg31">-#define extract_fast(n) { \</span>
<span class="term-fg31">-    (n) = c0; \</span>
<span class="term-fg31">-    c0 = c1; \</span>
<span class="term-fg31">-    c1 = 0; \</span>
<span class="term-fg31">-    VERIFY_CHECK(c2 == 0); \</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_scalar_reduce_512(secp256k1_scalar *r, const uint32_t *l) {</span>
<span class="term-fg31">-    uint64_t c;</span>
<span class="term-fg31">-    uint32_t n0 = l[8], n1 = l[9], n2 = l[10], n3 = l[11], n4 = l[12], n5 = l[13], n6 = l[14], n7 = l[15];</span>
<span class="term-fg31">-    uint32_t m0, m1, m2, m3, m4, m5, m6, m7, m8, m9, m10, m11, m12;</span>
<span class="term-fg31">-    uint32_t p0, p1, p2, p3, p4, p5, p6, p7, p8;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* 96 bit accumulator. *&#47;</span>
<span class="term-fg31">-    uint32_t c0, c1, c2;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Reduce 512 bits into 385. *&#47;</span>
<span class="term-fg31">-    &#47;* m[0..12] = l[0..7] + n[0..7] * SECP256K1_N_C. *&#47;</span>
<span class="term-fg31">-    c0 = l[0]; c1 = 0; c2 = 0;</span>
<span class="term-fg31">-    muladd_fast(n0, SECP256K1_N_C_0);</span>
<span class="term-fg31">-    extract_fast(m0);</span>
<span class="term-fg31">-    sumadd_fast(l[1]);</span>
<span class="term-fg31">-    muladd(n1, SECP256K1_N_C_0);</span>
<span class="term-fg31">-    muladd(n0, SECP256K1_N_C_1);</span>
<span class="term-fg31">-    extract(m1);</span>
<span class="term-fg31">-    sumadd(l[2]);</span>
<span class="term-fg31">-    muladd(n2, SECP256K1_N_C_0);</span>
<span class="term-fg31">-    muladd(n1, SECP256K1_N_C_1);</span>
<span class="term-fg31">-    muladd(n0, SECP256K1_N_C_2);</span>
<span class="term-fg31">-    extract(m2);</span>
<span class="term-fg31">-    sumadd(l[3]);</span>
<span class="term-fg31">-    muladd(n3, SECP256K1_N_C_0);</span>
<span class="term-fg31">-    muladd(n2, SECP256K1_N_C_1);</span>
<span class="term-fg31">-    muladd(n1, SECP256K1_N_C_2);</span>
<span class="term-fg31">-    muladd(n0, SECP256K1_N_C_3);</span>
<span class="term-fg31">-    extract(m3);</span>
<span class="term-fg31">-    sumadd(l[4]);</span>
<span class="term-fg31">-    muladd(n4, SECP256K1_N_C_0);</span>
<span class="term-fg31">-    muladd(n3, SECP256K1_N_C_1);</span>
<span class="term-fg31">-    muladd(n2, SECP256K1_N_C_2);</span>
<span class="term-fg31">-    muladd(n1, SECP256K1_N_C_3);</span>
<span class="term-fg31">-    sumadd(n0);</span>
<span class="term-fg31">-    extract(m4);</span>
<span class="term-fg31">-    sumadd(l[5]);</span>
<span class="term-fg31">-    muladd(n5, SECP256K1_N_C_0);</span>
<span class="term-fg31">-    muladd(n4, SECP256K1_N_C_1);</span>
<span class="term-fg31">-    muladd(n3, SECP256K1_N_C_2);</span>
<span class="term-fg31">-    muladd(n2, SECP256K1_N_C_3);</span>
<span class="term-fg31">-    sumadd(n1);</span>
<span class="term-fg31">-    extract(m5);</span>
<span class="term-fg31">-    sumadd(l[6]);</span>
<span class="term-fg31">-    muladd(n6, SECP256K1_N_C_0);</span>
<span class="term-fg31">-    muladd(n5, SECP256K1_N_C_1);</span>
<span class="term-fg31">-    muladd(n4, SECP256K1_N_C_2);</span>
<span class="term-fg31">-    muladd(n3, SECP256K1_N_C_3);</span>
<span class="term-fg31">-    sumadd(n2);</span>
<span class="term-fg31">-    extract(m6);</span>
<span class="term-fg31">-    sumadd(l[7]);</span>
<span class="term-fg31">-    muladd(n7, SECP256K1_N_C_0);</span>
<span class="term-fg31">-    muladd(n6, SECP256K1_N_C_1);</span>
<span class="term-fg31">-    muladd(n5, SECP256K1_N_C_2);</span>
<span class="term-fg31">-    muladd(n4, SECP256K1_N_C_3);</span>
<span class="term-fg31">-    sumadd(n3);</span>
<span class="term-fg31">-    extract(m7);</span>
<span class="term-fg31">-    muladd(n7, SECP256K1_N_C_1);</span>
<span class="term-fg31">-    muladd(n6, SECP256K1_N_C_2);</span>
<span class="term-fg31">-    muladd(n5, SECP256K1_N_C_3);</span>
<span class="term-fg31">-    sumadd(n4);</span>
<span class="term-fg31">-    extract(m8);</span>
<span class="term-fg31">-    muladd(n7, SECP256K1_N_C_2);</span>
<span class="term-fg31">-    muladd(n6, SECP256K1_N_C_3);</span>
<span class="term-fg31">-    sumadd(n5);</span>
<span class="term-fg31">-    extract(m9);</span>
<span class="term-fg31">-    muladd(n7, SECP256K1_N_C_3);</span>
<span class="term-fg31">-    sumadd(n6);</span>
<span class="term-fg31">-    extract(m10);</span>
<span class="term-fg31">-    sumadd_fast(n7);</span>
<span class="term-fg31">-    extract_fast(m11);</span>
<span class="term-fg31">-    VERIFY_CHECK(c0 &lt;= 1);</span>
<span class="term-fg31">-    m12 = c0;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Reduce 385 bits into 258. *&#47;</span>
<span class="term-fg31">-    &#47;* p[0..8] = m[0..7] + m[8..12] * SECP256K1_N_C. *&#47;</span>
<span class="term-fg31">-    c0 = m0; c1 = 0; c2 = 0;</span>
<span class="term-fg31">-    muladd_fast(m8, SECP256K1_N_C_0);</span>
<span class="term-fg31">-    extract_fast(p0);</span>
<span class="term-fg31">-    sumadd_fast(m1);</span>
<span class="term-fg31">-    muladd(m9, SECP256K1_N_C_0);</span>
<span class="term-fg31">-    muladd(m8, SECP256K1_N_C_1);</span>
<span class="term-fg31">-    extract(p1);</span>
<span class="term-fg31">-    sumadd(m2);</span>
<span class="term-fg31">-    muladd(m10, SECP256K1_N_C_0);</span>
<span class="term-fg31">-    muladd(m9, SECP256K1_N_C_1);</span>
<span class="term-fg31">-    muladd(m8, SECP256K1_N_C_2);</span>
<span class="term-fg31">-    extract(p2);</span>
<span class="term-fg31">-    sumadd(m3);</span>
<span class="term-fg31">-    muladd(m11, SECP256K1_N_C_0);</span>
<span class="term-fg31">-    muladd(m10, SECP256K1_N_C_1);</span>
<span class="term-fg31">-    muladd(m9, SECP256K1_N_C_2);</span>
<span class="term-fg31">-    muladd(m8, SECP256K1_N_C_3);</span>
<span class="term-fg31">-    extract(p3);</span>
<span class="term-fg31">-    sumadd(m4);</span>
<span class="term-fg31">-    muladd(m12, SECP256K1_N_C_0);</span>
<span class="term-fg31">-    muladd(m11, SECP256K1_N_C_1);</span>
<span class="term-fg31">-    muladd(m10, SECP256K1_N_C_2);</span>
<span class="term-fg31">-    muladd(m9, SECP256K1_N_C_3);</span>
<span class="term-fg31">-    sumadd(m8);</span>
<span class="term-fg31">-    extract(p4);</span>
<span class="term-fg31">-    sumadd(m5);</span>
<span class="term-fg31">-    muladd(m12, SECP256K1_N_C_1);</span>
<span class="term-fg31">-    muladd(m11, SECP256K1_N_C_2);</span>
<span class="term-fg31">-    muladd(m10, SECP256K1_N_C_3);</span>
<span class="term-fg31">-    sumadd(m9);</span>
<span class="term-fg31">-    extract(p5);</span>
<span class="term-fg31">-    sumadd(m6);</span>
<span class="term-fg31">-    muladd(m12, SECP256K1_N_C_2);</span>
<span class="term-fg31">-    muladd(m11, SECP256K1_N_C_3);</span>
<span class="term-fg31">-    sumadd(m10);</span>
<span class="term-fg31">-    extract(p6);</span>
<span class="term-fg31">-    sumadd_fast(m7);</span>
<span class="term-fg31">-    muladd_fast(m12, SECP256K1_N_C_3);</span>
<span class="term-fg31">-    sumadd_fast(m11);</span>
<span class="term-fg31">-    extract_fast(p7);</span>
<span class="term-fg31">-    p8 = c0 + m12;</span>
<span class="term-fg31">-    VERIFY_CHECK(p8 &lt;= 2);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Reduce 258 bits into 256. *&#47;</span>
<span class="term-fg31">-    &#47;* r[0..7] = p[0..7] + p[8] * SECP256K1_N_C. *&#47;</span>
<span class="term-fg31">-    c = p0 + (uint64_t)SECP256K1_N_C_0 * p8;</span>
<span class="term-fg31">-    r-&gt;d[0] = c &amp; 0xFFFFFFFFUL; c &gt;&gt;= 32;</span>
<span class="term-fg31">-    c += p1 + (uint64_t)SECP256K1_N_C_1 * p8;</span>
<span class="term-fg31">-    r-&gt;d[1] = c &amp; 0xFFFFFFFFUL; c &gt;&gt;= 32;</span>
<span class="term-fg31">-    c += p2 + (uint64_t)SECP256K1_N_C_2 * p8;</span>
<span class="term-fg31">-    r-&gt;d[2] = c &amp; 0xFFFFFFFFUL; c &gt;&gt;= 32;</span>
<span class="term-fg31">-    c += p3 + (uint64_t)SECP256K1_N_C_3 * p8;</span>
<span class="term-fg31">-    r-&gt;d[3] = c &amp; 0xFFFFFFFFUL; c &gt;&gt;= 32;</span>
<span class="term-fg31">-    c += p4 + (uint64_t)p8;</span>
<span class="term-fg31">-    r-&gt;d[4] = c &amp; 0xFFFFFFFFUL; c &gt;&gt;= 32;</span>
<span class="term-fg31">-    c += p5;</span>
<span class="term-fg31">-    r-&gt;d[5] = c &amp; 0xFFFFFFFFUL; c &gt;&gt;= 32;</span>
<span class="term-fg31">-    c += p6;</span>
<span class="term-fg31">-    r-&gt;d[6] = c &amp; 0xFFFFFFFFUL; c &gt;&gt;= 32;</span>
<span class="term-fg31">-    c += p7;</span>
<span class="term-fg31">-    r-&gt;d[7] = c &amp; 0xFFFFFFFFUL; c &gt;&gt;= 32;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Final reduction of r. *&#47;</span>
<span class="term-fg31">-    secp256k1_scalar_reduce(r, c + secp256k1_scalar_check_overflow(r));</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_scalar_mul_512(uint32_t *l, const secp256k1_scalar *a, const secp256k1_scalar *b) {</span>
<span class="term-fg31">-    &#47;* 96 bit accumulator. *&#47;</span>
<span class="term-fg31">-    uint32_t c0 = 0, c1 = 0, c2 = 0;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* l[0..15] = a[0..7] * b[0..7]. *&#47;</span>
<span class="term-fg31">-    muladd_fast(a-&gt;d[0], b-&gt;d[0]);</span>
<span class="term-fg31">-    extract_fast(l[0]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[0], b-&gt;d[1]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[1], b-&gt;d[0]);</span>
<span class="term-fg31">-    extract(l[1]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[0], b-&gt;d[2]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[1], b-&gt;d[1]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[2], b-&gt;d[0]);</span>
<span class="term-fg31">-    extract(l[2]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[0], b-&gt;d[3]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[1], b-&gt;d[2]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[2], b-&gt;d[1]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[3], b-&gt;d[0]);</span>
<span class="term-fg31">-    extract(l[3]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[0], b-&gt;d[4]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[1], b-&gt;d[3]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[2], b-&gt;d[2]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[3], b-&gt;d[1]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[4], b-&gt;d[0]);</span>
<span class="term-fg31">-    extract(l[4]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[0], b-&gt;d[5]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[1], b-&gt;d[4]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[2], b-&gt;d[3]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[3], b-&gt;d[2]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[4], b-&gt;d[1]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[5], b-&gt;d[0]);</span>
<span class="term-fg31">-    extract(l[5]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[0], b-&gt;d[6]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[1], b-&gt;d[5]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[2], b-&gt;d[4]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[3], b-&gt;d[3]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[4], b-&gt;d[2]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[5], b-&gt;d[1]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[6], b-&gt;d[0]);</span>
<span class="term-fg31">-    extract(l[6]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[0], b-&gt;d[7]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[1], b-&gt;d[6]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[2], b-&gt;d[5]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[3], b-&gt;d[4]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[4], b-&gt;d[3]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[5], b-&gt;d[2]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[6], b-&gt;d[1]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[7], b-&gt;d[0]);</span>
<span class="term-fg31">-    extract(l[7]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[1], b-&gt;d[7]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[2], b-&gt;d[6]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[3], b-&gt;d[5]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[4], b-&gt;d[4]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[5], b-&gt;d[3]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[6], b-&gt;d[2]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[7], b-&gt;d[1]);</span>
<span class="term-fg31">-    extract(l[8]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[2], b-&gt;d[7]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[3], b-&gt;d[6]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[4], b-&gt;d[5]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[5], b-&gt;d[4]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[6], b-&gt;d[3]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[7], b-&gt;d[2]);</span>
<span class="term-fg31">-    extract(l[9]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[3], b-&gt;d[7]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[4], b-&gt;d[6]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[5], b-&gt;d[5]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[6], b-&gt;d[4]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[7], b-&gt;d[3]);</span>
<span class="term-fg31">-    extract(l[10]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[4], b-&gt;d[7]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[5], b-&gt;d[6]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[6], b-&gt;d[5]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[7], b-&gt;d[4]);</span>
<span class="term-fg31">-    extract(l[11]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[5], b-&gt;d[7]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[6], b-&gt;d[6]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[7], b-&gt;d[5]);</span>
<span class="term-fg31">-    extract(l[12]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[6], b-&gt;d[7]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[7], b-&gt;d[6]);</span>
<span class="term-fg31">-    extract(l[13]);</span>
<span class="term-fg31">-    muladd_fast(a-&gt;d[7], b-&gt;d[7]);</span>
<span class="term-fg31">-    extract_fast(l[14]);</span>
<span class="term-fg31">-    VERIFY_CHECK(c1 == 0);</span>
<span class="term-fg31">-    l[15] = c0;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_scalar_sqr_512(uint32_t *l, const secp256k1_scalar *a) {</span>
<span class="term-fg31">-    &#47;* 96 bit accumulator. *&#47;</span>
<span class="term-fg31">-    uint32_t c0 = 0, c1 = 0, c2 = 0;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* l[0..15] = a[0..7]^2. *&#47;</span>
<span class="term-fg31">-    muladd_fast(a-&gt;d[0], a-&gt;d[0]);</span>
<span class="term-fg31">-    extract_fast(l[0]);</span>
<span class="term-fg31">-    muladd2(a-&gt;d[0], a-&gt;d[1]);</span>
<span class="term-fg31">-    extract(l[1]);</span>
<span class="term-fg31">-    muladd2(a-&gt;d[0], a-&gt;d[2]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[1], a-&gt;d[1]);</span>
<span class="term-fg31">-    extract(l[2]);</span>
<span class="term-fg31">-    muladd2(a-&gt;d[0], a-&gt;d[3]);</span>
<span class="term-fg31">-    muladd2(a-&gt;d[1], a-&gt;d[2]);</span>
<span class="term-fg31">-    extract(l[3]);</span>
<span class="term-fg31">-    muladd2(a-&gt;d[0], a-&gt;d[4]);</span>
<span class="term-fg31">-    muladd2(a-&gt;d[1], a-&gt;d[3]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[2], a-&gt;d[2]);</span>
<span class="term-fg31">-    extract(l[4]);</span>
<span class="term-fg31">-    muladd2(a-&gt;d[0], a-&gt;d[5]);</span>
<span class="term-fg31">-    muladd2(a-&gt;d[1], a-&gt;d[4]);</span>
<span class="term-fg31">-    muladd2(a-&gt;d[2], a-&gt;d[3]);</span>
<span class="term-fg31">-    extract(l[5]);</span>
<span class="term-fg31">-    muladd2(a-&gt;d[0], a-&gt;d[6]);</span>
<span class="term-fg31">-    muladd2(a-&gt;d[1], a-&gt;d[5]);</span>
<span class="term-fg31">-    muladd2(a-&gt;d[2], a-&gt;d[4]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[3], a-&gt;d[3]);</span>
<span class="term-fg31">-    extract(l[6]);</span>
<span class="term-fg31">-    muladd2(a-&gt;d[0], a-&gt;d[7]);</span>
<span class="term-fg31">-    muladd2(a-&gt;d[1], a-&gt;d[6]);</span>
<span class="term-fg31">-    muladd2(a-&gt;d[2], a-&gt;d[5]);</span>
<span class="term-fg31">-    muladd2(a-&gt;d[3], a-&gt;d[4]);</span>
<span class="term-fg31">-    extract(l[7]);</span>
<span class="term-fg31">-    muladd2(a-&gt;d[1], a-&gt;d[7]);</span>
<span class="term-fg31">-    muladd2(a-&gt;d[2], a-&gt;d[6]);</span>
<span class="term-fg31">-    muladd2(a-&gt;d[3], a-&gt;d[5]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[4], a-&gt;d[4]);</span>
<span class="term-fg31">-    extract(l[8]);</span>
<span class="term-fg31">-    muladd2(a-&gt;d[2], a-&gt;d[7]);</span>
<span class="term-fg31">-    muladd2(a-&gt;d[3], a-&gt;d[6]);</span>
<span class="term-fg31">-    muladd2(a-&gt;d[4], a-&gt;d[5]);</span>
<span class="term-fg31">-    extract(l[9]);</span>
<span class="term-fg31">-    muladd2(a-&gt;d[3], a-&gt;d[7]);</span>
<span class="term-fg31">-    muladd2(a-&gt;d[4], a-&gt;d[6]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[5], a-&gt;d[5]);</span>
<span class="term-fg31">-    extract(l[10]);</span>
<span class="term-fg31">-    muladd2(a-&gt;d[4], a-&gt;d[7]);</span>
<span class="term-fg31">-    muladd2(a-&gt;d[5], a-&gt;d[6]);</span>
<span class="term-fg31">-    extract(l[11]);</span>
<span class="term-fg31">-    muladd2(a-&gt;d[5], a-&gt;d[7]);</span>
<span class="term-fg31">-    muladd(a-&gt;d[6], a-&gt;d[6]);</span>
<span class="term-fg31">-    extract(l[12]);</span>
<span class="term-fg31">-    muladd2(a-&gt;d[6], a-&gt;d[7]);</span>
<span class="term-fg31">-    extract(l[13]);</span>
<span class="term-fg31">-    muladd_fast(a-&gt;d[7], a-&gt;d[7]);</span>
<span class="term-fg31">-    extract_fast(l[14]);</span>
<span class="term-fg31">-    VERIFY_CHECK(c1 == 0);</span>
<span class="term-fg31">-    l[15] = c0;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#undef sumadd</span>
<span class="term-fg31">-#undef sumadd_fast</span>
<span class="term-fg31">-#undef muladd</span>
<span class="term-fg31">-#undef muladd_fast</span>
<span class="term-fg31">-#undef muladd2</span>
<span class="term-fg31">-#undef extract</span>
<span class="term-fg31">-#undef extract_fast</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_scalar_mul(secp256k1_scalar *r, const secp256k1_scalar *a, const secp256k1_scalar *b) {</span>
<span class="term-fg31">-    uint32_t l[16];</span>
<span class="term-fg31">-    secp256k1_scalar_mul_512(l, a, b);</span>
<span class="term-fg31">-    secp256k1_scalar_reduce_512(r, l);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_scalar_shr_int(secp256k1_scalar *r, int n) {</span>
<span class="term-fg31">-    int ret;</span>
<span class="term-fg31">-    VERIFY_CHECK(n &gt; 0);</span>
<span class="term-fg31">-    VERIFY_CHECK(n &lt; 16);</span>
<span class="term-fg31">-    ret = r-&gt;d[0] &amp; ((1 &lt;&lt; n) - 1);</span>
<span class="term-fg31">-    r-&gt;d[0] = (r-&gt;d[0] &gt;&gt; n) + (r-&gt;d[1] &lt;&lt; (32 - n));</span>
<span class="term-fg31">-    r-&gt;d[1] = (r-&gt;d[1] &gt;&gt; n) + (r-&gt;d[2] &lt;&lt; (32 - n));</span>
<span class="term-fg31">-    r-&gt;d[2] = (r-&gt;d[2] &gt;&gt; n) + (r-&gt;d[3] &lt;&lt; (32 - n));</span>
<span class="term-fg31">-    r-&gt;d[3] = (r-&gt;d[3] &gt;&gt; n) + (r-&gt;d[4] &lt;&lt; (32 - n));</span>
<span class="term-fg31">-    r-&gt;d[4] = (r-&gt;d[4] &gt;&gt; n) + (r-&gt;d[5] &lt;&lt; (32 - n));</span>
<span class="term-fg31">-    r-&gt;d[5] = (r-&gt;d[5] &gt;&gt; n) + (r-&gt;d[6] &lt;&lt; (32 - n));</span>
<span class="term-fg31">-    r-&gt;d[6] = (r-&gt;d[6] &gt;&gt; n) + (r-&gt;d[7] &lt;&lt; (32 - n));</span>
<span class="term-fg31">-    r-&gt;d[7] = (r-&gt;d[7] &gt;&gt; n);</span>
<span class="term-fg31">-    return ret;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_scalar_sqr(secp256k1_scalar *r, const secp256k1_scalar *a) {</span>
<span class="term-fg31">-    uint32_t l[16];</span>
<span class="term-fg31">-    secp256k1_scalar_sqr_512(l, a);</span>
<span class="term-fg31">-    secp256k1_scalar_reduce_512(r, l);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef USE_ENDOMORPHISM</span>
<span class="term-fg31">-static void secp256k1_scalar_split_128(secp256k1_scalar *r1, secp256k1_scalar *r2, const secp256k1_scalar *a) {</span>
<span class="term-fg31">-    r1-&gt;d[0] = a-&gt;d[0];</span>
<span class="term-fg31">-    r1-&gt;d[1] = a-&gt;d[1];</span>
<span class="term-fg31">-    r1-&gt;d[2] = a-&gt;d[2];</span>
<span class="term-fg31">-    r1-&gt;d[3] = a-&gt;d[3];</span>
<span class="term-fg31">-    r1-&gt;d[4] = 0;</span>
<span class="term-fg31">-    r1-&gt;d[5] = 0;</span>
<span class="term-fg31">-    r1-&gt;d[6] = 0;</span>
<span class="term-fg31">-    r1-&gt;d[7] = 0;</span>
<span class="term-fg31">-    r2-&gt;d[0] = a-&gt;d[4];</span>
<span class="term-fg31">-    r2-&gt;d[1] = a-&gt;d[5];</span>
<span class="term-fg31">-    r2-&gt;d[2] = a-&gt;d[6];</span>
<span class="term-fg31">-    r2-&gt;d[3] = a-&gt;d[7];</span>
<span class="term-fg31">-    r2-&gt;d[4] = 0;</span>
<span class="term-fg31">-    r2-&gt;d[5] = 0;</span>
<span class="term-fg31">-    r2-&gt;d[6] = 0;</span>
<span class="term-fg31">-    r2-&gt;d[7] = 0;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static int secp256k1_scalar_eq(const secp256k1_scalar *a, const secp256k1_scalar *b) {</span>
<span class="term-fg31">-    return ((a-&gt;d[0] ^ b-&gt;d[0]) | (a-&gt;d[1] ^ b-&gt;d[1]) | (a-&gt;d[2] ^ b-&gt;d[2]) | (a-&gt;d[3] ^ b-&gt;d[3]) | (a-&gt;d[4] ^ b-&gt;d[4]) | (a-&gt;d[5] ^ b-&gt;d[5]) | (a-&gt;d[6] ^ b-&gt;d[6]) | (a-&gt;d[7] ^ b-&gt;d[7])) == 0;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static void secp256k1_scalar_mul_shift_var(secp256k1_scalar *r, const secp256k1_scalar *a, const secp256k1_scalar *b, unsigned int shift) {</span>
<span class="term-fg31">-    uint32_t l[16];</span>
<span class="term-fg31">-    unsigned int shiftlimbs;</span>
<span class="term-fg31">-    unsigned int shiftlow;</span>
<span class="term-fg31">-    unsigned int shifthigh;</span>
<span class="term-fg31">-    VERIFY_CHECK(shift &gt;= 256);</span>
<span class="term-fg31">-    secp256k1_scalar_mul_512(l, a, b);</span>
<span class="term-fg31">-    shiftlimbs = shift &gt;&gt; 5;</span>
<span class="term-fg31">-    shiftlow = shift &amp; 0x1F;</span>
<span class="term-fg31">-    shifthigh = 32 - shiftlow;</span>
<span class="term-fg31">-    r-&gt;d[0] = shift &lt; 512 ? (l[0 + shiftlimbs] &gt;&gt; shiftlow | (shift &lt; 480 &amp;&amp; shiftlow ? (l[1 + shiftlimbs] &lt;&lt; shifthigh) : 0)) : 0;</span>
<span class="term-fg31">-    r-&gt;d[1] = shift &lt; 480 ? (l[1 + shiftlimbs] &gt;&gt; shiftlow | (shift &lt; 448 &amp;&amp; shiftlow ? (l[2 + shiftlimbs] &lt;&lt; shifthigh) : 0)) : 0;</span>
<span class="term-fg31">-    r-&gt;d[2] = shift &lt; 448 ? (l[2 + shiftlimbs] &gt;&gt; shiftlow | (shift &lt; 416 &amp;&amp; shiftlow ? (l[3 + shiftlimbs] &lt;&lt; shifthigh) : 0)) : 0;</span>
<span class="term-fg31">-    r-&gt;d[3] = shift &lt; 416 ? (l[3 + shiftlimbs] &gt;&gt; shiftlow | (shift &lt; 384 &amp;&amp; shiftlow ? (l[4 + shiftlimbs] &lt;&lt; shifthigh) : 0)) : 0;</span>
<span class="term-fg31">-    r-&gt;d[4] = shift &lt; 384 ? (l[4 + shiftlimbs] &gt;&gt; shiftlow | (shift &lt; 352 &amp;&amp; shiftlow ? (l[5 + shiftlimbs] &lt;&lt; shifthigh) : 0)) : 0;</span>
<span class="term-fg31">-    r-&gt;d[5] = shift &lt; 352 ? (l[5 + shiftlimbs] &gt;&gt; shiftlow | (shift &lt; 320 &amp;&amp; shiftlow ? (l[6 + shiftlimbs] &lt;&lt; shifthigh) : 0)) : 0;</span>
<span class="term-fg31">-    r-&gt;d[6] = shift &lt; 320 ? (l[6 + shiftlimbs] &gt;&gt; shiftlow | (shift &lt; 288 &amp;&amp; shiftlow ? (l[7 + shiftlimbs] &lt;&lt; shifthigh) : 0)) : 0;</span>
<span class="term-fg31">-    r-&gt;d[7] = shift &lt; 288 ? (l[7 + shiftlimbs] &gt;&gt; shiftlow)  : 0;</span>
<span class="term-fg31">-    secp256k1_scalar_cadd_bit(r, 0, (l[(shift - 1) &gt;&gt; 5] &gt;&gt; ((shift - 1) &amp; 0x1f)) &amp; 1);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-530d35ad641bfe0ba46e29bb" role="button"
                       aria-expanded="false" aria-controls="id-530d35ad641bfe0ba46e29bb">
                        <code>crypto/secp256k1/libsecp256k1/src/scalar_impl.h</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/scalar_impl.h" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-370</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-530d35ad641bfe0ba46e29bb"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;scalar_impl.h op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;scalar_impl.h</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index f5b2376407bd3b2338e26b1a0bb84cd3fc91660b..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;scalar_impl.h</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,370 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2014 Pieter Wuille                                   *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef _SECP256K1_SCALAR_IMPL_H_</span>
<span class="term-fg31">-#define _SECP256K1_SCALAR_IMPL_H_</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &quot;group.h&quot;</span>
<span class="term-fg31">-#include &quot;scalar.h&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#if defined HAVE_CONFIG_H</span>
<span class="term-fg31">-#include &quot;libsecp256k1-config.h&quot;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#if defined(EXHAUSTIVE_TEST_ORDER)</span>
<span class="term-fg31">-#include &quot;scalar_low_impl.h&quot;</span>
<span class="term-fg31">-#elif defined(USE_SCALAR_4X64)</span>
<span class="term-fg31">-#include &quot;scalar_4x64_impl.h&quot;</span>
<span class="term-fg31">-#elif defined(USE_SCALAR_8X32)</span>
<span class="term-fg31">-#include &quot;scalar_8x32_impl.h&quot;</span>
<span class="term-fg31">-#else</span>
<span class="term-fg31">-#error &quot;Please select scalar implementation&quot;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef USE_NUM_NONE</span>
<span class="term-fg31">-static void secp256k1_scalar_get_num(secp256k1_num *r, const secp256k1_scalar *a) {</span>
<span class="term-fg31">-    unsigned char c[32];</span>
<span class="term-fg31">-    secp256k1_scalar_get_b32(c, a);</span>
<span class="term-fg31">-    secp256k1_num_set_bin(r, c, 32);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** secp256k1 curve order, see secp256k1_ecdsa_const_order_as_fe in ecdsa_impl.h *&#47;</span>
<span class="term-fg31">-static void secp256k1_scalar_order_get_num(secp256k1_num *r) {</span>
<span class="term-fg31">-#if defined(EXHAUSTIVE_TEST_ORDER)</span>
<span class="term-fg31">-    static const unsigned char order[32] = {</span>
<span class="term-fg31">-        0,0,0,0,0,0,0,0,</span>
<span class="term-fg31">-        0,0,0,0,0,0,0,0,</span>
<span class="term-fg31">-        0,0,0,0,0,0,0,0,</span>
<span class="term-fg31">-        0,0,0,0,0,0,0,EXHAUSTIVE_TEST_ORDER</span>
<span class="term-fg31">-    };</span>
<span class="term-fg31">-#else</span>
<span class="term-fg31">-    static const unsigned char order[32] = {</span>
<span class="term-fg31">-        0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,</span>
<span class="term-fg31">-        0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFE,</span>
<span class="term-fg31">-        0xBA,0xAE,0xDC,0xE6,0xAF,0x48,0xA0,0x3B,</span>
<span class="term-fg31">-        0xBF,0xD2,0x5E,0x8C,0xD0,0x36,0x41,0x41</span>
<span class="term-fg31">-    };</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-    secp256k1_num_set_bin(r, order, 32);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_scalar_inverse(secp256k1_scalar *r, const secp256k1_scalar *x) {</span>
<span class="term-fg31">-#if defined(EXHAUSTIVE_TEST_ORDER)</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    *r = 0;</span>
<span class="term-fg31">-    for (i = 0; i &lt; EXHAUSTIVE_TEST_ORDER; i++)</span>
<span class="term-fg31">-        if ((i * *x) % EXHAUSTIVE_TEST_ORDER == 1)</span>
<span class="term-fg31">-            *r = i;</span>
<span class="term-fg31">-    &#47;* If this VERIFY_CHECK triggers we were given a noninvertible scalar (and thus</span>
<span class="term-fg31">-     * have a composite group order; fix it in exhaustive_tests.c). *&#47;</span>
<span class="term-fg31">-    VERIFY_CHECK(*r != 0);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-#else</span>
<span class="term-fg31">-    secp256k1_scalar *t;</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    &#47;* First compute x ^ (2^N - 1) for some values of N. *&#47;</span>
<span class="term-fg31">-    secp256k1_scalar x2, x3, x4, x6, x7, x8, x15, x30, x60, x120, x127;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_scalar_sqr(&amp;x2,  x);</span>
<span class="term-fg31">-    secp256k1_scalar_mul(&amp;x2, &amp;x2,  x);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_scalar_sqr(&amp;x3, &amp;x2);</span>
<span class="term-fg31">-    secp256k1_scalar_mul(&amp;x3, &amp;x3,  x);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_scalar_sqr(&amp;x4, &amp;x3);</span>
<span class="term-fg31">-    secp256k1_scalar_mul(&amp;x4, &amp;x4,  x);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_scalar_sqr(&amp;x6, &amp;x4);</span>
<span class="term-fg31">-    secp256k1_scalar_sqr(&amp;x6, &amp;x6);</span>
<span class="term-fg31">-    secp256k1_scalar_mul(&amp;x6, &amp;x6, &amp;x2);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_scalar_sqr(&amp;x7, &amp;x6);</span>
<span class="term-fg31">-    secp256k1_scalar_mul(&amp;x7, &amp;x7,  x);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_scalar_sqr(&amp;x8, &amp;x7);</span>
<span class="term-fg31">-    secp256k1_scalar_mul(&amp;x8, &amp;x8,  x);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_scalar_sqr(&amp;x15, &amp;x8);</span>
<span class="term-fg31">-    for (i = 0; i &lt; 6; i++) {</span>
<span class="term-fg31">-        secp256k1_scalar_sqr(&amp;x15, &amp;x15);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_scalar_mul(&amp;x15, &amp;x15, &amp;x7);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_scalar_sqr(&amp;x30, &amp;x15);</span>
<span class="term-fg31">-    for (i = 0; i &lt; 14; i++) {</span>
<span class="term-fg31">-        secp256k1_scalar_sqr(&amp;x30, &amp;x30);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_scalar_mul(&amp;x30, &amp;x30, &amp;x15);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_scalar_sqr(&amp;x60, &amp;x30);</span>
<span class="term-fg31">-    for (i = 0; i &lt; 29; i++) {</span>
<span class="term-fg31">-        secp256k1_scalar_sqr(&amp;x60, &amp;x60);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_scalar_mul(&amp;x60, &amp;x60, &amp;x30);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_scalar_sqr(&amp;x120, &amp;x60);</span>
<span class="term-fg31">-    for (i = 0; i &lt; 59; i++) {</span>
<span class="term-fg31">-        secp256k1_scalar_sqr(&amp;x120, &amp;x120);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_scalar_mul(&amp;x120, &amp;x120, &amp;x60);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_scalar_sqr(&amp;x127, &amp;x120);</span>
<span class="term-fg31">-    for (i = 0; i &lt; 6; i++) {</span>
<span class="term-fg31">-        secp256k1_scalar_sqr(&amp;x127, &amp;x127);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_scalar_mul(&amp;x127, &amp;x127, &amp;x7);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Then accumulate the final result (t starts at x127). *&#47;</span>
<span class="term-fg31">-    t = &amp;x127;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 2; i++) { &#47;* 0 *&#47;</span>
<span class="term-fg31">-        secp256k1_scalar_sqr(t, t);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_scalar_mul(t, t, x); &#47;* 1 *&#47;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 4; i++) { &#47;* 0 *&#47;</span>
<span class="term-fg31">-        secp256k1_scalar_sqr(t, t);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_scalar_mul(t, t, &amp;x3); &#47;* 111 *&#47;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 2; i++) { &#47;* 0 *&#47;</span>
<span class="term-fg31">-        secp256k1_scalar_sqr(t, t);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_scalar_mul(t, t, x); &#47;* 1 *&#47;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 2; i++) { &#47;* 0 *&#47;</span>
<span class="term-fg31">-        secp256k1_scalar_sqr(t, t);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_scalar_mul(t, t, x); &#47;* 1 *&#47;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 2; i++) { &#47;* 0 *&#47;</span>
<span class="term-fg31">-        secp256k1_scalar_sqr(t, t);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_scalar_mul(t, t, x); &#47;* 1 *&#47;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 4; i++) { &#47;* 0 *&#47;</span>
<span class="term-fg31">-        secp256k1_scalar_sqr(t, t);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_scalar_mul(t, t, &amp;x3); &#47;* 111 *&#47;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 3; i++) { &#47;* 0 *&#47;</span>
<span class="term-fg31">-        secp256k1_scalar_sqr(t, t);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_scalar_mul(t, t, &amp;x2); &#47;* 11 *&#47;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 4; i++) { &#47;* 0 *&#47;</span>
<span class="term-fg31">-        secp256k1_scalar_sqr(t, t);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_scalar_mul(t, t, &amp;x3); &#47;* 111 *&#47;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 5; i++) { &#47;* 00 *&#47;</span>
<span class="term-fg31">-        secp256k1_scalar_sqr(t, t);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_scalar_mul(t, t, &amp;x3); &#47;* 111 *&#47;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 4; i++) { &#47;* 00 *&#47;</span>
<span class="term-fg31">-        secp256k1_scalar_sqr(t, t);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_scalar_mul(t, t, &amp;x2); &#47;* 11 *&#47;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 2; i++) { &#47;* 0 *&#47;</span>
<span class="term-fg31">-        secp256k1_scalar_sqr(t, t);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_scalar_mul(t, t, x); &#47;* 1 *&#47;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 2; i++) { &#47;* 0 *&#47;</span>
<span class="term-fg31">-        secp256k1_scalar_sqr(t, t);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_scalar_mul(t, t, x); &#47;* 1 *&#47;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 5; i++) { &#47;* 0 *&#47;</span>
<span class="term-fg31">-        secp256k1_scalar_sqr(t, t);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_scalar_mul(t, t, &amp;x4); &#47;* 1111 *&#47;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 2; i++) { &#47;* 0 *&#47;</span>
<span class="term-fg31">-        secp256k1_scalar_sqr(t, t);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_scalar_mul(t, t, x); &#47;* 1 *&#47;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 3; i++) { &#47;* 00 *&#47;</span>
<span class="term-fg31">-        secp256k1_scalar_sqr(t, t);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_scalar_mul(t, t, x); &#47;* 1 *&#47;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 4; i++) { &#47;* 000 *&#47;</span>
<span class="term-fg31">-        secp256k1_scalar_sqr(t, t);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_scalar_mul(t, t, x); &#47;* 1 *&#47;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 2; i++) { &#47;* 0 *&#47;</span>
<span class="term-fg31">-        secp256k1_scalar_sqr(t, t);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_scalar_mul(t, t, x); &#47;* 1 *&#47;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 10; i++) { &#47;* 0000000 *&#47;</span>
<span class="term-fg31">-        secp256k1_scalar_sqr(t, t);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_scalar_mul(t, t, &amp;x3); &#47;* 111 *&#47;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 4; i++) { &#47;* 0 *&#47;</span>
<span class="term-fg31">-        secp256k1_scalar_sqr(t, t);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_scalar_mul(t, t, &amp;x3); &#47;* 111 *&#47;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 9; i++) { &#47;* 0 *&#47;</span>
<span class="term-fg31">-        secp256k1_scalar_sqr(t, t);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_scalar_mul(t, t, &amp;x8); &#47;* 11111111 *&#47;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 2; i++) { &#47;* 0 *&#47;</span>
<span class="term-fg31">-        secp256k1_scalar_sqr(t, t);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_scalar_mul(t, t, x); &#47;* 1 *&#47;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 3; i++) { &#47;* 00 *&#47;</span>
<span class="term-fg31">-        secp256k1_scalar_sqr(t, t);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_scalar_mul(t, t, x); &#47;* 1 *&#47;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 3; i++) { &#47;* 00 *&#47;</span>
<span class="term-fg31">-        secp256k1_scalar_sqr(t, t);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_scalar_mul(t, t, x); &#47;* 1 *&#47;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 5; i++) { &#47;* 0 *&#47;</span>
<span class="term-fg31">-        secp256k1_scalar_sqr(t, t);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_scalar_mul(t, t, &amp;x4); &#47;* 1111 *&#47;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 2; i++) { &#47;* 0 *&#47;</span>
<span class="term-fg31">-        secp256k1_scalar_sqr(t, t);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_scalar_mul(t, t, x); &#47;* 1 *&#47;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 5; i++) { &#47;* 000 *&#47;</span>
<span class="term-fg31">-        secp256k1_scalar_sqr(t, t);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_scalar_mul(t, t, &amp;x2); &#47;* 11 *&#47;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 4; i++) { &#47;* 00 *&#47;</span>
<span class="term-fg31">-        secp256k1_scalar_sqr(t, t);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_scalar_mul(t, t, &amp;x2); &#47;* 11 *&#47;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 2; i++) { &#47;* 0 *&#47;</span>
<span class="term-fg31">-        secp256k1_scalar_sqr(t, t);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_scalar_mul(t, t, x); &#47;* 1 *&#47;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 8; i++) { &#47;* 000000 *&#47;</span>
<span class="term-fg31">-        secp256k1_scalar_sqr(t, t);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_scalar_mul(t, t, &amp;x2); &#47;* 11 *&#47;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 3; i++) { &#47;* 0 *&#47;</span>
<span class="term-fg31">-        secp256k1_scalar_sqr(t, t);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_scalar_mul(t, t, &amp;x2); &#47;* 11 *&#47;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 3; i++) { &#47;* 00 *&#47;</span>
<span class="term-fg31">-        secp256k1_scalar_sqr(t, t);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_scalar_mul(t, t, x); &#47;* 1 *&#47;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 6; i++) { &#47;* 00000 *&#47;</span>
<span class="term-fg31">-        secp256k1_scalar_sqr(t, t);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_scalar_mul(t, t, x); &#47;* 1 *&#47;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 8; i++) { &#47;* 00 *&#47;</span>
<span class="term-fg31">-        secp256k1_scalar_sqr(t, t);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_scalar_mul(r, t, &amp;x6); &#47;* 111111 *&#47;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static int secp256k1_scalar_is_even(const secp256k1_scalar *a) {</span>
<span class="term-fg31">-    return !(a-&gt;d[0] &amp; 1);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_scalar_inverse_var(secp256k1_scalar *r, const secp256k1_scalar *x) {</span>
<span class="term-fg31">-#if defined(USE_SCALAR_INV_BUILTIN)</span>
<span class="term-fg31">-    secp256k1_scalar_inverse(r, x);</span>
<span class="term-fg31">-#elif defined(USE_SCALAR_INV_NUM)</span>
<span class="term-fg31">-    unsigned char b[32];</span>
<span class="term-fg31">-    secp256k1_num n, m;</span>
<span class="term-fg31">-    secp256k1_scalar t = *x;</span>
<span class="term-fg31">-    secp256k1_scalar_get_b32(b, &amp;t);</span>
<span class="term-fg31">-    secp256k1_num_set_bin(&amp;n, b, 32);</span>
<span class="term-fg31">-    secp256k1_scalar_order_get_num(&amp;m);</span>
<span class="term-fg31">-    secp256k1_num_mod_inverse(&amp;n, &amp;n, &amp;m);</span>
<span class="term-fg31">-    secp256k1_num_get_bin(b, 32, &amp;n);</span>
<span class="term-fg31">-    secp256k1_scalar_set_b32(r, b, NULL);</span>
<span class="term-fg31">-    &#47;* Verify that the inverse was computed correctly, without GMP code. *&#47;</span>
<span class="term-fg31">-    secp256k1_scalar_mul(&amp;t, &amp;t, r);</span>
<span class="term-fg31">-    CHECK(secp256k1_scalar_is_one(&amp;t));</span>
<span class="term-fg31">-#else</span>
<span class="term-fg31">-#error &quot;Please select scalar inverse implementation&quot;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef USE_ENDOMORPHISM</span>
<span class="term-fg31">-#if defined(EXHAUSTIVE_TEST_ORDER)</span>
<span class="term-fg31">-&#47;**</span>
<span class="term-fg31">- * Find k1 and k2 given k, such that k1 + k2 * lambda == k mod n; unlike in the</span>
<span class="term-fg31">- * full case we don&#39;t bother making k1 and k2 be small, we just want them to be</span>
<span class="term-fg31">- * nontrivial to get full test coverage for the exhaustive tests. We therefore</span>
<span class="term-fg31">- * (arbitrarily) set k2 = k + 5 and k1 = k - k2 * lambda.</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-static void secp256k1_scalar_split_lambda(secp256k1_scalar *r1, secp256k1_scalar *r2, const secp256k1_scalar *a) {</span>
<span class="term-fg31">-    *r2 = (*a + 5) % EXHAUSTIVE_TEST_ORDER;</span>
<span class="term-fg31">-    *r1 = (*a + (EXHAUSTIVE_TEST_ORDER - *r2) * EXHAUSTIVE_TEST_LAMBDA) % EXHAUSTIVE_TEST_ORDER;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-#else</span>
<span class="term-fg31">-&#47;**</span>
<span class="term-fg31">- * The Secp256k1 curve has an endomorphism, where lambda * (x, y) = (beta * x, y), where</span>
<span class="term-fg31">- * lambda is {0x53,0x63,0xad,0x4c,0xc0,0x5c,0x30,0xe0,0xa5,0x26,0x1c,0x02,0x88,0x12,0x64,0x5a,</span>
<span class="term-fg31">- *            0x12,0x2e,0x22,0xea,0x20,0x81,0x66,0x78,0xdf,0x02,0x96,0x7c,0x1b,0x23,0xbd,0x72}</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- * &quot;Guide to Elliptic Curve Cryptography&quot; (Hankerson, Menezes, Vanstone) gives an algorithm</span>
<span class="term-fg31">- * (algorithm 3.74) to find k1 and k2 given k, such that k1 + k2 * lambda == k mod n, and k1</span>
<span class="term-fg31">- * and k2 have a small size.</span>
<span class="term-fg31">- * It relies on constants a1, b1, a2, b2. These constants for the value of lambda above are:</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- * - a1 =      {0x30,0x86,0xd2,0x21,0xa7,0xd4,0x6b,0xcd,0xe8,0x6c,0x90,0xe4,0x92,0x84,0xeb,0x15}</span>
<span class="term-fg31">- * - b1 =     -{0xe4,0x43,0x7e,0xd6,0x01,0x0e,0x88,0x28,0x6f,0x54,0x7f,0xa9,0x0a,0xbf,0xe4,0xc3}</span>
<span class="term-fg31">- * - a2 = {0x01,0x14,0xca,0x50,0xf7,0xa8,0xe2,0xf3,0xf6,0x57,0xc1,0x10,0x8d,0x9d,0x44,0xcf,0xd8}</span>
<span class="term-fg31">- * - b2 =      {0x30,0x86,0xd2,0x21,0xa7,0xd4,0x6b,0xcd,0xe8,0x6c,0x90,0xe4,0x92,0x84,0xeb,0x15}</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- * The algorithm then computes c1 = round(b1 * k &#47; n) and c2 = round(b2 * k &#47; n), and gives</span>
<span class="term-fg31">- * k1 = k - (c1*a1 + c2*a2) and k2 = -(c1*b1 + c2*b2). Instead, we use modular arithmetic, and</span>
<span class="term-fg31">- * compute k1 as k - k2 * lambda, avoiding the need for constants a1 and a2.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- * g1, g2 are precomputed constants used to replace division with a rounded multiplication</span>
<span class="term-fg31">- * when decomposing the scalar for an endomorphism-based point multiplication.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- * The possibility of using precomputed estimates is mentioned in &quot;Guide to Elliptic Curve</span>
<span class="term-fg31">- * Cryptography&quot; (Hankerson, Menezes, Vanstone) in section 3.5.</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- * The derivation is described in the paper &quot;Efficient Software Implementation of Public-Key</span>
<span class="term-fg31">- * Cryptography on Sensor Networks Using the MSP430X Microcontroller&quot; (Gouvea, Oliveira, Lopez),</span>
<span class="term-fg31">- * Section 4.3 (here we use a somewhat higher-precision estimate):</span>
<span class="term-fg31">- * d = a1*b2 - b1*a2</span>
<span class="term-fg31">- * g1 = round((2^272)*b2&#47;d)</span>
<span class="term-fg31">- * g2 = round((2^272)*b1&#47;d)</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- * (Note that &#39;d&#39; is also equal to the curve order here because [a1,b1] and [a2,b2] are found</span>
<span class="term-fg31">- * as outputs of the Extended Euclidean Algorithm on inputs &#39;order&#39; and &#39;lambda&#39;).</span>
<span class="term-fg31">- *</span>
<span class="term-fg31">- * The function below splits a in r1 and r2, such that r1 + lambda * r2 == a (mod order).</span>
<span class="term-fg31">- *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_scalar_split_lambda(secp256k1_scalar *r1, secp256k1_scalar *r2, const secp256k1_scalar *a) {</span>
<span class="term-fg31">-    secp256k1_scalar c1, c2;</span>
<span class="term-fg31">-    static const secp256k1_scalar minus_lambda = SECP256K1_SCALAR_CONST(</span>
<span class="term-fg31">-        0xAC9C52B3UL, 0x3FA3CF1FUL, 0x5AD9E3FDUL, 0x77ED9BA4UL,</span>
<span class="term-fg31">-        0xA880B9FCUL, 0x8EC739C2UL, 0xE0CFC810UL, 0xB51283CFUL</span>
<span class="term-fg31">-    );</span>
<span class="term-fg31">-    static const secp256k1_scalar minus_b1 = SECP256K1_SCALAR_CONST(</span>
<span class="term-fg31">-        0x00000000UL, 0x00000000UL, 0x00000000UL, 0x00000000UL,</span>
<span class="term-fg31">-        0xE4437ED6UL, 0x010E8828UL, 0x6F547FA9UL, 0x0ABFE4C3UL</span>
<span class="term-fg31">-    );</span>
<span class="term-fg31">-    static const secp256k1_scalar minus_b2 = SECP256K1_SCALAR_CONST(</span>
<span class="term-fg31">-        0xFFFFFFFFUL, 0xFFFFFFFFUL, 0xFFFFFFFFUL, 0xFFFFFFFEUL,</span>
<span class="term-fg31">-        0x8A280AC5UL, 0x0774346DUL, 0xD765CDA8UL, 0x3DB1562CUL</span>
<span class="term-fg31">-    );</span>
<span class="term-fg31">-    static const secp256k1_scalar g1 = SECP256K1_SCALAR_CONST(</span>
<span class="term-fg31">-        0x00000000UL, 0x00000000UL, 0x00000000UL, 0x00003086UL,</span>
<span class="term-fg31">-        0xD221A7D4UL, 0x6BCDE86CUL, 0x90E49284UL, 0xEB153DABUL</span>
<span class="term-fg31">-    );</span>
<span class="term-fg31">-    static const secp256k1_scalar g2 = SECP256K1_SCALAR_CONST(</span>
<span class="term-fg31">-        0x00000000UL, 0x00000000UL, 0x00000000UL, 0x0000E443UL,</span>
<span class="term-fg31">-        0x7ED6010EUL, 0x88286F54UL, 0x7FA90ABFUL, 0xE4C42212UL</span>
<span class="term-fg31">-    );</span>
<span class="term-fg31">-    VERIFY_CHECK(r1 != a);</span>
<span class="term-fg31">-    VERIFY_CHECK(r2 != a);</span>
<span class="term-fg31">-    &#47;* these _var calls are constant time since the shift amount is constant *&#47;</span>
<span class="term-fg31">-    secp256k1_scalar_mul_shift_var(&amp;c1, a, &amp;g1, 272);</span>
<span class="term-fg31">-    secp256k1_scalar_mul_shift_var(&amp;c2, a, &amp;g2, 272);</span>
<span class="term-fg31">-    secp256k1_scalar_mul(&amp;c1, &amp;c1, &amp;minus_b1);</span>
<span class="term-fg31">-    secp256k1_scalar_mul(&amp;c2, &amp;c2, &amp;minus_b2);</span>
<span class="term-fg31">-    secp256k1_scalar_add(r2, &amp;c1, &amp;c2);</span>
<span class="term-fg31">-    secp256k1_scalar_mul(r1, r2, &amp;minus_lambda);</span>
<span class="term-fg31">-    secp256k1_scalar_add(r1, r1, a);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-887ba5e6734b1c1ea82a4ea3" role="button"
                       aria-expanded="false" aria-controls="id-887ba5e6734b1c1ea82a4ea3">
                        <code>crypto/secp256k1/libsecp256k1/src/scalar_low.h</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/scalar_low.h" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-15</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-887ba5e6734b1c1ea82a4ea3"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;scalar_low.h op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;scalar_low.h</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 5574c44c7aeb3c8d41ec626adcb1b6994b6f05ef..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;scalar_low.h</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,15 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2015 Andrew Poelstra                                 *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef _SECP256K1_SCALAR_REPR_</span>
<span class="term-fg31">-#define _SECP256K1_SCALAR_REPR_</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &lt;stdint.h&gt;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** A scalar modulo the group order of the secp256k1 curve. *&#47;</span>
<span class="term-fg31">-typedef uint32_t secp256k1_scalar;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-b48d0b0b102a17418cb45758" role="button"
                       aria-expanded="false" aria-controls="id-b48d0b0b102a17418cb45758">
                        <code>crypto/secp256k1/libsecp256k1/src/scalar_low_impl.h</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/scalar_low_impl.h" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-114</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-b48d0b0b102a17418cb45758"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;scalar_low_impl.h op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;scalar_low_impl.h</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 4f94441f492a8144ebe579435ead2a66712eea17..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;scalar_low_impl.h</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,114 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2015 Andrew Poelstra                                 *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef _SECP256K1_SCALAR_REPR_IMPL_H_</span>
<span class="term-fg31">-#define _SECP256K1_SCALAR_REPR_IMPL_H_</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &quot;scalar.h&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &lt;string.h&gt;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static int secp256k1_scalar_is_even(const secp256k1_scalar *a) {</span>
<span class="term-fg31">-    return !(*a &amp; 1);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static void secp256k1_scalar_clear(secp256k1_scalar *r) { *r = 0; }</span>
<span class="term-fg31">-SECP256K1_INLINE static void secp256k1_scalar_set_int(secp256k1_scalar *r, unsigned int v) { *r = v; }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static unsigned int secp256k1_scalar_get_bits(const secp256k1_scalar *a, unsigned int offset, unsigned int count) {</span>
<span class="term-fg31">-    if (offset &lt; 32)</span>
<span class="term-fg31">-        return ((*a &gt;&gt; offset) &amp; ((((uint32_t)1) &lt;&lt; count) - 1));</span>
<span class="term-fg31">-    else</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static unsigned int secp256k1_scalar_get_bits_var(const secp256k1_scalar *a, unsigned int offset, unsigned int count) {</span>
<span class="term-fg31">-    return secp256k1_scalar_get_bits(a, offset, count);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static int secp256k1_scalar_check_overflow(const secp256k1_scalar *a) { return *a &gt;= EXHAUSTIVE_TEST_ORDER; }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_scalar_add(secp256k1_scalar *r, const secp256k1_scalar *a, const secp256k1_scalar *b) {</span>
<span class="term-fg31">-    *r = (*a + *b) % EXHAUSTIVE_TEST_ORDER;</span>
<span class="term-fg31">-    return *r &lt; *b;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_scalar_cadd_bit(secp256k1_scalar *r, unsigned int bit, int flag) {</span>
<span class="term-fg31">-    if (flag &amp;&amp; bit &lt; 32)</span>
<span class="term-fg31">-        *r += (1 &lt;&lt; bit);</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-    VERIFY_CHECK(secp256k1_scalar_check_overflow(r) == 0);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_scalar_set_b32(secp256k1_scalar *r, const unsigned char *b32, int *overflow) {</span>
<span class="term-fg31">-    const int base = 0x100 % EXHAUSTIVE_TEST_ORDER;</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    *r = 0;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 32; i++) {</span>
<span class="term-fg31">-       *r = ((*r * base) + b32[i]) % EXHAUSTIVE_TEST_ORDER;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    &#47;* just deny overflow, it basically always happens *&#47;</span>
<span class="term-fg31">-    if (overflow) *overflow = 0;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_scalar_get_b32(unsigned char *bin, const secp256k1_scalar* a) {</span>
<span class="term-fg31">-    memset(bin, 0, 32);</span>
<span class="term-fg31">-    bin[28] = *a &gt;&gt; 24; bin[29] = *a &gt;&gt; 16; bin[30] = *a &gt;&gt; 8; bin[31] = *a;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static int secp256k1_scalar_is_zero(const secp256k1_scalar *a) {</span>
<span class="term-fg31">-    return *a == 0;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_scalar_negate(secp256k1_scalar *r, const secp256k1_scalar *a) {</span>
<span class="term-fg31">-    if (*a == 0) {</span>
<span class="term-fg31">-        *r = 0;</span>
<span class="term-fg31">-    } else {</span>
<span class="term-fg31">-        *r = EXHAUSTIVE_TEST_ORDER - *a;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static int secp256k1_scalar_is_one(const secp256k1_scalar *a) {</span>
<span class="term-fg31">-    return *a == 1;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_scalar_is_high(const secp256k1_scalar *a) {</span>
<span class="term-fg31">-    return *a &gt; EXHAUSTIVE_TEST_ORDER &#47; 2;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_scalar_cond_negate(secp256k1_scalar *r, int flag) {</span>
<span class="term-fg31">-    if (flag) secp256k1_scalar_negate(r, r);</span>
<span class="term-fg31">-    return flag ? -1 : 1;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_scalar_mul(secp256k1_scalar *r, const secp256k1_scalar *a, const secp256k1_scalar *b) {</span>
<span class="term-fg31">-    *r = (*a * *b) % EXHAUSTIVE_TEST_ORDER;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_scalar_shr_int(secp256k1_scalar *r, int n) {</span>
<span class="term-fg31">-    int ret;</span>
<span class="term-fg31">-    VERIFY_CHECK(n &gt; 0);</span>
<span class="term-fg31">-    VERIFY_CHECK(n &lt; 16);</span>
<span class="term-fg31">-    ret = *r &amp; ((1 &lt;&lt; n) - 1);</span>
<span class="term-fg31">-    *r &gt;&gt;= n;</span>
<span class="term-fg31">-    return ret;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_scalar_sqr(secp256k1_scalar *r, const secp256k1_scalar *a) {</span>
<span class="term-fg31">-    *r = (*a * *a) % EXHAUSTIVE_TEST_ORDER;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_scalar_split_128(secp256k1_scalar *r1, secp256k1_scalar *r2, const secp256k1_scalar *a) {</span>
<span class="term-fg31">-    *r1 = *a;</span>
<span class="term-fg31">-    *r2 = 0;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static int secp256k1_scalar_eq(const secp256k1_scalar *a, const secp256k1_scalar *b) {</span>
<span class="term-fg31">-    return *a == *b;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-f8cc805722d579467a2d1a87" role="button"
                       aria-expanded="false" aria-controls="id-f8cc805722d579467a2d1a87">
                        <code>crypto/secp256k1/libsecp256k1/src/secp256k1.c</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/secp256k1.c" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-559</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-f8cc805722d579467a2d1a87"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;secp256k1.c op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;secp256k1.c</span>
<span class="term-fg1">deleted file mode 100755</span>
<span class="term-fg1">index 7d637bfad1c5967a1001b2248d71947c76cfbd35..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;secp256k1.c</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,559 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2013-2015 Pieter Wuille                              *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &quot;include&#47;secp256k1.h&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &quot;util.h&quot;</span>
<span class="term-fg31">-#include &quot;num_impl.h&quot;</span>
<span class="term-fg31">-#include &quot;field_impl.h&quot;</span>
<span class="term-fg31">-#include &quot;scalar_impl.h&quot;</span>
<span class="term-fg31">-#include &quot;group_impl.h&quot;</span>
<span class="term-fg31">-#include &quot;ecmult_impl.h&quot;</span>
<span class="term-fg31">-#include &quot;ecmult_const_impl.h&quot;</span>
<span class="term-fg31">-#include &quot;ecmult_gen_impl.h&quot;</span>
<span class="term-fg31">-#include &quot;ecdsa_impl.h&quot;</span>
<span class="term-fg31">-#include &quot;eckey_impl.h&quot;</span>
<span class="term-fg31">-#include &quot;hash_impl.h&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#define ARG_CHECK(cond) do { \</span>
<span class="term-fg31">-    if (EXPECT(!(cond), 0)) { \</span>
<span class="term-fg31">-        secp256k1_callback_call(&amp;ctx-&gt;illegal_callback, #cond); \</span>
<span class="term-fg31">-        return 0; \</span>
<span class="term-fg31">-    } \</span>
<span class="term-fg31">-} while(0)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void default_illegal_callback_fn(const char* str, void* data) {</span>
<span class="term-fg31">-    fprintf(stderr, &quot;[libsecp256k1] illegal argument: %s\n&quot;, str);</span>
<span class="term-fg31">-    abort();</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static const secp256k1_callback default_illegal_callback = {</span>
<span class="term-fg31">-    default_illegal_callback_fn,</span>
<span class="term-fg31">-    NULL</span>
<span class="term-fg31">-};</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void default_error_callback_fn(const char* str, void* data) {</span>
<span class="term-fg31">-    fprintf(stderr, &quot;[libsecp256k1] internal consistency check failed: %s\n&quot;, str);</span>
<span class="term-fg31">-    abort();</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static const secp256k1_callback default_error_callback = {</span>
<span class="term-fg31">-    default_error_callback_fn,</span>
<span class="term-fg31">-    NULL</span>
<span class="term-fg31">-};</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-struct secp256k1_context_struct {</span>
<span class="term-fg31">-    secp256k1_ecmult_context ecmult_ctx;</span>
<span class="term-fg31">-    secp256k1_ecmult_gen_context ecmult_gen_ctx;</span>
<span class="term-fg31">-    secp256k1_callback illegal_callback;</span>
<span class="term-fg31">-    secp256k1_callback error_callback;</span>
<span class="term-fg31">-};</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-secp256k1_context* secp256k1_context_create(unsigned int flags) {</span>
<span class="term-fg31">-    secp256k1_context* ret = (secp256k1_context*)checked_malloc(&amp;default_error_callback, sizeof(secp256k1_context));</span>
<span class="term-fg31">-    ret-&gt;illegal_callback = default_illegal_callback;</span>
<span class="term-fg31">-    ret-&gt;error_callback = default_error_callback;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    if (EXPECT((flags &amp; SECP256K1_FLAGS_TYPE_MASK) != SECP256K1_FLAGS_TYPE_CONTEXT, 0)) {</span>
<span class="term-fg31">-            secp256k1_callback_call(&amp;ret-&gt;illegal_callback,</span>
<span class="term-fg31">-                                    &quot;Invalid flags&quot;);</span>
<span class="term-fg31">-            free(ret);</span>
<span class="term-fg31">-            return NULL;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_ecmult_context_init(&amp;ret-&gt;ecmult_ctx);</span>
<span class="term-fg31">-    secp256k1_ecmult_gen_context_init(&amp;ret-&gt;ecmult_gen_ctx);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    if (flags &amp; SECP256K1_FLAGS_BIT_CONTEXT_SIGN) {</span>
<span class="term-fg31">-        secp256k1_ecmult_gen_context_build(&amp;ret-&gt;ecmult_gen_ctx, &amp;ret-&gt;error_callback);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    if (flags &amp; SECP256K1_FLAGS_BIT_CONTEXT_VERIFY) {</span>
<span class="term-fg31">-        secp256k1_ecmult_context_build(&amp;ret-&gt;ecmult_ctx, &amp;ret-&gt;error_callback);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    return ret;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-secp256k1_context* secp256k1_context_clone(const secp256k1_context* ctx) {</span>
<span class="term-fg31">-    secp256k1_context* ret = (secp256k1_context*)checked_malloc(&amp;ctx-&gt;error_callback, sizeof(secp256k1_context));</span>
<span class="term-fg31">-    ret-&gt;illegal_callback = ctx-&gt;illegal_callback;</span>
<span class="term-fg31">-    ret-&gt;error_callback = ctx-&gt;error_callback;</span>
<span class="term-fg31">-    secp256k1_ecmult_context_clone(&amp;ret-&gt;ecmult_ctx, &amp;ctx-&gt;ecmult_ctx, &amp;ctx-&gt;error_callback);</span>
<span class="term-fg31">-    secp256k1_ecmult_gen_context_clone(&amp;ret-&gt;ecmult_gen_ctx, &amp;ctx-&gt;ecmult_gen_ctx, &amp;ctx-&gt;error_callback);</span>
<span class="term-fg31">-    return ret;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void secp256k1_context_destroy(secp256k1_context* ctx) {</span>
<span class="term-fg31">-    if (ctx != NULL) {</span>
<span class="term-fg31">-        secp256k1_ecmult_context_clear(&amp;ctx-&gt;ecmult_ctx);</span>
<span class="term-fg31">-        secp256k1_ecmult_gen_context_clear(&amp;ctx-&gt;ecmult_gen_ctx);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        free(ctx);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void secp256k1_context_set_illegal_callback(secp256k1_context* ctx, void (*fun)(const char* message, void* data), const void* data) {</span>
<span class="term-fg31">-    if (fun == NULL) {</span>
<span class="term-fg31">-        fun = default_illegal_callback_fn;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    ctx-&gt;illegal_callback.fn = fun;</span>
<span class="term-fg31">-    ctx-&gt;illegal_callback.data = data;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void secp256k1_context_set_error_callback(secp256k1_context* ctx, void (*fun)(const char* message, void* data), const void* data) {</span>
<span class="term-fg31">-    if (fun == NULL) {</span>
<span class="term-fg31">-        fun = default_error_callback_fn;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    ctx-&gt;error_callback.fn = fun;</span>
<span class="term-fg31">-    ctx-&gt;error_callback.data = data;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int secp256k1_pubkey_load(const secp256k1_context* ctx, secp256k1_ge* ge, const secp256k1_pubkey* pubkey) {</span>
<span class="term-fg31">-    if (sizeof(secp256k1_ge_storage) == 64) {</span>
<span class="term-fg31">-        &#47;* When the secp256k1_ge_storage type is exactly 64 byte, use its</span>
<span class="term-fg31">-         * representation inside secp256k1_pubkey, as conversion is very fast.</span>
<span class="term-fg31">-         * Note that secp256k1_pubkey_save must use the same representation. *&#47;</span>
<span class="term-fg31">-        secp256k1_ge_storage s;</span>
<span class="term-fg31">-        memcpy(&amp;s, &amp;pubkey-&gt;data[0], 64);</span>
<span class="term-fg31">-        secp256k1_ge_from_storage(ge, &amp;s);</span>
<span class="term-fg31">-    } else {</span>
<span class="term-fg31">-        &#47;* Otherwise, fall back to 32-byte big endian for X and Y. *&#47;</span>
<span class="term-fg31">-        secp256k1_fe x, y;</span>
<span class="term-fg31">-        secp256k1_fe_set_b32(&amp;x, pubkey-&gt;data);</span>
<span class="term-fg31">-        secp256k1_fe_set_b32(&amp;y, pubkey-&gt;data + 32);</span>
<span class="term-fg31">-        secp256k1_ge_set_xy(ge, &amp;x, &amp;y);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    ARG_CHECK(!secp256k1_fe_is_zero(&amp;ge-&gt;x));</span>
<span class="term-fg31">-    return 1;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_pubkey_save(secp256k1_pubkey* pubkey, secp256k1_ge* ge) {</span>
<span class="term-fg31">-    if (sizeof(secp256k1_ge_storage) == 64) {</span>
<span class="term-fg31">-        secp256k1_ge_storage s;</span>
<span class="term-fg31">-        secp256k1_ge_to_storage(&amp;s, ge);</span>
<span class="term-fg31">-        memcpy(&amp;pubkey-&gt;data[0], &amp;s, 64);</span>
<span class="term-fg31">-    } else {</span>
<span class="term-fg31">-        VERIFY_CHECK(!secp256k1_ge_is_infinity(ge));</span>
<span class="term-fg31">-        secp256k1_fe_normalize_var(&amp;ge-&gt;x);</span>
<span class="term-fg31">-        secp256k1_fe_normalize_var(&amp;ge-&gt;y);</span>
<span class="term-fg31">-        secp256k1_fe_get_b32(pubkey-&gt;data, &amp;ge-&gt;x);</span>
<span class="term-fg31">-        secp256k1_fe_get_b32(pubkey-&gt;data + 32, &amp;ge-&gt;y);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-int secp256k1_ec_pubkey_parse(const secp256k1_context* ctx, secp256k1_pubkey* pubkey, const unsigned char *input, size_t inputlen) {</span>
<span class="term-fg31">-    secp256k1_ge Q;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    VERIFY_CHECK(ctx != NULL);</span>
<span class="term-fg31">-    ARG_CHECK(pubkey != NULL);</span>
<span class="term-fg31">-    memset(pubkey, 0, sizeof(*pubkey));</span>
<span class="term-fg31">-    ARG_CHECK(input != NULL);</span>
<span class="term-fg31">-    if (!secp256k1_eckey_pubkey_parse(&amp;Q, input, inputlen)) {</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_pubkey_save(pubkey, &amp;Q);</span>
<span class="term-fg31">-    secp256k1_ge_clear(&amp;Q);</span>
<span class="term-fg31">-    return 1;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-int secp256k1_ec_pubkey_serialize(const secp256k1_context* ctx, unsigned char *output, size_t *outputlen, const secp256k1_pubkey* pubkey, unsigned int flags) {</span>
<span class="term-fg31">-    secp256k1_ge Q;</span>
<span class="term-fg31">-    size_t len;</span>
<span class="term-fg31">-    int ret = 0;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    VERIFY_CHECK(ctx != NULL);</span>
<span class="term-fg31">-    ARG_CHECK(outputlen != NULL);</span>
<span class="term-fg31">-    ARG_CHECK(*outputlen &gt;= ((flags &amp; SECP256K1_FLAGS_BIT_COMPRESSION) ? 33 : 65));</span>
<span class="term-fg31">-    len = *outputlen;</span>
<span class="term-fg31">-    *outputlen = 0;</span>
<span class="term-fg31">-    ARG_CHECK(output != NULL);</span>
<span class="term-fg31">-    memset(output, 0, len);</span>
<span class="term-fg31">-    ARG_CHECK(pubkey != NULL);</span>
<span class="term-fg31">-    ARG_CHECK((flags &amp; SECP256K1_FLAGS_TYPE_MASK) == SECP256K1_FLAGS_TYPE_COMPRESSION);</span>
<span class="term-fg31">-    if (secp256k1_pubkey_load(ctx, &amp;Q, pubkey)) {</span>
<span class="term-fg31">-        ret = secp256k1_eckey_pubkey_serialize(&amp;Q, output, &amp;len, flags &amp; SECP256K1_FLAGS_BIT_COMPRESSION);</span>
<span class="term-fg31">-        if (ret) {</span>
<span class="term-fg31">-            *outputlen = len;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    return ret;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_ecdsa_signature_load(const secp256k1_context* ctx, secp256k1_scalar* r, secp256k1_scalar* s, const secp256k1_ecdsa_signature* sig) {</span>
<span class="term-fg31">-    (void)ctx;</span>
<span class="term-fg31">-    if (sizeof(secp256k1_scalar) == 32) {</span>
<span class="term-fg31">-        &#47;* When the secp256k1_scalar type is exactly 32 byte, use its</span>
<span class="term-fg31">-         * representation inside secp256k1_ecdsa_signature, as conversion is very fast.</span>
<span class="term-fg31">-         * Note that secp256k1_ecdsa_signature_save must use the same representation. *&#47;</span>
<span class="term-fg31">-        memcpy(r, &amp;sig-&gt;data[0], 32);</span>
<span class="term-fg31">-        memcpy(s, &amp;sig-&gt;data[32], 32);</span>
<span class="term-fg31">-    } else {</span>
<span class="term-fg31">-        secp256k1_scalar_set_b32(r, &amp;sig-&gt;data[0], NULL);</span>
<span class="term-fg31">-        secp256k1_scalar_set_b32(s, &amp;sig-&gt;data[32], NULL);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_ecdsa_signature_save(secp256k1_ecdsa_signature* sig, const secp256k1_scalar* r, const secp256k1_scalar* s) {</span>
<span class="term-fg31">-    if (sizeof(secp256k1_scalar) == 32) {</span>
<span class="term-fg31">-        memcpy(&amp;sig-&gt;data[0], r, 32);</span>
<span class="term-fg31">-        memcpy(&amp;sig-&gt;data[32], s, 32);</span>
<span class="term-fg31">-    } else {</span>
<span class="term-fg31">-        secp256k1_scalar_get_b32(&amp;sig-&gt;data[0], r);</span>
<span class="term-fg31">-        secp256k1_scalar_get_b32(&amp;sig-&gt;data[32], s);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-int secp256k1_ecdsa_signature_parse_der(const secp256k1_context* ctx, secp256k1_ecdsa_signature* sig, const unsigned char *input, size_t inputlen) {</span>
<span class="term-fg31">-    secp256k1_scalar r, s;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    VERIFY_CHECK(ctx != NULL);</span>
<span class="term-fg31">-    ARG_CHECK(sig != NULL);</span>
<span class="term-fg31">-    ARG_CHECK(input != NULL);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    if (secp256k1_ecdsa_sig_parse(&amp;r, &amp;s, input, inputlen)) {</span>
<span class="term-fg31">-        secp256k1_ecdsa_signature_save(sig, &amp;r, &amp;s);</span>
<span class="term-fg31">-        return 1;</span>
<span class="term-fg31">-    } else {</span>
<span class="term-fg31">-        memset(sig, 0, sizeof(*sig));</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-int secp256k1_ecdsa_signature_parse_compact(const secp256k1_context* ctx, secp256k1_ecdsa_signature* sig, const unsigned char *input64) {</span>
<span class="term-fg31">-    secp256k1_scalar r, s;</span>
<span class="term-fg31">-    int ret = 1;</span>
<span class="term-fg31">-    int overflow = 0;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    VERIFY_CHECK(ctx != NULL);</span>
<span class="term-fg31">-    ARG_CHECK(sig != NULL);</span>
<span class="term-fg31">-    ARG_CHECK(input64 != NULL);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_scalar_set_b32(&amp;r, &amp;input64[0], &amp;overflow);</span>
<span class="term-fg31">-    ret &amp;= !overflow;</span>
<span class="term-fg31">-    secp256k1_scalar_set_b32(&amp;s, &amp;input64[32], &amp;overflow);</span>
<span class="term-fg31">-    ret &amp;= !overflow;</span>
<span class="term-fg31">-    if (ret) {</span>
<span class="term-fg31">-        secp256k1_ecdsa_signature_save(sig, &amp;r, &amp;s);</span>
<span class="term-fg31">-    } else {</span>
<span class="term-fg31">-        memset(sig, 0, sizeof(*sig));</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    return ret;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-int secp256k1_ecdsa_signature_serialize_der(const secp256k1_context* ctx, unsigned char *output, size_t *outputlen, const secp256k1_ecdsa_signature* sig) {</span>
<span class="term-fg31">-    secp256k1_scalar r, s;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    VERIFY_CHECK(ctx != NULL);</span>
<span class="term-fg31">-    ARG_CHECK(output != NULL);</span>
<span class="term-fg31">-    ARG_CHECK(outputlen != NULL);</span>
<span class="term-fg31">-    ARG_CHECK(sig != NULL);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_ecdsa_signature_load(ctx, &amp;r, &amp;s, sig);</span>
<span class="term-fg31">-    return secp256k1_ecdsa_sig_serialize(output, outputlen, &amp;r, &amp;s);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-int secp256k1_ecdsa_signature_serialize_compact(const secp256k1_context* ctx, unsigned char *output64, const secp256k1_ecdsa_signature* sig) {</span>
<span class="term-fg31">-    secp256k1_scalar r, s;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    VERIFY_CHECK(ctx != NULL);</span>
<span class="term-fg31">-    ARG_CHECK(output64 != NULL);</span>
<span class="term-fg31">-    ARG_CHECK(sig != NULL);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_ecdsa_signature_load(ctx, &amp;r, &amp;s, sig);</span>
<span class="term-fg31">-    secp256k1_scalar_get_b32(&amp;output64[0], &amp;r);</span>
<span class="term-fg31">-    secp256k1_scalar_get_b32(&amp;output64[32], &amp;s);</span>
<span class="term-fg31">-    return 1;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-int secp256k1_ecdsa_signature_normalize(const secp256k1_context* ctx, secp256k1_ecdsa_signature *sigout, const secp256k1_ecdsa_signature *sigin) {</span>
<span class="term-fg31">-    secp256k1_scalar r, s;</span>
<span class="term-fg31">-    int ret = 0;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    VERIFY_CHECK(ctx != NULL);</span>
<span class="term-fg31">-    ARG_CHECK(sigin != NULL);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_ecdsa_signature_load(ctx, &amp;r, &amp;s, sigin);</span>
<span class="term-fg31">-    ret = secp256k1_scalar_is_high(&amp;s);</span>
<span class="term-fg31">-    if (sigout != NULL) {</span>
<span class="term-fg31">-        if (ret) {</span>
<span class="term-fg31">-            secp256k1_scalar_negate(&amp;s, &amp;s);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        secp256k1_ecdsa_signature_save(sigout, &amp;r, &amp;s);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    return ret;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-int secp256k1_ecdsa_verify(const secp256k1_context* ctx, const secp256k1_ecdsa_signature *sig, const unsigned char *msg32, const secp256k1_pubkey *pubkey) {</span>
<span class="term-fg31">-    secp256k1_ge q;</span>
<span class="term-fg31">-    secp256k1_scalar r, s;</span>
<span class="term-fg31">-    secp256k1_scalar m;</span>
<span class="term-fg31">-    VERIFY_CHECK(ctx != NULL);</span>
<span class="term-fg31">-    ARG_CHECK(secp256k1_ecmult_context_is_built(&amp;ctx-&gt;ecmult_ctx));</span>
<span class="term-fg31">-    ARG_CHECK(msg32 != NULL);</span>
<span class="term-fg31">-    ARG_CHECK(sig != NULL);</span>
<span class="term-fg31">-    ARG_CHECK(pubkey != NULL);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_scalar_set_b32(&amp;m, msg32, NULL);</span>
<span class="term-fg31">-    secp256k1_ecdsa_signature_load(ctx, &amp;r, &amp;s, sig);</span>
<span class="term-fg31">-    return (!secp256k1_scalar_is_high(&amp;s) &amp;&amp;</span>
<span class="term-fg31">-            secp256k1_pubkey_load(ctx, &amp;q, pubkey) &amp;&amp;</span>
<span class="term-fg31">-            secp256k1_ecdsa_sig_verify(&amp;ctx-&gt;ecmult_ctx, &amp;r, &amp;s, &amp;q, &amp;m));</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int nonce_function_rfc6979(unsigned char *nonce32, const unsigned char *msg32, const unsigned char *key32, const unsigned char *algo16, void *data, unsigned int counter) {</span>
<span class="term-fg31">-   unsigned char keydata[112];</span>
<span class="term-fg31">-   int keylen = 64;</span>
<span class="term-fg31">-   secp256k1_rfc6979_hmac_sha256_t rng;</span>
<span class="term-fg31">-   unsigned int i;</span>
<span class="term-fg31">-   &#47;* We feed a byte array to the PRNG as input, consisting of:</span>
<span class="term-fg31">-    * - the private key (32 bytes) and message (32 bytes), see RFC 6979 3.2d.</span>
<span class="term-fg31">-    * - optionally 32 extra bytes of data, see RFC 6979 3.6 Additional Data.</span>
<span class="term-fg31">-    * - optionally 16 extra bytes with the algorithm name.</span>
<span class="term-fg31">-    * Because the arguments have distinct fixed lengths it is not possible for</span>
<span class="term-fg31">-    *  different argument mixtures to emulate each other and result in the same</span>
<span class="term-fg31">-    *  nonces.</span>
<span class="term-fg31">-    *&#47;</span>
<span class="term-fg31">-   memcpy(keydata, key32, 32);</span>
<span class="term-fg31">-   memcpy(keydata + 32, msg32, 32);</span>
<span class="term-fg31">-   if (data != NULL) {</span>
<span class="term-fg31">-       memcpy(keydata + 64, data, 32);</span>
<span class="term-fg31">-       keylen = 96;</span>
<span class="term-fg31">-   }</span>
<span class="term-fg31">-   if (algo16 != NULL) {</span>
<span class="term-fg31">-       memcpy(keydata + keylen, algo16, 16);</span>
<span class="term-fg31">-       keylen += 16;</span>
<span class="term-fg31">-   }</span>
<span class="term-fg31">-   secp256k1_rfc6979_hmac_sha256_initialize(&amp;rng, keydata, keylen);</span>
<span class="term-fg31">-   memset(keydata, 0, sizeof(keydata));</span>
<span class="term-fg31">-   for (i = 0; i &lt;= counter; i++) {</span>
<span class="term-fg31">-       secp256k1_rfc6979_hmac_sha256_generate(&amp;rng, nonce32, 32);</span>
<span class="term-fg31">-   }</span>
<span class="term-fg31">-   secp256k1_rfc6979_hmac_sha256_finalize(&amp;rng);</span>
<span class="term-fg31">-   return 1;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-const secp256k1_nonce_function secp256k1_nonce_function_rfc6979 = nonce_function_rfc6979;</span>
<span class="term-fg31">-const secp256k1_nonce_function secp256k1_nonce_function_default = nonce_function_rfc6979;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-int secp256k1_ecdsa_sign(const secp256k1_context* ctx, secp256k1_ecdsa_signature *signature, const unsigned char *msg32, const unsigned char *seckey, secp256k1_nonce_function noncefp, const void* noncedata) {</span>
<span class="term-fg31">-    secp256k1_scalar r, s;</span>
<span class="term-fg31">-    secp256k1_scalar sec, non, msg;</span>
<span class="term-fg31">-    int ret = 0;</span>
<span class="term-fg31">-    int overflow = 0;</span>
<span class="term-fg31">-    VERIFY_CHECK(ctx != NULL);</span>
<span class="term-fg31">-    ARG_CHECK(secp256k1_ecmult_gen_context_is_built(&amp;ctx-&gt;ecmult_gen_ctx));</span>
<span class="term-fg31">-    ARG_CHECK(msg32 != NULL);</span>
<span class="term-fg31">-    ARG_CHECK(signature != NULL);</span>
<span class="term-fg31">-    ARG_CHECK(seckey != NULL);</span>
<span class="term-fg31">-    if (noncefp == NULL) {</span>
<span class="term-fg31">-        noncefp = secp256k1_nonce_function_default;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_scalar_set_b32(&amp;sec, seckey, &amp;overflow);</span>
<span class="term-fg31">-    &#47;* Fail if the secret key is invalid. *&#47;</span>
<span class="term-fg31">-    if (!overflow &amp;&amp; !secp256k1_scalar_is_zero(&amp;sec)) {</span>
<span class="term-fg31">-        unsigned char nonce32[32];</span>
<span class="term-fg31">-        unsigned int count = 0;</span>
<span class="term-fg31">-        secp256k1_scalar_set_b32(&amp;msg, msg32, NULL);</span>
<span class="term-fg31">-        while (1) {</span>
<span class="term-fg31">-            ret = noncefp(nonce32, msg32, seckey, NULL, (void*)noncedata, count);</span>
<span class="term-fg31">-            if (!ret) {</span>
<span class="term-fg31">-                break;</span>
<span class="term-fg31">-            }</span>
<span class="term-fg31">-            secp256k1_scalar_set_b32(&amp;non, nonce32, &amp;overflow);</span>
<span class="term-fg31">-            if (!overflow &amp;&amp; !secp256k1_scalar_is_zero(&amp;non)) {</span>
<span class="term-fg31">-                if (secp256k1_ecdsa_sig_sign(&amp;ctx-&gt;ecmult_gen_ctx, &amp;r, &amp;s, &amp;sec, &amp;msg, &amp;non, NULL)) {</span>
<span class="term-fg31">-                    break;</span>
<span class="term-fg31">-                }</span>
<span class="term-fg31">-            }</span>
<span class="term-fg31">-            count++;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        memset(nonce32, 0, 32);</span>
<span class="term-fg31">-        secp256k1_scalar_clear(&amp;msg);</span>
<span class="term-fg31">-        secp256k1_scalar_clear(&amp;non);</span>
<span class="term-fg31">-        secp256k1_scalar_clear(&amp;sec);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    if (ret) {</span>
<span class="term-fg31">-        secp256k1_ecdsa_signature_save(signature, &amp;r, &amp;s);</span>
<span class="term-fg31">-    } else {</span>
<span class="term-fg31">-        memset(signature, 0, sizeof(*signature));</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    return ret;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-int secp256k1_ec_seckey_verify(const secp256k1_context* ctx, const unsigned char *seckey) {</span>
<span class="term-fg31">-    secp256k1_scalar sec;</span>
<span class="term-fg31">-    int ret;</span>
<span class="term-fg31">-    int overflow;</span>
<span class="term-fg31">-    VERIFY_CHECK(ctx != NULL);</span>
<span class="term-fg31">-    ARG_CHECK(seckey != NULL);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_scalar_set_b32(&amp;sec, seckey, &amp;overflow);</span>
<span class="term-fg31">-    ret = !overflow &amp;&amp; !secp256k1_scalar_is_zero(&amp;sec);</span>
<span class="term-fg31">-    secp256k1_scalar_clear(&amp;sec);</span>
<span class="term-fg31">-    return ret;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-int secp256k1_ec_pubkey_create(const secp256k1_context* ctx, secp256k1_pubkey *pubkey, const unsigned char *seckey) {</span>
<span class="term-fg31">-    secp256k1_gej pj;</span>
<span class="term-fg31">-    secp256k1_ge p;</span>
<span class="term-fg31">-    secp256k1_scalar sec;</span>
<span class="term-fg31">-    int overflow;</span>
<span class="term-fg31">-    int ret = 0;</span>
<span class="term-fg31">-    VERIFY_CHECK(ctx != NULL);</span>
<span class="term-fg31">-    ARG_CHECK(pubkey != NULL);</span>
<span class="term-fg31">-    memset(pubkey, 0, sizeof(*pubkey));</span>
<span class="term-fg31">-    ARG_CHECK(secp256k1_ecmult_gen_context_is_built(&amp;ctx-&gt;ecmult_gen_ctx));</span>
<span class="term-fg31">-    ARG_CHECK(seckey != NULL);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_scalar_set_b32(&amp;sec, seckey, &amp;overflow);</span>
<span class="term-fg31">-    ret = (!overflow) &amp; (!secp256k1_scalar_is_zero(&amp;sec));</span>
<span class="term-fg31">-    if (ret) {</span>
<span class="term-fg31">-        secp256k1_ecmult_gen(&amp;ctx-&gt;ecmult_gen_ctx, &amp;pj, &amp;sec);</span>
<span class="term-fg31">-        secp256k1_ge_set_gej(&amp;p, &amp;pj);</span>
<span class="term-fg31">-        secp256k1_pubkey_save(pubkey, &amp;p);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_scalar_clear(&amp;sec);</span>
<span class="term-fg31">-    return ret;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-int secp256k1_ec_privkey_tweak_add(const secp256k1_context* ctx, unsigned char *seckey, const unsigned char *tweak) {</span>
<span class="term-fg31">-    secp256k1_scalar term;</span>
<span class="term-fg31">-    secp256k1_scalar sec;</span>
<span class="term-fg31">-    int ret = 0;</span>
<span class="term-fg31">-    int overflow = 0;</span>
<span class="term-fg31">-    VERIFY_CHECK(ctx != NULL);</span>
<span class="term-fg31">-    ARG_CHECK(seckey != NULL);</span>
<span class="term-fg31">-    ARG_CHECK(tweak != NULL);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_scalar_set_b32(&amp;term, tweak, &amp;overflow);</span>
<span class="term-fg31">-    secp256k1_scalar_set_b32(&amp;sec, seckey, NULL);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    ret = !overflow &amp;&amp; secp256k1_eckey_privkey_tweak_add(&amp;sec, &amp;term);</span>
<span class="term-fg31">-    memset(seckey, 0, 32);</span>
<span class="term-fg31">-    if (ret) {</span>
<span class="term-fg31">-        secp256k1_scalar_get_b32(seckey, &amp;sec);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_scalar_clear(&amp;sec);</span>
<span class="term-fg31">-    secp256k1_scalar_clear(&amp;term);</span>
<span class="term-fg31">-    return ret;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-int secp256k1_ec_pubkey_tweak_add(const secp256k1_context* ctx, secp256k1_pubkey *pubkey, const unsigned char *tweak) {</span>
<span class="term-fg31">-    secp256k1_ge p;</span>
<span class="term-fg31">-    secp256k1_scalar term;</span>
<span class="term-fg31">-    int ret = 0;</span>
<span class="term-fg31">-    int overflow = 0;</span>
<span class="term-fg31">-    VERIFY_CHECK(ctx != NULL);</span>
<span class="term-fg31">-    ARG_CHECK(secp256k1_ecmult_context_is_built(&amp;ctx-&gt;ecmult_ctx));</span>
<span class="term-fg31">-    ARG_CHECK(pubkey != NULL);</span>
<span class="term-fg31">-    ARG_CHECK(tweak != NULL);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_scalar_set_b32(&amp;term, tweak, &amp;overflow);</span>
<span class="term-fg31">-    ret = !overflow &amp;&amp; secp256k1_pubkey_load(ctx, &amp;p, pubkey);</span>
<span class="term-fg31">-    memset(pubkey, 0, sizeof(*pubkey));</span>
<span class="term-fg31">-    if (ret) {</span>
<span class="term-fg31">-        if (secp256k1_eckey_pubkey_tweak_add(&amp;ctx-&gt;ecmult_ctx, &amp;p, &amp;term)) {</span>
<span class="term-fg31">-            secp256k1_pubkey_save(pubkey, &amp;p);</span>
<span class="term-fg31">-        } else {</span>
<span class="term-fg31">-            ret = 0;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    return ret;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-int secp256k1_ec_privkey_tweak_mul(const secp256k1_context* ctx, unsigned char *seckey, const unsigned char *tweak) {</span>
<span class="term-fg31">-    secp256k1_scalar factor;</span>
<span class="term-fg31">-    secp256k1_scalar sec;</span>
<span class="term-fg31">-    int ret = 0;</span>
<span class="term-fg31">-    int overflow = 0;</span>
<span class="term-fg31">-    VERIFY_CHECK(ctx != NULL);</span>
<span class="term-fg31">-    ARG_CHECK(seckey != NULL);</span>
<span class="term-fg31">-    ARG_CHECK(tweak != NULL);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_scalar_set_b32(&amp;factor, tweak, &amp;overflow);</span>
<span class="term-fg31">-    secp256k1_scalar_set_b32(&amp;sec, seckey, NULL);</span>
<span class="term-fg31">-    ret = !overflow &amp;&amp; secp256k1_eckey_privkey_tweak_mul(&amp;sec, &amp;factor);</span>
<span class="term-fg31">-    memset(seckey, 0, 32);</span>
<span class="term-fg31">-    if (ret) {</span>
<span class="term-fg31">-        secp256k1_scalar_get_b32(seckey, &amp;sec);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_scalar_clear(&amp;sec);</span>
<span class="term-fg31">-    secp256k1_scalar_clear(&amp;factor);</span>
<span class="term-fg31">-    return ret;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-int secp256k1_ec_pubkey_tweak_mul(const secp256k1_context* ctx, secp256k1_pubkey *pubkey, const unsigned char *tweak) {</span>
<span class="term-fg31">-    secp256k1_ge p;</span>
<span class="term-fg31">-    secp256k1_scalar factor;</span>
<span class="term-fg31">-    int ret = 0;</span>
<span class="term-fg31">-    int overflow = 0;</span>
<span class="term-fg31">-    VERIFY_CHECK(ctx != NULL);</span>
<span class="term-fg31">-    ARG_CHECK(secp256k1_ecmult_context_is_built(&amp;ctx-&gt;ecmult_ctx));</span>
<span class="term-fg31">-    ARG_CHECK(pubkey != NULL);</span>
<span class="term-fg31">-    ARG_CHECK(tweak != NULL);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_scalar_set_b32(&amp;factor, tweak, &amp;overflow);</span>
<span class="term-fg31">-    ret = !overflow &amp;&amp; secp256k1_pubkey_load(ctx, &amp;p, pubkey);</span>
<span class="term-fg31">-    memset(pubkey, 0, sizeof(*pubkey));</span>
<span class="term-fg31">-    if (ret) {</span>
<span class="term-fg31">-        if (secp256k1_eckey_pubkey_tweak_mul(&amp;ctx-&gt;ecmult_ctx, &amp;p, &amp;factor)) {</span>
<span class="term-fg31">-            secp256k1_pubkey_save(pubkey, &amp;p);</span>
<span class="term-fg31">-        } else {</span>
<span class="term-fg31">-            ret = 0;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    return ret;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-int secp256k1_context_randomize(secp256k1_context* ctx, const unsigned char *seed32) {</span>
<span class="term-fg31">-    VERIFY_CHECK(ctx != NULL);</span>
<span class="term-fg31">-    ARG_CHECK(secp256k1_ecmult_gen_context_is_built(&amp;ctx-&gt;ecmult_gen_ctx));</span>
<span class="term-fg31">-    secp256k1_ecmult_gen_blind(&amp;ctx-&gt;ecmult_gen_ctx, seed32);</span>
<span class="term-fg31">-    return 1;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-int secp256k1_ec_pubkey_combine(const secp256k1_context* ctx, secp256k1_pubkey *pubnonce, const secp256k1_pubkey * const *pubnonces, size_t n) {</span>
<span class="term-fg31">-    size_t i;</span>
<span class="term-fg31">-    secp256k1_gej Qj;</span>
<span class="term-fg31">-    secp256k1_ge Q;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    ARG_CHECK(pubnonce != NULL);</span>
<span class="term-fg31">-    memset(pubnonce, 0, sizeof(*pubnonce));</span>
<span class="term-fg31">-    ARG_CHECK(n &gt;= 1);</span>
<span class="term-fg31">-    ARG_CHECK(pubnonces != NULL);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_gej_set_infinity(&amp;Qj);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    for (i = 0; i &lt; n; i++) {</span>
<span class="term-fg31">-        secp256k1_pubkey_load(ctx, &amp;Q, pubnonces[i]);</span>
<span class="term-fg31">-        secp256k1_gej_add_ge(&amp;Qj, &amp;Qj, &amp;Q);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    if (secp256k1_gej_is_infinity(&amp;Qj)) {</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_ge_set_gej(&amp;Q, &amp;Qj);</span>
<span class="term-fg31">-    secp256k1_pubkey_save(pubnonce, &amp;Q);</span>
<span class="term-fg31">-    return 1;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef ENABLE_MODULE_ECDH</span>
<span class="term-fg31">-# include &quot;modules&#47;ecdh&#47;main_impl.h&quot;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef ENABLE_MODULE_SCHNORR</span>
<span class="term-fg31">-# include &quot;modules&#47;schnorr&#47;main_impl.h&quot;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef ENABLE_MODULE_RECOVERY</span>
<span class="term-fg31">-# include &quot;modules&#47;recovery&#47;main_impl.h&quot;</span>
<span class="term-fg31">-#endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-6f36575a4a88845a66c65681" role="button"
                       aria-expanded="false" aria-controls="id-6f36575a4a88845a66c65681">
                        <code>crypto/secp256k1/libsecp256k1/src/testrand.h</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/testrand.h" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-38</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-6f36575a4a88845a66c65681"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;testrand.h op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;testrand.h</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index f8efa93c7c3f3194a16db581927f69fe2d645d40..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;testrand.h</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,38 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2013, 2014 Pieter Wuille                             *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef _SECP256K1_TESTRAND_H_</span>
<span class="term-fg31">-#define _SECP256K1_TESTRAND_H_</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#if defined HAVE_CONFIG_H</span>
<span class="term-fg31">-#include &quot;libsecp256k1-config.h&quot;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;* A non-cryptographic RNG used only for test infrastructure. *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Seed the pseudorandom number generator for testing. *&#47;</span>
<span class="term-fg31">-SECP256K1_INLINE static void secp256k1_rand_seed(const unsigned char *seed16);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Generate a pseudorandom number in the range [0..2**32-1]. *&#47;</span>
<span class="term-fg31">-static uint32_t secp256k1_rand32(void);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Generate a pseudorandom number in the range [0..2**bits-1]. Bits must be 1 or</span>
<span class="term-fg31">- *  more. *&#47;</span>
<span class="term-fg31">-static uint32_t secp256k1_rand_bits(int bits);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Generate a pseudorandom number in the range [0..range-1]. *&#47;</span>
<span class="term-fg31">-static uint32_t secp256k1_rand_int(uint32_t range);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Generate a pseudorandom 32-byte array. *&#47;</span>
<span class="term-fg31">-static void secp256k1_rand256(unsigned char *b32);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Generate a pseudorandom 32-byte array with long sequences of zero and one bits. *&#47;</span>
<span class="term-fg31">-static void secp256k1_rand256_test(unsigned char *b32);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Generate pseudorandom bytes with long sequences of zero and one bits. *&#47;</span>
<span class="term-fg31">-static void secp256k1_rand_bytes_test(unsigned char *bytes, size_t len);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-12ece64e5b91a07a0836ba9f" role="button"
                       aria-expanded="false" aria-controls="id-12ece64e5b91a07a0836ba9f">
                        <code>crypto/secp256k1/libsecp256k1/src/testrand_impl.h</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/testrand_impl.h" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-110</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-12ece64e5b91a07a0836ba9f"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;testrand_impl.h op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;testrand_impl.h</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 15c7b9f12df05216c762af9c4056f3477516bc43..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;testrand_impl.h</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,110 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2013-2015 Pieter Wuille                              *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef _SECP256K1_TESTRAND_IMPL_H_</span>
<span class="term-fg31">-#define _SECP256K1_TESTRAND_IMPL_H_</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &lt;stdint.h&gt;</span>
<span class="term-fg31">-#include &lt;string.h&gt;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &quot;testrand.h&quot;</span>
<span class="term-fg31">-#include &quot;hash.h&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static secp256k1_rfc6979_hmac_sha256_t secp256k1_test_rng;</span>
<span class="term-fg31">-static uint32_t secp256k1_test_rng_precomputed[8];</span>
<span class="term-fg31">-static int secp256k1_test_rng_precomputed_used = 8;</span>
<span class="term-fg31">-static uint64_t secp256k1_test_rng_integer;</span>
<span class="term-fg31">-static int secp256k1_test_rng_integer_bits_left = 0;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static void secp256k1_rand_seed(const unsigned char *seed16) {</span>
<span class="term-fg31">-    secp256k1_rfc6979_hmac_sha256_initialize(&amp;secp256k1_test_rng, seed16, 16);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-SECP256K1_INLINE static uint32_t secp256k1_rand32(void) {</span>
<span class="term-fg31">-    if (secp256k1_test_rng_precomputed_used == 8) {</span>
<span class="term-fg31">-        secp256k1_rfc6979_hmac_sha256_generate(&amp;secp256k1_test_rng, (unsigned char*)(&amp;secp256k1_test_rng_precomputed[0]), sizeof(secp256k1_test_rng_precomputed));</span>
<span class="term-fg31">-        secp256k1_test_rng_precomputed_used = 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    return secp256k1_test_rng_precomputed[secp256k1_test_rng_precomputed_used++];</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static uint32_t secp256k1_rand_bits(int bits) {</span>
<span class="term-fg31">-    uint32_t ret;</span>
<span class="term-fg31">-    if (secp256k1_test_rng_integer_bits_left &lt; bits) {</span>
<span class="term-fg31">-        secp256k1_test_rng_integer |= (((uint64_t)secp256k1_rand32()) &lt;&lt; secp256k1_test_rng_integer_bits_left);</span>
<span class="term-fg31">-        secp256k1_test_rng_integer_bits_left += 32;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    ret = secp256k1_test_rng_integer;</span>
<span class="term-fg31">-    secp256k1_test_rng_integer &gt;&gt;= bits;</span>
<span class="term-fg31">-    secp256k1_test_rng_integer_bits_left -= bits;</span>
<span class="term-fg31">-    ret &amp;= ((~((uint32_t)0)) &gt;&gt; (32 - bits));</span>
<span class="term-fg31">-    return ret;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static uint32_t secp256k1_rand_int(uint32_t range) {</span>
<span class="term-fg31">-    &#47;* We want a uniform integer between 0 and range-1, inclusive.</span>
<span class="term-fg31">-     * B is the smallest number such that range &lt;= 2**B.</span>
<span class="term-fg31">-     * two mechanisms implemented here:</span>
<span class="term-fg31">-     * - generate B bits numbers until one below range is found, and return it</span>
<span class="term-fg31">-     * - find the largest multiple M of range that is &lt;= 2**(B+A), generate B+A</span>
<span class="term-fg31">-     *   bits numbers until one below M is found, and return it modulo range</span>
<span class="term-fg31">-     * The second mechanism consumes A more bits of entropy in every iteration,</span>
<span class="term-fg31">-     * but may need fewer iterations due to M being closer to 2**(B+A) then</span>
<span class="term-fg31">-     * range is to 2**B. The array below (indexed by B) contains a 0 when the</span>
<span class="term-fg31">-     * first mechanism is to be used, and the number A otherwise.</span>
<span class="term-fg31">-     *&#47;</span>
<span class="term-fg31">-    static const int addbits[] = {0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, 1, 0};</span>
<span class="term-fg31">-    uint32_t trange, mult;</span>
<span class="term-fg31">-    int bits = 0;</span>
<span class="term-fg31">-    if (range &lt;= 1) {</span>
<span class="term-fg31">-        return 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    trange = range - 1;</span>
<span class="term-fg31">-    while (trange &gt; 0) {</span>
<span class="term-fg31">-        trange &gt;&gt;= 1;</span>
<span class="term-fg31">-        bits++;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    if (addbits[bits]) {</span>
<span class="term-fg31">-        bits = bits + addbits[bits];</span>
<span class="term-fg31">-        mult = ((~((uint32_t)0)) &gt;&gt; (32 - bits)) &#47; range;</span>
<span class="term-fg31">-        trange = range * mult;</span>
<span class="term-fg31">-    } else {</span>
<span class="term-fg31">-        trange = range;</span>
<span class="term-fg31">-        mult = 1;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    while(1) {</span>
<span class="term-fg31">-        uint32_t x = secp256k1_rand_bits(bits);</span>
<span class="term-fg31">-        if (x &lt; trange) {</span>
<span class="term-fg31">-            return (mult == 1) ? x : (x % range);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_rand256(unsigned char *b32) {</span>
<span class="term-fg31">-    secp256k1_rfc6979_hmac_sha256_generate(&amp;secp256k1_test_rng, b32, 32);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_rand_bytes_test(unsigned char *bytes, size_t len) {</span>
<span class="term-fg31">-    size_t bits = 0;</span>
<span class="term-fg31">-    memset(bytes, 0, len);</span>
<span class="term-fg31">-    while (bits &lt; len * 8) {</span>
<span class="term-fg31">-        int now;</span>
<span class="term-fg31">-        uint32_t val;</span>
<span class="term-fg31">-        now = 1 + (secp256k1_rand_bits(6) * secp256k1_rand_bits(5) + 16) &#47; 31;</span>
<span class="term-fg31">-        val = secp256k1_rand_bits(1);</span>
<span class="term-fg31">-        while (now &gt; 0 &amp;&amp; bits &lt; len * 8) {</span>
<span class="term-fg31">-            bytes[bits &#47; 8] |= val &lt;&lt; (bits % 8);</span>
<span class="term-fg31">-            now--;</span>
<span class="term-fg31">-            bits++;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void secp256k1_rand256_test(unsigned char *b32) {</span>
<span class="term-fg31">-    secp256k1_rand_bytes_test(b32, 32);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-65e7c11e14aff8cc206985b2" role="button"
                       aria-expanded="false" aria-controls="id-65e7c11e14aff8cc206985b2">
                        <code>crypto/secp256k1/libsecp256k1/src/tests.c</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/tests.c" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-4525</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-65e7c11e14aff8cc206985b2"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;tests.c op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;tests.c</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 9ae7d3028130637ba1159c4c9772cf94267e3711..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;tests.c</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,4525 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2013, 2014, 2015 Pieter Wuille, Gregory Maxwell      *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#if defined HAVE_CONFIG_H</span>
<span class="term-fg31">-#include &quot;libsecp256k1-config.h&quot;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &lt;stdio.h&gt;</span>
<span class="term-fg31">-#include &lt;stdlib.h&gt;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &lt;time.h&gt;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &quot;secp256k1.c&quot;</span>
<span class="term-fg31">-#include &quot;include&#47;secp256k1.h&quot;</span>
<span class="term-fg31">-#include &quot;testrand_impl.h&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef ENABLE_OPENSSL_TESTS</span>
<span class="term-fg31">-#include &quot;openssl&#47;bn.h&quot;</span>
<span class="term-fg31">-#include &quot;openssl&#47;ec.h&quot;</span>
<span class="term-fg31">-#include &quot;openssl&#47;ecdsa.h&quot;</span>
<span class="term-fg31">-#include &quot;openssl&#47;obj_mac.h&quot;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &quot;contrib&#47;lax_der_parsing.c&quot;</span>
<span class="term-fg31">-#include &quot;contrib&#47;lax_der_privatekey_parsing.c&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#if !defined(VG_CHECK)</span>
<span class="term-fg31">-# if defined(VALGRIND)</span>
<span class="term-fg31">-#  include &lt;valgrind&#47;memcheck.h&gt;</span>
<span class="term-fg31">-#  define VG_UNDEF(x,y) VALGRIND_MAKE_MEM_UNDEFINED((x),(y))</span>
<span class="term-fg31">-#  define VG_CHECK(x,y) VALGRIND_CHECK_MEM_IS_DEFINED((x),(y))</span>
<span class="term-fg31">-# else</span>
<span class="term-fg31">-#  define VG_UNDEF(x,y)</span>
<span class="term-fg31">-#  define VG_CHECK(x,y)</span>
<span class="term-fg31">-# endif</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int count = 64;</span>
<span class="term-fg31">-static secp256k1_context *ctx = NULL;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void counting_illegal_callback_fn(const char* str, void* data) {</span>
<span class="term-fg31">-    &#47;* Dummy callback function that just counts. *&#47;</span>
<span class="term-fg31">-    int32_t *p;</span>
<span class="term-fg31">-    (void)str;</span>
<span class="term-fg31">-    p = data;</span>
<span class="term-fg31">-    (*p)++;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void uncounting_illegal_callback_fn(const char* str, void* data) {</span>
<span class="term-fg31">-    &#47;* Dummy callback function that just counts (backwards). *&#47;</span>
<span class="term-fg31">-    int32_t *p;</span>
<span class="term-fg31">-    (void)str;</span>
<span class="term-fg31">-    p = data;</span>
<span class="term-fg31">-    (*p)--;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void random_field_element_test(secp256k1_fe *fe) {</span>
<span class="term-fg31">-    do {</span>
<span class="term-fg31">-        unsigned char b32[32];</span>
<span class="term-fg31">-        secp256k1_rand256_test(b32);</span>
<span class="term-fg31">-        if (secp256k1_fe_set_b32(fe, b32)) {</span>
<span class="term-fg31">-            break;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    } while(1);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void random_field_element_magnitude(secp256k1_fe *fe) {</span>
<span class="term-fg31">-    secp256k1_fe zero;</span>
<span class="term-fg31">-    int n = secp256k1_rand_int(9);</span>
<span class="term-fg31">-    secp256k1_fe_normalize(fe);</span>
<span class="term-fg31">-    if (n == 0) {</span>
<span class="term-fg31">-        return;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_fe_clear(&amp;zero);</span>
<span class="term-fg31">-    secp256k1_fe_negate(&amp;zero, &amp;zero, 0);</span>
<span class="term-fg31">-    secp256k1_fe_mul_int(&amp;zero, n - 1);</span>
<span class="term-fg31">-    secp256k1_fe_add(fe, &amp;zero);</span>
<span class="term-fg31">-    VERIFY_CHECK(fe-&gt;magnitude == n);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void random_group_element_test(secp256k1_ge *ge) {</span>
<span class="term-fg31">-    secp256k1_fe fe;</span>
<span class="term-fg31">-    do {</span>
<span class="term-fg31">-        random_field_element_test(&amp;fe);</span>
<span class="term-fg31">-        if (secp256k1_ge_set_xo_var(ge, &amp;fe, secp256k1_rand_bits(1))) {</span>
<span class="term-fg31">-            secp256k1_fe_normalize(&amp;ge-&gt;y);</span>
<span class="term-fg31">-            break;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    } while(1);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void random_group_element_jacobian_test(secp256k1_gej *gej, const secp256k1_ge *ge) {</span>
<span class="term-fg31">-    secp256k1_fe z2, z3;</span>
<span class="term-fg31">-    do {</span>
<span class="term-fg31">-        random_field_element_test(&amp;gej-&gt;z);</span>
<span class="term-fg31">-        if (!secp256k1_fe_is_zero(&amp;gej-&gt;z)) {</span>
<span class="term-fg31">-            break;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    } while(1);</span>
<span class="term-fg31">-    secp256k1_fe_sqr(&amp;z2, &amp;gej-&gt;z);</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;z3, &amp;z2, &amp;gej-&gt;z);</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;gej-&gt;x, &amp;ge-&gt;x, &amp;z2);</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;gej-&gt;y, &amp;ge-&gt;y, &amp;z3);</span>
<span class="term-fg31">-    gej-&gt;infinity = ge-&gt;infinity;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void random_scalar_order_test(secp256k1_scalar *num) {</span>
<span class="term-fg31">-    do {</span>
<span class="term-fg31">-        unsigned char b32[32];</span>
<span class="term-fg31">-        int overflow = 0;</span>
<span class="term-fg31">-        secp256k1_rand256_test(b32);</span>
<span class="term-fg31">-        secp256k1_scalar_set_b32(num, b32, &amp;overflow);</span>
<span class="term-fg31">-        if (overflow || secp256k1_scalar_is_zero(num)) {</span>
<span class="term-fg31">-            continue;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        break;</span>
<span class="term-fg31">-    } while(1);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void random_scalar_order(secp256k1_scalar *num) {</span>
<span class="term-fg31">-    do {</span>
<span class="term-fg31">-        unsigned char b32[32];</span>
<span class="term-fg31">-        int overflow = 0;</span>
<span class="term-fg31">-        secp256k1_rand256(b32);</span>
<span class="term-fg31">-        secp256k1_scalar_set_b32(num, b32, &amp;overflow);</span>
<span class="term-fg31">-        if (overflow || secp256k1_scalar_is_zero(num)) {</span>
<span class="term-fg31">-            continue;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        break;</span>
<span class="term-fg31">-    } while(1);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void run_context_tests(void) {</span>
<span class="term-fg31">-    secp256k1_pubkey pubkey;</span>
<span class="term-fg31">-    secp256k1_ecdsa_signature sig;</span>
<span class="term-fg31">-    unsigned char ctmp[32];</span>
<span class="term-fg31">-    int32_t ecount;</span>
<span class="term-fg31">-    int32_t ecount2;</span>
<span class="term-fg31">-    secp256k1_context *none = secp256k1_context_create(SECP256K1_CONTEXT_NONE);</span>
<span class="term-fg31">-    secp256k1_context *sign = secp256k1_context_create(SECP256K1_CONTEXT_SIGN);</span>
<span class="term-fg31">-    secp256k1_context *vrfy = secp256k1_context_create(SECP256K1_CONTEXT_VERIFY);</span>
<span class="term-fg31">-    secp256k1_context *both = secp256k1_context_create(SECP256K1_CONTEXT_SIGN | SECP256K1_CONTEXT_VERIFY);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_gej pubj;</span>
<span class="term-fg31">-    secp256k1_ge pub;</span>
<span class="term-fg31">-    secp256k1_scalar msg, key, nonce;</span>
<span class="term-fg31">-    secp256k1_scalar sigr, sigs;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    ecount = 0;</span>
<span class="term-fg31">-    ecount2 = 10;</span>
<span class="term-fg31">-    secp256k1_context_set_illegal_callback(vrfy, counting_illegal_callback_fn, &amp;ecount);</span>
<span class="term-fg31">-    secp256k1_context_set_illegal_callback(sign, counting_illegal_callback_fn, &amp;ecount2);</span>
<span class="term-fg31">-    secp256k1_context_set_error_callback(sign, counting_illegal_callback_fn, NULL);</span>
<span class="term-fg31">-    CHECK(vrfy-&gt;error_callback.fn != sign-&gt;error_callback.fn);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;*** clone and destroy all of them to make sure cloning was complete ***&#47;</span>
<span class="term-fg31">-    {</span>
<span class="term-fg31">-        secp256k1_context *ctx_tmp;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        ctx_tmp = none; none = secp256k1_context_clone(none); secp256k1_context_destroy(ctx_tmp);</span>
<span class="term-fg31">-        ctx_tmp = sign; sign = secp256k1_context_clone(sign); secp256k1_context_destroy(ctx_tmp);</span>
<span class="term-fg31">-        ctx_tmp = vrfy; vrfy = secp256k1_context_clone(vrfy); secp256k1_context_destroy(ctx_tmp);</span>
<span class="term-fg31">-        ctx_tmp = both; both = secp256k1_context_clone(both); secp256k1_context_destroy(ctx_tmp);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Verify that the error callback makes it across the clone. *&#47;</span>
<span class="term-fg31">-    CHECK(vrfy-&gt;error_callback.fn != sign-&gt;error_callback.fn);</span>
<span class="term-fg31">-    &#47;* And that it resets back to default. *&#47;</span>
<span class="term-fg31">-    secp256k1_context_set_error_callback(sign, NULL, NULL);</span>
<span class="term-fg31">-    CHECK(vrfy-&gt;error_callback.fn == sign-&gt;error_callback.fn);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;*** attempt to use them ***&#47;</span>
<span class="term-fg31">-    random_scalar_order_test(&amp;msg);</span>
<span class="term-fg31">-    random_scalar_order_test(&amp;key);</span>
<span class="term-fg31">-    secp256k1_ecmult_gen(&amp;both-&gt;ecmult_gen_ctx, &amp;pubj, &amp;key);</span>
<span class="term-fg31">-    secp256k1_ge_set_gej(&amp;pub, &amp;pubj);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Verify context-type checking illegal-argument errors. *&#47;</span>
<span class="term-fg31">-    memset(ctmp, 1, 32);</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_create(vrfy, &amp;pubkey, ctmp) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 1);</span>
<span class="term-fg31">-    VG_UNDEF(&amp;pubkey, sizeof(pubkey));</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_create(sign, &amp;pubkey, ctmp) == 1);</span>
<span class="term-fg31">-    VG_CHECK(&amp;pubkey, sizeof(pubkey));</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_sign(vrfy, &amp;sig, ctmp, ctmp, NULL, NULL) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 2);</span>
<span class="term-fg31">-    VG_UNDEF(&amp;sig, sizeof(sig));</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_sign(sign, &amp;sig, ctmp, ctmp, NULL, NULL) == 1);</span>
<span class="term-fg31">-    VG_CHECK(&amp;sig, sizeof(sig));</span>
<span class="term-fg31">-    CHECK(ecount2 == 10);</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_verify(sign, &amp;sig, ctmp, &amp;pubkey) == 0);</span>
<span class="term-fg31">-    CHECK(ecount2 == 11);</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_verify(vrfy, &amp;sig, ctmp, &amp;pubkey) == 1);</span>
<span class="term-fg31">-    CHECK(ecount == 2);</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_tweak_add(sign, &amp;pubkey, ctmp) == 0);</span>
<span class="term-fg31">-    CHECK(ecount2 == 12);</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_tweak_add(vrfy, &amp;pubkey, ctmp) == 1);</span>
<span class="term-fg31">-    CHECK(ecount == 2);</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_tweak_mul(sign, &amp;pubkey, ctmp) == 0);</span>
<span class="term-fg31">-    CHECK(ecount2 == 13);</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_tweak_mul(vrfy, &amp;pubkey, ctmp) == 1);</span>
<span class="term-fg31">-    CHECK(ecount == 2);</span>
<span class="term-fg31">-    CHECK(secp256k1_context_randomize(vrfy, ctmp) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 3);</span>
<span class="term-fg31">-    CHECK(secp256k1_context_randomize(sign, NULL) == 1);</span>
<span class="term-fg31">-    CHECK(ecount2 == 13);</span>
<span class="term-fg31">-    secp256k1_context_set_illegal_callback(vrfy, NULL, NULL);</span>
<span class="term-fg31">-    secp256k1_context_set_illegal_callback(sign, NULL, NULL);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* This shouldn&#39;t leak memory, due to already-set tests. *&#47;</span>
<span class="term-fg31">-    secp256k1_ecmult_gen_context_build(&amp;sign-&gt;ecmult_gen_ctx, NULL);</span>
<span class="term-fg31">-    secp256k1_ecmult_context_build(&amp;vrfy-&gt;ecmult_ctx, NULL);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* obtain a working nonce *&#47;</span>
<span class="term-fg31">-    do {</span>
<span class="term-fg31">-        random_scalar_order_test(&amp;nonce);</span>
<span class="term-fg31">-    } while(!secp256k1_ecdsa_sig_sign(&amp;both-&gt;ecmult_gen_ctx, &amp;sigr, &amp;sigs, &amp;key, &amp;msg, &amp;nonce, NULL));</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* try signing *&#47;</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_sig_sign(&amp;sign-&gt;ecmult_gen_ctx, &amp;sigr, &amp;sigs, &amp;key, &amp;msg, &amp;nonce, NULL));</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_sig_sign(&amp;both-&gt;ecmult_gen_ctx, &amp;sigr, &amp;sigs, &amp;key, &amp;msg, &amp;nonce, NULL));</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* try verifying *&#47;</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_sig_verify(&amp;vrfy-&gt;ecmult_ctx, &amp;sigr, &amp;sigs, &amp;pub, &amp;msg));</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_sig_verify(&amp;both-&gt;ecmult_ctx, &amp;sigr, &amp;sigs, &amp;pub, &amp;msg));</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* cleanup *&#47;</span>
<span class="term-fg31">-    secp256k1_context_destroy(none);</span>
<span class="term-fg31">-    secp256k1_context_destroy(sign);</span>
<span class="term-fg31">-    secp256k1_context_destroy(vrfy);</span>
<span class="term-fg31">-    secp256k1_context_destroy(both);</span>
<span class="term-fg31">-    &#47;* Defined as no-op. *&#47;</span>
<span class="term-fg31">-    secp256k1_context_destroy(NULL);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;***** HASH TESTS *****&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void run_sha256_tests(void) {</span>
<span class="term-fg31">-    static const char *inputs[8] = {</span>
<span class="term-fg31">-        &quot;&quot;, &quot;abc&quot;, &quot;message digest&quot;, &quot;secure hash algorithm&quot;, &quot;SHA256 is considered to be safe&quot;,</span>
<span class="term-fg31">-        &quot;abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq&quot;,</span>
<span class="term-fg31">-        &quot;For this sample, this 63-byte string will be used as input data&quot;,</span>
<span class="term-fg31">-        &quot;This is exactly 64 bytes long, not counting the terminating byte&quot;</span>
<span class="term-fg31">-    };</span>
<span class="term-fg31">-    static const unsigned char outputs[8][32] = {</span>
<span class="term-fg31">-        {0xe3, 0xb0, 0xc4, 0x42, 0x98, 0xfc, 0x1c, 0x14, 0x9a, 0xfb, 0xf4, 0xc8, 0x99, 0x6f, 0xb9, 0x24, 0x27, 0xae, 0x41, 0xe4, 0x64, 0x9b, 0x93, 0x4c, 0xa4, 0x95, 0x99, 0x1b, 0x78, 0x52, 0xb8, 0x55},</span>
<span class="term-fg31">-        {0xba, 0x78, 0x16, 0xbf, 0x8f, 0x01, 0xcf, 0xea, 0x41, 0x41, 0x40, 0xde, 0x5d, 0xae, 0x22, 0x23, 0xb0, 0x03, 0x61, 0xa3, 0x96, 0x17, 0x7a, 0x9c, 0xb4, 0x10, 0xff, 0x61, 0xf2, 0x00, 0x15, 0xad},</span>
<span class="term-fg31">-        {0xf7, 0x84, 0x6f, 0x55, 0xcf, 0x23, 0xe1, 0x4e, 0xeb, 0xea, 0xb5, 0xb4, 0xe1, 0x55, 0x0c, 0xad, 0x5b, 0x50, 0x9e, 0x33, 0x48, 0xfb, 0xc4, 0xef, 0xa3, 0xa1, 0x41, 0x3d, 0x39, 0x3c, 0xb6, 0x50},</span>
<span class="term-fg31">-        {0xf3, 0x0c, 0xeb, 0x2b, 0xb2, 0x82, 0x9e, 0x79, 0xe4, 0xca, 0x97, 0x53, 0xd3, 0x5a, 0x8e, 0xcc, 0x00, 0x26, 0x2d, 0x16, 0x4c, 0xc0, 0x77, 0x08, 0x02, 0x95, 0x38, 0x1c, 0xbd, 0x64, 0x3f, 0x0d},</span>
<span class="term-fg31">-        {0x68, 0x19, 0xd9, 0x15, 0xc7, 0x3f, 0x4d, 0x1e, 0x77, 0xe4, 0xe1, 0xb5, 0x2d, 0x1f, 0xa0, 0xf9, 0xcf, 0x9b, 0xea, 0xea, 0xd3, 0x93, 0x9f, 0x15, 0x87, 0x4b, 0xd9, 0x88, 0xe2, 0xa2, 0x36, 0x30},</span>
<span class="term-fg31">-        {0x24, 0x8d, 0x6a, 0x61, 0xd2, 0x06, 0x38, 0xb8, 0xe5, 0xc0, 0x26, 0x93, 0x0c, 0x3e, 0x60, 0x39, 0xa3, 0x3c, 0xe4, 0x59, 0x64, 0xff, 0x21, 0x67, 0xf6, 0xec, 0xed, 0xd4, 0x19, 0xdb, 0x06, 0xc1},</span>
<span class="term-fg31">-        {0xf0, 0x8a, 0x78, 0xcb, 0xba, 0xee, 0x08, 0x2b, 0x05, 0x2a, 0xe0, 0x70, 0x8f, 0x32, 0xfa, 0x1e, 0x50, 0xc5, 0xc4, 0x21, 0xaa, 0x77, 0x2b, 0xa5, 0xdb, 0xb4, 0x06, 0xa2, 0xea, 0x6b, 0xe3, 0x42},</span>
<span class="term-fg31">-        {0xab, 0x64, 0xef, 0xf7, 0xe8, 0x8e, 0x2e, 0x46, 0x16, 0x5e, 0x29, 0xf2, 0xbc, 0xe4, 0x18, 0x26, 0xbd, 0x4c, 0x7b, 0x35, 0x52, 0xf6, 0xb3, 0x82, 0xa9, 0xe7, 0xd3, 0xaf, 0x47, 0xc2, 0x45, 0xf8}</span>
<span class="term-fg31">-    };</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 8; i++) {</span>
<span class="term-fg31">-        unsigned char out[32];</span>
<span class="term-fg31">-        secp256k1_sha256_t hasher;</span>
<span class="term-fg31">-        secp256k1_sha256_initialize(&amp;hasher);</span>
<span class="term-fg31">-        secp256k1_sha256_write(&amp;hasher, (const unsigned char*)(inputs[i]), strlen(inputs[i]));</span>
<span class="term-fg31">-        secp256k1_sha256_finalize(&amp;hasher, out);</span>
<span class="term-fg31">-        CHECK(memcmp(out, outputs[i], 32) == 0);</span>
<span class="term-fg31">-        if (strlen(inputs[i]) &gt; 0) {</span>
<span class="term-fg31">-            int split = secp256k1_rand_int(strlen(inputs[i]));</span>
<span class="term-fg31">-            secp256k1_sha256_initialize(&amp;hasher);</span>
<span class="term-fg31">-            secp256k1_sha256_write(&amp;hasher, (const unsigned char*)(inputs[i]), split);</span>
<span class="term-fg31">-            secp256k1_sha256_write(&amp;hasher, (const unsigned char*)(inputs[i] + split), strlen(inputs[i]) - split);</span>
<span class="term-fg31">-            secp256k1_sha256_finalize(&amp;hasher, out);</span>
<span class="term-fg31">-            CHECK(memcmp(out, outputs[i], 32) == 0);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void run_hmac_sha256_tests(void) {</span>
<span class="term-fg31">-    static const char *keys[6] = {</span>
<span class="term-fg31">-        &quot;\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b&quot;,</span>
<span class="term-fg31">-        &quot;\x4a\x65\x66\x65&quot;,</span>
<span class="term-fg31">-        &quot;\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa&quot;,</span>
<span class="term-fg31">-        &quot;\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19&quot;,</span>
<span class="term-fg31">-        &quot;\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa&quot;,</span>
<span class="term-fg31">-        &quot;\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa&quot;</span>
<span class="term-fg31">-    };</span>
<span class="term-fg31">-    static const char *inputs[6] = {</span>
<span class="term-fg31">-        &quot;\x48\x69\x20\x54\x68\x65\x72\x65&quot;,</span>
<span class="term-fg31">-        &quot;\x77\x68\x61\x74\x20\x64\x6f\x20\x79\x61\x20\x77\x61\x6e\x74\x20\x66\x6f\x72\x20\x6e\x6f\x74\x68\x69\x6e\x67\x3f&quot;,</span>
<span class="term-fg31">-        &quot;\xdd\xdd\xdd\xdd\xdd\xdd\xdd\xdd\xdd\xdd\xdd\xdd\xdd\xdd\xdd\xdd\xdd\xdd\xdd\xdd\xdd\xdd\xdd\xdd\xdd\xdd\xdd\xdd\xdd\xdd\xdd\xdd\xdd\xdd\xdd\xdd\xdd\xdd\xdd\xdd\xdd\xdd\xdd\xdd\xdd\xdd\xdd\xdd\xdd\xdd&quot;,</span>
<span class="term-fg31">-        &quot;\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd&quot;,</span>
<span class="term-fg31">-        &quot;\x54\x65\x73\x74\x20\x55\x73\x69\x6e\x67\x20\x4c\x61\x72\x67\x65\x72\x20\x54\x68\x61\x6e\x20\x42\x6c\x6f\x63\x6b\x2d\x53\x69\x7a\x65\x20\x4b\x65\x79\x20\x2d\x20\x48\x61\x73\x68\x20\x4b\x65\x79\x20\x46\x69\x72\x73\x74&quot;,</span>
<span class="term-fg31">-        &quot;\x54\x68\x69\x73\x20\x69\x73\x20\x61\x20\x74\x65\x73\x74\x20\x75\x73\x69\x6e\x67\x20\x61\x20\x6c\x61\x72\x67\x65\x72\x20\x74\x68\x61\x6e\x20\x62\x6c\x6f\x63\x6b\x2d\x73\x69\x7a\x65\x20\x6b\x65\x79\x20\x61\x6e\x64\x20\x61\x20\x6c\x61\x72\x67\x65\x72\x20\x74\x68\x61\x6e\x20\x62\x6c\x6f\x63\x6b\x2d\x73\x69\x7a\x65\x20\x64\x61\x74\x61\x2e\x20\x54\x68\x65\x20\x6b\x65\x79\x20\x6e\x65\x65\x64\x73\x20\x74\x6f\x20\x62\x65\x20\x68\x61\x73\x68\x65\x64\x20\x62\x65\x66\x6f\x72\x65\x20\x62\x65\x69\x6e\x67\x20\x75\x73\x65\x64\x20\x62\x79\x20\x74\x68\x65\x20\x48\x4d\x41\x43\x20\x61\x6c\x67\x6f\x72\x69\x74\x68\x6d\x2e&quot;</span>
<span class="term-fg31">-    };</span>
<span class="term-fg31">-    static const unsigned char outputs[6][32] = {</span>
<span class="term-fg31">-        {0xb0, 0x34, 0x4c, 0x61, 0xd8, 0xdb, 0x38, 0x53, 0x5c, 0xa8, 0xaf, 0xce, 0xaf, 0x0b, 0xf1, 0x2b, 0x88, 0x1d, 0xc2, 0x00, 0xc9, 0x83, 0x3d, 0xa7, 0x26, 0xe9, 0x37, 0x6c, 0x2e, 0x32, 0xcf, 0xf7},</span>
<span class="term-fg31">-        {0x5b, 0xdc, 0xc1, 0x46, 0xbf, 0x60, 0x75, 0x4e, 0x6a, 0x04, 0x24, 0x26, 0x08, 0x95, 0x75, 0xc7, 0x5a, 0x00, 0x3f, 0x08, 0x9d, 0x27, 0x39, 0x83, 0x9d, 0xec, 0x58, 0xb9, 0x64, 0xec, 0x38, 0x43},</span>
<span class="term-fg31">-        {0x77, 0x3e, 0xa9, 0x1e, 0x36, 0x80, 0x0e, 0x46, 0x85, 0x4d, 0xb8, 0xeb, 0xd0, 0x91, 0x81, 0xa7, 0x29, 0x59, 0x09, 0x8b, 0x3e, 0xf8, 0xc1, 0x22, 0xd9, 0x63, 0x55, 0x14, 0xce, 0xd5, 0x65, 0xfe},</span>
<span class="term-fg31">-        {0x82, 0x55, 0x8a, 0x38, 0x9a, 0x44, 0x3c, 0x0e, 0xa4, 0xcc, 0x81, 0x98, 0x99, 0xf2, 0x08, 0x3a, 0x85, 0xf0, 0xfa, 0xa3, 0xe5, 0x78, 0xf8, 0x07, 0x7a, 0x2e, 0x3f, 0xf4, 0x67, 0x29, 0x66, 0x5b},</span>
<span class="term-fg31">-        {0x60, 0xe4, 0x31, 0x59, 0x1e, 0xe0, 0xb6, 0x7f, 0x0d, 0x8a, 0x26, 0xaa, 0xcb, 0xf5, 0xb7, 0x7f, 0x8e, 0x0b, 0xc6, 0x21, 0x37, 0x28, 0xc5, 0x14, 0x05, 0x46, 0x04, 0x0f, 0x0e, 0xe3, 0x7f, 0x54},</span>
<span class="term-fg31">-        {0x9b, 0x09, 0xff, 0xa7, 0x1b, 0x94, 0x2f, 0xcb, 0x27, 0x63, 0x5f, 0xbc, 0xd5, 0xb0, 0xe9, 0x44, 0xbf, 0xdc, 0x63, 0x64, 0x4f, 0x07, 0x13, 0x93, 0x8a, 0x7f, 0x51, 0x53, 0x5c, 0x3a, 0x35, 0xe2}</span>
<span class="term-fg31">-    };</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 6; i++) {</span>
<span class="term-fg31">-        secp256k1_hmac_sha256_t hasher;</span>
<span class="term-fg31">-        unsigned char out[32];</span>
<span class="term-fg31">-        secp256k1_hmac_sha256_initialize(&amp;hasher, (const unsigned char*)(keys[i]), strlen(keys[i]));</span>
<span class="term-fg31">-        secp256k1_hmac_sha256_write(&amp;hasher, (const unsigned char*)(inputs[i]), strlen(inputs[i]));</span>
<span class="term-fg31">-        secp256k1_hmac_sha256_finalize(&amp;hasher, out);</span>
<span class="term-fg31">-        CHECK(memcmp(out, outputs[i], 32) == 0);</span>
<span class="term-fg31">-        if (strlen(inputs[i]) &gt; 0) {</span>
<span class="term-fg31">-            int split = secp256k1_rand_int(strlen(inputs[i]));</span>
<span class="term-fg31">-            secp256k1_hmac_sha256_initialize(&amp;hasher, (const unsigned char*)(keys[i]), strlen(keys[i]));</span>
<span class="term-fg31">-            secp256k1_hmac_sha256_write(&amp;hasher, (const unsigned char*)(inputs[i]), split);</span>
<span class="term-fg31">-            secp256k1_hmac_sha256_write(&amp;hasher, (const unsigned char*)(inputs[i] + split), strlen(inputs[i]) - split);</span>
<span class="term-fg31">-            secp256k1_hmac_sha256_finalize(&amp;hasher, out);</span>
<span class="term-fg31">-            CHECK(memcmp(out, outputs[i], 32) == 0);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void run_rfc6979_hmac_sha256_tests(void) {</span>
<span class="term-fg31">-    static const unsigned char key1[65] = {0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f, 0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17, 0x18, 0x19, 0x1a, 0x1b, 0x1c, 0x1d, 0x1e, 0x1f, 0x00, 0x4b, 0xf5, 0x12, 0x2f, 0x34, 0x45, 0x54, 0xc5, 0x3b, 0xde, 0x2e, 0xbb, 0x8c, 0xd2, 0xb7, 0xe3, 0xd1, 0x60, 0x0a, 0xd6, 0x31, 0xc3, 0x85, 0xa5, 0xd7, 0xcc, 0xe2, 0x3c, 0x77, 0x85, 0x45, 0x9a, 0};</span>
<span class="term-fg31">-    static const unsigned char out1[3][32] = {</span>
<span class="term-fg31">-        {0x4f, 0xe2, 0x95, 0x25, 0xb2, 0x08, 0x68, 0x09, 0x15, 0x9a, 0xcd, 0xf0, 0x50, 0x6e, 0xfb, 0x86, 0xb0, 0xec, 0x93, 0x2c, 0x7b, 0xa4, 0x42, 0x56, 0xab, 0x32, 0x1e, 0x42, 0x1e, 0x67, 0xe9, 0xfb},</span>
<span class="term-fg31">-        {0x2b, 0xf0, 0xff, 0xf1, 0xd3, 0xc3, 0x78, 0xa2, 0x2d, 0xc5, 0xde, 0x1d, 0x85, 0x65, 0x22, 0x32, 0x5c, 0x65, 0xb5, 0x04, 0x49, 0x1a, 0x0c, 0xbd, 0x01, 0xcb, 0x8f, 0x3a, 0xa6, 0x7f, 0xfd, 0x4a},</span>
<span class="term-fg31">-        {0xf5, 0x28, 0xb4, 0x10, 0xcb, 0x54, 0x1f, 0x77, 0x00, 0x0d, 0x7a, 0xfb, 0x6c, 0x5b, 0x53, 0xc5, 0xc4, 0x71, 0xea, 0xb4, 0x3e, 0x46, 0x6d, 0x9a, 0xc5, 0x19, 0x0c, 0x39, 0xc8, 0x2f, 0xd8, 0x2e}</span>
<span class="term-fg31">-    };</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    static const unsigned char key2[64] = {0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xe3, 0xb0, 0xc4, 0x42, 0x98, 0xfc, 0x1c, 0x14, 0x9a, 0xfb, 0xf4, 0xc8, 0x99, 0x6f, 0xb9, 0x24, 0x27, 0xae, 0x41, 0xe4, 0x64, 0x9b, 0x93, 0x4c, 0xa4, 0x95, 0x99, 0x1b, 0x78, 0x52, 0xb8, 0x55};</span>
<span class="term-fg31">-    static const unsigned char out2[3][32] = {</span>
<span class="term-fg31">-        {0x9c, 0x23, 0x6c, 0x16, 0x5b, 0x82, 0xae, 0x0c, 0xd5, 0x90, 0x65, 0x9e, 0x10, 0x0b, 0x6b, 0xab, 0x30, 0x36, 0xe7, 0xba, 0x8b, 0x06, 0x74, 0x9b, 0xaf, 0x69, 0x81, 0xe1, 0x6f, 0x1a, 0x2b, 0x95},</span>
<span class="term-fg31">-        {0xdf, 0x47, 0x10, 0x61, 0x62, 0x5b, 0xc0, 0xea, 0x14, 0xb6, 0x82, 0xfe, 0xee, 0x2c, 0x9c, 0x02, 0xf2, 0x35, 0xda, 0x04, 0x20, 0x4c, 0x1d, 0x62, 0xa1, 0x53, 0x6c, 0x6e, 0x17, 0xae, 0xd7, 0xa9},</span>
<span class="term-fg31">-        {0x75, 0x97, 0x88, 0x7c, 0xbd, 0x76, 0x32, 0x1f, 0x32, 0xe3, 0x04, 0x40, 0x67, 0x9a, 0x22, 0xcf, 0x7f, 0x8d, 0x9d, 0x2e, 0xac, 0x39, 0x0e, 0x58, 0x1f, 0xea, 0x09, 0x1c, 0xe2, 0x02, 0xba, 0x94}</span>
<span class="term-fg31">-    };</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_rfc6979_hmac_sha256_t rng;</span>
<span class="term-fg31">-    unsigned char out[32];</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_rfc6979_hmac_sha256_initialize(&amp;rng, key1, 64);</span>
<span class="term-fg31">-    for (i = 0; i &lt; 3; i++) {</span>
<span class="term-fg31">-        secp256k1_rfc6979_hmac_sha256_generate(&amp;rng, out, 32);</span>
<span class="term-fg31">-        CHECK(memcmp(out, out1[i], 32) == 0);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_rfc6979_hmac_sha256_finalize(&amp;rng);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_rfc6979_hmac_sha256_initialize(&amp;rng, key1, 65);</span>
<span class="term-fg31">-    for (i = 0; i &lt; 3; i++) {</span>
<span class="term-fg31">-        secp256k1_rfc6979_hmac_sha256_generate(&amp;rng, out, 32);</span>
<span class="term-fg31">-        CHECK(memcmp(out, out1[i], 32) != 0);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_rfc6979_hmac_sha256_finalize(&amp;rng);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_rfc6979_hmac_sha256_initialize(&amp;rng, key2, 64);</span>
<span class="term-fg31">-    for (i = 0; i &lt; 3; i++) {</span>
<span class="term-fg31">-        secp256k1_rfc6979_hmac_sha256_generate(&amp;rng, out, 32);</span>
<span class="term-fg31">-        CHECK(memcmp(out, out2[i], 32) == 0);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_rfc6979_hmac_sha256_finalize(&amp;rng);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;***** RANDOM TESTS *****&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void test_rand_bits(int rand32, int bits) {</span>
<span class="term-fg31">-    &#47;* (1-1&#47;2^B)^rounds[B] &lt; 1&#47;10^9, so rounds is the number of iterations to</span>
<span class="term-fg31">-     * get a false negative chance below once in a billion *&#47;</span>
<span class="term-fg31">-    static const unsigned int rounds[7] = {1, 30, 73, 156, 322, 653, 1316};</span>
<span class="term-fg31">-    &#47;* We try multiplying the results with various odd numbers, which shouldn&#39;t</span>
<span class="term-fg31">-     * influence the uniform distribution modulo a power of 2. *&#47;</span>
<span class="term-fg31">-    static const uint32_t mults[6] = {1, 3, 21, 289, 0x9999, 0x80402011};</span>
<span class="term-fg31">-    &#47;* We only select up to 6 bits from the output to analyse *&#47;</span>
<span class="term-fg31">-    unsigned int usebits = bits &gt; 6 ? 6 : bits;</span>
<span class="term-fg31">-    unsigned int maxshift = bits - usebits;</span>
<span class="term-fg31">-    &#47;* For each of the maxshift+1 usebits-bit sequences inside a bits-bit</span>
<span class="term-fg31">-       number, track all observed outcomes, one per bit in a uint64_t. *&#47;</span>
<span class="term-fg31">-    uint64_t x[6][27] = {{0}};</span>
<span class="term-fg31">-    unsigned int i, shift, m;</span>
<span class="term-fg31">-    &#47;* Multiply the output of all rand calls with the odd number m, which</span>
<span class="term-fg31">-       should not change the uniformity of its distribution. *&#47;</span>
<span class="term-fg31">-    for (i = 0; i &lt; rounds[usebits]; i++) {</span>
<span class="term-fg31">-        uint32_t r = (rand32 ? secp256k1_rand32() : secp256k1_rand_bits(bits));</span>
<span class="term-fg31">-        CHECK((((uint64_t)r) &gt;&gt; bits) == 0);</span>
<span class="term-fg31">-        for (m = 0; m &lt; sizeof(mults) &#47; sizeof(mults[0]); m++) {</span>
<span class="term-fg31">-            uint32_t rm = r * mults[m];</span>
<span class="term-fg31">-            for (shift = 0; shift &lt;= maxshift; shift++) {</span>
<span class="term-fg31">-                x[m][shift] |= (((uint64_t)1) &lt;&lt; ((rm &gt;&gt; shift) &amp; ((1 &lt;&lt; usebits) - 1)));</span>
<span class="term-fg31">-            }</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    for (m = 0; m &lt; sizeof(mults) &#47; sizeof(mults[0]); m++) {</span>
<span class="term-fg31">-        for (shift = 0; shift &lt;= maxshift; shift++) {</span>
<span class="term-fg31">-            &#47;* Test that the lower usebits bits of x[shift] are 1 *&#47;</span>
<span class="term-fg31">-            CHECK(((~x[m][shift]) &lt;&lt; (64 - (1 &lt;&lt; usebits))) == 0);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;* Subrange must be a whole divisor of range, and at most 64 *&#47;</span>
<span class="term-fg31">-void test_rand_int(uint32_t range, uint32_t subrange) {</span>
<span class="term-fg31">-    &#47;* (1-1&#47;subrange)^rounds &lt; 1&#47;10^9 *&#47;</span>
<span class="term-fg31">-    int rounds = (subrange * 2073) &#47; 100;</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    uint64_t x = 0;</span>
<span class="term-fg31">-    CHECK((range % subrange) == 0);</span>
<span class="term-fg31">-    for (i = 0; i &lt; rounds; i++) {</span>
<span class="term-fg31">-        uint32_t r = secp256k1_rand_int(range);</span>
<span class="term-fg31">-        CHECK(r &lt; range);</span>
<span class="term-fg31">-        r = r % subrange;</span>
<span class="term-fg31">-        x |= (((uint64_t)1) &lt;&lt; r);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    &#47;* Test that the lower subrange bits of x are 1. *&#47;</span>
<span class="term-fg31">-    CHECK(((~x) &lt;&lt; (64 - subrange)) == 0);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void run_rand_bits(void) {</span>
<span class="term-fg31">-    size_t b;</span>
<span class="term-fg31">-    test_rand_bits(1, 32);</span>
<span class="term-fg31">-    for (b = 1; b &lt;= 32; b++) {</span>
<span class="term-fg31">-        test_rand_bits(0, b);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void run_rand_int(void) {</span>
<span class="term-fg31">-    static const uint32_t ms[] = {1, 3, 17, 1000, 13771, 999999, 33554432};</span>
<span class="term-fg31">-    static const uint32_t ss[] = {1, 3, 6, 9, 13, 31, 64};</span>
<span class="term-fg31">-    unsigned int m, s;</span>
<span class="term-fg31">-    for (m = 0; m &lt; sizeof(ms) &#47; sizeof(ms[0]); m++) {</span>
<span class="term-fg31">-        for (s = 0; s &lt; sizeof(ss) &#47; sizeof(ss[0]); s++) {</span>
<span class="term-fg31">-            test_rand_int(ms[m] * ss[s], ss[s]);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;***** NUM TESTS *****&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef USE_NUM_NONE</span>
<span class="term-fg31">-void random_num_negate(secp256k1_num *num) {</span>
<span class="term-fg31">-    if (secp256k1_rand_bits(1)) {</span>
<span class="term-fg31">-        secp256k1_num_negate(num);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void random_num_order_test(secp256k1_num *num) {</span>
<span class="term-fg31">-    secp256k1_scalar sc;</span>
<span class="term-fg31">-    random_scalar_order_test(&amp;sc);</span>
<span class="term-fg31">-    secp256k1_scalar_get_num(num, &amp;sc);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void random_num_order(secp256k1_num *num) {</span>
<span class="term-fg31">-    secp256k1_scalar sc;</span>
<span class="term-fg31">-    random_scalar_order(&amp;sc);</span>
<span class="term-fg31">-    secp256k1_scalar_get_num(num, &amp;sc);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void test_num_negate(void) {</span>
<span class="term-fg31">-    secp256k1_num n1;</span>
<span class="term-fg31">-    secp256k1_num n2;</span>
<span class="term-fg31">-    random_num_order_test(&amp;n1); &#47;* n1 = R *&#47;</span>
<span class="term-fg31">-    random_num_negate(&amp;n1);</span>
<span class="term-fg31">-    secp256k1_num_copy(&amp;n2, &amp;n1); &#47;* n2 = R *&#47;</span>
<span class="term-fg31">-    secp256k1_num_sub(&amp;n1, &amp;n2, &amp;n1); &#47;* n1 = n2-n1 = 0 *&#47;</span>
<span class="term-fg31">-    CHECK(secp256k1_num_is_zero(&amp;n1));</span>
<span class="term-fg31">-    secp256k1_num_copy(&amp;n1, &amp;n2); &#47;* n1 = R *&#47;</span>
<span class="term-fg31">-    secp256k1_num_negate(&amp;n1); &#47;* n1 = -R *&#47;</span>
<span class="term-fg31">-    CHECK(!secp256k1_num_is_zero(&amp;n1));</span>
<span class="term-fg31">-    secp256k1_num_add(&amp;n1, &amp;n2, &amp;n1); &#47;* n1 = n2+n1 = 0 *&#47;</span>
<span class="term-fg31">-    CHECK(secp256k1_num_is_zero(&amp;n1));</span>
<span class="term-fg31">-    secp256k1_num_copy(&amp;n1, &amp;n2); &#47;* n1 = R *&#47;</span>
<span class="term-fg31">-    secp256k1_num_negate(&amp;n1); &#47;* n1 = -R *&#47;</span>
<span class="term-fg31">-    CHECK(secp256k1_num_is_neg(&amp;n1) != secp256k1_num_is_neg(&amp;n2));</span>
<span class="term-fg31">-    secp256k1_num_negate(&amp;n1); &#47;* n1 = R *&#47;</span>
<span class="term-fg31">-    CHECK(secp256k1_num_eq(&amp;n1, &amp;n2));</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void test_num_add_sub(void) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    secp256k1_scalar s;</span>
<span class="term-fg31">-    secp256k1_num n1;</span>
<span class="term-fg31">-    secp256k1_num n2;</span>
<span class="term-fg31">-    secp256k1_num n1p2, n2p1, n1m2, n2m1;</span>
<span class="term-fg31">-    random_num_order_test(&amp;n1); &#47;* n1 = R1 *&#47;</span>
<span class="term-fg31">-    if (secp256k1_rand_bits(1)) {</span>
<span class="term-fg31">-        random_num_negate(&amp;n1);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    random_num_order_test(&amp;n2); &#47;* n2 = R2 *&#47;</span>
<span class="term-fg31">-    if (secp256k1_rand_bits(1)) {</span>
<span class="term-fg31">-        random_num_negate(&amp;n2);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_num_add(&amp;n1p2, &amp;n1, &amp;n2); &#47;* n1p2 = R1 + R2 *&#47;</span>
<span class="term-fg31">-    secp256k1_num_add(&amp;n2p1, &amp;n2, &amp;n1); &#47;* n2p1 = R2 + R1 *&#47;</span>
<span class="term-fg31">-    secp256k1_num_sub(&amp;n1m2, &amp;n1, &amp;n2); &#47;* n1m2 = R1 - R2 *&#47;</span>
<span class="term-fg31">-    secp256k1_num_sub(&amp;n2m1, &amp;n2, &amp;n1); &#47;* n2m1 = R2 - R1 *&#47;</span>
<span class="term-fg31">-    CHECK(secp256k1_num_eq(&amp;n1p2, &amp;n2p1));</span>
<span class="term-fg31">-    CHECK(!secp256k1_num_eq(&amp;n1p2, &amp;n1m2));</span>
<span class="term-fg31">-    secp256k1_num_negate(&amp;n2m1); &#47;* n2m1 = -R2 + R1 *&#47;</span>
<span class="term-fg31">-    CHECK(secp256k1_num_eq(&amp;n2m1, &amp;n1m2));</span>
<span class="term-fg31">-    CHECK(!secp256k1_num_eq(&amp;n2m1, &amp;n1));</span>
<span class="term-fg31">-    secp256k1_num_add(&amp;n2m1, &amp;n2m1, &amp;n2); &#47;* n2m1 = -R2 + R1 + R2 = R1 *&#47;</span>
<span class="term-fg31">-    CHECK(secp256k1_num_eq(&amp;n2m1, &amp;n1));</span>
<span class="term-fg31">-    CHECK(!secp256k1_num_eq(&amp;n2p1, &amp;n1));</span>
<span class="term-fg31">-    secp256k1_num_sub(&amp;n2p1, &amp;n2p1, &amp;n2); &#47;* n2p1 = R2 + R1 - R2 = R1 *&#47;</span>
<span class="term-fg31">-    CHECK(secp256k1_num_eq(&amp;n2p1, &amp;n1));</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* check is_one *&#47;</span>
<span class="term-fg31">-    secp256k1_scalar_set_int(&amp;s, 1);</span>
<span class="term-fg31">-    secp256k1_scalar_get_num(&amp;n1, &amp;s);</span>
<span class="term-fg31">-    CHECK(secp256k1_num_is_one(&amp;n1));</span>
<span class="term-fg31">-    &#47;* check that 2^n + 1 is never 1 *&#47;</span>
<span class="term-fg31">-    secp256k1_scalar_get_num(&amp;n2, &amp;s);</span>
<span class="term-fg31">-    for (i = 0; i &lt; 250; ++i) {</span>
<span class="term-fg31">-        secp256k1_num_add(&amp;n1, &amp;n1, &amp;n1);    &#47;* n1 *= 2 *&#47;</span>
<span class="term-fg31">-        secp256k1_num_add(&amp;n1p2, &amp;n1, &amp;n2);  &#47;* n1p2 = n1 + 1 *&#47;</span>
<span class="term-fg31">-        CHECK(!secp256k1_num_is_one(&amp;n1p2));</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void test_num_mod(void) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    secp256k1_scalar s;</span>
<span class="term-fg31">-    secp256k1_num order, n;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* check that 0 mod anything is 0 *&#47;</span>
<span class="term-fg31">-    random_scalar_order_test(&amp;s);</span>
<span class="term-fg31">-    secp256k1_scalar_get_num(&amp;order, &amp;s);</span>
<span class="term-fg31">-    secp256k1_scalar_set_int(&amp;s, 0);</span>
<span class="term-fg31">-    secp256k1_scalar_get_num(&amp;n, &amp;s);</span>
<span class="term-fg31">-    secp256k1_num_mod(&amp;n, &amp;order);</span>
<span class="term-fg31">-    CHECK(secp256k1_num_is_zero(&amp;n));</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* check that anything mod 1 is 0 *&#47;</span>
<span class="term-fg31">-    secp256k1_scalar_set_int(&amp;s, 1);</span>
<span class="term-fg31">-    secp256k1_scalar_get_num(&amp;order, &amp;s);</span>
<span class="term-fg31">-    secp256k1_scalar_get_num(&amp;n, &amp;s);</span>
<span class="term-fg31">-    secp256k1_num_mod(&amp;n, &amp;order);</span>
<span class="term-fg31">-    CHECK(secp256k1_num_is_zero(&amp;n));</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* check that increasing the number past 2^256 does not break this *&#47;</span>
<span class="term-fg31">-    random_scalar_order_test(&amp;s);</span>
<span class="term-fg31">-    secp256k1_scalar_get_num(&amp;n, &amp;s);</span>
<span class="term-fg31">-    &#47;* multiply by 2^8, which&#39;ll test this case with high probability *&#47;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 8; ++i) {</span>
<span class="term-fg31">-        secp256k1_num_add(&amp;n, &amp;n, &amp;n);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_num_mod(&amp;n, &amp;order);</span>
<span class="term-fg31">-    CHECK(secp256k1_num_is_zero(&amp;n));</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void test_num_jacobi(void) {</span>
<span class="term-fg31">-    secp256k1_scalar sqr;</span>
<span class="term-fg31">-    secp256k1_scalar small;</span>
<span class="term-fg31">-    secp256k1_scalar five;  &#47;* five is not a quadratic residue *&#47;</span>
<span class="term-fg31">-    secp256k1_num order, n;</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    &#47;* squares mod 5 are 1, 4 *&#47;</span>
<span class="term-fg31">-    const int jacobi5[10] = { 0, 1, -1, -1, 1, 0, 1, -1, -1, 1 };</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* check some small values with 5 as the order *&#47;</span>
<span class="term-fg31">-    secp256k1_scalar_set_int(&amp;five, 5);</span>
<span class="term-fg31">-    secp256k1_scalar_get_num(&amp;order, &amp;five);</span>
<span class="term-fg31">-    for (i = 0; i &lt; 10; ++i) {</span>
<span class="term-fg31">-        secp256k1_scalar_set_int(&amp;small, i);</span>
<span class="term-fg31">-        secp256k1_scalar_get_num(&amp;n, &amp;small);</span>
<span class="term-fg31">-        CHECK(secp256k1_num_jacobi(&amp;n, &amp;order) == jacobi5[i]);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;** test large values with 5 as group order *&#47;</span>
<span class="term-fg31">-    secp256k1_scalar_get_num(&amp;order, &amp;five);</span>
<span class="term-fg31">-    &#47;* we first need a scalar which is not a multiple of 5 *&#47;</span>
<span class="term-fg31">-    do {</span>
<span class="term-fg31">-        secp256k1_num fiven;</span>
<span class="term-fg31">-        random_scalar_order_test(&amp;sqr);</span>
<span class="term-fg31">-        secp256k1_scalar_get_num(&amp;fiven, &amp;five);</span>
<span class="term-fg31">-        secp256k1_scalar_get_num(&amp;n, &amp;sqr);</span>
<span class="term-fg31">-        secp256k1_num_mod(&amp;n, &amp;fiven);</span>
<span class="term-fg31">-    } while (secp256k1_num_is_zero(&amp;n));</span>
<span class="term-fg31">-    &#47;* next force it to be a residue. 2 is a nonresidue mod 5 so we can</span>
<span class="term-fg31">-     * just multiply by two, i.e. add the number to itself *&#47;</span>
<span class="term-fg31">-    if (secp256k1_num_jacobi(&amp;n, &amp;order) == -1) {</span>
<span class="term-fg31">-        secp256k1_num_add(&amp;n, &amp;n, &amp;n);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* test residue *&#47;</span>
<span class="term-fg31">-    CHECK(secp256k1_num_jacobi(&amp;n, &amp;order) == 1);</span>
<span class="term-fg31">-    &#47;* test nonresidue *&#47;</span>
<span class="term-fg31">-    secp256k1_num_add(&amp;n, &amp;n, &amp;n);</span>
<span class="term-fg31">-    CHECK(secp256k1_num_jacobi(&amp;n, &amp;order) == -1);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;** test with secp group order as order *&#47;</span>
<span class="term-fg31">-    secp256k1_scalar_order_get_num(&amp;order);</span>
<span class="term-fg31">-    random_scalar_order_test(&amp;sqr);</span>
<span class="term-fg31">-    secp256k1_scalar_sqr(&amp;sqr, &amp;sqr);</span>
<span class="term-fg31">-    &#47;* test residue *&#47;</span>
<span class="term-fg31">-    secp256k1_scalar_get_num(&amp;n, &amp;sqr);</span>
<span class="term-fg31">-    CHECK(secp256k1_num_jacobi(&amp;n, &amp;order) == 1);</span>
<span class="term-fg31">-    &#47;* test nonresidue *&#47;</span>
<span class="term-fg31">-    secp256k1_scalar_mul(&amp;sqr, &amp;sqr, &amp;five);</span>
<span class="term-fg31">-    secp256k1_scalar_get_num(&amp;n, &amp;sqr);</span>
<span class="term-fg31">-    CHECK(secp256k1_num_jacobi(&amp;n, &amp;order) == -1);</span>
<span class="term-fg31">-    &#47;* test multiple of the order*&#47;</span>
<span class="term-fg31">-    CHECK(secp256k1_num_jacobi(&amp;order, &amp;order) == 0);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* check one less than the order *&#47;</span>
<span class="term-fg31">-    secp256k1_scalar_set_int(&amp;small, 1);</span>
<span class="term-fg31">-    secp256k1_scalar_get_num(&amp;n, &amp;small);</span>
<span class="term-fg31">-    secp256k1_num_sub(&amp;n, &amp;order, &amp;n);</span>
<span class="term-fg31">-    CHECK(secp256k1_num_jacobi(&amp;n, &amp;order) == 1);  &#47;* sage confirms this is 1 *&#47;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void run_num_smalltests(void) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 100*count; i++) {</span>
<span class="term-fg31">-        test_num_negate();</span>
<span class="term-fg31">-        test_num_add_sub();</span>
<span class="term-fg31">-        test_num_mod();</span>
<span class="term-fg31">-        test_num_jacobi();</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;***** SCALAR TESTS *****&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void scalar_test(void) {</span>
<span class="term-fg31">-    secp256k1_scalar s;</span>
<span class="term-fg31">-    secp256k1_scalar s1;</span>
<span class="term-fg31">-    secp256k1_scalar s2;</span>
<span class="term-fg31">-#ifndef USE_NUM_NONE</span>
<span class="term-fg31">-    secp256k1_num snum, s1num, s2num;</span>
<span class="term-fg31">-    secp256k1_num order, half_order;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-    unsigned char c[32];</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Set &#39;s&#39; to a random scalar, with value &#39;snum&#39;. *&#47;</span>
<span class="term-fg31">-    random_scalar_order_test(&amp;s);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Set &#39;s1&#39; to a random scalar, with value &#39;s1num&#39;. *&#47;</span>
<span class="term-fg31">-    random_scalar_order_test(&amp;s1);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Set &#39;s2&#39; to a random scalar, with value &#39;snum2&#39;, and byte array representation &#39;c&#39;. *&#47;</span>
<span class="term-fg31">-    random_scalar_order_test(&amp;s2);</span>
<span class="term-fg31">-    secp256k1_scalar_get_b32(c, &amp;s2);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef USE_NUM_NONE</span>
<span class="term-fg31">-    secp256k1_scalar_get_num(&amp;snum, &amp;s);</span>
<span class="term-fg31">-    secp256k1_scalar_get_num(&amp;s1num, &amp;s1);</span>
<span class="term-fg31">-    secp256k1_scalar_get_num(&amp;s2num, &amp;s2);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_scalar_order_get_num(&amp;order);</span>
<span class="term-fg31">-    half_order = order;</span>
<span class="term-fg31">-    secp256k1_num_shift(&amp;half_order, 1);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    {</span>
<span class="term-fg31">-        int i;</span>
<span class="term-fg31">-        &#47;* Test that fetching groups of 4 bits from a scalar and recursing n(i)=16*n(i-1)+p(i) reconstructs it. *&#47;</span>
<span class="term-fg31">-        secp256k1_scalar n;</span>
<span class="term-fg31">-        secp256k1_scalar_set_int(&amp;n, 0);</span>
<span class="term-fg31">-        for (i = 0; i &lt; 256; i += 4) {</span>
<span class="term-fg31">-            secp256k1_scalar t;</span>
<span class="term-fg31">-            int j;</span>
<span class="term-fg31">-            secp256k1_scalar_set_int(&amp;t, secp256k1_scalar_get_bits(&amp;s, 256 - 4 - i, 4));</span>
<span class="term-fg31">-            for (j = 0; j &lt; 4; j++) {</span>
<span class="term-fg31">-                secp256k1_scalar_add(&amp;n, &amp;n, &amp;n);</span>
<span class="term-fg31">-            }</span>
<span class="term-fg31">-            secp256k1_scalar_add(&amp;n, &amp;n, &amp;t);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        CHECK(secp256k1_scalar_eq(&amp;n, &amp;s));</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    {</span>
<span class="term-fg31">-        &#47;* Test that fetching groups of randomly-sized bits from a scalar and recursing n(i)=b*n(i-1)+p(i) reconstructs it. *&#47;</span>
<span class="term-fg31">-        secp256k1_scalar n;</span>
<span class="term-fg31">-        int i = 0;</span>
<span class="term-fg31">-        secp256k1_scalar_set_int(&amp;n, 0);</span>
<span class="term-fg31">-        while (i &lt; 256) {</span>
<span class="term-fg31">-            secp256k1_scalar t;</span>
<span class="term-fg31">-            int j;</span>
<span class="term-fg31">-            int now = secp256k1_rand_int(15) + 1;</span>
<span class="term-fg31">-            if (now + i &gt; 256) {</span>
<span class="term-fg31">-                now = 256 - i;</span>
<span class="term-fg31">-            }</span>
<span class="term-fg31">-            secp256k1_scalar_set_int(&amp;t, secp256k1_scalar_get_bits_var(&amp;s, 256 - now - i, now));</span>
<span class="term-fg31">-            for (j = 0; j &lt; now; j++) {</span>
<span class="term-fg31">-                secp256k1_scalar_add(&amp;n, &amp;n, &amp;n);</span>
<span class="term-fg31">-            }</span>
<span class="term-fg31">-            secp256k1_scalar_add(&amp;n, &amp;n, &amp;t);</span>
<span class="term-fg31">-            i += now;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        CHECK(secp256k1_scalar_eq(&amp;n, &amp;s));</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef USE_NUM_NONE</span>
<span class="term-fg31">-    {</span>
<span class="term-fg31">-        &#47;* Test that adding the scalars together is equal to adding their numbers together modulo the order. *&#47;</span>
<span class="term-fg31">-        secp256k1_num rnum;</span>
<span class="term-fg31">-        secp256k1_num r2num;</span>
<span class="term-fg31">-        secp256k1_scalar r;</span>
<span class="term-fg31">-        secp256k1_num_add(&amp;rnum, &amp;snum, &amp;s2num);</span>
<span class="term-fg31">-        secp256k1_num_mod(&amp;rnum, &amp;order);</span>
<span class="term-fg31">-        secp256k1_scalar_add(&amp;r, &amp;s, &amp;s2);</span>
<span class="term-fg31">-        secp256k1_scalar_get_num(&amp;r2num, &amp;r);</span>
<span class="term-fg31">-        CHECK(secp256k1_num_eq(&amp;rnum, &amp;r2num));</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    {</span>
<span class="term-fg31">-        &#47;* Test that multiplying the scalars is equal to multiplying their numbers modulo the order. *&#47;</span>
<span class="term-fg31">-        secp256k1_scalar r;</span>
<span class="term-fg31">-        secp256k1_num r2num;</span>
<span class="term-fg31">-        secp256k1_num rnum;</span>
<span class="term-fg31">-        secp256k1_num_mul(&amp;rnum, &amp;snum, &amp;s2num);</span>
<span class="term-fg31">-        secp256k1_num_mod(&amp;rnum, &amp;order);</span>
<span class="term-fg31">-        secp256k1_scalar_mul(&amp;r, &amp;s, &amp;s2);</span>
<span class="term-fg31">-        secp256k1_scalar_get_num(&amp;r2num, &amp;r);</span>
<span class="term-fg31">-        CHECK(secp256k1_num_eq(&amp;rnum, &amp;r2num));</span>
<span class="term-fg31">-        &#47;* The result can only be zero if at least one of the factors was zero. *&#47;</span>
<span class="term-fg31">-        CHECK(secp256k1_scalar_is_zero(&amp;r) == (secp256k1_scalar_is_zero(&amp;s) || secp256k1_scalar_is_zero(&amp;s2)));</span>
<span class="term-fg31">-        &#47;* The results can only be equal to one of the factors if that factor was zero, or the other factor was one. *&#47;</span>
<span class="term-fg31">-        CHECK(secp256k1_num_eq(&amp;rnum, &amp;snum) == (secp256k1_scalar_is_zero(&amp;s) || secp256k1_scalar_is_one(&amp;s2)));</span>
<span class="term-fg31">-        CHECK(secp256k1_num_eq(&amp;rnum, &amp;s2num) == (secp256k1_scalar_is_zero(&amp;s2) || secp256k1_scalar_is_one(&amp;s)));</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    {</span>
<span class="term-fg31">-        secp256k1_scalar neg;</span>
<span class="term-fg31">-        secp256k1_num negnum;</span>
<span class="term-fg31">-        secp256k1_num negnum2;</span>
<span class="term-fg31">-        &#47;* Check that comparison with zero matches comparison with zero on the number. *&#47;</span>
<span class="term-fg31">-        CHECK(secp256k1_num_is_zero(&amp;snum) == secp256k1_scalar_is_zero(&amp;s));</span>
<span class="term-fg31">-        &#47;* Check that comparison with the half order is equal to testing for high scalar. *&#47;</span>
<span class="term-fg31">-        CHECK(secp256k1_scalar_is_high(&amp;s) == (secp256k1_num_cmp(&amp;snum, &amp;half_order) &gt; 0));</span>
<span class="term-fg31">-        secp256k1_scalar_negate(&amp;neg, &amp;s);</span>
<span class="term-fg31">-        secp256k1_num_sub(&amp;negnum, &amp;order, &amp;snum);</span>
<span class="term-fg31">-        secp256k1_num_mod(&amp;negnum, &amp;order);</span>
<span class="term-fg31">-        &#47;* Check that comparison with the half order is equal to testing for high scalar after negation. *&#47;</span>
<span class="term-fg31">-        CHECK(secp256k1_scalar_is_high(&amp;neg) == (secp256k1_num_cmp(&amp;negnum, &amp;half_order) &gt; 0));</span>
<span class="term-fg31">-        &#47;* Negating should change the high property, unless the value was already zero. *&#47;</span>
<span class="term-fg31">-        CHECK((secp256k1_scalar_is_high(&amp;s) == secp256k1_scalar_is_high(&amp;neg)) == secp256k1_scalar_is_zero(&amp;s));</span>
<span class="term-fg31">-        secp256k1_scalar_get_num(&amp;negnum2, &amp;neg);</span>
<span class="term-fg31">-        &#47;* Negating a scalar should be equal to (order - n) mod order on the number. *&#47;</span>
<span class="term-fg31">-        CHECK(secp256k1_num_eq(&amp;negnum, &amp;negnum2));</span>
<span class="term-fg31">-        secp256k1_scalar_add(&amp;neg, &amp;neg, &amp;s);</span>
<span class="term-fg31">-        &#47;* Adding a number to its negation should result in zero. *&#47;</span>
<span class="term-fg31">-        CHECK(secp256k1_scalar_is_zero(&amp;neg));</span>
<span class="term-fg31">-        secp256k1_scalar_negate(&amp;neg, &amp;neg);</span>
<span class="term-fg31">-        &#47;* Negating zero should still result in zero. *&#47;</span>
<span class="term-fg31">-        CHECK(secp256k1_scalar_is_zero(&amp;neg));</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    {</span>
<span class="term-fg31">-        &#47;* Test secp256k1_scalar_mul_shift_var. *&#47;</span>
<span class="term-fg31">-        secp256k1_scalar r;</span>
<span class="term-fg31">-        secp256k1_num one;</span>
<span class="term-fg31">-        secp256k1_num rnum;</span>
<span class="term-fg31">-        secp256k1_num rnum2;</span>
<span class="term-fg31">-        unsigned char cone[1] = {0x01};</span>
<span class="term-fg31">-        unsigned int shift = 256 + secp256k1_rand_int(257);</span>
<span class="term-fg31">-        secp256k1_scalar_mul_shift_var(&amp;r, &amp;s1, &amp;s2, shift);</span>
<span class="term-fg31">-        secp256k1_num_mul(&amp;rnum, &amp;s1num, &amp;s2num);</span>
<span class="term-fg31">-        secp256k1_num_shift(&amp;rnum, shift - 1);</span>
<span class="term-fg31">-        secp256k1_num_set_bin(&amp;one, cone, 1);</span>
<span class="term-fg31">-        secp256k1_num_add(&amp;rnum, &amp;rnum, &amp;one);</span>
<span class="term-fg31">-        secp256k1_num_shift(&amp;rnum, 1);</span>
<span class="term-fg31">-        secp256k1_scalar_get_num(&amp;rnum2, &amp;r);</span>
<span class="term-fg31">-        CHECK(secp256k1_num_eq(&amp;rnum, &amp;rnum2));</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    {</span>
<span class="term-fg31">-        &#47;* test secp256k1_scalar_shr_int *&#47;</span>
<span class="term-fg31">-        secp256k1_scalar r;</span>
<span class="term-fg31">-        int i;</span>
<span class="term-fg31">-        random_scalar_order_test(&amp;r);</span>
<span class="term-fg31">-        for (i = 0; i &lt; 100; ++i) {</span>
<span class="term-fg31">-            int low;</span>
<span class="term-fg31">-            int shift = 1 + secp256k1_rand_int(15);</span>
<span class="term-fg31">-            int expected = r.d[0] % (1 &lt;&lt; shift);</span>
<span class="term-fg31">-            low = secp256k1_scalar_shr_int(&amp;r, shift);</span>
<span class="term-fg31">-            CHECK(expected == low);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    {</span>
<span class="term-fg31">-        &#47;* Test that scalar inverses are equal to the inverse of their number modulo the order. *&#47;</span>
<span class="term-fg31">-        if (!secp256k1_scalar_is_zero(&amp;s)) {</span>
<span class="term-fg31">-            secp256k1_scalar inv;</span>
<span class="term-fg31">-#ifndef USE_NUM_NONE</span>
<span class="term-fg31">-            secp256k1_num invnum;</span>
<span class="term-fg31">-            secp256k1_num invnum2;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-            secp256k1_scalar_inverse(&amp;inv, &amp;s);</span>
<span class="term-fg31">-#ifndef USE_NUM_NONE</span>
<span class="term-fg31">-            secp256k1_num_mod_inverse(&amp;invnum, &amp;snum, &amp;order);</span>
<span class="term-fg31">-            secp256k1_scalar_get_num(&amp;invnum2, &amp;inv);</span>
<span class="term-fg31">-            CHECK(secp256k1_num_eq(&amp;invnum, &amp;invnum2));</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-            secp256k1_scalar_mul(&amp;inv, &amp;inv, &amp;s);</span>
<span class="term-fg31">-            &#47;* Multiplying a scalar with its inverse must result in one. *&#47;</span>
<span class="term-fg31">-            CHECK(secp256k1_scalar_is_one(&amp;inv));</span>
<span class="term-fg31">-            secp256k1_scalar_inverse(&amp;inv, &amp;inv);</span>
<span class="term-fg31">-            &#47;* Inverting one must result in one. *&#47;</span>
<span class="term-fg31">-            CHECK(secp256k1_scalar_is_one(&amp;inv));</span>
<span class="term-fg31">-#ifndef USE_NUM_NONE</span>
<span class="term-fg31">-            secp256k1_scalar_get_num(&amp;invnum, &amp;inv);</span>
<span class="term-fg31">-            CHECK(secp256k1_num_is_one(&amp;invnum));</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    {</span>
<span class="term-fg31">-        &#47;* Test commutativity of add. *&#47;</span>
<span class="term-fg31">-        secp256k1_scalar r1, r2;</span>
<span class="term-fg31">-        secp256k1_scalar_add(&amp;r1, &amp;s1, &amp;s2);</span>
<span class="term-fg31">-        secp256k1_scalar_add(&amp;r2, &amp;s2, &amp;s1);</span>
<span class="term-fg31">-        CHECK(secp256k1_scalar_eq(&amp;r1, &amp;r2));</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    {</span>
<span class="term-fg31">-        secp256k1_scalar r1, r2;</span>
<span class="term-fg31">-        secp256k1_scalar b;</span>
<span class="term-fg31">-        int i;</span>
<span class="term-fg31">-        &#47;* Test add_bit. *&#47;</span>
<span class="term-fg31">-        int bit = secp256k1_rand_bits(8);</span>
<span class="term-fg31">-        secp256k1_scalar_set_int(&amp;b, 1);</span>
<span class="term-fg31">-        CHECK(secp256k1_scalar_is_one(&amp;b));</span>
<span class="term-fg31">-        for (i = 0; i &lt; bit; i++) {</span>
<span class="term-fg31">-            secp256k1_scalar_add(&amp;b, &amp;b, &amp;b);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        r1 = s1;</span>
<span class="term-fg31">-        r2 = s1;</span>
<span class="term-fg31">-        if (!secp256k1_scalar_add(&amp;r1, &amp;r1, &amp;b)) {</span>
<span class="term-fg31">-            &#47;* No overflow happened. *&#47;</span>
<span class="term-fg31">-            secp256k1_scalar_cadd_bit(&amp;r2, bit, 1);</span>
<span class="term-fg31">-            CHECK(secp256k1_scalar_eq(&amp;r1, &amp;r2));</span>
<span class="term-fg31">-            &#47;* cadd is a noop when flag is zero *&#47;</span>
<span class="term-fg31">-            secp256k1_scalar_cadd_bit(&amp;r2, bit, 0);</span>
<span class="term-fg31">-            CHECK(secp256k1_scalar_eq(&amp;r1, &amp;r2));</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    {</span>
<span class="term-fg31">-        &#47;* Test commutativity of mul. *&#47;</span>
<span class="term-fg31">-        secp256k1_scalar r1, r2;</span>
<span class="term-fg31">-        secp256k1_scalar_mul(&amp;r1, &amp;s1, &amp;s2);</span>
<span class="term-fg31">-        secp256k1_scalar_mul(&amp;r2, &amp;s2, &amp;s1);</span>
<span class="term-fg31">-        CHECK(secp256k1_scalar_eq(&amp;r1, &amp;r2));</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    {</span>
<span class="term-fg31">-        &#47;* Test associativity of add. *&#47;</span>
<span class="term-fg31">-        secp256k1_scalar r1, r2;</span>
<span class="term-fg31">-        secp256k1_scalar_add(&amp;r1, &amp;s1, &amp;s2);</span>
<span class="term-fg31">-        secp256k1_scalar_add(&amp;r1, &amp;r1, &amp;s);</span>
<span class="term-fg31">-        secp256k1_scalar_add(&amp;r2, &amp;s2, &amp;s);</span>
<span class="term-fg31">-        secp256k1_scalar_add(&amp;r2, &amp;s1, &amp;r2);</span>
<span class="term-fg31">-        CHECK(secp256k1_scalar_eq(&amp;r1, &amp;r2));</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    {</span>
<span class="term-fg31">-        &#47;* Test associativity of mul. *&#47;</span>
<span class="term-fg31">-        secp256k1_scalar r1, r2;</span>
<span class="term-fg31">-        secp256k1_scalar_mul(&amp;r1, &amp;s1, &amp;s2);</span>
<span class="term-fg31">-        secp256k1_scalar_mul(&amp;r1, &amp;r1, &amp;s);</span>
<span class="term-fg31">-        secp256k1_scalar_mul(&amp;r2, &amp;s2, &amp;s);</span>
<span class="term-fg31">-        secp256k1_scalar_mul(&amp;r2, &amp;s1, &amp;r2);</span>
<span class="term-fg31">-        CHECK(secp256k1_scalar_eq(&amp;r1, &amp;r2));</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    {</span>
<span class="term-fg31">-        &#47;* Test distributitivity of mul over add. *&#47;</span>
<span class="term-fg31">-        secp256k1_scalar r1, r2, t;</span>
<span class="term-fg31">-        secp256k1_scalar_add(&amp;r1, &amp;s1, &amp;s2);</span>
<span class="term-fg31">-        secp256k1_scalar_mul(&amp;r1, &amp;r1, &amp;s);</span>
<span class="term-fg31">-        secp256k1_scalar_mul(&amp;r2, &amp;s1, &amp;s);</span>
<span class="term-fg31">-        secp256k1_scalar_mul(&amp;t, &amp;s2, &amp;s);</span>
<span class="term-fg31">-        secp256k1_scalar_add(&amp;r2, &amp;r2, &amp;t);</span>
<span class="term-fg31">-        CHECK(secp256k1_scalar_eq(&amp;r1, &amp;r2));</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    {</span>
<span class="term-fg31">-        &#47;* Test square. *&#47;</span>
<span class="term-fg31">-        secp256k1_scalar r1, r2;</span>
<span class="term-fg31">-        secp256k1_scalar_sqr(&amp;r1, &amp;s1);</span>
<span class="term-fg31">-        secp256k1_scalar_mul(&amp;r2, &amp;s1, &amp;s1);</span>
<span class="term-fg31">-        CHECK(secp256k1_scalar_eq(&amp;r1, &amp;r2));</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    {</span>
<span class="term-fg31">-        &#47;* Test multiplicative identity. *&#47;</span>
<span class="term-fg31">-        secp256k1_scalar r1, v1;</span>
<span class="term-fg31">-        secp256k1_scalar_set_int(&amp;v1,1);</span>
<span class="term-fg31">-        secp256k1_scalar_mul(&amp;r1, &amp;s1, &amp;v1);</span>
<span class="term-fg31">-        CHECK(secp256k1_scalar_eq(&amp;r1, &amp;s1));</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    {</span>
<span class="term-fg31">-        &#47;* Test additive identity. *&#47;</span>
<span class="term-fg31">-        secp256k1_scalar r1, v0;</span>
<span class="term-fg31">-        secp256k1_scalar_set_int(&amp;v0,0);</span>
<span class="term-fg31">-        secp256k1_scalar_add(&amp;r1, &amp;s1, &amp;v0);</span>
<span class="term-fg31">-        CHECK(secp256k1_scalar_eq(&amp;r1, &amp;s1));</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    {</span>
<span class="term-fg31">-        &#47;* Test zero product property. *&#47;</span>
<span class="term-fg31">-        secp256k1_scalar r1, v0;</span>
<span class="term-fg31">-        secp256k1_scalar_set_int(&amp;v0,0);</span>
<span class="term-fg31">-        secp256k1_scalar_mul(&amp;r1, &amp;s1, &amp;v0);</span>
<span class="term-fg31">-        CHECK(secp256k1_scalar_eq(&amp;r1, &amp;v0));</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void run_scalar_tests(void) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 128 * count; i++) {</span>
<span class="term-fg31">-        scalar_test();</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    {</span>
<span class="term-fg31">-        &#47;* (-1)+1 should be zero. *&#47;</span>
<span class="term-fg31">-        secp256k1_scalar s, o;</span>
<span class="term-fg31">-        secp256k1_scalar_set_int(&amp;s, 1);</span>
<span class="term-fg31">-        CHECK(secp256k1_scalar_is_one(&amp;s));</span>
<span class="term-fg31">-        secp256k1_scalar_negate(&amp;o, &amp;s);</span>
<span class="term-fg31">-        secp256k1_scalar_add(&amp;o, &amp;o, &amp;s);</span>
<span class="term-fg31">-        CHECK(secp256k1_scalar_is_zero(&amp;o));</span>
<span class="term-fg31">-        secp256k1_scalar_negate(&amp;o, &amp;o);</span>
<span class="term-fg31">-        CHECK(secp256k1_scalar_is_zero(&amp;o));</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef USE_NUM_NONE</span>
<span class="term-fg31">-    {</span>
<span class="term-fg31">-        &#47;* A scalar with value of the curve order should be 0. *&#47;</span>
<span class="term-fg31">-        secp256k1_num order;</span>
<span class="term-fg31">-        secp256k1_scalar zero;</span>
<span class="term-fg31">-        unsigned char bin[32];</span>
<span class="term-fg31">-        int overflow = 0;</span>
<span class="term-fg31">-        secp256k1_scalar_order_get_num(&amp;order);</span>
<span class="term-fg31">-        secp256k1_num_get_bin(bin, 32, &amp;order);</span>
<span class="term-fg31">-        secp256k1_scalar_set_b32(&amp;zero, bin, &amp;overflow);</span>
<span class="term-fg31">-        CHECK(overflow == 1);</span>
<span class="term-fg31">-        CHECK(secp256k1_scalar_is_zero(&amp;zero));</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    {</span>
<span class="term-fg31">-        &#47;* Does check_overflow check catch all ones? *&#47;</span>
<span class="term-fg31">-        static const secp256k1_scalar overflowed = SECP256K1_SCALAR_CONST(</span>
<span class="term-fg31">-            0xFFFFFFFFUL, 0xFFFFFFFFUL, 0xFFFFFFFFUL, 0xFFFFFFFFUL,</span>
<span class="term-fg31">-            0xFFFFFFFFUL, 0xFFFFFFFFUL, 0xFFFFFFFFUL, 0xFFFFFFFFUL</span>
<span class="term-fg31">-        );</span>
<span class="term-fg31">-        CHECK(secp256k1_scalar_check_overflow(&amp;overflowed));</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    {</span>
<span class="term-fg31">-        &#47;* Static test vectors.</span>
<span class="term-fg31">-         * These were reduced from ~10^12 random vectors based on comparison-decision</span>
<span class="term-fg31">-         *  and edge-case coverage on 32-bit and 64-bit implementations.</span>
<span class="term-fg31">-         * The responses were generated with Sage 5.9.</span>
<span class="term-fg31">-         *&#47;</span>
<span class="term-fg31">-        secp256k1_scalar x;</span>
<span class="term-fg31">-        secp256k1_scalar y;</span>
<span class="term-fg31">-        secp256k1_scalar z;</span>
<span class="term-fg31">-        secp256k1_scalar zz;</span>
<span class="term-fg31">-        secp256k1_scalar one;</span>
<span class="term-fg31">-        secp256k1_scalar r1;</span>
<span class="term-fg31">-        secp256k1_scalar r2;</span>
<span class="term-fg31">-#if defined(USE_SCALAR_INV_NUM)</span>
<span class="term-fg31">-        secp256k1_scalar zzv;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-        int overflow;</span>
<span class="term-fg31">-        unsigned char chal[33][2][32] = {</span>
<span class="term-fg31">-            {{0xff, 0xff, 0x03, 0x07, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x03,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x00, 0xf8, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0xff, 0x03, 0x00, 0xc0, 0xff, 0xff, 0xff},</span>
<span class="term-fg31">-             {0xff, 0xff, 0xff, 0xff, 0xff, 0x0f, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xf8,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0x03, 0x00, 0x00, 0x00, 0x00, 0xe0, 0xff}},</span>
<span class="term-fg31">-            {{0xef, 0xff, 0x1f, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0xfe, 0xff, 0xff, 0xff, 0xff, 0xff, 0x3f, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},</span>
<span class="term-fg31">-             {0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xe0,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0xfc, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0x7f, 0x00, 0x80, 0xff}},</span>
<span class="term-fg31">-            {{0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x00, 0x06, 0x00, 0x00,</span>
<span class="term-fg31">-              0x80, 0x00, 0x00, 0x80, 0xff, 0x3f, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0xf8, 0xff, 0xff, 0xff, 0x00},</span>
<span class="term-fg31">-             {0x00, 0x00, 0xfc, 0xff, 0xff, 0xff, 0xff, 0x80,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0xff, 0x0f, 0x00, 0xe0,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0xff, 0x7f, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x7f, 0xff, 0xff, 0xff}},</span>
<span class="term-fg31">-            {{0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x80, 0x00, 0x00, 0x80,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00,</span>
<span class="term-fg31">-              0x00, 0x1e, 0xf8, 0xff, 0xff, 0xff, 0xfd, 0xff},</span>
<span class="term-fg31">-             {0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x1f,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0xf8, 0xff, 0x03, 0x00, 0xe0,</span>
<span class="term-fg31">-              0xff, 0x0f, 0x00, 0x00, 0x00, 0x00, 0xf0, 0xff,</span>
<span class="term-fg31">-              0xf3, 0xff, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00}},</span>
<span class="term-fg31">-            {{0x80, 0x00, 0x00, 0x80, 0xff, 0xff, 0xff, 0x00,</span>
<span class="term-fg31">-              0x00, 0x1c, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xe0, 0xff, 0xff, 0xff, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0xe0, 0xff, 0xff, 0xff},</span>
<span class="term-fg31">-             {0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x03, 0x00,</span>
<span class="term-fg31">-              0xf8, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0x1f, 0x00, 0x00, 0x80, 0xff, 0xff, 0x3f,</span>
<span class="term-fg31">-              0x00, 0xfe, 0xff, 0xff, 0xff, 0xdf, 0xff, 0xff}},</span>
<span class="term-fg31">-            {{0xff, 0xff, 0xff, 0xff, 0x00, 0x0f, 0xfc, 0x9f,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0x00, 0x80, 0x00, 0x00, 0x80,</span>
<span class="term-fg31">-              0xff, 0x0f, 0xfc, 0xff, 0x7f, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0xf8, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00},</span>
<span class="term-fg31">-             {0x08, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80,</span>
<span class="term-fg31">-              0x00, 0x00, 0xf8, 0xff, 0x0f, 0xc0, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0x1f, 0x00, 0x00, 0x00, 0xc0, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0x07, 0x80, 0xff, 0xff, 0xff}},</span>
<span class="term-fg31">-            {{0xff, 0xff, 0xff, 0xff, 0xff, 0x3f, 0x00, 0x00,</span>
<span class="term-fg31">-              0x80, 0x00, 0x00, 0x80, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0xf7, 0xff, 0xff, 0xef, 0xff, 0xff, 0xff, 0x00,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0xf0},</span>
<span class="term-fg31">-             {0x00, 0x00, 0x00, 0x00, 0xf8, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0x01, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x80, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff}},</span>
<span class="term-fg31">-            {{0x00, 0xf8, 0xff, 0x03, 0xff, 0xff, 0xff, 0x00,</span>
<span class="term-fg31">-              0x00, 0xfe, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00,</span>
<span class="term-fg31">-              0x80, 0x00, 0x00, 0x80, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0xff, 0x03, 0xc0, 0xff, 0x0f, 0xfc, 0xff},</span>
<span class="term-fg31">-             {0xff, 0xff, 0xff, 0xff, 0xff, 0xe0, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0x01, 0x00, 0x00, 0x00, 0x3f, 0x00, 0xc0,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff}},</span>
<span class="term-fg31">-            {{0x8f, 0x0f, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0xf8, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0x7f, 0x00, 0x00, 0x80, 0x00, 0x00, 0x80,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00},</span>
<span class="term-fg31">-             {0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0x0f, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00}},</span>
<span class="term-fg31">-            {{0x00, 0x00, 0x00, 0xc0, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0xff, 0x03, 0x00, 0x80, 0x00, 0x00, 0x80,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0x00, 0x00, 0x80, 0xff, 0x7f},</span>
<span class="term-fg31">-             {0xff, 0xcf, 0xff, 0xff, 0x01, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0xc0, 0xff, 0xcf, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0xbf, 0xff, 0x0e, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x80, 0xff, 0xff, 0xff, 0xff, 0x00, 0x00, 0x00}},</span>
<span class="term-fg31">-            {{0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0xff, 0x00, 0xfc, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0x00, 0x80, 0x00, 0x00, 0x80,</span>
<span class="term-fg31">-              0xff, 0x01, 0xfc, 0xff, 0x01, 0x00, 0xfe, 0xff},</span>
<span class="term-fg31">-             {0xff, 0xff, 0xff, 0x03, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xc0,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x03, 0x00}},</span>
<span class="term-fg31">-            {{0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0xe0, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0x00, 0xf8, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0x7f, 0x00, 0x00, 0x00, 0x80, 0x00, 0x00, 0x80},</span>
<span class="term-fg31">-             {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0xf8, 0xff, 0x01, 0x00, 0xf0, 0xff, 0xff,</span>
<span class="term-fg31">-              0xe0, 0xff, 0x0f, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00}},</span>
<span class="term-fg31">-            {{0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x00, 0xf8, 0xff, 0x00},</span>
<span class="term-fg31">-             {0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00, 0x00,</span>
<span class="term-fg31">-              0xfc, 0xff, 0xff, 0x3f, 0xf0, 0xff, 0xff, 0x3f,</span>
<span class="term-fg31">-              0x00, 0x00, 0xf8, 0x07, 0x00, 0x00, 0x00, 0xff,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0x0f, 0x7e, 0x00, 0x00}},</span>
<span class="term-fg31">-            {{0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x80, 0x00, 0x00, 0x80,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0xff, 0x1f, 0x00, 0x00, 0xfe, 0x07, 0x00},</span>
<span class="term-fg31">-             {0x00, 0x00, 0x00, 0xf0, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0xfb, 0xff, 0x07, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x60}},</span>
<span class="term-fg31">-            {{0xff, 0x01, 0x00, 0xff, 0xff, 0xff, 0x0f, 0x00,</span>
<span class="term-fg31">-              0x80, 0x7f, 0xfe, 0xff, 0xff, 0xff, 0xff, 0x03,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x80, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff},</span>
<span class="term-fg31">-             {0xff, 0xff, 0x1f, 0x00, 0xf0, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0x3f, 0x00, 0x00, 0x00, 0x00}},</span>
<span class="term-fg31">-            {{0x80, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff},</span>
<span class="term-fg31">-             {0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xf1, 0xff,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x03,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0xe0, 0xff, 0xff, 0xff, 0xff}},</span>
<span class="term-fg31">-            {{0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00,</span>
<span class="term-fg31">-              0x7e, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0xc0, 0xff, 0xff, 0xcf, 0xff, 0x1f, 0x00, 0x00,</span>
<span class="term-fg31">-              0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80},</span>
<span class="term-fg31">-             {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x00, 0xe0, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0xff, 0x3f, 0x00, 0x7e,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00}},</span>
<span class="term-fg31">-            {{0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0xfc, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0xff, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x7c, 0x00},</span>
<span class="term-fg31">-             {0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80,</span>
<span class="term-fg31">-              0xff, 0xff, 0x7f, 0x00, 0x80, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0xe0, 0xff, 0xff, 0xff, 0xff, 0xff}},</span>
<span class="term-fg31">-            {{0xff, 0xff, 0xff, 0xff, 0xff, 0x1f, 0x00, 0x80,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00,</span>
<span class="term-fg31">-              0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00},</span>
<span class="term-fg31">-             {0xf0, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0x3f, 0x00, 0x00, 0x80,</span>
<span class="term-fg31">-              0xff, 0x01, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0x7f, 0xf8, 0xff, 0xff, 0x1f, 0x00, 0xfe}},</span>
<span class="term-fg31">-            {{0xff, 0xff, 0xff, 0x3f, 0xf8, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0x03, 0xfe, 0x01, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0xf0, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x07},</span>
<span class="term-fg31">-             {0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00,</span>
<span class="term-fg31">-              0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0x01, 0x80, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00}},</span>
<span class="term-fg31">-            {{0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},</span>
<span class="term-fg31">-             {0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xfe,</span>
<span class="term-fg31">-              0xba, 0xae, 0xdc, 0xe6, 0xaf, 0x48, 0xa0, 0x3b,</span>
<span class="term-fg31">-              0xbf, 0xd2, 0x5e, 0x8c, 0xd0, 0x36, 0x41, 0x40}},</span>
<span class="term-fg31">-            {{0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01},</span>
<span class="term-fg31">-             {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00}},</span>
<span class="term-fg31">-            {{0x7f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff},</span>
<span class="term-fg31">-             {0x7f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff}},</span>
<span class="term-fg31">-            {{0xff, 0xff, 0xff, 0xff, 0xff, 0x00, 0x00, 0xc0,</span>
<span class="term-fg31">-              0xff, 0x0f, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0xf0, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x7f},</span>
<span class="term-fg31">-             {0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x01, 0x00,</span>
<span class="term-fg31">-              0xf0, 0xff, 0xff, 0xff, 0xff, 0x07, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0xfe, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0x01, 0xff, 0xff, 0xff}},</span>
<span class="term-fg31">-            {{0x7f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff},</span>
<span class="term-fg31">-             {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02}},</span>
<span class="term-fg31">-            {{0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xfe,</span>
<span class="term-fg31">-              0xba, 0xae, 0xdc, 0xe6, 0xaf, 0x48, 0xa0, 0x3b,</span>
<span class="term-fg31">-              0xbf, 0xd2, 0x5e, 0x8c, 0xd0, 0x36, 0x41, 0x40},</span>
<span class="term-fg31">-             {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01}},</span>
<span class="term-fg31">-            {{0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0x7e, 0x00, 0x00, 0xc0, 0xff, 0xff, 0x07, 0x00,</span>
<span class="term-fg31">-              0x80, 0x00, 0x00, 0x00, 0x80, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0xfc, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff},</span>
<span class="term-fg31">-             {0xff, 0x01, 0x00, 0x00, 0x00, 0xe0, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0xff, 0x1f, 0x00, 0x80,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0xff, 0x03, 0x00, 0x00,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff}},</span>
<span class="term-fg31">-            {{0xff, 0xff, 0xf0, 0xff, 0xff, 0xff, 0xff, 0x00,</span>
<span class="term-fg31">-              0xf0, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00,</span>
<span class="term-fg31">-              0x00, 0xe0, 0xff, 0xff, 0xff, 0xff, 0xff, 0x01,</span>
<span class="term-fg31">-              0x80, 0x00, 0x00, 0x80, 0xff, 0xff, 0xff, 0xff},</span>
<span class="term-fg31">-             {0x00, 0x00, 0x00, 0x00, 0x00, 0xe0, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0xff, 0x3f, 0x00, 0xf8, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0x3f, 0x00, 0x00, 0xc0, 0xf1, 0x7f, 0x00}},</span>
<span class="term-fg31">-            {{0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0xc0, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x80, 0x00, 0x00, 0x80, 0xff, 0xff, 0xff, 0x00},</span>
<span class="term-fg31">-             {0x00, 0xf8, 0xff, 0xff, 0xff, 0xff, 0xff, 0x01,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xf8, 0xff,</span>
<span class="term-fg31">-              0xff, 0x7f, 0x00, 0x00, 0x00, 0x00, 0x80, 0x1f,</span>
<span class="term-fg31">-              0x00, 0x00, 0xfc, 0xff, 0xff, 0x01, 0xff, 0xff}},</span>
<span class="term-fg31">-            {{0x00, 0xfe, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00,</span>
<span class="term-fg31">-              0x80, 0x00, 0x00, 0x80, 0xff, 0x03, 0xe0, 0x01,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0xfc, 0xff,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00},</span>
<span class="term-fg31">-             {0xff, 0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0xfe, 0xff, 0xff, 0xf0, 0x07, 0x00, 0x3c, 0x80,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0xfc, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0xff, 0x07, 0xe0, 0xff, 0x00, 0x00, 0x00}},</span>
<span class="term-fg31">-            {{0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00,</span>
<span class="term-fg31">-              0xfc, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x07, 0xf8,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x80, 0x00, 0x00, 0x80},</span>
<span class="term-fg31">-             {0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0xff, 0x0c, 0x80, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0xc0, 0x7f, 0xfe, 0xff, 0x1f,</span>
<span class="term-fg31">-              0x00, 0xfe, 0xff, 0x03, 0x00, 0x00, 0xfe, 0xff}},</span>
<span class="term-fg31">-            {{0xff, 0xff, 0x81, 0xff, 0xff, 0xff, 0xff, 0x00,</span>
<span class="term-fg31">-              0x80, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x83,</span>
<span class="term-fg31">-              0xff, 0xff, 0x00, 0x00, 0x80, 0x00, 0x00, 0x80,</span>
<span class="term-fg31">-              0xff, 0xff, 0x7f, 0x00, 0x00, 0x00, 0x00, 0xf0},</span>
<span class="term-fg31">-             {0xff, 0x01, 0x00, 0x00, 0x00, 0x00, 0xf8, 0xff,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0xff, 0x1f, 0x00, 0x00,</span>
<span class="term-fg31">-              0xf8, 0x07, 0x00, 0x80, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0xc7, 0xff, 0xff, 0xe0, 0xff, 0xff, 0xff}},</span>
<span class="term-fg31">-            {{0x82, 0xc9, 0xfa, 0xb0, 0x68, 0x04, 0xa0, 0x00,</span>
<span class="term-fg31">-              0x82, 0xc9, 0xfa, 0xb0, 0x68, 0x04, 0xa0, 0x00,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0xff, 0x6f, 0x03, 0xfb,</span>
<span class="term-fg31">-              0xfa, 0x8a, 0x7d, 0xdf, 0x13, 0x86, 0xe2, 0x03},</span>
<span class="term-fg31">-             {0x82, 0xc9, 0xfa, 0xb0, 0x68, 0x04, 0xa0, 0x00,</span>
<span class="term-fg31">-              0x82, 0xc9, 0xfa, 0xb0, 0x68, 0x04, 0xa0, 0x00,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0xff, 0x6f, 0x03, 0xfb,</span>
<span class="term-fg31">-              0xfa, 0x8a, 0x7d, 0xdf, 0x13, 0x86, 0xe2, 0x03}}</span>
<span class="term-fg31">-        };</span>
<span class="term-fg31">-        unsigned char res[33][2][32] = {</span>
<span class="term-fg31">-            {{0x0c, 0x3b, 0x0a, 0xca, 0x8d, 0x1a, 0x2f, 0xb9,</span>
<span class="term-fg31">-              0x8a, 0x7b, 0x53, 0x5a, 0x1f, 0xc5, 0x22, 0xa1,</span>
<span class="term-fg31">-              0x07, 0x2a, 0x48, 0xea, 0x02, 0xeb, 0xb3, 0xd6,</span>
<span class="term-fg31">-              0x20, 0x1e, 0x86, 0xd0, 0x95, 0xf6, 0x92, 0x35},</span>
<span class="term-fg31">-             {0xdc, 0x90, 0x7a, 0x07, 0x2e, 0x1e, 0x44, 0x6d,</span>
<span class="term-fg31">-              0xf8, 0x15, 0x24, 0x5b, 0x5a, 0x96, 0x37, 0x9c,</span>
<span class="term-fg31">-              0x37, 0x7b, 0x0d, 0xac, 0x1b, 0x65, 0x58, 0x49,</span>
<span class="term-fg31">-              0x43, 0xb7, 0x31, 0xbb, 0xa7, 0xf4, 0x97, 0x15}},</span>
<span class="term-fg31">-            {{0xf1, 0xf7, 0x3a, 0x50, 0xe6, 0x10, 0xba, 0x22,</span>
<span class="term-fg31">-              0x43, 0x4d, 0x1f, 0x1f, 0x7c, 0x27, 0xca, 0x9c,</span>
<span class="term-fg31">-              0xb8, 0xb6, 0xa0, 0xfc, 0xd8, 0xc0, 0x05, 0x2f,</span>
<span class="term-fg31">-              0xf7, 0x08, 0xe1, 0x76, 0xdd, 0xd0, 0x80, 0xc8},</span>
<span class="term-fg31">-             {0xe3, 0x80, 0x80, 0xb8, 0xdb, 0xe3, 0xa9, 0x77,</span>
<span class="term-fg31">-              0x00, 0xb0, 0xf5, 0x2e, 0x27, 0xe2, 0x68, 0xc4,</span>
<span class="term-fg31">-              0x88, 0xe8, 0x04, 0xc1, 0x12, 0xbf, 0x78, 0x59,</span>
<span class="term-fg31">-              0xe6, 0xa9, 0x7c, 0xe1, 0x81, 0xdd, 0xb9, 0xd5}},</span>
<span class="term-fg31">-            {{0x96, 0xe2, 0xee, 0x01, 0xa6, 0x80, 0x31, 0xef,</span>
<span class="term-fg31">-              0x5c, 0xd0, 0x19, 0xb4, 0x7d, 0x5f, 0x79, 0xab,</span>
<span class="term-fg31">-              0xa1, 0x97, 0xd3, 0x7e, 0x33, 0xbb, 0x86, 0x55,</span>
<span class="term-fg31">-              0x60, 0x20, 0x10, 0x0d, 0x94, 0x2d, 0x11, 0x7c},</span>
<span class="term-fg31">-             {0xcc, 0xab, 0xe0, 0xe8, 0x98, 0x65, 0x12, 0x96,</span>
<span class="term-fg31">-              0x38, 0x5a, 0x1a, 0xf2, 0x85, 0x23, 0x59, 0x5f,</span>
<span class="term-fg31">-              0xf9, 0xf3, 0xc2, 0x81, 0x70, 0x92, 0x65, 0x12,</span>
<span class="term-fg31">-              0x9c, 0x65, 0x1e, 0x96, 0x00, 0xef, 0xe7, 0x63}},</span>
<span class="term-fg31">-            {{0xac, 0x1e, 0x62, 0xc2, 0x59, 0xfc, 0x4e, 0x5c,</span>
<span class="term-fg31">-              0x83, 0xb0, 0xd0, 0x6f, 0xce, 0x19, 0xf6, 0xbf,</span>
<span class="term-fg31">-              0xa4, 0xb0, 0xe0, 0x53, 0x66, 0x1f, 0xbf, 0xc9,</span>
<span class="term-fg31">-              0x33, 0x47, 0x37, 0xa9, 0x3d, 0x5d, 0xb0, 0x48},</span>
<span class="term-fg31">-             {0x86, 0xb9, 0x2a, 0x7f, 0x8e, 0xa8, 0x60, 0x42,</span>
<span class="term-fg31">-              0x26, 0x6d, 0x6e, 0x1c, 0xa2, 0xec, 0xe0, 0xe5,</span>
<span class="term-fg31">-              0x3e, 0x0a, 0x33, 0xbb, 0x61, 0x4c, 0x9f, 0x3c,</span>
<span class="term-fg31">-              0xd1, 0xdf, 0x49, 0x33, 0xcd, 0x72, 0x78, 0x18}},</span>
<span class="term-fg31">-            {{0xf7, 0xd3, 0xcd, 0x49, 0x5c, 0x13, 0x22, 0xfb,</span>
<span class="term-fg31">-              0x2e, 0xb2, 0x2f, 0x27, 0xf5, 0x8a, 0x5d, 0x74,</span>
<span class="term-fg31">-              0xc1, 0x58, 0xc5, 0xc2, 0x2d, 0x9f, 0x52, 0xc6,</span>
<span class="term-fg31">-              0x63, 0x9f, 0xba, 0x05, 0x76, 0x45, 0x7a, 0x63},</span>
<span class="term-fg31">-             {0x8a, 0xfa, 0x55, 0x4d, 0xdd, 0xa3, 0xb2, 0xc3,</span>
<span class="term-fg31">-              0x44, 0xfd, 0xec, 0x72, 0xde, 0xef, 0xc0, 0x99,</span>
<span class="term-fg31">-              0xf5, 0x9f, 0xe2, 0x52, 0xb4, 0x05, 0x32, 0x58,</span>
<span class="term-fg31">-              0x57, 0xc1, 0x8f, 0xea, 0xc3, 0x24, 0x5b, 0x94}},</span>
<span class="term-fg31">-            {{0x05, 0x83, 0xee, 0xdd, 0x64, 0xf0, 0x14, 0x3b,</span>
<span class="term-fg31">-              0xa0, 0x14, 0x4a, 0x3a, 0x41, 0x82, 0x7c, 0xa7,</span>
<span class="term-fg31">-              0x2c, 0xaa, 0xb1, 0x76, 0xbb, 0x59, 0x64, 0x5f,</span>
<span class="term-fg31">-              0x52, 0xad, 0x25, 0x29, 0x9d, 0x8f, 0x0b, 0xb0},</span>
<span class="term-fg31">-             {0x7e, 0xe3, 0x7c, 0xca, 0xcd, 0x4f, 0xb0, 0x6d,</span>
<span class="term-fg31">-              0x7a, 0xb2, 0x3e, 0xa0, 0x08, 0xb9, 0xa8, 0x2d,</span>
<span class="term-fg31">-              0xc2, 0xf4, 0x99, 0x66, 0xcc, 0xac, 0xd8, 0xb9,</span>
<span class="term-fg31">-              0x72, 0x2a, 0x4a, 0x3e, 0x0f, 0x7b, 0xbf, 0xf4}},</span>
<span class="term-fg31">-            {{0x8c, 0x9c, 0x78, 0x2b, 0x39, 0x61, 0x7e, 0xf7,</span>
<span class="term-fg31">-              0x65, 0x37, 0x66, 0x09, 0x38, 0xb9, 0x6f, 0x70,</span>
<span class="term-fg31">-              0x78, 0x87, 0xff, 0xcf, 0x93, 0xca, 0x85, 0x06,</span>
<span class="term-fg31">-              0x44, 0x84, 0xa7, 0xfe, 0xd3, 0xa4, 0xe3, 0x7e},</span>
<span class="term-fg31">-             {0xa2, 0x56, 0x49, 0x23, 0x54, 0xa5, 0x50, 0xe9,</span>
<span class="term-fg31">-              0x5f, 0xf0, 0x4d, 0xe7, 0xdc, 0x38, 0x32, 0x79,</span>
<span class="term-fg31">-              0x4f, 0x1c, 0xb7, 0xe4, 0xbb, 0xf8, 0xbb, 0x2e,</span>
<span class="term-fg31">-              0x40, 0x41, 0x4b, 0xcc, 0xe3, 0x1e, 0x16, 0x36}},</span>
<span class="term-fg31">-            {{0x0c, 0x1e, 0xd7, 0x09, 0x25, 0x40, 0x97, 0xcb,</span>
<span class="term-fg31">-              0x5c, 0x46, 0xa8, 0xda, 0xef, 0x25, 0xd5, 0xe5,</span>
<span class="term-fg31">-              0x92, 0x4d, 0xcf, 0xa3, 0xc4, 0x5d, 0x35, 0x4a,</span>
<span class="term-fg31">-              0xe4, 0x61, 0x92, 0xf3, 0xbf, 0x0e, 0xcd, 0xbe},</span>
<span class="term-fg31">-             {0xe4, 0xaf, 0x0a, 0xb3, 0x30, 0x8b, 0x9b, 0x48,</span>
<span class="term-fg31">-              0x49, 0x43, 0xc7, 0x64, 0x60, 0x4a, 0x2b, 0x9e,</span>
<span class="term-fg31">-              0x95, 0x5f, 0x56, 0xe8, 0x35, 0xdc, 0xeb, 0xdc,</span>
<span class="term-fg31">-              0xc7, 0xc4, 0xfe, 0x30, 0x40, 0xc7, 0xbf, 0xa4}},</span>
<span class="term-fg31">-            {{0xd4, 0xa0, 0xf5, 0x81, 0x49, 0x6b, 0xb6, 0x8b,</span>
<span class="term-fg31">-              0x0a, 0x69, 0xf9, 0xfe, 0xa8, 0x32, 0xe5, 0xe0,</span>
<span class="term-fg31">-              0xa5, 0xcd, 0x02, 0x53, 0xf9, 0x2c, 0xe3, 0x53,</span>
<span class="term-fg31">-              0x83, 0x36, 0xc6, 0x02, 0xb5, 0xeb, 0x64, 0xb8},</span>
<span class="term-fg31">-             {0x1d, 0x42, 0xb9, 0xf9, 0xe9, 0xe3, 0x93, 0x2c,</span>
<span class="term-fg31">-              0x4c, 0xee, 0x6c, 0x5a, 0x47, 0x9e, 0x62, 0x01,</span>
<span class="term-fg31">-              0x6b, 0x04, 0xfe, 0xa4, 0x30, 0x2b, 0x0d, 0x4f,</span>
<span class="term-fg31">-              0x71, 0x10, 0xd3, 0x55, 0xca, 0xf3, 0x5e, 0x80}},</span>
<span class="term-fg31">-            {{0x77, 0x05, 0xf6, 0x0c, 0x15, 0x9b, 0x45, 0xe7,</span>
<span class="term-fg31">-              0xb9, 0x11, 0xb8, 0xf5, 0xd6, 0xda, 0x73, 0x0c,</span>
<span class="term-fg31">-              0xda, 0x92, 0xea, 0xd0, 0x9d, 0xd0, 0x18, 0x92,</span>
<span class="term-fg31">-              0xce, 0x9a, 0xaa, 0xee, 0x0f, 0xef, 0xde, 0x30},</span>
<span class="term-fg31">-             {0xf1, 0xf1, 0xd6, 0x9b, 0x51, 0xd7, 0x77, 0x62,</span>
<span class="term-fg31">-              0x52, 0x10, 0xb8, 0x7a, 0x84, 0x9d, 0x15, 0x4e,</span>
<span class="term-fg31">-              0x07, 0xdc, 0x1e, 0x75, 0x0d, 0x0c, 0x3b, 0xdb,</span>
<span class="term-fg31">-              0x74, 0x58, 0x62, 0x02, 0x90, 0x54, 0x8b, 0x43}},</span>
<span class="term-fg31">-            {{0xa6, 0xfe, 0x0b, 0x87, 0x80, 0x43, 0x67, 0x25,</span>
<span class="term-fg31">-              0x57, 0x5d, 0xec, 0x40, 0x50, 0x08, 0xd5, 0x5d,</span>
<span class="term-fg31">-              0x43, 0xd7, 0xe0, 0xaa, 0xe0, 0x13, 0xb6, 0xb0,</span>
<span class="term-fg31">-              0xc0, 0xd4, 0xe5, 0x0d, 0x45, 0x83, 0xd6, 0x13},</span>
<span class="term-fg31">-             {0x40, 0x45, 0x0a, 0x92, 0x31, 0xea, 0x8c, 0x60,</span>
<span class="term-fg31">-              0x8c, 0x1f, 0xd8, 0x76, 0x45, 0xb9, 0x29, 0x00,</span>
<span class="term-fg31">-              0x26, 0x32, 0xd8, 0xa6, 0x96, 0x88, 0xe2, 0xc4,</span>
<span class="term-fg31">-              0x8b, 0xdb, 0x7f, 0x17, 0x87, 0xcc, 0xc8, 0xf2}},</span>
<span class="term-fg31">-            {{0xc2, 0x56, 0xe2, 0xb6, 0x1a, 0x81, 0xe7, 0x31,</span>
<span class="term-fg31">-              0x63, 0x2e, 0xbb, 0x0d, 0x2f, 0x81, 0x67, 0xd4,</span>
<span class="term-fg31">-              0x22, 0xe2, 0x38, 0x02, 0x25, 0x97, 0xc7, 0x88,</span>
<span class="term-fg31">-              0x6e, 0xdf, 0xbe, 0x2a, 0xa5, 0x73, 0x63, 0xaa},</span>
<span class="term-fg31">-             {0x50, 0x45, 0xe2, 0xc3, 0xbd, 0x89, 0xfc, 0x57,</span>
<span class="term-fg31">-              0xbd, 0x3c, 0xa3, 0x98, 0x7e, 0x7f, 0x36, 0x38,</span>
<span class="term-fg31">-              0x92, 0x39, 0x1f, 0x0f, 0x81, 0x1a, 0x06, 0x51,</span>
<span class="term-fg31">-              0x1f, 0x8d, 0x6a, 0xff, 0x47, 0x16, 0x06, 0x9c}},</span>
<span class="term-fg31">-            {{0x33, 0x95, 0xa2, 0x6f, 0x27, 0x5f, 0x9c, 0x9c,</span>
<span class="term-fg31">-              0x64, 0x45, 0xcb, 0xd1, 0x3c, 0xee, 0x5e, 0x5f,</span>
<span class="term-fg31">-              0x48, 0xa6, 0xaf, 0xe3, 0x79, 0xcf, 0xb1, 0xe2,</span>
<span class="term-fg31">-              0xbf, 0x55, 0x0e, 0xa2, 0x3b, 0x62, 0xf0, 0xe4},</span>
<span class="term-fg31">-             {0x14, 0xe8, 0x06, 0xe3, 0xbe, 0x7e, 0x67, 0x01,</span>
<span class="term-fg31">-              0xc5, 0x21, 0x67, 0xd8, 0x54, 0xb5, 0x7f, 0xa4,</span>
<span class="term-fg31">-              0xf9, 0x75, 0x70, 0x1c, 0xfd, 0x79, 0xdb, 0x86,</span>
<span class="term-fg31">-              0xad, 0x37, 0x85, 0x83, 0x56, 0x4e, 0xf0, 0xbf}},</span>
<span class="term-fg31">-            {{0xbc, 0xa6, 0xe0, 0x56, 0x4e, 0xef, 0xfa, 0xf5,</span>
<span class="term-fg31">-              0x1d, 0x5d, 0x3f, 0x2a, 0x5b, 0x19, 0xab, 0x51,</span>
<span class="term-fg31">-              0xc5, 0x8b, 0xdd, 0x98, 0x28, 0x35, 0x2f, 0xc3,</span>
<span class="term-fg31">-              0x81, 0x4f, 0x5c, 0xe5, 0x70, 0xb9, 0xeb, 0x62},</span>
<span class="term-fg31">-             {0xc4, 0x6d, 0x26, 0xb0, 0x17, 0x6b, 0xfe, 0x6c,</span>
<span class="term-fg31">-              0x12, 0xf8, 0xe7, 0xc1, 0xf5, 0x2f, 0xfa, 0x91,</span>
<span class="term-fg31">-              0x13, 0x27, 0xbd, 0x73, 0xcc, 0x33, 0x31, 0x1c,</span>
<span class="term-fg31">-              0x39, 0xe3, 0x27, 0x6a, 0x95, 0xcf, 0xc5, 0xfb}},</span>
<span class="term-fg31">-            {{0x30, 0xb2, 0x99, 0x84, 0xf0, 0x18, 0x2a, 0x6e,</span>
<span class="term-fg31">-              0x1e, 0x27, 0xed, 0xa2, 0x29, 0x99, 0x41, 0x56,</span>
<span class="term-fg31">-              0xe8, 0xd4, 0x0d, 0xef, 0x99, 0x9c, 0xf3, 0x58,</span>
<span class="term-fg31">-              0x29, 0x55, 0x1a, 0xc0, 0x68, 0xd6, 0x74, 0xa4},</span>
<span class="term-fg31">-             {0x07, 0x9c, 0xe7, 0xec, 0xf5, 0x36, 0x73, 0x41,</span>
<span class="term-fg31">-              0xa3, 0x1c, 0xe5, 0x93, 0x97, 0x6a, 0xfd, 0xf7,</span>
<span class="term-fg31">-              0x53, 0x18, 0xab, 0xaf, 0xeb, 0x85, 0xbd, 0x92,</span>
<span class="term-fg31">-              0x90, 0xab, 0x3c, 0xbf, 0x30, 0x82, 0xad, 0xf6}},</span>
<span class="term-fg31">-            {{0xc6, 0x87, 0x8a, 0x2a, 0xea, 0xc0, 0xa9, 0xec,</span>
<span class="term-fg31">-              0x6d, 0xd3, 0xdc, 0x32, 0x23, 0xce, 0x62, 0x19,</span>
<span class="term-fg31">-              0xa4, 0x7e, 0xa8, 0xdd, 0x1c, 0x33, 0xae, 0xd3,</span>
<span class="term-fg31">-              0x4f, 0x62, 0x9f, 0x52, 0xe7, 0x65, 0x46, 0xf4},</span>
<span class="term-fg31">-             {0x97, 0x51, 0x27, 0x67, 0x2d, 0xa2, 0x82, 0x87,</span>
<span class="term-fg31">-              0x98, 0xd3, 0xb6, 0x14, 0x7f, 0x51, 0xd3, 0x9a,</span>
<span class="term-fg31">-              0x0b, 0xd0, 0x76, 0x81, 0xb2, 0x4f, 0x58, 0x92,</span>
<span class="term-fg31">-              0xa4, 0x86, 0xa1, 0xa7, 0x09, 0x1d, 0xef, 0x9b}},</span>
<span class="term-fg31">-            {{0xb3, 0x0f, 0x2b, 0x69, 0x0d, 0x06, 0x90, 0x64,</span>
<span class="term-fg31">-              0xbd, 0x43, 0x4c, 0x10, 0xe8, 0x98, 0x1c, 0xa3,</span>
<span class="term-fg31">-              0xe1, 0x68, 0xe9, 0x79, 0x6c, 0x29, 0x51, 0x3f,</span>
<span class="term-fg31">-              0x41, 0xdc, 0xdf, 0x1f, 0xf3, 0x60, 0xbe, 0x33},</span>
<span class="term-fg31">-             {0xa1, 0x5f, 0xf7, 0x1d, 0xb4, 0x3e, 0x9b, 0x3c,</span>
<span class="term-fg31">-              0xe7, 0xbd, 0xb6, 0x06, 0xd5, 0x60, 0x06, 0x6d,</span>
<span class="term-fg31">-              0x50, 0xd2, 0xf4, 0x1a, 0x31, 0x08, 0xf2, 0xea,</span>
<span class="term-fg31">-              0x8e, 0xef, 0x5f, 0x7d, 0xb6, 0xd0, 0xc0, 0x27}},</span>
<span class="term-fg31">-            {{0x62, 0x9a, 0xd9, 0xbb, 0x38, 0x36, 0xce, 0xf7,</span>
<span class="term-fg31">-              0x5d, 0x2f, 0x13, 0xec, 0xc8, 0x2d, 0x02, 0x8a,</span>
<span class="term-fg31">-              0x2e, 0x72, 0xf0, 0xe5, 0x15, 0x9d, 0x72, 0xae,</span>
<span class="term-fg31">-              0xfc, 0xb3, 0x4f, 0x02, 0xea, 0xe1, 0x09, 0xfe},</span>
<span class="term-fg31">-             {0x00, 0x00, 0x00, 0x00, 0xfa, 0x0a, 0x3d, 0xbc,</span>
<span class="term-fg31">-              0xad, 0x16, 0x0c, 0xb6, 0xe7, 0x7c, 0x8b, 0x39,</span>
<span class="term-fg31">-              0x9a, 0x43, 0xbb, 0xe3, 0xc2, 0x55, 0x15, 0x14,</span>
<span class="term-fg31">-              0x75, 0xac, 0x90, 0x9b, 0x7f, 0x9a, 0x92, 0x00}},</span>
<span class="term-fg31">-            {{0x8b, 0xac, 0x70, 0x86, 0x29, 0x8f, 0x00, 0x23,</span>
<span class="term-fg31">-              0x7b, 0x45, 0x30, 0xaa, 0xb8, 0x4c, 0xc7, 0x8d,</span>
<span class="term-fg31">-              0x4e, 0x47, 0x85, 0xc6, 0x19, 0xe3, 0x96, 0xc2,</span>
<span class="term-fg31">-              0x9a, 0xa0, 0x12, 0xed, 0x6f, 0xd7, 0x76, 0x16},</span>
<span class="term-fg31">-             {0x45, 0xaf, 0x7e, 0x33, 0xc7, 0x7f, 0x10, 0x6c,</span>
<span class="term-fg31">-              0x7c, 0x9f, 0x29, 0xc1, 0xa8, 0x7e, 0x15, 0x84,</span>
<span class="term-fg31">-              0xe7, 0x7d, 0xc0, 0x6d, 0xab, 0x71, 0x5d, 0xd0,</span>
<span class="term-fg31">-              0x6b, 0x9f, 0x97, 0xab, 0xcb, 0x51, 0x0c, 0x9f}},</span>
<span class="term-fg31">-            {{0x9e, 0xc3, 0x92, 0xb4, 0x04, 0x9f, 0xc8, 0xbb,</span>
<span class="term-fg31">-              0xdd, 0x9e, 0xc6, 0x05, 0xfd, 0x65, 0xec, 0x94,</span>
<span class="term-fg31">-              0x7f, 0x2c, 0x16, 0xc4, 0x40, 0xac, 0x63, 0x7b,</span>
<span class="term-fg31">-              0x7d, 0xb8, 0x0c, 0xe4, 0x5b, 0xe3, 0xa7, 0x0e},</span>
<span class="term-fg31">-             {0x43, 0xf4, 0x44, 0xe8, 0xcc, 0xc8, 0xd4, 0x54,</span>
<span class="term-fg31">-              0x33, 0x37, 0x50, 0xf2, 0x87, 0x42, 0x2e, 0x00,</span>
<span class="term-fg31">-              0x49, 0x60, 0x62, 0x02, 0xfd, 0x1a, 0x7c, 0xdb,</span>
<span class="term-fg31">-              0x29, 0x6c, 0x6d, 0x54, 0x53, 0x08, 0xd1, 0xc8}},</span>
<span class="term-fg31">-            {{0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},</span>
<span class="term-fg31">-             {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00}},</span>
<span class="term-fg31">-            {{0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},</span>
<span class="term-fg31">-             {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01}},</span>
<span class="term-fg31">-            {{0x27, 0x59, 0xc7, 0x35, 0x60, 0x71, 0xa6, 0xf1,</span>
<span class="term-fg31">-              0x79, 0xa5, 0xfd, 0x79, 0x16, 0xf3, 0x41, 0xf0,</span>
<span class="term-fg31">-              0x57, 0xb4, 0x02, 0x97, 0x32, 0xe7, 0xde, 0x59,</span>
<span class="term-fg31">-              0xe2, 0x2d, 0x9b, 0x11, 0xea, 0x2c, 0x35, 0x92},</span>
<span class="term-fg31">-             {0x27, 0x59, 0xc7, 0x35, 0x60, 0x71, 0xa6, 0xf1,</span>
<span class="term-fg31">-              0x79, 0xa5, 0xfd, 0x79, 0x16, 0xf3, 0x41, 0xf0,</span>
<span class="term-fg31">-              0x57, 0xb4, 0x02, 0x97, 0x32, 0xe7, 0xde, 0x59,</span>
<span class="term-fg31">-              0xe2, 0x2d, 0x9b, 0x11, 0xea, 0x2c, 0x35, 0x92}},</span>
<span class="term-fg31">-            {{0x28, 0x56, 0xac, 0x0e, 0x4f, 0x98, 0x09, 0xf0,</span>
<span class="term-fg31">-              0x49, 0xfa, 0x7f, 0x84, 0xac, 0x7e, 0x50, 0x5b,</span>
<span class="term-fg31">-              0x17, 0x43, 0x14, 0x89, 0x9c, 0x53, 0xa8, 0x94,</span>
<span class="term-fg31">-              0x30, 0xf2, 0x11, 0x4d, 0x92, 0x14, 0x27, 0xe8},</span>
<span class="term-fg31">-             {0x39, 0x7a, 0x84, 0x56, 0x79, 0x9d, 0xec, 0x26,</span>
<span class="term-fg31">-              0x2c, 0x53, 0xc1, 0x94, 0xc9, 0x8d, 0x9e, 0x9d,</span>
<span class="term-fg31">-              0x32, 0x1f, 0xdd, 0x84, 0x04, 0xe8, 0xe2, 0x0a,</span>
<span class="term-fg31">-              0x6b, 0xbe, 0xbb, 0x42, 0x40, 0x67, 0x30, 0x6c}},</span>
<span class="term-fg31">-            {{0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01,</span>
<span class="term-fg31">-              0x45, 0x51, 0x23, 0x19, 0x50, 0xb7, 0x5f, 0xc4,</span>
<span class="term-fg31">-              0x40, 0x2d, 0xa1, 0x73, 0x2f, 0xc9, 0xbe, 0xbd},</span>
<span class="term-fg31">-             {0x27, 0x59, 0xc7, 0x35, 0x60, 0x71, 0xa6, 0xf1,</span>
<span class="term-fg31">-              0x79, 0xa5, 0xfd, 0x79, 0x16, 0xf3, 0x41, 0xf0,</span>
<span class="term-fg31">-              0x57, 0xb4, 0x02, 0x97, 0x32, 0xe7, 0xde, 0x59,</span>
<span class="term-fg31">-              0xe2, 0x2d, 0x9b, 0x11, 0xea, 0x2c, 0x35, 0x92}},</span>
<span class="term-fg31">-            {{0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-              0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xfe,</span>
<span class="term-fg31">-              0xba, 0xae, 0xdc, 0xe6, 0xaf, 0x48, 0xa0, 0x3b,</span>
<span class="term-fg31">-              0xbf, 0xd2, 0x5e, 0x8c, 0xd0, 0x36, 0x41, 0x40},</span>
<span class="term-fg31">-             {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-              0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01}},</span>
<span class="term-fg31">-            {{0x1c, 0xc4, 0xf7, 0xda, 0x0f, 0x65, 0xca, 0x39,</span>
<span class="term-fg31">-              0x70, 0x52, 0x92, 0x8e, 0xc3, 0xc8, 0x15, 0xea,</span>
<span class="term-fg31">-              0x7f, 0x10, 0x9e, 0x77, 0x4b, 0x6e, 0x2d, 0xdf,</span>
<span class="term-fg31">-              0xe8, 0x30, 0x9d, 0xda, 0xe8, 0x9a, 0x65, 0xae},</span>
<span class="term-fg31">-             {0x02, 0xb0, 0x16, 0xb1, 0x1d, 0xc8, 0x57, 0x7b,</span>
<span class="term-fg31">-              0xa2, 0x3a, 0xa2, 0xa3, 0x38, 0x5c, 0x8f, 0xeb,</span>
<span class="term-fg31">-              0x66, 0x37, 0x91, 0xa8, 0x5f, 0xef, 0x04, 0xf6,</span>
<span class="term-fg31">-              0x59, 0x75, 0xe1, 0xee, 0x92, 0xf6, 0x0e, 0x30}},</span>
<span class="term-fg31">-            {{0x8d, 0x76, 0x14, 0xa4, 0x14, 0x06, 0x9f, 0x9a,</span>
<span class="term-fg31">-              0xdf, 0x4a, 0x85, 0xa7, 0x6b, 0xbf, 0x29, 0x6f,</span>
<span class="term-fg31">-              0xbc, 0x34, 0x87, 0x5d, 0xeb, 0xbb, 0x2e, 0xa9,</span>
<span class="term-fg31">-              0xc9, 0x1f, 0x58, 0xd6, 0x9a, 0x82, 0xa0, 0x56},</span>
<span class="term-fg31">-             {0xd4, 0xb9, 0xdb, 0x88, 0x1d, 0x04, 0xe9, 0x93,</span>
<span class="term-fg31">-              0x8d, 0x3f, 0x20, 0xd5, 0x86, 0xa8, 0x83, 0x07,</span>
<span class="term-fg31">-              0xdb, 0x09, 0xd8, 0x22, 0x1f, 0x7f, 0xf1, 0x71,</span>
<span class="term-fg31">-              0xc8, 0xe7, 0x5d, 0x47, 0xaf, 0x8b, 0x72, 0xe9}},</span>
<span class="term-fg31">-            {{0x83, 0xb9, 0x39, 0xb2, 0xa4, 0xdf, 0x46, 0x87,</span>
<span class="term-fg31">-              0xc2, 0xb8, 0xf1, 0xe6, 0x4c, 0xd1, 0xe2, 0xa9,</span>
<span class="term-fg31">-              0xe4, 0x70, 0x30, 0x34, 0xbc, 0x52, 0x7c, 0x55,</span>
<span class="term-fg31">-              0xa6, 0xec, 0x80, 0xa4, 0xe5, 0xd2, 0xdc, 0x73},</span>
<span class="term-fg31">-             {0x08, 0xf1, 0x03, 0xcf, 0x16, 0x73, 0xe8, 0x7d,</span>
<span class="term-fg31">-              0xb6, 0x7e, 0x9b, 0xc0, 0xb4, 0xc2, 0xa5, 0x86,</span>
<span class="term-fg31">-              0x02, 0x77, 0xd5, 0x27, 0x86, 0xa5, 0x15, 0xfb,</span>
<span class="term-fg31">-              0xae, 0x9b, 0x8c, 0xa9, 0xf9, 0xf8, 0xa8, 0x4a}},</span>
<span class="term-fg31">-            {{0x8b, 0x00, 0x49, 0xdb, 0xfa, 0xf0, 0x1b, 0xa2,</span>
<span class="term-fg31">-              0xed, 0x8a, 0x9a, 0x7a, 0x36, 0x78, 0x4a, 0xc7,</span>
<span class="term-fg31">-              0xf7, 0xad, 0x39, 0xd0, 0x6c, 0x65, 0x7a, 0x41,</span>
<span class="term-fg31">-              0xce, 0xd6, 0xd6, 0x4c, 0x20, 0x21, 0x6b, 0xc7},</span>
<span class="term-fg31">-             {0xc6, 0xca, 0x78, 0x1d, 0x32, 0x6c, 0x6c, 0x06,</span>
<span class="term-fg31">-              0x91, 0xf2, 0x1a, 0xe8, 0x43, 0x16, 0xea, 0x04,</span>
<span class="term-fg31">-              0x3c, 0x1f, 0x07, 0x85, 0xf7, 0x09, 0x22, 0x08,</span>
<span class="term-fg31">-              0xba, 0x13, 0xfd, 0x78, 0x1e, 0x3f, 0x6f, 0x62}},</span>
<span class="term-fg31">-            {{0x25, 0x9b, 0x7c, 0xb0, 0xac, 0x72, 0x6f, 0xb2,</span>
<span class="term-fg31">-              0xe3, 0x53, 0x84, 0x7a, 0x1a, 0x9a, 0x98, 0x9b,</span>
<span class="term-fg31">-              0x44, 0xd3, 0x59, 0xd0, 0x8e, 0x57, 0x41, 0x40,</span>
<span class="term-fg31">-              0x78, 0xa7, 0x30, 0x2f, 0x4c, 0x9c, 0xb9, 0x68},</span>
<span class="term-fg31">-             {0xb7, 0x75, 0x03, 0x63, 0x61, 0xc2, 0x48, 0x6e,</span>
<span class="term-fg31">-              0x12, 0x3d, 0xbf, 0x4b, 0x27, 0xdf, 0xb1, 0x7a,</span>
<span class="term-fg31">-              0xff, 0x4e, 0x31, 0x07, 0x83, 0xf4, 0x62, 0x5b,</span>
<span class="term-fg31">-              0x19, 0xa5, 0xac, 0xa0, 0x32, 0x58, 0x0d, 0xa7}},</span>
<span class="term-fg31">-            {{0x43, 0x4f, 0x10, 0xa4, 0xca, 0xdb, 0x38, 0x67,</span>
<span class="term-fg31">-              0xfa, 0xae, 0x96, 0xb5, 0x6d, 0x97, 0xff, 0x1f,</span>
<span class="term-fg31">-              0xb6, 0x83, 0x43, 0xd3, 0xa0, 0x2d, 0x70, 0x7a,</span>
<span class="term-fg31">-              0x64, 0x05, 0x4c, 0xa7, 0xc1, 0xa5, 0x21, 0x51},</span>
<span class="term-fg31">-             {0xe4, 0xf1, 0x23, 0x84, 0xe1, 0xb5, 0x9d, 0xf2,</span>
<span class="term-fg31">-              0xb8, 0x73, 0x8b, 0x45, 0x2b, 0x35, 0x46, 0x38,</span>
<span class="term-fg31">-              0x10, 0x2b, 0x50, 0xf8, 0x8b, 0x35, 0xcd, 0x34,</span>
<span class="term-fg31">-              0xc8, 0x0e, 0xf6, 0xdb, 0x09, 0x35, 0xf0, 0xda}},</span>
<span class="term-fg31">-            {{0xdb, 0x21, 0x5c, 0x8d, 0x83, 0x1d, 0xb3, 0x34,</span>
<span class="term-fg31">-              0xc7, 0x0e, 0x43, 0xa1, 0x58, 0x79, 0x67, 0x13,</span>
<span class="term-fg31">-              0x1e, 0x86, 0x5d, 0x89, 0x63, 0xe6, 0x0a, 0x46,</span>
<span class="term-fg31">-              0x5c, 0x02, 0x97, 0x1b, 0x62, 0x43, 0x86, 0xf5},</span>
<span class="term-fg31">-             {0xdb, 0x21, 0x5c, 0x8d, 0x83, 0x1d, 0xb3, 0x34,</span>
<span class="term-fg31">-              0xc7, 0x0e, 0x43, 0xa1, 0x58, 0x79, 0x67, 0x13,</span>
<span class="term-fg31">-              0x1e, 0x86, 0x5d, 0x89, 0x63, 0xe6, 0x0a, 0x46,</span>
<span class="term-fg31">-              0x5c, 0x02, 0x97, 0x1b, 0x62, 0x43, 0x86, 0xf5}}</span>
<span class="term-fg31">-        };</span>
<span class="term-fg31">-        secp256k1_scalar_set_int(&amp;one, 1);</span>
<span class="term-fg31">-        for (i = 0; i &lt; 33; i++) {</span>
<span class="term-fg31">-            secp256k1_scalar_set_b32(&amp;x, chal[i][0], &amp;overflow);</span>
<span class="term-fg31">-            CHECK(!overflow);</span>
<span class="term-fg31">-            secp256k1_scalar_set_b32(&amp;y, chal[i][1], &amp;overflow);</span>
<span class="term-fg31">-            CHECK(!overflow);</span>
<span class="term-fg31">-            secp256k1_scalar_set_b32(&amp;r1, res[i][0], &amp;overflow);</span>
<span class="term-fg31">-            CHECK(!overflow);</span>
<span class="term-fg31">-            secp256k1_scalar_set_b32(&amp;r2, res[i][1], &amp;overflow);</span>
<span class="term-fg31">-            CHECK(!overflow);</span>
<span class="term-fg31">-            secp256k1_scalar_mul(&amp;z, &amp;x, &amp;y);</span>
<span class="term-fg31">-            CHECK(!secp256k1_scalar_check_overflow(&amp;z));</span>
<span class="term-fg31">-            CHECK(secp256k1_scalar_eq(&amp;r1, &amp;z));</span>
<span class="term-fg31">-            if (!secp256k1_scalar_is_zero(&amp;y)) {</span>
<span class="term-fg31">-                secp256k1_scalar_inverse(&amp;zz, &amp;y);</span>
<span class="term-fg31">-                CHECK(!secp256k1_scalar_check_overflow(&amp;zz));</span>
<span class="term-fg31">-#if defined(USE_SCALAR_INV_NUM)</span>
<span class="term-fg31">-                secp256k1_scalar_inverse_var(&amp;zzv, &amp;y);</span>
<span class="term-fg31">-                CHECK(secp256k1_scalar_eq(&amp;zzv, &amp;zz));</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-                secp256k1_scalar_mul(&amp;z, &amp;z, &amp;zz);</span>
<span class="term-fg31">-                CHECK(!secp256k1_scalar_check_overflow(&amp;z));</span>
<span class="term-fg31">-                CHECK(secp256k1_scalar_eq(&amp;x, &amp;z));</span>
<span class="term-fg31">-                secp256k1_scalar_mul(&amp;zz, &amp;zz, &amp;y);</span>
<span class="term-fg31">-                CHECK(!secp256k1_scalar_check_overflow(&amp;zz));</span>
<span class="term-fg31">-                CHECK(secp256k1_scalar_eq(&amp;one, &amp;zz));</span>
<span class="term-fg31">-            }</span>
<span class="term-fg31">-            secp256k1_scalar_mul(&amp;z, &amp;x, &amp;x);</span>
<span class="term-fg31">-            CHECK(!secp256k1_scalar_check_overflow(&amp;z));</span>
<span class="term-fg31">-            secp256k1_scalar_sqr(&amp;zz, &amp;x);</span>
<span class="term-fg31">-            CHECK(!secp256k1_scalar_check_overflow(&amp;zz));</span>
<span class="term-fg31">-            CHECK(secp256k1_scalar_eq(&amp;zz, &amp;z));</span>
<span class="term-fg31">-            CHECK(secp256k1_scalar_eq(&amp;r2, &amp;zz));</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;***** FIELD TESTS *****&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void random_fe(secp256k1_fe *x) {</span>
<span class="term-fg31">-    unsigned char bin[32];</span>
<span class="term-fg31">-    do {</span>
<span class="term-fg31">-        secp256k1_rand256(bin);</span>
<span class="term-fg31">-        if (secp256k1_fe_set_b32(x, bin)) {</span>
<span class="term-fg31">-            return;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    } while(1);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void random_fe_test(secp256k1_fe *x) {</span>
<span class="term-fg31">-    unsigned char bin[32];</span>
<span class="term-fg31">-    do {</span>
<span class="term-fg31">-        secp256k1_rand256_test(bin);</span>
<span class="term-fg31">-        if (secp256k1_fe_set_b32(x, bin)) {</span>
<span class="term-fg31">-            return;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    } while(1);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void random_fe_non_zero(secp256k1_fe *nz) {</span>
<span class="term-fg31">-    int tries = 10;</span>
<span class="term-fg31">-    while (--tries &gt;= 0) {</span>
<span class="term-fg31">-        random_fe(nz);</span>
<span class="term-fg31">-        secp256k1_fe_normalize(nz);</span>
<span class="term-fg31">-        if (!secp256k1_fe_is_zero(nz)) {</span>
<span class="term-fg31">-            break;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    &#47;* Infinitesimal probability of spurious failure here *&#47;</span>
<span class="term-fg31">-    CHECK(tries &gt;= 0);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void random_fe_non_square(secp256k1_fe *ns) {</span>
<span class="term-fg31">-    secp256k1_fe r;</span>
<span class="term-fg31">-    random_fe_non_zero(ns);</span>
<span class="term-fg31">-    if (secp256k1_fe_sqrt(&amp;r, ns)) {</span>
<span class="term-fg31">-        secp256k1_fe_negate(ns, ns, 1);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-int check_fe_equal(const secp256k1_fe *a, const secp256k1_fe *b) {</span>
<span class="term-fg31">-    secp256k1_fe an = *a;</span>
<span class="term-fg31">-    secp256k1_fe bn = *b;</span>
<span class="term-fg31">-    secp256k1_fe_normalize_weak(&amp;an);</span>
<span class="term-fg31">-    secp256k1_fe_normalize_var(&amp;bn);</span>
<span class="term-fg31">-    return secp256k1_fe_equal_var(&amp;an, &amp;bn);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-int check_fe_inverse(const secp256k1_fe *a, const secp256k1_fe *ai) {</span>
<span class="term-fg31">-    secp256k1_fe x;</span>
<span class="term-fg31">-    secp256k1_fe one = SECP256K1_FE_CONST(0, 0, 0, 0, 0, 0, 0, 1);</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;x, a, ai);</span>
<span class="term-fg31">-    return check_fe_equal(&amp;x, &amp;one);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void run_field_convert(void) {</span>
<span class="term-fg31">-    static const unsigned char b32[32] = {</span>
<span class="term-fg31">-        0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,</span>
<span class="term-fg31">-        0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17, 0x18,</span>
<span class="term-fg31">-        0x22, 0x23, 0x24, 0x25, 0x26, 0x27, 0x28, 0x29,</span>
<span class="term-fg31">-        0x33, 0x34, 0x35, 0x36, 0x37, 0x38, 0x39, 0x40</span>
<span class="term-fg31">-    };</span>
<span class="term-fg31">-    static const secp256k1_fe_storage fes = SECP256K1_FE_STORAGE_CONST(</span>
<span class="term-fg31">-        0x00010203UL, 0x04050607UL, 0x11121314UL, 0x15161718UL,</span>
<span class="term-fg31">-        0x22232425UL, 0x26272829UL, 0x33343536UL, 0x37383940UL</span>
<span class="term-fg31">-    );</span>
<span class="term-fg31">-    static const secp256k1_fe fe = SECP256K1_FE_CONST(</span>
<span class="term-fg31">-        0x00010203UL, 0x04050607UL, 0x11121314UL, 0x15161718UL,</span>
<span class="term-fg31">-        0x22232425UL, 0x26272829UL, 0x33343536UL, 0x37383940UL</span>
<span class="term-fg31">-    );</span>
<span class="term-fg31">-    secp256k1_fe fe2;</span>
<span class="term-fg31">-    unsigned char b322[32];</span>
<span class="term-fg31">-    secp256k1_fe_storage fes2;</span>
<span class="term-fg31">-    &#47;* Check conversions to fe. *&#47;</span>
<span class="term-fg31">-    CHECK(secp256k1_fe_set_b32(&amp;fe2, b32));</span>
<span class="term-fg31">-    CHECK(secp256k1_fe_equal_var(&amp;fe, &amp;fe2));</span>
<span class="term-fg31">-    secp256k1_fe_from_storage(&amp;fe2, &amp;fes);</span>
<span class="term-fg31">-    CHECK(secp256k1_fe_equal_var(&amp;fe, &amp;fe2));</span>
<span class="term-fg31">-    &#47;* Check conversion from fe. *&#47;</span>
<span class="term-fg31">-    secp256k1_fe_get_b32(b322, &amp;fe);</span>
<span class="term-fg31">-    CHECK(memcmp(b322, b32, 32) == 0);</span>
<span class="term-fg31">-    secp256k1_fe_to_storage(&amp;fes2, &amp;fe);</span>
<span class="term-fg31">-    CHECK(memcmp(&amp;fes2, &amp;fes, sizeof(fes)) == 0);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-int fe_memcmp(const secp256k1_fe *a, const secp256k1_fe *b) {</span>
<span class="term-fg31">-    secp256k1_fe t = *b;</span>
<span class="term-fg31">-#ifdef VERIFY</span>
<span class="term-fg31">-    t.magnitude = a-&gt;magnitude;</span>
<span class="term-fg31">-    t.normalized = a-&gt;normalized;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-    return memcmp(a, &amp;t, sizeof(secp256k1_fe));</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void run_field_misc(void) {</span>
<span class="term-fg31">-    secp256k1_fe x;</span>
<span class="term-fg31">-    secp256k1_fe y;</span>
<span class="term-fg31">-    secp256k1_fe z;</span>
<span class="term-fg31">-    secp256k1_fe q;</span>
<span class="term-fg31">-    secp256k1_fe fe5 = SECP256K1_FE_CONST(0, 0, 0, 0, 0, 0, 0, 5);</span>
<span class="term-fg31">-    int i, j;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 5*count; i++) {</span>
<span class="term-fg31">-        secp256k1_fe_storage xs, ys, zs;</span>
<span class="term-fg31">-        random_fe(&amp;x);</span>
<span class="term-fg31">-        random_fe_non_zero(&amp;y);</span>
<span class="term-fg31">-        &#47;* Test the fe equality and comparison operations. *&#47;</span>
<span class="term-fg31">-        CHECK(secp256k1_fe_cmp_var(&amp;x, &amp;x) == 0);</span>
<span class="term-fg31">-        CHECK(secp256k1_fe_equal_var(&amp;x, &amp;x));</span>
<span class="term-fg31">-        z = x;</span>
<span class="term-fg31">-        secp256k1_fe_add(&amp;z,&amp;y);</span>
<span class="term-fg31">-        &#47;* Test fe conditional move; z is not normalized here. *&#47;</span>
<span class="term-fg31">-        q = x;</span>
<span class="term-fg31">-        secp256k1_fe_cmov(&amp;x, &amp;z, 0);</span>
<span class="term-fg31">-        VERIFY_CHECK(!x.normalized &amp;&amp; x.magnitude == z.magnitude);</span>
<span class="term-fg31">-        secp256k1_fe_cmov(&amp;x, &amp;x, 1);</span>
<span class="term-fg31">-        CHECK(fe_memcmp(&amp;x, &amp;z) != 0);</span>
<span class="term-fg31">-        CHECK(fe_memcmp(&amp;x, &amp;q) == 0);</span>
<span class="term-fg31">-        secp256k1_fe_cmov(&amp;q, &amp;z, 1);</span>
<span class="term-fg31">-        VERIFY_CHECK(!q.normalized &amp;&amp; q.magnitude == z.magnitude);</span>
<span class="term-fg31">-        CHECK(fe_memcmp(&amp;q, &amp;z) == 0);</span>
<span class="term-fg31">-        secp256k1_fe_normalize_var(&amp;x);</span>
<span class="term-fg31">-        secp256k1_fe_normalize_var(&amp;z);</span>
<span class="term-fg31">-        CHECK(!secp256k1_fe_equal_var(&amp;x, &amp;z));</span>
<span class="term-fg31">-        secp256k1_fe_normalize_var(&amp;q);</span>
<span class="term-fg31">-        secp256k1_fe_cmov(&amp;q, &amp;z, (i&amp;1));</span>
<span class="term-fg31">-        VERIFY_CHECK(q.normalized &amp;&amp; q.magnitude == 1);</span>
<span class="term-fg31">-        for (j = 0; j &lt; 6; j++) {</span>
<span class="term-fg31">-            secp256k1_fe_negate(&amp;z, &amp;z, j+1);</span>
<span class="term-fg31">-            secp256k1_fe_normalize_var(&amp;q);</span>
<span class="term-fg31">-            secp256k1_fe_cmov(&amp;q, &amp;z, (j&amp;1));</span>
<span class="term-fg31">-            VERIFY_CHECK(!q.normalized &amp;&amp; q.magnitude == (j+2));</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        secp256k1_fe_normalize_var(&amp;z);</span>
<span class="term-fg31">-        &#47;* Test storage conversion and conditional moves. *&#47;</span>
<span class="term-fg31">-        secp256k1_fe_to_storage(&amp;xs, &amp;x);</span>
<span class="term-fg31">-        secp256k1_fe_to_storage(&amp;ys, &amp;y);</span>
<span class="term-fg31">-        secp256k1_fe_to_storage(&amp;zs, &amp;z);</span>
<span class="term-fg31">-        secp256k1_fe_storage_cmov(&amp;zs, &amp;xs, 0);</span>
<span class="term-fg31">-        secp256k1_fe_storage_cmov(&amp;zs, &amp;zs, 1);</span>
<span class="term-fg31">-        CHECK(memcmp(&amp;xs, &amp;zs, sizeof(xs)) != 0);</span>
<span class="term-fg31">-        secp256k1_fe_storage_cmov(&amp;ys, &amp;xs, 1);</span>
<span class="term-fg31">-        CHECK(memcmp(&amp;xs, &amp;ys, sizeof(xs)) == 0);</span>
<span class="term-fg31">-        secp256k1_fe_from_storage(&amp;x, &amp;xs);</span>
<span class="term-fg31">-        secp256k1_fe_from_storage(&amp;y, &amp;ys);</span>
<span class="term-fg31">-        secp256k1_fe_from_storage(&amp;z, &amp;zs);</span>
<span class="term-fg31">-        &#47;* Test that mul_int, mul, and add agree. *&#47;</span>
<span class="term-fg31">-        secp256k1_fe_add(&amp;y, &amp;x);</span>
<span class="term-fg31">-        secp256k1_fe_add(&amp;y, &amp;x);</span>
<span class="term-fg31">-        z = x;</span>
<span class="term-fg31">-        secp256k1_fe_mul_int(&amp;z, 3);</span>
<span class="term-fg31">-        CHECK(check_fe_equal(&amp;y, &amp;z));</span>
<span class="term-fg31">-        secp256k1_fe_add(&amp;y, &amp;x);</span>
<span class="term-fg31">-        secp256k1_fe_add(&amp;z, &amp;x);</span>
<span class="term-fg31">-        CHECK(check_fe_equal(&amp;z, &amp;y));</span>
<span class="term-fg31">-        z = x;</span>
<span class="term-fg31">-        secp256k1_fe_mul_int(&amp;z, 5);</span>
<span class="term-fg31">-        secp256k1_fe_mul(&amp;q, &amp;x, &amp;fe5);</span>
<span class="term-fg31">-        CHECK(check_fe_equal(&amp;z, &amp;q));</span>
<span class="term-fg31">-        secp256k1_fe_negate(&amp;x, &amp;x, 1);</span>
<span class="term-fg31">-        secp256k1_fe_add(&amp;z, &amp;x);</span>
<span class="term-fg31">-        secp256k1_fe_add(&amp;q, &amp;x);</span>
<span class="term-fg31">-        CHECK(check_fe_equal(&amp;y, &amp;z));</span>
<span class="term-fg31">-        CHECK(check_fe_equal(&amp;q, &amp;y));</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void run_field_inv(void) {</span>
<span class="term-fg31">-    secp256k1_fe x, xi, xii;</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 10*count; i++) {</span>
<span class="term-fg31">-        random_fe_non_zero(&amp;x);</span>
<span class="term-fg31">-        secp256k1_fe_inv(&amp;xi, &amp;x);</span>
<span class="term-fg31">-        CHECK(check_fe_inverse(&amp;x, &amp;xi));</span>
<span class="term-fg31">-        secp256k1_fe_inv(&amp;xii, &amp;xi);</span>
<span class="term-fg31">-        CHECK(check_fe_equal(&amp;x, &amp;xii));</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void run_field_inv_var(void) {</span>
<span class="term-fg31">-    secp256k1_fe x, xi, xii;</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 10*count; i++) {</span>
<span class="term-fg31">-        random_fe_non_zero(&amp;x);</span>
<span class="term-fg31">-        secp256k1_fe_inv_var(&amp;xi, &amp;x);</span>
<span class="term-fg31">-        CHECK(check_fe_inverse(&amp;x, &amp;xi));</span>
<span class="term-fg31">-        secp256k1_fe_inv_var(&amp;xii, &amp;xi);</span>
<span class="term-fg31">-        CHECK(check_fe_equal(&amp;x, &amp;xii));</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void run_field_inv_all_var(void) {</span>
<span class="term-fg31">-    secp256k1_fe x[16], xi[16], xii[16];</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    &#47;* Check it&#39;s safe to call for 0 elements *&#47;</span>
<span class="term-fg31">-    secp256k1_fe_inv_all_var(xi, x, 0);</span>
<span class="term-fg31">-    for (i = 0; i &lt; count; i++) {</span>
<span class="term-fg31">-        size_t j;</span>
<span class="term-fg31">-        size_t len = secp256k1_rand_int(15) + 1;</span>
<span class="term-fg31">-        for (j = 0; j &lt; len; j++) {</span>
<span class="term-fg31">-            random_fe_non_zero(&amp;x[j]);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        secp256k1_fe_inv_all_var(xi, x, len);</span>
<span class="term-fg31">-        for (j = 0; j &lt; len; j++) {</span>
<span class="term-fg31">-            CHECK(check_fe_inverse(&amp;x[j], &amp;xi[j]));</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        secp256k1_fe_inv_all_var(xii, xi, len);</span>
<span class="term-fg31">-        for (j = 0; j &lt; len; j++) {</span>
<span class="term-fg31">-            CHECK(check_fe_equal(&amp;x[j], &amp;xii[j]));</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void run_sqr(void) {</span>
<span class="term-fg31">-    secp256k1_fe x, s;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    {</span>
<span class="term-fg31">-        int i;</span>
<span class="term-fg31">-        secp256k1_fe_set_int(&amp;x, 1);</span>
<span class="term-fg31">-        secp256k1_fe_negate(&amp;x, &amp;x, 1);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        for (i = 1; i &lt;= 512; ++i) {</span>
<span class="term-fg31">-            secp256k1_fe_mul_int(&amp;x, 2);</span>
<span class="term-fg31">-            secp256k1_fe_normalize(&amp;x);</span>
<span class="term-fg31">-            secp256k1_fe_sqr(&amp;s, &amp;x);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void test_sqrt(const secp256k1_fe *a, const secp256k1_fe *k) {</span>
<span class="term-fg31">-    secp256k1_fe r1, r2;</span>
<span class="term-fg31">-    int v = secp256k1_fe_sqrt(&amp;r1, a);</span>
<span class="term-fg31">-    CHECK((v == 0) == (k == NULL));</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    if (k != NULL) {</span>
<span class="term-fg31">-        &#47;* Check that the returned root is +&#47;- the given known answer *&#47;</span>
<span class="term-fg31">-        secp256k1_fe_negate(&amp;r2, &amp;r1, 1);</span>
<span class="term-fg31">-        secp256k1_fe_add(&amp;r1, k); secp256k1_fe_add(&amp;r2, k);</span>
<span class="term-fg31">-        secp256k1_fe_normalize(&amp;r1); secp256k1_fe_normalize(&amp;r2);</span>
<span class="term-fg31">-        CHECK(secp256k1_fe_is_zero(&amp;r1) || secp256k1_fe_is_zero(&amp;r2));</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void run_sqrt(void) {</span>
<span class="term-fg31">-    secp256k1_fe ns, x, s, t;</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Check sqrt(0) is 0 *&#47;</span>
<span class="term-fg31">-    secp256k1_fe_set_int(&amp;x, 0);</span>
<span class="term-fg31">-    secp256k1_fe_sqr(&amp;s, &amp;x);</span>
<span class="term-fg31">-    test_sqrt(&amp;s, &amp;x);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Check sqrt of small squares (and their negatives) *&#47;</span>
<span class="term-fg31">-    for (i = 1; i &lt;= 100; i++) {</span>
<span class="term-fg31">-        secp256k1_fe_set_int(&amp;x, i);</span>
<span class="term-fg31">-        secp256k1_fe_sqr(&amp;s, &amp;x);</span>
<span class="term-fg31">-        test_sqrt(&amp;s, &amp;x);</span>
<span class="term-fg31">-        secp256k1_fe_negate(&amp;t, &amp;s, 1);</span>
<span class="term-fg31">-        test_sqrt(&amp;t, NULL);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Consistency checks for large random values *&#47;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 10; i++) {</span>
<span class="term-fg31">-        int j;</span>
<span class="term-fg31">-        random_fe_non_square(&amp;ns);</span>
<span class="term-fg31">-        for (j = 0; j &lt; count; j++) {</span>
<span class="term-fg31">-            random_fe(&amp;x);</span>
<span class="term-fg31">-            secp256k1_fe_sqr(&amp;s, &amp;x);</span>
<span class="term-fg31">-            test_sqrt(&amp;s, &amp;x);</span>
<span class="term-fg31">-            secp256k1_fe_negate(&amp;t, &amp;s, 1);</span>
<span class="term-fg31">-            test_sqrt(&amp;t, NULL);</span>
<span class="term-fg31">-            secp256k1_fe_mul(&amp;t, &amp;s, &amp;ns);</span>
<span class="term-fg31">-            test_sqrt(&amp;t, NULL);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;***** GROUP TESTS *****&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void ge_equals_ge(const secp256k1_ge *a, const secp256k1_ge *b) {</span>
<span class="term-fg31">-    CHECK(a-&gt;infinity == b-&gt;infinity);</span>
<span class="term-fg31">-    if (a-&gt;infinity) {</span>
<span class="term-fg31">-        return;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    CHECK(secp256k1_fe_equal_var(&amp;a-&gt;x, &amp;b-&gt;x));</span>
<span class="term-fg31">-    CHECK(secp256k1_fe_equal_var(&amp;a-&gt;y, &amp;b-&gt;y));</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;* This compares jacobian points including their Z, not just their geometric meaning. *&#47;</span>
<span class="term-fg31">-int gej_xyz_equals_gej(const secp256k1_gej *a, const secp256k1_gej *b) {</span>
<span class="term-fg31">-    secp256k1_gej a2;</span>
<span class="term-fg31">-    secp256k1_gej b2;</span>
<span class="term-fg31">-    int ret = 1;</span>
<span class="term-fg31">-    ret &amp;= a-&gt;infinity == b-&gt;infinity;</span>
<span class="term-fg31">-    if (ret &amp;&amp; !a-&gt;infinity) {</span>
<span class="term-fg31">-        a2 = *a;</span>
<span class="term-fg31">-        b2 = *b;</span>
<span class="term-fg31">-        secp256k1_fe_normalize(&amp;a2.x);</span>
<span class="term-fg31">-        secp256k1_fe_normalize(&amp;a2.y);</span>
<span class="term-fg31">-        secp256k1_fe_normalize(&amp;a2.z);</span>
<span class="term-fg31">-        secp256k1_fe_normalize(&amp;b2.x);</span>
<span class="term-fg31">-        secp256k1_fe_normalize(&amp;b2.y);</span>
<span class="term-fg31">-        secp256k1_fe_normalize(&amp;b2.z);</span>
<span class="term-fg31">-        ret &amp;= secp256k1_fe_cmp_var(&amp;a2.x, &amp;b2.x) == 0;</span>
<span class="term-fg31">-        ret &amp;= secp256k1_fe_cmp_var(&amp;a2.y, &amp;b2.y) == 0;</span>
<span class="term-fg31">-        ret &amp;= secp256k1_fe_cmp_var(&amp;a2.z, &amp;b2.z) == 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    return ret;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void ge_equals_gej(const secp256k1_ge *a, const secp256k1_gej *b) {</span>
<span class="term-fg31">-    secp256k1_fe z2s;</span>
<span class="term-fg31">-    secp256k1_fe u1, u2, s1, s2;</span>
<span class="term-fg31">-    CHECK(a-&gt;infinity == b-&gt;infinity);</span>
<span class="term-fg31">-    if (a-&gt;infinity) {</span>
<span class="term-fg31">-        return;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    &#47;* Check a.x * b.z^2 == b.x &amp;&amp; a.y * b.z^3 == b.y, to avoid inverses. *&#47;</span>
<span class="term-fg31">-    secp256k1_fe_sqr(&amp;z2s, &amp;b-&gt;z);</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;u1, &amp;a-&gt;x, &amp;z2s);</span>
<span class="term-fg31">-    u2 = b-&gt;x; secp256k1_fe_normalize_weak(&amp;u2);</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;s1, &amp;a-&gt;y, &amp;z2s); secp256k1_fe_mul(&amp;s1, &amp;s1, &amp;b-&gt;z);</span>
<span class="term-fg31">-    s2 = b-&gt;y; secp256k1_fe_normalize_weak(&amp;s2);</span>
<span class="term-fg31">-    CHECK(secp256k1_fe_equal_var(&amp;u1, &amp;u2));</span>
<span class="term-fg31">-    CHECK(secp256k1_fe_equal_var(&amp;s1, &amp;s2));</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void test_ge(void) {</span>
<span class="term-fg31">-    int i, i1;</span>
<span class="term-fg31">-#ifdef USE_ENDOMORPHISM</span>
<span class="term-fg31">-    int runs = 6;</span>
<span class="term-fg31">-#else</span>
<span class="term-fg31">-    int runs = 4;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-    &#47;* Points: (infinity, p1, p1, -p1, -p1, p2, p2, -p2, -p2, p3, p3, -p3, -p3, p4, p4, -p4, -p4).</span>
<span class="term-fg31">-     * The second in each pair of identical points uses a random Z coordinate in the Jacobian form.</span>
<span class="term-fg31">-     * All magnitudes are randomized.</span>
<span class="term-fg31">-     * All 17*17 combinations of points are added to each other, using all applicable methods.</span>
<span class="term-fg31">-     *</span>
<span class="term-fg31">-     * When the endomorphism code is compiled in, p5 = lambda*p1 and p6 = lambda^2*p1 are added as well.</span>
<span class="term-fg31">-     *&#47;</span>
<span class="term-fg31">-    secp256k1_ge *ge = (secp256k1_ge *)malloc(sizeof(secp256k1_ge) * (1 + 4 * runs));</span>
<span class="term-fg31">-    secp256k1_gej *gej = (secp256k1_gej *)malloc(sizeof(secp256k1_gej) * (1 + 4 * runs));</span>
<span class="term-fg31">-    secp256k1_fe *zinv = (secp256k1_fe *)malloc(sizeof(secp256k1_fe) * (1 + 4 * runs));</span>
<span class="term-fg31">-    secp256k1_fe zf;</span>
<span class="term-fg31">-    secp256k1_fe zfi2, zfi3;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_gej_set_infinity(&amp;gej[0]);</span>
<span class="term-fg31">-    secp256k1_ge_clear(&amp;ge[0]);</span>
<span class="term-fg31">-    secp256k1_ge_set_gej_var(&amp;ge[0], &amp;gej[0]);</span>
<span class="term-fg31">-    for (i = 0; i &lt; runs; i++) {</span>
<span class="term-fg31">-        int j;</span>
<span class="term-fg31">-        secp256k1_ge g;</span>
<span class="term-fg31">-        random_group_element_test(&amp;g);</span>
<span class="term-fg31">-#ifdef USE_ENDOMORPHISM</span>
<span class="term-fg31">-        if (i &gt;= runs - 2) {</span>
<span class="term-fg31">-            secp256k1_ge_mul_lambda(&amp;g, &amp;ge[1]);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        if (i &gt;= runs - 1) {</span>
<span class="term-fg31">-            secp256k1_ge_mul_lambda(&amp;g, &amp;g);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-        ge[1 + 4 * i] = g;</span>
<span class="term-fg31">-        ge[2 + 4 * i] = g;</span>
<span class="term-fg31">-        secp256k1_ge_neg(&amp;ge[3 + 4 * i], &amp;g);</span>
<span class="term-fg31">-        secp256k1_ge_neg(&amp;ge[4 + 4 * i], &amp;g);</span>
<span class="term-fg31">-        secp256k1_gej_set_ge(&amp;gej[1 + 4 * i], &amp;ge[1 + 4 * i]);</span>
<span class="term-fg31">-        random_group_element_jacobian_test(&amp;gej[2 + 4 * i], &amp;ge[2 + 4 * i]);</span>
<span class="term-fg31">-        secp256k1_gej_set_ge(&amp;gej[3 + 4 * i], &amp;ge[3 + 4 * i]);</span>
<span class="term-fg31">-        random_group_element_jacobian_test(&amp;gej[4 + 4 * i], &amp;ge[4 + 4 * i]);</span>
<span class="term-fg31">-        for (j = 0; j &lt; 4; j++) {</span>
<span class="term-fg31">-            random_field_element_magnitude(&amp;ge[1 + j + 4 * i].x);</span>
<span class="term-fg31">-            random_field_element_magnitude(&amp;ge[1 + j + 4 * i].y);</span>
<span class="term-fg31">-            random_field_element_magnitude(&amp;gej[1 + j + 4 * i].x);</span>
<span class="term-fg31">-            random_field_element_magnitude(&amp;gej[1 + j + 4 * i].y);</span>
<span class="term-fg31">-            random_field_element_magnitude(&amp;gej[1 + j + 4 * i].z);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Compute z inverses. *&#47;</span>
<span class="term-fg31">-    {</span>
<span class="term-fg31">-        secp256k1_fe *zs = malloc(sizeof(secp256k1_fe) * (1 + 4 * runs));</span>
<span class="term-fg31">-        for (i = 0; i &lt; 4 * runs + 1; i++) {</span>
<span class="term-fg31">-            if (i == 0) {</span>
<span class="term-fg31">-                &#47;* The point at infinity does not have a meaningful z inverse. Any should do. *&#47;</span>
<span class="term-fg31">-                do {</span>
<span class="term-fg31">-                    random_field_element_test(&amp;zs[i]);</span>
<span class="term-fg31">-                } while(secp256k1_fe_is_zero(&amp;zs[i]));</span>
<span class="term-fg31">-            } else {</span>
<span class="term-fg31">-                zs[i] = gej[i].z;</span>
<span class="term-fg31">-            }</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        secp256k1_fe_inv_all_var(zinv, zs, 4 * runs + 1);</span>
<span class="term-fg31">-        free(zs);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Generate random zf, and zfi2 = 1&#47;zf^2, zfi3 = 1&#47;zf^3 *&#47;</span>
<span class="term-fg31">-    do {</span>
<span class="term-fg31">-        random_field_element_test(&amp;zf);</span>
<span class="term-fg31">-    } while(secp256k1_fe_is_zero(&amp;zf));</span>
<span class="term-fg31">-    random_field_element_magnitude(&amp;zf);</span>
<span class="term-fg31">-    secp256k1_fe_inv_var(&amp;zfi3, &amp;zf);</span>
<span class="term-fg31">-    secp256k1_fe_sqr(&amp;zfi2, &amp;zfi3);</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;zfi3, &amp;zfi3, &amp;zfi2);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    for (i1 = 0; i1 &lt; 1 + 4 * runs; i1++) {</span>
<span class="term-fg31">-        int i2;</span>
<span class="term-fg31">-        for (i2 = 0; i2 &lt; 1 + 4 * runs; i2++) {</span>
<span class="term-fg31">-            &#47;* Compute reference result using gej + gej (var). *&#47;</span>
<span class="term-fg31">-            secp256k1_gej refj, resj;</span>
<span class="term-fg31">-            secp256k1_ge ref;</span>
<span class="term-fg31">-            secp256k1_fe zr;</span>
<span class="term-fg31">-            secp256k1_gej_add_var(&amp;refj, &amp;gej[i1], &amp;gej[i2], secp256k1_gej_is_infinity(&amp;gej[i1]) ? NULL : &amp;zr);</span>
<span class="term-fg31">-            &#47;* Check Z ratio. *&#47;</span>
<span class="term-fg31">-            if (!secp256k1_gej_is_infinity(&amp;gej[i1]) &amp;&amp; !secp256k1_gej_is_infinity(&amp;refj)) {</span>
<span class="term-fg31">-                secp256k1_fe zrz; secp256k1_fe_mul(&amp;zrz, &amp;zr, &amp;gej[i1].z);</span>
<span class="term-fg31">-                CHECK(secp256k1_fe_equal_var(&amp;zrz, &amp;refj.z));</span>
<span class="term-fg31">-            }</span>
<span class="term-fg31">-            secp256k1_ge_set_gej_var(&amp;ref, &amp;refj);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-            &#47;* Test gej + ge with Z ratio result (var). *&#47;</span>
<span class="term-fg31">-            secp256k1_gej_add_ge_var(&amp;resj, &amp;gej[i1], &amp;ge[i2], secp256k1_gej_is_infinity(&amp;gej[i1]) ? NULL : &amp;zr);</span>
<span class="term-fg31">-            ge_equals_gej(&amp;ref, &amp;resj);</span>
<span class="term-fg31">-            if (!secp256k1_gej_is_infinity(&amp;gej[i1]) &amp;&amp; !secp256k1_gej_is_infinity(&amp;resj)) {</span>
<span class="term-fg31">-                secp256k1_fe zrz; secp256k1_fe_mul(&amp;zrz, &amp;zr, &amp;gej[i1].z);</span>
<span class="term-fg31">-                CHECK(secp256k1_fe_equal_var(&amp;zrz, &amp;resj.z));</span>
<span class="term-fg31">-            }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-            &#47;* Test gej + ge (var, with additional Z factor). *&#47;</span>
<span class="term-fg31">-            {</span>
<span class="term-fg31">-                secp256k1_ge ge2_zfi = ge[i2]; &#47;* the second term with x and y rescaled for z = 1&#47;zf *&#47;</span>
<span class="term-fg31">-                secp256k1_fe_mul(&amp;ge2_zfi.x, &amp;ge2_zfi.x, &amp;zfi2);</span>
<span class="term-fg31">-                secp256k1_fe_mul(&amp;ge2_zfi.y, &amp;ge2_zfi.y, &amp;zfi3);</span>
<span class="term-fg31">-                random_field_element_magnitude(&amp;ge2_zfi.x);</span>
<span class="term-fg31">-                random_field_element_magnitude(&amp;ge2_zfi.y);</span>
<span class="term-fg31">-                secp256k1_gej_add_zinv_var(&amp;resj, &amp;gej[i1], &amp;ge2_zfi, &amp;zf);</span>
<span class="term-fg31">-                ge_equals_gej(&amp;ref, &amp;resj);</span>
<span class="term-fg31">-            }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-            &#47;* Test gej + ge (const). *&#47;</span>
<span class="term-fg31">-            if (i2 != 0) {</span>
<span class="term-fg31">-                &#47;* secp256k1_gej_add_ge does not support its second argument being infinity. *&#47;</span>
<span class="term-fg31">-                secp256k1_gej_add_ge(&amp;resj, &amp;gej[i1], &amp;ge[i2]);</span>
<span class="term-fg31">-                ge_equals_gej(&amp;ref, &amp;resj);</span>
<span class="term-fg31">-            }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-            &#47;* Test doubling (var). *&#47;</span>
<span class="term-fg31">-            if ((i1 == 0 &amp;&amp; i2 == 0) || ((i1 + 3)&#47;4 == (i2 + 3)&#47;4 &amp;&amp; ((i1 + 3)%4)&#47;2 == ((i2 + 3)%4)&#47;2)) {</span>
<span class="term-fg31">-                secp256k1_fe zr2;</span>
<span class="term-fg31">-                &#47;* Normal doubling with Z ratio result. *&#47;</span>
<span class="term-fg31">-                secp256k1_gej_double_var(&amp;resj, &amp;gej[i1], &amp;zr2);</span>
<span class="term-fg31">-                ge_equals_gej(&amp;ref, &amp;resj);</span>
<span class="term-fg31">-                &#47;* Check Z ratio. *&#47;</span>
<span class="term-fg31">-                secp256k1_fe_mul(&amp;zr2, &amp;zr2, &amp;gej[i1].z);</span>
<span class="term-fg31">-                CHECK(secp256k1_fe_equal_var(&amp;zr2, &amp;resj.z));</span>
<span class="term-fg31">-                &#47;* Normal doubling. *&#47;</span>
<span class="term-fg31">-                secp256k1_gej_double_var(&amp;resj, &amp;gej[i2], NULL);</span>
<span class="term-fg31">-                ge_equals_gej(&amp;ref, &amp;resj);</span>
<span class="term-fg31">-            }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-            &#47;* Test adding opposites. *&#47;</span>
<span class="term-fg31">-            if ((i1 == 0 &amp;&amp; i2 == 0) || ((i1 + 3)&#47;4 == (i2 + 3)&#47;4 &amp;&amp; ((i1 + 3)%4)&#47;2 != ((i2 + 3)%4)&#47;2)) {</span>
<span class="term-fg31">-                CHECK(secp256k1_ge_is_infinity(&amp;ref));</span>
<span class="term-fg31">-            }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-            &#47;* Test adding infinity. *&#47;</span>
<span class="term-fg31">-            if (i1 == 0) {</span>
<span class="term-fg31">-                CHECK(secp256k1_ge_is_infinity(&amp;ge[i1]));</span>
<span class="term-fg31">-                CHECK(secp256k1_gej_is_infinity(&amp;gej[i1]));</span>
<span class="term-fg31">-                ge_equals_gej(&amp;ref, &amp;gej[i2]);</span>
<span class="term-fg31">-            }</span>
<span class="term-fg31">-            if (i2 == 0) {</span>
<span class="term-fg31">-                CHECK(secp256k1_ge_is_infinity(&amp;ge[i2]));</span>
<span class="term-fg31">-                CHECK(secp256k1_gej_is_infinity(&amp;gej[i2]));</span>
<span class="term-fg31">-                ge_equals_gej(&amp;ref, &amp;gej[i1]);</span>
<span class="term-fg31">-            }</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Test adding all points together in random order equals infinity. *&#47;</span>
<span class="term-fg31">-    {</span>
<span class="term-fg31">-        secp256k1_gej sum = SECP256K1_GEJ_CONST_INFINITY;</span>
<span class="term-fg31">-        secp256k1_gej *gej_shuffled = (secp256k1_gej *)malloc((4 * runs + 1) * sizeof(secp256k1_gej));</span>
<span class="term-fg31">-        for (i = 0; i &lt; 4 * runs + 1; i++) {</span>
<span class="term-fg31">-            gej_shuffled[i] = gej[i];</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        for (i = 0; i &lt; 4 * runs + 1; i++) {</span>
<span class="term-fg31">-            int swap = i + secp256k1_rand_int(4 * runs + 1 - i);</span>
<span class="term-fg31">-            if (swap != i) {</span>
<span class="term-fg31">-                secp256k1_gej t = gej_shuffled[i];</span>
<span class="term-fg31">-                gej_shuffled[i] = gej_shuffled[swap];</span>
<span class="term-fg31">-                gej_shuffled[swap] = t;</span>
<span class="term-fg31">-            }</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        for (i = 0; i &lt; 4 * runs + 1; i++) {</span>
<span class="term-fg31">-            secp256k1_gej_add_var(&amp;sum, &amp;sum, &amp;gej_shuffled[i], NULL);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        CHECK(secp256k1_gej_is_infinity(&amp;sum));</span>
<span class="term-fg31">-        free(gej_shuffled);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Test batch gej -&gt; ge conversion with and without known z ratios. *&#47;</span>
<span class="term-fg31">-    {</span>
<span class="term-fg31">-        secp256k1_fe *zr = (secp256k1_fe *)malloc((4 * runs + 1) * sizeof(secp256k1_fe));</span>
<span class="term-fg31">-        secp256k1_ge *ge_set_table = (secp256k1_ge *)malloc((4 * runs + 1) * sizeof(secp256k1_ge));</span>
<span class="term-fg31">-        secp256k1_ge *ge_set_all = (secp256k1_ge *)malloc((4 * runs + 1) * sizeof(secp256k1_ge));</span>
<span class="term-fg31">-        for (i = 0; i &lt; 4 * runs + 1; i++) {</span>
<span class="term-fg31">-            &#47;* Compute gej[i + 1].z &#47; gez[i].z (with gej[n].z taken to be 1). *&#47;</span>
<span class="term-fg31">-            if (i &lt; 4 * runs) {</span>
<span class="term-fg31">-                secp256k1_fe_mul(&amp;zr[i + 1], &amp;zinv[i], &amp;gej[i + 1].z);</span>
<span class="term-fg31">-            }</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        secp256k1_ge_set_table_gej_var(ge_set_table, gej, zr, 4 * runs + 1);</span>
<span class="term-fg31">-        secp256k1_ge_set_all_gej_var(ge_set_all, gej, 4 * runs + 1, &amp;ctx-&gt;error_callback);</span>
<span class="term-fg31">-        for (i = 0; i &lt; 4 * runs + 1; i++) {</span>
<span class="term-fg31">-            secp256k1_fe s;</span>
<span class="term-fg31">-            random_fe_non_zero(&amp;s);</span>
<span class="term-fg31">-            secp256k1_gej_rescale(&amp;gej[i], &amp;s);</span>
<span class="term-fg31">-            ge_equals_gej(&amp;ge_set_table[i], &amp;gej[i]);</span>
<span class="term-fg31">-            ge_equals_gej(&amp;ge_set_all[i], &amp;gej[i]);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        free(ge_set_table);</span>
<span class="term-fg31">-        free(ge_set_all);</span>
<span class="term-fg31">-        free(zr);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    free(ge);</span>
<span class="term-fg31">-    free(gej);</span>
<span class="term-fg31">-    free(zinv);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void test_add_neg_y_diff_x(void) {</span>
<span class="term-fg31">-    &#47;* The point of this test is to check that we can add two points</span>
<span class="term-fg31">-     * whose y-coordinates are negatives of each other but whose x</span>
<span class="term-fg31">-     * coordinates differ. If the x-coordinates were the same, these</span>
<span class="term-fg31">-     * points would be negatives of each other and their sum is</span>
<span class="term-fg31">-     * infinity. This is cool because it &quot;covers up&quot; any degeneracy</span>
<span class="term-fg31">-     * in the addition algorithm that would cause the xy coordinates</span>
<span class="term-fg31">-     * of the sum to be wrong (since infinity has no xy coordinates).</span>
<span class="term-fg31">-     * HOWEVER, if the x-coordinates are different, infinity is the</span>
<span class="term-fg31">-     * wrong answer, and such degeneracies are exposed. This is the</span>
<span class="term-fg31">-     * root of https:&#47;&#47;github.com&#47;bitcoin-core&#47;secp256k1&#47;issues&#47;257</span>
<span class="term-fg31">-     * which this test is a regression test for.</span>
<span class="term-fg31">-     *</span>
<span class="term-fg31">-     * These points were generated in sage as</span>
<span class="term-fg31">-     * # secp256k1 params</span>
<span class="term-fg31">-     * F = FiniteField (0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F)</span>
<span class="term-fg31">-     * C = EllipticCurve ([F (0), F (7)])</span>
<span class="term-fg31">-     * G = C.lift_x(0x79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798)</span>
<span class="term-fg31">-     * N = FiniteField(G.order())</span>
<span class="term-fg31">-     *</span>
<span class="term-fg31">-     * # endomorphism values (lambda is 1^{1&#47;3} in N, beta is 1^{1&#47;3} in F)</span>
<span class="term-fg31">-     * x = polygen(N)</span>
<span class="term-fg31">-     * lam  = (1 - x^3).roots()[1][0]</span>
<span class="term-fg31">-     *</span>
<span class="term-fg31">-     * # random &quot;bad pair&quot;</span>
<span class="term-fg31">-     * P = C.random_element()</span>
<span class="term-fg31">-     * Q = -int(lam) * P</span>
<span class="term-fg31">-     * print &quot;    P: %x %x&quot; % P.xy()</span>
<span class="term-fg31">-     * print &quot;    Q: %x %x&quot; % Q.xy()</span>
<span class="term-fg31">-     * print &quot;P + Q: %x %x&quot; % (P + Q).xy()</span>
<span class="term-fg31">-     *&#47;</span>
<span class="term-fg31">-    secp256k1_gej aj = SECP256K1_GEJ_CONST(</span>
<span class="term-fg31">-        0x8d24cd95, 0x0a355af1, 0x3c543505, 0x44238d30,</span>
<span class="term-fg31">-        0x0643d79f, 0x05a59614, 0x2f8ec030, 0xd58977cb,</span>
<span class="term-fg31">-        0x001e337a, 0x38093dcd, 0x6c0f386d, 0x0b1293a8,</span>
<span class="term-fg31">-        0x4d72c879, 0xd7681924, 0x44e6d2f3, 0x9190117d</span>
<span class="term-fg31">-    );</span>
<span class="term-fg31">-    secp256k1_gej bj = SECP256K1_GEJ_CONST(</span>
<span class="term-fg31">-        0xc7b74206, 0x1f788cd9, 0xabd0937d, 0x164a0d86,</span>
<span class="term-fg31">-        0x95f6ff75, 0xf19a4ce9, 0xd013bd7b, 0xbf92d2a7,</span>
<span class="term-fg31">-        0xffe1cc85, 0xc7f6c232, 0x93f0c792, 0xf4ed6c57,</span>
<span class="term-fg31">-        0xb28d3786, 0x2897e6db, 0xbb192d0b, 0x6e6feab2</span>
<span class="term-fg31">-    );</span>
<span class="term-fg31">-    secp256k1_gej sumj = SECP256K1_GEJ_CONST(</span>
<span class="term-fg31">-        0x671a63c0, 0x3efdad4c, 0x389a7798, 0x24356027,</span>
<span class="term-fg31">-        0xb3d69010, 0x278625c3, 0x5c86d390, 0x184a8f7a,</span>
<span class="term-fg31">-        0x5f6409c2, 0x2ce01f2b, 0x511fd375, 0x25071d08,</span>
<span class="term-fg31">-        0xda651801, 0x70e95caf, 0x8f0d893c, 0xbed8fbbe</span>
<span class="term-fg31">-    );</span>
<span class="term-fg31">-    secp256k1_ge b;</span>
<span class="term-fg31">-    secp256k1_gej resj;</span>
<span class="term-fg31">-    secp256k1_ge res;</span>
<span class="term-fg31">-    secp256k1_ge_set_gej(&amp;b, &amp;bj);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_gej_add_var(&amp;resj, &amp;aj, &amp;bj, NULL);</span>
<span class="term-fg31">-    secp256k1_ge_set_gej(&amp;res, &amp;resj);</span>
<span class="term-fg31">-    ge_equals_gej(&amp;res, &amp;sumj);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_gej_add_ge(&amp;resj, &amp;aj, &amp;b);</span>
<span class="term-fg31">-    secp256k1_ge_set_gej(&amp;res, &amp;resj);</span>
<span class="term-fg31">-    ge_equals_gej(&amp;res, &amp;sumj);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_gej_add_ge_var(&amp;resj, &amp;aj, &amp;b, NULL);</span>
<span class="term-fg31">-    secp256k1_ge_set_gej(&amp;res, &amp;resj);</span>
<span class="term-fg31">-    ge_equals_gej(&amp;res, &amp;sumj);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void run_ge(void) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    for (i = 0; i &lt; count * 32; i++) {</span>
<span class="term-fg31">-        test_ge();</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    test_add_neg_y_diff_x();</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void test_ec_combine(void) {</span>
<span class="term-fg31">-    secp256k1_scalar sum = SECP256K1_SCALAR_CONST(0, 0, 0, 0, 0, 0, 0, 0);</span>
<span class="term-fg31">-    secp256k1_pubkey data[6];</span>
<span class="term-fg31">-    const secp256k1_pubkey* d[6];</span>
<span class="term-fg31">-    secp256k1_pubkey sd;</span>
<span class="term-fg31">-    secp256k1_pubkey sd2;</span>
<span class="term-fg31">-    secp256k1_gej Qj;</span>
<span class="term-fg31">-    secp256k1_ge Q;</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    for (i = 1; i &lt;= 6; i++) {</span>
<span class="term-fg31">-        secp256k1_scalar s;</span>
<span class="term-fg31">-        random_scalar_order_test(&amp;s);</span>
<span class="term-fg31">-        secp256k1_scalar_add(&amp;sum, &amp;sum, &amp;s);</span>
<span class="term-fg31">-        secp256k1_ecmult_gen(&amp;ctx-&gt;ecmult_gen_ctx, &amp;Qj, &amp;s);</span>
<span class="term-fg31">-        secp256k1_ge_set_gej(&amp;Q, &amp;Qj);</span>
<span class="term-fg31">-        secp256k1_pubkey_save(&amp;data[i - 1], &amp;Q);</span>
<span class="term-fg31">-        d[i - 1] = &amp;data[i - 1];</span>
<span class="term-fg31">-        secp256k1_ecmult_gen(&amp;ctx-&gt;ecmult_gen_ctx, &amp;Qj, &amp;sum);</span>
<span class="term-fg31">-        secp256k1_ge_set_gej(&amp;Q, &amp;Qj);</span>
<span class="term-fg31">-        secp256k1_pubkey_save(&amp;sd, &amp;Q);</span>
<span class="term-fg31">-        CHECK(secp256k1_ec_pubkey_combine(ctx, &amp;sd2, d, i) == 1);</span>
<span class="term-fg31">-        CHECK(memcmp(&amp;sd, &amp;sd2, sizeof(sd)) == 0);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void run_ec_combine(void) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    for (i = 0; i &lt; count * 8; i++) {</span>
<span class="term-fg31">-         test_ec_combine();</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void test_group_decompress(const secp256k1_fe* x) {</span>
<span class="term-fg31">-    &#47;* The input itself, normalized. *&#47;</span>
<span class="term-fg31">-    secp256k1_fe fex = *x;</span>
<span class="term-fg31">-    secp256k1_fe fez;</span>
<span class="term-fg31">-    &#47;* Results of set_xquad_var, set_xo_var(..., 0), set_xo_var(..., 1). *&#47;</span>
<span class="term-fg31">-    secp256k1_ge ge_quad, ge_even, ge_odd;</span>
<span class="term-fg31">-    secp256k1_gej gej_quad;</span>
<span class="term-fg31">-    &#47;* Return values of the above calls. *&#47;</span>
<span class="term-fg31">-    int res_quad, res_even, res_odd;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_fe_normalize_var(&amp;fex);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    res_quad = secp256k1_ge_set_xquad(&amp;ge_quad, &amp;fex);</span>
<span class="term-fg31">-    res_even = secp256k1_ge_set_xo_var(&amp;ge_even, &amp;fex, 0);</span>
<span class="term-fg31">-    res_odd = secp256k1_ge_set_xo_var(&amp;ge_odd, &amp;fex, 1);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    CHECK(res_quad == res_even);</span>
<span class="term-fg31">-    CHECK(res_quad == res_odd);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    if (res_quad) {</span>
<span class="term-fg31">-        secp256k1_fe_normalize_var(&amp;ge_quad.x);</span>
<span class="term-fg31">-        secp256k1_fe_normalize_var(&amp;ge_odd.x);</span>
<span class="term-fg31">-        secp256k1_fe_normalize_var(&amp;ge_even.x);</span>
<span class="term-fg31">-        secp256k1_fe_normalize_var(&amp;ge_quad.y);</span>
<span class="term-fg31">-        secp256k1_fe_normalize_var(&amp;ge_odd.y);</span>
<span class="term-fg31">-        secp256k1_fe_normalize_var(&amp;ge_even.y);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        &#47;* No infinity allowed. *&#47;</span>
<span class="term-fg31">-        CHECK(!ge_quad.infinity);</span>
<span class="term-fg31">-        CHECK(!ge_even.infinity);</span>
<span class="term-fg31">-        CHECK(!ge_odd.infinity);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        &#47;* Check that the x coordinates check out. *&#47;</span>
<span class="term-fg31">-        CHECK(secp256k1_fe_equal_var(&amp;ge_quad.x, x));</span>
<span class="term-fg31">-        CHECK(secp256k1_fe_equal_var(&amp;ge_even.x, x));</span>
<span class="term-fg31">-        CHECK(secp256k1_fe_equal_var(&amp;ge_odd.x, x));</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        &#47;* Check that the Y coordinate result in ge_quad is a square. *&#47;</span>
<span class="term-fg31">-        CHECK(secp256k1_fe_is_quad_var(&amp;ge_quad.y));</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        &#47;* Check odd&#47;even Y in ge_odd, ge_even. *&#47;</span>
<span class="term-fg31">-        CHECK(secp256k1_fe_is_odd(&amp;ge_odd.y));</span>
<span class="term-fg31">-        CHECK(!secp256k1_fe_is_odd(&amp;ge_even.y));</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        &#47;* Check secp256k1_gej_has_quad_y_var. *&#47;</span>
<span class="term-fg31">-        secp256k1_gej_set_ge(&amp;gej_quad, &amp;ge_quad);</span>
<span class="term-fg31">-        CHECK(secp256k1_gej_has_quad_y_var(&amp;gej_quad));</span>
<span class="term-fg31">-        do {</span>
<span class="term-fg31">-            random_fe_test(&amp;fez);</span>
<span class="term-fg31">-        } while (secp256k1_fe_is_zero(&amp;fez));</span>
<span class="term-fg31">-        secp256k1_gej_rescale(&amp;gej_quad, &amp;fez);</span>
<span class="term-fg31">-        CHECK(secp256k1_gej_has_quad_y_var(&amp;gej_quad));</span>
<span class="term-fg31">-        secp256k1_gej_neg(&amp;gej_quad, &amp;gej_quad);</span>
<span class="term-fg31">-        CHECK(!secp256k1_gej_has_quad_y_var(&amp;gej_quad));</span>
<span class="term-fg31">-        do {</span>
<span class="term-fg31">-            random_fe_test(&amp;fez);</span>
<span class="term-fg31">-        } while (secp256k1_fe_is_zero(&amp;fez));</span>
<span class="term-fg31">-        secp256k1_gej_rescale(&amp;gej_quad, &amp;fez);</span>
<span class="term-fg31">-        CHECK(!secp256k1_gej_has_quad_y_var(&amp;gej_quad));</span>
<span class="term-fg31">-        secp256k1_gej_neg(&amp;gej_quad, &amp;gej_quad);</span>
<span class="term-fg31">-        CHECK(secp256k1_gej_has_quad_y_var(&amp;gej_quad));</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void run_group_decompress(void) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    for (i = 0; i &lt; count * 4; i++) {</span>
<span class="term-fg31">-        secp256k1_fe fe;</span>
<span class="term-fg31">-        random_fe_test(&amp;fe);</span>
<span class="term-fg31">-        test_group_decompress(&amp;fe);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;***** ECMULT TESTS *****&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void run_ecmult_chain(void) {</span>
<span class="term-fg31">-    &#47;* random starting point A (on the curve) *&#47;</span>
<span class="term-fg31">-    secp256k1_gej a = SECP256K1_GEJ_CONST(</span>
<span class="term-fg31">-        0x8b30bbe9, 0xae2a9906, 0x96b22f67, 0x0709dff3,</span>
<span class="term-fg31">-        0x727fd8bc, 0x04d3362c, 0x6c7bf458, 0xe2846004,</span>
<span class="term-fg31">-        0xa357ae91, 0x5c4a6528, 0x1309edf2, 0x0504740f,</span>
<span class="term-fg31">-        0x0eb33439, 0x90216b4f, 0x81063cb6, 0x5f2f7e0f</span>
<span class="term-fg31">-    );</span>
<span class="term-fg31">-    &#47;* two random initial factors xn and gn *&#47;</span>
<span class="term-fg31">-    secp256k1_scalar xn = SECP256K1_SCALAR_CONST(</span>
<span class="term-fg31">-        0x84cc5452, 0xf7fde1ed, 0xb4d38a8c, 0xe9b1b84c,</span>
<span class="term-fg31">-        0xcef31f14, 0x6e569be9, 0x705d357a, 0x42985407</span>
<span class="term-fg31">-    );</span>
<span class="term-fg31">-    secp256k1_scalar gn = SECP256K1_SCALAR_CONST(</span>
<span class="term-fg31">-        0xa1e58d22, 0x553dcd42, 0xb2398062, 0x5d4c57a9,</span>
<span class="term-fg31">-        0x6e9323d4, 0x2b3152e5, 0xca2c3990, 0xedc7c9de</span>
<span class="term-fg31">-    );</span>
<span class="term-fg31">-    &#47;* two small multipliers to be applied to xn and gn in every iteration: *&#47;</span>
<span class="term-fg31">-    static const secp256k1_scalar xf = SECP256K1_SCALAR_CONST(0, 0, 0, 0, 0, 0, 0, 0x1337);</span>
<span class="term-fg31">-    static const secp256k1_scalar gf = SECP256K1_SCALAR_CONST(0, 0, 0, 0, 0, 0, 0, 0x7113);</span>
<span class="term-fg31">-    &#47;* accumulators with the resulting coefficients to A and G *&#47;</span>
<span class="term-fg31">-    secp256k1_scalar ae = SECP256K1_SCALAR_CONST(0, 0, 0, 0, 0, 0, 0, 1);</span>
<span class="term-fg31">-    secp256k1_scalar ge = SECP256K1_SCALAR_CONST(0, 0, 0, 0, 0, 0, 0, 0);</span>
<span class="term-fg31">-    &#47;* actual points *&#47;</span>
<span class="term-fg31">-    secp256k1_gej x;</span>
<span class="term-fg31">-    secp256k1_gej x2;</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* the point being computed *&#47;</span>
<span class="term-fg31">-    x = a;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 200*count; i++) {</span>
<span class="term-fg31">-        &#47;* in each iteration, compute X = xn*X + gn*G; *&#47;</span>
<span class="term-fg31">-        secp256k1_ecmult(&amp;ctx-&gt;ecmult_ctx, &amp;x, &amp;x, &amp;xn, &amp;gn);</span>
<span class="term-fg31">-        &#47;* also compute ae and ge: the actual accumulated factors for A and G *&#47;</span>
<span class="term-fg31">-        &#47;* if X was (ae*A+ge*G), xn*X + gn*G results in (xn*ae*A + (xn*ge+gn)*G) *&#47;</span>
<span class="term-fg31">-        secp256k1_scalar_mul(&amp;ae, &amp;ae, &amp;xn);</span>
<span class="term-fg31">-        secp256k1_scalar_mul(&amp;ge, &amp;ge, &amp;xn);</span>
<span class="term-fg31">-        secp256k1_scalar_add(&amp;ge, &amp;ge, &amp;gn);</span>
<span class="term-fg31">-        &#47;* modify xn and gn *&#47;</span>
<span class="term-fg31">-        secp256k1_scalar_mul(&amp;xn, &amp;xn, &amp;xf);</span>
<span class="term-fg31">-        secp256k1_scalar_mul(&amp;gn, &amp;gn, &amp;gf);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        &#47;* verify *&#47;</span>
<span class="term-fg31">-        if (i == 19999) {</span>
<span class="term-fg31">-            &#47;* expected result after 19999 iterations *&#47;</span>
<span class="term-fg31">-            secp256k1_gej rp = SECP256K1_GEJ_CONST(</span>
<span class="term-fg31">-                0xD6E96687, 0xF9B10D09, 0x2A6F3543, 0x9D86CEBE,</span>
<span class="term-fg31">-                0xA4535D0D, 0x409F5358, 0x6440BD74, 0xB933E830,</span>
<span class="term-fg31">-                0xB95CBCA2, 0xC77DA786, 0x539BE8FD, 0x53354D2D,</span>
<span class="term-fg31">-                0x3B4F566A, 0xE6580454, 0x07ED6015, 0xEE1B2A88</span>
<span class="term-fg31">-            );</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-            secp256k1_gej_neg(&amp;rp, &amp;rp);</span>
<span class="term-fg31">-            secp256k1_gej_add_var(&amp;rp, &amp;rp, &amp;x, NULL);</span>
<span class="term-fg31">-            CHECK(secp256k1_gej_is_infinity(&amp;rp));</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    &#47;* redo the computation, but directly with the resulting ae and ge coefficients: *&#47;</span>
<span class="term-fg31">-    secp256k1_ecmult(&amp;ctx-&gt;ecmult_ctx, &amp;x2, &amp;a, &amp;ae, &amp;ge);</span>
<span class="term-fg31">-    secp256k1_gej_neg(&amp;x2, &amp;x2);</span>
<span class="term-fg31">-    secp256k1_gej_add_var(&amp;x2, &amp;x2, &amp;x, NULL);</span>
<span class="term-fg31">-    CHECK(secp256k1_gej_is_infinity(&amp;x2));</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void test_point_times_order(const secp256k1_gej *point) {</span>
<span class="term-fg31">-    &#47;* X * (point + G) + (order-X) * (pointer + G) = 0 *&#47;</span>
<span class="term-fg31">-    secp256k1_scalar x;</span>
<span class="term-fg31">-    secp256k1_scalar nx;</span>
<span class="term-fg31">-    secp256k1_scalar zero = SECP256K1_SCALAR_CONST(0, 0, 0, 0, 0, 0, 0, 0);</span>
<span class="term-fg31">-    secp256k1_scalar one = SECP256K1_SCALAR_CONST(0, 0, 0, 0, 0, 0, 0, 1);</span>
<span class="term-fg31">-    secp256k1_gej res1, res2;</span>
<span class="term-fg31">-    secp256k1_ge res3;</span>
<span class="term-fg31">-    unsigned char pub[65];</span>
<span class="term-fg31">-    size_t psize = 65;</span>
<span class="term-fg31">-    random_scalar_order_test(&amp;x);</span>
<span class="term-fg31">-    secp256k1_scalar_negate(&amp;nx, &amp;x);</span>
<span class="term-fg31">-    secp256k1_ecmult(&amp;ctx-&gt;ecmult_ctx, &amp;res1, point, &amp;x, &amp;x); &#47;* calc res1 = x * point + x * G; *&#47;</span>
<span class="term-fg31">-    secp256k1_ecmult(&amp;ctx-&gt;ecmult_ctx, &amp;res2, point, &amp;nx, &amp;nx); &#47;* calc res2 = (order - x) * point + (order - x) * G; *&#47;</span>
<span class="term-fg31">-    secp256k1_gej_add_var(&amp;res1, &amp;res1, &amp;res2, NULL);</span>
<span class="term-fg31">-    CHECK(secp256k1_gej_is_infinity(&amp;res1));</span>
<span class="term-fg31">-    CHECK(secp256k1_gej_is_valid_var(&amp;res1) == 0);</span>
<span class="term-fg31">-    secp256k1_ge_set_gej(&amp;res3, &amp;res1);</span>
<span class="term-fg31">-    CHECK(secp256k1_ge_is_infinity(&amp;res3));</span>
<span class="term-fg31">-    CHECK(secp256k1_ge_is_valid_var(&amp;res3) == 0);</span>
<span class="term-fg31">-    CHECK(secp256k1_eckey_pubkey_serialize(&amp;res3, pub, &amp;psize, 0) == 0);</span>
<span class="term-fg31">-    psize = 65;</span>
<span class="term-fg31">-    CHECK(secp256k1_eckey_pubkey_serialize(&amp;res3, pub, &amp;psize, 1) == 0);</span>
<span class="term-fg31">-    &#47;* check zero&#47;one edge cases *&#47;</span>
<span class="term-fg31">-    secp256k1_ecmult(&amp;ctx-&gt;ecmult_ctx, &amp;res1, point, &amp;zero, &amp;zero);</span>
<span class="term-fg31">-    secp256k1_ge_set_gej(&amp;res3, &amp;res1);</span>
<span class="term-fg31">-    CHECK(secp256k1_ge_is_infinity(&amp;res3));</span>
<span class="term-fg31">-    secp256k1_ecmult(&amp;ctx-&gt;ecmult_ctx, &amp;res1, point, &amp;one, &amp;zero);</span>
<span class="term-fg31">-    secp256k1_ge_set_gej(&amp;res3, &amp;res1);</span>
<span class="term-fg31">-    ge_equals_gej(&amp;res3, point);</span>
<span class="term-fg31">-    secp256k1_ecmult(&amp;ctx-&gt;ecmult_ctx, &amp;res1, point, &amp;zero, &amp;one);</span>
<span class="term-fg31">-    secp256k1_ge_set_gej(&amp;res3, &amp;res1);</span>
<span class="term-fg31">-    ge_equals_ge(&amp;res3, &amp;secp256k1_ge_const_g);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void run_point_times_order(void) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    secp256k1_fe x = SECP256K1_FE_CONST(0, 0, 0, 0, 0, 0, 0, 2);</span>
<span class="term-fg31">-    static const secp256k1_fe xr = SECP256K1_FE_CONST(</span>
<span class="term-fg31">-        0x7603CB59, 0xB0EF6C63, 0xFE608479, 0x2A0C378C,</span>
<span class="term-fg31">-        0xDB3233A8, 0x0F8A9A09, 0xA877DEAD, 0x31B38C45</span>
<span class="term-fg31">-    );</span>
<span class="term-fg31">-    for (i = 0; i &lt; 500; i++) {</span>
<span class="term-fg31">-        secp256k1_ge p;</span>
<span class="term-fg31">-        if (secp256k1_ge_set_xo_var(&amp;p, &amp;x, 1)) {</span>
<span class="term-fg31">-            secp256k1_gej j;</span>
<span class="term-fg31">-            CHECK(secp256k1_ge_is_valid_var(&amp;p));</span>
<span class="term-fg31">-            secp256k1_gej_set_ge(&amp;j, &amp;p);</span>
<span class="term-fg31">-            CHECK(secp256k1_gej_is_valid_var(&amp;j));</span>
<span class="term-fg31">-            test_point_times_order(&amp;j);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        secp256k1_fe_sqr(&amp;x, &amp;x);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_fe_normalize_var(&amp;x);</span>
<span class="term-fg31">-    CHECK(secp256k1_fe_equal_var(&amp;x, &amp;xr));</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void ecmult_const_random_mult(void) {</span>
<span class="term-fg31">-    &#47;* random starting point A (on the curve) *&#47;</span>
<span class="term-fg31">-    secp256k1_ge a = SECP256K1_GE_CONST(</span>
<span class="term-fg31">-        0x6d986544, 0x57ff52b8, 0xcf1b8126, 0x5b802a5b,</span>
<span class="term-fg31">-        0xa97f9263, 0xb1e88044, 0x93351325, 0x91bc450a,</span>
<span class="term-fg31">-        0x535c59f7, 0x325e5d2b, 0xc391fbe8, 0x3c12787c,</span>
<span class="term-fg31">-        0x337e4a98, 0xe82a9011, 0x0123ba37, 0xdd769c7d</span>
<span class="term-fg31">-    );</span>
<span class="term-fg31">-    &#47;* random initial factor xn *&#47;</span>
<span class="term-fg31">-    secp256k1_scalar xn = SECP256K1_SCALAR_CONST(</span>
<span class="term-fg31">-        0x649d4f77, 0xc4242df7, 0x7f2079c9, 0x14530327,</span>
<span class="term-fg31">-        0xa31b876a, 0xd2d8ce2a, 0x2236d5c6, 0xd7b2029b</span>
<span class="term-fg31">-    );</span>
<span class="term-fg31">-    &#47;* expected xn * A (from sage) *&#47;</span>
<span class="term-fg31">-    secp256k1_ge expected_b = SECP256K1_GE_CONST(</span>
<span class="term-fg31">-        0x23773684, 0x4d209dc7, 0x098a786f, 0x20d06fcd,</span>
<span class="term-fg31">-        0x070a38bf, 0xc11ac651, 0x03004319, 0x1e2a8786,</span>
<span class="term-fg31">-        0xed8c3b8e, 0xc06dd57b, 0xd06ea66e, 0x45492b0f,</span>
<span class="term-fg31">-        0xb84e4e1b, 0xfb77e21f, 0x96baae2a, 0x63dec956</span>
<span class="term-fg31">-    );</span>
<span class="term-fg31">-    secp256k1_gej b;</span>
<span class="term-fg31">-    secp256k1_ecmult_const(&amp;b, &amp;a, &amp;xn);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    CHECK(secp256k1_ge_is_valid_var(&amp;a));</span>
<span class="term-fg31">-    ge_equals_gej(&amp;expected_b, &amp;b);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void ecmult_const_commutativity(void) {</span>
<span class="term-fg31">-    secp256k1_scalar a;</span>
<span class="term-fg31">-    secp256k1_scalar b;</span>
<span class="term-fg31">-    secp256k1_gej res1;</span>
<span class="term-fg31">-    secp256k1_gej res2;</span>
<span class="term-fg31">-    secp256k1_ge mid1;</span>
<span class="term-fg31">-    secp256k1_ge mid2;</span>
<span class="term-fg31">-    random_scalar_order_test(&amp;a);</span>
<span class="term-fg31">-    random_scalar_order_test(&amp;b);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_ecmult_const(&amp;res1, &amp;secp256k1_ge_const_g, &amp;a);</span>
<span class="term-fg31">-    secp256k1_ecmult_const(&amp;res2, &amp;secp256k1_ge_const_g, &amp;b);</span>
<span class="term-fg31">-    secp256k1_ge_set_gej(&amp;mid1, &amp;res1);</span>
<span class="term-fg31">-    secp256k1_ge_set_gej(&amp;mid2, &amp;res2);</span>
<span class="term-fg31">-    secp256k1_ecmult_const(&amp;res1, &amp;mid1, &amp;b);</span>
<span class="term-fg31">-    secp256k1_ecmult_const(&amp;res2, &amp;mid2, &amp;a);</span>
<span class="term-fg31">-    secp256k1_ge_set_gej(&amp;mid1, &amp;res1);</span>
<span class="term-fg31">-    secp256k1_ge_set_gej(&amp;mid2, &amp;res2);</span>
<span class="term-fg31">-    ge_equals_ge(&amp;mid1, &amp;mid2);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void ecmult_const_mult_zero_one(void) {</span>
<span class="term-fg31">-    secp256k1_scalar zero = SECP256K1_SCALAR_CONST(0, 0, 0, 0, 0, 0, 0, 0);</span>
<span class="term-fg31">-    secp256k1_scalar one = SECP256K1_SCALAR_CONST(0, 0, 0, 0, 0, 0, 0, 1);</span>
<span class="term-fg31">-    secp256k1_scalar negone;</span>
<span class="term-fg31">-    secp256k1_gej res1;</span>
<span class="term-fg31">-    secp256k1_ge res2;</span>
<span class="term-fg31">-    secp256k1_ge point;</span>
<span class="term-fg31">-    secp256k1_scalar_negate(&amp;negone, &amp;one);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    random_group_element_test(&amp;point);</span>
<span class="term-fg31">-    secp256k1_ecmult_const(&amp;res1, &amp;point, &amp;zero);</span>
<span class="term-fg31">-    secp256k1_ge_set_gej(&amp;res2, &amp;res1);</span>
<span class="term-fg31">-    CHECK(secp256k1_ge_is_infinity(&amp;res2));</span>
<span class="term-fg31">-    secp256k1_ecmult_const(&amp;res1, &amp;point, &amp;one);</span>
<span class="term-fg31">-    secp256k1_ge_set_gej(&amp;res2, &amp;res1);</span>
<span class="term-fg31">-    ge_equals_ge(&amp;res2, &amp;point);</span>
<span class="term-fg31">-    secp256k1_ecmult_const(&amp;res1, &amp;point, &amp;negone);</span>
<span class="term-fg31">-    secp256k1_gej_neg(&amp;res1, &amp;res1);</span>
<span class="term-fg31">-    secp256k1_ge_set_gej(&amp;res2, &amp;res1);</span>
<span class="term-fg31">-    ge_equals_ge(&amp;res2, &amp;point);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void ecmult_const_chain_multiply(void) {</span>
<span class="term-fg31">-    &#47;* Check known result (randomly generated test problem from sage) *&#47;</span>
<span class="term-fg31">-    const secp256k1_scalar scalar = SECP256K1_SCALAR_CONST(</span>
<span class="term-fg31">-        0x4968d524, 0x2abf9b7a, 0x466abbcf, 0x34b11b6d,</span>
<span class="term-fg31">-        0xcd83d307, 0x827bed62, 0x05fad0ce, 0x18fae63b</span>
<span class="term-fg31">-    );</span>
<span class="term-fg31">-    const secp256k1_gej expected_point = SECP256K1_GEJ_CONST(</span>
<span class="term-fg31">-        0x5494c15d, 0x32099706, 0xc2395f94, 0x348745fd,</span>
<span class="term-fg31">-        0x757ce30e, 0x4e8c90fb, 0xa2bad184, 0xf883c69f,</span>
<span class="term-fg31">-        0x5d195d20, 0xe191bf7f, 0x1be3e55f, 0x56a80196,</span>
<span class="term-fg31">-        0x6071ad01, 0xf1462f66, 0xc997fa94, 0xdb858435</span>
<span class="term-fg31">-    );</span>
<span class="term-fg31">-    secp256k1_gej point;</span>
<span class="term-fg31">-    secp256k1_ge res;</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_gej_set_ge(&amp;point, &amp;secp256k1_ge_const_g);</span>
<span class="term-fg31">-    for (i = 0; i &lt; 100; ++i) {</span>
<span class="term-fg31">-        secp256k1_ge tmp;</span>
<span class="term-fg31">-        secp256k1_ge_set_gej(&amp;tmp, &amp;point);</span>
<span class="term-fg31">-        secp256k1_ecmult_const(&amp;point, &amp;tmp, &amp;scalar);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_ge_set_gej(&amp;res, &amp;point);</span>
<span class="term-fg31">-    ge_equals_gej(&amp;res, &amp;expected_point);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void run_ecmult_const_tests(void) {</span>
<span class="term-fg31">-    ecmult_const_mult_zero_one();</span>
<span class="term-fg31">-    ecmult_const_random_mult();</span>
<span class="term-fg31">-    ecmult_const_commutativity();</span>
<span class="term-fg31">-    ecmult_const_chain_multiply();</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void test_wnaf(const secp256k1_scalar *number, int w) {</span>
<span class="term-fg31">-    secp256k1_scalar x, two, t;</span>
<span class="term-fg31">-    int wnaf[256];</span>
<span class="term-fg31">-    int zeroes = -1;</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    int bits;</span>
<span class="term-fg31">-    secp256k1_scalar_set_int(&amp;x, 0);</span>
<span class="term-fg31">-    secp256k1_scalar_set_int(&amp;two, 2);</span>
<span class="term-fg31">-    bits = secp256k1_ecmult_wnaf(wnaf, 256, number, w);</span>
<span class="term-fg31">-    CHECK(bits &lt;= 256);</span>
<span class="term-fg31">-    for (i = bits-1; i &gt;= 0; i--) {</span>
<span class="term-fg31">-        int v = wnaf[i];</span>
<span class="term-fg31">-        secp256k1_scalar_mul(&amp;x, &amp;x, &amp;two);</span>
<span class="term-fg31">-        if (v) {</span>
<span class="term-fg31">-            CHECK(zeroes == -1 || zeroes &gt;= w-1); &#47;* check that distance between non-zero elements is at least w-1 *&#47;</span>
<span class="term-fg31">-            zeroes=0;</span>
<span class="term-fg31">-            CHECK((v &amp; 1) == 1); &#47;* check non-zero elements are odd *&#47;</span>
<span class="term-fg31">-            CHECK(v &lt;= (1 &lt;&lt; (w-1)) - 1); &#47;* check range below *&#47;</span>
<span class="term-fg31">-            CHECK(v &gt;= -(1 &lt;&lt; (w-1)) - 1); &#47;* check range above *&#47;</span>
<span class="term-fg31">-        } else {</span>
<span class="term-fg31">-            CHECK(zeroes != -1); &#47;* check that no unnecessary zero padding exists *&#47;</span>
<span class="term-fg31">-            zeroes++;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        if (v &gt;= 0) {</span>
<span class="term-fg31">-            secp256k1_scalar_set_int(&amp;t, v);</span>
<span class="term-fg31">-        } else {</span>
<span class="term-fg31">-            secp256k1_scalar_set_int(&amp;t, -v);</span>
<span class="term-fg31">-            secp256k1_scalar_negate(&amp;t, &amp;t);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        secp256k1_scalar_add(&amp;x, &amp;x, &amp;t);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    CHECK(secp256k1_scalar_eq(&amp;x, number)); &#47;* check that wnaf represents number *&#47;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void test_constant_wnaf_negate(const secp256k1_scalar *number) {</span>
<span class="term-fg31">-    secp256k1_scalar neg1 = *number;</span>
<span class="term-fg31">-    secp256k1_scalar neg2 = *number;</span>
<span class="term-fg31">-    int sign1 = 1;</span>
<span class="term-fg31">-    int sign2 = 1;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    if (!secp256k1_scalar_get_bits(&amp;neg1, 0, 1)) {</span>
<span class="term-fg31">-        secp256k1_scalar_negate(&amp;neg1, &amp;neg1);</span>
<span class="term-fg31">-        sign1 = -1;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    sign2 = secp256k1_scalar_cond_negate(&amp;neg2, secp256k1_scalar_is_even(&amp;neg2));</span>
<span class="term-fg31">-    CHECK(sign1 == sign2);</span>
<span class="term-fg31">-    CHECK(secp256k1_scalar_eq(&amp;neg1, &amp;neg2));</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void test_constant_wnaf(const secp256k1_scalar *number, int w) {</span>
<span class="term-fg31">-    secp256k1_scalar x, shift;</span>
<span class="term-fg31">-    int wnaf[256] = {0};</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    int skew;</span>
<span class="term-fg31">-    secp256k1_scalar num = *number;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_scalar_set_int(&amp;x, 0);</span>
<span class="term-fg31">-    secp256k1_scalar_set_int(&amp;shift, 1 &lt;&lt; w);</span>
<span class="term-fg31">-    &#47;* With USE_ENDOMORPHISM on we only consider 128-bit numbers *&#47;</span>
<span class="term-fg31">-#ifdef USE_ENDOMORPHISM</span>
<span class="term-fg31">-    for (i = 0; i &lt; 16; ++i) {</span>
<span class="term-fg31">-        secp256k1_scalar_shr_int(&amp;num, 8);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-    skew = secp256k1_wnaf_const(wnaf, num, w);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    for (i = WNAF_SIZE(w); i &gt;= 0; --i) {</span>
<span class="term-fg31">-        secp256k1_scalar t;</span>
<span class="term-fg31">-        int v = wnaf[i];</span>
<span class="term-fg31">-        CHECK(v != 0); &#47;* check nonzero *&#47;</span>
<span class="term-fg31">-        CHECK(v &amp; 1);  &#47;* check parity *&#47;</span>
<span class="term-fg31">-        CHECK(v &gt; -(1 &lt;&lt; w)); &#47;* check range above *&#47;</span>
<span class="term-fg31">-        CHECK(v &lt; (1 &lt;&lt; w));  &#47;* check range below *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        secp256k1_scalar_mul(&amp;x, &amp;x, &amp;shift);</span>
<span class="term-fg31">-        if (v &gt;= 0) {</span>
<span class="term-fg31">-            secp256k1_scalar_set_int(&amp;t, v);</span>
<span class="term-fg31">-        } else {</span>
<span class="term-fg31">-            secp256k1_scalar_set_int(&amp;t, -v);</span>
<span class="term-fg31">-            secp256k1_scalar_negate(&amp;t, &amp;t);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        secp256k1_scalar_add(&amp;x, &amp;x, &amp;t);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    &#47;* Skew num because when encoding numbers as odd we use an offset *&#47;</span>
<span class="term-fg31">-    secp256k1_scalar_cadd_bit(&amp;num, skew == 2, 1);</span>
<span class="term-fg31">-    CHECK(secp256k1_scalar_eq(&amp;x, &amp;num));</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void run_wnaf(void) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    secp256k1_scalar n = {{0}};</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Sanity check: 1 and 2 are the smallest odd and even numbers and should</span>
<span class="term-fg31">-     *               have easier-to-diagnose failure modes  *&#47;</span>
<span class="term-fg31">-    n.d[0] = 1;</span>
<span class="term-fg31">-    test_constant_wnaf(&amp;n, 4);</span>
<span class="term-fg31">-    n.d[0] = 2;</span>
<span class="term-fg31">-    test_constant_wnaf(&amp;n, 4);</span>
<span class="term-fg31">-    &#47;* Random tests *&#47;</span>
<span class="term-fg31">-    for (i = 0; i &lt; count; i++) {</span>
<span class="term-fg31">-        random_scalar_order(&amp;n);</span>
<span class="term-fg31">-        test_wnaf(&amp;n, 4+(i%10));</span>
<span class="term-fg31">-        test_constant_wnaf_negate(&amp;n);</span>
<span class="term-fg31">-        test_constant_wnaf(&amp;n, 4 + (i % 10));</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_scalar_set_int(&amp;n, 0);</span>
<span class="term-fg31">-    CHECK(secp256k1_scalar_cond_negate(&amp;n, 1) == -1);</span>
<span class="term-fg31">-    CHECK(secp256k1_scalar_is_zero(&amp;n));</span>
<span class="term-fg31">-    CHECK(secp256k1_scalar_cond_negate(&amp;n, 0) == 1);</span>
<span class="term-fg31">-    CHECK(secp256k1_scalar_is_zero(&amp;n));</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void test_ecmult_constants(void) {</span>
<span class="term-fg31">-    &#47;* Test ecmult_gen() for [0..36) and [order-36..0). *&#47;</span>
<span class="term-fg31">-    secp256k1_scalar x;</span>
<span class="term-fg31">-    secp256k1_gej r;</span>
<span class="term-fg31">-    secp256k1_ge ng;</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    int j;</span>
<span class="term-fg31">-    secp256k1_ge_neg(&amp;ng, &amp;secp256k1_ge_const_g);</span>
<span class="term-fg31">-    for (i = 0; i &lt; 36; i++ ) {</span>
<span class="term-fg31">-        secp256k1_scalar_set_int(&amp;x, i);</span>
<span class="term-fg31">-        secp256k1_ecmult_gen(&amp;ctx-&gt;ecmult_gen_ctx, &amp;r, &amp;x);</span>
<span class="term-fg31">-        for (j = 0; j &lt; i; j++) {</span>
<span class="term-fg31">-            if (j == i - 1) {</span>
<span class="term-fg31">-                ge_equals_gej(&amp;secp256k1_ge_const_g, &amp;r);</span>
<span class="term-fg31">-            }</span>
<span class="term-fg31">-            secp256k1_gej_add_ge(&amp;r, &amp;r, &amp;ng);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        CHECK(secp256k1_gej_is_infinity(&amp;r));</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    for (i = 1; i &lt;= 36; i++ ) {</span>
<span class="term-fg31">-        secp256k1_scalar_set_int(&amp;x, i);</span>
<span class="term-fg31">-        secp256k1_scalar_negate(&amp;x, &amp;x);</span>
<span class="term-fg31">-        secp256k1_ecmult_gen(&amp;ctx-&gt;ecmult_gen_ctx, &amp;r, &amp;x);</span>
<span class="term-fg31">-        for (j = 0; j &lt; i; j++) {</span>
<span class="term-fg31">-            if (j == i - 1) {</span>
<span class="term-fg31">-                ge_equals_gej(&amp;ng, &amp;r);</span>
<span class="term-fg31">-            }</span>
<span class="term-fg31">-            secp256k1_gej_add_ge(&amp;r, &amp;r, &amp;secp256k1_ge_const_g);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        CHECK(secp256k1_gej_is_infinity(&amp;r));</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void run_ecmult_constants(void) {</span>
<span class="term-fg31">-    test_ecmult_constants();</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void test_ecmult_gen_blind(void) {</span>
<span class="term-fg31">-    &#47;* Test ecmult_gen() blinding and confirm that the blinding changes, the affine points match, and the z&#39;s don&#39;t match. *&#47;</span>
<span class="term-fg31">-    secp256k1_scalar key;</span>
<span class="term-fg31">-    secp256k1_scalar b;</span>
<span class="term-fg31">-    unsigned char seed32[32];</span>
<span class="term-fg31">-    secp256k1_gej pgej;</span>
<span class="term-fg31">-    secp256k1_gej pgej2;</span>
<span class="term-fg31">-    secp256k1_gej i;</span>
<span class="term-fg31">-    secp256k1_ge pge;</span>
<span class="term-fg31">-    random_scalar_order_test(&amp;key);</span>
<span class="term-fg31">-    secp256k1_ecmult_gen(&amp;ctx-&gt;ecmult_gen_ctx, &amp;pgej, &amp;key);</span>
<span class="term-fg31">-    secp256k1_rand256(seed32);</span>
<span class="term-fg31">-    b = ctx-&gt;ecmult_gen_ctx.blind;</span>
<span class="term-fg31">-    i = ctx-&gt;ecmult_gen_ctx.initial;</span>
<span class="term-fg31">-    secp256k1_ecmult_gen_blind(&amp;ctx-&gt;ecmult_gen_ctx, seed32);</span>
<span class="term-fg31">-    CHECK(!secp256k1_scalar_eq(&amp;b, &amp;ctx-&gt;ecmult_gen_ctx.blind));</span>
<span class="term-fg31">-    secp256k1_ecmult_gen(&amp;ctx-&gt;ecmult_gen_ctx, &amp;pgej2, &amp;key);</span>
<span class="term-fg31">-    CHECK(!gej_xyz_equals_gej(&amp;pgej, &amp;pgej2));</span>
<span class="term-fg31">-    CHECK(!gej_xyz_equals_gej(&amp;i, &amp;ctx-&gt;ecmult_gen_ctx.initial));</span>
<span class="term-fg31">-    secp256k1_ge_set_gej(&amp;pge, &amp;pgej);</span>
<span class="term-fg31">-    ge_equals_gej(&amp;pge, &amp;pgej2);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void test_ecmult_gen_blind_reset(void) {</span>
<span class="term-fg31">-    &#47;* Test ecmult_gen() blinding reset and confirm that the blinding is consistent. *&#47;</span>
<span class="term-fg31">-    secp256k1_scalar b;</span>
<span class="term-fg31">-    secp256k1_gej initial;</span>
<span class="term-fg31">-    secp256k1_ecmult_gen_blind(&amp;ctx-&gt;ecmult_gen_ctx, 0);</span>
<span class="term-fg31">-    b = ctx-&gt;ecmult_gen_ctx.blind;</span>
<span class="term-fg31">-    initial = ctx-&gt;ecmult_gen_ctx.initial;</span>
<span class="term-fg31">-    secp256k1_ecmult_gen_blind(&amp;ctx-&gt;ecmult_gen_ctx, 0);</span>
<span class="term-fg31">-    CHECK(secp256k1_scalar_eq(&amp;b, &amp;ctx-&gt;ecmult_gen_ctx.blind));</span>
<span class="term-fg31">-    CHECK(gej_xyz_equals_gej(&amp;initial, &amp;ctx-&gt;ecmult_gen_ctx.initial));</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void run_ecmult_gen_blind(void) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    test_ecmult_gen_blind_reset();</span>
<span class="term-fg31">-    for (i = 0; i &lt; 10; i++) {</span>
<span class="term-fg31">-        test_ecmult_gen_blind();</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef USE_ENDOMORPHISM</span>
<span class="term-fg31">-&#47;***** ENDOMORPHISH TESTS *****&#47;</span>
<span class="term-fg31">-void test_scalar_split(void) {</span>
<span class="term-fg31">-    secp256k1_scalar full;</span>
<span class="term-fg31">-    secp256k1_scalar s1, slam;</span>
<span class="term-fg31">-    const unsigned char zero[32] = {0};</span>
<span class="term-fg31">-    unsigned char tmp[32];</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    random_scalar_order_test(&amp;full);</span>
<span class="term-fg31">-    secp256k1_scalar_split_lambda(&amp;s1, &amp;slam, &amp;full);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* check that both are &lt;= 128 bits in size *&#47;</span>
<span class="term-fg31">-    if (secp256k1_scalar_is_high(&amp;s1)) {</span>
<span class="term-fg31">-        secp256k1_scalar_negate(&amp;s1, &amp;s1);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    if (secp256k1_scalar_is_high(&amp;slam)) {</span>
<span class="term-fg31">-        secp256k1_scalar_negate(&amp;slam, &amp;slam);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_scalar_get_b32(tmp, &amp;s1);</span>
<span class="term-fg31">-    CHECK(memcmp(zero, tmp, 16) == 0);</span>
<span class="term-fg31">-    secp256k1_scalar_get_b32(tmp, &amp;slam);</span>
<span class="term-fg31">-    CHECK(memcmp(zero, tmp, 16) == 0);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void run_endomorphism_tests(void) {</span>
<span class="term-fg31">-    test_scalar_split();</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void ec_pubkey_parse_pointtest(const unsigned char *input, int xvalid, int yvalid) {</span>
<span class="term-fg31">-    unsigned char pubkeyc[65];</span>
<span class="term-fg31">-    secp256k1_pubkey pubkey;</span>
<span class="term-fg31">-    secp256k1_ge ge;</span>
<span class="term-fg31">-    size_t pubkeyclen;</span>
<span class="term-fg31">-    int32_t ecount;</span>
<span class="term-fg31">-    ecount = 0;</span>
<span class="term-fg31">-    secp256k1_context_set_illegal_callback(ctx, counting_illegal_callback_fn, &amp;ecount);</span>
<span class="term-fg31">-    for (pubkeyclen = 3; pubkeyclen &lt;= 65; pubkeyclen++) {</span>
<span class="term-fg31">-        &#47;* Smaller sizes are tested exhaustively elsewhere. *&#47;</span>
<span class="term-fg31">-        int32_t i;</span>
<span class="term-fg31">-        memcpy(&amp;pubkeyc[1], input, 64);</span>
<span class="term-fg31">-        VG_UNDEF(&amp;pubkeyc[pubkeyclen], 65 - pubkeyclen);</span>
<span class="term-fg31">-        for (i = 0; i &lt; 256; i++) {</span>
<span class="term-fg31">-            &#47;* Try all type bytes. *&#47;</span>
<span class="term-fg31">-            int xpass;</span>
<span class="term-fg31">-            int ypass;</span>
<span class="term-fg31">-            int ysign;</span>
<span class="term-fg31">-            pubkeyc[0] = i;</span>
<span class="term-fg31">-            &#47;* What sign does this point have? *&#47;</span>
<span class="term-fg31">-            ysign = (input[63] &amp; 1) + 2;</span>
<span class="term-fg31">-            &#47;* For the current type (i) do we expect parsing to work? Handled all of compressed&#47;uncompressed&#47;hybrid. *&#47;</span>
<span class="term-fg31">-            xpass = xvalid &amp;&amp; (pubkeyclen == 33) &amp;&amp; ((i &amp; 254) == 2);</span>
<span class="term-fg31">-            &#47;* Do we expect a parse and re-serialize as uncompressed to give a matching y? *&#47;</span>
<span class="term-fg31">-            ypass = xvalid &amp;&amp; yvalid &amp;&amp; ((i &amp; 4) == ((pubkeyclen == 65) &lt;&lt; 2)) &amp;&amp;</span>
<span class="term-fg31">-                ((i == 4) || ((i &amp; 251) == ysign)) &amp;&amp; ((pubkeyclen == 33) || (pubkeyclen == 65));</span>
<span class="term-fg31">-            if (xpass || ypass) {</span>
<span class="term-fg31">-                &#47;* These cases must parse. *&#47;</span>
<span class="term-fg31">-                unsigned char pubkeyo[65];</span>
<span class="term-fg31">-                size_t outl;</span>
<span class="term-fg31">-                memset(&amp;pubkey, 0, sizeof(pubkey));</span>
<span class="term-fg31">-                VG_UNDEF(&amp;pubkey, sizeof(pubkey));</span>
<span class="term-fg31">-                ecount = 0;</span>
<span class="term-fg31">-                CHECK(secp256k1_ec_pubkey_parse(ctx, &amp;pubkey, pubkeyc, pubkeyclen) == 1);</span>
<span class="term-fg31">-                VG_CHECK(&amp;pubkey, sizeof(pubkey));</span>
<span class="term-fg31">-                outl = 65;</span>
<span class="term-fg31">-                VG_UNDEF(pubkeyo, 65);</span>
<span class="term-fg31">-                CHECK(secp256k1_ec_pubkey_serialize(ctx, pubkeyo, &amp;outl, &amp;pubkey, SECP256K1_EC_COMPRESSED) == 1);</span>
<span class="term-fg31">-                VG_CHECK(pubkeyo, outl);</span>
<span class="term-fg31">-                CHECK(outl == 33);</span>
<span class="term-fg31">-                CHECK(memcmp(&amp;pubkeyo[1], &amp;pubkeyc[1], 32) == 0);</span>
<span class="term-fg31">-                CHECK((pubkeyclen != 33) || (pubkeyo[0] == pubkeyc[0]));</span>
<span class="term-fg31">-                if (ypass) {</span>
<span class="term-fg31">-                    &#47;* This test isn&#39;t always done because we decode with alternative signs, so the y won&#39;t match. *&#47;</span>
<span class="term-fg31">-                    CHECK(pubkeyo[0] == ysign);</span>
<span class="term-fg31">-                    CHECK(secp256k1_pubkey_load(ctx, &amp;ge, &amp;pubkey) == 1);</span>
<span class="term-fg31">-                    memset(&amp;pubkey, 0, sizeof(pubkey));</span>
<span class="term-fg31">-                    VG_UNDEF(&amp;pubkey, sizeof(pubkey));</span>
<span class="term-fg31">-                    secp256k1_pubkey_save(&amp;pubkey, &amp;ge);</span>
<span class="term-fg31">-                    VG_CHECK(&amp;pubkey, sizeof(pubkey));</span>
<span class="term-fg31">-                    outl = 65;</span>
<span class="term-fg31">-                    VG_UNDEF(pubkeyo, 65);</span>
<span class="term-fg31">-                    CHECK(secp256k1_ec_pubkey_serialize(ctx, pubkeyo, &amp;outl, &amp;pubkey, SECP256K1_EC_UNCOMPRESSED) == 1);</span>
<span class="term-fg31">-                    VG_CHECK(pubkeyo, outl);</span>
<span class="term-fg31">-                    CHECK(outl == 65);</span>
<span class="term-fg31">-                    CHECK(pubkeyo[0] == 4);</span>
<span class="term-fg31">-                    CHECK(memcmp(&amp;pubkeyo[1], input, 64) == 0);</span>
<span class="term-fg31">-                }</span>
<span class="term-fg31">-                CHECK(ecount == 0);</span>
<span class="term-fg31">-            } else {</span>
<span class="term-fg31">-                &#47;* These cases must fail to parse. *&#47;</span>
<span class="term-fg31">-                memset(&amp;pubkey, 0xfe, sizeof(pubkey));</span>
<span class="term-fg31">-                ecount = 0;</span>
<span class="term-fg31">-                VG_UNDEF(&amp;pubkey, sizeof(pubkey));</span>
<span class="term-fg31">-                CHECK(secp256k1_ec_pubkey_parse(ctx, &amp;pubkey, pubkeyc, pubkeyclen) == 0);</span>
<span class="term-fg31">-                VG_CHECK(&amp;pubkey, sizeof(pubkey));</span>
<span class="term-fg31">-                CHECK(ecount == 0);</span>
<span class="term-fg31">-                CHECK(secp256k1_pubkey_load(ctx, &amp;ge, &amp;pubkey) == 0);</span>
<span class="term-fg31">-                CHECK(ecount == 1);</span>
<span class="term-fg31">-            }</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_context_set_illegal_callback(ctx, NULL, NULL);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void run_ec_pubkey_parse_test(void) {</span>
<span class="term-fg31">-#define SECP256K1_EC_PARSE_TEST_NVALID (12)</span>
<span class="term-fg31">-    const unsigned char valid[SECP256K1_EC_PARSE_TEST_NVALID][64] = {</span>
<span class="term-fg31">-        {</span>
<span class="term-fg31">-            &#47;* Point with leading and trailing zeros in x and y serialization. *&#47;</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x42, 0x52,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-            0x00, 0x00, 0x64, 0xef, 0xa1, 0x7b, 0x77, 0x61, 0xe1, 0xe4, 0x27, 0x06, 0x98, 0x9f, 0xb4, 0x83,</span>
<span class="term-fg31">-            0xb8, 0xd2, 0xd4, 0x9b, 0xf7, 0x8f, 0xae, 0x98, 0x03, 0xf0, 0x99, 0xb8, 0x34, 0xed, 0xeb, 0x00</span>
<span class="term-fg31">-        },</span>
<span class="term-fg31">-        {</span>
<span class="term-fg31">-            &#47;* Point with x equal to a 3rd root of unity.*&#47;</span>
<span class="term-fg31">-            0x7a, 0xe9, 0x6a, 0x2b, 0x65, 0x7c, 0x07, 0x10, 0x6e, 0x64, 0x47, 0x9e, 0xac, 0x34, 0x34, 0xe9,</span>
<span class="term-fg31">-            0x9c, 0xf0, 0x49, 0x75, 0x12, 0xf5, 0x89, 0x95, 0xc1, 0x39, 0x6c, 0x28, 0x71, 0x95, 0x01, 0xee,</span>
<span class="term-fg31">-            0x42, 0x18, 0xf2, 0x0a, 0xe6, 0xc6, 0x46, 0xb3, 0x63, 0xdb, 0x68, 0x60, 0x58, 0x22, 0xfb, 0x14,</span>
<span class="term-fg31">-            0x26, 0x4c, 0xa8, 0xd2, 0x58, 0x7f, 0xdd, 0x6f, 0xbc, 0x75, 0x0d, 0x58, 0x7e, 0x76, 0xa7, 0xee,</span>
<span class="term-fg31">-        },</span>
<span class="term-fg31">-        {</span>
<span class="term-fg31">-            &#47;* Point with largest x. (1&#47;2) *&#47;</span>
<span class="term-fg31">-            0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-            0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xfe, 0xff, 0xff, 0xfc, 0x2c,</span>
<span class="term-fg31">-            0x0e, 0x99, 0x4b, 0x14, 0xea, 0x72, 0xf8, 0xc3, 0xeb, 0x95, 0xc7, 0x1e, 0xf6, 0x92, 0x57, 0x5e,</span>
<span class="term-fg31">-            0x77, 0x50, 0x58, 0x33, 0x2d, 0x7e, 0x52, 0xd0, 0x99, 0x5c, 0xf8, 0x03, 0x88, 0x71, 0xb6, 0x7d,</span>
<span class="term-fg31">-        },</span>
<span class="term-fg31">-        {</span>
<span class="term-fg31">-            &#47;* Point with largest x. (2&#47;2) *&#47;</span>
<span class="term-fg31">-            0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-            0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xfe, 0xff, 0xff, 0xfc, 0x2c,</span>
<span class="term-fg31">-            0xf1, 0x66, 0xb4, 0xeb, 0x15, 0x8d, 0x07, 0x3c, 0x14, 0x6a, 0x38, 0xe1, 0x09, 0x6d, 0xa8, 0xa1,</span>
<span class="term-fg31">-            0x88, 0xaf, 0xa7, 0xcc, 0xd2, 0x81, 0xad, 0x2f, 0x66, 0xa3, 0x07, 0xfb, 0x77, 0x8e, 0x45, 0xb2,</span>
<span class="term-fg31">-        },</span>
<span class="term-fg31">-        {</span>
<span class="term-fg31">-            &#47;* Point with smallest x. (1&#47;2) *&#47;</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01,</span>
<span class="term-fg31">-            0x42, 0x18, 0xf2, 0x0a, 0xe6, 0xc6, 0x46, 0xb3, 0x63, 0xdb, 0x68, 0x60, 0x58, 0x22, 0xfb, 0x14,</span>
<span class="term-fg31">-            0x26, 0x4c, 0xa8, 0xd2, 0x58, 0x7f, 0xdd, 0x6f, 0xbc, 0x75, 0x0d, 0x58, 0x7e, 0x76, 0xa7, 0xee,</span>
<span class="term-fg31">-        },</span>
<span class="term-fg31">-        {</span>
<span class="term-fg31">-            &#47;* Point with smallest x. (2&#47;2) *&#47;</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01,</span>
<span class="term-fg31">-            0xbd, 0xe7, 0x0d, 0xf5, 0x19, 0x39, 0xb9, 0x4c, 0x9c, 0x24, 0x97, 0x9f, 0xa7, 0xdd, 0x04, 0xeb,</span>
<span class="term-fg31">-            0xd9, 0xb3, 0x57, 0x2d, 0xa7, 0x80, 0x22, 0x90, 0x43, 0x8a, 0xf2, 0xa6, 0x81, 0x89, 0x54, 0x41,</span>
<span class="term-fg31">-        },</span>
<span class="term-fg31">-        {</span>
<span class="term-fg31">-            &#47;* Point with largest y. (1&#47;3) *&#47;</span>
<span class="term-fg31">-            0x1f, 0xe1, 0xe5, 0xef, 0x3f, 0xce, 0xb5, 0xc1, 0x35, 0xab, 0x77, 0x41, 0x33, 0x3c, 0xe5, 0xa6,</span>
<span class="term-fg31">-            0xe8, 0x0d, 0x68, 0x16, 0x76, 0x53, 0xf6, 0xb2, 0xb2, 0x4b, 0xcb, 0xcf, 0xaa, 0xaf, 0xf5, 0x07,</span>
<span class="term-fg31">-            0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-            0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xfe, 0xff, 0xff, 0xfc, 0x2e,</span>
<span class="term-fg31">-        },</span>
<span class="term-fg31">-        {</span>
<span class="term-fg31">-            &#47;* Point with largest y. (2&#47;3) *&#47;</span>
<span class="term-fg31">-            0xcb, 0xb0, 0xde, 0xab, 0x12, 0x57, 0x54, 0xf1, 0xfd, 0xb2, 0x03, 0x8b, 0x04, 0x34, 0xed, 0x9c,</span>
<span class="term-fg31">-            0xb3, 0xfb, 0x53, 0xab, 0x73, 0x53, 0x91, 0x12, 0x99, 0x94, 0xa5, 0x35, 0xd9, 0x25, 0xf6, 0x73,</span>
<span class="term-fg31">-            0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-            0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xfe, 0xff, 0xff, 0xfc, 0x2e,</span>
<span class="term-fg31">-        },</span>
<span class="term-fg31">-        {</span>
<span class="term-fg31">-            &#47;* Point with largest y. (3&#47;3) *&#47;</span>
<span class="term-fg31">-            0x14, 0x6d, 0x3b, 0x65, 0xad, 0xd9, 0xf5, 0x4c, 0xcc, 0xa2, 0x85, 0x33, 0xc8, 0x8e, 0x2c, 0xbc,</span>
<span class="term-fg31">-            0x63, 0xf7, 0x44, 0x3e, 0x16, 0x58, 0x78, 0x3a, 0xb4, 0x1f, 0x8e, 0xf9, 0x7c, 0x2a, 0x10, 0xb5,</span>
<span class="term-fg31">-            0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-            0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xfe, 0xff, 0xff, 0xfc, 0x2e,</span>
<span class="term-fg31">-        },</span>
<span class="term-fg31">-        {</span>
<span class="term-fg31">-            &#47;* Point with smallest y. (1&#47;3) *&#47;</span>
<span class="term-fg31">-            0x1f, 0xe1, 0xe5, 0xef, 0x3f, 0xce, 0xb5, 0xc1, 0x35, 0xab, 0x77, 0x41, 0x33, 0x3c, 0xe5, 0xa6,</span>
<span class="term-fg31">-            0xe8, 0x0d, 0x68, 0x16, 0x76, 0x53, 0xf6, 0xb2, 0xb2, 0x4b, 0xcb, 0xcf, 0xaa, 0xaf, 0xf5, 0x07,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01,</span>
<span class="term-fg31">-        },</span>
<span class="term-fg31">-        {</span>
<span class="term-fg31">-            &#47;* Point with smallest y. (2&#47;3) *&#47;</span>
<span class="term-fg31">-            0xcb, 0xb0, 0xde, 0xab, 0x12, 0x57, 0x54, 0xf1, 0xfd, 0xb2, 0x03, 0x8b, 0x04, 0x34, 0xed, 0x9c,</span>
<span class="term-fg31">-            0xb3, 0xfb, 0x53, 0xab, 0x73, 0x53, 0x91, 0x12, 0x99, 0x94, 0xa5, 0x35, 0xd9, 0x25, 0xf6, 0x73,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01,</span>
<span class="term-fg31">-        },</span>
<span class="term-fg31">-        {</span>
<span class="term-fg31">-            &#47;* Point with smallest y. (3&#47;3) *&#47;</span>
<span class="term-fg31">-            0x14, 0x6d, 0x3b, 0x65, 0xad, 0xd9, 0xf5, 0x4c, 0xcc, 0xa2, 0x85, 0x33, 0xc8, 0x8e, 0x2c, 0xbc,</span>
<span class="term-fg31">-            0x63, 0xf7, 0x44, 0x3e, 0x16, 0x58, 0x78, 0x3a, 0xb4, 0x1f, 0x8e, 0xf9, 0x7c, 0x2a, 0x10, 0xb5,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    };</span>
<span class="term-fg31">-#define SECP256K1_EC_PARSE_TEST_NXVALID (4)</span>
<span class="term-fg31">-    const unsigned char onlyxvalid[SECP256K1_EC_PARSE_TEST_NXVALID][64] = {</span>
<span class="term-fg31">-        {</span>
<span class="term-fg31">-            &#47;* Valid if y overflow ignored (y = 1 mod p). (1&#47;3) *&#47;</span>
<span class="term-fg31">-            0x1f, 0xe1, 0xe5, 0xef, 0x3f, 0xce, 0xb5, 0xc1, 0x35, 0xab, 0x77, 0x41, 0x33, 0x3c, 0xe5, 0xa6,</span>
<span class="term-fg31">-            0xe8, 0x0d, 0x68, 0x16, 0x76, 0x53, 0xf6, 0xb2, 0xb2, 0x4b, 0xcb, 0xcf, 0xaa, 0xaf, 0xf5, 0x07,</span>
<span class="term-fg31">-            0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-            0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xfe, 0xff, 0xff, 0xfc, 0x30,</span>
<span class="term-fg31">-        },</span>
<span class="term-fg31">-        {</span>
<span class="term-fg31">-            &#47;* Valid if y overflow ignored (y = 1 mod p). (2&#47;3) *&#47;</span>
<span class="term-fg31">-            0xcb, 0xb0, 0xde, 0xab, 0x12, 0x57, 0x54, 0xf1, 0xfd, 0xb2, 0x03, 0x8b, 0x04, 0x34, 0xed, 0x9c,</span>
<span class="term-fg31">-            0xb3, 0xfb, 0x53, 0xab, 0x73, 0x53, 0x91, 0x12, 0x99, 0x94, 0xa5, 0x35, 0xd9, 0x25, 0xf6, 0x73,</span>
<span class="term-fg31">-            0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-            0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xfe, 0xff, 0xff, 0xfc, 0x30,</span>
<span class="term-fg31">-        },</span>
<span class="term-fg31">-        {</span>
<span class="term-fg31">-            &#47;* Valid if y overflow ignored (y = 1 mod p). (3&#47;3)*&#47;</span>
<span class="term-fg31">-            0x14, 0x6d, 0x3b, 0x65, 0xad, 0xd9, 0xf5, 0x4c, 0xcc, 0xa2, 0x85, 0x33, 0xc8, 0x8e, 0x2c, 0xbc,</span>
<span class="term-fg31">-            0x63, 0xf7, 0x44, 0x3e, 0x16, 0x58, 0x78, 0x3a, 0xb4, 0x1f, 0x8e, 0xf9, 0x7c, 0x2a, 0x10, 0xb5,</span>
<span class="term-fg31">-            0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-            0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xfe, 0xff, 0xff, 0xfc, 0x30,</span>
<span class="term-fg31">-        },</span>
<span class="term-fg31">-        {</span>
<span class="term-fg31">-            &#47;* x on curve, y is from y^2 = x^3 + 8. *&#47;</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    };</span>
<span class="term-fg31">-#define SECP256K1_EC_PARSE_TEST_NINVALID (7)</span>
<span class="term-fg31">-    const unsigned char invalid[SECP256K1_EC_PARSE_TEST_NINVALID][64] = {</span>
<span class="term-fg31">-        {</span>
<span class="term-fg31">-            &#47;* x is third root of -8, y is -1 * (x^3+7); also on the curve for y^2 = x^3 + 9. *&#47;</span>
<span class="term-fg31">-            0x0a, 0x2d, 0x2b, 0xa9, 0x35, 0x07, 0xf1, 0xdf, 0x23, 0x37, 0x70, 0xc2, 0xa7, 0x97, 0x96, 0x2c,</span>
<span class="term-fg31">-            0xc6, 0x1f, 0x6d, 0x15, 0xda, 0x14, 0xec, 0xd4, 0x7d, 0x8d, 0x27, 0xae, 0x1c, 0xd5, 0xf8, 0x53,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01,</span>
<span class="term-fg31">-        },</span>
<span class="term-fg31">-        {</span>
<span class="term-fg31">-            &#47;* Valid if x overflow ignored (x = 1 mod p). *&#47;</span>
<span class="term-fg31">-            0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-            0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xfe, 0xff, 0xff, 0xfc, 0x30,</span>
<span class="term-fg31">-            0x42, 0x18, 0xf2, 0x0a, 0xe6, 0xc6, 0x46, 0xb3, 0x63, 0xdb, 0x68, 0x60, 0x58, 0x22, 0xfb, 0x14,</span>
<span class="term-fg31">-            0x26, 0x4c, 0xa8, 0xd2, 0x58, 0x7f, 0xdd, 0x6f, 0xbc, 0x75, 0x0d, 0x58, 0x7e, 0x76, 0xa7, 0xee,</span>
<span class="term-fg31">-        },</span>
<span class="term-fg31">-        {</span>
<span class="term-fg31">-            &#47;* Valid if x overflow ignored (x = 1 mod p). *&#47;</span>
<span class="term-fg31">-            0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-            0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xfe, 0xff, 0xff, 0xfc, 0x30,</span>
<span class="term-fg31">-            0xbd, 0xe7, 0x0d, 0xf5, 0x19, 0x39, 0xb9, 0x4c, 0x9c, 0x24, 0x97, 0x9f, 0xa7, 0xdd, 0x04, 0xeb,</span>
<span class="term-fg31">-            0xd9, 0xb3, 0x57, 0x2d, 0xa7, 0x80, 0x22, 0x90, 0x43, 0x8a, 0xf2, 0xa6, 0x81, 0x89, 0x54, 0x41,</span>
<span class="term-fg31">-        },</span>
<span class="term-fg31">-        {</span>
<span class="term-fg31">-            &#47;* x is -1, y is the result of the sqrt ladder; also on the curve for y^2 = x^3 - 5. *&#47;</span>
<span class="term-fg31">-            0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-            0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xfe, 0xff, 0xff, 0xfc, 0x2e,</span>
<span class="term-fg31">-            0xf4, 0x84, 0x14, 0x5c, 0xb0, 0x14, 0x9b, 0x82, 0x5d, 0xff, 0x41, 0x2f, 0xa0, 0x52, 0xa8, 0x3f,</span>
<span class="term-fg31">-            0xcb, 0x72, 0xdb, 0x61, 0xd5, 0x6f, 0x37, 0x70, 0xce, 0x06, 0x6b, 0x73, 0x49, 0xa2, 0xaa, 0x28,</span>
<span class="term-fg31">-        },</span>
<span class="term-fg31">-        {</span>
<span class="term-fg31">-            &#47;* x is -1, y is the result of the sqrt ladder; also on the curve for y^2 = x^3 - 5. *&#47;</span>
<span class="term-fg31">-            0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-            0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xfe, 0xff, 0xff, 0xfc, 0x2e,</span>
<span class="term-fg31">-            0x0b, 0x7b, 0xeb, 0xa3, 0x4f, 0xeb, 0x64, 0x7d, 0xa2, 0x00, 0xbe, 0xd0, 0x5f, 0xad, 0x57, 0xc0,</span>
<span class="term-fg31">-            0x34, 0x8d, 0x24, 0x9e, 0x2a, 0x90, 0xc8, 0x8f, 0x31, 0xf9, 0x94, 0x8b, 0xb6, 0x5d, 0x52, 0x07,</span>
<span class="term-fg31">-        },</span>
<span class="term-fg31">-        {</span>
<span class="term-fg31">-            &#47;* x is zero, y is the result of the sqrt ladder; also on the curve for y^2 = x^3 - 7. *&#47;</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-            0x8f, 0x53, 0x7e, 0xef, 0xdf, 0xc1, 0x60, 0x6a, 0x07, 0x27, 0xcd, 0x69, 0xb4, 0xa7, 0x33, 0x3d,</span>
<span class="term-fg31">-            0x38, 0xed, 0x44, 0xe3, 0x93, 0x2a, 0x71, 0x79, 0xee, 0xcb, 0x4b, 0x6f, 0xba, 0x93, 0x60, 0xdc,</span>
<span class="term-fg31">-        },</span>
<span class="term-fg31">-        {</span>
<span class="term-fg31">-            &#47;* x is zero, y is the result of the sqrt ladder; also on the curve for y^2 = x^3 - 7. *&#47;</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-            0x70, 0xac, 0x81, 0x10, 0x20, 0x3e, 0x9f, 0x95, 0xf8, 0xd8, 0x32, 0x96, 0x4b, 0x58, 0xcc, 0xc2,</span>
<span class="term-fg31">-            0xc7, 0x12, 0xbb, 0x1c, 0x6c, 0xd5, 0x8e, 0x86, 0x11, 0x34, 0xb4, 0x8f, 0x45, 0x6c, 0x9b, 0x53</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    };</span>
<span class="term-fg31">-    const unsigned char pubkeyc[66] = {</span>
<span class="term-fg31">-        &#47;* Serialization of G. *&#47;</span>
<span class="term-fg31">-        0x04, 0x79, 0xBE, 0x66, 0x7E, 0xF9, 0xDC, 0xBB, 0xAC, 0x55, 0xA0, 0x62, 0x95, 0xCE, 0x87, 0x0B,</span>
<span class="term-fg31">-        0x07, 0x02, 0x9B, 0xFC, 0xDB, 0x2D, 0xCE, 0x28, 0xD9, 0x59, 0xF2, 0x81, 0x5B, 0x16, 0xF8, 0x17,</span>
<span class="term-fg31">-        0x98, 0x48, 0x3A, 0xDA, 0x77, 0x26, 0xA3, 0xC4, 0x65, 0x5D, 0xA4, 0xFB, 0xFC, 0x0E, 0x11, 0x08,</span>
<span class="term-fg31">-        0xA8, 0xFD, 0x17, 0xB4, 0x48, 0xA6, 0x85, 0x54, 0x19, 0x9C, 0x47, 0xD0, 0x8F, 0xFB, 0x10, 0xD4,</span>
<span class="term-fg31">-        0xB8, 0x00</span>
<span class="term-fg31">-    };</span>
<span class="term-fg31">-    unsigned char sout[65];</span>
<span class="term-fg31">-    unsigned char shortkey[2];</span>
<span class="term-fg31">-    secp256k1_ge ge;</span>
<span class="term-fg31">-    secp256k1_pubkey pubkey;</span>
<span class="term-fg31">-    size_t len;</span>
<span class="term-fg31">-    int32_t i;</span>
<span class="term-fg31">-    int32_t ecount;</span>
<span class="term-fg31">-    int32_t ecount2;</span>
<span class="term-fg31">-    ecount = 0;</span>
<span class="term-fg31">-    &#47;* Nothing should be reading this far into pubkeyc. *&#47;</span>
<span class="term-fg31">-    VG_UNDEF(&amp;pubkeyc[65], 1);</span>
<span class="term-fg31">-    secp256k1_context_set_illegal_callback(ctx, counting_illegal_callback_fn, &amp;ecount);</span>
<span class="term-fg31">-    &#47;* Zero length claimed, fail, zeroize, no illegal arg error. *&#47;</span>
<span class="term-fg31">-    memset(&amp;pubkey, 0xfe, sizeof(pubkey));</span>
<span class="term-fg31">-    ecount = 0;</span>
<span class="term-fg31">-    VG_UNDEF(shortkey, 2);</span>
<span class="term-fg31">-    VG_UNDEF(&amp;pubkey, sizeof(pubkey));</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_parse(ctx, &amp;pubkey, shortkey, 0) == 0);</span>
<span class="term-fg31">-    VG_CHECK(&amp;pubkey, sizeof(pubkey));</span>
<span class="term-fg31">-    CHECK(ecount == 0);</span>
<span class="term-fg31">-    CHECK(secp256k1_pubkey_load(ctx, &amp;ge, &amp;pubkey) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 1);</span>
<span class="term-fg31">-    &#47;* Length one claimed, fail, zeroize, no illegal arg error. *&#47;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 256 ; i++) {</span>
<span class="term-fg31">-        memset(&amp;pubkey, 0xfe, sizeof(pubkey));</span>
<span class="term-fg31">-        ecount = 0;</span>
<span class="term-fg31">-        shortkey[0] = i;</span>
<span class="term-fg31">-        VG_UNDEF(&amp;shortkey[1], 1);</span>
<span class="term-fg31">-        VG_UNDEF(&amp;pubkey, sizeof(pubkey));</span>
<span class="term-fg31">-        CHECK(secp256k1_ec_pubkey_parse(ctx, &amp;pubkey, shortkey, 1) == 0);</span>
<span class="term-fg31">-        VG_CHECK(&amp;pubkey, sizeof(pubkey));</span>
<span class="term-fg31">-        CHECK(ecount == 0);</span>
<span class="term-fg31">-        CHECK(secp256k1_pubkey_load(ctx, &amp;ge, &amp;pubkey) == 0);</span>
<span class="term-fg31">-        CHECK(ecount == 1);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    &#47;* Length two claimed, fail, zeroize, no illegal arg error. *&#47;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 65536 ; i++) {</span>
<span class="term-fg31">-        memset(&amp;pubkey, 0xfe, sizeof(pubkey));</span>
<span class="term-fg31">-        ecount = 0;</span>
<span class="term-fg31">-        shortkey[0] = i &amp; 255;</span>
<span class="term-fg31">-        shortkey[1] = i &gt;&gt; 8;</span>
<span class="term-fg31">-        VG_UNDEF(&amp;pubkey, sizeof(pubkey));</span>
<span class="term-fg31">-        CHECK(secp256k1_ec_pubkey_parse(ctx, &amp;pubkey, shortkey, 2) == 0);</span>
<span class="term-fg31">-        VG_CHECK(&amp;pubkey, sizeof(pubkey));</span>
<span class="term-fg31">-        CHECK(ecount == 0);</span>
<span class="term-fg31">-        CHECK(secp256k1_pubkey_load(ctx, &amp;ge, &amp;pubkey) == 0);</span>
<span class="term-fg31">-        CHECK(ecount == 1);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    memset(&amp;pubkey, 0xfe, sizeof(pubkey));</span>
<span class="term-fg31">-    ecount = 0;</span>
<span class="term-fg31">-    VG_UNDEF(&amp;pubkey, sizeof(pubkey));</span>
<span class="term-fg31">-    &#47;* 33 bytes claimed on otherwise valid input starting with 0x04, fail, zeroize output, no illegal arg error. *&#47;</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_parse(ctx, &amp;pubkey, pubkeyc, 33) == 0);</span>
<span class="term-fg31">-    VG_CHECK(&amp;pubkey, sizeof(pubkey));</span>
<span class="term-fg31">-    CHECK(ecount == 0);</span>
<span class="term-fg31">-    CHECK(secp256k1_pubkey_load(ctx, &amp;ge, &amp;pubkey) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 1);</span>
<span class="term-fg31">-    &#47;* NULL pubkey, illegal arg error. Pubkey isn&#39;t rewritten before this step, since it&#39;s NULL into the parser. *&#47;</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_parse(ctx, NULL, pubkeyc, 65) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 2);</span>
<span class="term-fg31">-    &#47;* NULL input string. Illegal arg and zeroize output. *&#47;</span>
<span class="term-fg31">-    memset(&amp;pubkey, 0xfe, sizeof(pubkey));</span>
<span class="term-fg31">-    ecount = 0;</span>
<span class="term-fg31">-    VG_UNDEF(&amp;pubkey, sizeof(pubkey));</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_parse(ctx, &amp;pubkey, NULL, 65) == 0);</span>
<span class="term-fg31">-    VG_CHECK(&amp;pubkey, sizeof(pubkey));</span>
<span class="term-fg31">-    CHECK(ecount == 1);</span>
<span class="term-fg31">-    CHECK(secp256k1_pubkey_load(ctx, &amp;ge, &amp;pubkey) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 2);</span>
<span class="term-fg31">-    &#47;* 64 bytes claimed on input starting with 0x04, fail, zeroize output, no illegal arg error. *&#47;</span>
<span class="term-fg31">-    memset(&amp;pubkey, 0xfe, sizeof(pubkey));</span>
<span class="term-fg31">-    ecount = 0;</span>
<span class="term-fg31">-    VG_UNDEF(&amp;pubkey, sizeof(pubkey));</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_parse(ctx, &amp;pubkey, pubkeyc, 64) == 0);</span>
<span class="term-fg31">-    VG_CHECK(&amp;pubkey, sizeof(pubkey));</span>
<span class="term-fg31">-    CHECK(ecount == 0);</span>
<span class="term-fg31">-    CHECK(secp256k1_pubkey_load(ctx, &amp;ge, &amp;pubkey) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 1);</span>
<span class="term-fg31">-    &#47;* 66 bytes claimed, fail, zeroize output, no illegal arg error. *&#47;</span>
<span class="term-fg31">-    memset(&amp;pubkey, 0xfe, sizeof(pubkey));</span>
<span class="term-fg31">-    ecount = 0;</span>
<span class="term-fg31">-    VG_UNDEF(&amp;pubkey, sizeof(pubkey));</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_parse(ctx, &amp;pubkey, pubkeyc, 66) == 0);</span>
<span class="term-fg31">-    VG_CHECK(&amp;pubkey, sizeof(pubkey));</span>
<span class="term-fg31">-    CHECK(ecount == 0);</span>
<span class="term-fg31">-    CHECK(secp256k1_pubkey_load(ctx, &amp;ge, &amp;pubkey) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 1);</span>
<span class="term-fg31">-    &#47;* Valid parse. *&#47;</span>
<span class="term-fg31">-    memset(&amp;pubkey, 0, sizeof(pubkey));</span>
<span class="term-fg31">-    ecount = 0;</span>
<span class="term-fg31">-    VG_UNDEF(&amp;pubkey, sizeof(pubkey));</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_parse(ctx, &amp;pubkey, pubkeyc, 65) == 1);</span>
<span class="term-fg31">-    VG_CHECK(&amp;pubkey, sizeof(pubkey));</span>
<span class="term-fg31">-    CHECK(ecount == 0);</span>
<span class="term-fg31">-    VG_UNDEF(&amp;ge, sizeof(ge));</span>
<span class="term-fg31">-    CHECK(secp256k1_pubkey_load(ctx, &amp;ge, &amp;pubkey) == 1);</span>
<span class="term-fg31">-    VG_CHECK(&amp;ge.x, sizeof(ge.x));</span>
<span class="term-fg31">-    VG_CHECK(&amp;ge.y, sizeof(ge.y));</span>
<span class="term-fg31">-    VG_CHECK(&amp;ge.infinity, sizeof(ge.infinity));</span>
<span class="term-fg31">-    ge_equals_ge(&amp;secp256k1_ge_const_g, &amp;ge);</span>
<span class="term-fg31">-    CHECK(ecount == 0);</span>
<span class="term-fg31">-    &#47;* secp256k1_ec_pubkey_serialize illegal args. *&#47;</span>
<span class="term-fg31">-    ecount = 0;</span>
<span class="term-fg31">-    len = 65;</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_serialize(ctx, NULL, &amp;len, &amp;pubkey, SECP256K1_EC_UNCOMPRESSED) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 1);</span>
<span class="term-fg31">-    CHECK(len == 0);</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_serialize(ctx, sout, NULL, &amp;pubkey, SECP256K1_EC_UNCOMPRESSED) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 2);</span>
<span class="term-fg31">-    len = 65;</span>
<span class="term-fg31">-    VG_UNDEF(sout, 65);</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_serialize(ctx, sout, &amp;len, NULL, SECP256K1_EC_UNCOMPRESSED) == 0);</span>
<span class="term-fg31">-    VG_CHECK(sout, 65);</span>
<span class="term-fg31">-    CHECK(ecount == 3);</span>
<span class="term-fg31">-    CHECK(len == 0);</span>
<span class="term-fg31">-    len = 65;</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_serialize(ctx, sout, &amp;len, &amp;pubkey, ~0) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 4);</span>
<span class="term-fg31">-    CHECK(len == 0);</span>
<span class="term-fg31">-    len = 65;</span>
<span class="term-fg31">-    VG_UNDEF(sout, 65);</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_serialize(ctx, sout, &amp;len, &amp;pubkey, SECP256K1_EC_UNCOMPRESSED) == 1);</span>
<span class="term-fg31">-    VG_CHECK(sout, 65);</span>
<span class="term-fg31">-    CHECK(ecount == 4);</span>
<span class="term-fg31">-    CHECK(len == 65);</span>
<span class="term-fg31">-    &#47;* Multiple illegal args. Should still set arg error only once. *&#47;</span>
<span class="term-fg31">-    ecount = 0;</span>
<span class="term-fg31">-    ecount2 = 11;</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_parse(ctx, NULL, NULL, 65) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 1);</span>
<span class="term-fg31">-    &#47;* Does the illegal arg callback actually change the behavior? *&#47;</span>
<span class="term-fg31">-    secp256k1_context_set_illegal_callback(ctx, uncounting_illegal_callback_fn, &amp;ecount2);</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_parse(ctx, NULL, NULL, 65) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 1);</span>
<span class="term-fg31">-    CHECK(ecount2 == 10);</span>
<span class="term-fg31">-    secp256k1_context_set_illegal_callback(ctx, NULL, NULL);</span>
<span class="term-fg31">-    &#47;* Try a bunch of prefabbed points with all possible encodings. *&#47;</span>
<span class="term-fg31">-    for (i = 0; i &lt; SECP256K1_EC_PARSE_TEST_NVALID; i++) {</span>
<span class="term-fg31">-        ec_pubkey_parse_pointtest(valid[i], 1, 1);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    for (i = 0; i &lt; SECP256K1_EC_PARSE_TEST_NXVALID; i++) {</span>
<span class="term-fg31">-        ec_pubkey_parse_pointtest(onlyxvalid[i], 1, 0);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    for (i = 0; i &lt; SECP256K1_EC_PARSE_TEST_NINVALID; i++) {</span>
<span class="term-fg31">-        ec_pubkey_parse_pointtest(invalid[i], 0, 0);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void run_eckey_edge_case_test(void) {</span>
<span class="term-fg31">-    const unsigned char orderc[32] = {</span>
<span class="term-fg31">-        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xfe,</span>
<span class="term-fg31">-        0xba, 0xae, 0xdc, 0xe6, 0xaf, 0x48, 0xa0, 0x3b,</span>
<span class="term-fg31">-        0xbf, 0xd2, 0x5e, 0x8c, 0xd0, 0x36, 0x41, 0x41</span>
<span class="term-fg31">-    };</span>
<span class="term-fg31">-    const unsigned char zeros[sizeof(secp256k1_pubkey)] = {0x00};</span>
<span class="term-fg31">-    unsigned char ctmp[33];</span>
<span class="term-fg31">-    unsigned char ctmp2[33];</span>
<span class="term-fg31">-    secp256k1_pubkey pubkey;</span>
<span class="term-fg31">-    secp256k1_pubkey pubkey2;</span>
<span class="term-fg31">-    secp256k1_pubkey pubkey_one;</span>
<span class="term-fg31">-    secp256k1_pubkey pubkey_negone;</span>
<span class="term-fg31">-    const secp256k1_pubkey *pubkeys[3];</span>
<span class="term-fg31">-    size_t len;</span>
<span class="term-fg31">-    int32_t ecount;</span>
<span class="term-fg31">-    &#47;* Group order is too large, reject. *&#47;</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_seckey_verify(ctx, orderc) == 0);</span>
<span class="term-fg31">-    VG_UNDEF(&amp;pubkey, sizeof(pubkey));</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_create(ctx, &amp;pubkey, orderc) == 0);</span>
<span class="term-fg31">-    VG_CHECK(&amp;pubkey, sizeof(pubkey));</span>
<span class="term-fg31">-    CHECK(memcmp(&amp;pubkey, zeros, sizeof(secp256k1_pubkey)) == 0);</span>
<span class="term-fg31">-    &#47;* Maximum value is too large, reject. *&#47;</span>
<span class="term-fg31">-    memset(ctmp, 255, 32);</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_seckey_verify(ctx, ctmp) == 0);</span>
<span class="term-fg31">-    memset(&amp;pubkey, 1, sizeof(pubkey));</span>
<span class="term-fg31">-    VG_UNDEF(&amp;pubkey, sizeof(pubkey));</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_create(ctx, &amp;pubkey, ctmp) == 0);</span>
<span class="term-fg31">-    VG_CHECK(&amp;pubkey, sizeof(pubkey));</span>
<span class="term-fg31">-    CHECK(memcmp(&amp;pubkey, zeros, sizeof(secp256k1_pubkey)) == 0);</span>
<span class="term-fg31">-    &#47;* Zero is too small, reject. *&#47;</span>
<span class="term-fg31">-    memset(ctmp, 0, 32);</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_seckey_verify(ctx, ctmp) == 0);</span>
<span class="term-fg31">-    memset(&amp;pubkey, 1, sizeof(pubkey));</span>
<span class="term-fg31">-    VG_UNDEF(&amp;pubkey, sizeof(pubkey));</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_create(ctx, &amp;pubkey, ctmp) == 0);</span>
<span class="term-fg31">-    VG_CHECK(&amp;pubkey, sizeof(pubkey));</span>
<span class="term-fg31">-    CHECK(memcmp(&amp;pubkey, zeros, sizeof(secp256k1_pubkey)) == 0);</span>
<span class="term-fg31">-    &#47;* One must be accepted. *&#47;</span>
<span class="term-fg31">-    ctmp[31] = 0x01;</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_seckey_verify(ctx, ctmp) == 1);</span>
<span class="term-fg31">-    memset(&amp;pubkey, 0, sizeof(pubkey));</span>
<span class="term-fg31">-    VG_UNDEF(&amp;pubkey, sizeof(pubkey));</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_create(ctx, &amp;pubkey, ctmp) == 1);</span>
<span class="term-fg31">-    VG_CHECK(&amp;pubkey, sizeof(pubkey));</span>
<span class="term-fg31">-    CHECK(memcmp(&amp;pubkey, zeros, sizeof(secp256k1_pubkey)) &gt; 0);</span>
<span class="term-fg31">-    pubkey_one = pubkey;</span>
<span class="term-fg31">-    &#47;* Group order + 1 is too large, reject. *&#47;</span>
<span class="term-fg31">-    memcpy(ctmp, orderc, 32);</span>
<span class="term-fg31">-    ctmp[31] = 0x42;</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_seckey_verify(ctx, ctmp) == 0);</span>
<span class="term-fg31">-    memset(&amp;pubkey, 1, sizeof(pubkey));</span>
<span class="term-fg31">-    VG_UNDEF(&amp;pubkey, sizeof(pubkey));</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_create(ctx, &amp;pubkey, ctmp) == 0);</span>
<span class="term-fg31">-    VG_CHECK(&amp;pubkey, sizeof(pubkey));</span>
<span class="term-fg31">-    CHECK(memcmp(&amp;pubkey, zeros, sizeof(secp256k1_pubkey)) == 0);</span>
<span class="term-fg31">-    &#47;* -1 must be accepted. *&#47;</span>
<span class="term-fg31">-    ctmp[31] = 0x40;</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_seckey_verify(ctx, ctmp) == 1);</span>
<span class="term-fg31">-    memset(&amp;pubkey, 0, sizeof(pubkey));</span>
<span class="term-fg31">-    VG_UNDEF(&amp;pubkey, sizeof(pubkey));</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_create(ctx, &amp;pubkey, ctmp) == 1);</span>
<span class="term-fg31">-    VG_CHECK(&amp;pubkey, sizeof(pubkey));</span>
<span class="term-fg31">-    CHECK(memcmp(&amp;pubkey, zeros, sizeof(secp256k1_pubkey)) &gt; 0);</span>
<span class="term-fg31">-    pubkey_negone = pubkey;</span>
<span class="term-fg31">-    &#47;* Tweak of zero leaves the value changed. *&#47;</span>
<span class="term-fg31">-    memset(ctmp2, 0, 32);</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_privkey_tweak_add(ctx, ctmp, ctmp2) == 1);</span>
<span class="term-fg31">-    CHECK(memcmp(orderc, ctmp, 31) == 0 &amp;&amp; ctmp[31] == 0x40);</span>
<span class="term-fg31">-    memcpy(&amp;pubkey2, &amp;pubkey, sizeof(pubkey));</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_tweak_add(ctx, &amp;pubkey, ctmp2) == 1);</span>
<span class="term-fg31">-    CHECK(memcmp(&amp;pubkey, &amp;pubkey2, sizeof(pubkey)) == 0);</span>
<span class="term-fg31">-    &#47;* Multiply tweak of zero zeroizes the output. *&#47;</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_privkey_tweak_mul(ctx, ctmp, ctmp2) == 0);</span>
<span class="term-fg31">-    CHECK(memcmp(zeros, ctmp, 32) == 0);</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_tweak_mul(ctx, &amp;pubkey, ctmp2) == 0);</span>
<span class="term-fg31">-    CHECK(memcmp(&amp;pubkey, zeros, sizeof(pubkey)) == 0);</span>
<span class="term-fg31">-    memcpy(&amp;pubkey, &amp;pubkey2, sizeof(pubkey));</span>
<span class="term-fg31">-    &#47;* Overflowing key tweak zeroizes. *&#47;</span>
<span class="term-fg31">-    memcpy(ctmp, orderc, 32);</span>
<span class="term-fg31">-    ctmp[31] = 0x40;</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_privkey_tweak_add(ctx, ctmp, orderc) == 0);</span>
<span class="term-fg31">-    CHECK(memcmp(zeros, ctmp, 32) == 0);</span>
<span class="term-fg31">-    memcpy(ctmp, orderc, 32);</span>
<span class="term-fg31">-    ctmp[31] = 0x40;</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_privkey_tweak_mul(ctx, ctmp, orderc) == 0);</span>
<span class="term-fg31">-    CHECK(memcmp(zeros, ctmp, 32) == 0);</span>
<span class="term-fg31">-    memcpy(ctmp, orderc, 32);</span>
<span class="term-fg31">-    ctmp[31] = 0x40;</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_tweak_add(ctx, &amp;pubkey, orderc) == 0);</span>
<span class="term-fg31">-    CHECK(memcmp(&amp;pubkey, zeros, sizeof(pubkey)) == 0);</span>
<span class="term-fg31">-    memcpy(&amp;pubkey, &amp;pubkey2, sizeof(pubkey));</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_tweak_mul(ctx, &amp;pubkey, orderc) == 0);</span>
<span class="term-fg31">-    CHECK(memcmp(&amp;pubkey, zeros, sizeof(pubkey)) == 0);</span>
<span class="term-fg31">-    memcpy(&amp;pubkey, &amp;pubkey2, sizeof(pubkey));</span>
<span class="term-fg31">-    &#47;* Private key tweaks results in a key of zero. *&#47;</span>
<span class="term-fg31">-    ctmp2[31] = 1;</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_privkey_tweak_add(ctx, ctmp2, ctmp) == 0);</span>
<span class="term-fg31">-    CHECK(memcmp(zeros, ctmp2, 32) == 0);</span>
<span class="term-fg31">-    ctmp2[31] = 1;</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_tweak_add(ctx, &amp;pubkey, ctmp2) == 0);</span>
<span class="term-fg31">-    CHECK(memcmp(&amp;pubkey, zeros, sizeof(pubkey)) == 0);</span>
<span class="term-fg31">-    memcpy(&amp;pubkey, &amp;pubkey2, sizeof(pubkey));</span>
<span class="term-fg31">-    &#47;* Tweak computation wraps and results in a key of 1. *&#47;</span>
<span class="term-fg31">-    ctmp2[31] = 2;</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_privkey_tweak_add(ctx, ctmp2, ctmp) == 1);</span>
<span class="term-fg31">-    CHECK(memcmp(ctmp2, zeros, 31) == 0 &amp;&amp; ctmp2[31] == 1);</span>
<span class="term-fg31">-    ctmp2[31] = 2;</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_tweak_add(ctx, &amp;pubkey, ctmp2) == 1);</span>
<span class="term-fg31">-    ctmp2[31] = 1;</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_create(ctx, &amp;pubkey2, ctmp2) == 1);</span>
<span class="term-fg31">-    CHECK(memcmp(&amp;pubkey, &amp;pubkey2, sizeof(pubkey)) == 0);</span>
<span class="term-fg31">-    &#47;* Tweak mul * 2 = 1+1. *&#47;</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_tweak_add(ctx, &amp;pubkey, ctmp2) == 1);</span>
<span class="term-fg31">-    ctmp2[31] = 2;</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_tweak_mul(ctx, &amp;pubkey2, ctmp2) == 1);</span>
<span class="term-fg31">-    CHECK(memcmp(&amp;pubkey, &amp;pubkey2, sizeof(pubkey)) == 0);</span>
<span class="term-fg31">-    &#47;* Test argument errors. *&#47;</span>
<span class="term-fg31">-    ecount = 0;</span>
<span class="term-fg31">-    secp256k1_context_set_illegal_callback(ctx, counting_illegal_callback_fn, &amp;ecount);</span>
<span class="term-fg31">-    CHECK(ecount == 0);</span>
<span class="term-fg31">-    &#47;* Zeroize pubkey on parse error. *&#47;</span>
<span class="term-fg31">-    memset(&amp;pubkey, 0, 32);</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_tweak_add(ctx, &amp;pubkey, ctmp2) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 1);</span>
<span class="term-fg31">-    CHECK(memcmp(&amp;pubkey, zeros, sizeof(pubkey)) == 0);</span>
<span class="term-fg31">-    memcpy(&amp;pubkey, &amp;pubkey2, sizeof(pubkey));</span>
<span class="term-fg31">-    memset(&amp;pubkey2, 0, 32);</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_tweak_mul(ctx, &amp;pubkey2, ctmp2) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 2);</span>
<span class="term-fg31">-    CHECK(memcmp(&amp;pubkey2, zeros, sizeof(pubkey2)) == 0);</span>
<span class="term-fg31">-    &#47;* Plain argument errors. *&#47;</span>
<span class="term-fg31">-    ecount = 0;</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_seckey_verify(ctx, ctmp) == 1);</span>
<span class="term-fg31">-    CHECK(ecount == 0);</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_seckey_verify(ctx, NULL) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 1);</span>
<span class="term-fg31">-    ecount = 0;</span>
<span class="term-fg31">-    memset(ctmp2, 0, 32);</span>
<span class="term-fg31">-    ctmp2[31] = 4;</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_tweak_add(ctx, NULL, ctmp2) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 1);</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_tweak_add(ctx, &amp;pubkey, NULL) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 2);</span>
<span class="term-fg31">-    ecount = 0;</span>
<span class="term-fg31">-    memset(ctmp2, 0, 32);</span>
<span class="term-fg31">-    ctmp2[31] = 4;</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_tweak_mul(ctx, NULL, ctmp2) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 1);</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_tweak_mul(ctx, &amp;pubkey, NULL) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 2);</span>
<span class="term-fg31">-    ecount = 0;</span>
<span class="term-fg31">-    memset(ctmp2, 0, 32);</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_privkey_tweak_add(ctx, NULL, ctmp2) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 1);</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_privkey_tweak_add(ctx, ctmp, NULL) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 2);</span>
<span class="term-fg31">-    ecount = 0;</span>
<span class="term-fg31">-    memset(ctmp2, 0, 32);</span>
<span class="term-fg31">-    ctmp2[31] = 1;</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_privkey_tweak_mul(ctx, NULL, ctmp2) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 1);</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_privkey_tweak_mul(ctx, ctmp, NULL) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 2);</span>
<span class="term-fg31">-    ecount = 0;</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_create(ctx, NULL, ctmp) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 1);</span>
<span class="term-fg31">-    memset(&amp;pubkey, 1, sizeof(pubkey));</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_create(ctx, &amp;pubkey, NULL) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 2);</span>
<span class="term-fg31">-    CHECK(memcmp(&amp;pubkey, zeros, sizeof(secp256k1_pubkey)) == 0);</span>
<span class="term-fg31">-    &#47;* secp256k1_ec_pubkey_combine tests. *&#47;</span>
<span class="term-fg31">-    ecount = 0;</span>
<span class="term-fg31">-    pubkeys[0] = &amp;pubkey_one;</span>
<span class="term-fg31">-    VG_UNDEF(&amp;pubkeys[0], sizeof(secp256k1_pubkey *));</span>
<span class="term-fg31">-    VG_UNDEF(&amp;pubkeys[1], sizeof(secp256k1_pubkey *));</span>
<span class="term-fg31">-    VG_UNDEF(&amp;pubkeys[2], sizeof(secp256k1_pubkey *));</span>
<span class="term-fg31">-    memset(&amp;pubkey, 255, sizeof(secp256k1_pubkey));</span>
<span class="term-fg31">-    VG_UNDEF(&amp;pubkey, sizeof(secp256k1_pubkey));</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_combine(ctx, &amp;pubkey, pubkeys, 0) == 0);</span>
<span class="term-fg31">-    VG_CHECK(&amp;pubkey, sizeof(secp256k1_pubkey));</span>
<span class="term-fg31">-    CHECK(memcmp(&amp;pubkey, zeros, sizeof(secp256k1_pubkey)) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 1);</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_combine(ctx, NULL, pubkeys, 1) == 0);</span>
<span class="term-fg31">-    CHECK(memcmp(&amp;pubkey, zeros, sizeof(secp256k1_pubkey)) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 2);</span>
<span class="term-fg31">-    memset(&amp;pubkey, 255, sizeof(secp256k1_pubkey));</span>
<span class="term-fg31">-    VG_UNDEF(&amp;pubkey, sizeof(secp256k1_pubkey));</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_combine(ctx, &amp;pubkey, NULL, 1) == 0);</span>
<span class="term-fg31">-    VG_CHECK(&amp;pubkey, sizeof(secp256k1_pubkey));</span>
<span class="term-fg31">-    CHECK(memcmp(&amp;pubkey, zeros, sizeof(secp256k1_pubkey)) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 3);</span>
<span class="term-fg31">-    pubkeys[0] = &amp;pubkey_negone;</span>
<span class="term-fg31">-    memset(&amp;pubkey, 255, sizeof(secp256k1_pubkey));</span>
<span class="term-fg31">-    VG_UNDEF(&amp;pubkey, sizeof(secp256k1_pubkey));</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_combine(ctx, &amp;pubkey, pubkeys, 1) == 1);</span>
<span class="term-fg31">-    VG_CHECK(&amp;pubkey, sizeof(secp256k1_pubkey));</span>
<span class="term-fg31">-    CHECK(memcmp(&amp;pubkey, zeros, sizeof(secp256k1_pubkey)) &gt; 0);</span>
<span class="term-fg31">-    CHECK(ecount == 3);</span>
<span class="term-fg31">-    len = 33;</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_serialize(ctx, ctmp, &amp;len, &amp;pubkey, SECP256K1_EC_COMPRESSED) == 1);</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_serialize(ctx, ctmp2, &amp;len, &amp;pubkey_negone, SECP256K1_EC_COMPRESSED) == 1);</span>
<span class="term-fg31">-    CHECK(memcmp(ctmp, ctmp2, 33) == 0);</span>
<span class="term-fg31">-    &#47;* Result is infinity. *&#47;</span>
<span class="term-fg31">-    pubkeys[0] = &amp;pubkey_one;</span>
<span class="term-fg31">-    pubkeys[1] = &amp;pubkey_negone;</span>
<span class="term-fg31">-    memset(&amp;pubkey, 255, sizeof(secp256k1_pubkey));</span>
<span class="term-fg31">-    VG_UNDEF(&amp;pubkey, sizeof(secp256k1_pubkey));</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_combine(ctx, &amp;pubkey, pubkeys, 2) == 0);</span>
<span class="term-fg31">-    VG_CHECK(&amp;pubkey, sizeof(secp256k1_pubkey));</span>
<span class="term-fg31">-    CHECK(memcmp(&amp;pubkey, zeros, sizeof(secp256k1_pubkey)) == 0);</span>
<span class="term-fg31">-    CHECK(ecount == 3);</span>
<span class="term-fg31">-    &#47;* Passes through infinity but comes out one. *&#47;</span>
<span class="term-fg31">-    pubkeys[2] = &amp;pubkey_one;</span>
<span class="term-fg31">-    memset(&amp;pubkey, 255, sizeof(secp256k1_pubkey));</span>
<span class="term-fg31">-    VG_UNDEF(&amp;pubkey, sizeof(secp256k1_pubkey));</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_combine(ctx, &amp;pubkey, pubkeys, 3) == 1);</span>
<span class="term-fg31">-    VG_CHECK(&amp;pubkey, sizeof(secp256k1_pubkey));</span>
<span class="term-fg31">-    CHECK(memcmp(&amp;pubkey, zeros, sizeof(secp256k1_pubkey)) &gt; 0);</span>
<span class="term-fg31">-    CHECK(ecount == 3);</span>
<span class="term-fg31">-    len = 33;</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_serialize(ctx, ctmp, &amp;len, &amp;pubkey, SECP256K1_EC_COMPRESSED) == 1);</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_serialize(ctx, ctmp2, &amp;len, &amp;pubkey_one, SECP256K1_EC_COMPRESSED) == 1);</span>
<span class="term-fg31">-    CHECK(memcmp(ctmp, ctmp2, 33) == 0);</span>
<span class="term-fg31">-    &#47;* Adds to two. *&#47;</span>
<span class="term-fg31">-    pubkeys[1] = &amp;pubkey_one;</span>
<span class="term-fg31">-    memset(&amp;pubkey, 255, sizeof(secp256k1_pubkey));</span>
<span class="term-fg31">-    VG_UNDEF(&amp;pubkey, sizeof(secp256k1_pubkey));</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_combine(ctx, &amp;pubkey, pubkeys, 2) == 1);</span>
<span class="term-fg31">-    VG_CHECK(&amp;pubkey, sizeof(secp256k1_pubkey));</span>
<span class="term-fg31">-    CHECK(memcmp(&amp;pubkey, zeros, sizeof(secp256k1_pubkey)) &gt; 0);</span>
<span class="term-fg31">-    CHECK(ecount == 3);</span>
<span class="term-fg31">-    secp256k1_context_set_illegal_callback(ctx, NULL, NULL);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void random_sign(secp256k1_scalar *sigr, secp256k1_scalar *sigs, const secp256k1_scalar *key, const secp256k1_scalar *msg, int *recid) {</span>
<span class="term-fg31">-    secp256k1_scalar nonce;</span>
<span class="term-fg31">-    do {</span>
<span class="term-fg31">-        random_scalar_order_test(&amp;nonce);</span>
<span class="term-fg31">-    } while(!secp256k1_ecdsa_sig_sign(&amp;ctx-&gt;ecmult_gen_ctx, sigr, sigs, key, msg, &amp;nonce, recid));</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void test_ecdsa_sign_verify(void) {</span>
<span class="term-fg31">-    secp256k1_gej pubj;</span>
<span class="term-fg31">-    secp256k1_ge pub;</span>
<span class="term-fg31">-    secp256k1_scalar one;</span>
<span class="term-fg31">-    secp256k1_scalar msg, key;</span>
<span class="term-fg31">-    secp256k1_scalar sigr, sigs;</span>
<span class="term-fg31">-    int recid;</span>
<span class="term-fg31">-    int getrec;</span>
<span class="term-fg31">-    random_scalar_order_test(&amp;msg);</span>
<span class="term-fg31">-    random_scalar_order_test(&amp;key);</span>
<span class="term-fg31">-    secp256k1_ecmult_gen(&amp;ctx-&gt;ecmult_gen_ctx, &amp;pubj, &amp;key);</span>
<span class="term-fg31">-    secp256k1_ge_set_gej(&amp;pub, &amp;pubj);</span>
<span class="term-fg31">-    getrec = secp256k1_rand_bits(1);</span>
<span class="term-fg31">-    random_sign(&amp;sigr, &amp;sigs, &amp;key, &amp;msg, getrec?&amp;recid:NULL);</span>
<span class="term-fg31">-    if (getrec) {</span>
<span class="term-fg31">-        CHECK(recid &gt;= 0 &amp;&amp; recid &lt; 4);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_sig_verify(&amp;ctx-&gt;ecmult_ctx, &amp;sigr, &amp;sigs, &amp;pub, &amp;msg));</span>
<span class="term-fg31">-    secp256k1_scalar_set_int(&amp;one, 1);</span>
<span class="term-fg31">-    secp256k1_scalar_add(&amp;msg, &amp;msg, &amp;one);</span>
<span class="term-fg31">-    CHECK(!secp256k1_ecdsa_sig_verify(&amp;ctx-&gt;ecmult_ctx, &amp;sigr, &amp;sigs, &amp;pub, &amp;msg));</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void run_ecdsa_sign_verify(void) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 10*count; i++) {</span>
<span class="term-fg31">-        test_ecdsa_sign_verify();</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** Dummy nonce generation function that just uses a precomputed nonce, and fails if it is not accepted. Use only for testing. *&#47;</span>
<span class="term-fg31">-static int precomputed_nonce_function(unsigned char *nonce32, const unsigned char *msg32, const unsigned char *key32, const unsigned char *algo16, void *data, unsigned int counter) {</span>
<span class="term-fg31">-    (void)msg32;</span>
<span class="term-fg31">-    (void)key32;</span>
<span class="term-fg31">-    (void)algo16;</span>
<span class="term-fg31">-    memcpy(nonce32, data, 32);</span>
<span class="term-fg31">-    return (counter == 0);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int nonce_function_test_fail(unsigned char *nonce32, const unsigned char *msg32, const unsigned char *key32, const unsigned char *algo16, void *data, unsigned int counter) {</span>
<span class="term-fg31">-   &#47;* Dummy nonce generator that has a fatal error on the first counter value. *&#47;</span>
<span class="term-fg31">-   if (counter == 0) {</span>
<span class="term-fg31">-       return 0;</span>
<span class="term-fg31">-   }</span>
<span class="term-fg31">-   return nonce_function_rfc6979(nonce32, msg32, key32, algo16, data, counter - 1);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static int nonce_function_test_retry(unsigned char *nonce32, const unsigned char *msg32, const unsigned char *key32, const unsigned char *algo16, void *data, unsigned int counter) {</span>
<span class="term-fg31">-   &#47;* Dummy nonce generator that produces unacceptable nonces for the first several counter values. *&#47;</span>
<span class="term-fg31">-   if (counter &lt; 3) {</span>
<span class="term-fg31">-       memset(nonce32, counter==0 ? 0 : 255, 32);</span>
<span class="term-fg31">-       if (counter == 2) {</span>
<span class="term-fg31">-           nonce32[31]--;</span>
<span class="term-fg31">-       }</span>
<span class="term-fg31">-       return 1;</span>
<span class="term-fg31">-   }</span>
<span class="term-fg31">-   if (counter &lt; 5) {</span>
<span class="term-fg31">-       static const unsigned char order[] = {</span>
<span class="term-fg31">-           0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,</span>
<span class="term-fg31">-           0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFE,</span>
<span class="term-fg31">-           0xBA,0xAE,0xDC,0xE6,0xAF,0x48,0xA0,0x3B,</span>
<span class="term-fg31">-           0xBF,0xD2,0x5E,0x8C,0xD0,0x36,0x41,0x41</span>
<span class="term-fg31">-       };</span>
<span class="term-fg31">-       memcpy(nonce32, order, 32);</span>
<span class="term-fg31">-       if (counter == 4) {</span>
<span class="term-fg31">-           nonce32[31]++;</span>
<span class="term-fg31">-       }</span>
<span class="term-fg31">-       return 1;</span>
<span class="term-fg31">-   }</span>
<span class="term-fg31">-   &#47;* Retry rate of 6979 is negligible esp. as we only call this in deterministic tests. *&#47;</span>
<span class="term-fg31">-   &#47;* If someone does fine a case where it retries for secp256k1, we&#39;d like to know. *&#47;</span>
<span class="term-fg31">-   if (counter &gt; 5) {</span>
<span class="term-fg31">-       return 0;</span>
<span class="term-fg31">-   }</span>
<span class="term-fg31">-   return nonce_function_rfc6979(nonce32, msg32, key32, algo16, data, counter - 5);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-int is_empty_signature(const secp256k1_ecdsa_signature *sig) {</span>
<span class="term-fg31">-    static const unsigned char res[sizeof(secp256k1_ecdsa_signature)] = {0};</span>
<span class="term-fg31">-    return memcmp(sig, res, sizeof(secp256k1_ecdsa_signature)) == 0;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void test_ecdsa_end_to_end(void) {</span>
<span class="term-fg31">-    unsigned char extra[32] = {0x00};</span>
<span class="term-fg31">-    unsigned char privkey[32];</span>
<span class="term-fg31">-    unsigned char message[32];</span>
<span class="term-fg31">-    unsigned char privkey2[32];</span>
<span class="term-fg31">-    secp256k1_ecdsa_signature signature[6];</span>
<span class="term-fg31">-    secp256k1_scalar r, s;</span>
<span class="term-fg31">-    unsigned char sig[74];</span>
<span class="term-fg31">-    size_t siglen = 74;</span>
<span class="term-fg31">-    unsigned char pubkeyc[65];</span>
<span class="term-fg31">-    size_t pubkeyclen = 65;</span>
<span class="term-fg31">-    secp256k1_pubkey pubkey;</span>
<span class="term-fg31">-    unsigned char seckey[300];</span>
<span class="term-fg31">-    size_t seckeylen = 300;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Generate a random key and message. *&#47;</span>
<span class="term-fg31">-    {</span>
<span class="term-fg31">-        secp256k1_scalar msg, key;</span>
<span class="term-fg31">-        random_scalar_order_test(&amp;msg);</span>
<span class="term-fg31">-        random_scalar_order_test(&amp;key);</span>
<span class="term-fg31">-        secp256k1_scalar_get_b32(privkey, &amp;key);</span>
<span class="term-fg31">-        secp256k1_scalar_get_b32(message, &amp;msg);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Construct and verify corresponding public key. *&#47;</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_seckey_verify(ctx, privkey) == 1);</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_create(ctx, &amp;pubkey, privkey) == 1);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Verify exporting and importing public key. *&#47;</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_serialize(ctx, pubkeyc, &amp;pubkeyclen, &amp;pubkey, secp256k1_rand_bits(1) == 1 ? SECP256K1_EC_COMPRESSED : SECP256K1_EC_UNCOMPRESSED));</span>
<span class="term-fg31">-    memset(&amp;pubkey, 0, sizeof(pubkey));</span>
<span class="term-fg31">-    CHECK(secp256k1_ec_pubkey_parse(ctx, &amp;pubkey, pubkeyc, pubkeyclen) == 1);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Verify private key import and export. *&#47;</span>
<span class="term-fg31">-    CHECK(ec_privkey_export_der(ctx, seckey, &amp;seckeylen, privkey, secp256k1_rand_bits(1) == 1));</span>
<span class="term-fg31">-    CHECK(ec_privkey_import_der(ctx, privkey2, seckey, seckeylen) == 1);</span>
<span class="term-fg31">-    CHECK(memcmp(privkey, privkey2, 32) == 0);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Optionally tweak the keys using addition. *&#47;</span>
<span class="term-fg31">-    if (secp256k1_rand_int(3) == 0) {</span>
<span class="term-fg31">-        int ret1;</span>
<span class="term-fg31">-        int ret2;</span>
<span class="term-fg31">-        unsigned char rnd[32];</span>
<span class="term-fg31">-        secp256k1_pubkey pubkey2;</span>
<span class="term-fg31">-        secp256k1_rand256_test(rnd);</span>
<span class="term-fg31">-        ret1 = secp256k1_ec_privkey_tweak_add(ctx, privkey, rnd);</span>
<span class="term-fg31">-        ret2 = secp256k1_ec_pubkey_tweak_add(ctx, &amp;pubkey, rnd);</span>
<span class="term-fg31">-        CHECK(ret1 == ret2);</span>
<span class="term-fg31">-        if (ret1 == 0) {</span>
<span class="term-fg31">-            return;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        CHECK(secp256k1_ec_pubkey_create(ctx, &amp;pubkey2, privkey) == 1);</span>
<span class="term-fg31">-        CHECK(memcmp(&amp;pubkey, &amp;pubkey2, sizeof(pubkey)) == 0);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Optionally tweak the keys using multiplication. *&#47;</span>
<span class="term-fg31">-    if (secp256k1_rand_int(3) == 0) {</span>
<span class="term-fg31">-        int ret1;</span>
<span class="term-fg31">-        int ret2;</span>
<span class="term-fg31">-        unsigned char rnd[32];</span>
<span class="term-fg31">-        secp256k1_pubkey pubkey2;</span>
<span class="term-fg31">-        secp256k1_rand256_test(rnd);</span>
<span class="term-fg31">-        ret1 = secp256k1_ec_privkey_tweak_mul(ctx, privkey, rnd);</span>
<span class="term-fg31">-        ret2 = secp256k1_ec_pubkey_tweak_mul(ctx, &amp;pubkey, rnd);</span>
<span class="term-fg31">-        CHECK(ret1 == ret2);</span>
<span class="term-fg31">-        if (ret1 == 0) {</span>
<span class="term-fg31">-            return;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        CHECK(secp256k1_ec_pubkey_create(ctx, &amp;pubkey2, privkey) == 1);</span>
<span class="term-fg31">-        CHECK(memcmp(&amp;pubkey, &amp;pubkey2, sizeof(pubkey)) == 0);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Sign. *&#47;</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_sign(ctx, &amp;signature[0], message, privkey, NULL, NULL) == 1);</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_sign(ctx, &amp;signature[4], message, privkey, NULL, NULL) == 1);</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_sign(ctx, &amp;signature[1], message, privkey, NULL, extra) == 1);</span>
<span class="term-fg31">-    extra[31] = 1;</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_sign(ctx, &amp;signature[2], message, privkey, NULL, extra) == 1);</span>
<span class="term-fg31">-    extra[31] = 0;</span>
<span class="term-fg31">-    extra[0] = 1;</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_sign(ctx, &amp;signature[3], message, privkey, NULL, extra) == 1);</span>
<span class="term-fg31">-    CHECK(memcmp(&amp;signature[0], &amp;signature[4], sizeof(signature[0])) == 0);</span>
<span class="term-fg31">-    CHECK(memcmp(&amp;signature[0], &amp;signature[1], sizeof(signature[0])) != 0);</span>
<span class="term-fg31">-    CHECK(memcmp(&amp;signature[0], &amp;signature[2], sizeof(signature[0])) != 0);</span>
<span class="term-fg31">-    CHECK(memcmp(&amp;signature[0], &amp;signature[3], sizeof(signature[0])) != 0);</span>
<span class="term-fg31">-    CHECK(memcmp(&amp;signature[1], &amp;signature[2], sizeof(signature[0])) != 0);</span>
<span class="term-fg31">-    CHECK(memcmp(&amp;signature[1], &amp;signature[3], sizeof(signature[0])) != 0);</span>
<span class="term-fg31">-    CHECK(memcmp(&amp;signature[2], &amp;signature[3], sizeof(signature[0])) != 0);</span>
<span class="term-fg31">-    &#47;* Verify. *&#47;</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_verify(ctx, &amp;signature[0], message, &amp;pubkey) == 1);</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_verify(ctx, &amp;signature[1], message, &amp;pubkey) == 1);</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_verify(ctx, &amp;signature[2], message, &amp;pubkey) == 1);</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_verify(ctx, &amp;signature[3], message, &amp;pubkey) == 1);</span>
<span class="term-fg31">-    &#47;* Test lower-S form, malleate, verify and fail, test again, malleate again *&#47;</span>
<span class="term-fg31">-    CHECK(!secp256k1_ecdsa_signature_normalize(ctx, NULL, &amp;signature[0]));</span>
<span class="term-fg31">-    secp256k1_ecdsa_signature_load(ctx, &amp;r, &amp;s, &amp;signature[0]);</span>
<span class="term-fg31">-    secp256k1_scalar_negate(&amp;s, &amp;s);</span>
<span class="term-fg31">-    secp256k1_ecdsa_signature_save(&amp;signature[5], &amp;r, &amp;s);</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_verify(ctx, &amp;signature[5], message, &amp;pubkey) == 0);</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_signature_normalize(ctx, NULL, &amp;signature[5]));</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_signature_normalize(ctx, &amp;signature[5], &amp;signature[5]));</span>
<span class="term-fg31">-    CHECK(!secp256k1_ecdsa_signature_normalize(ctx, NULL, &amp;signature[5]));</span>
<span class="term-fg31">-    CHECK(!secp256k1_ecdsa_signature_normalize(ctx, &amp;signature[5], &amp;signature[5]));</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_verify(ctx, &amp;signature[5], message, &amp;pubkey) == 1);</span>
<span class="term-fg31">-    secp256k1_scalar_negate(&amp;s, &amp;s);</span>
<span class="term-fg31">-    secp256k1_ecdsa_signature_save(&amp;signature[5], &amp;r, &amp;s);</span>
<span class="term-fg31">-    CHECK(!secp256k1_ecdsa_signature_normalize(ctx, NULL, &amp;signature[5]));</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_verify(ctx, &amp;signature[5], message, &amp;pubkey) == 1);</span>
<span class="term-fg31">-    CHECK(memcmp(&amp;signature[5], &amp;signature[0], 64) == 0);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Serialize&#47;parse DER and verify again *&#47;</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_signature_serialize_der(ctx, sig, &amp;siglen, &amp;signature[0]) == 1);</span>
<span class="term-fg31">-    memset(&amp;signature[0], 0, sizeof(signature[0]));</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_signature_parse_der(ctx, &amp;signature[0], sig, siglen) == 1);</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_verify(ctx, &amp;signature[0], message, &amp;pubkey) == 1);</span>
<span class="term-fg31">-    &#47;* Serialize&#47;destroy&#47;parse DER and verify again. *&#47;</span>
<span class="term-fg31">-    siglen = 74;</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_signature_serialize_der(ctx, sig, &amp;siglen, &amp;signature[0]) == 1);</span>
<span class="term-fg31">-    sig[secp256k1_rand_int(siglen)] += 1 + secp256k1_rand_int(255);</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_signature_parse_der(ctx, &amp;signature[0], sig, siglen) == 0 ||</span>
<span class="term-fg31">-          secp256k1_ecdsa_verify(ctx, &amp;signature[0], message, &amp;pubkey) == 0);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void test_random_pubkeys(void) {</span>
<span class="term-fg31">-    secp256k1_ge elem;</span>
<span class="term-fg31">-    secp256k1_ge elem2;</span>
<span class="term-fg31">-    unsigned char in[65];</span>
<span class="term-fg31">-    &#47;* Generate some randomly sized pubkeys. *&#47;</span>
<span class="term-fg31">-    size_t len = secp256k1_rand_bits(2) == 0 ? 65 : 33;</span>
<span class="term-fg31">-    if (secp256k1_rand_bits(2) == 0) {</span>
<span class="term-fg31">-        len = secp256k1_rand_bits(6);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    if (len == 65) {</span>
<span class="term-fg31">-      in[0] = secp256k1_rand_bits(1) ? 4 : (secp256k1_rand_bits(1) ? 6 : 7);</span>
<span class="term-fg31">-    } else {</span>
<span class="term-fg31">-      in[0] = secp256k1_rand_bits(1) ? 2 : 3;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    if (secp256k1_rand_bits(3) == 0) {</span>
<span class="term-fg31">-        in[0] = secp256k1_rand_bits(8);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    if (len &gt; 1) {</span>
<span class="term-fg31">-        secp256k1_rand256(&amp;in[1]);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    if (len &gt; 33) {</span>
<span class="term-fg31">-        secp256k1_rand256(&amp;in[33]);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    if (secp256k1_eckey_pubkey_parse(&amp;elem, in, len)) {</span>
<span class="term-fg31">-        unsigned char out[65];</span>
<span class="term-fg31">-        unsigned char firstb;</span>
<span class="term-fg31">-        int res;</span>
<span class="term-fg31">-        size_t size = len;</span>
<span class="term-fg31">-        firstb = in[0];</span>
<span class="term-fg31">-        &#47;* If the pubkey can be parsed, it should round-trip... *&#47;</span>
<span class="term-fg31">-        CHECK(secp256k1_eckey_pubkey_serialize(&amp;elem, out, &amp;size, len == 33));</span>
<span class="term-fg31">-        CHECK(size == len);</span>
<span class="term-fg31">-        CHECK(memcmp(&amp;in[1], &amp;out[1], len-1) == 0);</span>
<span class="term-fg31">-        &#47;* ... except for the type of hybrid inputs. *&#47;</span>
<span class="term-fg31">-        if ((in[0] != 6) &amp;&amp; (in[0] != 7)) {</span>
<span class="term-fg31">-            CHECK(in[0] == out[0]);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        size = 65;</span>
<span class="term-fg31">-        CHECK(secp256k1_eckey_pubkey_serialize(&amp;elem, in, &amp;size, 0));</span>
<span class="term-fg31">-        CHECK(size == 65);</span>
<span class="term-fg31">-        CHECK(secp256k1_eckey_pubkey_parse(&amp;elem2, in, size));</span>
<span class="term-fg31">-        ge_equals_ge(&amp;elem,&amp;elem2);</span>
<span class="term-fg31">-        &#47;* Check that the X9.62 hybrid type is checked. *&#47;</span>
<span class="term-fg31">-        in[0] = secp256k1_rand_bits(1) ? 6 : 7;</span>
<span class="term-fg31">-        res = secp256k1_eckey_pubkey_parse(&amp;elem2, in, size);</span>
<span class="term-fg31">-        if (firstb == 2 || firstb == 3) {</span>
<span class="term-fg31">-            if (in[0] == firstb + 4) {</span>
<span class="term-fg31">-              CHECK(res);</span>
<span class="term-fg31">-            } else {</span>
<span class="term-fg31">-              CHECK(!res);</span>
<span class="term-fg31">-            }</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        if (res) {</span>
<span class="term-fg31">-            ge_equals_ge(&amp;elem,&amp;elem2);</span>
<span class="term-fg31">-            CHECK(secp256k1_eckey_pubkey_serialize(&amp;elem, out, &amp;size, 0));</span>
<span class="term-fg31">-            CHECK(memcmp(&amp;in[1], &amp;out[1], 64) == 0);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void run_random_pubkeys(void) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 10*count; i++) {</span>
<span class="term-fg31">-        test_random_pubkeys();</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void run_ecdsa_end_to_end(void) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 64*count; i++) {</span>
<span class="term-fg31">-        test_ecdsa_end_to_end();</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-int test_ecdsa_der_parse(const unsigned char *sig, size_t siglen, int certainly_der, int certainly_not_der) {</span>
<span class="term-fg31">-    static const unsigned char zeroes[32] = {0};</span>
<span class="term-fg31">-#ifdef ENABLE_OPENSSL_TESTS</span>
<span class="term-fg31">-    static const unsigned char max_scalar[32] = {</span>
<span class="term-fg31">-        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xfe,</span>
<span class="term-fg31">-        0xba, 0xae, 0xdc, 0xe6, 0xaf, 0x48, 0xa0, 0x3b,</span>
<span class="term-fg31">-        0xbf, 0xd2, 0x5e, 0x8c, 0xd0, 0x36, 0x41, 0x40</span>
<span class="term-fg31">-    };</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    int ret = 0;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_ecdsa_signature sig_der;</span>
<span class="term-fg31">-    unsigned char roundtrip_der[2048];</span>
<span class="term-fg31">-    unsigned char compact_der[64];</span>
<span class="term-fg31">-    size_t len_der = 2048;</span>
<span class="term-fg31">-    int parsed_der = 0, valid_der = 0, roundtrips_der = 0;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_ecdsa_signature sig_der_lax;</span>
<span class="term-fg31">-    unsigned char roundtrip_der_lax[2048];</span>
<span class="term-fg31">-    unsigned char compact_der_lax[64];</span>
<span class="term-fg31">-    size_t len_der_lax = 2048;</span>
<span class="term-fg31">-    int parsed_der_lax = 0, valid_der_lax = 0, roundtrips_der_lax = 0;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef ENABLE_OPENSSL_TESTS</span>
<span class="term-fg31">-    ECDSA_SIG *sig_openssl;</span>
<span class="term-fg31">-    const unsigned char *sigptr;</span>
<span class="term-fg31">-    unsigned char roundtrip_openssl[2048];</span>
<span class="term-fg31">-    int len_openssl = 2048;</span>
<span class="term-fg31">-    int parsed_openssl, valid_openssl = 0, roundtrips_openssl = 0;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    parsed_der = secp256k1_ecdsa_signature_parse_der(ctx, &amp;sig_der, sig, siglen);</span>
<span class="term-fg31">-    if (parsed_der) {</span>
<span class="term-fg31">-        ret |= (!secp256k1_ecdsa_signature_serialize_compact(ctx, compact_der, &amp;sig_der)) &lt;&lt; 0;</span>
<span class="term-fg31">-        valid_der = (memcmp(compact_der, zeroes, 32) != 0) &amp;&amp; (memcmp(compact_der + 32, zeroes, 32) != 0);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    if (valid_der) {</span>
<span class="term-fg31">-        ret |= (!secp256k1_ecdsa_signature_serialize_der(ctx, roundtrip_der, &amp;len_der, &amp;sig_der)) &lt;&lt; 1;</span>
<span class="term-fg31">-        roundtrips_der = (len_der == siglen) &amp;&amp; memcmp(roundtrip_der, sig, siglen) == 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    parsed_der_lax = ecdsa_signature_parse_der_lax(ctx, &amp;sig_der_lax, sig, siglen);</span>
<span class="term-fg31">-    if (parsed_der_lax) {</span>
<span class="term-fg31">-        ret |= (!secp256k1_ecdsa_signature_serialize_compact(ctx, compact_der_lax, &amp;sig_der_lax)) &lt;&lt; 10;</span>
<span class="term-fg31">-        valid_der_lax = (memcmp(compact_der_lax, zeroes, 32) != 0) &amp;&amp; (memcmp(compact_der_lax + 32, zeroes, 32) != 0);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    if (valid_der_lax) {</span>
<span class="term-fg31">-        ret |= (!secp256k1_ecdsa_signature_serialize_der(ctx, roundtrip_der_lax, &amp;len_der_lax, &amp;sig_der_lax)) &lt;&lt; 11;</span>
<span class="term-fg31">-        roundtrips_der_lax = (len_der_lax == siglen) &amp;&amp; memcmp(roundtrip_der_lax, sig, siglen) == 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    if (certainly_der) {</span>
<span class="term-fg31">-        ret |= (!parsed_der) &lt;&lt; 2;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    if (certainly_not_der) {</span>
<span class="term-fg31">-        ret |= (parsed_der) &lt;&lt; 17;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    if (valid_der) {</span>
<span class="term-fg31">-        ret |= (!roundtrips_der) &lt;&lt; 3;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    if (valid_der) {</span>
<span class="term-fg31">-        ret |= (!roundtrips_der_lax) &lt;&lt; 12;</span>
<span class="term-fg31">-        ret |= (len_der != len_der_lax) &lt;&lt; 13;</span>
<span class="term-fg31">-        ret |= (memcmp(roundtrip_der_lax, roundtrip_der, len_der) != 0) &lt;&lt; 14;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    ret |= (roundtrips_der != roundtrips_der_lax) &lt;&lt; 15;</span>
<span class="term-fg31">-    if (parsed_der) {</span>
<span class="term-fg31">-        ret |= (!parsed_der_lax) &lt;&lt; 16;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef ENABLE_OPENSSL_TESTS</span>
<span class="term-fg31">-    sig_openssl = ECDSA_SIG_new();</span>
<span class="term-fg31">-    sigptr = sig;</span>
<span class="term-fg31">-    parsed_openssl = (d2i_ECDSA_SIG(&amp;sig_openssl, &amp;sigptr, siglen) != NULL);</span>
<span class="term-fg31">-    if (parsed_openssl) {</span>
<span class="term-fg31">-        valid_openssl = !BN_is_negative(sig_openssl-&gt;r) &amp;&amp; !BN_is_negative(sig_openssl-&gt;s) &amp;&amp; BN_num_bits(sig_openssl-&gt;r) &gt; 0 &amp;&amp; BN_num_bits(sig_openssl-&gt;r) &lt;= 256 &amp;&amp; BN_num_bits(sig_openssl-&gt;s) &gt; 0 &amp;&amp; BN_num_bits(sig_openssl-&gt;s) &lt;= 256;</span>
<span class="term-fg31">-        if (valid_openssl) {</span>
<span class="term-fg31">-            unsigned char tmp[32] = {0};</span>
<span class="term-fg31">-            BN_bn2bin(sig_openssl-&gt;r, tmp + 32 - BN_num_bytes(sig_openssl-&gt;r));</span>
<span class="term-fg31">-            valid_openssl = memcmp(tmp, max_scalar, 32) &lt; 0;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        if (valid_openssl) {</span>
<span class="term-fg31">-            unsigned char tmp[32] = {0};</span>
<span class="term-fg31">-            BN_bn2bin(sig_openssl-&gt;s, tmp + 32 - BN_num_bytes(sig_openssl-&gt;s));</span>
<span class="term-fg31">-            valid_openssl = memcmp(tmp, max_scalar, 32) &lt; 0;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    len_openssl = i2d_ECDSA_SIG(sig_openssl, NULL);</span>
<span class="term-fg31">-    if (len_openssl &lt;= 2048) {</span>
<span class="term-fg31">-        unsigned char *ptr = roundtrip_openssl;</span>
<span class="term-fg31">-        CHECK(i2d_ECDSA_SIG(sig_openssl, &amp;ptr) == len_openssl);</span>
<span class="term-fg31">-        roundtrips_openssl = valid_openssl &amp;&amp; ((size_t)len_openssl == siglen) &amp;&amp; (memcmp(roundtrip_openssl, sig, siglen) == 0);</span>
<span class="term-fg31">-    } else {</span>
<span class="term-fg31">-        len_openssl = 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    ECDSA_SIG_free(sig_openssl);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    ret |= (parsed_der &amp;&amp; !parsed_openssl) &lt;&lt; 4;</span>
<span class="term-fg31">-    ret |= (valid_der &amp;&amp; !valid_openssl) &lt;&lt; 5;</span>
<span class="term-fg31">-    ret |= (roundtrips_openssl &amp;&amp; !parsed_der) &lt;&lt; 6;</span>
<span class="term-fg31">-    ret |= (roundtrips_der != roundtrips_openssl) &lt;&lt; 7;</span>
<span class="term-fg31">-    if (roundtrips_openssl) {</span>
<span class="term-fg31">-        ret |= (len_der != (size_t)len_openssl) &lt;&lt; 8;</span>
<span class="term-fg31">-        ret |= (memcmp(roundtrip_der, roundtrip_openssl, len_der) != 0) &lt;&lt; 9;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-    return ret;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void assign_big_endian(unsigned char *ptr, size_t ptrlen, uint32_t val) {</span>
<span class="term-fg31">-    size_t i;</span>
<span class="term-fg31">-    for (i = 0; i &lt; ptrlen; i++) {</span>
<span class="term-fg31">-        int shift = ptrlen - 1 - i;</span>
<span class="term-fg31">-        if (shift &gt;= 4) {</span>
<span class="term-fg31">-            ptr[i] = 0;</span>
<span class="term-fg31">-        } else {</span>
<span class="term-fg31">-            ptr[i] = (val &gt;&gt; shift) &amp; 0xFF;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void damage_array(unsigned char *sig, size_t *len) {</span>
<span class="term-fg31">-    int pos;</span>
<span class="term-fg31">-    int action = secp256k1_rand_bits(3);</span>
<span class="term-fg31">-    if (action &lt; 1 &amp;&amp; *len &gt; 3) {</span>
<span class="term-fg31">-        &#47;* Delete a byte. *&#47;</span>
<span class="term-fg31">-        pos = secp256k1_rand_int(*len);</span>
<span class="term-fg31">-        memmove(sig + pos, sig + pos + 1, *len - pos - 1);</span>
<span class="term-fg31">-        (*len)--;</span>
<span class="term-fg31">-        return;</span>
<span class="term-fg31">-    } else if (action &lt; 2 &amp;&amp; *len &lt; 2048) {</span>
<span class="term-fg31">-        &#47;* Insert a byte. *&#47;</span>
<span class="term-fg31">-        pos = secp256k1_rand_int(1 + *len);</span>
<span class="term-fg31">-        memmove(sig + pos + 1, sig + pos, *len - pos);</span>
<span class="term-fg31">-        sig[pos] = secp256k1_rand_bits(8);</span>
<span class="term-fg31">-        (*len)++;</span>
<span class="term-fg31">-        return;</span>
<span class="term-fg31">-    } else if (action &lt; 4) {</span>
<span class="term-fg31">-        &#47;* Modify a byte. *&#47;</span>
<span class="term-fg31">-        sig[secp256k1_rand_int(*len)] += 1 + secp256k1_rand_int(255);</span>
<span class="term-fg31">-        return;</span>
<span class="term-fg31">-    } else { &#47;* action &lt; 8 *&#47;</span>
<span class="term-fg31">-        &#47;* Modify a bit. *&#47;</span>
<span class="term-fg31">-        sig[secp256k1_rand_int(*len)] ^= 1 &lt;&lt; secp256k1_rand_bits(3);</span>
<span class="term-fg31">-        return;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static void random_ber_signature(unsigned char *sig, size_t *len, int* certainly_der, int* certainly_not_der) {</span>
<span class="term-fg31">-    int der;</span>
<span class="term-fg31">-    int nlow[2], nlen[2], nlenlen[2], nhbit[2], nhbyte[2], nzlen[2];</span>
<span class="term-fg31">-    size_t tlen, elen, glen;</span>
<span class="term-fg31">-    int indet;</span>
<span class="term-fg31">-    int n;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    *len = 0;</span>
<span class="term-fg31">-    der = secp256k1_rand_bits(2) == 0;</span>
<span class="term-fg31">-    *certainly_der = der;</span>
<span class="term-fg31">-    *certainly_not_der = 0;</span>
<span class="term-fg31">-    indet = der ? 0 : secp256k1_rand_int(10) == 0;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    for (n = 0; n &lt; 2; n++) {</span>
<span class="term-fg31">-        &#47;* We generate two classes of numbers: nlow==1 &quot;low&quot; ones (up to 32 bytes), nlow==0 &quot;high&quot; ones (32 bytes with 129 top bits set, or larger than 32 bytes) *&#47;</span>
<span class="term-fg31">-        nlow[n] = der ? 1 : (secp256k1_rand_bits(3) != 0);</span>
<span class="term-fg31">-        &#47;* The length of the number in bytes (the first byte of which will always be nonzero) *&#47;</span>
<span class="term-fg31">-        nlen[n] = nlow[n] ? secp256k1_rand_int(33) : 32 + secp256k1_rand_int(200) * secp256k1_rand_int(8) &#47; 8;</span>
<span class="term-fg31">-        CHECK(nlen[n] &lt;= 232);</span>
<span class="term-fg31">-        &#47;* The top bit of the number. *&#47;</span>
<span class="term-fg31">-        nhbit[n] = (nlow[n] == 0 &amp;&amp; nlen[n] == 32) ? 1 : (nlen[n] == 0 ? 0 : secp256k1_rand_bits(1));</span>
<span class="term-fg31">-        &#47;* The top byte of the number (after the potential hardcoded 16 0xFF characters for &quot;high&quot; 32 bytes numbers) *&#47;</span>
<span class="term-fg31">-        nhbyte[n] = nlen[n] == 0 ? 0 : (nhbit[n] ? 128 + secp256k1_rand_bits(7) : 1 + secp256k1_rand_int(127));</span>
<span class="term-fg31">-        &#47;* The number of zero bytes in front of the number (which is 0 or 1 in case of DER, otherwise we extend up to 300 bytes) *&#47;</span>
<span class="term-fg31">-        nzlen[n] = der ? ((nlen[n] == 0 || nhbit[n]) ? 1 : 0) : (nlow[n] ? secp256k1_rand_int(3) : secp256k1_rand_int(300 - nlen[n]) * secp256k1_rand_int(8) &#47; 8);</span>
<span class="term-fg31">-        if (nzlen[n] &gt; ((nlen[n] == 0 || nhbit[n]) ? 1 : 0)) {</span>
<span class="term-fg31">-            *certainly_not_der = 1;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        CHECK(nlen[n] + nzlen[n] &lt;= 300);</span>
<span class="term-fg31">-        &#47;* The length of the length descriptor for the number. 0 means short encoding, anything else is long encoding. *&#47;</span>
<span class="term-fg31">-        nlenlen[n] = nlen[n] + nzlen[n] &lt; 128 ? 0 : (nlen[n] + nzlen[n] &lt; 256 ? 1 : 2);</span>
<span class="term-fg31">-        if (!der) {</span>
<span class="term-fg31">-            &#47;* nlenlen[n] max 127 bytes *&#47;</span>
<span class="term-fg31">-            int add = secp256k1_rand_int(127 - nlenlen[n]) * secp256k1_rand_int(16) * secp256k1_rand_int(16) &#47; 256;</span>
<span class="term-fg31">-            nlenlen[n] += add;</span>
<span class="term-fg31">-            if (add != 0) {</span>
<span class="term-fg31">-                *certainly_not_der = 1;</span>
<span class="term-fg31">-            }</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        CHECK(nlen[n] + nzlen[n] + nlenlen[n] &lt;= 427);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* The total length of the data to go, so far *&#47;</span>
<span class="term-fg31">-    tlen = 2 + nlenlen[0] + nlen[0] + nzlen[0] + 2 + nlenlen[1] + nlen[1] + nzlen[1];</span>
<span class="term-fg31">-    CHECK(tlen &lt;= 856);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* The length of the garbage inside the tuple. *&#47;</span>
<span class="term-fg31">-    elen = (der || indet) ? 0 : secp256k1_rand_int(980 - tlen) * secp256k1_rand_int(8) &#47; 8;</span>
<span class="term-fg31">-    if (elen != 0) {</span>
<span class="term-fg31">-        *certainly_not_der = 1;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    tlen += elen;</span>
<span class="term-fg31">-    CHECK(tlen &lt;= 980);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* The length of the garbage after the end of the tuple. *&#47;</span>
<span class="term-fg31">-    glen = der ? 0 : secp256k1_rand_int(990 - tlen) * secp256k1_rand_int(8) &#47; 8;</span>
<span class="term-fg31">-    if (glen != 0) {</span>
<span class="term-fg31">-        *certainly_not_der = 1;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    CHECK(tlen + glen &lt;= 990);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Write the tuple header. *&#47;</span>
<span class="term-fg31">-    sig[(*len)++] = 0x30;</span>
<span class="term-fg31">-    if (indet) {</span>
<span class="term-fg31">-        &#47;* Indeterminate length *&#47;</span>
<span class="term-fg31">-        sig[(*len)++] = 0x80;</span>
<span class="term-fg31">-        *certainly_not_der = 1;</span>
<span class="term-fg31">-    } else {</span>
<span class="term-fg31">-        int tlenlen = tlen &lt; 128 ? 0 : (tlen &lt; 256 ? 1 : 2);</span>
<span class="term-fg31">-        if (!der) {</span>
<span class="term-fg31">-            int add = secp256k1_rand_int(127 - tlenlen) * secp256k1_rand_int(16) * secp256k1_rand_int(16) &#47; 256;</span>
<span class="term-fg31">-            tlenlen += add;</span>
<span class="term-fg31">-            if (add != 0) {</span>
<span class="term-fg31">-                *certainly_not_der = 1;</span>
<span class="term-fg31">-            }</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        if (tlenlen == 0) {</span>
<span class="term-fg31">-            &#47;* Short length notation *&#47;</span>
<span class="term-fg31">-            sig[(*len)++] = tlen;</span>
<span class="term-fg31">-        } else {</span>
<span class="term-fg31">-            &#47;* Long length notation *&#47;</span>
<span class="term-fg31">-            sig[(*len)++] = 128 + tlenlen;</span>
<span class="term-fg31">-            assign_big_endian(sig + *len, tlenlen, tlen);</span>
<span class="term-fg31">-            *len += tlenlen;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        tlen += tlenlen;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    tlen += 2;</span>
<span class="term-fg31">-    CHECK(tlen + glen &lt;= 1119);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    for (n = 0; n &lt; 2; n++) {</span>
<span class="term-fg31">-        &#47;* Write the integer header. *&#47;</span>
<span class="term-fg31">-        sig[(*len)++] = 0x02;</span>
<span class="term-fg31">-        if (nlenlen[n] == 0) {</span>
<span class="term-fg31">-            &#47;* Short length notation *&#47;</span>
<span class="term-fg31">-            sig[(*len)++] = nlen[n] + nzlen[n];</span>
<span class="term-fg31">-        } else {</span>
<span class="term-fg31">-            &#47;* Long length notation. *&#47;</span>
<span class="term-fg31">-            sig[(*len)++] = 128 + nlenlen[n];</span>
<span class="term-fg31">-            assign_big_endian(sig + *len, nlenlen[n], nlen[n] + nzlen[n]);</span>
<span class="term-fg31">-            *len += nlenlen[n];</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        &#47;* Write zero padding *&#47;</span>
<span class="term-fg31">-        while (nzlen[n] &gt; 0) {</span>
<span class="term-fg31">-            sig[(*len)++] = 0x00;</span>
<span class="term-fg31">-            nzlen[n]--;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        if (nlen[n] == 32 &amp;&amp; !nlow[n]) {</span>
<span class="term-fg31">-            &#47;* Special extra 16 0xFF bytes in &quot;high&quot; 32-byte numbers *&#47;</span>
<span class="term-fg31">-            int i;</span>
<span class="term-fg31">-            for (i = 0; i &lt; 16; i++) {</span>
<span class="term-fg31">-                sig[(*len)++] = 0xFF;</span>
<span class="term-fg31">-            }</span>
<span class="term-fg31">-            nlen[n] -= 16;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        &#47;* Write first byte of number *&#47;</span>
<span class="term-fg31">-        if (nlen[n] &gt; 0) {</span>
<span class="term-fg31">-            sig[(*len)++] = nhbyte[n];</span>
<span class="term-fg31">-            nlen[n]--;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        &#47;* Generate remaining random bytes of number *&#47;</span>
<span class="term-fg31">-        secp256k1_rand_bytes_test(sig + *len, nlen[n]);</span>
<span class="term-fg31">-        *len += nlen[n];</span>
<span class="term-fg31">-        nlen[n] = 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Generate random garbage inside tuple. *&#47;</span>
<span class="term-fg31">-    secp256k1_rand_bytes_test(sig + *len, elen);</span>
<span class="term-fg31">-    *len += elen;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Generate end-of-contents bytes. *&#47;</span>
<span class="term-fg31">-    if (indet) {</span>
<span class="term-fg31">-        sig[(*len)++] = 0;</span>
<span class="term-fg31">-        sig[(*len)++] = 0;</span>
<span class="term-fg31">-        tlen += 2;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    CHECK(tlen + glen &lt;= 1121);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Generate random garbage outside tuple. *&#47;</span>
<span class="term-fg31">-    secp256k1_rand_bytes_test(sig + *len, glen);</span>
<span class="term-fg31">-    *len += glen;</span>
<span class="term-fg31">-    tlen += glen;</span>
<span class="term-fg31">-    CHECK(tlen &lt;= 1121);</span>
<span class="term-fg31">-    CHECK(tlen == *len);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void run_ecdsa_der_parse(void) {</span>
<span class="term-fg31">-    int i,j;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 200 * count; i++) {</span>
<span class="term-fg31">-        unsigned char buffer[2048];</span>
<span class="term-fg31">-        size_t buflen = 0;</span>
<span class="term-fg31">-        int certainly_der = 0;</span>
<span class="term-fg31">-        int certainly_not_der = 0;</span>
<span class="term-fg31">-        random_ber_signature(buffer, &amp;buflen, &amp;certainly_der, &amp;certainly_not_der);</span>
<span class="term-fg31">-        CHECK(buflen &lt;= 2048);</span>
<span class="term-fg31">-        for (j = 0; j &lt; 16; j++) {</span>
<span class="term-fg31">-            int ret = 0;</span>
<span class="term-fg31">-            if (j &gt; 0) {</span>
<span class="term-fg31">-                damage_array(buffer, &amp;buflen);</span>
<span class="term-fg31">-                &#47;* We don&#39;t know anything anymore about the DERness of the result *&#47;</span>
<span class="term-fg31">-                certainly_der = 0;</span>
<span class="term-fg31">-                certainly_not_der = 0;</span>
<span class="term-fg31">-            }</span>
<span class="term-fg31">-            ret = test_ecdsa_der_parse(buffer, buflen, certainly_der, certainly_not_der);</span>
<span class="term-fg31">-            if (ret != 0) {</span>
<span class="term-fg31">-                size_t k;</span>
<span class="term-fg31">-                fprintf(stderr, &quot;Failure %x on &quot;, ret);</span>
<span class="term-fg31">-                for (k = 0; k &lt; buflen; k++) {</span>
<span class="term-fg31">-                    fprintf(stderr, &quot;%02x &quot;, buffer[k]);</span>
<span class="term-fg31">-                }</span>
<span class="term-fg31">-                fprintf(stderr, &quot;\n&quot;);</span>
<span class="term-fg31">-            }</span>
<span class="term-fg31">-            CHECK(ret == 0);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;* Tests several edge cases. *&#47;</span>
<span class="term-fg31">-void test_ecdsa_edge_cases(void) {</span>
<span class="term-fg31">-    int t;</span>
<span class="term-fg31">-    secp256k1_ecdsa_signature sig;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Test the case where ECDSA recomputes a point that is infinity. *&#47;</span>
<span class="term-fg31">-    {</span>
<span class="term-fg31">-        secp256k1_gej keyj;</span>
<span class="term-fg31">-        secp256k1_ge key;</span>
<span class="term-fg31">-        secp256k1_scalar msg;</span>
<span class="term-fg31">-        secp256k1_scalar sr, ss;</span>
<span class="term-fg31">-        secp256k1_scalar_set_int(&amp;ss, 1);</span>
<span class="term-fg31">-        secp256k1_scalar_negate(&amp;ss, &amp;ss);</span>
<span class="term-fg31">-        secp256k1_scalar_inverse(&amp;ss, &amp;ss);</span>
<span class="term-fg31">-        secp256k1_scalar_set_int(&amp;sr, 1);</span>
<span class="term-fg31">-        secp256k1_ecmult_gen(&amp;ctx-&gt;ecmult_gen_ctx, &amp;keyj, &amp;sr);</span>
<span class="term-fg31">-        secp256k1_ge_set_gej(&amp;key, &amp;keyj);</span>
<span class="term-fg31">-        msg = ss;</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_sig_verify(&amp;ctx-&gt;ecmult_ctx, &amp;sr, &amp;ss, &amp;key, &amp;msg) == 0);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Verify signature with r of zero fails. *&#47;</span>
<span class="term-fg31">-    {</span>
<span class="term-fg31">-        const unsigned char pubkey_mods_zero[33] = {</span>
<span class="term-fg31">-            0x02, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-            0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-            0xfe, 0xba, 0xae, 0xdc, 0xe6, 0xaf, 0x48, 0xa0,</span>
<span class="term-fg31">-            0x3b, 0xbf, 0xd2, 0x5e, 0x8c, 0xd0, 0x36, 0x41,</span>
<span class="term-fg31">-            0x41</span>
<span class="term-fg31">-        };</span>
<span class="term-fg31">-        secp256k1_ge key;</span>
<span class="term-fg31">-        secp256k1_scalar msg;</span>
<span class="term-fg31">-        secp256k1_scalar sr, ss;</span>
<span class="term-fg31">-        secp256k1_scalar_set_int(&amp;ss, 1);</span>
<span class="term-fg31">-        secp256k1_scalar_set_int(&amp;msg, 0);</span>
<span class="term-fg31">-        secp256k1_scalar_set_int(&amp;sr, 0);</span>
<span class="term-fg31">-        CHECK(secp256k1_eckey_pubkey_parse(&amp;key, pubkey_mods_zero, 33));</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_sig_verify(&amp;ctx-&gt;ecmult_ctx, &amp;sr, &amp;ss, &amp;key, &amp;msg) == 0);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Verify signature with s of zero fails. *&#47;</span>
<span class="term-fg31">-    {</span>
<span class="term-fg31">-        const unsigned char pubkey[33] = {</span>
<span class="term-fg31">-            0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-            0x01</span>
<span class="term-fg31">-        };</span>
<span class="term-fg31">-        secp256k1_ge key;</span>
<span class="term-fg31">-        secp256k1_scalar msg;</span>
<span class="term-fg31">-        secp256k1_scalar sr, ss;</span>
<span class="term-fg31">-        secp256k1_scalar_set_int(&amp;ss, 0);</span>
<span class="term-fg31">-        secp256k1_scalar_set_int(&amp;msg, 0);</span>
<span class="term-fg31">-        secp256k1_scalar_set_int(&amp;sr, 1);</span>
<span class="term-fg31">-        CHECK(secp256k1_eckey_pubkey_parse(&amp;key, pubkey, 33));</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_sig_verify(&amp;ctx-&gt;ecmult_ctx, &amp;sr, &amp;ss, &amp;key, &amp;msg) == 0);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Verify signature with message 0 passes. *&#47;</span>
<span class="term-fg31">-    {</span>
<span class="term-fg31">-        const unsigned char pubkey[33] = {</span>
<span class="term-fg31">-            0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-            0x02</span>
<span class="term-fg31">-        };</span>
<span class="term-fg31">-        const unsigned char pubkey2[33] = {</span>
<span class="term-fg31">-            0x02, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-            0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-            0xfe, 0xba, 0xae, 0xdc, 0xe6, 0xaf, 0x48, 0xa0,</span>
<span class="term-fg31">-            0x3b, 0xbf, 0xd2, 0x5e, 0x8c, 0xd0, 0x36, 0x41,</span>
<span class="term-fg31">-            0x43</span>
<span class="term-fg31">-        };</span>
<span class="term-fg31">-        secp256k1_ge key;</span>
<span class="term-fg31">-        secp256k1_ge key2;</span>
<span class="term-fg31">-        secp256k1_scalar msg;</span>
<span class="term-fg31">-        secp256k1_scalar sr, ss;</span>
<span class="term-fg31">-        secp256k1_scalar_set_int(&amp;ss, 2);</span>
<span class="term-fg31">-        secp256k1_scalar_set_int(&amp;msg, 0);</span>
<span class="term-fg31">-        secp256k1_scalar_set_int(&amp;sr, 2);</span>
<span class="term-fg31">-        CHECK(secp256k1_eckey_pubkey_parse(&amp;key, pubkey, 33));</span>
<span class="term-fg31">-        CHECK(secp256k1_eckey_pubkey_parse(&amp;key2, pubkey2, 33));</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_sig_verify(&amp;ctx-&gt;ecmult_ctx, &amp;sr, &amp;ss, &amp;key, &amp;msg) == 1);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_sig_verify(&amp;ctx-&gt;ecmult_ctx, &amp;sr, &amp;ss, &amp;key2, &amp;msg) == 1);</span>
<span class="term-fg31">-        secp256k1_scalar_negate(&amp;ss, &amp;ss);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_sig_verify(&amp;ctx-&gt;ecmult_ctx, &amp;sr, &amp;ss, &amp;key, &amp;msg) == 1);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_sig_verify(&amp;ctx-&gt;ecmult_ctx, &amp;sr, &amp;ss, &amp;key2, &amp;msg) == 1);</span>
<span class="term-fg31">-        secp256k1_scalar_set_int(&amp;ss, 1);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_sig_verify(&amp;ctx-&gt;ecmult_ctx, &amp;sr, &amp;ss, &amp;key, &amp;msg) == 0);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_sig_verify(&amp;ctx-&gt;ecmult_ctx, &amp;sr, &amp;ss, &amp;key2, &amp;msg) == 0);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Verify signature with message 1 passes. *&#47;</span>
<span class="term-fg31">-    {</span>
<span class="term-fg31">-        const unsigned char pubkey[33] = {</span>
<span class="term-fg31">-            0x02, 0x14, 0x4e, 0x5a, 0x58, 0xef, 0x5b, 0x22,</span>
<span class="term-fg31">-            0x6f, 0xd2, 0xe2, 0x07, 0x6a, 0x77, 0xcf, 0x05,</span>
<span class="term-fg31">-            0xb4, 0x1d, 0xe7, 0x4a, 0x30, 0x98, 0x27, 0x8c,</span>
<span class="term-fg31">-            0x93, 0xe6, 0xe6, 0x3c, 0x0b, 0xc4, 0x73, 0x76,</span>
<span class="term-fg31">-            0x25</span>
<span class="term-fg31">-        };</span>
<span class="term-fg31">-        const unsigned char pubkey2[33] = {</span>
<span class="term-fg31">-            0x02, 0x8a, 0xd5, 0x37, 0xed, 0x73, 0xd9, 0x40,</span>
<span class="term-fg31">-            0x1d, 0xa0, 0x33, 0xd2, 0xdc, 0xf0, 0xaf, 0xae,</span>
<span class="term-fg31">-            0x34, 0xcf, 0x5f, 0x96, 0x4c, 0x73, 0x28, 0x0f,</span>
<span class="term-fg31">-            0x92, 0xc0, 0xf6, 0x9d, 0xd9, 0xb2, 0x09, 0x10,</span>
<span class="term-fg31">-            0x62</span>
<span class="term-fg31">-        };</span>
<span class="term-fg31">-        const unsigned char csr[32] = {</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01,</span>
<span class="term-fg31">-            0x45, 0x51, 0x23, 0x19, 0x50, 0xb7, 0x5f, 0xc4,</span>
<span class="term-fg31">-            0x40, 0x2d, 0xa1, 0x72, 0x2f, 0xc9, 0xba, 0xeb</span>
<span class="term-fg31">-        };</span>
<span class="term-fg31">-        secp256k1_ge key;</span>
<span class="term-fg31">-        secp256k1_ge key2;</span>
<span class="term-fg31">-        secp256k1_scalar msg;</span>
<span class="term-fg31">-        secp256k1_scalar sr, ss;</span>
<span class="term-fg31">-        secp256k1_scalar_set_int(&amp;ss, 1);</span>
<span class="term-fg31">-        secp256k1_scalar_set_int(&amp;msg, 1);</span>
<span class="term-fg31">-        secp256k1_scalar_set_b32(&amp;sr, csr, NULL);</span>
<span class="term-fg31">-        CHECK(secp256k1_eckey_pubkey_parse(&amp;key, pubkey, 33));</span>
<span class="term-fg31">-        CHECK(secp256k1_eckey_pubkey_parse(&amp;key2, pubkey2, 33));</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_sig_verify(&amp;ctx-&gt;ecmult_ctx, &amp;sr, &amp;ss, &amp;key, &amp;msg) == 1);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_sig_verify(&amp;ctx-&gt;ecmult_ctx, &amp;sr, &amp;ss, &amp;key2, &amp;msg) == 1);</span>
<span class="term-fg31">-        secp256k1_scalar_negate(&amp;ss, &amp;ss);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_sig_verify(&amp;ctx-&gt;ecmult_ctx, &amp;sr, &amp;ss, &amp;key, &amp;msg) == 1);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_sig_verify(&amp;ctx-&gt;ecmult_ctx, &amp;sr, &amp;ss, &amp;key2, &amp;msg) == 1);</span>
<span class="term-fg31">-        secp256k1_scalar_set_int(&amp;ss, 2);</span>
<span class="term-fg31">-        secp256k1_scalar_inverse_var(&amp;ss, &amp;ss);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_sig_verify(&amp;ctx-&gt;ecmult_ctx, &amp;sr, &amp;ss, &amp;key, &amp;msg) == 0);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_sig_verify(&amp;ctx-&gt;ecmult_ctx, &amp;sr, &amp;ss, &amp;key2, &amp;msg) == 0);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Verify signature with message -1 passes. *&#47;</span>
<span class="term-fg31">-    {</span>
<span class="term-fg31">-        const unsigned char pubkey[33] = {</span>
<span class="term-fg31">-            0x03, 0xaf, 0x97, 0xff, 0x7d, 0x3a, 0xf6, 0xa0,</span>
<span class="term-fg31">-            0x02, 0x94, 0xbd, 0x9f, 0x4b, 0x2e, 0xd7, 0x52,</span>
<span class="term-fg31">-            0x28, 0xdb, 0x49, 0x2a, 0x65, 0xcb, 0x1e, 0x27,</span>
<span class="term-fg31">-            0x57, 0x9c, 0xba, 0x74, 0x20, 0xd5, 0x1d, 0x20,</span>
<span class="term-fg31">-            0xf1</span>
<span class="term-fg31">-        };</span>
<span class="term-fg31">-        const unsigned char csr[32] = {</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01,</span>
<span class="term-fg31">-            0x45, 0x51, 0x23, 0x19, 0x50, 0xb7, 0x5f, 0xc4,</span>
<span class="term-fg31">-            0x40, 0x2d, 0xa1, 0x72, 0x2f, 0xc9, 0xba, 0xee</span>
<span class="term-fg31">-        };</span>
<span class="term-fg31">-        secp256k1_ge key;</span>
<span class="term-fg31">-        secp256k1_scalar msg;</span>
<span class="term-fg31">-        secp256k1_scalar sr, ss;</span>
<span class="term-fg31">-        secp256k1_scalar_set_int(&amp;ss, 1);</span>
<span class="term-fg31">-        secp256k1_scalar_set_int(&amp;msg, 1);</span>
<span class="term-fg31">-        secp256k1_scalar_negate(&amp;msg, &amp;msg);</span>
<span class="term-fg31">-        secp256k1_scalar_set_b32(&amp;sr, csr, NULL);</span>
<span class="term-fg31">-        CHECK(secp256k1_eckey_pubkey_parse(&amp;key, pubkey, 33));</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_sig_verify(&amp;ctx-&gt;ecmult_ctx, &amp;sr, &amp;ss, &amp;key, &amp;msg) == 1);</span>
<span class="term-fg31">-        secp256k1_scalar_negate(&amp;ss, &amp;ss);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_sig_verify(&amp;ctx-&gt;ecmult_ctx, &amp;sr, &amp;ss, &amp;key, &amp;msg) == 1);</span>
<span class="term-fg31">-        secp256k1_scalar_set_int(&amp;ss, 3);</span>
<span class="term-fg31">-        secp256k1_scalar_inverse_var(&amp;ss, &amp;ss);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_sig_verify(&amp;ctx-&gt;ecmult_ctx, &amp;sr, &amp;ss, &amp;key, &amp;msg) == 0);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Signature where s would be zero. *&#47;</span>
<span class="term-fg31">-    {</span>
<span class="term-fg31">-        secp256k1_pubkey pubkey;</span>
<span class="term-fg31">-        size_t siglen;</span>
<span class="term-fg31">-        int32_t ecount;</span>
<span class="term-fg31">-        unsigned char signature[72];</span>
<span class="term-fg31">-        static const unsigned char nonce[32] = {</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01,</span>
<span class="term-fg31">-        };</span>
<span class="term-fg31">-        static const unsigned char nonce2[32] = {</span>
<span class="term-fg31">-            0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,</span>
<span class="term-fg31">-            0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFE,</span>
<span class="term-fg31">-            0xBA,0xAE,0xDC,0xE6,0xAF,0x48,0xA0,0x3B,</span>
<span class="term-fg31">-            0xBF,0xD2,0x5E,0x8C,0xD0,0x36,0x41,0x40</span>
<span class="term-fg31">-        };</span>
<span class="term-fg31">-        const unsigned char key[32] = {</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</span>
<span class="term-fg31">-            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01,</span>
<span class="term-fg31">-        };</span>
<span class="term-fg31">-        unsigned char msg[32] = {</span>
<span class="term-fg31">-            0x86, 0x41, 0x99, 0x81, 0x06, 0x23, 0x44, 0x53,</span>
<span class="term-fg31">-            0xaa, 0x5f, 0x9d, 0x6a, 0x31, 0x78, 0xf4, 0xf7,</span>
<span class="term-fg31">-            0xb8, 0x12, 0xe0, 0x0b, 0x81, 0x7a, 0x77, 0x62,</span>
<span class="term-fg31">-            0x65, 0xdf, 0xdd, 0x31, 0xb9, 0x3e, 0x29, 0xa9,</span>
<span class="term-fg31">-        };</span>
<span class="term-fg31">-        ecount = 0;</span>
<span class="term-fg31">-        secp256k1_context_set_illegal_callback(ctx, counting_illegal_callback_fn, &amp;ecount);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_sign(ctx, &amp;sig, msg, key, precomputed_nonce_function, nonce) == 0);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_sign(ctx, &amp;sig, msg, key, precomputed_nonce_function, nonce2) == 0);</span>
<span class="term-fg31">-        msg[31] = 0xaa;</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_sign(ctx, &amp;sig, msg, key, precomputed_nonce_function, nonce) == 1);</span>
<span class="term-fg31">-        CHECK(ecount == 0);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_sign(ctx, NULL, msg, key, precomputed_nonce_function, nonce2) == 0);</span>
<span class="term-fg31">-        CHECK(ecount == 1);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_sign(ctx, &amp;sig, NULL, key, precomputed_nonce_function, nonce2) == 0);</span>
<span class="term-fg31">-        CHECK(ecount == 2);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_sign(ctx, &amp;sig, msg, NULL, precomputed_nonce_function, nonce2) == 0);</span>
<span class="term-fg31">-        CHECK(ecount == 3);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_sign(ctx, &amp;sig, msg, key, precomputed_nonce_function, nonce2) == 1);</span>
<span class="term-fg31">-        CHECK(secp256k1_ec_pubkey_create(ctx, &amp;pubkey, key) == 1);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_verify(ctx, NULL, msg, &amp;pubkey) == 0);</span>
<span class="term-fg31">-        CHECK(ecount == 4);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_verify(ctx, &amp;sig, NULL, &amp;pubkey) == 0);</span>
<span class="term-fg31">-        CHECK(ecount == 5);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_verify(ctx, &amp;sig, msg, NULL) == 0);</span>
<span class="term-fg31">-        CHECK(ecount == 6);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_verify(ctx, &amp;sig, msg, &amp;pubkey) == 1);</span>
<span class="term-fg31">-        CHECK(ecount == 6);</span>
<span class="term-fg31">-        CHECK(secp256k1_ec_pubkey_create(ctx, &amp;pubkey, NULL) == 0);</span>
<span class="term-fg31">-        CHECK(ecount == 7);</span>
<span class="term-fg31">-        &#47;* That pubkeyload fails via an ARGCHECK is a little odd but makes sense because pubkeys are an opaque data type. *&#47;</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_verify(ctx, &amp;sig, msg, &amp;pubkey) == 0);</span>
<span class="term-fg31">-        CHECK(ecount == 8);</span>
<span class="term-fg31">-        siglen = 72;</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_signature_serialize_der(ctx, NULL, &amp;siglen, &amp;sig) == 0);</span>
<span class="term-fg31">-        CHECK(ecount == 9);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_signature_serialize_der(ctx, signature, NULL, &amp;sig) == 0);</span>
<span class="term-fg31">-        CHECK(ecount == 10);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_signature_serialize_der(ctx, signature, &amp;siglen, NULL) == 0);</span>
<span class="term-fg31">-        CHECK(ecount == 11);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_signature_serialize_der(ctx, signature, &amp;siglen, &amp;sig) == 1);</span>
<span class="term-fg31">-        CHECK(ecount == 11);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_signature_parse_der(ctx, NULL, signature, siglen) == 0);</span>
<span class="term-fg31">-        CHECK(ecount == 12);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_signature_parse_der(ctx, &amp;sig, NULL, siglen) == 0);</span>
<span class="term-fg31">-        CHECK(ecount == 13);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_signature_parse_der(ctx, &amp;sig, signature, siglen) == 1);</span>
<span class="term-fg31">-        CHECK(ecount == 13);</span>
<span class="term-fg31">-        siglen = 10;</span>
<span class="term-fg31">-        &#47;* Too little room for a signature does not fail via ARGCHECK. *&#47;</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_signature_serialize_der(ctx, signature, &amp;siglen, &amp;sig) == 0);</span>
<span class="term-fg31">-        CHECK(ecount == 13);</span>
<span class="term-fg31">-        ecount = 0;</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_signature_normalize(ctx, NULL, NULL) == 0);</span>
<span class="term-fg31">-        CHECK(ecount == 1);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_signature_serialize_compact(ctx, NULL, &amp;sig) == 0);</span>
<span class="term-fg31">-        CHECK(ecount == 2);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_signature_serialize_compact(ctx, signature, NULL) == 0);</span>
<span class="term-fg31">-        CHECK(ecount == 3);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_signature_serialize_compact(ctx, signature, &amp;sig) == 1);</span>
<span class="term-fg31">-        CHECK(ecount == 3);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_signature_parse_compact(ctx, NULL, signature) == 0);</span>
<span class="term-fg31">-        CHECK(ecount == 4);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_signature_parse_compact(ctx, &amp;sig, NULL) == 0);</span>
<span class="term-fg31">-        CHECK(ecount == 5);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_signature_parse_compact(ctx, &amp;sig, signature) == 1);</span>
<span class="term-fg31">-        CHECK(ecount == 5);</span>
<span class="term-fg31">-        memset(signature, 255, 64);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_signature_parse_compact(ctx, &amp;sig, signature) == 0);</span>
<span class="term-fg31">-        CHECK(ecount == 5);</span>
<span class="term-fg31">-        secp256k1_context_set_illegal_callback(ctx, NULL, NULL);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Nonce function corner cases. *&#47;</span>
<span class="term-fg31">-    for (t = 0; t &lt; 2; t++) {</span>
<span class="term-fg31">-        static const unsigned char zero[32] = {0x00};</span>
<span class="term-fg31">-        int i;</span>
<span class="term-fg31">-        unsigned char key[32];</span>
<span class="term-fg31">-        unsigned char msg[32];</span>
<span class="term-fg31">-        secp256k1_ecdsa_signature sig2;</span>
<span class="term-fg31">-        secp256k1_scalar sr[512], ss;</span>
<span class="term-fg31">-        const unsigned char *extra;</span>
<span class="term-fg31">-        extra = t == 0 ? NULL : zero;</span>
<span class="term-fg31">-        memset(msg, 0, 32);</span>
<span class="term-fg31">-        msg[31] = 1;</span>
<span class="term-fg31">-        &#47;* High key results in signature failure. *&#47;</span>
<span class="term-fg31">-        memset(key, 0xFF, 32);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_sign(ctx, &amp;sig, msg, key, NULL, extra) == 0);</span>
<span class="term-fg31">-        CHECK(is_empty_signature(&amp;sig));</span>
<span class="term-fg31">-        &#47;* Zero key results in signature failure. *&#47;</span>
<span class="term-fg31">-        memset(key, 0, 32);</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_sign(ctx, &amp;sig, msg, key, NULL, extra) == 0);</span>
<span class="term-fg31">-        CHECK(is_empty_signature(&amp;sig));</span>
<span class="term-fg31">-        &#47;* Nonce function failure results in signature failure. *&#47;</span>
<span class="term-fg31">-        key[31] = 1;</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_sign(ctx, &amp;sig, msg, key, nonce_function_test_fail, extra) == 0);</span>
<span class="term-fg31">-        CHECK(is_empty_signature(&amp;sig));</span>
<span class="term-fg31">-        &#47;* The retry loop successfully makes its way to the first good value. *&#47;</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_sign(ctx, &amp;sig, msg, key, nonce_function_test_retry, extra) == 1);</span>
<span class="term-fg31">-        CHECK(!is_empty_signature(&amp;sig));</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_sign(ctx, &amp;sig2, msg, key, nonce_function_rfc6979, extra) == 1);</span>
<span class="term-fg31">-        CHECK(!is_empty_signature(&amp;sig2));</span>
<span class="term-fg31">-        CHECK(memcmp(&amp;sig, &amp;sig2, sizeof(sig)) == 0);</span>
<span class="term-fg31">-        &#47;* The default nonce function is deterministic. *&#47;</span>
<span class="term-fg31">-        CHECK(secp256k1_ecdsa_sign(ctx, &amp;sig2, msg, key, NULL, extra) == 1);</span>
<span class="term-fg31">-        CHECK(!is_empty_signature(&amp;sig2));</span>
<span class="term-fg31">-        CHECK(memcmp(&amp;sig, &amp;sig2, sizeof(sig)) == 0);</span>
<span class="term-fg31">-        &#47;* The default nonce function changes output with different messages. *&#47;</span>
<span class="term-fg31">-        for(i = 0; i &lt; 256; i++) {</span>
<span class="term-fg31">-            int j;</span>
<span class="term-fg31">-            msg[0] = i;</span>
<span class="term-fg31">-            CHECK(secp256k1_ecdsa_sign(ctx, &amp;sig2, msg, key, NULL, extra) == 1);</span>
<span class="term-fg31">-            CHECK(!is_empty_signature(&amp;sig2));</span>
<span class="term-fg31">-            secp256k1_ecdsa_signature_load(ctx, &amp;sr[i], &amp;ss, &amp;sig2);</span>
<span class="term-fg31">-            for (j = 0; j &lt; i; j++) {</span>
<span class="term-fg31">-                CHECK(!secp256k1_scalar_eq(&amp;sr[i], &amp;sr[j]));</span>
<span class="term-fg31">-            }</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        msg[0] = 0;</span>
<span class="term-fg31">-        msg[31] = 2;</span>
<span class="term-fg31">-        &#47;* The default nonce function changes output with different keys. *&#47;</span>
<span class="term-fg31">-        for(i = 256; i &lt; 512; i++) {</span>
<span class="term-fg31">-            int j;</span>
<span class="term-fg31">-            key[0] = i - 256;</span>
<span class="term-fg31">-            CHECK(secp256k1_ecdsa_sign(ctx, &amp;sig2, msg, key, NULL, extra) == 1);</span>
<span class="term-fg31">-            CHECK(!is_empty_signature(&amp;sig2));</span>
<span class="term-fg31">-            secp256k1_ecdsa_signature_load(ctx, &amp;sr[i], &amp;ss, &amp;sig2);</span>
<span class="term-fg31">-            for (j = 0; j &lt; i; j++) {</span>
<span class="term-fg31">-                CHECK(!secp256k1_scalar_eq(&amp;sr[i], &amp;sr[j]));</span>
<span class="term-fg31">-            }</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        key[0] = 0;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    {</span>
<span class="term-fg31">-        &#47;* Check that optional nonce arguments do not have equivalent effect. *&#47;</span>
<span class="term-fg31">-        const unsigned char zeros[32] = {0};</span>
<span class="term-fg31">-        unsigned char nonce[32];</span>
<span class="term-fg31">-        unsigned char nonce2[32];</span>
<span class="term-fg31">-        unsigned char nonce3[32];</span>
<span class="term-fg31">-        unsigned char nonce4[32];</span>
<span class="term-fg31">-        VG_UNDEF(nonce,32);</span>
<span class="term-fg31">-        VG_UNDEF(nonce2,32);</span>
<span class="term-fg31">-        VG_UNDEF(nonce3,32);</span>
<span class="term-fg31">-        VG_UNDEF(nonce4,32);</span>
<span class="term-fg31">-        CHECK(nonce_function_rfc6979(nonce, zeros, zeros, NULL, NULL, 0) == 1);</span>
<span class="term-fg31">-        VG_CHECK(nonce,32);</span>
<span class="term-fg31">-        CHECK(nonce_function_rfc6979(nonce2, zeros, zeros, zeros, NULL, 0) == 1);</span>
<span class="term-fg31">-        VG_CHECK(nonce2,32);</span>
<span class="term-fg31">-        CHECK(nonce_function_rfc6979(nonce3, zeros, zeros, NULL, (void *)zeros, 0) == 1);</span>
<span class="term-fg31">-        VG_CHECK(nonce3,32);</span>
<span class="term-fg31">-        CHECK(nonce_function_rfc6979(nonce4, zeros, zeros, zeros, (void *)zeros, 0) == 1);</span>
<span class="term-fg31">-        VG_CHECK(nonce4,32);</span>
<span class="term-fg31">-        CHECK(memcmp(nonce, nonce2, 32) != 0);</span>
<span class="term-fg31">-        CHECK(memcmp(nonce, nonce3, 32) != 0);</span>
<span class="term-fg31">-        CHECK(memcmp(nonce, nonce4, 32) != 0);</span>
<span class="term-fg31">-        CHECK(memcmp(nonce2, nonce3, 32) != 0);</span>
<span class="term-fg31">-        CHECK(memcmp(nonce2, nonce4, 32) != 0);</span>
<span class="term-fg31">-        CHECK(memcmp(nonce3, nonce4, 32) != 0);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Privkey export where pubkey is the point at infinity. *&#47;</span>
<span class="term-fg31">-    {</span>
<span class="term-fg31">-        unsigned char privkey[300];</span>
<span class="term-fg31">-        unsigned char seckey[32] = {</span>
<span class="term-fg31">-            0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,</span>
<span class="term-fg31">-            0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xfe,</span>
<span class="term-fg31">-            0xba, 0xae, 0xdc, 0xe6, 0xaf, 0x48, 0xa0, 0x3b,</span>
<span class="term-fg31">-            0xbf, 0xd2, 0x5e, 0x8c, 0xd0, 0x36, 0x41, 0x41,</span>
<span class="term-fg31">-        };</span>
<span class="term-fg31">-        size_t outlen = 300;</span>
<span class="term-fg31">-        CHECK(!ec_privkey_export_der(ctx, privkey, &amp;outlen, seckey, 0));</span>
<span class="term-fg31">-        outlen = 300;</span>
<span class="term-fg31">-        CHECK(!ec_privkey_export_der(ctx, privkey, &amp;outlen, seckey, 1));</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void run_ecdsa_edge_cases(void) {</span>
<span class="term-fg31">-    test_ecdsa_edge_cases();</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef ENABLE_OPENSSL_TESTS</span>
<span class="term-fg31">-EC_KEY *get_openssl_key(const unsigned char *key32) {</span>
<span class="term-fg31">-    unsigned char privkey[300];</span>
<span class="term-fg31">-    size_t privkeylen;</span>
<span class="term-fg31">-    const unsigned char* pbegin = privkey;</span>
<span class="term-fg31">-    int compr = secp256k1_rand_bits(1);</span>
<span class="term-fg31">-    EC_KEY *ec_key = EC_KEY_new_by_curve_name(NID_secp256k1);</span>
<span class="term-fg31">-    CHECK(ec_privkey_export_der(ctx, privkey, &amp;privkeylen, key32, compr));</span>
<span class="term-fg31">-    CHECK(d2i_ECPrivateKey(&amp;ec_key, &amp;pbegin, privkeylen));</span>
<span class="term-fg31">-    CHECK(EC_KEY_check_key(ec_key));</span>
<span class="term-fg31">-    return ec_key;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void test_ecdsa_openssl(void) {</span>
<span class="term-fg31">-    secp256k1_gej qj;</span>
<span class="term-fg31">-    secp256k1_ge q;</span>
<span class="term-fg31">-    secp256k1_scalar sigr, sigs;</span>
<span class="term-fg31">-    secp256k1_scalar one;</span>
<span class="term-fg31">-    secp256k1_scalar msg2;</span>
<span class="term-fg31">-    secp256k1_scalar key, msg;</span>
<span class="term-fg31">-    EC_KEY *ec_key;</span>
<span class="term-fg31">-    unsigned int sigsize = 80;</span>
<span class="term-fg31">-    size_t secp_sigsize = 80;</span>
<span class="term-fg31">-    unsigned char message[32];</span>
<span class="term-fg31">-    unsigned char signature[80];</span>
<span class="term-fg31">-    unsigned char key32[32];</span>
<span class="term-fg31">-    secp256k1_rand256_test(message);</span>
<span class="term-fg31">-    secp256k1_scalar_set_b32(&amp;msg, message, NULL);</span>
<span class="term-fg31">-    random_scalar_order_test(&amp;key);</span>
<span class="term-fg31">-    secp256k1_scalar_get_b32(key32, &amp;key);</span>
<span class="term-fg31">-    secp256k1_ecmult_gen(&amp;ctx-&gt;ecmult_gen_ctx, &amp;qj, &amp;key);</span>
<span class="term-fg31">-    secp256k1_ge_set_gej(&amp;q, &amp;qj);</span>
<span class="term-fg31">-    ec_key = get_openssl_key(key32);</span>
<span class="term-fg31">-    CHECK(ec_key != NULL);</span>
<span class="term-fg31">-    CHECK(ECDSA_sign(0, message, sizeof(message), signature, &amp;sigsize, ec_key));</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_sig_parse(&amp;sigr, &amp;sigs, signature, sigsize));</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_sig_verify(&amp;ctx-&gt;ecmult_ctx, &amp;sigr, &amp;sigs, &amp;q, &amp;msg));</span>
<span class="term-fg31">-    secp256k1_scalar_set_int(&amp;one, 1);</span>
<span class="term-fg31">-    secp256k1_scalar_add(&amp;msg2, &amp;msg, &amp;one);</span>
<span class="term-fg31">-    CHECK(!secp256k1_ecdsa_sig_verify(&amp;ctx-&gt;ecmult_ctx, &amp;sigr, &amp;sigs, &amp;q, &amp;msg2));</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    random_sign(&amp;sigr, &amp;sigs, &amp;key, &amp;msg, NULL);</span>
<span class="term-fg31">-    CHECK(secp256k1_ecdsa_sig_serialize(signature, &amp;secp_sigsize, &amp;sigr, &amp;sigs));</span>
<span class="term-fg31">-    CHECK(ECDSA_verify(0, message, sizeof(message), signature, secp_sigsize, ec_key) == 1);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    EC_KEY_free(ec_key);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void run_ecdsa_openssl(void) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    for (i = 0; i &lt; 10*count; i++) {</span>
<span class="term-fg31">-        test_ecdsa_openssl();</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef ENABLE_MODULE_ECDH</span>
<span class="term-fg31">-# include &quot;modules&#47;ecdh&#47;tests_impl.h&quot;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef ENABLE_MODULE_SCHNORR</span>
<span class="term-fg31">-# include &quot;modules&#47;schnorr&#47;tests_impl.h&quot;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef ENABLE_MODULE_RECOVERY</span>
<span class="term-fg31">-# include &quot;modules&#47;recovery&#47;tests_impl.h&quot;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-int main(int argc, char **argv) {</span>
<span class="term-fg31">-    unsigned char seed16[16] = {0};</span>
<span class="term-fg31">-    unsigned char run32[32] = {0};</span>
<span class="term-fg31">-    &#47;* find iteration count *&#47;</span>
<span class="term-fg31">-    if (argc &gt; 1) {</span>
<span class="term-fg31">-        count = strtol(argv[1], NULL, 0);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* find random seed *&#47;</span>
<span class="term-fg31">-    if (argc &gt; 2) {</span>
<span class="term-fg31">-        int pos = 0;</span>
<span class="term-fg31">-        const char* ch = argv[2];</span>
<span class="term-fg31">-        while (pos &lt; 16 &amp;&amp; ch[0] != 0 &amp;&amp; ch[1] != 0) {</span>
<span class="term-fg31">-            unsigned short sh;</span>
<span class="term-fg31">-            if (sscanf(ch, &quot;%2hx&quot;, &amp;sh)) {</span>
<span class="term-fg31">-                seed16[pos] = sh;</span>
<span class="term-fg31">-            } else {</span>
<span class="term-fg31">-                break;</span>
<span class="term-fg31">-            }</span>
<span class="term-fg31">-            ch += 2;</span>
<span class="term-fg31">-            pos++;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    } else {</span>
<span class="term-fg31">-        FILE *frand = fopen(&quot;&#47;dev&#47;urandom&quot;, &quot;r&quot;);</span>
<span class="term-fg31">-        if ((frand == NULL) || !fread(&amp;seed16, sizeof(seed16), 1, frand)) {</span>
<span class="term-fg31">-            uint64_t t = time(NULL) * (uint64_t)1337;</span>
<span class="term-fg31">-            seed16[0] ^= t;</span>
<span class="term-fg31">-            seed16[1] ^= t &gt;&gt; 8;</span>
<span class="term-fg31">-            seed16[2] ^= t &gt;&gt; 16;</span>
<span class="term-fg31">-            seed16[3] ^= t &gt;&gt; 24;</span>
<span class="term-fg31">-            seed16[4] ^= t &gt;&gt; 32;</span>
<span class="term-fg31">-            seed16[5] ^= t &gt;&gt; 40;</span>
<span class="term-fg31">-            seed16[6] ^= t &gt;&gt; 48;</span>
<span class="term-fg31">-            seed16[7] ^= t &gt;&gt; 56;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        fclose(frand);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_rand_seed(seed16);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    printf(&quot;test count = %i\n&quot;, count);</span>
<span class="term-fg31">-    printf(&quot;random seed = %02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x\n&quot;, seed16[0], seed16[1], seed16[2], seed16[3], seed16[4], seed16[5], seed16[6], seed16[7], seed16[8], seed16[9], seed16[10], seed16[11], seed16[12], seed16[13], seed16[14], seed16[15]);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* initialize *&#47;</span>
<span class="term-fg31">-    run_context_tests();</span>
<span class="term-fg31">-    ctx = secp256k1_context_create(SECP256K1_CONTEXT_SIGN | SECP256K1_CONTEXT_VERIFY);</span>
<span class="term-fg31">-    if (secp256k1_rand_bits(1)) {</span>
<span class="term-fg31">-        secp256k1_rand256(run32);</span>
<span class="term-fg31">-        CHECK(secp256k1_context_randomize(ctx, secp256k1_rand_bits(1) ? run32 : NULL));</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    run_rand_bits();</span>
<span class="term-fg31">-    run_rand_int();</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    run_sha256_tests();</span>
<span class="term-fg31">-    run_hmac_sha256_tests();</span>
<span class="term-fg31">-    run_rfc6979_hmac_sha256_tests();</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef USE_NUM_NONE</span>
<span class="term-fg31">-    &#47;* num tests *&#47;</span>
<span class="term-fg31">-    run_num_smalltests();</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* scalar tests *&#47;</span>
<span class="term-fg31">-    run_scalar_tests();</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* field tests *&#47;</span>
<span class="term-fg31">-    run_field_inv();</span>
<span class="term-fg31">-    run_field_inv_var();</span>
<span class="term-fg31">-    run_field_inv_all_var();</span>
<span class="term-fg31">-    run_field_misc();</span>
<span class="term-fg31">-    run_field_convert();</span>
<span class="term-fg31">-    run_sqr();</span>
<span class="term-fg31">-    run_sqrt();</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* group tests *&#47;</span>
<span class="term-fg31">-    run_ge();</span>
<span class="term-fg31">-    run_group_decompress();</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* ecmult tests *&#47;</span>
<span class="term-fg31">-    run_wnaf();</span>
<span class="term-fg31">-    run_point_times_order();</span>
<span class="term-fg31">-    run_ecmult_chain();</span>
<span class="term-fg31">-    run_ecmult_constants();</span>
<span class="term-fg31">-    run_ecmult_gen_blind();</span>
<span class="term-fg31">-    run_ecmult_const_tests();</span>
<span class="term-fg31">-    run_ec_combine();</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* endomorphism tests *&#47;</span>
<span class="term-fg31">-#ifdef USE_ENDOMORPHISM</span>
<span class="term-fg31">-    run_endomorphism_tests();</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* EC point parser test *&#47;</span>
<span class="term-fg31">-    run_ec_pubkey_parse_test();</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* EC key edge cases *&#47;</span>
<span class="term-fg31">-    run_eckey_edge_case_test();</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef ENABLE_MODULE_ECDH</span>
<span class="term-fg31">-    &#47;* ecdh tests *&#47;</span>
<span class="term-fg31">-    run_ecdh_tests();</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* ecdsa tests *&#47;</span>
<span class="term-fg31">-    run_random_pubkeys();</span>
<span class="term-fg31">-    run_ecdsa_der_parse();</span>
<span class="term-fg31">-    run_ecdsa_sign_verify();</span>
<span class="term-fg31">-    run_ecdsa_end_to_end();</span>
<span class="term-fg31">-    run_ecdsa_edge_cases();</span>
<span class="term-fg31">-#ifdef ENABLE_OPENSSL_TESTS</span>
<span class="term-fg31">-    run_ecdsa_openssl();</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef ENABLE_MODULE_SCHNORR</span>
<span class="term-fg31">-    &#47;* Schnorr tests *&#47;</span>
<span class="term-fg31">-    run_schnorr_tests();</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef ENABLE_MODULE_RECOVERY</span>
<span class="term-fg31">-    &#47;* ECDSA pubkey recovery tests *&#47;</span>
<span class="term-fg31">-    run_recovery_tests();</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_rand256(run32);</span>
<span class="term-fg31">-    printf(&quot;random run = %02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x\n&quot;, run32[0], run32[1], run32[2], run32[3], run32[4], run32[5], run32[6], run32[7], run32[8], run32[9], run32[10], run32[11], run32[12], run32[13], run32[14], run32[15]);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* shutdown *&#47;</span>
<span class="term-fg31">-    secp256k1_context_destroy(ctx);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    printf(&quot;no problems found\n&quot;);</span>
<span class="term-fg31">-    return 0;</span>
<span class="term-fg31">-}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-cb678f4c4901438b2cf639a6" role="button"
                       aria-expanded="false" aria-controls="id-cb678f4c4901438b2cf639a6">
                        <code>crypto/secp256k1/libsecp256k1/src/tests_exhaustive.c</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/tests_exhaustive.c" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-470</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-cb678f4c4901438b2cf639a6"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;tests_exhaustive.c op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;tests_exhaustive.c</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index b040bb0733ddf1abef0b715b807d3133db37d2f8..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;tests_exhaustive.c</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,470 +0,0 @@</span>
<span class="term-fg31">-&#47;***********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2016 Andrew Poelstra                                 *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#if defined HAVE_CONFIG_H</span>
<span class="term-fg31">-#include &quot;libsecp256k1-config.h&quot;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &lt;stdio.h&gt;</span>
<span class="term-fg31">-#include &lt;stdlib.h&gt;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &lt;time.h&gt;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#undef USE_ECMULT_STATIC_PRECOMPUTATION</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef EXHAUSTIVE_TEST_ORDER</span>
<span class="term-fg31">-&#47;* see group_impl.h for allowable values *&#47;</span>
<span class="term-fg31">-#define EXHAUSTIVE_TEST_ORDER 13</span>
<span class="term-fg31">-#define EXHAUSTIVE_TEST_LAMBDA 9   &#47;* cube root of 1 mod 13 *&#47;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &quot;include&#47;secp256k1.h&quot;</span>
<span class="term-fg31">-#include &quot;group.h&quot;</span>
<span class="term-fg31">-#include &quot;secp256k1.c&quot;</span>
<span class="term-fg31">-#include &quot;testrand_impl.h&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef ENABLE_MODULE_RECOVERY</span>
<span class="term-fg31">-#include &quot;src&#47;modules&#47;recovery&#47;main_impl.h&quot;</span>
<span class="term-fg31">-#include &quot;include&#47;secp256k1_recovery.h&quot;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;** stolen from tests.c *&#47;</span>
<span class="term-fg31">-void ge_equals_ge(const secp256k1_ge *a, const secp256k1_ge *b) {</span>
<span class="term-fg31">-    CHECK(a-&gt;infinity == b-&gt;infinity);</span>
<span class="term-fg31">-    if (a-&gt;infinity) {</span>
<span class="term-fg31">-        return;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    CHECK(secp256k1_fe_equal_var(&amp;a-&gt;x, &amp;b-&gt;x));</span>
<span class="term-fg31">-    CHECK(secp256k1_fe_equal_var(&amp;a-&gt;y, &amp;b-&gt;y));</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void ge_equals_gej(const secp256k1_ge *a, const secp256k1_gej *b) {</span>
<span class="term-fg31">-    secp256k1_fe z2s;</span>
<span class="term-fg31">-    secp256k1_fe u1, u2, s1, s2;</span>
<span class="term-fg31">-    CHECK(a-&gt;infinity == b-&gt;infinity);</span>
<span class="term-fg31">-    if (a-&gt;infinity) {</span>
<span class="term-fg31">-        return;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    &#47;* Check a.x * b.z^2 == b.x &amp;&amp; a.y * b.z^3 == b.y, to avoid inverses. *&#47;</span>
<span class="term-fg31">-    secp256k1_fe_sqr(&amp;z2s, &amp;b-&gt;z);</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;u1, &amp;a-&gt;x, &amp;z2s);</span>
<span class="term-fg31">-    u2 = b-&gt;x; secp256k1_fe_normalize_weak(&amp;u2);</span>
<span class="term-fg31">-    secp256k1_fe_mul(&amp;s1, &amp;a-&gt;y, &amp;z2s); secp256k1_fe_mul(&amp;s1, &amp;s1, &amp;b-&gt;z);</span>
<span class="term-fg31">-    s2 = b-&gt;y; secp256k1_fe_normalize_weak(&amp;s2);</span>
<span class="term-fg31">-    CHECK(secp256k1_fe_equal_var(&amp;u1, &amp;u2));</span>
<span class="term-fg31">-    CHECK(secp256k1_fe_equal_var(&amp;s1, &amp;s2));</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void random_fe(secp256k1_fe *x) {</span>
<span class="term-fg31">-    unsigned char bin[32];</span>
<span class="term-fg31">-    do {</span>
<span class="term-fg31">-        secp256k1_rand256(bin);</span>
<span class="term-fg31">-        if (secp256k1_fe_set_b32(x, bin)) {</span>
<span class="term-fg31">-            return;</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    } while(1);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-&#47;** END stolen from tests.c *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-int secp256k1_nonce_function_smallint(unsigned char *nonce32, const unsigned char *msg32,</span>
<span class="term-fg31">-                                      const unsigned char *key32, const unsigned char *algo16,</span>
<span class="term-fg31">-                                      void *data, unsigned int attempt) {</span>
<span class="term-fg31">-    secp256k1_scalar s;</span>
<span class="term-fg31">-    int *idata = data;</span>
<span class="term-fg31">-    (void)msg32;</span>
<span class="term-fg31">-    (void)key32;</span>
<span class="term-fg31">-    (void)algo16;</span>
<span class="term-fg31">-    &#47;* Some nonces cannot be used because they&#39;d cause s and&#47;or r to be zero.</span>
<span class="term-fg31">-     * The signing function has retry logic here that just re-calls the nonce</span>
<span class="term-fg31">-     * function with an increased `attempt`. So if attempt &gt; 0 this means we</span>
<span class="term-fg31">-     * need to change the nonce to avoid an infinite loop. *&#47;</span>
<span class="term-fg31">-    if (attempt &gt; 0) {</span>
<span class="term-fg31">-        *idata = (*idata + 1) % EXHAUSTIVE_TEST_ORDER;</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    secp256k1_scalar_set_int(&amp;s, *idata);</span>
<span class="term-fg31">-    secp256k1_scalar_get_b32(nonce32, &amp;s);</span>
<span class="term-fg31">-    return 1;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef USE_ENDOMORPHISM</span>
<span class="term-fg31">-void test_exhaustive_endomorphism(const secp256k1_ge *group, int order) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    for (i = 0; i &lt; order; i++) {</span>
<span class="term-fg31">-        secp256k1_ge res;</span>
<span class="term-fg31">-        secp256k1_ge_mul_lambda(&amp;res, &amp;group[i]);</span>
<span class="term-fg31">-        ge_equals_ge(&amp;group[i * EXHAUSTIVE_TEST_LAMBDA % EXHAUSTIVE_TEST_ORDER], &amp;res);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void test_exhaustive_addition(const secp256k1_ge *group, const secp256k1_gej *groupj, int order) {</span>
<span class="term-fg31">-    int i, j;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Sanity-check (and check infinity functions) *&#47;</span>
<span class="term-fg31">-    CHECK(secp256k1_ge_is_infinity(&amp;group[0]));</span>
<span class="term-fg31">-    CHECK(secp256k1_gej_is_infinity(&amp;groupj[0]));</span>
<span class="term-fg31">-    for (i = 1; i &lt; order; i++) {</span>
<span class="term-fg31">-        CHECK(!secp256k1_ge_is_infinity(&amp;group[i]));</span>
<span class="term-fg31">-        CHECK(!secp256k1_gej_is_infinity(&amp;groupj[i]));</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Check all addition formulae *&#47;</span>
<span class="term-fg31">-    for (j = 0; j &lt; order; j++) {</span>
<span class="term-fg31">-        secp256k1_fe fe_inv;</span>
<span class="term-fg31">-        secp256k1_fe_inv(&amp;fe_inv, &amp;groupj[j].z);</span>
<span class="term-fg31">-        for (i = 0; i &lt; order; i++) {</span>
<span class="term-fg31">-            secp256k1_ge zless_gej;</span>
<span class="term-fg31">-            secp256k1_gej tmp;</span>
<span class="term-fg31">-            &#47;* add_var *&#47;</span>
<span class="term-fg31">-            secp256k1_gej_add_var(&amp;tmp, &amp;groupj[i], &amp;groupj[j], NULL);</span>
<span class="term-fg31">-            ge_equals_gej(&amp;group[(i + j) % order], &amp;tmp);</span>
<span class="term-fg31">-            &#47;* add_ge *&#47;</span>
<span class="term-fg31">-            if (j &gt; 0) {</span>
<span class="term-fg31">-                secp256k1_gej_add_ge(&amp;tmp, &amp;groupj[i], &amp;group[j]);</span>
<span class="term-fg31">-                ge_equals_gej(&amp;group[(i + j) % order], &amp;tmp);</span>
<span class="term-fg31">-            }</span>
<span class="term-fg31">-            &#47;* add_ge_var *&#47;</span>
<span class="term-fg31">-            secp256k1_gej_add_ge_var(&amp;tmp, &amp;groupj[i], &amp;group[j], NULL);</span>
<span class="term-fg31">-            ge_equals_gej(&amp;group[(i + j) % order], &amp;tmp);</span>
<span class="term-fg31">-            &#47;* add_zinv_var *&#47;</span>
<span class="term-fg31">-            zless_gej.infinity = groupj[j].infinity;</span>
<span class="term-fg31">-            zless_gej.x = groupj[j].x;</span>
<span class="term-fg31">-            zless_gej.y = groupj[j].y;</span>
<span class="term-fg31">-            secp256k1_gej_add_zinv_var(&amp;tmp, &amp;groupj[i], &amp;zless_gej, &amp;fe_inv);</span>
<span class="term-fg31">-            ge_equals_gej(&amp;group[(i + j) % order], &amp;tmp);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Check doubling *&#47;</span>
<span class="term-fg31">-    for (i = 0; i &lt; order; i++) {</span>
<span class="term-fg31">-        secp256k1_gej tmp;</span>
<span class="term-fg31">-        if (i &gt; 0) {</span>
<span class="term-fg31">-            secp256k1_gej_double_nonzero(&amp;tmp, &amp;groupj[i], NULL);</span>
<span class="term-fg31">-            ge_equals_gej(&amp;group[(2 * i) % order], &amp;tmp);</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-        secp256k1_gej_double_var(&amp;tmp, &amp;groupj[i], NULL);</span>
<span class="term-fg31">-        ge_equals_gej(&amp;group[(2 * i) % order], &amp;tmp);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Check negation *&#47;</span>
<span class="term-fg31">-    for (i = 1; i &lt; order; i++) {</span>
<span class="term-fg31">-        secp256k1_ge tmp;</span>
<span class="term-fg31">-        secp256k1_gej tmpj;</span>
<span class="term-fg31">-        secp256k1_ge_neg(&amp;tmp, &amp;group[i]);</span>
<span class="term-fg31">-        ge_equals_ge(&amp;group[order - i], &amp;tmp);</span>
<span class="term-fg31">-        secp256k1_gej_neg(&amp;tmpj, &amp;groupj[i]);</span>
<span class="term-fg31">-        ge_equals_gej(&amp;group[order - i], &amp;tmpj);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void test_exhaustive_ecmult(const secp256k1_context *ctx, const secp256k1_ge *group, const secp256k1_gej *groupj, int order) {</span>
<span class="term-fg31">-    int i, j, r_log;</span>
<span class="term-fg31">-    for (r_log = 1; r_log &lt; order; r_log++) {</span>
<span class="term-fg31">-        for (j = 0; j &lt; order; j++) {</span>
<span class="term-fg31">-            for (i = 0; i &lt; order; i++) {</span>
<span class="term-fg31">-                secp256k1_gej tmp;</span>
<span class="term-fg31">-                secp256k1_scalar na, ng;</span>
<span class="term-fg31">-                secp256k1_scalar_set_int(&amp;na, i);</span>
<span class="term-fg31">-                secp256k1_scalar_set_int(&amp;ng, j);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-                secp256k1_ecmult(&amp;ctx-&gt;ecmult_ctx, &amp;tmp, &amp;groupj[r_log], &amp;na, &amp;ng);</span>
<span class="term-fg31">-                ge_equals_gej(&amp;group[(i * r_log + j) % order], &amp;tmp);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-                if (i &gt; 0) {</span>
<span class="term-fg31">-                    secp256k1_ecmult_const(&amp;tmp, &amp;group[i], &amp;ng);</span>
<span class="term-fg31">-                    ge_equals_gej(&amp;group[(i * j) % order], &amp;tmp);</span>
<span class="term-fg31">-                }</span>
<span class="term-fg31">-            }</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void r_from_k(secp256k1_scalar *r, const secp256k1_ge *group, int k) {</span>
<span class="term-fg31">-    secp256k1_fe x;</span>
<span class="term-fg31">-    unsigned char x_bin[32];</span>
<span class="term-fg31">-    k %= EXHAUSTIVE_TEST_ORDER;</span>
<span class="term-fg31">-    x = group[k].x;</span>
<span class="term-fg31">-    secp256k1_fe_normalize(&amp;x);</span>
<span class="term-fg31">-    secp256k1_fe_get_b32(x_bin, &amp;x);</span>
<span class="term-fg31">-    secp256k1_scalar_set_b32(r, x_bin, NULL);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void test_exhaustive_verify(const secp256k1_context *ctx, const secp256k1_ge *group, int order) {</span>
<span class="term-fg31">-    int s, r, msg, key;</span>
<span class="term-fg31">-    for (s = 1; s &lt; order; s++) {</span>
<span class="term-fg31">-        for (r = 1; r &lt; order; r++) {</span>
<span class="term-fg31">-            for (msg = 1; msg &lt; order; msg++) {</span>
<span class="term-fg31">-                for (key = 1; key &lt; order; key++) {</span>
<span class="term-fg31">-                    secp256k1_ge nonconst_ge;</span>
<span class="term-fg31">-                    secp256k1_ecdsa_signature sig;</span>
<span class="term-fg31">-                    secp256k1_pubkey pk;</span>
<span class="term-fg31">-                    secp256k1_scalar sk_s, msg_s, r_s, s_s;</span>
<span class="term-fg31">-                    secp256k1_scalar s_times_k_s, msg_plus_r_times_sk_s;</span>
<span class="term-fg31">-                    int k, should_verify;</span>
<span class="term-fg31">-                    unsigned char msg32[32];</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-                    secp256k1_scalar_set_int(&amp;s_s, s);</span>
<span class="term-fg31">-                    secp256k1_scalar_set_int(&amp;r_s, r);</span>
<span class="term-fg31">-                    secp256k1_scalar_set_int(&amp;msg_s, msg);</span>
<span class="term-fg31">-                    secp256k1_scalar_set_int(&amp;sk_s, key);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-                    &#47;* Verify by hand *&#47;</span>
<span class="term-fg31">-                    &#47;* Run through every k value that gives us this r and check that *one* works.</span>
<span class="term-fg31">-                     * Note there could be none, there could be multiple, ECDSA is weird. *&#47;</span>
<span class="term-fg31">-                    should_verify = 0;</span>
<span class="term-fg31">-                    for (k = 0; k &lt; order; k++) {</span>
<span class="term-fg31">-                        secp256k1_scalar check_x_s;</span>
<span class="term-fg31">-                        r_from_k(&amp;check_x_s, group, k);</span>
<span class="term-fg31">-                        if (r_s == check_x_s) {</span>
<span class="term-fg31">-                            secp256k1_scalar_set_int(&amp;s_times_k_s, k);</span>
<span class="term-fg31">-                            secp256k1_scalar_mul(&amp;s_times_k_s, &amp;s_times_k_s, &amp;s_s);</span>
<span class="term-fg31">-                            secp256k1_scalar_mul(&amp;msg_plus_r_times_sk_s, &amp;r_s, &amp;sk_s);</span>
<span class="term-fg31">-                            secp256k1_scalar_add(&amp;msg_plus_r_times_sk_s, &amp;msg_plus_r_times_sk_s, &amp;msg_s);</span>
<span class="term-fg31">-                            should_verify |= secp256k1_scalar_eq(&amp;s_times_k_s, &amp;msg_plus_r_times_sk_s);</span>
<span class="term-fg31">-                        }</span>
<span class="term-fg31">-                    }</span>
<span class="term-fg31">-                    &#47;* nb we have a &quot;high s&quot; rule *&#47;</span>
<span class="term-fg31">-                    should_verify &amp;= !secp256k1_scalar_is_high(&amp;s_s);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-                    &#47;* Verify by calling verify *&#47;</span>
<span class="term-fg31">-                    secp256k1_ecdsa_signature_save(&amp;sig, &amp;r_s, &amp;s_s);</span>
<span class="term-fg31">-                    memcpy(&amp;nonconst_ge, &amp;group[sk_s], sizeof(nonconst_ge));</span>
<span class="term-fg31">-                    secp256k1_pubkey_save(&amp;pk, &amp;nonconst_ge);</span>
<span class="term-fg31">-                    secp256k1_scalar_get_b32(msg32, &amp;msg_s);</span>
<span class="term-fg31">-                    CHECK(should_verify ==</span>
<span class="term-fg31">-                          secp256k1_ecdsa_verify(ctx, &amp;sig, msg32, &amp;pk));</span>
<span class="term-fg31">-                }</span>
<span class="term-fg31">-            }</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void test_exhaustive_sign(const secp256k1_context *ctx, const secp256k1_ge *group, int order) {</span>
<span class="term-fg31">-    int i, j, k;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Loop *&#47;</span>
<span class="term-fg31">-    for (i = 1; i &lt; order; i++) {  &#47;* message *&#47;</span>
<span class="term-fg31">-        for (j = 1; j &lt; order; j++) {  &#47;* key *&#47;</span>
<span class="term-fg31">-            for (k = 1; k &lt; order; k++) {  &#47;* nonce *&#47;</span>
<span class="term-fg31">-                const int starting_k = k;</span>
<span class="term-fg31">-                secp256k1_ecdsa_signature sig;</span>
<span class="term-fg31">-                secp256k1_scalar sk, msg, r, s, expected_r;</span>
<span class="term-fg31">-                unsigned char sk32[32], msg32[32];</span>
<span class="term-fg31">-                secp256k1_scalar_set_int(&amp;msg, i);</span>
<span class="term-fg31">-                secp256k1_scalar_set_int(&amp;sk, j);</span>
<span class="term-fg31">-                secp256k1_scalar_get_b32(sk32, &amp;sk);</span>
<span class="term-fg31">-                secp256k1_scalar_get_b32(msg32, &amp;msg);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-                secp256k1_ecdsa_sign(ctx, &amp;sig, msg32, sk32, secp256k1_nonce_function_smallint, &amp;k);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-                secp256k1_ecdsa_signature_load(ctx, &amp;r, &amp;s, &amp;sig);</span>
<span class="term-fg31">-                &#47;* Note that we compute expected_r *after* signing -- this is important</span>
<span class="term-fg31">-                 * because our nonce-computing function function might change k during</span>
<span class="term-fg31">-                 * signing. *&#47;</span>
<span class="term-fg31">-                r_from_k(&amp;expected_r, group, k);</span>
<span class="term-fg31">-                CHECK(r == expected_r);</span>
<span class="term-fg31">-                CHECK((k * s) % order == (i + r * j) % order ||</span>
<span class="term-fg31">-                      (k * (EXHAUSTIVE_TEST_ORDER - s)) % order == (i + r * j) % order);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-                &#47;* Overflow means we&#39;ve tried every possible nonce *&#47;</span>
<span class="term-fg31">-                if (k &lt; starting_k) {</span>
<span class="term-fg31">-                    break;</span>
<span class="term-fg31">-                }</span>
<span class="term-fg31">-            }</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* We would like to verify zero-knowledge here by counting how often every</span>
<span class="term-fg31">-     * possible (s, r) tuple appears, but because the group order is larger</span>
<span class="term-fg31">-     * than the field order, when coercing the x-values to scalar values, some</span>
<span class="term-fg31">-     * appear more often than others, so we are actually not zero-knowledge.</span>
<span class="term-fg31">-     * (This effect also appears in the real code, but the difference is on the</span>
<span class="term-fg31">-     * order of 1&#47;2^128th the field order, so the deviation is not useful to a</span>
<span class="term-fg31">-     * computationally bounded attacker.)</span>
<span class="term-fg31">-     *&#47;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef ENABLE_MODULE_RECOVERY</span>
<span class="term-fg31">-void test_exhaustive_recovery_sign(const secp256k1_context *ctx, const secp256k1_ge *group, int order) {</span>
<span class="term-fg31">-    int i, j, k;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Loop *&#47;</span>
<span class="term-fg31">-    for (i = 1; i &lt; order; i++) {  &#47;* message *&#47;</span>
<span class="term-fg31">-        for (j = 1; j &lt; order; j++) {  &#47;* key *&#47;</span>
<span class="term-fg31">-            for (k = 1; k &lt; order; k++) {  &#47;* nonce *&#47;</span>
<span class="term-fg31">-                const int starting_k = k;</span>
<span class="term-fg31">-                secp256k1_fe r_dot_y_normalized;</span>
<span class="term-fg31">-                secp256k1_ecdsa_recoverable_signature rsig;</span>
<span class="term-fg31">-                secp256k1_ecdsa_signature sig;</span>
<span class="term-fg31">-                secp256k1_scalar sk, msg, r, s, expected_r;</span>
<span class="term-fg31">-                unsigned char sk32[32], msg32[32];</span>
<span class="term-fg31">-                int expected_recid;</span>
<span class="term-fg31">-                int recid;</span>
<span class="term-fg31">-                secp256k1_scalar_set_int(&amp;msg, i);</span>
<span class="term-fg31">-                secp256k1_scalar_set_int(&amp;sk, j);</span>
<span class="term-fg31">-                secp256k1_scalar_get_b32(sk32, &amp;sk);</span>
<span class="term-fg31">-                secp256k1_scalar_get_b32(msg32, &amp;msg);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-                secp256k1_ecdsa_sign_recoverable(ctx, &amp;rsig, msg32, sk32, secp256k1_nonce_function_smallint, &amp;k);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-                &#47;* Check directly *&#47;</span>
<span class="term-fg31">-                secp256k1_ecdsa_recoverable_signature_load(ctx, &amp;r, &amp;s, &amp;recid, &amp;rsig);</span>
<span class="term-fg31">-                r_from_k(&amp;expected_r, group, k);</span>
<span class="term-fg31">-                CHECK(r == expected_r);</span>
<span class="term-fg31">-                CHECK((k * s) % order == (i + r * j) % order ||</span>
<span class="term-fg31">-                      (k * (EXHAUSTIVE_TEST_ORDER - s)) % order == (i + r * j) % order);</span>
<span class="term-fg31">-                &#47;* In computing the recid, there is an overflow condition that is disabled in</span>
<span class="term-fg31">-                 * scalar_low_impl.h `secp256k1_scalar_set_b32` because almost every r.y value</span>
<span class="term-fg31">-                 * will exceed the group order, and our signing code always holds out for r</span>
<span class="term-fg31">-                 * values that don&#39;t overflow, so with a proper overflow check the tests would</span>
<span class="term-fg31">-                 * loop indefinitely. *&#47;</span>
<span class="term-fg31">-                r_dot_y_normalized = group[k].y;</span>
<span class="term-fg31">-                secp256k1_fe_normalize(&amp;r_dot_y_normalized);</span>
<span class="term-fg31">-                &#47;* Also the recovery id is flipped depending if we hit the low-s branch *&#47;</span>
<span class="term-fg31">-                if ((k * s) % order == (i + r * j) % order) {</span>
<span class="term-fg31">-                    expected_recid = secp256k1_fe_is_odd(&amp;r_dot_y_normalized) ? 1 : 0;</span>
<span class="term-fg31">-                } else {</span>
<span class="term-fg31">-                    expected_recid = secp256k1_fe_is_odd(&amp;r_dot_y_normalized) ? 0 : 1;</span>
<span class="term-fg31">-                }</span>
<span class="term-fg31">-                CHECK(recid == expected_recid);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-                &#47;* Convert to a standard sig then check *&#47;</span>
<span class="term-fg31">-                secp256k1_ecdsa_recoverable_signature_convert(ctx, &amp;sig, &amp;rsig);</span>
<span class="term-fg31">-                secp256k1_ecdsa_signature_load(ctx, &amp;r, &amp;s, &amp;sig);</span>
<span class="term-fg31">-                &#47;* Note that we compute expected_r *after* signing -- this is important</span>
<span class="term-fg31">-                 * because our nonce-computing function function might change k during</span>
<span class="term-fg31">-                 * signing. *&#47;</span>
<span class="term-fg31">-                r_from_k(&amp;expected_r, group, k);</span>
<span class="term-fg31">-                CHECK(r == expected_r);</span>
<span class="term-fg31">-                CHECK((k * s) % order == (i + r * j) % order ||</span>
<span class="term-fg31">-                      (k * (EXHAUSTIVE_TEST_ORDER - s)) % order == (i + r * j) % order);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-                &#47;* Overflow means we&#39;ve tried every possible nonce *&#47;</span>
<span class="term-fg31">-                if (k &lt; starting_k) {</span>
<span class="term-fg31">-                    break;</span>
<span class="term-fg31">-                }</span>
<span class="term-fg31">-            }</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-void test_exhaustive_recovery_verify(const secp256k1_context *ctx, const secp256k1_ge *group, int order) {</span>
<span class="term-fg31">-    &#47;* This is essentially a copy of test_exhaustive_verify, with recovery added *&#47;</span>
<span class="term-fg31">-    int s, r, msg, key;</span>
<span class="term-fg31">-    for (s = 1; s &lt; order; s++) {</span>
<span class="term-fg31">-        for (r = 1; r &lt; order; r++) {</span>
<span class="term-fg31">-            for (msg = 1; msg &lt; order; msg++) {</span>
<span class="term-fg31">-                for (key = 1; key &lt; order; key++) {</span>
<span class="term-fg31">-                    secp256k1_ge nonconst_ge;</span>
<span class="term-fg31">-                    secp256k1_ecdsa_recoverable_signature rsig;</span>
<span class="term-fg31">-                    secp256k1_ecdsa_signature sig;</span>
<span class="term-fg31">-                    secp256k1_pubkey pk;</span>
<span class="term-fg31">-                    secp256k1_scalar sk_s, msg_s, r_s, s_s;</span>
<span class="term-fg31">-                    secp256k1_scalar s_times_k_s, msg_plus_r_times_sk_s;</span>
<span class="term-fg31">-                    int recid = 0;</span>
<span class="term-fg31">-                    int k, should_verify;</span>
<span class="term-fg31">-                    unsigned char msg32[32];</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-                    secp256k1_scalar_set_int(&amp;s_s, s);</span>
<span class="term-fg31">-                    secp256k1_scalar_set_int(&amp;r_s, r);</span>
<span class="term-fg31">-                    secp256k1_scalar_set_int(&amp;msg_s, msg);</span>
<span class="term-fg31">-                    secp256k1_scalar_set_int(&amp;sk_s, key);</span>
<span class="term-fg31">-                    secp256k1_scalar_get_b32(msg32, &amp;msg_s);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-                    &#47;* Verify by hand *&#47;</span>
<span class="term-fg31">-                    &#47;* Run through every k value that gives us this r and check that *one* works.</span>
<span class="term-fg31">-                     * Note there could be none, there could be multiple, ECDSA is weird. *&#47;</span>
<span class="term-fg31">-                    should_verify = 0;</span>
<span class="term-fg31">-                    for (k = 0; k &lt; order; k++) {</span>
<span class="term-fg31">-                        secp256k1_scalar check_x_s;</span>
<span class="term-fg31">-                        r_from_k(&amp;check_x_s, group, k);</span>
<span class="term-fg31">-                        if (r_s == check_x_s) {</span>
<span class="term-fg31">-                            secp256k1_scalar_set_int(&amp;s_times_k_s, k);</span>
<span class="term-fg31">-                            secp256k1_scalar_mul(&amp;s_times_k_s, &amp;s_times_k_s, &amp;s_s);</span>
<span class="term-fg31">-                            secp256k1_scalar_mul(&amp;msg_plus_r_times_sk_s, &amp;r_s, &amp;sk_s);</span>
<span class="term-fg31">-                            secp256k1_scalar_add(&amp;msg_plus_r_times_sk_s, &amp;msg_plus_r_times_sk_s, &amp;msg_s);</span>
<span class="term-fg31">-                            should_verify |= secp256k1_scalar_eq(&amp;s_times_k_s, &amp;msg_plus_r_times_sk_s);</span>
<span class="term-fg31">-                        }</span>
<span class="term-fg31">-                    }</span>
<span class="term-fg31">-                    &#47;* nb we have a &quot;high s&quot; rule *&#47;</span>
<span class="term-fg31">-                    should_verify &amp;= !secp256k1_scalar_is_high(&amp;s_s);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-                    &#47;* We would like to try recovering the pubkey and checking that it matches,</span>
<span class="term-fg31">-                     * but pubkey recovery is impossible in the exhaustive tests (the reason</span>
<span class="term-fg31">-                     * being that there are 12 nonzero r values, 12 nonzero points, and no</span>
<span class="term-fg31">-                     * overlap between the sets, so there are no valid signatures). *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-                    &#47;* Verify by converting to a standard signature and calling verify *&#47;</span>
<span class="term-fg31">-                    secp256k1_ecdsa_recoverable_signature_save(&amp;rsig, &amp;r_s, &amp;s_s, recid);</span>
<span class="term-fg31">-                    secp256k1_ecdsa_recoverable_signature_convert(ctx, &amp;sig, &amp;rsig);</span>
<span class="term-fg31">-                    memcpy(&amp;nonconst_ge, &amp;group[sk_s], sizeof(nonconst_ge));</span>
<span class="term-fg31">-                    secp256k1_pubkey_save(&amp;pk, &amp;nonconst_ge);</span>
<span class="term-fg31">-                    CHECK(should_verify ==</span>
<span class="term-fg31">-                          secp256k1_ecdsa_verify(ctx, &amp;sig, msg32, &amp;pk));</span>
<span class="term-fg31">-                }</span>
<span class="term-fg31">-            }</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-int main(void) {</span>
<span class="term-fg31">-    int i;</span>
<span class="term-fg31">-    secp256k1_gej groupj[EXHAUSTIVE_TEST_ORDER];</span>
<span class="term-fg31">-    secp256k1_ge group[EXHAUSTIVE_TEST_ORDER];</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Build context *&#47;</span>
<span class="term-fg31">-    secp256k1_context *ctx = secp256k1_context_create(SECP256K1_CONTEXT_SIGN | SECP256K1_CONTEXT_VERIFY);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* TODO set z = 1, then do num_tests runs with random z values *&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Generate the entire group *&#47;</span>
<span class="term-fg31">-    secp256k1_gej_set_infinity(&amp;groupj[0]);</span>
<span class="term-fg31">-    secp256k1_ge_set_gej(&amp;group[0], &amp;groupj[0]);</span>
<span class="term-fg31">-    for (i = 1; i &lt; EXHAUSTIVE_TEST_ORDER; i++) {</span>
<span class="term-fg31">-        &#47;* Set a different random z-value for each Jacobian point *&#47;</span>
<span class="term-fg31">-        secp256k1_fe z;</span>
<span class="term-fg31">-        random_fe(&amp;z);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        secp256k1_gej_add_ge(&amp;groupj[i], &amp;groupj[i - 1], &amp;secp256k1_ge_const_g);</span>
<span class="term-fg31">-        secp256k1_ge_set_gej(&amp;group[i], &amp;groupj[i]);</span>
<span class="term-fg31">-        secp256k1_gej_rescale(&amp;groupj[i], &amp;z);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-        &#47;* Verify against ecmult_gen *&#47;</span>
<span class="term-fg31">-        {</span>
<span class="term-fg31">-            secp256k1_scalar scalar_i;</span>
<span class="term-fg31">-            secp256k1_gej generatedj;</span>
<span class="term-fg31">-            secp256k1_ge generated;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-            secp256k1_scalar_set_int(&amp;scalar_i, i);</span>
<span class="term-fg31">-            secp256k1_ecmult_gen(&amp;ctx-&gt;ecmult_gen_ctx, &amp;generatedj, &amp;scalar_i);</span>
<span class="term-fg31">-            secp256k1_ge_set_gej(&amp;generated, &amp;generatedj);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-            CHECK(group[i].infinity == 0);</span>
<span class="term-fg31">-            CHECK(generated.infinity == 0);</span>
<span class="term-fg31">-            CHECK(secp256k1_fe_equal_var(&amp;generated.x, &amp;group[i].x));</span>
<span class="term-fg31">-            CHECK(secp256k1_fe_equal_var(&amp;generated.y, &amp;group[i].y));</span>
<span class="term-fg31">-        }</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    &#47;* Run the tests *&#47;</span>
<span class="term-fg31">-#ifdef USE_ENDOMORPHISM</span>
<span class="term-fg31">-    test_exhaustive_endomorphism(group, EXHAUSTIVE_TEST_ORDER);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-    test_exhaustive_addition(group, groupj, EXHAUSTIVE_TEST_ORDER);</span>
<span class="term-fg31">-    test_exhaustive_ecmult(ctx, group, groupj, EXHAUSTIVE_TEST_ORDER);</span>
<span class="term-fg31">-    test_exhaustive_sign(ctx, group, EXHAUSTIVE_TEST_ORDER);</span>
<span class="term-fg31">-    test_exhaustive_verify(ctx, group, EXHAUSTIVE_TEST_ORDER);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef ENABLE_MODULE_RECOVERY</span>
<span class="term-fg31">-    test_exhaustive_recovery_sign(ctx, group, EXHAUSTIVE_TEST_ORDER);</span>
<span class="term-fg31">-    test_exhaustive_recovery_verify(ctx, group, EXHAUSTIVE_TEST_ORDER);</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-    secp256k1_context_destroy(ctx);</span>
<span class="term-fg31">-    return 0;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-042b5492583ad36606d04963" role="button"
                       aria-expanded="false" aria-controls="id-042b5492583ad36606d04963">
                        <code>crypto/secp256k1/libsecp256k1/src/util.h</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/libsecp256k1/src/util.h" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-113</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-042b5492583ad36606d04963"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;util.h op-geth&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;util.h</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 4092a86c9175cb7815cd4ebe5cf791940f72fb47..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;libsecp256k1&#47;src&#47;util.h</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,113 +0,0 @@</span>
<span class="term-fg31">-&#47;**********************************************************************</span>
<span class="term-fg31">- * Copyright (c) 2013, 2014 Pieter Wuille                             *</span>
<span class="term-fg31">- * Distributed under the MIT software license, see the accompanying   *</span>
<span class="term-fg31">- * file COPYING or http:&#47;&#47;www.opensource.org&#47;licenses&#47;mit-license.php.*</span>
<span class="term-fg31">- **********************************************************************&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef _SECP256K1_UTIL_H_</span>
<span class="term-fg31">-#define _SECP256K1_UTIL_H_</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#if defined HAVE_CONFIG_H</span>
<span class="term-fg31">-#include &quot;libsecp256k1-config.h&quot;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &lt;stdlib.h&gt;</span>
<span class="term-fg31">-#include &lt;stdint.h&gt;</span>
<span class="term-fg31">-#include &lt;stdio.h&gt;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-typedef struct {</span>
<span class="term-fg31">-    void (*fn)(const char *text, void* data);</span>
<span class="term-fg31">-    const void* data;</span>
<span class="term-fg31">-} secp256k1_callback;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static SECP256K1_INLINE void secp256k1_callback_call(const secp256k1_callback * const cb, const char * const text) {</span>
<span class="term-fg31">-    cb-&gt;fn(text, (void*)cb-&gt;data);</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef DETERMINISTIC</span>
<span class="term-fg31">-#define TEST_FAILURE(msg) do { \</span>
<span class="term-fg31">-    fprintf(stderr, &quot;%s\n&quot;, msg); \</span>
<span class="term-fg31">-    abort(); \</span>
<span class="term-fg31">-} while(0);</span>
<span class="term-fg31">-#else</span>
<span class="term-fg31">-#define TEST_FAILURE(msg) do { \</span>
<span class="term-fg31">-    fprintf(stderr, &quot;%s:%d: %s\n&quot;, __FILE__, __LINE__, msg); \</span>
<span class="term-fg31">-    abort(); \</span>
<span class="term-fg31">-} while(0)</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef HAVE_BUILTIN_EXPECT</span>
<span class="term-fg31">-#define EXPECT(x,c) __builtin_expect((x),(c))</span>
<span class="term-fg31">-#else</span>
<span class="term-fg31">-#define EXPECT(x,c) (x)</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef DETERMINISTIC</span>
<span class="term-fg31">-#define CHECK(cond) do { \</span>
<span class="term-fg31">-    if (EXPECT(!(cond), 0)) { \</span>
<span class="term-fg31">-        TEST_FAILURE(&quot;test condition failed&quot;); \</span>
<span class="term-fg31">-    } \</span>
<span class="term-fg31">-} while(0)</span>
<span class="term-fg31">-#else</span>
<span class="term-fg31">-#define CHECK(cond) do { \</span>
<span class="term-fg31">-    if (EXPECT(!(cond), 0)) { \</span>
<span class="term-fg31">-        TEST_FAILURE(&quot;test condition failed: &quot; #cond); \</span>
<span class="term-fg31">-    } \</span>
<span class="term-fg31">-} while(0)</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;* Like assert(), but when VERIFY is defined, and side-effect safe. *&#47;</span>
<span class="term-fg31">-#if defined(COVERAGE)</span>
<span class="term-fg31">-#define VERIFY_CHECK(check)</span>
<span class="term-fg31">-#define VERIFY_SETUP(stmt)</span>
<span class="term-fg31">-#elif defined(VERIFY)</span>
<span class="term-fg31">-#define VERIFY_CHECK CHECK</span>
<span class="term-fg31">-#define VERIFY_SETUP(stmt) do { stmt; } while(0)</span>
<span class="term-fg31">-#else</span>
<span class="term-fg31">-#define VERIFY_CHECK(cond) do { (void)(cond); } while(0)</span>
<span class="term-fg31">-#define VERIFY_SETUP(stmt)</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-static SECP256K1_INLINE void *checked_malloc(const secp256k1_callback* cb, size_t size) {</span>
<span class="term-fg31">-    void *ret = malloc(size);</span>
<span class="term-fg31">-    if (ret == NULL) {</span>
<span class="term-fg31">-        secp256k1_callback_call(cb, &quot;Out of memory&quot;);</span>
<span class="term-fg31">-    }</span>
<span class="term-fg31">-    return ret;</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;* Macro for restrict, when available and not in a VERIFY build. *&#47;</span>
<span class="term-fg31">-#if defined(SECP256K1_BUILD) &amp;&amp; defined(VERIFY)</span>
<span class="term-fg31">-# define SECP256K1_RESTRICT</span>
<span class="term-fg31">-#else</span>
<span class="term-fg31">-# if (!defined(__STDC_VERSION__) || (__STDC_VERSION__ &lt; 199901L) )</span>
<span class="term-fg31">-#  if SECP256K1_GNUC_PREREQ(3,0)</span>
<span class="term-fg31">-#   define SECP256K1_RESTRICT __restrict__</span>
<span class="term-fg31">-#  elif (defined(_MSC_VER) &amp;&amp; _MSC_VER &gt;= 1400)</span>
<span class="term-fg31">-#   define SECP256K1_RESTRICT __restrict</span>
<span class="term-fg31">-#  else</span>
<span class="term-fg31">-#   define SECP256K1_RESTRICT</span>
<span class="term-fg31">-#  endif</span>
<span class="term-fg31">-# else</span>
<span class="term-fg31">-#  define SECP256K1_RESTRICT restrict</span>
<span class="term-fg31">-# endif</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#if defined(_WIN32)</span>
<span class="term-fg31">-# define I64FORMAT &quot;I64d&quot;</span>
<span class="term-fg31">-# define I64uFORMAT &quot;I64u&quot;</span>
<span class="term-fg31">-#else</span>
<span class="term-fg31">-# define I64FORMAT &quot;lld&quot;</span>
<span class="term-fg31">-# define I64uFORMAT &quot;llu&quot;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#if defined(HAVE___INT128)</span>
<span class="term-fg31">-# if defined(__GNUC__)</span>
<span class="term-fg31">-#  define SECP256K1_GNUC_EXT __extension__</span>
<span class="term-fg31">-# else</span>
<span class="term-fg31">-#  define SECP256K1_GNUC_EXT</span>
<span class="term-fg31">-# endif</span>
<span class="term-fg31">-SECP256K1_GNUC_EXT typedef unsigned __int128 uint128_t;</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#endif</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-f2570f662db34fcf9fe3ba68" role="button"
                       aria-expanded="false" aria-controls="id-f2570f662db34fcf9fe3ba68">
                        <code>crypto/secp256k1/panic_cb.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/panic_cb.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-24</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-f2570f662db34fcf9fe3ba68"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;panic_cb.go op-geth&#47;crypto&#47;secp256k1&#47;panic_cb.go</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index a30b04f51b4277cb27e8b0d25e4eb465a4d326d7..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;panic_cb.go</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,24 +0,0 @@</span>
<span class="term-fg31">-&#47;&#47; Copyright 2015 Jeffrey Wilcke, Felix Lange, Gustav Simonsson. All rights reserved.</span>
<span class="term-fg31">-&#47;&#47; Use of this source code is governed by a BSD-style license that can be found in</span>
<span class="term-fg31">-&#47;&#47; the LICENSE file.</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;&#47;go:build !gofuzz &amp;&amp; cgo</span>
<span class="term-fg31">-&#47;&#47; +build !gofuzz,cgo</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-package secp256k1</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-import &quot;C&quot;</span>
<span class="term-fg31">-import &quot;unsafe&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;&#47; Callbacks for converting libsecp256k1 internal faults into</span>
<span class="term-fg31">-&#47;&#47; recoverable Go panics.</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;&#47;export secp256k1GoPanicIllegal</span>
<span class="term-fg31">-func secp256k1GoPanicIllegal(msg *C.char, data unsafe.Pointer) {</span>
<span class="term-fg31">-	panic(&quot;illegal argument: &quot; + C.GoString(msg))</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;&#47;export secp256k1GoPanicError</span>
<span class="term-fg31">-func secp256k1GoPanicError(msg *C.char, data unsafe.Pointer) {</span>
<span class="term-fg31">-	panic(&quot;internal error: &quot; + C.GoString(msg))</span>
<span class="term-fg31">-}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-43fb8d8c60091cd613f55927" role="button"
                       aria-expanded="false" aria-controls="id-43fb8d8c60091cd613f55927">
                        <code>crypto/secp256k1/scalar_mult_cgo.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/scalar_mult_cgo.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-53</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-43fb8d8c60091cd613f55927"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;scalar_mult_cgo.go op-geth&#47;crypto&#47;secp256k1&#47;scalar_mult_cgo.go</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index d11c11faf85bddedeb233272bbb9ea2e507a0221..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;scalar_mult_cgo.go</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,53 +0,0 @@</span>
<span class="term-fg31">-&#47;&#47; Copyright 2015 Jeffrey Wilcke, Felix Lange, Gustav Simonsson. All rights reserved.</span>
<span class="term-fg31">-&#47;&#47; Use of this source code is governed by a BSD-style license that can be found in</span>
<span class="term-fg31">-&#47;&#47; the LICENSE file.</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;&#47;go:build !gofuzz &amp;&amp; cgo</span>
<span class="term-fg31">-&#47;&#47; +build !gofuzz,cgo</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-package secp256k1</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-import (</span>
<span class="term-fg31">-	&quot;math&#47;big&quot;</span>
<span class="term-fg31">-	&quot;unsafe&quot;</span>
<span class="term-fg31">-)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;*</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#include &quot;libsecp256k1&#47;include&#47;secp256k1.h&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-extern int secp256k1_ext_scalar_mul(const secp256k1_context* ctx, const unsigned char *point, const unsigned char *scalar);</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-*&#47;</span>
<span class="term-fg31">-import &quot;C&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-func (bitCurve *BitCurve) ScalarMult(Bx, By *big.Int, scalar []byte) (*big.Int, *big.Int) {</span>
<span class="term-fg31">-	&#47;&#47; Ensure scalar is exactly 32 bytes. We pad always, even if</span>
<span class="term-fg31">-	&#47;&#47; scalar is 32 bytes long, to avoid a timing side channel.</span>
<span class="term-fg31">-	if len(scalar) &gt; 32 {</span>
<span class="term-fg31">-		panic(&quot;can&#39;t handle scalars &gt; 256 bits&quot;)</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-	&#47;&#47; NOTE: potential timing issue</span>
<span class="term-fg31">-	padded := make([]byte, 32)</span>
<span class="term-fg31">-	copy(padded[32-len(scalar):], scalar)</span>
<span class="term-fg31">-	scalar = padded</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	&#47;&#47; Do the multiplication in C, updating point.</span>
<span class="term-fg31">-	point := make([]byte, 64)</span>
<span class="term-fg31">-	readBits(Bx, point[:32])</span>
<span class="term-fg31">-	readBits(By, point[32:])</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	pointPtr := (*C.uchar)(unsafe.Pointer(&amp;point[0]))</span>
<span class="term-fg31">-	scalarPtr := (*C.uchar)(unsafe.Pointer(&amp;scalar[0]))</span>
<span class="term-fg31">-	res := C.secp256k1_ext_scalar_mul(context, pointPtr, scalarPtr)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	&#47;&#47; Unpack the result and clear temporaries.</span>
<span class="term-fg31">-	x := new(big.Int).SetBytes(point[:32])</span>
<span class="term-fg31">-	y := new(big.Int).SetBytes(point[32:])</span>
<span class="term-fg31">-	clear(point)</span>
<span class="term-fg31">-	clear(scalar)</span>
<span class="term-fg31">-	if res != 1 {</span>
<span class="term-fg31">-		return nil, nil</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-	return x, y</span>
<span class="term-fg31">-}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-d0fe185e6ab88151f0592b78" role="button"
                       aria-expanded="false" aria-controls="id-d0fe185e6ab88151f0592b78">
                        <code>crypto/secp256k1/scalar_mult_nocgo.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/scalar_mult_nocgo.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-14</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-d0fe185e6ab88151f0592b78"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;scalar_mult_nocgo.go op-geth&#47;crypto&#47;secp256k1&#47;scalar_mult_nocgo.go</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index feb13a8dfd0e32087bb2ddcde21e4750b6f2a119..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;scalar_mult_nocgo.go</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,14 +0,0 @@</span>
<span class="term-fg31">-&#47;&#47; Copyright 2015 Jeffrey Wilcke, Felix Lange, Gustav Simonsson. All rights reserved.</span>
<span class="term-fg31">-&#47;&#47; Use of this source code is governed by a BSD-style license that can be found in</span>
<span class="term-fg31">-&#47;&#47; the LICENSE file.</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;&#47;go:build gofuzz || !cgo</span>
<span class="term-fg31">-&#47;&#47; +build gofuzz !cgo</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-package secp256k1</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-import &quot;math&#47;big&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-func (bitCurve *BitCurve) ScalarMult(Bx, By *big.Int, scalar []byte) (*big.Int, *big.Int) {</span>
<span class="term-fg31">-	panic(&quot;ScalarMult is not available when secp256k1 is built without cgo&quot;)</span>
<span class="term-fg31">-}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-e4121999efc572429e2b2191" role="button"
                       aria-expanded="false" aria-controls="id-e4121999efc572429e2b2191">
                        <code>crypto/secp256k1/secp256.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/crypto/secp256k1/secp256.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <span class="text-muted">(deleted)</span>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+0</span></div>
                            <div class="text-start"><span class="text-danger">-182</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-e4121999efc572429e2b2191"><span class="term-fg1">diff --git go-ethereum&#47;crypto&#47;secp256k1&#47;secp256.go op-geth&#47;crypto&#47;secp256k1&#47;secp256.go</span>
<span class="term-fg1">deleted file mode 100644</span>
<span class="term-fg1">index 61abc1eaf04b7e9e31139369bfb34b1d7bf1dfa4..0000000000000000000000000000000000000000</span>
<span class="term-fg1">--- go-ethereum&#47;crypto&#47;secp256k1&#47;secp256.go</span>
<span class="term-fg1">+++ &#47;dev&#47;null</span>
<span class="term-fg36">@@ -1,182 +0,0 @@</span>
<span class="term-fg31">-&#47;&#47; Copyright 2015 Jeffrey Wilcke, Felix Lange, Gustav Simonsson. All rights reserved.</span>
<span class="term-fg31">-&#47;&#47; Use of this source code is governed by a BSD-style license that can be found in</span>
<span class="term-fg31">-&#47;&#47; the LICENSE file.</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;&#47;go:build !gofuzz &amp;&amp; cgo</span>
<span class="term-fg31">-&#47;&#47; +build !gofuzz,cgo</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;&#47; Package secp256k1 wraps the bitcoin secp256k1 C library.</span>
<span class="term-fg31">-package secp256k1</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;*</span>
<span class="term-fg31">-#cgo CFLAGS: -I.&#47;libsecp256k1</span>
<span class="term-fg31">-#cgo CFLAGS: -I.&#47;libsecp256k1&#47;src&#47;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifdef __SIZEOF_INT128__</span>
<span class="term-fg31">-#  define HAVE___INT128</span>
<span class="term-fg31">-#  define USE_FIELD_5X52</span>
<span class="term-fg31">-#  define USE_SCALAR_4X64</span>
<span class="term-fg31">-#else</span>
<span class="term-fg31">-#  define USE_FIELD_10X26</span>
<span class="term-fg31">-#  define USE_SCALAR_8X32</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#ifndef NDEBUG</span>
<span class="term-fg31">-#  define NDEBUG</span>
<span class="term-fg31">-#endif</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-#define USE_ENDOMORPHISM</span>
<span class="term-fg31">-#define USE_NUM_NONE</span>
<span class="term-fg31">-#define USE_FIELD_INV_BUILTIN</span>
<span class="term-fg31">-#define USE_SCALAR_INV_BUILTIN</span>
<span class="term-fg31">-#include &quot;.&#47;libsecp256k1&#47;src&#47;secp256k1.c&quot;</span>
<span class="term-fg31">-#include &quot;.&#47;libsecp256k1&#47;src&#47;modules&#47;recovery&#47;main_impl.h&quot;</span>
<span class="term-fg31">-#include &quot;ext.h&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-typedef void (*callbackFunc) (const char* msg, void* data);</span>
<span class="term-fg31">-extern void secp256k1GoPanicIllegal(const char* msg, void* data);</span>
<span class="term-fg31">-extern void secp256k1GoPanicError(const char* msg, void* data);</span>
<span class="term-fg31">-*&#47;</span>
<span class="term-fg31">-import &quot;C&quot;</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-import (</span>
<span class="term-fg31">-	&quot;errors&quot;</span>
<span class="term-fg31">-	&quot;math&#47;big&quot;</span>
<span class="term-fg31">-	&quot;unsafe&quot;</span>
<span class="term-fg31">-)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-var context *C.secp256k1_context</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-func init() {</span>
<span class="term-fg31">-	&#47;&#47; around 20 ms on a modern CPU.</span>
<span class="term-fg31">-	context = C.secp256k1_context_create_sign_verify()</span>
<span class="term-fg31">-	C.secp256k1_context_set_illegal_callback(context, C.callbackFunc(C.secp256k1GoPanicIllegal), nil)</span>
<span class="term-fg31">-	C.secp256k1_context_set_error_callback(context, C.callbackFunc(C.secp256k1GoPanicError), nil)</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-var (</span>
<span class="term-fg31">-	ErrInvalidMsgLen       = errors.New(&quot;invalid message length, need 32 bytes&quot;)</span>
<span class="term-fg31">-	ErrInvalidSignatureLen = errors.New(&quot;invalid signature length&quot;)</span>
<span class="term-fg31">-	ErrInvalidRecoveryID   = errors.New(&quot;invalid signature recovery id&quot;)</span>
<span class="term-fg31">-	ErrInvalidKey          = errors.New(&quot;invalid private key&quot;)</span>
<span class="term-fg31">-	ErrInvalidPubkey       = errors.New(&quot;invalid public key&quot;)</span>
<span class="term-fg31">-	ErrSignFailed          = errors.New(&quot;signing failed&quot;)</span>
<span class="term-fg31">-	ErrRecoverFailed       = errors.New(&quot;recovery failed&quot;)</span>
<span class="term-fg31">-)</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;&#47; Sign creates a recoverable ECDSA signature.</span>
<span class="term-fg31">-&#47;&#47; The produced signature is in the 65-byte [R || S || V] format where V is 0 or 1.</span>
<span class="term-fg31">-&#47;&#47;</span>
<span class="term-fg31">-&#47;&#47; The caller is responsible for ensuring that msg cannot be chosen</span>
<span class="term-fg31">-&#47;&#47; directly by an attacker. It is usually preferable to use a cryptographic</span>
<span class="term-fg31">-&#47;&#47; hash function on any input before handing it to this function.</span>
<span class="term-fg31">-func Sign(msg []byte, seckey []byte) ([]byte, error) {</span>
<span class="term-fg31">-	if len(msg) != 32 {</span>
<span class="term-fg31">-		return nil, ErrInvalidMsgLen</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-	if len(seckey) != 32 {</span>
<span class="term-fg31">-		return nil, ErrInvalidKey</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-	seckeydata := (*C.uchar)(unsafe.Pointer(&amp;seckey[0]))</span>
<span class="term-fg31">-	if C.secp256k1_ec_seckey_verify(context, seckeydata) != 1 {</span>
<span class="term-fg31">-		return nil, ErrInvalidKey</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	var (</span>
<span class="term-fg31">-		msgdata   = (*C.uchar)(unsafe.Pointer(&amp;msg[0]))</span>
<span class="term-fg31">-		noncefunc = C.secp256k1_nonce_function_rfc6979</span>
<span class="term-fg31">-		sigstruct C.secp256k1_ecdsa_recoverable_signature</span>
<span class="term-fg31">-	)</span>
<span class="term-fg31">-	if C.secp256k1_ecdsa_sign_recoverable(context, &amp;sigstruct, msgdata, seckeydata, noncefunc, nil) == 0 {</span>
<span class="term-fg31">-		return nil, ErrSignFailed</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	var (</span>
<span class="term-fg31">-		sig     = make([]byte, 65)</span>
<span class="term-fg31">-		sigdata = (*C.uchar)(unsafe.Pointer(&amp;sig[0]))</span>
<span class="term-fg31">-		recid   C.int</span>
<span class="term-fg31">-	)</span>
<span class="term-fg31">-	C.secp256k1_ecdsa_recoverable_signature_serialize_compact(context, sigdata, &amp;recid, &amp;sigstruct)</span>
<span class="term-fg31">-	sig[64] = byte(recid) &#47;&#47; add back recid to get 65 bytes sig</span>
<span class="term-fg31">-	return sig, nil</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;&#47; RecoverPubkey returns the public key of the signer.</span>
<span class="term-fg31">-&#47;&#47; msg must be the 32-byte hash of the message to be signed.</span>
<span class="term-fg31">-&#47;&#47; sig must be a 65-byte compact ECDSA signature containing the</span>
<span class="term-fg31">-&#47;&#47; recovery id as the last element.</span>
<span class="term-fg31">-func RecoverPubkey(msg []byte, sig []byte) ([]byte, error) {</span>
<span class="term-fg31">-	if len(msg) != 32 {</span>
<span class="term-fg31">-		return nil, ErrInvalidMsgLen</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-	if err := checkSignature(sig); err != nil {</span>
<span class="term-fg31">-		return nil, err</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-	var (</span>
<span class="term-fg31">-		pubkey  = make([]byte, 65)</span>
<span class="term-fg31">-		sigdata = (*C.uchar)(unsafe.Pointer(&amp;sig[0]))</span>
<span class="term-fg31">-		msgdata = (*C.uchar)(unsafe.Pointer(&amp;msg[0]))</span>
<span class="term-fg31">-	)</span>
<span class="term-fg31">-	if C.secp256k1_ext_ecdsa_recover(context, (*C.uchar)(unsafe.Pointer(&amp;pubkey[0])), sigdata, msgdata) == 0 {</span>
<span class="term-fg31">-		return nil, ErrRecoverFailed</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-	return pubkey, nil</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;&#47; VerifySignature checks that the given pubkey created signature over message.</span>
<span class="term-fg31">-&#47;&#47; The signature should be in [R || S] format.</span>
<span class="term-fg31">-func VerifySignature(pubkey, msg, signature []byte) bool {</span>
<span class="term-fg31">-	if len(msg) != 32 || len(signature) != 64 || len(pubkey) == 0 {</span>
<span class="term-fg31">-		return false</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-	sigdata := (*C.uchar)(unsafe.Pointer(&amp;signature[0]))</span>
<span class="term-fg31">-	msgdata := (*C.uchar)(unsafe.Pointer(&amp;msg[0]))</span>
<span class="term-fg31">-	keydata := (*C.uchar)(unsafe.Pointer(&amp;pubkey[0]))</span>
<span class="term-fg31">-	return C.secp256k1_ext_ecdsa_verify(context, sigdata, msgdata, keydata, C.size_t(len(pubkey))) != 0</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;&#47; DecompressPubkey parses a public key in the 33-byte compressed format.</span>
<span class="term-fg31">-&#47;&#47; It returns non-nil coordinates if the public key is valid.</span>
<span class="term-fg31">-func DecompressPubkey(pubkey []byte) (x, y *big.Int) {</span>
<span class="term-fg31">-	if len(pubkey) != 33 {</span>
<span class="term-fg31">-		return nil, nil</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-	var (</span>
<span class="term-fg31">-		pubkeydata = (*C.uchar)(unsafe.Pointer(&amp;pubkey[0]))</span>
<span class="term-fg31">-		pubkeylen  = C.size_t(len(pubkey))</span>
<span class="term-fg31">-		out        = make([]byte, 65)</span>
<span class="term-fg31">-		outdata    = (*C.uchar)(unsafe.Pointer(&amp;out[0]))</span>
<span class="term-fg31">-		outlen     = C.size_t(len(out))</span>
<span class="term-fg31">-	)</span>
<span class="term-fg31">-	if C.secp256k1_ext_reencode_pubkey(context, outdata, outlen, pubkeydata, pubkeylen) == 0 {</span>
<span class="term-fg31">-		return nil, nil</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-	return new(big.Int).SetBytes(out[1:33]), new(big.Int).SetBytes(out[33:])</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-&#47;&#47; CompressPubkey encodes a public key to 33-byte compressed format.</span>
<span class="term-fg31">-func CompressPubkey(x, y *big.Int) []byte {</span>
<span class="term-fg31">-	var (</span>
<span class="term-fg31">-		pubkey     = S256().Marshal(x, y)</span>
<span class="term-fg31">-		pubkeydata = (*C.uchar)(unsafe.Pointer(&amp;pubkey[0]))</span>
<span class="term-fg31">-		pubkeylen  = C.size_t(len(pubkey))</span>
<span class="term-fg31">-		out        = make([]byte, 33)</span>
<span class="term-fg31">-		outdata    = (*C.uchar)(unsafe.Pointer(&amp;out[0]))</span>
<span class="term-fg31">-		outlen     = C.size_t(len(out))</span>
<span class="term-fg31">-	)</span>
<span class="term-fg31">-	if C.secp256k1_ext_reencode_pubkey(context, outdata, outlen, pubkeydata, pubkeylen) == 0 {</span>
<span class="term-fg31">-		panic(&quot;libsecp256k1 error&quot;)</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-	return out</span>
<span class="term-fg31">-}</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-func checkSignature(sig []byte) error {</span>
<span class="term-fg31">-	if len(sig) != 65 {</span>
<span class="term-fg31">-		return ErrInvalidSignatureLen</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-	if sig[64] &gt;= 4 {</span>
<span class="term-fg31">-		return ErrInvalidRecoveryID</span>
<span class="term-fg31">-	}</span>
<span class="term-fg31">-	return nil</span>
<span class="term-fg31">-}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-c1cbc5645f1ddb7e923cb511" role="button"
                       aria-expanded="false" aria-controls="id-c1cbc5645f1ddb7e923cb511">
                        <code>eth/catalyst/queue.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/eth/catalyst/queue.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/eth/catalyst/queue.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+19</span></div>
                            <div class="text-start"><span class="text-danger">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-c1cbc5645f1ddb7e923cb511"><span class="term-fg1">diff --git go-ethereum&#47;eth&#47;catalyst&#47;queue.go op-geth&#47;eth&#47;catalyst&#47;queue.go</span>
<span class="term-fg1">index 634dc1b2e6c2520f02e74f38ba66cba649685c86..d42904843b25fa8bb54a1739a9ff68f6d017f90f 100644</span>
<span class="term-fg1">--- go-ethereum&#47;eth&#47;catalyst&#47;queue.go</span>
<span class="term-fg1">+++ op-geth&#47;eth&#47;catalyst&#47;queue.go</span>
<span class="term-fg36">@@ -17,6 +17,7 @@</span>
 package catalyst
&nbsp;
 import (
<span class="term-fg32">+	&quot;errors&quot;</span>
 	&quot;sync&quot;
&nbsp;
 	&quot;github.com&#47;ethereum&#47;go-ethereum&#47;beacon&#47;engine&quot;
<span class="term-fg36">@@ -89,6 +90,24 @@</span> 			return item.payload.ResolveFull()
 		}
 	}
 	return nil
<span class="term-fg32">+}</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47; waitFull waits until the first full payload has been built for the specified payload id</span>
<span class="term-fg32">+&#47;&#47; The method returns immediately if the payload is unknown.</span>
<span class="term-fg32">+func (q *payloadQueue) waitFull(id engine.PayloadID) error {</span>
<span class="term-fg32">+	q.lock.RLock()</span>
<span class="term-fg32">+	defer q.lock.RUnlock()</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+	for _, item := range q.payloads {</span>
<span class="term-fg32">+		if item == nil {</span>
<span class="term-fg32">+			return errors.New(&quot;unknown payload&quot;)</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+		if item.id == id {</span>
<span class="term-fg32">+			item.payload.WaitFull()</span>
<span class="term-fg32">+			return nil</span>
<span class="term-fg32">+		}</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+	return errors.New(&quot;unknown payload&quot;)</span>
 }
&nbsp;
 &#47;&#47; has checks if a particular payload is already tracked.</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-554e57343346cbf82dd1f4a5" role="button"
                       aria-expanded="false" aria-controls="id-554e57343346cbf82dd1f4a5">
                        <code>eth/catalyst/simulated_beacon.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/eth/catalyst/simulated_beacon.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/eth/catalyst/simulated_beacon.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+4</span></div>
                            <div class="text-start"><span class="text-danger">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-554e57343346cbf82dd1f4a5"><span class="term-fg1">diff --git go-ethereum&#47;eth&#47;catalyst&#47;simulated_beacon.go op-geth&#47;eth&#47;catalyst&#47;simulated_beacon.go</span>
<span class="term-fg1">index 2d6569e4221823026e10430417b2bf8b921f7209..97172028f786206815514e6a3f65c311b3ead185 100644</span>
<span class="term-fg1">--- go-ethereum&#47;eth&#47;catalyst&#47;simulated_beacon.go</span>
<span class="term-fg1">+++ op-geth&#47;eth&#47;catalyst&#47;simulated_beacon.go</span>
<span class="term-fg36">@@ -171,6 +171,10 @@</span> 	}
 	if fcResponse == engine.STATUS_SYNCING {
 		return errors.New(&quot;chain rewind prevented invocation of payload creation&quot;)
 	}
<span class="term-fg32">+</span>
<span class="term-fg32">+	if err := c.engineAPI.localBlocks.waitFull(*fcResponse.PayloadID); err != nil {</span>
<span class="term-fg32">+		return err</span>
<span class="term-fg32">+	}</span>
 	envelope, err := c.engineAPI.getPayload(*fcResponse.PayloadID, true)
 	if err != nil {
 		return err</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-b25321c3b9d5e274aebeb0dd" role="button"
                       aria-expanded="false" aria-controls="id-b25321c3b9d5e274aebeb0dd">
                        <code>eth/gasestimator/gasestimator.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/eth/gasestimator/gasestimator.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/eth/gasestimator/gasestimator.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+1</span></div>
                            <div class="text-start"><span class="text-danger">-1</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-b25321c3b9d5e274aebeb0dd"><span class="term-fg1">diff --git go-ethereum&#47;eth&#47;gasestimator&#47;gasestimator.go op-geth&#47;eth&#47;gasestimator&#47;gasestimator.go</span>
<span class="term-fg1">index ac3b59e97e8b7d6a331849f7bdebdfe55d9faa1f..fbcdbc8b351ce1eb0a4821806b2e5d76194bd68f 100644</span>
<span class="term-fg1">--- go-ethereum&#47;eth&#47;gasestimator&#47;gasestimator.go</span>
<span class="term-fg1">+++ op-geth&#47;eth&#47;gasestimator&#47;gasestimator.go</span>
<span class="term-fg36">@@ -218,7 +218,7 @@</span> func run(ctx context.Context, call *core.Message, opts *Options) (*core.ExecutionResult, error) {
 	&#47;&#47; Assemble the call and the call context
 	var (
 		msgContext = core.NewEVMTxContext(call)
<span class="term-fg31">-		evmContext = core.NewEVMBlockContext(opts.Header, opts.Chain, nil)</span>
<span class="term-fg32">+		evmContext = core.NewEVMBlockContext(opts.Header, opts.Chain, nil, opts.Config, opts.State)</span>
&nbsp;
 		dirtyState = opts.State.Copy()
 		evm        = vm.NewEVM(evmContext, msgContext, dirtyState, opts.Config, vm.Config{NoBaseFee: true})</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-d495834691e59cbe05c31001" role="button"
                       aria-expanded="false" aria-controls="id-d495834691e59cbe05c31001">
                        <code>eth/gasprice/feehistory.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/eth/gasprice/feehistory.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/eth/gasprice/feehistory.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+1</span></div>
                            <div class="text-start"><span class="text-danger">-1</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-d495834691e59cbe05c31001"><span class="term-fg1">diff --git go-ethereum&#47;eth&#47;gasprice&#47;feehistory.go op-geth&#47;eth&#47;gasprice&#47;feehistory.go</span>
<span class="term-fg1">index 1e625e21c0297a8c32b6c2c584186036763e97f3..51938e04a38bf3057aa5a3e7bab3c381b8a5e0f1 100644</span>
<span class="term-fg1">--- go-ethereum&#47;eth&#47;gasprice&#47;feehistory.go</span>
<span class="term-fg1">+++ op-geth&#47;eth&#47;gasprice&#47;feehistory.go</span>
<span class="term-fg36">@@ -91,7 +91,7 @@</span> 	if bf.results.baseFee = bf.header.BaseFee; bf.results.baseFee == nil {
 		bf.results.baseFee = new(big.Int)
 	}
 	if config.IsLondon(big.NewInt(int64(bf.blockNumber + 1))) {
<span class="term-fg31">-		bf.results.nextBaseFee = eip1559.CalcBaseFee(config, bf.header)</span>
<span class="term-fg32">+		bf.results.nextBaseFee = eip1559.CalcBaseFee(config, bf.header, bf.header.Time+1)</span>
 	} else {
 		bf.results.nextBaseFee = new(big.Int)
 	}</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-57ff7d9fdc9bd32f7a395b78" role="button"
                       aria-expanded="false" aria-controls="id-57ff7d9fdc9bd32f7a395b78">
                        <code>eth/tracers/native/call.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/eth/tracers/native/call.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/eth/tracers/native/call.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+6</span></div>
                            <div class="text-start"><span class="text-danger">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-57ff7d9fdc9bd32f7a395b78"><span class="term-fg1">diff --git go-ethereum&#47;eth&#47;tracers&#47;native&#47;call.go op-geth&#47;eth&#47;tracers&#47;native&#47;call.go</span>
<span class="term-fg1">index 2b84ecaf405734953db44e17083ed21b21a2ddba..16cb88b990fc7ebf87069bff86d3de7164205435 100644</span>
<span class="term-fg1">--- go-ethereum&#47;eth&#47;tracers&#47;native&#47;call.go</span>
<span class="term-fg1">+++ op-geth&#47;eth&#47;tracers&#47;native&#47;call.go</span>
<span class="term-fg36">@@ -261,6 +261,12 @@</span> 	if len(t.callstack) != 1 {
 		return nil, errors.New(&quot;incorrect number of top-level calls&quot;)
 	}
&nbsp;
<span class="term-fg32">+	if t.callstack[0].Type == vm.STOP {</span>
<span class="term-fg32">+		t.callstack[0].Error = &quot;failed deposit transaction&quot;</span>
<span class="term-fg32">+		t.callstack[0].To = nil</span>
<span class="term-fg32">+		t.callstack[0].Gas = 0</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
 	res, err := json.Marshal(t.callstack[0])
 	if err != nil {
 		return nil, err</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-dd53972eda328aebcb49cf6f" role="button"
                       aria-expanded="false" aria-controls="id-dd53972eda328aebcb49cf6f">
                        <code>eth/tracers/native/call_flat.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/eth/tracers/native/call_flat.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/eth/tracers/native/call_flat.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+7</span></div>
                            <div class="text-start"><span class="text-danger">-1</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-dd53972eda328aebcb49cf6f"><span class="term-fg1">diff --git go-ethereum&#47;eth&#47;tracers&#47;native&#47;call_flat.go op-geth&#47;eth&#47;tracers&#47;native&#47;call_flat.go</span>
<span class="term-fg1">index a47b79f8df26f8888d1bf609e98bb690f9a4cd8b..c869d559351568bf9c85ae241d9a24a3c58efedb 100644</span>
<span class="term-fg1">--- go-ethereum&#47;eth&#47;tracers&#47;native&#47;call_flat.go</span>
<span class="term-fg1">+++ op-geth&#47;eth&#47;tracers&#47;native&#47;call_flat.go</span>
<span class="term-fg36">@@ -223,6 +223,12 @@</span> 	if len(t.tracer.callstack) &lt; 1 {
 		return nil, errors.New(&quot;invalid number of calls&quot;)
 	}
&nbsp;
<span class="term-fg32">+	if t.tracer.callstack[0].Type == vm.STOP {</span>
<span class="term-fg32">+		t.tracer.callstack[0].Error = &quot;failed deposit transaction&quot;</span>
<span class="term-fg32">+		t.tracer.callstack[0].To = nil</span>
<span class="term-fg32">+		t.tracer.callstack[0].Gas = 0</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
 	flat, err := flatFromNested(&amp;t.tracer.callstack[0], []int{}, t.config.ConvertParityErrors, t.ctx)
 	if err != nil {
 		return nil, err
<span class="term-fg36">@@ -253,7 +259,7 @@</span> 	case vm.CREATE, vm.CREATE2:
 		frame = newFlatCreate(input)
 	case vm.SELFDESTRUCT:
 		frame = newFlatSelfdestruct(input)
<span class="term-fg31">-	case vm.CALL, vm.STATICCALL, vm.CALLCODE, vm.DELEGATECALL:</span>
<span class="term-fg32">+	case vm.CALL, vm.STATICCALL, vm.CALLCODE, vm.DELEGATECALL, vm.STOP:</span>
 		frame = newFlatCall(input)
 	default:
 		return nil, fmt.Errorf(&quot;unrecognized call frame type: %s&quot;, input.Type)</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-fec542bb9a7fca964e1b5295" role="button"
                       aria-expanded="false" aria-controls="id-fec542bb9a7fca964e1b5295">
                        <code>ethdb/pebble/pebble.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/ethdb/pebble/pebble.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/ethdb/pebble/pebble.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+2</span></div>
                            <div class="text-start"><span class="text-danger">-2</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-fec542bb9a7fca964e1b5295"><span class="term-fg1">diff --git go-ethereum&#47;ethdb&#47;pebble&#47;pebble.go op-geth&#47;ethdb&#47;pebble&#47;pebble.go</span>
<span class="term-fg1">index 130d6617b5ba1e4c48865439d289804654ea922c..4e6bb2234ce9ebe3a15e46aa429696234ae8ff32 100644</span>
<span class="term-fg1">--- go-ethereum&#47;ethdb&#47;pebble&#47;pebble.go</span>
<span class="term-fg1">+++ op-geth&#47;ethdb&#47;pebble&#47;pebble.go</span>
<span class="term-fg36">@@ -605,8 +605,8 @@</span> &#47;&#47; Replay replays the batch contents.
 func (b *batch) Replay(w ethdb.KeyValueWriter) error {
 	reader := b.b.Reader()
 	for {
<span class="term-fg31">-		kind, k, v, ok, err := reader.Next()</span>
<span class="term-fg31">-		if !ok || err != nil {</span>
<span class="term-fg32">+		kind, k, v, ok := reader.Next()</span>
<span class="term-fg32">+		if !ok {</span>
 			break
 		}
 		&#47;&#47; The (k,v) slices might be overwritten if the batch is reset&#47;reused,</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-0efc5cbf30c48b129be86ccb" role="button"
                       aria-expanded="false" aria-controls="id-0efc5cbf30c48b129be86ccb">
                        <code>graphql/graphql.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/graphql/graphql.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/graphql/graphql.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+1</span></div>
                            <div class="text-start"><span class="text-danger">-1</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-0efc5cbf30c48b129be86ccb"><span class="term-fg1">diff --git go-ethereum&#47;graphql&#47;graphql.go op-geth&#47;graphql&#47;graphql.go</span>
<span class="term-fg1">index f7cf164d3144def12d4b9b22171391e6188a5715..6672c99a99c0a231598657c56340babaa5be9157 100644</span>
<span class="term-fg1">--- go-ethereum&#47;graphql&#47;graphql.go</span>
<span class="term-fg1">+++ op-geth&#47;graphql&#47;graphql.go</span>
<span class="term-fg36">@@ -773,7 +773,7 @@</span> 		if !chaincfg.IsLondon(new(big.Int).Add(header.Number, common.Big1)) {
 			return nil, nil
 		}
 	}
<span class="term-fg31">-	nextBaseFee := eip1559.CalcBaseFee(chaincfg, header)</span>
<span class="term-fg32">+	nextBaseFee := eip1559.CalcBaseFee(chaincfg, header, header.Time+1)</span>
 	return (*hexutil.Big)(nextBaseFee), nil
 }
</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-152a9143a0e060cbaa3366d5" role="button"
                       aria-expanded="false" aria-controls="id-152a9143a0e060cbaa3366d5">
                        <code>internal/build/env.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/internal/build/env.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/internal/build/env.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+5</span></div>
                            <div class="text-start"><span class="text-danger">-3</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-152a9143a0e060cbaa3366d5"><span class="term-fg1">diff --git go-ethereum&#47;internal&#47;build&#47;env.go op-geth&#47;internal&#47;build&#47;env.go</span>
<span class="term-fg1">index 0854fba2498d2f490ca5de1e73c1c9f2c58932a3..6a621495ba5441adbc045f1210f1f75c98a969b0 100644</span>
<span class="term-fg1">--- go-ethereum&#47;internal&#47;build&#47;env.go</span>
<span class="term-fg1">+++ op-geth&#47;internal&#47;build&#47;env.go</span>
<span class="term-fg36">@@ -102,6 +102,10 @@</span> func LocalEnv() Environment {
 	env := applyEnvFlags(Environment{Name: &quot;local&quot;, Repo: &quot;ethereum&#47;go-ethereum&quot;})
&nbsp;
 	head := readGitFile(&quot;HEAD&quot;)
<span class="term-fg32">+	if info, err := os.Stat(&quot;.git&#47;objects&quot;); err == nil &amp;&amp; info.IsDir() &amp;&amp; env.Tag == &quot;&quot; {</span>
<span class="term-fg32">+		env.Tag = firstLine(RunGit(&quot;tag&quot;, &quot;-l&quot;, &quot;--points-at&quot;, &quot;HEAD&quot;))</span>
<span class="term-fg32">+	}</span>
<span class="term-fg32">+</span>
 	if fields := strings.Fields(head); len(fields) == 2 {
 		head = fields[1]
 	} else {
<span class="term-fg36">@@ -111,6 +115,7 @@</span> 		&#47;&#47; Additional check required to verify, that file contains commit hash
 		commitRe, _ := regexp.Compile(&quot;^([0-9a-f]{40})$&quot;)
 		if commit := commitRe.FindString(head); commit != &quot;&quot; &amp;&amp; env.Commit == &quot;&quot; {
 			env.Commit = commit
<span class="term-fg32">+			env.Date = getDate(env.Commit)</span>
 		}
 		return env
 	}
<span class="term-fg36">@@ -122,9 +127,6 @@</span> 	if env.Branch == &quot;&quot; {
 		if head != &quot;HEAD&quot; {
 			env.Branch = strings.TrimPrefix(head, &quot;refs&#47;heads&#47;&quot;)
 		}
<span class="term-fg31">-	}</span>
<span class="term-fg31">-	if info, err := os.Stat(&quot;.git&#47;objects&quot;); err == nil &amp;&amp; info.IsDir() &amp;&amp; env.Tag == &quot;&quot; {</span>
<span class="term-fg31">-		env.Tag = firstLine(RunGit(&quot;tag&quot;, &quot;-l&quot;, &quot;--points-at&quot;, &quot;HEAD&quot;))</span>
 	}
 	return env
 }</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-4ee76420541b7579684ae8ab" role="button"
                       aria-expanded="false" aria-controls="id-4ee76420541b7579684ae8ab">
                        <code>node/node.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/node/node.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/node/node.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+1</span></div>
                            <div class="text-start"><span class="text-danger">-1</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-4ee76420541b7579684ae8ab"><span class="term-fg1">diff --git go-ethereum&#47;node&#47;node.go op-geth&#47;node&#47;node.go</span>
<span class="term-fg1">index 633f88f058a19418ecd1be9adeec4c6a225910f1..d8c5994be0a65cfc34514b2c09df49ce481e019e 100644</span>
<span class="term-fg1">--- go-ethereum&#47;node&#47;node.go</span>
<span class="term-fg1">+++ op-geth&#47;node&#47;node.go</span>
<span class="term-fg36">@@ -678,7 +678,7 @@</span>
 &#47;&#47; HTTPEndpoint returns the URL of the HTTP server. Note that this URL does not
 &#47;&#47; contain the JSON-RPC path prefix set by HTTPPathPrefix.
 func (n *Node) HTTPEndpoint() string {
<span class="term-fg31">-	return &quot;http:&#47;&#47;&quot; + n.http.listenAddr()</span>
<span class="term-fg32">+	return &quot;http:&#47;&#47;&quot; + n.http.listenAddr() &#47;&#47;nolint:all</span>
 }
&nbsp;
 &#47;&#47; WSEndpoint returns the current JSON-RPC over WebSocket endpoint.</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-dcfeb34edee4a94d27f68ca4" role="button"
                       aria-expanded="false" aria-controls="id-dcfeb34edee4a94d27f68ca4">
                        <code>rpc/http.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/rpc/http.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/rpc/http.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+3</span></div>
                            <div class="text-start"><span class="text-danger">-2</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-dcfeb34edee4a94d27f68ca4"><span class="term-fg1">diff --git go-ethereum&#47;rpc&#47;http.go op-geth&#47;rpc&#47;http.go</span>
<span class="term-fg1">index f4b99429ef4fedc101bb6d5b1a7073630b3982c2..58cc9b374e9d185b4d717dbcc2e10e84f7757dd6 100644</span>
<span class="term-fg1">--- go-ethereum&#47;rpc&#47;http.go</span>
<span class="term-fg1">+++ op-geth&#47;rpc&#47;http.go</span>
<span class="term-fg36">@@ -33,8 +33,9 @@</span> 	&quot;time&quot;
 )
&nbsp;
 const (
<span class="term-fg31">-	defaultBodyLimit = 5 * 1024 * 1024</span>
<span class="term-fg31">-	contentType      = &quot;application&#47;json&quot;</span>
<span class="term-fg32">+	maxRequestContentLength = 1024 * 1024 * 32</span>
<span class="term-fg32">+	defaultBodyLimit        = 5 * 1024 * 1024</span>
<span class="term-fg32">+	contentType             = &quot;application&#47;json&quot;</span>
 )
&nbsp;
 &#47;&#47; https:&#47;&#47;www.jsonrpc.org&#47;historical&#47;json-rpc-over-http.html#id13</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-decoration-none" data-bs-toggle="collapse" href="#id-9e2776b3ccdc505c3162282f" role="button"
                       aria-expanded="false" aria-controls="id-9e2776b3ccdc505c3162282f">
                        <code>tests/state_test_util.go</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/tests/state_test_util.go" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/tests/state_test_util.go" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-success">+1</span></div>
                            <div class="text-start"><span class="text-danger">-1</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-9e2776b3ccdc505c3162282f"><span class="term-fg1">diff --git go-ethereum&#47;tests&#47;state_test_util.go op-geth&#47;tests&#47;state_test_util.go</span>
<span class="term-fg1">index 416bab9472648642ab44c4d7c865b8f8896e1658..420206dec543645bf8ad492c484ae9340363c732 100644</span>
<span class="term-fg1">--- go-ethereum&#47;tests&#47;state_test_util.go</span>
<span class="term-fg1">+++ op-geth&#47;tests&#47;state_test_util.go</span>
<span class="term-fg36">@@ -278,7 +278,7 @@</span> 	}
&nbsp;
 	&#47;&#47; Prepare the EVM.
 	txContext := core.NewEVMTxContext(msg)
<span class="term-fg31">-	context := core.NewEVMBlockContext(block.Header(), nil, &amp;t.json.Env.Coinbase)</span>
<span class="term-fg32">+	context := core.NewEVMBlockContext(block.Header(), nil, &amp;t.json.Env.Coinbase, config, st.StateDB)</span>
 	context.GetHash = vmTestBlockHash
 	context.BaseFee = baseFee
 	context.Random = nil</div>
    </div>

            
            
        </div>
        <div>
            
        </div>
    </div>
</div>

            
        </div>
    </div>
</div>

                
                    <div class="ps-1 py-2 my-1"><div class="row border-bottom border-1"data-bs-toggle="collapse" data-bs-target="#id-83b32dd996cb308d640f40c9"role="button" aria-expanded="false" aria-controls="id-83b32dd996cb308d640f40c9">
        
            <div class="col-12 col-md-12 col-lg-6 col-xl-6 text-start"><h4>Ignored changes</h4></div>
        

        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2">
            <div class="row line-stat">
                
                
            </div>
        </div>
        <div class="col-6 col-md-3 col-xl-2 ms-auto mt-2 ">
            <div class="row line-stat">
                
                
                    <div class="text-end"><span class="text-add-ignored">+6375</span></div>
                    <div class="text-start"><span class="text-delete-ignored">-97</span></div>
                
            </div>
        </div>
    </div>

    <div class="row forkdef-content collapse  border-1 ps-3 my-3" id="id-83b32dd996cb308d640f40c9">
        <div></div>
        <div>
            
            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-muted" data-bs-toggle="collapse" href="#id-a8cdd9639ba7d14f80b3eff3" role="button"
                       aria-expanded="false" aria-controls="id-a8cdd9639ba7d14f80b3eff3">
                        <code>.circleci/check-releases.sh</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/.circleci/check-releases.sh" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-add-ignored">+21</span></div>
                            <div class="text-start"><span class="text-delete-ignored">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-a8cdd9639ba7d14f80b3eff3"><span class="term-fg1">diff --git go-ethereum&#47;.circleci&#47;check-releases.sh op-geth&#47;.circleci&#47;check-releases.sh</span>
<span class="term-fg1">new file mode 100755</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..f3595e1320377bea4b17c13326d87342083071c0</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ op-geth&#47;.circleci&#47;check-releases.sh</span>
<span class="term-fg36">@@ -0,0 +1,21 @@</span>
<span class="term-fg32">+#!&#47;bin&#47;bash</span>
<span class="term-fg32">+set -euo pipefail</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+LATEST_RELEASE=$(curl -s --fail -L \</span>
<span class="term-fg32">+  -H &quot;Accept: application&#47;vnd.github+json&quot; \</span>
<span class="term-fg32">+  -H &quot;X-GitHub-Api-Version: 2022-11-28&quot; \</span>
<span class="term-fg32">+  https:&#47;&#47;api.github.com&#47;repos&#47;ethereum&#47;go-ethereum&#47;releases \</span>
<span class="term-fg32">+  | jq -r &#39;(.[] | select(.draft==false) | select(.prerelease==false)).tag_name&#39; | head -n 1)</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+echo &quot;Detected latest go-ethereum release as ${LATEST_RELEASE}&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+git remote add upstream https:&#47;&#47;github.com&#47;ethereum&#47;go-ethereum</span>
<span class="term-fg32">+git fetch upstream &gt; &#47;dev&#47;null</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+if git branch --contains &quot;${LATEST_RELEASE}&quot; 2&gt;&amp;1 | grep -e &#39;^[ *]*optimism$&#39; &gt; &#47;dev&#47;null</span>
<span class="term-fg32">+then</span>
<span class="term-fg32">+  echo &quot;Up to date with latest release.  Great job! &quot;</span>
<span class="term-fg32">+else</span>
<span class="term-fg32">+  echo &quot;Release has not been merged&quot;</span>
<span class="term-fg32">+  exit 1</span>
<span class="term-fg32">+fi</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-muted" data-bs-toggle="collapse" href="#id-ae6c3fcd7f6402c80b94477b" role="button"
                       aria-expanded="false" aria-controls="id-ae6c3fcd7f6402c80b94477b">
                        <code>.circleci/ci-docker-tag-op-geth-release.sh</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/.circleci/ci-docker-tag-op-geth-release.sh" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-add-ignored">+38</span></div>
                            <div class="text-start"><span class="text-delete-ignored">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-ae6c3fcd7f6402c80b94477b"><span class="term-fg1">diff --git go-ethereum&#47;.circleci&#47;ci-docker-tag-op-geth-release.sh op-geth&#47;.circleci&#47;ci-docker-tag-op-geth-release.sh</span>
<span class="term-fg1">new file mode 100755</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..7b66e789a4d7e50699f2d22ff037117c0d7a3a35</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ op-geth&#47;.circleci&#47;ci-docker-tag-op-geth-release.sh</span>
<span class="term-fg36">@@ -0,0 +1,38 @@</span>
<span class="term-fg32">+#!&#47;usr&#47;bin&#47;env bash</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+set -euo pipefail</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+DOCKER_REPO=$1</span>
<span class="term-fg32">+GIT_TAG=$2</span>
<span class="term-fg32">+GIT_SHA=$3</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+IMAGE_NAME=&quot;op-geth&quot;</span>
<span class="term-fg32">+IMAGE_TAG=$GIT_TAG</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+SOURCE_IMAGE_TAG=&quot;$DOCKER_REPO&#47;$IMAGE_NAME:$GIT_SHA&quot;</span>
<span class="term-fg32">+TARGET_IMAGE_TAG=&quot;$DOCKER_REPO&#47;$IMAGE_NAME:$IMAGE_TAG&quot;</span>
<span class="term-fg32">+TARGET_IMAGE_TAG_LATEST=&quot;$DOCKER_REPO&#47;$IMAGE_NAME:latest&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+echo &quot;Checking if docker images exist for &#39;$IMAGE_NAME&#39;&quot;</span>
<span class="term-fg32">+echo &quot;&quot;</span>
<span class="term-fg32">+tags=$(gcloud container images list-tags &quot;$DOCKER_REPO&#47;$IMAGE_NAME&quot; --limit 1 --format json)</span>
<span class="term-fg32">+if [ &quot;$tags&quot; = &quot;[]&quot; ]; then</span>
<span class="term-fg32">+  echo &quot;No existing docker images were found for &#39;$IMAGE_NAME&#39;. The code tagged with &#39;$GIT_TAG&#39; may not have an associated dockerfile or docker build job.&quot;</span>
<span class="term-fg32">+  echo &quot;If this service has a dockerfile, add a docker-publish job for it in the circleci config.&quot;</span>
<span class="term-fg32">+  echo &quot;&quot;</span>
<span class="term-fg32">+  echo &quot;Exiting&quot;</span>
<span class="term-fg32">+  exit 0</span>
<span class="term-fg32">+fi</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+echo &quot;Tagging $SOURCE_IMAGE_TAG with &#39;$IMAGE_TAG&#39;&quot;</span>
<span class="term-fg32">+gcloud container images add-tag -q &quot;$SOURCE_IMAGE_TAG&quot; &quot;$TARGET_IMAGE_TAG&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+# Do not tag with latest if the release is a release candidate.</span>
<span class="term-fg32">+if [[ &quot;$IMAGE_TAG&quot; == *&quot;rc&quot;* ]]; then</span>
<span class="term-fg32">+  echo &quot;Not tagging with &#39;latest&#39; because the release is a release candidate.&quot;</span>
<span class="term-fg32">+  exit 0</span>
<span class="term-fg32">+fi</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+echo &quot;Tagging $SOURCE_IMAGE_TAG with &#39;latest&#39;&quot;</span>
<span class="term-fg32">+gcloud container images add-tag -q &quot;$SOURCE_IMAGE_TAG&quot; &quot;$TARGET_IMAGE_TAG_LATEST&quot;</span>
<span class="term-fg32">+</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-muted" data-bs-toggle="collapse" href="#id-d1a9f30f2375806be3811a9b" role="button"
                       aria-expanded="false" aria-controls="id-d1a9f30f2375806be3811a9b">
                        <code>.circleci/config.yml</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/.circleci/config.yml" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-add-ignored">+230</span></div>
                            <div class="text-start"><span class="text-delete-ignored">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-d1a9f30f2375806be3811a9b"><span class="term-fg1">diff --git go-ethereum&#47;.circleci&#47;config.yml op-geth&#47;.circleci&#47;config.yml</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..ad9793ad9873c294d4c128d575406fc0710ee20c</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ op-geth&#47;.circleci&#47;config.yml</span>
<span class="term-fg36">@@ -0,0 +1,230 @@</span>
<span class="term-fg32">+version: 2.1</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+orbs:</span>
<span class="term-fg32">+  gcp-cli: circleci&#47;gcp-cli@3.0.1</span>
<span class="term-fg32">+  slack: circleci&#47;slack@4.10.1</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+commands:</span>
<span class="term-fg32">+  gcp-oidc-authenticate:</span>
<span class="term-fg32">+    description: &quot;Authenticate with GCP using a CircleCI OIDC token.&quot;</span>
<span class="term-fg32">+    parameters:</span>
<span class="term-fg32">+      project_id:</span>
<span class="term-fg32">+        type: env_var_name</span>
<span class="term-fg32">+        default: GCP_PROJECT_ID</span>
<span class="term-fg32">+      workload_identity_pool_id:</span>
<span class="term-fg32">+        type: env_var_name</span>
<span class="term-fg32">+        default: GCP_WIP_ID</span>
<span class="term-fg32">+      workload_identity_pool_provider_id:</span>
<span class="term-fg32">+        type: env_var_name</span>
<span class="term-fg32">+        default: GCP_WIP_PROVIDER_ID</span>
<span class="term-fg32">+      service_account_email:</span>
<span class="term-fg32">+        type: env_var_name</span>
<span class="term-fg32">+        default: GCP_SERVICE_ACCOUNT_EMAIL</span>
<span class="term-fg32">+      gcp_cred_config_file_path:</span>
<span class="term-fg32">+        type: string</span>
<span class="term-fg32">+        default: &#47;home&#47;circleci&#47;gcp_cred_config.json</span>
<span class="term-fg32">+      oidc_token_file_path:</span>
<span class="term-fg32">+        type: string</span>
<span class="term-fg32">+        default: &#47;home&#47;circleci&#47;oidc_token.json</span>
<span class="term-fg32">+    steps:</span>
<span class="term-fg32">+      - run:</span>
<span class="term-fg32">+          name: &quot;Create OIDC credential configuration&quot;</span>
<span class="term-fg32">+          command: |</span>
<span class="term-fg32">+            # Store OIDC token in temp file</span>
<span class="term-fg32">+            echo $CIRCLE_OIDC_TOKEN &gt; &lt;&lt; parameters.oidc_token_file_path &gt;&gt;</span>
<span class="term-fg32">+            # Create a credential configuration for the generated OIDC ID Token</span>
<span class="term-fg32">+            gcloud iam workload-identity-pools create-cred-config \</span>
<span class="term-fg32">+                &quot;projects&#47;${&lt;&lt; parameters.project_id &gt;&gt;}&#47;locations&#47;global&#47;workloadIdentityPools&#47;${&lt;&lt; parameters.workload_identity_pool_id &gt;&gt;}&#47;providers&#47;${&lt;&lt; parameters.workload_identity_pool_provider_id &gt;&gt;}&quot;\</span>
<span class="term-fg32">+                --output-file=&quot;&lt;&lt; parameters.gcp_cred_config_file_path &gt;&gt;&quot; \</span>
<span class="term-fg32">+                --service-account=&quot;${&lt;&lt; parameters.service_account_email &gt;&gt;}&quot; \</span>
<span class="term-fg32">+                --credential-source-file=&lt;&lt; parameters.oidc_token_file_path &gt;&gt;</span>
<span class="term-fg32">+      - run:</span>
<span class="term-fg32">+          name: &quot;Authenticate with GCP using OIDC&quot;</span>
<span class="term-fg32">+          command: |</span>
<span class="term-fg32">+            # Configure gcloud to leverage the generated credential configuration</span>
<span class="term-fg32">+            gcloud auth login --brief --cred-file &quot;&lt;&lt; parameters.gcp_cred_config_file_path &gt;&gt;&quot;</span>
<span class="term-fg32">+            # Configure ADC</span>
<span class="term-fg32">+            echo &quot;export GOOGLE_APPLICATION_CREDENTIALS=&#39;&lt;&lt; parameters.gcp_cred_config_file_path &gt;&gt;&#39;&quot; | tee -a &quot;$BASH_ENV&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+jobs:</span>
<span class="term-fg32">+  docker-release:</span>
<span class="term-fg32">+    environment:</span>
<span class="term-fg32">+      DOCKER_BUILDKIT: 1</span>
<span class="term-fg32">+    parameters:</span>
<span class="term-fg32">+      docker_name:</span>
<span class="term-fg32">+        description: Docker image name</span>
<span class="term-fg32">+        type: string</span>
<span class="term-fg32">+        default: &quot;op-geth&quot;</span>
<span class="term-fg32">+      docker_tags:</span>
<span class="term-fg32">+        description: Docker image tags as csv</span>
<span class="term-fg32">+        type: string</span>
<span class="term-fg32">+      registry:</span>
<span class="term-fg32">+        description: Docker registry</span>
<span class="term-fg32">+        type: string</span>
<span class="term-fg32">+        default: &quot;us-docker.pkg.dev&quot;</span>
<span class="term-fg32">+      repo:</span>
<span class="term-fg32">+        description: Docker repo</span>
<span class="term-fg32">+        type: string</span>
<span class="term-fg32">+        default: &quot;oplabs-tools-artifacts&#47;images&quot;</span>
<span class="term-fg32">+      push_tags:</span>
<span class="term-fg32">+        description: Push release push tags</span>
<span class="term-fg32">+        type: boolean</span>
<span class="term-fg32">+        default: false</span>
<span class="term-fg32">+    machine:</span>
<span class="term-fg32">+      image: default</span>
<span class="term-fg32">+      resource_class: xlarge</span>
<span class="term-fg32">+    steps:</span>
<span class="term-fg32">+      - gcp-cli&#47;install</span>
<span class="term-fg32">+      - gcp-oidc-authenticate</span>
<span class="term-fg32">+      - checkout</span>
<span class="term-fg32">+      - run:</span>
<span class="term-fg32">+          name: Configure Docker</span>
<span class="term-fg32">+          command: |</span>
<span class="term-fg32">+            gcloud auth configure-docker &lt;&lt;parameters.registry&gt;&gt;</span>
<span class="term-fg32">+      - run:</span>
<span class="term-fg32">+          name: Build and push</span>
<span class="term-fg32">+          command: |</span>
<span class="term-fg32">+            RAW_TAGS=&quot;&lt;&lt;parameters.docker_tags&gt;&gt;&quot;</span>
<span class="term-fg32">+            if [ &quot;$CIRCLE_BRANCH&quot; = &quot;optimism&quot; ]; then</span>
<span class="term-fg32">+              RAW_TAGS=&quot;$RAW_TAGS,optimism&quot;</span>
<span class="term-fg32">+            fi</span>
<span class="term-fg32">+            IMAGE_BASE=&quot;&lt;&lt;parameters.registry&gt;&gt;&#47;&lt;&lt;parameters.repo&gt;&gt;&#47;&lt;&lt;parameters.docker_name&gt;&gt;&quot;</span>
<span class="term-fg32">+            DOCKER_TAGS=$(echo -ne &quot;$RAW_TAGS&quot; | sed &quot;s&#47;,&#47;\n&#47;g&quot; | sed &quot;s&#47;[^a-zA-Z0-9\n.]&#47;-&#47;g&quot; | sed -e &quot;s|^|-t ${IMAGE_BASE}:|&quot;)</span>
<span class="term-fg32">+            docker context create buildx-build</span>
<span class="term-fg32">+            docker buildx create --use buildx-build</span>
<span class="term-fg32">+            docker buildx build --push \</span>
<span class="term-fg32">+              $(echo -ne $DOCKER_TAGS | tr &#39;\n&#39; &#39; &#39;) \</span>
<span class="term-fg32">+              --platform=linux&#47;arm64,linux&#47;amd64 \</span>
<span class="term-fg32">+              --build-arg VERSION=$CIRCLE_TAG \</span>
<span class="term-fg32">+              --build-arg COMMIT=$CIRCLE_SHA \</span>
<span class="term-fg32">+              --build-arg BUILDNUM=$CIRCLE_BUILD_NUM \</span>
<span class="term-fg32">+              --progress plain \</span>
<span class="term-fg32">+              -f Dockerfile .</span>
<span class="term-fg32">+      - when:</span>
<span class="term-fg32">+          condition:</span>
<span class="term-fg32">+            equal: [ true, &lt;&lt;parameters.push_tags&gt;&gt; ]</span>
<span class="term-fg32">+          steps:</span>
<span class="term-fg32">+            - run:</span>
<span class="term-fg32">+                name: Tag</span>
<span class="term-fg32">+                command: |</span>
<span class="term-fg32">+                  .&#47;.circleci&#47;ci-docker-tag-op-geth-release.sh &lt;&lt;parameters.registry&gt;&gt;&#47;&lt;&lt;parameters.repo&gt;&gt; $CIRCLE_TAG $CIRCLE_SHA1</span>
<span class="term-fg32">+      - when:</span>
<span class="term-fg32">+          condition:</span>
<span class="term-fg32">+            equal: [optimism, &lt;&lt; pipeline.git.branch &gt;&gt;]</span>
<span class="term-fg32">+          steps:</span>
<span class="term-fg32">+            - gcp-oidc-authenticate:</span>
<span class="term-fg32">+                service_account_email: GCP_SERVICE_ATTESTOR_ACCOUNT_EMAIL</span>
<span class="term-fg32">+            - run:</span>
<span class="term-fg32">+                name: Sign</span>
<span class="term-fg32">+                command: |</span>
<span class="term-fg32">+                  git clone --branch v1.0.3 --depth 1 https:&#47;&#47;github.com&#47;ethereum-optimism&#47;binary_signer</span>
<span class="term-fg32">+                  cd binary_signer&#47;signer</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+                  IMAGE_PATH=&quot;&lt;&lt;parameters.registry&gt;&gt;&#47;&lt;&lt;parameters.repo&gt;&gt;&#47;&lt;&lt;parameters.docker_name&gt;&gt;:&lt;&lt;pipeline.git.revision&gt;&gt;&quot;</span>
<span class="term-fg32">+                  echo $IMAGE_PATH</span>
<span class="term-fg32">+                  pip3 install -r requirements.txt</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+                  python3 .&#47;sign_image.py --command=&quot;sign&quot;\</span>
<span class="term-fg32">+                      --attestor-project-name=&quot;$ATTESTOR_PROJECT_NAME&quot;\</span>
<span class="term-fg32">+                      --attestor-name=&quot;$ATTESTOR_NAME&quot;\</span>
<span class="term-fg32">+                      --image-path=&quot;$IMAGE_PATH&quot;\</span>
<span class="term-fg32">+                      --signer-logging-level=&quot;INFO&quot;\</span>
<span class="term-fg32">+                      --attestor-key-id=&quot;&#47;&#47;cloudkms.googleapis.com&#47;v1&#47;projects&#47;$ATTESTOR_PROJECT_NAME&#47;locations&#47;global&#47;keyRings&#47;$ATTESTOR_NAME-key-ring&#47;cryptoKeys&#47;$ATTESTOR_NAME-key&#47;cryptoKeyVersions&#47;1&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+  build-geth:</span>
<span class="term-fg32">+    docker:</span>
<span class="term-fg32">+      - image: cimg&#47;go:1.21</span>
<span class="term-fg32">+    resource_class: xlarge</span>
<span class="term-fg32">+    steps:</span>
<span class="term-fg32">+      - checkout</span>
<span class="term-fg32">+      - run:</span>
<span class="term-fg32">+          command: go run build&#47;ci.go install</span>
<span class="term-fg32">+  unit-test:</span>
<span class="term-fg32">+    resource_class: xlarge</span>
<span class="term-fg32">+    docker:</span>
<span class="term-fg32">+      - image: cimg&#47;go:1.21</span>
<span class="term-fg32">+    steps:</span>
<span class="term-fg32">+      - checkout</span>
<span class="term-fg32">+      - run:</span>
<span class="term-fg32">+          command: go run build&#47;ci.go test</span>
<span class="term-fg32">+  lint-geth:</span>
<span class="term-fg32">+    resource_class: medium</span>
<span class="term-fg32">+    docker:</span>
<span class="term-fg32">+      - image: cimg&#47;go:1.21</span>
<span class="term-fg32">+    steps:</span>
<span class="term-fg32">+      - checkout</span>
<span class="term-fg32">+      - run:</span>
<span class="term-fg32">+          command: go run build&#47;ci.go lint</span>
<span class="term-fg32">+  tidy-geth:</span>
<span class="term-fg32">+    resource_class: small</span>
<span class="term-fg32">+    docker:</span>
<span class="term-fg32">+      - image: cimg&#47;go:1.21</span>
<span class="term-fg32">+    steps:</span>
<span class="term-fg32">+      - checkout</span>
<span class="term-fg32">+      - run:</span>
<span class="term-fg32">+          command: go mod tidy &amp;&amp; git diff --exit-code</span>
<span class="term-fg32">+  check-releases:</span>
<span class="term-fg32">+    docker:</span>
<span class="term-fg32">+      - image: cimg&#47;go:1.21</span>
<span class="term-fg32">+    steps:</span>
<span class="term-fg32">+      - checkout</span>
<span class="term-fg32">+      - run:</span>
<span class="term-fg32">+          command: .circleci&#47;check-releases.sh</span>
<span class="term-fg32">+      - slack&#47;notify:</span>
<span class="term-fg32">+          channel: C03N11M0BBN</span>
<span class="term-fg32">+          branch_pattern: optimism</span>
<span class="term-fg32">+          event: fail</span>
<span class="term-fg32">+          template: basic_fail_1</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+workflows:</span>
<span class="term-fg32">+  main:</span>
<span class="term-fg32">+    jobs:</span>
<span class="term-fg32">+      - build-geth:</span>
<span class="term-fg32">+          name: Build geth</span>
<span class="term-fg32">+      - unit-test:</span>
<span class="term-fg32">+          name: Run unit tests for geth</span>
<span class="term-fg32">+      - lint-geth:</span>
<span class="term-fg32">+          name: Run linter over geth</span>
<span class="term-fg32">+      - tidy-geth:</span>
<span class="term-fg32">+          name: Check geth go.mod file has been tidied</span>
<span class="term-fg32">+      - docker-release:</span>
<span class="term-fg32">+          name: Push to Docker</span>
<span class="term-fg32">+          docker_tags: &lt;&lt;pipeline.git.revision&gt;&gt;</span>
<span class="term-fg32">+          context:</span>
<span class="term-fg32">+            - oplabs-gcr</span>
<span class="term-fg32">+  release:</span>
<span class="term-fg32">+    jobs:</span>
<span class="term-fg32">+      - hold:</span>
<span class="term-fg32">+          type: approval</span>
<span class="term-fg32">+          filters:</span>
<span class="term-fg32">+            tags:</span>
<span class="term-fg32">+              only: &#47;^v.*&#47;</span>
<span class="term-fg32">+            branches:</span>
<span class="term-fg32">+              ignore: &#47;.*&#47;</span>
<span class="term-fg32">+      - docker-release:</span>
<span class="term-fg32">+          name: Push to Docker (release)</span>
<span class="term-fg32">+          filters:</span>
<span class="term-fg32">+            tags:</span>
<span class="term-fg32">+              only: &#47;^v.*&#47;</span>
<span class="term-fg32">+            branches:</span>
<span class="term-fg32">+              ignore: &#47;.*&#47;</span>
<span class="term-fg32">+          docker_tags: &lt;&lt;pipeline.git.revision&gt;&gt;,&lt;&lt;pipeline.git.tag&gt;&gt;</span>
<span class="term-fg32">+          push_tags: true</span>
<span class="term-fg32">+          context:</span>
<span class="term-fg32">+            - oplabs-gcr-release</span>
<span class="term-fg32">+          requires:</span>
<span class="term-fg32">+            - hold</span>
<span class="term-fg32">+  scheduled:</span>
<span class="term-fg32">+    triggers:</span>
<span class="term-fg32">+      - schedule:</span>
<span class="term-fg32">+          # run daily</span>
<span class="term-fg32">+          cron: &quot;0 0 * * *&quot;</span>
<span class="term-fg32">+          filters:</span>
<span class="term-fg32">+            branches:</span>
<span class="term-fg32">+              only: [ &quot;optimism&quot; ]</span>
<span class="term-fg32">+    jobs:</span>
<span class="term-fg32">+      - check-releases:</span>
<span class="term-fg32">+          name: Check for new upstream releases</span>
<span class="term-fg32">+          context: slack</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-muted" data-bs-toggle="collapse" href="#id-a093943239832d470d13940e" role="button"
                       aria-expanded="false" aria-controls="id-a093943239832d470d13940e">
                        <code>.github/CODEOWNERS</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/.github/CODEOWNERS" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/.github/CODEOWNERS" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-add-ignored">+0</span></div>
                            <div class="text-start"><span class="text-delete-ignored">-27</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-a093943239832d470d13940e"><span class="term-fg1">diff --git go-ethereum&#47;.github&#47;CODEOWNERS op-geth&#47;.github&#47;CODEOWNERS</span>
<span class="term-fg1">index ec2efb10e354c616e8b6d937d2b0d689b3050d25..a52ce4b85b205e9378cd398ffd103616baabda0a 100644</span>
<span class="term-fg1">--- go-ethereum&#47;.github&#47;CODEOWNERS</span>
<span class="term-fg1">+++ op-geth&#47;.github&#47;CODEOWNERS</span>
<span class="term-fg36">@@ -1,27 +1 @@</span>
<span class="term-fg31">-# Lines starting with &#39;#&#39; are comments.</span>
<span class="term-fg31">-# Each line is a file pattern followed by one or more owners.</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-accounts&#47;usbwallet              @karalabe</span>
<span class="term-fg31">-accounts&#47;scwallet               @gballet</span>
<span class="term-fg31">-accounts&#47;abi                    @gballet @MariusVanDerWijden</span>
<span class="term-fg31">-beacon&#47;engine                   @lightclient</span>
<span class="term-fg31">-cmd&#47;clef                        @holiman</span>
<span class="term-fg31">-cmd&#47;evm                         @holiman @MariusVanDerWijden @lightclient</span>
<span class="term-fg31">-consensus                       @karalabe</span>
<span class="term-fg31">-core&#47;                           @karalabe @holiman @rjl493456442</span>
<span class="term-fg31">-eth&#47;                            @karalabe @holiman @rjl493456442</span>
<span class="term-fg31">-eth&#47;catalyst&#47;                   @gballet @lightclient</span>
<span class="term-fg31">-eth&#47;tracers&#47;                    @s1na</span>
<span class="term-fg31">-core&#47;tracing&#47;                   @s1na</span>
<span class="term-fg31">-graphql&#47;                        @s1na</span>
<span class="term-fg31">-internal&#47;ethapi                 @lightclient</span>
<span class="term-fg31">-internal&#47;era                    @lightclient</span>
<span class="term-fg31">-les&#47;                            @zsfelfoldi @rjl493456442</span>
<span class="term-fg31">-light&#47;                          @zsfelfoldi @rjl493456442</span>
<span class="term-fg31">-node&#47;                           @fjl</span>
<span class="term-fg31">-p2p&#47;                            @fjl @zsfelfoldi</span>
<span class="term-fg31">-rpc&#47;                            @fjl @holiman</span>
<span class="term-fg31">-p2p&#47;simulations                 @fjl</span>
<span class="term-fg31">-p2p&#47;protocols                   @fjl</span>
<span class="term-fg31">-p2p&#47;testing                     @fjl</span>
<span class="term-fg31">-signer&#47;                         @holiman</span>
<span class="term-fg32">+*  @ethereum-optimism&#47;op-geth-maintainers</span>
<span class="term-fg32">\ No newline at end of file</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-muted" data-bs-toggle="collapse" href="#id-09970bc30de1833ba3745421" role="button"
                       aria-expanded="false" aria-controls="id-09970bc30de1833ba3745421">
                        <code>.github/workflows/go.yml</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/.github/workflows/go.yml" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/.github/workflows/go.yml" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-add-ignored">+0</span></div>
                            <div class="text-start"><span class="text-delete-ignored">-24</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-09970bc30de1833ba3745421"><span class="term-fg1">diff --git go-ethereum&#47;.github&#47;workflows&#47;go.yml op-geth&#47;.github&#47;workflows&#47;go.yml</span>
<span class="term-fg1">index 844cfb5d242a56ae936fbd94f586fe4a33909b4d..e69de29bb2d1d6434b8b29ae775ad8c2e48c5391 100644</span>
<span class="term-fg1">--- go-ethereum&#47;.github&#47;workflows&#47;go.yml</span>
<span class="term-fg1">+++ op-geth&#47;.github&#47;workflows&#47;go.yml</span>
<span class="term-fg36">@@ -1,24 +0,0 @@</span>
<span class="term-fg31">-name: i386 linux tests</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-on:</span>
<span class="term-fg31">-  push:</span>
<span class="term-fg31">-    branches: [ master ]</span>
<span class="term-fg31">-  pull_request:</span>
<span class="term-fg31">-    branches: [ master ]</span>
<span class="term-fg31">-  workflow_dispatch:</span>
<span class="term-fg31">-</span>
<span class="term-fg31">-jobs:</span>
<span class="term-fg31">-  build:</span>
<span class="term-fg31">-    runs-on: self-hosted</span>
<span class="term-fg31">-    steps:</span>
<span class="term-fg31">-      - uses: actions&#47;checkout@v4</span>
<span class="term-fg31">-      - name: Set up Go</span>
<span class="term-fg31">-        uses: actions&#47;setup-go@v5</span>
<span class="term-fg31">-        with:</span>
<span class="term-fg31">-          go-version: 1.21.4</span>
<span class="term-fg31">-          cache: false</span>
<span class="term-fg31">-      - name: Run tests</span>
<span class="term-fg31">-        run: go test -short .&#47;...</span>
<span class="term-fg31">-        env:</span>
<span class="term-fg31">-          GOOS: linux</span>
<span class="term-fg31">-          GOARCH: 386</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-muted" data-bs-toggle="collapse" href="#id-df4b77d64cf284f10e3e1504" role="button"
                       aria-expanded="false" aria-controls="id-df4b77d64cf284f10e3e1504">
                        <code>.github/workflows/pages.yaml</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/.github/workflows/pages.yaml" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-add-ignored">+36</span></div>
                            <div class="text-start"><span class="text-delete-ignored">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-df4b77d64cf284f10e3e1504"><span class="term-fg1">diff --git go-ethereum&#47;.github&#47;workflows&#47;pages.yaml op-geth&#47;.github&#47;workflows&#47;pages.yaml</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..3c45b5d3390e8fa379824c7001f308ad721a2f86</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ op-geth&#47;.github&#47;workflows&#47;pages.yaml</span>
<span class="term-fg36">@@ -0,0 +1,36 @@</span>
<span class="term-fg32">+name: Build and publish forkdiff github-pages</span>
<span class="term-fg32">+permissions:</span>
<span class="term-fg32">+  contents: write</span>
<span class="term-fg32">+on:</span>
<span class="term-fg32">+  push:</span>
<span class="term-fg32">+    branches:</span>
<span class="term-fg32">+      - optimism</span>
<span class="term-fg32">+jobs:</span>
<span class="term-fg32">+  deploy:</span>
<span class="term-fg32">+    concurrency: ci-${{ github.ref }}</span>
<span class="term-fg32">+    runs-on: ubuntu-latest</span>
<span class="term-fg32">+    steps:</span>
<span class="term-fg32">+      - name: Checkout</span>
<span class="term-fg32">+        uses: actions&#47;checkout@v3</span>
<span class="term-fg32">+        with:</span>
<span class="term-fg32">+          fetch-depth: 1000  # make sure to fetch the old commit we diff against</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+      - name: Build forkdiff</span>
<span class="term-fg32">+        uses: &quot;docker:&#47;&#47;protolambda&#47;forkdiff:0.1.0&quot;</span>
<span class="term-fg32">+        with:</span>
<span class="term-fg32">+          args: -repo=&#47;github&#47;workspace -fork=&#47;github&#47;workspace&#47;fork.yaml -out=&#47;github&#47;workspace&#47;index.html</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+      - name: Build pages</span>
<span class="term-fg32">+        run: |</span>
<span class="term-fg32">+          mkdir -p tmp&#47;pages</span>
<span class="term-fg32">+          mv index.html tmp&#47;pages&#47;index.html</span>
<span class="term-fg32">+          touch tmp&#47;pages&#47;.nojekyll</span>
<span class="term-fg32">+          if [ &quot;$GITHUB_REPOSITORY&quot; == &quot;ethereum-optimism&#47;op-geth&quot; ]; then</span>
<span class="term-fg32">+              echo &quot;op-geth.optimism.io&quot; &gt; tmp&#47;pages&#47;CNAME</span>
<span class="term-fg32">+          fi;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+      - name: Deploy</span>
<span class="term-fg32">+        uses: JamesIves&#47;github-pages-deploy-action@v4</span>
<span class="term-fg32">+        with:</span>
<span class="term-fg32">+          folder: tmp&#47;pages</span>
<span class="term-fg32">+          clean: true</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-muted" data-bs-toggle="collapse" href="#id-eb3659712a772e5c6eaf60d1" role="button"
                       aria-expanded="false" aria-controls="id-eb3659712a772e5c6eaf60d1">
                        <code>.golangci.yml</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/.golangci.yml" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/.golangci.yml" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-add-ignored">+5</span></div>
                            <div class="text-start"><span class="text-delete-ignored">-2</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-eb3659712a772e5c6eaf60d1"><span class="term-fg1">diff --git go-ethereum&#47;.golangci.yml op-geth&#47;.golangci.yml</span>
<span class="term-fg1">index 2132f5403ab7793c9be1d7c211c9aa75b28e0eca..75fa12383184edceadbf356157b283d870857d86 100644</span>
<span class="term-fg1">--- go-ethereum&#47;.golangci.yml</span>
<span class="term-fg1">+++ op-geth&#47;.golangci.yml</span>
<span class="term-fg36">@@ -1,11 +1,12 @@</span>
 # This file configures github.com&#47;golangci&#47;golangci-lint.
<span class="term-fg32">+# see &lt;https:&#47;&#47;golangci-lint.run&#47;usage&#47;configuration&gt;</span>
&nbsp;
 run:
   timeout: 20m
   tests: true
   # default is true. Enables skipping of directories:
   #   vendor$, third_party$, testdata$, examples$, Godeps$, builtin$
<span class="term-fg31">-  skip-dirs-use-default: true</span>
<span class="term-fg32">+</span>
&nbsp;
 linters:
   disable-all: true
<span class="term-fg36">@@ -50,7 +51,8 @@</span>         disabled: false
         exclude: [&quot;&quot;]
&nbsp;
 issues:
<span class="term-fg31">-  exclude-files:</span>
<span class="term-fg32">+  exclude-dirs-use-default: true</span>
<span class="term-fg32">+  exclude-dirs:</span>
     - core&#47;genesis_alloc.go
   exclude-rules:
     - path: crypto&#47;bn256&#47;cloudflare&#47;optate.go
<span class="term-fg36">@@ -73,3 +75,4 @@</span>     - &#39;SA1019: event.TypeMux is deprecated: use Feed&#39;
     - &#39;SA1019: strings.Title is deprecated&#39;
     - &#39;SA1019: strings.Title has been deprecated since Go 1.18 and an alternative has been available since Go 1.0: The rule Title uses for word boundaries does not handle Unicode punctuation properly. Use golang.org&#47;x&#47;text&#47;cases instead.&#39;
     - &#39;SA1029: should not use built-in type string as key for value&#39;
<span class="term-fg32">+    - &#39;SA1019:&#39; # temporary, until fully updated to Go 1.21</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-muted" data-bs-toggle="collapse" href="#id-8a83a4a611b1c1bae5834b7e" role="button"
                       aria-expanded="false" aria-controls="id-8a83a4a611b1c1bae5834b7e">
                        <code>Makefile</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/Makefile" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/Makefile" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-add-ignored">+6</span></div>
                            <div class="text-start"><span class="text-delete-ignored">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-8a83a4a611b1c1bae5834b7e"><span class="term-fg1">diff --git go-ethereum&#47;Makefile op-geth&#47;Makefile</span>
<span class="term-fg1">index 857cb8c9789991d7669d99fb2a961a49b604a1ac..750615fd997ad012a331a37821de20066d0cb285 100644</span>
<span class="term-fg1">--- go-ethereum&#47;Makefile</span>
<span class="term-fg1">+++ op-geth&#47;Makefile</span>
<span class="term-fg36">@@ -47,6 +47,12 @@</span> 	env GOBIN= go install .&#47;cmd&#47;abigen
 	@type &quot;solc&quot; 2&gt; &#47;dev&#47;null || echo &#39;Please install solc&#39;
 	@type &quot;protoc&quot; 2&gt; &#47;dev&#47;null || echo &#39;Please install protoc&#39;
&nbsp;
<span class="term-fg32">+forkdiff:</span>
<span class="term-fg32">+	docker run --rm \</span>
<span class="term-fg32">+		--mount src=$(shell pwd),target=&#47;host-pwd,type=bind \</span>
<span class="term-fg32">+		protolambda&#47;forkdiff:latest \</span>
<span class="term-fg32">+		-repo &#47;host-pwd&#47; -fork &#47;host-pwd&#47;fork.yaml -out &#47;host-pwd&#47;forkdiff.html</span>
<span class="term-fg32">+</span>
 #? help: Get more info on make commands.
 help: Makefile
 	@echo &#39;&#39;</div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-muted" data-bs-toggle="collapse" href="#id-989ffaf67111b6fae2efd351" role="button"
                       aria-expanded="false" aria-controls="id-989ffaf67111b6fae2efd351">
                        <code>core/vm/testdata/precompiles/p256Verify.json</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/core/vm/testdata/precompiles/p256Verify.json" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-add-ignored">+5468</span></div>
                            <div class="text-start"><span class="text-delete-ignored">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-989ffaf67111b6fae2efd351"><span class="term-fg1">diff --git go-ethereum&#47;core&#47;vm&#47;testdata&#47;precompiles&#47;p256Verify.json op-geth&#47;core&#47;vm&#47;testdata&#47;precompiles&#47;p256Verify.json</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..b631d907ac523bd8ca8e3712314a0047f4cf4115</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ op-geth&#47;core&#47;vm&#47;testdata&#47;precompiles&#47;p256Verify.json</span>
<span class="term-fg36">@@ -0,0 +1,5469 @@</span>
<span class="term-fg32">+[</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050232ba3a8be6b94d5ec80a6d9d1190a436effe50d85a1eee859b8cc6af9bd5c2e184cd60b855d442f5b3c7b11eb6c4e0ae7525fe710fab9aa7c77a67f79e6fadd762927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #1: signature malleability&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023d45c5740946b2a147f59262ee6f5bc90bd01ed280528b62b3aed5fc93f06f739b329f479a2bbd0a5c384ee1493b1f5186a87139cac5df4087c134b49156847db2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #3: Modified r or s, e.g. by adding or subtracting the order of the group&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023d45c5741946b2a137f59262ee6f5bc91001af27a5e1117a64733950642a3d1e8b329f479a2bbd0a5c384ee1493b1f5186a87139cac5df4087c134b49156847db2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #5: Modified r or s, e.g. by adding or subtracting the order of the group&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050232ba3a8be6b94d5ec80a6d9d1190a436effe50d85a1eee859b8cc6af9bd5c2e184cd60b865d442f5a3c7b11eb6c4e0ae79578ec6353a20bf783ecb4b6ea97b8252927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #8: Modified r or s, e.g. by adding or subtracting the order of the group&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #9: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000012927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #10: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050230000000000000000000000000000000000000000000000000000000000000000ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325512927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #11: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050230000000000000000000000000000000000000000000000000000000000000000ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325502927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #12: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050230000000000000000000000000000000000000000000000000000000000000000ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325522927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #13: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050230000000000000000000000000000000000000000000000000000000000000000ffffffff00000001000000000000000000000000ffffffffffffffffffffffff2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #14: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050230000000000000000000000000000000000000000000000000000000000000000ffffffff000000010000000000000000000000010000000000000000000000002927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #15: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000002927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #16: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000012927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #17: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050230000000000000000000000000000000000000000000000000000000000000001ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325512927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #18: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050230000000000000000000000000000000000000000000000000000000000000001ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325502927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #19: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050230000000000000000000000000000000000000000000000000000000000000001ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325522927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #20: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050230000000000000000000000000000000000000000000000000000000000000001ffffffff00000001000000000000000000000000ffffffffffffffffffffffff2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #21: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050230000000000000000000000000000000000000000000000000000000000000001ffffffff000000010000000000000000000000010000000000000000000000002927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #22: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc63255100000000000000000000000000000000000000000000000000000000000000002927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #23: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc63255100000000000000000000000000000000000000000000000000000000000000012927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #24: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325512927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #25: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325502927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #26: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325522927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #27: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551ffffffff00000001000000000000000000000000ffffffffffffffffffffffff2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #28: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551ffffffff000000010000000000000000000000010000000000000000000000002927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #29: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc63255000000000000000000000000000000000000000000000000000000000000000002927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #30: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc63255000000000000000000000000000000000000000000000000000000000000000012927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #31: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632550ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325512927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #32: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632550ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325502927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #33: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632550ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325522927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #34: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632550ffffffff00000001000000000000000000000000ffffffffffffffffffffffff2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #35: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632550ffffffff000000010000000000000000000000010000000000000000000000002927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #36: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc63255200000000000000000000000000000000000000000000000000000000000000002927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #37: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc63255200000000000000000000000000000000000000000000000000000000000000012927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #38: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632552ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325512927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #39: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632552ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325502927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #40: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632552ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325522927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #41: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632552ffffffff00000001000000000000000000000000ffffffffffffffffffffffff2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #42: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632552ffffffff000000010000000000000000000000010000000000000000000000002927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #43: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000001000000000000000000000000ffffffffffffffffffffffff00000000000000000000000000000000000000000000000000000000000000002927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #44: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000001000000000000000000000000ffffffffffffffffffffffff00000000000000000000000000000000000000000000000000000000000000012927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #45: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000001000000000000000000000000ffffffffffffffffffffffffffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325512927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #46: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000001000000000000000000000000ffffffffffffffffffffffffffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325502927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #47: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000001000000000000000000000000ffffffffffffffffffffffffffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325522927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #48: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000001000000000000000000000000ffffffffffffffffffffffffffffffff00000001000000000000000000000000ffffffffffffffffffffffff2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #49: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000001000000000000000000000000ffffffffffffffffffffffffffffffff000000010000000000000000000000010000000000000000000000002927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #50: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff0000000100000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000002927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #51: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff0000000100000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000012927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #52: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000001000000000000000000000001000000000000000000000000ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325512927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #53: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000001000000000000000000000001000000000000000000000000ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325502927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #54: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000001000000000000000000000001000000000000000000000000ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325522927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #55: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000001000000000000000000000001000000000000000000000000ffffffff00000001000000000000000000000000ffffffffffffffffffffffff2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #56: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000001000000000000000000000001000000000000000000000000ffffffff000000010000000000000000000000010000000000000000000000002927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #57: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;70239dd877f7c944c422f44dea4ed1a52f2627416faf2f072fa50c772ed6f80764a1aab5000d0e804f3e2fc02bdee9be8ff312334e2ba16d11547c97711c898e6af015971cc30be6d1a206d4e013e0997772a2f91d73286ffd683b9bb2cf4f1b2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #58: Edge case for Shamir multiplication&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;00000000690ed426ccf17803ebe2bd0884bcd58a1bb5e7477ead3645f356e7a916aea964a2f6506d6f78c81c91fc7e8bded7d397738448de1e19a0ec580bf266252cd762130c6667cfe8b7bc47d27d78391e8e80c578d1cd38c3ff033be928e92927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #59: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;7300000000213f2a525c6035725235c2f696ad3ebb5ee47f140697ad25770d919cc98be2347d469bf476dfc26b9b733df2d26d6ef524af917c665baccb23c882093496459effe2d8d70727b82462f61d0ec1b7847929d10ea631dacb16b56c322927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #60: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;ddf2000000005e0be0635b245f0b97978afd25daadeb3edb4a0161c27fe0604573b3c90ecd390028058164524dde892703dce3dea0d53fa8093999f07ab8aa432f67b0b8e20636695bb7d8bf0a651c802ed25a395387b5f4188c0c4075c886342927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #61: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;67ab1900000000784769c4ecb9e164d6642b8499588b89855be1ec355d0841a0bfab3098252847b328fadf2f89b95c851a7f0eb390763378f37e90119d5ba3ddbdd64e234e832b1067c2d058ccb44d978195ccebb65c2aaf1e2da9b8b4987e3b2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #62: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;a2bf09460000000076d7dbeffe125eaf02095dff252ee905e296b6350fc311cf204a9784074b246d8bf8bf04a4ceb1c1f1c9aaab168b1596d17093c5cd21d2cd51cce41670636783dc06a759c8847868a406c2506fe17975582fe648d1d88b522927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #63: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;3554e827c700000000e1e75e624a06b3a0a353171160858129e15c544e4f0e65ed66dc34f551ac82f63d4aa4f81fe2cb0031a91d1314f835027bca0f1ceeaa0399ca123aa09b13cd194a422e18d5fda167623c3f6e5d4d6abb8953d67c0c48c72927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #64: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;9b6cd3b812610000000026941a0f0bb53255ea4c9fd0cb3426e3a54b9fc6965c060b700bef665c68899d44f2356a578d126b062023ccc3c056bf0f60a237012b8d186c027832965f4fcc78a3366ca95dedbb410cbef3f26d6be5d581c11d36102927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #65: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;883ae39f50bf0100000000e7561c26fc82a52baa51c71ca877162f93c4ae01869f6adfe8d5eb5b2c24d7aa7934b6cf29c93ea76cd313c9132bb0c8e38c96831db26a9c9e40e55ee0890c944cf271756c906a33e66b5bd15e051593883b5e99022927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #66: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;a1ce5d6e5ecaf28b0000000000fa7cd010540f420fb4ff7401fe9fce011d0ba6a1af03ca91677b673ad2f33615e56174a1abf6da168cebfa8868f4ba273f16b720aa73ffe48afa6435cd258b173d0c2377d69022e7d098d75caf24c8c5e06b1c2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #67: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;8ea5f645f373f580930000000038345397330012a8ee836c5494cdffd5ee8054fdc70602766f8eed11a6c99a71c973d5659355507b843da6e327a28c11893db93df5349688a085b137b1eacf456a9e9e0f6d15ec0078ca60a7f83f2b10d213502927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #68: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;660570d323e9f75fa734000000008792d65ce93eabb7d60d8d9c1bbdcb5ef305b516a314f2fce530d6537f6a6c49966c23456f63c643cf8e0dc738f7b876e675d39ffd033c92b6d717dd536fbc5efdf1967c4bd80954479ba66b0120cd16fff22927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #69: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;d0462673154cce587dde8800000000e98d35f1f45cf9c3bf46ada2de4c568c343b2cbf046eac45842ecb7984d475831582717bebb6492fd0a485c101e29ff0a84c9b7b47a98b0f82de512bc9313aaf51701099cac5f76e68c8595fc1c1d992582927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #70: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bd90640269a7822680cedfef000000000caef15a6171059ab83e7b4418d7278f30c87d35e636f540841f14af54e2f9edd79d0312cfa1ab656c3fb15bfde48dcf47c15a5a82d24b75c85a692bd6ecafeb71409ede23efd08e0db9abf6340677ed2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #71: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;33239a52d72f1311512e41222a00000000d2dcceb301c54b4beae8e284788a7338686ff0fda2cef6bc43b58cfe6647b9e2e8176d168dec3c68ff262113760f52067ec3b651f422669601662167fa8717e976e2db5e6a4cf7c2ddabb3fde9d67d2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #72: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;b8d64fbcd4a1c10f1365d4e6d95c000000007ee4a21a1cbe1dc84c2d941ffaf144a3e23bf314f2b344fc25c7f2de8b6af3e17d27f5ee844b225985ab6e2775cf2d48e223205e98041ddc87be532abed584f0411f5729500493c9cc3f4dd15e862927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #73: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;01603d3982bf77d7a3fef3183ed092000000003a227420db4088b20fe0e9d84a2ded5b7ec8e90e7bf11f967a3d95110c41b99db3b5aa8d330eb9d638781688e97d5792c53628155e1bfc46fb1a67e3088de049c328ae1f44ec69238a009808f92927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #74: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;9ea6994f1e0384c8599aa02e6cf66d9c000000004d89ef50b7e9eb0cfbff7363bdae7bcb580bf335efd3bc3d31870f923eaccafcd40ec2f605976f15137d8b8ff6dfa12f19e525270b0106eecfe257499f373a4fb318994f24838122ce7ec3c72927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #75: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;d03215a8401bcf16693979371a01068a4700000000e2fa5bf692bc670905b18c50f9c4f0cd6940e162720957ffff513799209b78596956d21ece251c2401f1c6d7033a0a787d338e889defaaabb106b95a4355e411a59c32aa5167dfab2447262927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #76: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;307bfaaffb650c889c84bf83f0300e5dc87e000000008408fd5f64b582e3bb14f612820687604fa01906066a378d67540982e29575d019aabe90924ead5c860d3f9367702dd7dd4f75ea98afd20e328a1a99f4857b316525328230ce294b0fef2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #77: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bab5c4f4df540d7b33324d36bb0c157551527c00000000e4af574bb4d54ea6b89505e407657d6e8bc93db5da7aa6f5081f61980c1949f56b0f2f507da5782a7ac60d31904e3669738ffbeccab6c3656c08e0ed5cb92b3cfa5e7f71784f9c50212927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #78: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;d4ba47f6ae28f274e4f58d8036f9c36ec2456f5b00000000c3b869197ef5e15ebbd16fbbb656b6d0d83e6a7787cd691b08735aed371732723e1c68a40404517d9d8e35dba96028b7787d91315be675877d2d097be5e8ee34560e3e7fd25c0f002927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #79: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;79fd19c7235ea212f29f1fa00984342afe0f10aafd00000000801e47f8c184e12ec9760122db98fd06ea76848d35a6da442d2ceef7559a30cf57c61e92df327e7ab271da90859479701fccf86e462ee3393fb6814c27b760c4963625c0a198782927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #80: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;8c291e8eeaa45adbaf9aba5c0583462d79cbeb7ac97300000000a37ea6700cda54e76b7683b6650baa6a7fc49b1c51eed9ba9dd463221f7a4f1005a89fe00c592ea076886c773eb937ec1cc8374b7915cfd11b1c1ae1166152f2f7806a31c8fd2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #81: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;0eaae8641084fa979803efbfb8140732f4cdcf66c3f78a000000003c278a6b215291deaf24659ffbbce6e3c26f6021097a74abdbb69be4fb10419c0c496c946665d6fcf336d27cc7cdb982bb4e4ecef5827f84742f29f10abf83469270a03dc32927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #82: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;e02716d01fb23a5a0068399bf01bab42ef17c6d96e13846c00000000afc0f89d207a3241812d75d947419dc58efb05e8003b33fc17eb50f9d15166a88479f107cdee749f2e492b213ce80b32d0574f62f1c5d70793cf55e382d5caadf75927672927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #83: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;9eb0bf583a1a6b9a194e9a16bc7dab2a9061768af89d00659a00000000fc7de16554e49f82a855204328ac94913bf01bbe84437a355a0a37c0dee3cf81aa7728aea00de2507ddaf5c94e1e126980d3df16250a2eaebc8be486effe7f22b4f9292927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #84: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;62aac98818b3b84a2c214f0d5e72ef286e1030cb53d9a82b690e00000000cd15a54c5062648339d2bff06f71c88216c26c6e19b4d80a8c602990ac82707efdfce99bbe7fcfafae3e69fd016777517aa01056317f467ad09aff09be73c9731b0d2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #85: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;3760a7f37cf96218f29ae43732e513efd2b6f552ea4b6895464b9300000000c8975bd7157a8d363b309f1f444012b1a1d23096593133e71b4ca8b059cff37eaf7faa7a28b1c822baa241793f2abc930bd4c69840fe090f2aacc46786bf9196222927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #86: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;0da0a1d2851d33023834f2098c0880096b4320bea836cd9cbb6ff6c8000000005694a6f84b8f875c276afd2ebcfe4d61de9ec90305afb1357b95b3e0da43885e0dffad9ffd0b757d8051dec02ebdf70d8ee2dc5c7870c0823b6ccc7c679cbaa42927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #87: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;ffffffff293886d3086fd567aafd598f0fe975f735887194a764a231e82d289aa0c30e8026fdb2b4b4968a27d16a6d08f7098f1a98d21620d7454ba9790f1ba65e470453a8a399f15baf463f9deceb53acc5ca64459149688bd2760c654243392927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #88: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;7bffffffff2376d1e3c03445a072e24326acdc4ce127ec2e0e8d9ca99527e7b7614ea84acf736527dd73602cd4bb4eea1dfebebd5ad8aca52aa0228cf7b99a88737cc85f5f2d2f60d1b8183f3ed490e4de14368e96a9482c2a4dd193195c902f2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #89: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;a2b5ffffffffebb251b085377605a224bc80872602a6e467fd016807e97fa395bead6734ebe44b810d3fb2ea00b1732945377338febfd439a8d74dfbd0f942fa6bb18eae36616a7d3cad35919fd21a8af4bbe7a10f73b3e036a46b103ef56e2a2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #90: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;641227ffffffff6f1b96fa5f097fcf3cc1a3c256870d45a67b83d0967d4b20c0499625479e161dacd4db9d9ce64854c98d922cbf212703e9654fae182df9bad242c177cf37b8193a0131108d97819edd9439936028864ac195b64fca76d9d6932927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #91: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;958415d8ffffffffabad03e2fc662dc3ba203521177502298df56f36600e0f8b08f16b8093a8fb4d66a2c8065b541b3d31e3bfe694f6b89c50fb1aaa6ff6c9b29d6455e2d5d1779748573b611cb95d4a21f967410399b39b535ba3e5af81ca2e2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #92: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;f1d8de4858ffffffff1281093536f47fe13deb04e1fbe8fb954521b6975420f8be26231b6191658a19dd72ddb99ed8f8c579b6938d19bce8eed8dc2b338cb5f8e1d9a32ee56cffed37f0f22b2dcb57d5c943c14f79694a03b9c5e96952575c892927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #93: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;0927895f2802ffffffff10782dd14a3b32dc5d47c05ef6f1876b95c81fc31def15e76880898316b16204ac920a02d58045f36a229d4aa4f812638c455abe0443e74d357d3fcb5c8c5337bd6aba4178b455ca10e226e13f9638196506a19391232927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #94: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;60907984aa7e8effffffff4f332862a10a57c3063fb5a30624cf6a0c3ac80589352ecb53f8df2c503a45f9846fc28d1d31e6307d3ddbffc1132315cc07f16dad1348dfa9c482c558e1d05c5242ca1c39436726ecd28258b1899792887dd0a3c62927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #95: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;c6ff198484939170ffffffff0af42cda50f9a5f50636ea6942d6b9b8cd6ae1e24a40801a7e606ba78a0da9882ab23c7677b8642349ed3d652c5bfa5f2a9558fb3a49b64848d682ef7f605f2832f7384bdc24ed2925825bf8ea77dc59817257822927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #96: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;de030419345ca15c75ffffffff8074799b9e0956cc43135d16dfbe4d27d7e68deacc5e1a8304a74d2be412b078924b3bb3511bac855c05c9e5e9e44df3d61e967451cd8e18d6ed1885dd827714847f96ec4bb0ed4c36ce9808db8f714204f6d12927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #97: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;6f0e3eeaf42b28132b88fffffffff6c8665604d34acb19037e1ab78caaaac6ff2f7a5e9e5771d424f30f67fdab61e8ce4f8cd1214882adb65f7de94c31577052ac4e69808345809b44acb0b2bd889175fb75dd050c5a449ab9528f8f78daa10c2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #98: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;cdb549f773b3e62b3708d1ffffffffbe48f7c0591ddcae7d2cb222d1f8017ab9ffcda40f792ce4d93e7e0f0e95e1a2147dddd7f6487621c30a03d710b330021979938b55f8a17f7ed7ba9ade8f2065a1fa77618f0b67add8d58c422c2453a49a2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #99: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2c3f26f96a3ac0051df4989bffffffff9fd64886c1dc4f9924d8fd6f0edb048481f2359c4faba6b53d3e8c8c3fcc16a948350f7ab3a588b28c17603a431e39a8cd6f6a5cc3b55ead0ff695d06c6860b509e46d99fccefb9f7f9e101857f743002927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #100: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;ac18f8418c55a2502cb7d53f9affffffff5c31d89fda6a6b8476397c04edf411dfc8bf520445cbb8ee1596fb073ea283ea130251a6fdffa5c3f5f2aaf75ca808048e33efce147c9dd92823640e338e68bfd7d0dc7a4905b3a7ac711e577e90e72927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #101: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;4f9618f98e2d3a15b24094f72bb5ffffffffa2fd3e2893683e5a6ab8cf0ee610ad019f74c6941d20efda70b46c53db166503a0e393e932f688227688ba6a576293320eb7ca0710255346bdbb3102cdcf7964ef2e0988e712bc05efe16c1993452927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #102: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;422e82a3d56ed10a9cc21d31d37a25ffffffff67edf7c40204caae73ab0bc75aac8096842e8add68c34e78ce11dd71e4b54316bd3ebf7fffdeb7bd5a3ebc1883f5ca2f4f23d674502d4caf85d187215d36e3ce9f0ce219709f21a3aac003b7a82927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #103: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;7075d245ccc3281b6e7b329ff738fbb417a5ffffffffa0842d9890b5cf95d018677b2d3a59b18a5ff939b70ea002250889ddcd7b7b9d776854b4943693fb92f76b4ba856ade7677bf30307b21f3ccda35d2f63aee81efd0bab6972cc0795db552927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #104: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;3c80de54cd9226989443d593fa4fd6597e280ebeffffffffc1847eb76c217a95479e1ded14bcaed0379ba8e1b73d3115d84d31d4b7c30e1f05e1fc0d5957cfb0918f79e35b3d89487cf634a4f05b2e0c30857ca879f97c771e877027355b24432927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #105: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;de21754e29b85601980bef3d697ea2770ce891a8cdffffffffc7906aa794b39b43dfccd0edb9e280d9a58f01164d55c3d711e14b12ac5cf3b64840ead512a0a31dbe33fa8ba84533cd5c4934365b3442ca1174899b78ef9a3199f495843897722927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #106: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;8f65d92927cfb86a84dd59623fb531bb599e4d5f7289ffffffff2f1f2f57881c5b09ab637bd4caf0f4c7c7e4bca592fea20e9087c259d26a38bb4085f0bbff1145b7eb467b6748af618e9d80d6fdcd6aa24964e5a13f885bca8101de08eb0d752927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #107: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;6b63e9a74e092120160bea3877dace8a2cc7cd0e8426cbfffffffffafc8c3ca85e9b1c5a028070df5728c5c8af9b74e0667afa570a6cfa0114a5039ed15ee06fb1360907e2d9785ead362bb8d7bd661b6c29eeffd3c5037744edaeb9ad990c202927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #108: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;fc28259702a03845b6d75219444e8b43d094586e249c8699ffffffffe852512e0671a0a85c2b72d54a2fb0990e34538b4890050f5a5712f6d1a7a5fb8578f32edb1846bab6b7361479ab9c3285ca41291808f27fd5bd4fdac720e5854713694c2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #109: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;1273b4502ea4e3bccee044ee8e8db7f774ecbcd52e8ceb571757ffffffffe20a7673f8526748446477dbbb0590a45492c5d7d69859d301abbaedb35b2095103a3dc70ddf9c6b524d886bed9e6af02e0e4dec0d417a414fed3807ef4422913d7c2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #110: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;08fb565610a79baa0c566c66228d81814f8c53a15b96e602fb49ffffffffff6e7f085441070ecd2bb21285089ebb1aa6450d1a06c36d3ff39dfd657a796d12b5249712012029870a2459d18d47da9aa492a5e6cb4b2d8dafa9e4c5c54a2b9a8b2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #111: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;d59291cc2cf89f3087715fcb1aa4e79aa2403f748e97d7cd28ecaefeffffffff914c67fb61dd1e27c867398ea7322d5ab76df04bc5aa6683a8e0f30a5d287348fa07474031481dda4953e3ac1959ee8cea7e66ec412b38d6c96d28f6d37304ea2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #112: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023000000000000000000000000000000004319055358e8617b0c46353d039cdaabffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc63254e0ad99500288d466940031d72a9f5445a4d43784640855bf0a69874d2de5fe103c5011e6ef2c42dcd50d5d3d29f99ae6eba2c80c9244f4c5422f0979ff0c3ba5e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #113: k*G has a large x-coordinate&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000001000000000000000000000000fffffffffffffffffffffffcffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc63254e0ad99500288d466940031d72a9f5445a4d43784640855bf0a69874d2de5fe103c5011e6ef2c42dcd50d5d3d29f99ae6eba2c80c9244f4c5422f0979ff0c3ba5e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #114: r too large&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc63254fffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc63254eab05fd9d0de26b9ce6f4819652d9fc69193d0aa398f0fba8013e09c58220455419235271228c786759095d12b75af0692dd4103f19f6a8c32f49435a1e9b8d45&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #115: r,s are large&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd909135bdb6799286170f5ead2de4f6511453fe50914f3df2de54a36383df8dd480984f39a1ff38a86a68aa4201b6be5dfbfecf876219710b07badf6fdd4c6c5611feb97390d9826e7a06dfb41871c940d74415ed3cac2089f1445019bb55ed95&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #116: r and s^-1 have a large Hamming weight&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd27b4577ca009376f71303fd5dd227dcef5deb773ad5f5a84360644669ca249a54201b4272944201c3294f5baa9a3232b6dd687495fcc19a70a95bc602b4f7c0595c37eba9ee8171c1bb5ac6feaf753bc36f463e3aef16629572c0c0a8fb0800e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #117: r and s^-1 have a large Hamming weight&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca60502300000000000000000000000000000000000000000000000000000000000000050000000000000000000000000000000000000000000000000000000000000001a71af64de5126a4a4e02b7922d66ce9415ce88a4c9d25514d91082c8725ac9575d47723c8fbe580bb369fec9c2665d8e30a435b9932645482e7c9f11e872296b&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #118: small r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023000000000000000000000000000000000000000000000000000000000000000500000000000000000000000000000000000000000000000000000000000000036627cec4f0731ea23fc2931f90ebe5b7572f597d20df08fc2b31ee8ef16b15726170ed77d8d0a14fc5c9c3c4c9be7f0d3ee18f709bb275eaf2073e258fe694a5&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #120: small r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023000000000000000000000000000000000000000000000000000000000000000500000000000000000000000000000000000000000000000000000000000000055a7c8825e85691cce1f5e7544c54e73f14afc010cb731343262ca7ec5a77f5bfef6edf62a4497c1bd7b147fb6c3d22af3c39bfce95f30e13a16d3d7b2812f813&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #122: small r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca60502300000000000000000000000000000000000000000000000000000000000000050000000000000000000000000000000000000000000000000000000000000006cbe0c29132cd738364fedd603152990c048e5e2fff996d883fa6caca7978c73770af6a8ce44cb41224b2603606f4c04d188e80bff7cc31ad5189d4ab0d70e8c1&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #124: small r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325560000000000000000000000000000000000000000000000000000000000000006cbe0c29132cd738364fedd603152990c048e5e2fff996d883fa6caca7978c73770af6a8ce44cb41224b2603606f4c04d188e80bff7cc31ad5189d4ab0d70e8c1&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #126: r is larger than n&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050230000000000000000000000000000000000000000000000000000000000000005ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc75fbd84be4178097002f0deab68f0d9a130e0ed33a6795d02a20796db83444b037e13920f13051e0eecdcfce4dacea0f50d1f247caa669f193c1b4075b51ae296d2d56&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #127: s is larger than n&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca60502300000000000000000000000000000000000000000000000000000000000001008f1e3c7862c58b16bb76eddbb76eddbb516af4f63f2d74d76e0d28c9bb75ea88d0f73792203716afd4be4329faa48d269f15313ebbba379d7783c97bf3e890d9971f4a3206605bec21782bf5e275c714417e8f566549e6bc68690d2363c89cc1&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #128: small r and s^-1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023000000000000000000000000000000000000000000000000002d9b4d347952d6ef3043e7329581dbb3974497710ab11505ee1c87ff907beebadd195a0ffe6d7a4838b2be35a6276a80ef9e228140f9d9b96ce83b7a254f71ccdebbb8054ce05ffa9cbc123c919b19e00238198d04069043bd660a828814051fcb8aac738a6c6b&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #129: smallish r and s^-1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023000000000000000000000000000000000000001033e67e37b32b445580bf4eff8b748b74000000008b748b748b748b7466e769ad4a16d3dcd87129b8e91d1b4d7393983ca30a520bbc4783dc9960746aab444ef520c0a8e771119aa4e74b0f64e9d7be1ab01a0bf626e709863e6a486dbaf32793afccf774e2c6cd27b1857526&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #130: 100-bit r and small s^-1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050230000000000000000000000000000000000000000000000000000000000000100ef9f6ba4d97c09d03178fa20b4aaad83be3cf9cb824a879fec3270fc4b81ef5b5ac331a1103fe966697379f356a937f350588a05477e308851b8a502d5dfcdc5fe9993df4b57939b2b8da095bf6d794265204cfe03be995a02e65d408c871c0b&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #131: small r and 100 bit s^-1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca60502300000000000000000000000000000000000000062522bbd3ecbe7c39e93e7c25ef9f6ba4d97c09d03178fa20b4aaad83be3cf9cb824a879fec3270fc4b81ef5b1d209be8de2de877095a399d3904c74cc458d926e27bb8e58e5eae5767c41509dd59e04c214f7b18dce351fc2a549893a6860e80163f38cc60a4f2c9d040d8c9&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #132: 100-bit r and s^-1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6324d5555555550000000055555555555555553ef7a8e48d07df81a693439654210c70083539fbee44625e3acaafa2fcb41349392cef0633a1b8fabecee0c133b10e99915c1ebe7bf00df8535196770a58047ae2a402f26326bb7d41d4d7616337911e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #133: r and s^-1 are close to n&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023555555550000000055555555555555553ef7a8e48d07df81a693439654210c7000000000000000000000000000000000000000000000000000000000000000018aeb368a7027a4d64abdea37390c0c1d6a26f399e2d9734de1eb3d0e1937387405bd13834715e1dbae9b875cf07bd55e1b6691c7f7536aef3b19bf7a4adf576d&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #134: s == 1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023555555550000000055555555555555553ef7a8e48d07df81a693439654210c7000000000000000000000000000000000000000000000000000000000000000008aeb368a7027a4d64abdea37390c0c1d6a26f399e2d9734de1eb3d0e1937387405bd13834715e1dbae9b875cf07bd55e1b6691c7f7536aef3b19bf7a4adf576d&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #135: s == 0&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237fffffff800000007fffffffffffffffde737d56d38bcf4279dce5617e3192a8555555550000000055555555555555553ef7a8e48d07df81a693439654210c70b533d4695dd5b8c5e07757e55e6e516f7e2c88fa0239e23f60e8ec07dd70f2871b134ee58cc583278456863f33c3a85d881f7d4a39850143e29d4eaf009afe47&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #136: point at infinity during verify&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237fffffff800000007fffffffffffffffde737d56d38bcf4279dce5617e3192a97fffffff800000007fffffffffffffffde737d56d38bcf4279dce5617e3192a8f50d371b91bfb1d7d14e1323523bc3aa8cbf2c57f9e284de628c8b4536787b86f94ad887ac94d527247cd2e7d0c8b1291c553c9730405380b14cbb209f5fa2dd&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #137: edge case for signature malleability&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237fffffff800000007fffffffffffffffde737d56d38bcf4279dce5617e3192a97fffffff800000007fffffffffffffffde737d56d38bcf4279dce5617e3192a968ec6e298eafe16539156ce57a14b04a7047c221bafc3a582eaeb0d857c4d94697bed1af17850117fdb39b2324f220a5698ed16c426a27335bb385ac8ca6fb30&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #138: edge case for signature malleability&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023555555550000000055555555555555553ef7a8e48d07df81a693439654210c70bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca60502369da0364734d2e530fece94019265fefb781a0f1b08f6c8897bdf6557927c8b866d2d3c7dcd518b23d726960f069ad71a933d86ef8abbcce8b20f71e2a847002&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #139: u1 == 1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023555555550000000055555555555555553ef7a8e48d07df81a693439654210c7044a5ad0ad0636d9f12bc9e0a6bdd5e1cbcb012ea7bf091fcec15b0c43202d52ed8adc00023a8edc02576e2b63e3e30621a471e2b2320620187bf067a1ac1ff3233e2b50ec09807accb36131fff95ed12a09a86b4ea9690aa32861576ba2362e1&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #140: u1 == n - 1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023555555550000000055555555555555553ef7a8e48d07df81a693439654210c70555555550000000055555555555555553ef7a8e48d07df81a693439654210c703623ac973ced0a56fa6d882f03a7d5c7edca02cfc7b2401fab3690dbe75ab7858db06908e64b28613da7257e737f39793da8e713ba0643b92e9bb3252be7f8fe&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #141: u2 == 1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023555555550000000055555555555555553ef7a8e48d07df81a693439654210c70aaaaaaaa00000000aaaaaaaaaaaaaaaa7def51c91a0fbf034d26872ca84218e1cf04ea77e9622523d894b93ff52dc3027b31959503b6fa3890e5e04263f922f1e8528fb7c006b3983c8b8400e57b4ed71740c2f3975438821199bedeaecab2e9&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #142: u2 == n - 1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffde91e1ba60fdedb76a46bcb51dc0b8b4b7e019f0a28721885fa5d3a8196623397db7a2c8a1ab573e5929dc24077b508d7e683d49227996bda3e9f78dbeff773504f417f3bc9a88075c2e0aadd5a13311730cf7cc76a82f11a36eaf08a6c99a206&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #143: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffdfdea5843ffeb73af94313ba4831b53fe24f799e525b1e8e8c87b59b95b430ad9dead11c7a5b396862f21974dc4752fadeff994efe9bbd05ab413765ea80b6e1f1de3f0640e8ac6edcf89cff53c40e265bb94078a343736df07aa0318fc7fe1ff&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #144: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd03ffcabf2f1b4d2a65190db1680d62bb994e41c5251cd73b3c3dfc5e5bafc035d0bc472e0d7c81ebaed3a6ef96c18613bb1fea6f994326fbe80e00dfde67c7e9986c723ea4843d48389b946f64ad56c83ad70ff17ba85335667d1bb9fa619efd&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #145: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd4dfbc401f971cd304b33dfdb17d0fed0fe4c1a88ae648e0d2847f74977534989a0a44ca947d66a2acb736008b9c08d1ab2ad03776e02640f78495d458dd51c326337fe5cf8c4604b1f1c409dc2d872d4294a4762420df43a30a2392e40426add&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #146: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffdbc4024761cd2ffd43dfdb17d0fed112b988977055cd3a8e54971eba9cda5ca71c9c2115290d008b45fb65fad0f602389298c25420b775019d42b62c3ce8a96b73877d25a8080dc02d987ca730f0405c2c9dbefac46f9e601cc3f06e9713973fd&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #147: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd788048ed39a5ffa77bfb62fa1fda2257742bf35d128fb3459f2a0c909ee86f915eca1ef4c287dddc66b8bccf1b88e8a24c0018962f3c5e7efa83bc1a5ff6033e5e79c4cb2c245b8c45abdce8a8e4da758d92a607c32cd407ecaef22f1c934a71&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #148: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd476d9131fd381bd917d0fed112bc9e0a5924b5ed5b11167edd8b23582b3cb15e5caaa030e7fdf0e4936bc7ab5a96353e0a01e4130c3f8bf22d473e317029a47adeb6adc462f7058f2a20d371e9702254e9b201642005b3ceda926b42b178bef9&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #149: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd8374253e3e21bd154448d0a8f640fe46fafa8b19ce78d538f6cc0a19662d3601c2fd20bac06e555bb8ac0ce69eb1ea20f83a1fc3501c8a66469b1a31f619b0986237050779f52b615bd7b8d76a25fc95ca2ed32525c75f27ffc87ac397e6cbaf&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #150: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd357cfd3be4d01d413c5b9ede36cba5452c11ee7fe14879e749ae6a2d897a52d63fd6a1ca7f77fb3b0bbe726c372010068426e11ea6ae78ce17bedae4bba86ced03ce5516406bf8cfaab8745eac1cd69018ad6f50b5461872ddfc56e0db3c8ff4&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #151: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd29798c5c0ee287d4a5e8e6b799fd86b8df5225298e6ffc807cd2f2bc27a0a6d89cb8e51e27a5ae3b624a60d6dc32734e4989db20e9bca3ede1edf7b086911114b4c104ab3c677e4b36d6556e8ad5f523410a19f2e277aa895fc57322b4427544&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #152: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd0b70f22c781092452dca1a5711fa3a5a1f72add1bf52c2ff7cae4820b30078dda3e52c156dcaf10502620b7955bc2b40bc78ef3d569e1223c262512d8f49602a4a2039f31c1097024ad3cc86e57321de032355463486164cf192944977df147f&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #153: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd16e1e458f021248a5b9434ae23f474b43ee55ba37ea585fef95c90416600f1baf19b78928720d5bee8e670fb90010fb15c37bf91b58a5157c3f3c059b2655e88cf701ec962fb4a11dcf273f5dc357e58468560c7cfeb942d074abd4329260509&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #154: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd2252d6856831b6cf895e4f0535eeaf0e5e5809753df848fe760ad86219016a9783a744459ecdfb01a5cf52b27a05bb7337482d242f235d7b4cb89345545c90a8c05d49337b9649813287de9ffe90355fd905df5f3c32945828121f37cc50de6e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #155: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd81ffe55f178da695b28c86d8b406b15dab1a9e39661a3ae017fbe390ac0972c3dd13c6b34c56982ddae124f039dfd23f4b19bbe88cee8e528ae51e5d6f3a21d7bfad4c2e6f263fe5eb59ca974d039fc0e4c3345692fb5320bdae4bd3b42a45ff&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #156: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd7fffffffaaaaaaaaffffffffffffffffe9a2538f37b28a2c513dee40fecbb71a67e6f659cdde869a2f65f094e94e5b4dfad636bbf95192feeed01b0f3deb7460a37e0a51f258b7aeb51dfe592f5cfd5685bbe58712c8d9233c62886437c38ba0&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #157: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffdb62f26b5f2a2b26f6de86d42ad8a13da3ab3cccd0459b201de009e526adf21f22eb6412505aec05c6545f029932087e490d05511e8ec1f599617bb367f9ecaaf805f51efcc4803403f9b1ae0124890f06a43fedcddb31830f6669af292895cb0&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #158: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffdbb1d9ac949dd748cd02bbbe749bd351cd57b38bb61403d700686aa7b4c90851e84db645868eab35e3a9fd80e056e2e855435e3a6b68d75a50a854625fe0d7f356d2589ac655edc9a11ef3e075eddda9abf92e72171570ef7bf43a2ee39338cfe&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #159: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd66755a00638cdaec1c732513ca0234ece52545dac11f816e818f725b4f60aaf291b9e47c56278662d75c0983b22ca8ea6aa5059b7a2ff7637eb2975e386ad66349aa8ff283d0f77c18d6d11dc062165fd13c3c0310679c1408302a16854ecfbd&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #160: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd55a00c9fcdaebb6032513ca0234ecfffe98ebe492fdf02e48ca48e982beb3669f3ec2f13caf04d0192b47fb4c5311fb6d4dc6b0a9e802e5327f7ec5ee8e4834df97e3e468b7d0db867d6ecfe81e2b0f9531df87efdb47c1338ac321fefe5a432&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #161: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffdab40193f9b5d76c064a27940469d9fffd31d7c925fbe05c919491d3057d66cd2d92b200aefcab6ac7dafd9acaf2fa10b3180235b8f46b4503e4693c670fccc885ef2f3aebf5b317475336256768f7c19efb7352d27e4cccadc85b6b8ab922c72&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #162: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffdca0234ebb5fdcb13ca0234ecffffffffcb0dadbbc7f549f8a26b4408d0dc86000a88361eb92ecca2625b38e5f98bbabb96bf179b3d76fc48140a3bcd881523cde6bdf56033f84a5054035597375d90866aa2c96b86a41ccf6edebf47298ad489&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #163: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffdbfffffff3ea3677e082b9310572620ae19933a9e65b285598711c77298815ad3d0fb17ccd8fafe827e0c1afc5d8d80366e2b20e7f14a563a2ba50469d84375e868612569d39e2bb9f554355564646de99ac602cc6349cf8c1e236a7de7637d93&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #164: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd266666663bbbbbbbe6666666666666665b37902e023fab7c8f055d86e5cc41f4836f33bbc1dc0d3d3abbcef0d91f11e2ac4181076c9af0a22b1e4309d3edb2769ab443ff6f901e30c773867582997c2bec2b0cb8120d760236f3a95bbe881f75&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #165: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffdbfffffff36db6db7a492492492492492146c573f4c6dfc8d08a443e258970b0992f99fbe973ed4a299719baee4b432741237034dec8d72ba5103cb33e55feeb8033dd0e91134c734174889f3ebcf1b7a1ac05767289280ee7a794cebd6e69697&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #166: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffdbfffffff2aaaaaab7fffffffffffffffc815d0e60b3e596ecb1ad3a27cfd49c4d35ba58da30197d378e618ec0fa7e2e2d12cffd73ebbb2049d130bba434af09eff83986e6875e41ea432b7585a49b3a6c77cbb3c47919f8e82874c794635c1d2&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #167: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd7fffffff55555555ffffffffffffffffd344a71e6f651458a27bdc81fd976e378651ce490f1b46d73f3ff475149be29136697334a519d7ddab0725c8d0793224e11c65bd8ca92dc8bc9ae82911f0b52751ce21dd9003ae60900bd825f590cc28&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #168: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd3fffffff800000007fffffffffffffffde737d56d38bcf4279dce5617e3192aa6d8e1b12c831a0da8795650ff95f101ed921d9e2f72b15b1cdaca9826b9cfc6def6d63e2bc5c089570394a4bc9f892d5e6c7a6a637b20469a58c106ad486bf37&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #169: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd5d8ecd64a4eeba466815ddf3a4de9a8e6abd9c5db0a01eb80343553da648428f0ae580bae933b4ef2997cbdbb0922328ca9a410f627a0f7dff24cb4d920e15428911e7f8cc365a8a88eb81421a361ccc2b99e309d8dcd9a98ba83c3949d893e3&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #170: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050236f2347cab7dd76858fe0555ac3bc99048c4aacafdfb6bcbe05ea6c42c4934569bb726660235793aa9957a61e76e00c2c435109cf9a15dd624d53f4301047856b5b812fd521aafa69835a849cce6fbdeb6983b442d2444fe70e134c027fc46963838a40f2a36092e9004e92d8d940cf5638550ce672ce8b8d4e15eba5499249e9&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #171: point duplication during verification&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050236f2347cab7dd76858fe0555ac3bc99048c4aacafdfb6bcbe05ea6c42c4934569bb726660235793aa9957a61e76e00c2c435109cf9a15dd624d53f4301047856b5b812fd521aafa69835a849cce6fbdeb6983b442d2444fe70e134c027fc469637c75bf0c5c9f6d17ffb16d2726bf30a9c7aaf31a8d317472b1ea145ab66db616&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #172: duplication bug&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050230000000000000000000000000000000000000000000000000000000000000001555555550000000055555555555555553ef7a8e48d07df81a693439654210c706adda82b90261b0f319faa0d878665a6b6da497f09c903176222c34acfef72a647e6f50dcc40ad5d9b59f7602bb222fad71a41bf5e1f9df4959a364c62e488d9&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #173: point with x-coordinate 0&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023555555550000000055555555555555553ef7a8e48d07df81a693439654210c703333333300000000333333333333333325c7cbbc549e52e763f1f55a327a3aa9dd86d3b5f4a13e8511083b78002081c53ff467f11ebd98a51a633db76665d25045d5c8200c89f2fa10d849349226d21d8dfaed6ff8d5cb3e1b7e17474ebc18f7&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #175: comparison with point at infinity &quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237cf27b188d034f7e8a52380304b51ac3c08969e277f21b35a60b48fc47669978555555550000000055555555555555553ef7a8e48d07df81a693439654210c704fea55b32cb32aca0c12c4cd0abfb4e64b0f5a516e578c016591a93f5a0fbcc5d7d3fd10b2be668c547b212f6bb14c88f0fecd38a8a4b2c785ed3be62ce4b280&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #176: extreme value for k and edgecase s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237cf27b188d034f7e8a52380304b51ac3c08969e277f21b35a60b48fc47669978b6db6db6249249254924924924924924625bd7a09bec4ca81bcdd9f8fd6b63ccc6a771527024227792170a6f8eee735bf32b7f98af669ead299802e32d7c3107bc3b4b5e65ab887bbd343572b3e5619261fe3a073e2ffd78412f726867db589e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #177: extreme value for k and s^-1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237cf27b188d034f7e8a52380304b51ac3c08969e277f21b35a60b48fc47669978cccccccc00000000cccccccccccccccc971f2ef152794b9d8fc7d568c9e8eaa7851c2bbad08e54ec7a9af99f49f03644d6ec6d59b207fec98de85a7d15b956efcee9960283045075684b410be8d0f7494b91aa2379f60727319f10ddeb0fe9d6&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #178: extreme value for k and s^-1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237cf27b188d034f7e8a52380304b51ac3c08969e277f21b35a60b48fc476699783333333300000000333333333333333325c7cbbc549e52e763f1f55a327a3aaaf6417c8a670584e388676949e53da7fc55911ff68318d1bf3061205acb19c48f8f2b743df34ad0f72674acb7505929784779cd9ac916c3669ead43026ab6d43f&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #179: extreme value for k and s^-1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237cf27b188d034f7e8a52380304b51ac3c08969e277f21b35a60b48fc4766997849249248db6db6dbb6db6db6db6db6db5a8b230d0b2b51dcd7ebf0c9fef7c185501421277be45a5eefec6c639930d636032565af420cf3373f557faa7f8a06438673d6cb6076e1cfcdc7dfe7384c8e5cac08d74501f2ae6e89cad195d0aa1371&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #180: extreme value for k and s^-1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237cf27b188d034f7e8a52380304b51ac3c08969e277f21b35a60b48fc4766997816a4502e2781e11ac82cbc9d1edd8c981584d13e18411e2f6e0478c34416e3bb0d935bf9ffc115a527735f729ca8a4ca23ee01a4894adf0e3415ac84e808bb343195a3762fea29ed38912bd9ea6c4fde70c3050893a4375850ce61d82eba33c5&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #181: extreme value for k&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050236b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296555555550000000055555555555555553ef7a8e48d07df81a693439654210c705e59f50708646be8a589355014308e60b668fb670196206c41e748e64e4dca215de37fee5c97bcaf7144d5b459982f52eeeafbdf03aacbafef38e213624a01de&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #182: extreme value for k and edgecase s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050236b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296b6db6db6249249254924924924924924625bd7a09bec4ca81bcdd9f8fd6b63cc169fb797325843faff2f7a5b5445da9e2fd6226f7ef90ef0bfe924104b02db8e7bbb8de662c7b9b1cf9b22f7a2e582bd46d581d68878efb2b861b131d8a1d667&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #183: extreme value for k and s^-1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050236b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296cccccccc00000000cccccccccccccccc971f2ef152794b9d8fc7d568c9e8eaa7271cd89c000143096b62d4e9e4ca885aef2f7023d18affdaf8b7b548981487540a1c6e954e32108435b55fa385b0f76481a609b9149ccb4b02b2ca47fe8e4da5&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #184: extreme value for k and s^-1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050236b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c2963333333300000000333333333333333325c7cbbc549e52e763f1f55a327a3aaa3d0bc7ed8f09d2cb7ddb46ebc1ed799ab1563a9ab84bf524587a220afe499c12e22dc3b3c103824a4f378d96adb0a408abf19ce7d68aa6244f78cb216fa3f8df&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #185: extreme value for k and s^-1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050236b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c29649249248db6db6dbb6db6db6db6db6db5a8b230d0b2b51dcd7ebf0c9fef7c185a6c885ade1a4c566f9bb010d066974abb281797fa701288c721bcbd23663a9b72e424b690957168d193a6096fc77a2b004a9c7d467e007e1f2058458f98af316&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #186: extreme value for k and s^-1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050236b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c29616a4502e2781e11ac82cbc9d1edd8c981584d13e18411e2f6e0478c34416e3bb8d3c2c2c3b765ba8289e6ac3812572a25bf75df62d87ab7330c3bdbad9ebfa5c4c6845442d66935b238578d43aec54f7caa1621d1af241d4632e0b780c423f5d&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #187: extreme value for k&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023249249246db6db6ddb6db6db6db6db6dad4591868595a8ee6bf5f864ff7be0c26b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c2964fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #188: testing point duplication&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca60502344a5ad0ad0636d9f12bc9e0a6bdd5e1cbcb012ea7bf091fcec15b0c43202d52e249249246db6db6ddb6db6db6db6db6dad4591868595a8ee6bf5f864ff7be0c26b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c2964fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #189: testing point duplication&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023249249246db6db6ddb6db6db6db6db6dad4591868595a8ee6bf5f864ff7be0c26b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296b01cbd1c01e58065711814b583f061e9d431cca994cea1313449bf97c840ae0a&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #190: testing point duplication&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca60502344a5ad0ad0636d9f12bc9e0a6bdd5e1cbcb012ea7bf091fcec15b0c43202d52e249249246db6db6ddb6db6db6db6db6dad4591868595a8ee6bf5f864ff7be0c26b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296b01cbd1c01e58065711814b583f061e9d431cca994cea1313449bf97c840ae0a&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #191: testing point duplication&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855b292a619339f6e567a305c951c0dcbcc42d16e47f219f9e98e76e09d8770b34a0177e60492c5a8242f76f07bfe3661bde59ec2a17ce5bd2dab2abebdf89a62e204aaec73635726f213fb8a9e64da3b8632e41495a944d0045b522eba7240fad587d9315798aaa3a5ba01775787ced05eaaf7b4e09fc81d6d1aa546e8365d525d&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #192: pseudorandom signature&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;dc1921946f4af96a2856e7be399007c9e807bdf4c5332f19f59ec9dd1bb8c7b3530bd6b0c9af2d69ba897f6b5fb59695cfbf33afe66dbadcf5b8d2a2a6538e23d85e489cb7a161fd55ededcedbf4cc0c0987e3e3f0f242cae934c72caa3f43e904aaec73635726f213fb8a9e64da3b8632e41495a944d0045b522eba7240fad587d9315798aaa3a5ba01775787ced05eaaf7b4e09fc81d6d1aa546e8365d525d&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #193: pseudorandom signature&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023a8ea150cb80125d7381c4c1f1da8e9de2711f9917060406a73d7904519e51388f3ab9fa68bd47973a73b2d40480c2ba50c22c9d76ec217257288293285449b8604aaec73635726f213fb8a9e64da3b8632e41495a944d0045b522eba7240fad587d9315798aaa3a5ba01775787ced05eaaf7b4e09fc81d6d1aa546e8365d525d&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #194: pseudorandom signature&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;de47c9b27eb8d300dbb5f2c353e632c393262cf06340c4fa7f1b40c4cbd36f90986e65933ef2ed4ee5aada139f52b70539aaf63f00a91f29c69178490d57fb713dafedfb8da6189d372308cbf1489bbbdabf0c0217d1c0ff0f701aaa7a694b9c04aaec73635726f213fb8a9e64da3b8632e41495a944d0045b522eba7240fad587d9315798aaa3a5ba01775787ced05eaaf7b4e09fc81d6d1aa546e8365d525d&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #195: pseudorandom signature&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91d434e262a49eab7781e353a3565e482550dd0fd5defa013c7f29745eff3569f19b0c0a93f267fb6052fd8077be769c2b98953195d7bc10de844218305c6ba17a4f337ccfd67726a805e4f1600ae2849df3807eca117380239fbd816900000000ed9dea124cc8c396416411e988c30f427eb504af43a3146cd5df7ea60666d685&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #196: x-coordinate of the public key has many trailing 0&#39;s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f910fe774355c04d060f76d79fd7a772e421463489221bf0a33add0be9b1979110b500dcba1c69a8fbd43fa4f57f743ce124ca8b91a1f325f3fac6181175df557374f337ccfd67726a805e4f1600ae2849df3807eca117380239fbd816900000000ed9dea124cc8c396416411e988c30f427eb504af43a3146cd5df7ea60666d685&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #197: x-coordinate of the public key has many trailing 0&#39;s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91bb40bf217bed3fb3950c7d39f03d36dc8e3b2cd79693f125bfd06595ee1135e3541bf3532351ebb032710bdb6a1bf1bfc89a1e291ac692b3fa4780745bb556774f337ccfd67726a805e4f1600ae2849df3807eca117380239fbd816900000000ed9dea124cc8c396416411e988c30f427eb504af43a3146cd5df7ea60666d685&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #198: x-coordinate of the public key has many trailing 0&#39;s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91664eb7ee6db84a34df3c86ea31389a5405badd5ca99231ff556d3e75a233e73a59f3c752e52eca46137642490a51560ce0badc678754b8f72e51a2901426a1bd3cf03d614d8939cfd499a07873fac281618f06b8ff87e8015c3f49726500493584fa174d791c72bf2ce3880a8960dd2a7c7a1338a82f85a9e59cdbde80000000&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #199: y-coordinate of the public key has many trailing 0&#39;s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f914cd0429bbabd2827009d6fcd843d4ce39c3e42e2d1631fd001985a79d1fd8b439638bf12dd682f60be7ef1d0e0d98f08b7bca77a1a2b869ae466189d2acdabe33cf03d614d8939cfd499a07873fac281618f06b8ff87e8015c3f49726500493584fa174d791c72bf2ce3880a8960dd2a7c7a1338a82f85a9e59cdbde80000000&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #200: y-coordinate of the public key has many trailing 0&#39;s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91e56c6ea2d1b017091c44d8b6cb62b9f460e3ce9aed5e5fd41e8added97c56c04a308ec31f281e955be20b457e463440b4fcf2b80258078207fc1378180f89b553cf03d614d8939cfd499a07873fac281618f06b8ff87e8015c3f49726500493584fa174d791c72bf2ce3880a8960dd2a7c7a1338a82f85a9e59cdbde80000000&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #201: y-coordinate of the public key has many trailing 0&#39;s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f911158a08d291500b4cabed3346d891eee57c176356a2624fb011f8fbbf3466830228a8c486a736006e082325b85290c5bc91f378b75d487dda46798c18f2855193cf03d614d8939cfd499a07873fac281618f06b8ff87e8015c3f4972650049357b05e8b186e38d41d31c77f5769f22d58385ecc857d07a561a6324217fffffff&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #202: y-coordinate of the public key has many trailing 1&#39;s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91b1db9289649f59410ea36b0c0fc8d6aa2687b29176939dd23e0dde56d309fa9d3e1535e4280559015b0dbd987366dcf43a6d1af5c23c7d584e1c3f48a12513363cf03d614d8939cfd499a07873fac281618f06b8ff87e8015c3f4972650049357b05e8b186e38d41d31c77f5769f22d58385ecc857d07a561a6324217fffffff&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #203: y-coordinate of the public key has many trailing 1&#39;s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91b7b16e762286cb96446aa8d4e6e7578b0a341a79f2dd1a220ac6f0ca4e24ed86ddc60a700a139b04661c547d07bbb0721780146df799ccf55e55234ecb8f12bc3cf03d614d8939cfd499a07873fac281618f06b8ff87e8015c3f4972650049357b05e8b186e38d41d31c77f5769f22d58385ecc857d07a561a6324217fffffff&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #204: y-coordinate of the public key has many trailing 1&#39;s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91d82a7c2717261187c8e00d8df963ff35d796edad36bc6e6bd1c91c670d9105b43dcabddaf8fcaa61f4603e7cbac0f3c0351ecd5988efb23f680d07debd1399292829c31faa2e400e344ed94bca3fcd0545956ebcfe8ad0f6dfa5ff8effffffffa01aafaf000e52585855afa7676ade284113099052df57e7eb3bd37ebeb9222e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #205: x-coordinate of the public key has many trailing 1&#39;s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f915eb9c8845de68eb13d5befe719f462d77787802baff30ce96a5cba063254af782c026ae9be2e2a5e7ca0ff9bbd92fb6e44972186228ee9a62b87ddbe2ef66fb52829c31faa2e400e344ed94bca3fcd0545956ebcfe8ad0f6dfa5ff8effffffffa01aafaf000e52585855afa7676ade284113099052df57e7eb3bd37ebeb9222e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #206: x-coordinate of the public key has many trailing 1&#39;s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f9196843dd03c22abd2f3b782b170239f90f277921becc117d0404a8e4e36230c28f2be378f526f74a543f67165976de9ed9a31214eb4d7e6db19e1ede123dd991d2829c31faa2e400e344ed94bca3fcd0545956ebcfe8ad0f6dfa5ff8effffffffa01aafaf000e52585855afa7676ade284113099052df57e7eb3bd37ebeb9222e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #207: x-coordinate of the public key has many trailing 1&#39;s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91766456dce1857c906f9996af729339464d27e9d98edc2d0e3b760297067421f6402385ecadae0d8081dccaf5d19037ec4e55376eced699e93646bfbbf19d0b41fffffff948081e6a0458dd8f9e738f2665ff9059ad6aac0708318c4ca9a7a4f55a8abcba2dda8474311ee54149b973cae0c0fb89557ad0bf78e6529a1663bd73&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #208: x-coordinate of the public key is large&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91c605c4b2edeab20419e6518a11b2dbc2b97ed8b07cced0b19c34f777de7b9fd9edf0f612c5f46e03c719647bc8af1b29b2cde2eda700fb1cff5e159d47326dbafffffff948081e6a0458dd8f9e738f2665ff9059ad6aac0708318c4ca9a7a4f55a8abcba2dda8474311ee54149b973cae0c0fb89557ad0bf78e6529a1663bd73&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #209: x-coordinate of the public key is large&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91d48b68e6cabfe03cf6141c9ac54141f210e64485d9929ad7b732bfe3b7eb8a84feedae50c61bd00e19dc26f9b7e2265e4508c389109ad2f208f0772315b6c941fffffff948081e6a0458dd8f9e738f2665ff9059ad6aac0708318c4ca9a7a4f55a8abcba2dda8474311ee54149b973cae0c0fb89557ad0bf78e6529a1663bd73&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #210: x-coordinate of the public key is large&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91b7c81457d4aeb6aa65957098569f0479710ad7f6595d5874c35a93d12a5dd4c7b7961a0b652878c2d568069a432ca18a1a9199f2ca574dad4b9e3a05c0a1cdb300000003fa15f963949d5f03a6f5c7f86f9e0015eeb23aebbff1173937ba748e1099872070e8e87c555fa13659cca5d7fadcfcb0023ea889548ca48af2ba7e71&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #211: x-coordinate of the public key is small&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f916b01332ddb6edfa9a30a1321d5858e1ee3cf97e263e669f8de5e9652e76ff3f75939545fced457309a6a04ace2bd0f70139c8f7d86b02cb1cc58f9e69e96cd5a00000003fa15f963949d5f03a6f5c7f86f9e0015eeb23aebbff1173937ba748e1099872070e8e87c555fa13659cca5d7fadcfcb0023ea889548ca48af2ba7e71&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #212: x-coordinate of the public key is small&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91efdb884720eaeadc349f9fc356b6c0344101cd2fd8436b7d0e6a4fb93f106361f24bee6ad5dc05f7613975473aadf3aacba9e77de7d69b6ce48cb60d8113385d00000003fa15f963949d5f03a6f5c7f86f9e0015eeb23aebbff1173937ba748e1099872070e8e87c555fa13659cca5d7fadcfcb0023ea889548ca48af2ba7e71&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #213: x-coordinate of the public key is small&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f9131230428405560dcb88fb5a646836aea9b23a23dd973dcbe8014c87b8b20eb070f9344d6e812ce166646747694a41b0aaf97374e19f3c5fb8bd7ae3d9bd0beffbcbb2914c79f045eaa6ecbbc612816b3be5d2d6796707d8125e9f851c18af015000000001352bb4a0fa2ea4cceb9ab63dd684ade5a1127bcf300a698a7193bc2&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #214: y-coordinate of the public key is small&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91caa797da65b320ab0d5c470cda0b36b294359c7db9841d679174db34c4855743cf543a62f23e212745391aaf7505f345123d2685ee3b941d3de6d9b36242e5a0bcbb2914c79f045eaa6ecbbc612816b3be5d2d6796707d8125e9f851c18af015000000001352bb4a0fa2ea4cceb9ab63dd684ade5a1127bcf300a698a7193bc2&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #215: y-coordinate of the public key is small&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f917e5f0ab5d900d3d3d7867657e5d6d36519bc54084536e7d21c336ed8001859459450c07f201faec94b82dfb322e5ac676688294aad35aa72e727ff0b19b646aabcbb2914c79f045eaa6ecbbc612816b3be5d2d6796707d8125e9f851c18af015000000001352bb4a0fa2ea4cceb9ab63dd684ade5a1127bcf300a698a7193bc2&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #216: y-coordinate of the public key is small&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91d7d70c581ae9e3f66dc6a480bf037ae23f8a1e4a2136fe4b03aa69f0ca25b35689c460f8a5a5c2bbba962c8a3ee833a413e85658e62a59e2af41d9127cc47224bcbb2914c79f045eaa6ecbbc612816b3be5d2d6796707d8125e9f851c18af015fffffffeecad44b6f05d15b33146549c2297b522a5eed8430cff596758e6c43d&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #217: y-coordinate of the public key is large&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91341c1b9ff3c83dd5e0dfa0bf68bcdf4bb7aa20c625975e5eeee34bb396266b3472b69f061b750fd5121b22b11366fad549c634e77765a017902a67099e0a4469bcbb2914c79f045eaa6ecbbc612816b3be5d2d6796707d8125e9f851c18af015fffffffeecad44b6f05d15b33146549c2297b522a5eed8430cff596758e6c43d&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #218: y-coordinate of the public key is large&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f9170bebe684cdcb5ca72a42f0d873879359bd1781a591809947628d313a3814f67aec03aca8f5587a4d535fa31027bbe9cc0e464b1c3577f4c2dcde6b2094798a9bcbb2914c79f045eaa6ecbbc612816b3be5d2d6796707d8125e9f851c18af015fffffffeecad44b6f05d15b33146549c2297b522a5eed8430cff596758e6c43d&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_p1363_test.json EcdsaP1363Verify SHA-256 #219: y-coordinate of the public key is large&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050232ba3a8be6b94d5ec80a6d9d1190a436effe50d85a1eee859b8cc6af9bd5c2e184cd60b855d442f5b3c7b11eb6c4e0ae7525fe710fab9aa7c77a67f79e6fadd762927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #1: signature malleability&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050232ba3a8be6b94d5ec80a6d9d1190a436effe50d85a1eee859b8cc6af9bd5c2e18b329f479a2bbd0a5c384ee1493b1f5186a87139cac5df4087c134b49156847db2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #2: Legacy:ASN encoding of s misses leading 0&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050232ba3a8be6b94d5ec80a6d9d1190a436effe50d85a1eee859b8cc6af9bd5c2e18b329f479a2bbd0a5c384ee1493b1f5186a87139cac5df4087c134b49156847db2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #3: valid&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca60502329a3a8be6b94d5ec80a6d9d1190a436effe50d85a1eee859b8cc6af9bd5c2e18b329f479a2bbd0a5c384ee1493b1f5186a87139cac5df4087c134b49156847db2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #118: modify first byte of integer&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050232ba3a8be6b94d5ec80a6d9d1190a436effe50d85a1eee859b8cc6af9bd5c2e98b329f479a2bbd0a5c384ee1493b1f5186a87139cac5df4087c134b49156847db2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #120: modify last byte of integer&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050232ba3a8be6b94d5ec80a6d9d1190a436effe50d85a1eee859b8cc6af9bd5c2e18b329f479a2bbd0a5c384ee1493b1f5186a87139cac5df4087c134b491568475b2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #121: modify last byte of integer&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050232ba3a8be6b94d5ec80a6d9d1190a436effe50d85a1eee859b8cc6af9bd5c2e1800b329f479a2bbd0a5c384ee1493b1f5186a87139cac5df4087c134b491568472927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #124: truncated integer&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023d45c5741946b2a137f59262ee6f5bc91001af27a5e1117a64733950642a3d1e8b329f479a2bbd0a5c384ee1493b1f5186a87139cac5df4087c134b49156847db2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #133: Modified r or s, e.g. by adding or subtracting the order of the group&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023d45c5740946b2a147f59262ee6f5bc90bd01ed280528b62b3aed5fc93f06f739b329f479a2bbd0a5c384ee1493b1f5186a87139cac5df4087c134b49156847db2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #134: Modified r or s, e.g. by adding or subtracting the order of the group&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023d45c5741946b2a137f59262ee6f5bc91001af27a5e1117a64733950642a3d1e8b329f479a2bbd0a5c384ee1493b1f5186a87139cac5df4087c134b49156847db2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #137: Modified r or s, e.g. by adding or subtracting the order of the group&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050232ba3a8be6b94d5ec80a6d9d1190a436effe50d85a1eee859b8cc6af9bd5c2e18b329f47aa2bbd0a4c384ee1493b1f518ada018ef05465583885980861905228a2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #139: Modified r or s, e.g. by adding or subtracting the order of the group&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050232ba3a8be6b94d5ec80a6d9d1190a436effe50d85a1eee859b8cc6af9bd5c2e184cd60b865d442f5a3c7b11eb6c4e0ae79578ec6353a20bf783ecb4b6ea97b8252927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #143: Modified r or s, e.g. by adding or subtracting the order of the group&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325512927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #177: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325502927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #178: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325522927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #179: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551ffffffff00000001000000000000000000000000ffffffffffffffffffffffff2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #180: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551ffffffff000000010000000000000000000000010000000000000000000000002927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #181: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632550ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325512927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #187: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632550ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325502927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #188: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632550ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325522927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #189: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632550ffffffff00000001000000000000000000000000ffffffffffffffffffffffff2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #190: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632550ffffffff000000010000000000000000000000010000000000000000000000002927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #191: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632552ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325512927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #197: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632552ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325502927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #198: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632552ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325522927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #199: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632552ffffffff00000001000000000000000000000000ffffffffffffffffffffffff2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #200: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632552ffffffff000000010000000000000000000000010000000000000000000000002927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #201: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000001000000000000000000000000ffffffffffffffffffffffffffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325512927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #207: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000001000000000000000000000000ffffffffffffffffffffffffffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325502927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #208: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000001000000000000000000000000ffffffffffffffffffffffffffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325522927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #209: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000001000000000000000000000000ffffffffffffffffffffffffffffffff00000001000000000000000000000000ffffffffffffffffffffffff2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #210: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000001000000000000000000000000ffffffffffffffffffffffffffffffff000000010000000000000000000000010000000000000000000000002927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #211: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000001000000000000000000000001000000000000000000000000ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325512927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #217: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000001000000000000000000000001000000000000000000000000ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325502927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #218: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000001000000000000000000000001000000000000000000000000ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325522927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #219: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000001000000000000000000000001000000000000000000000000ffffffff00000001000000000000000000000000ffffffffffffffffffffffff2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #220: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000001000000000000000000000001000000000000000000000000ffffffff000000010000000000000000000000010000000000000000000000002927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #221: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;70239dd877f7c944c422f44dea4ed1a52f2627416faf2f072fa50c772ed6f80764a1aab5000d0e804f3e2fc02bdee9be8ff312334e2ba16d11547c97711c898e6af015971cc30be6d1a206d4e013e0997772a2f91d73286ffd683b9bb2cf4f1b2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #230: Edge case for Shamir multiplication&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;00000000690ed426ccf17803ebe2bd0884bcd58a1bb5e7477ead3645f356e7a916aea964a2f6506d6f78c81c91fc7e8bded7d397738448de1e19a0ec580bf266252cd762130c6667cfe8b7bc47d27d78391e8e80c578d1cd38c3ff033be928e92927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #231: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;7300000000213f2a525c6035725235c2f696ad3ebb5ee47f140697ad25770d919cc98be2347d469bf476dfc26b9b733df2d26d6ef524af917c665baccb23c882093496459effe2d8d70727b82462f61d0ec1b7847929d10ea631dacb16b56c322927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #232: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;ddf2000000005e0be0635b245f0b97978afd25daadeb3edb4a0161c27fe0604573b3c90ecd390028058164524dde892703dce3dea0d53fa8093999f07ab8aa432f67b0b8e20636695bb7d8bf0a651c802ed25a395387b5f4188c0c4075c886342927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #233: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;67ab1900000000784769c4ecb9e164d6642b8499588b89855be1ec355d0841a0bfab3098252847b328fadf2f89b95c851a7f0eb390763378f37e90119d5ba3ddbdd64e234e832b1067c2d058ccb44d978195ccebb65c2aaf1e2da9b8b4987e3b2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #234: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;a2bf09460000000076d7dbeffe125eaf02095dff252ee905e296b6350fc311cf204a9784074b246d8bf8bf04a4ceb1c1f1c9aaab168b1596d17093c5cd21d2cd51cce41670636783dc06a759c8847868a406c2506fe17975582fe648d1d88b522927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #235: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;3554e827c700000000e1e75e624a06b3a0a353171160858129e15c544e4f0e65ed66dc34f551ac82f63d4aa4f81fe2cb0031a91d1314f835027bca0f1ceeaa0399ca123aa09b13cd194a422e18d5fda167623c3f6e5d4d6abb8953d67c0c48c72927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #236: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;9b6cd3b812610000000026941a0f0bb53255ea4c9fd0cb3426e3a54b9fc6965c060b700bef665c68899d44f2356a578d126b062023ccc3c056bf0f60a237012b8d186c027832965f4fcc78a3366ca95dedbb410cbef3f26d6be5d581c11d36102927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #237: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;883ae39f50bf0100000000e7561c26fc82a52baa51c71ca877162f93c4ae01869f6adfe8d5eb5b2c24d7aa7934b6cf29c93ea76cd313c9132bb0c8e38c96831db26a9c9e40e55ee0890c944cf271756c906a33e66b5bd15e051593883b5e99022927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #238: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;a1ce5d6e5ecaf28b0000000000fa7cd010540f420fb4ff7401fe9fce011d0ba6a1af03ca91677b673ad2f33615e56174a1abf6da168cebfa8868f4ba273f16b720aa73ffe48afa6435cd258b173d0c2377d69022e7d098d75caf24c8c5e06b1c2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #239: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;8ea5f645f373f580930000000038345397330012a8ee836c5494cdffd5ee8054fdc70602766f8eed11a6c99a71c973d5659355507b843da6e327a28c11893db93df5349688a085b137b1eacf456a9e9e0f6d15ec0078ca60a7f83f2b10d213502927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #240: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;660570d323e9f75fa734000000008792d65ce93eabb7d60d8d9c1bbdcb5ef305b516a314f2fce530d6537f6a6c49966c23456f63c643cf8e0dc738f7b876e675d39ffd033c92b6d717dd536fbc5efdf1967c4bd80954479ba66b0120cd16fff22927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #241: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;d0462673154cce587dde8800000000e98d35f1f45cf9c3bf46ada2de4c568c343b2cbf046eac45842ecb7984d475831582717bebb6492fd0a485c101e29ff0a84c9b7b47a98b0f82de512bc9313aaf51701099cac5f76e68c8595fc1c1d992582927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #242: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bd90640269a7822680cedfef000000000caef15a6171059ab83e7b4418d7278f30c87d35e636f540841f14af54e2f9edd79d0312cfa1ab656c3fb15bfde48dcf47c15a5a82d24b75c85a692bd6ecafeb71409ede23efd08e0db9abf6340677ed2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #243: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;33239a52d72f1311512e41222a00000000d2dcceb301c54b4beae8e284788a7338686ff0fda2cef6bc43b58cfe6647b9e2e8176d168dec3c68ff262113760f52067ec3b651f422669601662167fa8717e976e2db5e6a4cf7c2ddabb3fde9d67d2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #244: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;b8d64fbcd4a1c10f1365d4e6d95c000000007ee4a21a1cbe1dc84c2d941ffaf144a3e23bf314f2b344fc25c7f2de8b6af3e17d27f5ee844b225985ab6e2775cf2d48e223205e98041ddc87be532abed584f0411f5729500493c9cc3f4dd15e862927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #245: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;01603d3982bf77d7a3fef3183ed092000000003a227420db4088b20fe0e9d84a2ded5b7ec8e90e7bf11f967a3d95110c41b99db3b5aa8d330eb9d638781688e97d5792c53628155e1bfc46fb1a67e3088de049c328ae1f44ec69238a009808f92927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #246: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;9ea6994f1e0384c8599aa02e6cf66d9c000000004d89ef50b7e9eb0cfbff7363bdae7bcb580bf335efd3bc3d31870f923eaccafcd40ec2f605976f15137d8b8ff6dfa12f19e525270b0106eecfe257499f373a4fb318994f24838122ce7ec3c72927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #247: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;d03215a8401bcf16693979371a01068a4700000000e2fa5bf692bc670905b18c50f9c4f0cd6940e162720957ffff513799209b78596956d21ece251c2401f1c6d7033a0a787d338e889defaaabb106b95a4355e411a59c32aa5167dfab2447262927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #248: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;307bfaaffb650c889c84bf83f0300e5dc87e000000008408fd5f64b582e3bb14f612820687604fa01906066a378d67540982e29575d019aabe90924ead5c860d3f9367702dd7dd4f75ea98afd20e328a1a99f4857b316525328230ce294b0fef2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #249: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bab5c4f4df540d7b33324d36bb0c157551527c00000000e4af574bb4d54ea6b89505e407657d6e8bc93db5da7aa6f5081f61980c1949f56b0f2f507da5782a7ac60d31904e3669738ffbeccab6c3656c08e0ed5cb92b3cfa5e7f71784f9c50212927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #250: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;d4ba47f6ae28f274e4f58d8036f9c36ec2456f5b00000000c3b869197ef5e15ebbd16fbbb656b6d0d83e6a7787cd691b08735aed371732723e1c68a40404517d9d8e35dba96028b7787d91315be675877d2d097be5e8ee34560e3e7fd25c0f002927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #251: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;79fd19c7235ea212f29f1fa00984342afe0f10aafd00000000801e47f8c184e12ec9760122db98fd06ea76848d35a6da442d2ceef7559a30cf57c61e92df327e7ab271da90859479701fccf86e462ee3393fb6814c27b760c4963625c0a198782927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #252: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;8c291e8eeaa45adbaf9aba5c0583462d79cbeb7ac97300000000a37ea6700cda54e76b7683b6650baa6a7fc49b1c51eed9ba9dd463221f7a4f1005a89fe00c592ea076886c773eb937ec1cc8374b7915cfd11b1c1ae1166152f2f7806a31c8fd2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #253: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;0eaae8641084fa979803efbfb8140732f4cdcf66c3f78a000000003c278a6b215291deaf24659ffbbce6e3c26f6021097a74abdbb69be4fb10419c0c496c946665d6fcf336d27cc7cdb982bb4e4ecef5827f84742f29f10abf83469270a03dc32927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #254: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;e02716d01fb23a5a0068399bf01bab42ef17c6d96e13846c00000000afc0f89d207a3241812d75d947419dc58efb05e8003b33fc17eb50f9d15166a88479f107cdee749f2e492b213ce80b32d0574f62f1c5d70793cf55e382d5caadf75927672927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #255: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;9eb0bf583a1a6b9a194e9a16bc7dab2a9061768af89d00659a00000000fc7de16554e49f82a855204328ac94913bf01bbe84437a355a0a37c0dee3cf81aa7728aea00de2507ddaf5c94e1e126980d3df16250a2eaebc8be486effe7f22b4f9292927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #256: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;62aac98818b3b84a2c214f0d5e72ef286e1030cb53d9a82b690e00000000cd15a54c5062648339d2bff06f71c88216c26c6e19b4d80a8c602990ac82707efdfce99bbe7fcfafae3e69fd016777517aa01056317f467ad09aff09be73c9731b0d2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #257: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;3760a7f37cf96218f29ae43732e513efd2b6f552ea4b6895464b9300000000c8975bd7157a8d363b309f1f444012b1a1d23096593133e71b4ca8b059cff37eaf7faa7a28b1c822baa241793f2abc930bd4c69840fe090f2aacc46786bf9196222927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #258: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;0da0a1d2851d33023834f2098c0880096b4320bea836cd9cbb6ff6c8000000005694a6f84b8f875c276afd2ebcfe4d61de9ec90305afb1357b95b3e0da43885e0dffad9ffd0b757d8051dec02ebdf70d8ee2dc5c7870c0823b6ccc7c679cbaa42927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #259: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;ffffffff293886d3086fd567aafd598f0fe975f735887194a764a231e82d289aa0c30e8026fdb2b4b4968a27d16a6d08f7098f1a98d21620d7454ba9790f1ba65e470453a8a399f15baf463f9deceb53acc5ca64459149688bd2760c654243392927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #260: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;7bffffffff2376d1e3c03445a072e24326acdc4ce127ec2e0e8d9ca99527e7b7614ea84acf736527dd73602cd4bb4eea1dfebebd5ad8aca52aa0228cf7b99a88737cc85f5f2d2f60d1b8183f3ed490e4de14368e96a9482c2a4dd193195c902f2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #261: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;a2b5ffffffffebb251b085377605a224bc80872602a6e467fd016807e97fa395bead6734ebe44b810d3fb2ea00b1732945377338febfd439a8d74dfbd0f942fa6bb18eae36616a7d3cad35919fd21a8af4bbe7a10f73b3e036a46b103ef56e2a2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #262: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;641227ffffffff6f1b96fa5f097fcf3cc1a3c256870d45a67b83d0967d4b20c0499625479e161dacd4db9d9ce64854c98d922cbf212703e9654fae182df9bad242c177cf37b8193a0131108d97819edd9439936028864ac195b64fca76d9d6932927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #263: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;958415d8ffffffffabad03e2fc662dc3ba203521177502298df56f36600e0f8b08f16b8093a8fb4d66a2c8065b541b3d31e3bfe694f6b89c50fb1aaa6ff6c9b29d6455e2d5d1779748573b611cb95d4a21f967410399b39b535ba3e5af81ca2e2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #264: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;f1d8de4858ffffffff1281093536f47fe13deb04e1fbe8fb954521b6975420f8be26231b6191658a19dd72ddb99ed8f8c579b6938d19bce8eed8dc2b338cb5f8e1d9a32ee56cffed37f0f22b2dcb57d5c943c14f79694a03b9c5e96952575c892927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #265: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;0927895f2802ffffffff10782dd14a3b32dc5d47c05ef6f1876b95c81fc31def15e76880898316b16204ac920a02d58045f36a229d4aa4f812638c455abe0443e74d357d3fcb5c8c5337bd6aba4178b455ca10e226e13f9638196506a19391232927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #266: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;60907984aa7e8effffffff4f332862a10a57c3063fb5a30624cf6a0c3ac80589352ecb53f8df2c503a45f9846fc28d1d31e6307d3ddbffc1132315cc07f16dad1348dfa9c482c558e1d05c5242ca1c39436726ecd28258b1899792887dd0a3c62927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #267: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;c6ff198484939170ffffffff0af42cda50f9a5f50636ea6942d6b9b8cd6ae1e24a40801a7e606ba78a0da9882ab23c7677b8642349ed3d652c5bfa5f2a9558fb3a49b64848d682ef7f605f2832f7384bdc24ed2925825bf8ea77dc59817257822927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #268: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;de030419345ca15c75ffffffff8074799b9e0956cc43135d16dfbe4d27d7e68deacc5e1a8304a74d2be412b078924b3bb3511bac855c05c9e5e9e44df3d61e967451cd8e18d6ed1885dd827714847f96ec4bb0ed4c36ce9808db8f714204f6d12927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #269: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;6f0e3eeaf42b28132b88fffffffff6c8665604d34acb19037e1ab78caaaac6ff2f7a5e9e5771d424f30f67fdab61e8ce4f8cd1214882adb65f7de94c31577052ac4e69808345809b44acb0b2bd889175fb75dd050c5a449ab9528f8f78daa10c2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #270: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;cdb549f773b3e62b3708d1ffffffffbe48f7c0591ddcae7d2cb222d1f8017ab9ffcda40f792ce4d93e7e0f0e95e1a2147dddd7f6487621c30a03d710b330021979938b55f8a17f7ed7ba9ade8f2065a1fa77618f0b67add8d58c422c2453a49a2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #271: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2c3f26f96a3ac0051df4989bffffffff9fd64886c1dc4f9924d8fd6f0edb048481f2359c4faba6b53d3e8c8c3fcc16a948350f7ab3a588b28c17603a431e39a8cd6f6a5cc3b55ead0ff695d06c6860b509e46d99fccefb9f7f9e101857f743002927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #272: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;ac18f8418c55a2502cb7d53f9affffffff5c31d89fda6a6b8476397c04edf411dfc8bf520445cbb8ee1596fb073ea283ea130251a6fdffa5c3f5f2aaf75ca808048e33efce147c9dd92823640e338e68bfd7d0dc7a4905b3a7ac711e577e90e72927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #273: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;4f9618f98e2d3a15b24094f72bb5ffffffffa2fd3e2893683e5a6ab8cf0ee610ad019f74c6941d20efda70b46c53db166503a0e393e932f688227688ba6a576293320eb7ca0710255346bdbb3102cdcf7964ef2e0988e712bc05efe16c1993452927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #274: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;422e82a3d56ed10a9cc21d31d37a25ffffffff67edf7c40204caae73ab0bc75aac8096842e8add68c34e78ce11dd71e4b54316bd3ebf7fffdeb7bd5a3ebc1883f5ca2f4f23d674502d4caf85d187215d36e3ce9f0ce219709f21a3aac003b7a82927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #275: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;7075d245ccc3281b6e7b329ff738fbb417a5ffffffffa0842d9890b5cf95d018677b2d3a59b18a5ff939b70ea002250889ddcd7b7b9d776854b4943693fb92f76b4ba856ade7677bf30307b21f3ccda35d2f63aee81efd0bab6972cc0795db552927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #276: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;3c80de54cd9226989443d593fa4fd6597e280ebeffffffffc1847eb76c217a95479e1ded14bcaed0379ba8e1b73d3115d84d31d4b7c30e1f05e1fc0d5957cfb0918f79e35b3d89487cf634a4f05b2e0c30857ca879f97c771e877027355b24432927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #277: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;de21754e29b85601980bef3d697ea2770ce891a8cdffffffffc7906aa794b39b43dfccd0edb9e280d9a58f01164d55c3d711e14b12ac5cf3b64840ead512a0a31dbe33fa8ba84533cd5c4934365b3442ca1174899b78ef9a3199f495843897722927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #278: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;8f65d92927cfb86a84dd59623fb531bb599e4d5f7289ffffffff2f1f2f57881c5b09ab637bd4caf0f4c7c7e4bca592fea20e9087c259d26a38bb4085f0bbff1145b7eb467b6748af618e9d80d6fdcd6aa24964e5a13f885bca8101de08eb0d752927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #279: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;6b63e9a74e092120160bea3877dace8a2cc7cd0e8426cbfffffffffafc8c3ca85e9b1c5a028070df5728c5c8af9b74e0667afa570a6cfa0114a5039ed15ee06fb1360907e2d9785ead362bb8d7bd661b6c29eeffd3c5037744edaeb9ad990c202927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #280: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;fc28259702a03845b6d75219444e8b43d094586e249c8699ffffffffe852512e0671a0a85c2b72d54a2fb0990e34538b4890050f5a5712f6d1a7a5fb8578f32edb1846bab6b7361479ab9c3285ca41291808f27fd5bd4fdac720e5854713694c2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #281: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;1273b4502ea4e3bccee044ee8e8db7f774ecbcd52e8ceb571757ffffffffe20a7673f8526748446477dbbb0590a45492c5d7d69859d301abbaedb35b2095103a3dc70ddf9c6b524d886bed9e6af02e0e4dec0d417a414fed3807ef4422913d7c2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #282: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;08fb565610a79baa0c566c66228d81814f8c53a15b96e602fb49ffffffffff6e7f085441070ecd2bb21285089ebb1aa6450d1a06c36d3ff39dfd657a796d12b5249712012029870a2459d18d47da9aa492a5e6cb4b2d8dafa9e4c5c54a2b9a8b2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #283: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;d59291cc2cf89f3087715fcb1aa4e79aa2403f748e97d7cd28ecaefeffffffff914c67fb61dd1e27c867398ea7322d5ab76df04bc5aa6683a8e0f30a5d287348fa07474031481dda4953e3ac1959ee8cea7e66ec412b38d6c96d28f6d37304ea2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #284: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000001000000000000000000000000fffffffffffffffffffffffcffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc63254e0ad99500288d466940031d72a9f5445a4d43784640855bf0a69874d2de5fe103c5011e6ef2c42dcd50d5d3d29f99ae6eba2c80c9244f4c5422f0979ff0c3ba5e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #286: r too large&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc63254fffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc63254eab05fd9d0de26b9ce6f4819652d9fc69193d0aa398f0fba8013e09c58220455419235271228c786759095d12b75af0692dd4103f19f6a8c32f49435a1e9b8d45&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #287: r,s are large&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd909135bdb6799286170f5ead2de4f6511453fe50914f3df2de54a36383df8dd480984f39a1ff38a86a68aa4201b6be5dfbfecf876219710b07badf6fdd4c6c5611feb97390d9826e7a06dfb41871c940d74415ed3cac2089f1445019bb55ed95&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #288: r and s^-1 have a large Hamming weight&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd27b4577ca009376f71303fd5dd227dcef5deb773ad5f5a84360644669ca249a54201b4272944201c3294f5baa9a3232b6dd687495fcc19a70a95bc602b4f7c0595c37eba9ee8171c1bb5ac6feaf753bc36f463e3aef16629572c0c0a8fb0800e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #289: r and s^-1 have a large Hamming weight&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6324d5555555550000000055555555555555553ef7a8e48d07df81a693439654210c70083539fbee44625e3acaafa2fcb41349392cef0633a1b8fabecee0c133b10e99915c1ebe7bf00df8535196770a58047ae2a402f26326bb7d41d4d7616337911e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #301: r and s^-1 are close to n&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237fffffff800000007fffffffffffffffde737d56d38bcf4279dce5617e3192a8555555550000000055555555555555553ef7a8e48d07df81a693439654210c70b533d4695dd5b8c5e07757e55e6e516f7e2c88fa0239e23f60e8ec07dd70f2871b134ee58cc583278456863f33c3a85d881f7d4a39850143e29d4eaf009afe47&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #304: point at infinity during verify&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237fffffff800000007fffffffffffffffde737d56d38bcf4279dce5617e3192a97fffffff800000007fffffffffffffffde737d56d38bcf4279dce5617e3192a8f50d371b91bfb1d7d14e1323523bc3aa8cbf2c57f9e284de628c8b4536787b86f94ad887ac94d527247cd2e7d0c8b1291c553c9730405380b14cbb209f5fa2dd&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #305: edge case for signature malleability&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237fffffff800000007fffffffffffffffde737d56d38bcf4279dce5617e3192a97fffffff800000007fffffffffffffffde737d56d38bcf4279dce5617e3192a968ec6e298eafe16539156ce57a14b04a7047c221bafc3a582eaeb0d857c4d94697bed1af17850117fdb39b2324f220a5698ed16c426a27335bb385ac8ca6fb30&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #306: edge case for signature malleability&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023555555550000000055555555555555553ef7a8e48d07df81a693439654210c70bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca60502369da0364734d2e530fece94019265fefb781a0f1b08f6c8897bdf6557927c8b866d2d3c7dcd518b23d726960f069ad71a933d86ef8abbcce8b20f71e2a847002&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #307: u1 == 1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023555555550000000055555555555555553ef7a8e48d07df81a693439654210c7044a5ad0ad0636d9f12bc9e0a6bdd5e1cbcb012ea7bf091fcec15b0c43202d52ed8adc00023a8edc02576e2b63e3e30621a471e2b2320620187bf067a1ac1ff3233e2b50ec09807accb36131fff95ed12a09a86b4ea9690aa32861576ba2362e1&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #308: u1 == n - 1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023555555550000000055555555555555553ef7a8e48d07df81a693439654210c70555555550000000055555555555555553ef7a8e48d07df81a693439654210c703623ac973ced0a56fa6d882f03a7d5c7edca02cfc7b2401fab3690dbe75ab7858db06908e64b28613da7257e737f39793da8e713ba0643b92e9bb3252be7f8fe&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #309: u2 == 1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023555555550000000055555555555555553ef7a8e48d07df81a693439654210c70aaaaaaaa00000000aaaaaaaaaaaaaaaa7def51c91a0fbf034d26872ca84218e1cf04ea77e9622523d894b93ff52dc3027b31959503b6fa3890e5e04263f922f1e8528fb7c006b3983c8b8400e57b4ed71740c2f3975438821199bedeaecab2e9&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #310: u2 == n - 1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffde91e1ba60fdedb76a46bcb51dc0b8b4b7e019f0a28721885fa5d3a8196623397db7a2c8a1ab573e5929dc24077b508d7e683d49227996bda3e9f78dbeff773504f417f3bc9a88075c2e0aadd5a13311730cf7cc76a82f11a36eaf08a6c99a206&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #311: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffdfdea5843ffeb73af94313ba4831b53fe24f799e525b1e8e8c87b59b95b430ad9dead11c7a5b396862f21974dc4752fadeff994efe9bbd05ab413765ea80b6e1f1de3f0640e8ac6edcf89cff53c40e265bb94078a343736df07aa0318fc7fe1ff&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #312: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd03ffcabf2f1b4d2a65190db1680d62bb994e41c5251cd73b3c3dfc5e5bafc035d0bc472e0d7c81ebaed3a6ef96c18613bb1fea6f994326fbe80e00dfde67c7e9986c723ea4843d48389b946f64ad56c83ad70ff17ba85335667d1bb9fa619efd&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #313: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd4dfbc401f971cd304b33dfdb17d0fed0fe4c1a88ae648e0d2847f74977534989a0a44ca947d66a2acb736008b9c08d1ab2ad03776e02640f78495d458dd51c326337fe5cf8c4604b1f1c409dc2d872d4294a4762420df43a30a2392e40426add&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #314: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffdbc4024761cd2ffd43dfdb17d0fed112b988977055cd3a8e54971eba9cda5ca71c9c2115290d008b45fb65fad0f602389298c25420b775019d42b62c3ce8a96b73877d25a8080dc02d987ca730f0405c2c9dbefac46f9e601cc3f06e9713973fd&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #315: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd788048ed39a5ffa77bfb62fa1fda2257742bf35d128fb3459f2a0c909ee86f915eca1ef4c287dddc66b8bccf1b88e8a24c0018962f3c5e7efa83bc1a5ff6033e5e79c4cb2c245b8c45abdce8a8e4da758d92a607c32cd407ecaef22f1c934a71&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #316: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd476d9131fd381bd917d0fed112bc9e0a5924b5ed5b11167edd8b23582b3cb15e5caaa030e7fdf0e4936bc7ab5a96353e0a01e4130c3f8bf22d473e317029a47adeb6adc462f7058f2a20d371e9702254e9b201642005b3ceda926b42b178bef9&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #317: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd8374253e3e21bd154448d0a8f640fe46fafa8b19ce78d538f6cc0a19662d3601c2fd20bac06e555bb8ac0ce69eb1ea20f83a1fc3501c8a66469b1a31f619b0986237050779f52b615bd7b8d76a25fc95ca2ed32525c75f27ffc87ac397e6cbaf&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #318: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd357cfd3be4d01d413c5b9ede36cba5452c11ee7fe14879e749ae6a2d897a52d63fd6a1ca7f77fb3b0bbe726c372010068426e11ea6ae78ce17bedae4bba86ced03ce5516406bf8cfaab8745eac1cd69018ad6f50b5461872ddfc56e0db3c8ff4&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #319: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd29798c5c0ee287d4a5e8e6b799fd86b8df5225298e6ffc807cd2f2bc27a0a6d89cb8e51e27a5ae3b624a60d6dc32734e4989db20e9bca3ede1edf7b086911114b4c104ab3c677e4b36d6556e8ad5f523410a19f2e277aa895fc57322b4427544&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #320: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd0b70f22c781092452dca1a5711fa3a5a1f72add1bf52c2ff7cae4820b30078dda3e52c156dcaf10502620b7955bc2b40bc78ef3d569e1223c262512d8f49602a4a2039f31c1097024ad3cc86e57321de032355463486164cf192944977df147f&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #321: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd16e1e458f021248a5b9434ae23f474b43ee55ba37ea585fef95c90416600f1baf19b78928720d5bee8e670fb90010fb15c37bf91b58a5157c3f3c059b2655e88cf701ec962fb4a11dcf273f5dc357e58468560c7cfeb942d074abd4329260509&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #322: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd2252d6856831b6cf895e4f0535eeaf0e5e5809753df848fe760ad86219016a9783a744459ecdfb01a5cf52b27a05bb7337482d242f235d7b4cb89345545c90a8c05d49337b9649813287de9ffe90355fd905df5f3c32945828121f37cc50de6e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #323: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd81ffe55f178da695b28c86d8b406b15dab1a9e39661a3ae017fbe390ac0972c3dd13c6b34c56982ddae124f039dfd23f4b19bbe88cee8e528ae51e5d6f3a21d7bfad4c2e6f263fe5eb59ca974d039fc0e4c3345692fb5320bdae4bd3b42a45ff&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #324: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd7fffffffaaaaaaaaffffffffffffffffe9a2538f37b28a2c513dee40fecbb71a67e6f659cdde869a2f65f094e94e5b4dfad636bbf95192feeed01b0f3deb7460a37e0a51f258b7aeb51dfe592f5cfd5685bbe58712c8d9233c62886437c38ba0&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #325: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffdb62f26b5f2a2b26f6de86d42ad8a13da3ab3cccd0459b201de009e526adf21f22eb6412505aec05c6545f029932087e490d05511e8ec1f599617bb367f9ecaaf805f51efcc4803403f9b1ae0124890f06a43fedcddb31830f6669af292895cb0&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #326: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffdbb1d9ac949dd748cd02bbbe749bd351cd57b38bb61403d700686aa7b4c90851e84db645868eab35e3a9fd80e056e2e855435e3a6b68d75a50a854625fe0d7f356d2589ac655edc9a11ef3e075eddda9abf92e72171570ef7bf43a2ee39338cfe&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #327: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd66755a00638cdaec1c732513ca0234ece52545dac11f816e818f725b4f60aaf291b9e47c56278662d75c0983b22ca8ea6aa5059b7a2ff7637eb2975e386ad66349aa8ff283d0f77c18d6d11dc062165fd13c3c0310679c1408302a16854ecfbd&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #328: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd55a00c9fcdaebb6032513ca0234ecfffe98ebe492fdf02e48ca48e982beb3669f3ec2f13caf04d0192b47fb4c5311fb6d4dc6b0a9e802e5327f7ec5ee8e4834df97e3e468b7d0db867d6ecfe81e2b0f9531df87efdb47c1338ac321fefe5a432&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #329: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffdab40193f9b5d76c064a27940469d9fffd31d7c925fbe05c919491d3057d66cd2d92b200aefcab6ac7dafd9acaf2fa10b3180235b8f46b4503e4693c670fccc885ef2f3aebf5b317475336256768f7c19efb7352d27e4cccadc85b6b8ab922c72&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #330: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffdca0234ebb5fdcb13ca0234ecffffffffcb0dadbbc7f549f8a26b4408d0dc86000a88361eb92ecca2625b38e5f98bbabb96bf179b3d76fc48140a3bcd881523cde6bdf56033f84a5054035597375d90866aa2c96b86a41ccf6edebf47298ad489&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #331: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffdbfffffff3ea3677e082b9310572620ae19933a9e65b285598711c77298815ad3d0fb17ccd8fafe827e0c1afc5d8d80366e2b20e7f14a563a2ba50469d84375e868612569d39e2bb9f554355564646de99ac602cc6349cf8c1e236a7de7637d93&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #332: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd266666663bbbbbbbe6666666666666665b37902e023fab7c8f055d86e5cc41f4836f33bbc1dc0d3d3abbcef0d91f11e2ac4181076c9af0a22b1e4309d3edb2769ab443ff6f901e30c773867582997c2bec2b0cb8120d760236f3a95bbe881f75&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #333: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffdbfffffff36db6db7a492492492492492146c573f4c6dfc8d08a443e258970b0992f99fbe973ed4a299719baee4b432741237034dec8d72ba5103cb33e55feeb8033dd0e91134c734174889f3ebcf1b7a1ac05767289280ee7a794cebd6e69697&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #334: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffdbfffffff2aaaaaab7fffffffffffffffc815d0e60b3e596ecb1ad3a27cfd49c4d35ba58da30197d378e618ec0fa7e2e2d12cffd73ebbb2049d130bba434af09eff83986e6875e41ea432b7585a49b3a6c77cbb3c47919f8e82874c794635c1d2&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #335: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd7fffffff55555555ffffffffffffffffd344a71e6f651458a27bdc81fd976e378651ce490f1b46d73f3ff475149be29136697334a519d7ddab0725c8d0793224e11c65bd8ca92dc8bc9ae82911f0b52751ce21dd9003ae60900bd825f590cc28&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #336: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd3fffffff800000007fffffffffffffffde737d56d38bcf4279dce5617e3192aa6d8e1b12c831a0da8795650ff95f101ed921d9e2f72b15b1cdaca9826b9cfc6def6d63e2bc5c089570394a4bc9f892d5e6c7a6a637b20469a58c106ad486bf37&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #337: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd5d8ecd64a4eeba466815ddf3a4de9a8e6abd9c5db0a01eb80343553da648428f0ae580bae933b4ef2997cbdbb0922328ca9a410f627a0f7dff24cb4d920e15428911e7f8cc365a8a88eb81421a361ccc2b99e309d8dcd9a98ba83c3949d893e3&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #338: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050236f2347cab7dd76858fe0555ac3bc99048c4aacafdfb6bcbe05ea6c42c4934569bb726660235793aa9957a61e76e00c2c435109cf9a15dd624d53f4301047856b5b812fd521aafa69835a849cce6fbdeb6983b442d2444fe70e134c027fc46963838a40f2a36092e9004e92d8d940cf5638550ce672ce8b8d4e15eba5499249e9&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #339: point duplication during verification&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050236f2347cab7dd76858fe0555ac3bc99048c4aacafdfb6bcbe05ea6c42c4934569bb726660235793aa9957a61e76e00c2c435109cf9a15dd624d53f4301047856b5b812fd521aafa69835a849cce6fbdeb6983b442d2444fe70e134c027fc469637c75bf0c5c9f6d17ffb16d2726bf30a9c7aaf31a8d317472b1ea145ab66db616&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #340: duplication bug&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023555555550000000055555555555555553ef7a8e48d07df81a693439654210c703333333300000000333333333333333325c7cbbc549e52e763f1f55a327a3aa9dd86d3b5f4a13e8511083b78002081c53ff467f11ebd98a51a633db76665d25045d5c8200c89f2fa10d849349226d21d8dfaed6ff8d5cb3e1b7e17474ebc18f7&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #343: comparison with point at infinity &quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237cf27b188d034f7e8a52380304b51ac3c08969e277f21b35a60b48fc47669978555555550000000055555555555555553ef7a8e48d07df81a693439654210c704fea55b32cb32aca0c12c4cd0abfb4e64b0f5a516e578c016591a93f5a0fbcc5d7d3fd10b2be668c547b212f6bb14c88f0fecd38a8a4b2c785ed3be62ce4b280&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #344: extreme value for k and edgecase s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237cf27b188d034f7e8a52380304b51ac3c08969e277f21b35a60b48fc47669978b6db6db6249249254924924924924924625bd7a09bec4ca81bcdd9f8fd6b63ccc6a771527024227792170a6f8eee735bf32b7f98af669ead299802e32d7c3107bc3b4b5e65ab887bbd343572b3e5619261fe3a073e2ffd78412f726867db589e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #345: extreme value for k and s^-1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237cf27b188d034f7e8a52380304b51ac3c08969e277f21b35a60b48fc47669978cccccccc00000000cccccccccccccccc971f2ef152794b9d8fc7d568c9e8eaa7851c2bbad08e54ec7a9af99f49f03644d6ec6d59b207fec98de85a7d15b956efcee9960283045075684b410be8d0f7494b91aa2379f60727319f10ddeb0fe9d6&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #346: extreme value for k and s^-1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237cf27b188d034f7e8a52380304b51ac3c08969e277f21b35a60b48fc476699783333333300000000333333333333333325c7cbbc549e52e763f1f55a327a3aaaf6417c8a670584e388676949e53da7fc55911ff68318d1bf3061205acb19c48f8f2b743df34ad0f72674acb7505929784779cd9ac916c3669ead43026ab6d43f&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #347: extreme value for k and s^-1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237cf27b188d034f7e8a52380304b51ac3c08969e277f21b35a60b48fc4766997849249248db6db6dbb6db6db6db6db6db5a8b230d0b2b51dcd7ebf0c9fef7c185501421277be45a5eefec6c639930d636032565af420cf3373f557faa7f8a06438673d6cb6076e1cfcdc7dfe7384c8e5cac08d74501f2ae6e89cad195d0aa1371&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #348: extreme value for k and s^-1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050237cf27b188d034f7e8a52380304b51ac3c08969e277f21b35a60b48fc4766997816a4502e2781e11ac82cbc9d1edd8c981584d13e18411e2f6e0478c34416e3bb0d935bf9ffc115a527735f729ca8a4ca23ee01a4894adf0e3415ac84e808bb343195a3762fea29ed38912bd9ea6c4fde70c3050893a4375850ce61d82eba33c5&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #349: extreme value for k&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050236b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296555555550000000055555555555555553ef7a8e48d07df81a693439654210c705e59f50708646be8a589355014308e60b668fb670196206c41e748e64e4dca215de37fee5c97bcaf7144d5b459982f52eeeafbdf03aacbafef38e213624a01de&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #350: extreme value for k and edgecase s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050236b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296b6db6db6249249254924924924924924625bd7a09bec4ca81bcdd9f8fd6b63cc169fb797325843faff2f7a5b5445da9e2fd6226f7ef90ef0bfe924104b02db8e7bbb8de662c7b9b1cf9b22f7a2e582bd46d581d68878efb2b861b131d8a1d667&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #351: extreme value for k and s^-1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050236b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296cccccccc00000000cccccccccccccccc971f2ef152794b9d8fc7d568c9e8eaa7271cd89c000143096b62d4e9e4ca885aef2f7023d18affdaf8b7b548981487540a1c6e954e32108435b55fa385b0f76481a609b9149ccb4b02b2ca47fe8e4da5&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #352: extreme value for k and s^-1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050236b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c2963333333300000000333333333333333325c7cbbc549e52e763f1f55a327a3aaa3d0bc7ed8f09d2cb7ddb46ebc1ed799ab1563a9ab84bf524587a220afe499c12e22dc3b3c103824a4f378d96adb0a408abf19ce7d68aa6244f78cb216fa3f8df&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #353: extreme value for k and s^-1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050236b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c29649249248db6db6dbb6db6db6db6db6db5a8b230d0b2b51dcd7ebf0c9fef7c185a6c885ade1a4c566f9bb010d066974abb281797fa701288c721bcbd23663a9b72e424b690957168d193a6096fc77a2b004a9c7d467e007e1f2058458f98af316&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #354: extreme value for k and s^-1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050236b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c29616a4502e2781e11ac82cbc9d1edd8c981584d13e18411e2f6e0478c34416e3bb8d3c2c2c3b765ba8289e6ac3812572a25bf75df62d87ab7330c3bdbad9ebfa5c4c6845442d66935b238578d43aec54f7caa1621d1af241d4632e0b780c423f5d&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #355: extreme value for k&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023249249246db6db6ddb6db6db6db6db6dad4591868595a8ee6bf5f864ff7be0c26b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c2964fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #356: testing point duplication&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca60502344a5ad0ad0636d9f12bc9e0a6bdd5e1cbcb012ea7bf091fcec15b0c43202d52e249249246db6db6ddb6db6db6db6db6dad4591868595a8ee6bf5f864ff7be0c26b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c2964fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #357: testing point duplication&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023249249246db6db6ddb6db6db6db6db6dad4591868595a8ee6bf5f864ff7be0c26b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296b01cbd1c01e58065711814b583f061e9d431cca994cea1313449bf97c840ae0a&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #358: testing point duplication&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca60502344a5ad0ad0636d9f12bc9e0a6bdd5e1cbcb012ea7bf091fcec15b0c43202d52e249249246db6db6ddb6db6db6db6db6dad4591868595a8ee6bf5f864ff7be0c26b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296b01cbd1c01e58065711814b583f061e9d431cca994cea1313449bf97c840ae0a&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #359: testing point duplication&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855b292a619339f6e567a305c951c0dcbcc42d16e47f219f9e98e76e09d8770b34a0177e60492c5a8242f76f07bfe3661bde59ec2a17ce5bd2dab2abebdf89a62e204aaec73635726f213fb8a9e64da3b8632e41495a944d0045b522eba7240fad587d9315798aaa3a5ba01775787ced05eaaf7b4e09fc81d6d1aa546e8365d525d&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #360: pseudorandom signature&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;dc1921946f4af96a2856e7be399007c9e807bdf4c5332f19f59ec9dd1bb8c7b3530bd6b0c9af2d69ba897f6b5fb59695cfbf33afe66dbadcf5b8d2a2a6538e23d85e489cb7a161fd55ededcedbf4cc0c0987e3e3f0f242cae934c72caa3f43e904aaec73635726f213fb8a9e64da3b8632e41495a944d0045b522eba7240fad587d9315798aaa3a5ba01775787ced05eaaf7b4e09fc81d6d1aa546e8365d525d&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #361: pseudorandom signature&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023a8ea150cb80125d7381c4c1f1da8e9de2711f9917060406a73d7904519e51388f3ab9fa68bd47973a73b2d40480c2ba50c22c9d76ec217257288293285449b8604aaec73635726f213fb8a9e64da3b8632e41495a944d0045b522eba7240fad587d9315798aaa3a5ba01775787ced05eaaf7b4e09fc81d6d1aa546e8365d525d&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #362: pseudorandom signature&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;de47c9b27eb8d300dbb5f2c353e632c393262cf06340c4fa7f1b40c4cbd36f90986e65933ef2ed4ee5aada139f52b70539aaf63f00a91f29c69178490d57fb713dafedfb8da6189d372308cbf1489bbbdabf0c0217d1c0ff0f701aaa7a694b9c04aaec73635726f213fb8a9e64da3b8632e41495a944d0045b522eba7240fad587d9315798aaa3a5ba01775787ced05eaaf7b4e09fc81d6d1aa546e8365d525d&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #363: pseudorandom signature&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91d434e262a49eab7781e353a3565e482550dd0fd5defa013c7f29745eff3569f19b0c0a93f267fb6052fd8077be769c2b98953195d7bc10de844218305c6ba17a4f337ccfd67726a805e4f1600ae2849df3807eca117380239fbd816900000000ed9dea124cc8c396416411e988c30f427eb504af43a3146cd5df7ea60666d685&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #364: x-coordinate of the public key has many trailing 0&#39;s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f910fe774355c04d060f76d79fd7a772e421463489221bf0a33add0be9b1979110b500dcba1c69a8fbd43fa4f57f743ce124ca8b91a1f325f3fac6181175df557374f337ccfd67726a805e4f1600ae2849df3807eca117380239fbd816900000000ed9dea124cc8c396416411e988c30f427eb504af43a3146cd5df7ea60666d685&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #365: x-coordinate of the public key has many trailing 0&#39;s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91bb40bf217bed3fb3950c7d39f03d36dc8e3b2cd79693f125bfd06595ee1135e3541bf3532351ebb032710bdb6a1bf1bfc89a1e291ac692b3fa4780745bb556774f337ccfd67726a805e4f1600ae2849df3807eca117380239fbd816900000000ed9dea124cc8c396416411e988c30f427eb504af43a3146cd5df7ea60666d685&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #366: x-coordinate of the public key has many trailing 0&#39;s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91664eb7ee6db84a34df3c86ea31389a5405badd5ca99231ff556d3e75a233e73a59f3c752e52eca46137642490a51560ce0badc678754b8f72e51a2901426a1bd3cf03d614d8939cfd499a07873fac281618f06b8ff87e8015c3f49726500493584fa174d791c72bf2ce3880a8960dd2a7c7a1338a82f85a9e59cdbde80000000&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #367: y-coordinate of the public key has many trailing 0&#39;s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f914cd0429bbabd2827009d6fcd843d4ce39c3e42e2d1631fd001985a79d1fd8b439638bf12dd682f60be7ef1d0e0d98f08b7bca77a1a2b869ae466189d2acdabe33cf03d614d8939cfd499a07873fac281618f06b8ff87e8015c3f49726500493584fa174d791c72bf2ce3880a8960dd2a7c7a1338a82f85a9e59cdbde80000000&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #368: y-coordinate of the public key has many trailing 0&#39;s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91e56c6ea2d1b017091c44d8b6cb62b9f460e3ce9aed5e5fd41e8added97c56c04a308ec31f281e955be20b457e463440b4fcf2b80258078207fc1378180f89b553cf03d614d8939cfd499a07873fac281618f06b8ff87e8015c3f49726500493584fa174d791c72bf2ce3880a8960dd2a7c7a1338a82f85a9e59cdbde80000000&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #369: y-coordinate of the public key has many trailing 0&#39;s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f911158a08d291500b4cabed3346d891eee57c176356a2624fb011f8fbbf3466830228a8c486a736006e082325b85290c5bc91f378b75d487dda46798c18f2855193cf03d614d8939cfd499a07873fac281618f06b8ff87e8015c3f4972650049357b05e8b186e38d41d31c77f5769f22d58385ecc857d07a561a6324217fffffff&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #370: y-coordinate of the public key has many trailing 1&#39;s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91b1db9289649f59410ea36b0c0fc8d6aa2687b29176939dd23e0dde56d309fa9d3e1535e4280559015b0dbd987366dcf43a6d1af5c23c7d584e1c3f48a12513363cf03d614d8939cfd499a07873fac281618f06b8ff87e8015c3f4972650049357b05e8b186e38d41d31c77f5769f22d58385ecc857d07a561a6324217fffffff&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #371: y-coordinate of the public key has many trailing 1&#39;s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91b7b16e762286cb96446aa8d4e6e7578b0a341a79f2dd1a220ac6f0ca4e24ed86ddc60a700a139b04661c547d07bbb0721780146df799ccf55e55234ecb8f12bc3cf03d614d8939cfd499a07873fac281618f06b8ff87e8015c3f4972650049357b05e8b186e38d41d31c77f5769f22d58385ecc857d07a561a6324217fffffff&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #372: y-coordinate of the public key has many trailing 1&#39;s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91d82a7c2717261187c8e00d8df963ff35d796edad36bc6e6bd1c91c670d9105b43dcabddaf8fcaa61f4603e7cbac0f3c0351ecd5988efb23f680d07debd1399292829c31faa2e400e344ed94bca3fcd0545956ebcfe8ad0f6dfa5ff8effffffffa01aafaf000e52585855afa7676ade284113099052df57e7eb3bd37ebeb9222e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #373: x-coordinate of the public key has many trailing 1&#39;s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f915eb9c8845de68eb13d5befe719f462d77787802baff30ce96a5cba063254af782c026ae9be2e2a5e7ca0ff9bbd92fb6e44972186228ee9a62b87ddbe2ef66fb52829c31faa2e400e344ed94bca3fcd0545956ebcfe8ad0f6dfa5ff8effffffffa01aafaf000e52585855afa7676ade284113099052df57e7eb3bd37ebeb9222e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #374: x-coordinate of the public key has many trailing 1&#39;s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f9196843dd03c22abd2f3b782b170239f90f277921becc117d0404a8e4e36230c28f2be378f526f74a543f67165976de9ed9a31214eb4d7e6db19e1ede123dd991d2829c31faa2e400e344ed94bca3fcd0545956ebcfe8ad0f6dfa5ff8effffffffa01aafaf000e52585855afa7676ade284113099052df57e7eb3bd37ebeb9222e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #375: x-coordinate of the public key has many trailing 1&#39;s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91766456dce1857c906f9996af729339464d27e9d98edc2d0e3b760297067421f6402385ecadae0d8081dccaf5d19037ec4e55376eced699e93646bfbbf19d0b41fffffff948081e6a0458dd8f9e738f2665ff9059ad6aac0708318c4ca9a7a4f55a8abcba2dda8474311ee54149b973cae0c0fb89557ad0bf78e6529a1663bd73&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #376: x-coordinate of the public key is large&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91c605c4b2edeab20419e6518a11b2dbc2b97ed8b07cced0b19c34f777de7b9fd9edf0f612c5f46e03c719647bc8af1b29b2cde2eda700fb1cff5e159d47326dbafffffff948081e6a0458dd8f9e738f2665ff9059ad6aac0708318c4ca9a7a4f55a8abcba2dda8474311ee54149b973cae0c0fb89557ad0bf78e6529a1663bd73&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #377: x-coordinate of the public key is large&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91d48b68e6cabfe03cf6141c9ac54141f210e64485d9929ad7b732bfe3b7eb8a84feedae50c61bd00e19dc26f9b7e2265e4508c389109ad2f208f0772315b6c941fffffff948081e6a0458dd8f9e738f2665ff9059ad6aac0708318c4ca9a7a4f55a8abcba2dda8474311ee54149b973cae0c0fb89557ad0bf78e6529a1663bd73&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #378: x-coordinate of the public key is large&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91b7c81457d4aeb6aa65957098569f0479710ad7f6595d5874c35a93d12a5dd4c7b7961a0b652878c2d568069a432ca18a1a9199f2ca574dad4b9e3a05c0a1cdb300000003fa15f963949d5f03a6f5c7f86f9e0015eeb23aebbff1173937ba748e1099872070e8e87c555fa13659cca5d7fadcfcb0023ea889548ca48af2ba7e71&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #379: x-coordinate of the public key is small&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f916b01332ddb6edfa9a30a1321d5858e1ee3cf97e263e669f8de5e9652e76ff3f75939545fced457309a6a04ace2bd0f70139c8f7d86b02cb1cc58f9e69e96cd5a00000003fa15f963949d5f03a6f5c7f86f9e0015eeb23aebbff1173937ba748e1099872070e8e87c555fa13659cca5d7fadcfcb0023ea889548ca48af2ba7e71&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #380: x-coordinate of the public key is small&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91efdb884720eaeadc349f9fc356b6c0344101cd2fd8436b7d0e6a4fb93f106361f24bee6ad5dc05f7613975473aadf3aacba9e77de7d69b6ce48cb60d8113385d00000003fa15f963949d5f03a6f5c7f86f9e0015eeb23aebbff1173937ba748e1099872070e8e87c555fa13659cca5d7fadcfcb0023ea889548ca48af2ba7e71&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #381: x-coordinate of the public key is small&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f9131230428405560dcb88fb5a646836aea9b23a23dd973dcbe8014c87b8b20eb070f9344d6e812ce166646747694a41b0aaf97374e19f3c5fb8bd7ae3d9bd0beffbcbb2914c79f045eaa6ecbbc612816b3be5d2d6796707d8125e9f851c18af015000000001352bb4a0fa2ea4cceb9ab63dd684ade5a1127bcf300a698a7193bc2&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #382: y-coordinate of the public key is small&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91caa797da65b320ab0d5c470cda0b36b294359c7db9841d679174db34c4855743cf543a62f23e212745391aaf7505f345123d2685ee3b941d3de6d9b36242e5a0bcbb2914c79f045eaa6ecbbc612816b3be5d2d6796707d8125e9f851c18af015000000001352bb4a0fa2ea4cceb9ab63dd684ade5a1127bcf300a698a7193bc2&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #383: y-coordinate of the public key is small&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f917e5f0ab5d900d3d3d7867657e5d6d36519bc54084536e7d21c336ed8001859459450c07f201faec94b82dfb322e5ac676688294aad35aa72e727ff0b19b646aabcbb2914c79f045eaa6ecbbc612816b3be5d2d6796707d8125e9f851c18af015000000001352bb4a0fa2ea4cceb9ab63dd684ade5a1127bcf300a698a7193bc2&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #384: y-coordinate of the public key is small&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91d7d70c581ae9e3f66dc6a480bf037ae23f8a1e4a2136fe4b03aa69f0ca25b35689c460f8a5a5c2bbba962c8a3ee833a413e85658e62a59e2af41d9127cc47224bcbb2914c79f045eaa6ecbbc612816b3be5d2d6796707d8125e9f851c18af015fffffffeecad44b6f05d15b33146549c2297b522a5eed8430cff596758e6c43d&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #385: y-coordinate of the public key is large&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91341c1b9ff3c83dd5e0dfa0bf68bcdf4bb7aa20c625975e5eeee34bb396266b3472b69f061b750fd5121b22b11366fad549c634e77765a017902a67099e0a4469bcbb2914c79f045eaa6ecbbc612816b3be5d2d6796707d8125e9f851c18af015fffffffeecad44b6f05d15b33146549c2297b522a5eed8430cff596758e6c43d&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #386: y-coordinate of the public key is large&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f9170bebe684cdcb5ca72a42f0d873879359bd1781a591809947628d313a3814f67aec03aca8f5587a4d535fa31027bbe9cc0e464b1c3577f4c2dcde6b2094798a9bcbb2914c79f045eaa6ecbbc612816b3be5d2d6796707d8125e9f851c18af015fffffffeecad44b6f05d15b33146549c2297b522a5eed8430cff596758e6c43d&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_secp256r1_sha256_test.json EcdsaVerify SHA-256 #387: y-coordinate of the public key is large&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050232ba3a8be6b94d5ec80a6d9d1190a436effe50d85a1eee859b8cc6af9bd5c2e184cd60b855d442f5b3c7b11eb6c4e0ae7525fe710fab9aa7c77a67f79e6fadd762927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #1: signature malleability&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050232ba3a8be6b94d5ec80a6d9d1190a436effe50d85a1eee859b8cc6af9bd5c2e18b329f479a2bbd0a5c384ee1493b1f5186a87139cac5df4087c134b49156847db2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #2: Legacy:ASN encoding of s misses leading 0&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050232ba3a8be6b94d5ec80a6d9d1190a436effe50d85a1eee859b8cc6af9bd5c2e18b329f479a2bbd0a5c384ee1493b1f5186a87139cac5df4087c134b49156847db2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #3: valid&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca60502329a3a8be6b94d5ec80a6d9d1190a436effe50d85a1eee859b8cc6af9bd5c2e18b329f479a2bbd0a5c384ee1493b1f5186a87139cac5df4087c134b49156847db2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #118: modify first byte of integer&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050232ba3a8be6b94d5ec80a6d9d1190a436effe50d85a1eee859b8cc6af9bd5c2e98b329f479a2bbd0a5c384ee1493b1f5186a87139cac5df4087c134b49156847db2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #120: modify last byte of integer&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050232ba3a8be6b94d5ec80a6d9d1190a436effe50d85a1eee859b8cc6af9bd5c2e18b329f479a2bbd0a5c384ee1493b1f5186a87139cac5df4087c134b491568475b2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #121: modify last byte of integer&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050232ba3a8be6b94d5ec80a6d9d1190a436effe50d85a1eee859b8cc6af9bd5c2e1800b329f479a2bbd0a5c384ee1493b1f5186a87139cac5df4087c134b491568472927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #124: truncated integer&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023d45c5741946b2a137f59262ee6f5bc91001af27a5e1117a64733950642a3d1e8b329f479a2bbd0a5c384ee1493b1f5186a87139cac5df4087c134b49156847db2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #133: Modified r or s, e.g. by adding or subtracting the order of the group&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023d45c5740946b2a147f59262ee6f5bc90bd01ed280528b62b3aed5fc93f06f739b329f479a2bbd0a5c384ee1493b1f5186a87139cac5df4087c134b49156847db2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #134: Modified r or s, e.g. by adding or subtracting the order of the group&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023d45c5741946b2a137f59262ee6f5bc91001af27a5e1117a64733950642a3d1e8b329f479a2bbd0a5c384ee1493b1f5186a87139cac5df4087c134b49156847db2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #137: Modified r or s, e.g. by adding or subtracting the order of the group&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050232ba3a8be6b94d5ec80a6d9d1190a436effe50d85a1eee859b8cc6af9bd5c2e18b329f47aa2bbd0a4c384ee1493b1f518ada018ef05465583885980861905228a2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #139: Modified r or s, e.g. by adding or subtracting the order of the group&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050232ba3a8be6b94d5ec80a6d9d1190a436effe50d85a1eee859b8cc6af9bd5c2e184cd60b865d442f5a3c7b11eb6c4e0ae79578ec6353a20bf783ecb4b6ea97b8252927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #143: Modified r or s, e.g. by adding or subtracting the order of the group&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325512927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #177: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325502927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #178: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325522927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #179: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551ffffffff00000001000000000000000000000000ffffffffffffffffffffffff2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #180: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551ffffffff000000010000000000000000000000010000000000000000000000002927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #181: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632550ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325512927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #187: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632550ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325502927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #188: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632550ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325522927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #189: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632550ffffffff00000001000000000000000000000000ffffffffffffffffffffffff2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #190: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632550ffffffff000000010000000000000000000000010000000000000000000000002927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #191: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632552ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325512927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #197: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632552ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325502927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #198: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632552ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325522927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #199: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632552ffffffff00000001000000000000000000000000ffffffffffffffffffffffff2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #200: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632552ffffffff000000010000000000000000000000010000000000000000000000002927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #201: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000001000000000000000000000000ffffffffffffffffffffffffffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325512927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #207: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000001000000000000000000000000ffffffffffffffffffffffffffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325502927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #208: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000001000000000000000000000000ffffffffffffffffffffffffffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325522927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #209: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000001000000000000000000000000ffffffffffffffffffffffffffffffff00000001000000000000000000000000ffffffffffffffffffffffff2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #210: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000001000000000000000000000000ffffffffffffffffffffffffffffffff000000010000000000000000000000010000000000000000000000002927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #211: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000001000000000000000000000001000000000000000000000000ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325512927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #217: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000001000000000000000000000001000000000000000000000000ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325502927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #218: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000001000000000000000000000001000000000000000000000000ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325522927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #219: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000001000000000000000000000001000000000000000000000000ffffffff00000001000000000000000000000000ffffffffffffffffffffffff2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #220: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000001000000000000000000000001000000000000000000000000ffffffff000000010000000000000000000000010000000000000000000000002927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #221: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;70239dd877f7c944c422f44dea4ed1a52f2627416faf2f072fa50c772ed6f80764a1aab5000d0e804f3e2fc02bdee9be8ff312334e2ba16d11547c97711c898e6af015971cc30be6d1a206d4e013e0997772a2f91d73286ffd683b9bb2cf4f1b2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #230: Edge case for Shamir multiplication&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;00000000690ed426ccf17803ebe2bd0884bcd58a1bb5e7477ead3645f356e7a916aea964a2f6506d6f78c81c91fc7e8bded7d397738448de1e19a0ec580bf266252cd762130c6667cfe8b7bc47d27d78391e8e80c578d1cd38c3ff033be928e92927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #231: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;7300000000213f2a525c6035725235c2f696ad3ebb5ee47f140697ad25770d919cc98be2347d469bf476dfc26b9b733df2d26d6ef524af917c665baccb23c882093496459effe2d8d70727b82462f61d0ec1b7847929d10ea631dacb16b56c322927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #232: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;ddf2000000005e0be0635b245f0b97978afd25daadeb3edb4a0161c27fe0604573b3c90ecd390028058164524dde892703dce3dea0d53fa8093999f07ab8aa432f67b0b8e20636695bb7d8bf0a651c802ed25a395387b5f4188c0c4075c886342927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #233: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;67ab1900000000784769c4ecb9e164d6642b8499588b89855be1ec355d0841a0bfab3098252847b328fadf2f89b95c851a7f0eb390763378f37e90119d5ba3ddbdd64e234e832b1067c2d058ccb44d978195ccebb65c2aaf1e2da9b8b4987e3b2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #234: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;a2bf09460000000076d7dbeffe125eaf02095dff252ee905e296b6350fc311cf204a9784074b246d8bf8bf04a4ceb1c1f1c9aaab168b1596d17093c5cd21d2cd51cce41670636783dc06a759c8847868a406c2506fe17975582fe648d1d88b522927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #235: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;3554e827c700000000e1e75e624a06b3a0a353171160858129e15c544e4f0e65ed66dc34f551ac82f63d4aa4f81fe2cb0031a91d1314f835027bca0f1ceeaa0399ca123aa09b13cd194a422e18d5fda167623c3f6e5d4d6abb8953d67c0c48c72927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #236: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;9b6cd3b812610000000026941a0f0bb53255ea4c9fd0cb3426e3a54b9fc6965c060b700bef665c68899d44f2356a578d126b062023ccc3c056bf0f60a237012b8d186c027832965f4fcc78a3366ca95dedbb410cbef3f26d6be5d581c11d36102927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #237: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;883ae39f50bf0100000000e7561c26fc82a52baa51c71ca877162f93c4ae01869f6adfe8d5eb5b2c24d7aa7934b6cf29c93ea76cd313c9132bb0c8e38c96831db26a9c9e40e55ee0890c944cf271756c906a33e66b5bd15e051593883b5e99022927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #238: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;a1ce5d6e5ecaf28b0000000000fa7cd010540f420fb4ff7401fe9fce011d0ba6a1af03ca91677b673ad2f33615e56174a1abf6da168cebfa8868f4ba273f16b720aa73ffe48afa6435cd258b173d0c2377d69022e7d098d75caf24c8c5e06b1c2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #239: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;8ea5f645f373f580930000000038345397330012a8ee836c5494cdffd5ee8054fdc70602766f8eed11a6c99a71c973d5659355507b843da6e327a28c11893db93df5349688a085b137b1eacf456a9e9e0f6d15ec0078ca60a7f83f2b10d213502927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #240: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;660570d323e9f75fa734000000008792d65ce93eabb7d60d8d9c1bbdcb5ef305b516a314f2fce530d6537f6a6c49966c23456f63c643cf8e0dc738f7b876e675d39ffd033c92b6d717dd536fbc5efdf1967c4bd80954479ba66b0120cd16fff22927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #241: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;d0462673154cce587dde8800000000e98d35f1f45cf9c3bf46ada2de4c568c343b2cbf046eac45842ecb7984d475831582717bebb6492fd0a485c101e29ff0a84c9b7b47a98b0f82de512bc9313aaf51701099cac5f76e68c8595fc1c1d992582927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #242: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bd90640269a7822680cedfef000000000caef15a6171059ab83e7b4418d7278f30c87d35e636f540841f14af54e2f9edd79d0312cfa1ab656c3fb15bfde48dcf47c15a5a82d24b75c85a692bd6ecafeb71409ede23efd08e0db9abf6340677ed2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #243: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;33239a52d72f1311512e41222a00000000d2dcceb301c54b4beae8e284788a7338686ff0fda2cef6bc43b58cfe6647b9e2e8176d168dec3c68ff262113760f52067ec3b651f422669601662167fa8717e976e2db5e6a4cf7c2ddabb3fde9d67d2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #244: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;b8d64fbcd4a1c10f1365d4e6d95c000000007ee4a21a1cbe1dc84c2d941ffaf144a3e23bf314f2b344fc25c7f2de8b6af3e17d27f5ee844b225985ab6e2775cf2d48e223205e98041ddc87be532abed584f0411f5729500493c9cc3f4dd15e862927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #245: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;01603d3982bf77d7a3fef3183ed092000000003a227420db4088b20fe0e9d84a2ded5b7ec8e90e7bf11f967a3d95110c41b99db3b5aa8d330eb9d638781688e97d5792c53628155e1bfc46fb1a67e3088de049c328ae1f44ec69238a009808f92927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #246: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;9ea6994f1e0384c8599aa02e6cf66d9c000000004d89ef50b7e9eb0cfbff7363bdae7bcb580bf335efd3bc3d31870f923eaccafcd40ec2f605976f15137d8b8ff6dfa12f19e525270b0106eecfe257499f373a4fb318994f24838122ce7ec3c72927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #247: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;d03215a8401bcf16693979371a01068a4700000000e2fa5bf692bc670905b18c50f9c4f0cd6940e162720957ffff513799209b78596956d21ece251c2401f1c6d7033a0a787d338e889defaaabb106b95a4355e411a59c32aa5167dfab2447262927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #248: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;307bfaaffb650c889c84bf83f0300e5dc87e000000008408fd5f64b582e3bb14f612820687604fa01906066a378d67540982e29575d019aabe90924ead5c860d3f9367702dd7dd4f75ea98afd20e328a1a99f4857b316525328230ce294b0fef2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #249: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bab5c4f4df540d7b33324d36bb0c157551527c00000000e4af574bb4d54ea6b89505e407657d6e8bc93db5da7aa6f5081f61980c1949f56b0f2f507da5782a7ac60d31904e3669738ffbeccab6c3656c08e0ed5cb92b3cfa5e7f71784f9c50212927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #250: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;d4ba47f6ae28f274e4f58d8036f9c36ec2456f5b00000000c3b869197ef5e15ebbd16fbbb656b6d0d83e6a7787cd691b08735aed371732723e1c68a40404517d9d8e35dba96028b7787d91315be675877d2d097be5e8ee34560e3e7fd25c0f002927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #251: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;79fd19c7235ea212f29f1fa00984342afe0f10aafd00000000801e47f8c184e12ec9760122db98fd06ea76848d35a6da442d2ceef7559a30cf57c61e92df327e7ab271da90859479701fccf86e462ee3393fb6814c27b760c4963625c0a198782927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #252: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;8c291e8eeaa45adbaf9aba5c0583462d79cbeb7ac97300000000a37ea6700cda54e76b7683b6650baa6a7fc49b1c51eed9ba9dd463221f7a4f1005a89fe00c592ea076886c773eb937ec1cc8374b7915cfd11b1c1ae1166152f2f7806a31c8fd2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #253: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;0eaae8641084fa979803efbfb8140732f4cdcf66c3f78a000000003c278a6b215291deaf24659ffbbce6e3c26f6021097a74abdbb69be4fb10419c0c496c946665d6fcf336d27cc7cdb982bb4e4ecef5827f84742f29f10abf83469270a03dc32927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #254: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;e02716d01fb23a5a0068399bf01bab42ef17c6d96e13846c00000000afc0f89d207a3241812d75d947419dc58efb05e8003b33fc17eb50f9d15166a88479f107cdee749f2e492b213ce80b32d0574f62f1c5d70793cf55e382d5caadf75927672927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #255: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;9eb0bf583a1a6b9a194e9a16bc7dab2a9061768af89d00659a00000000fc7de16554e49f82a855204328ac94913bf01bbe84437a355a0a37c0dee3cf81aa7728aea00de2507ddaf5c94e1e126980d3df16250a2eaebc8be486effe7f22b4f9292927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #256: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;62aac98818b3b84a2c214f0d5e72ef286e1030cb53d9a82b690e00000000cd15a54c5062648339d2bff06f71c88216c26c6e19b4d80a8c602990ac82707efdfce99bbe7fcfafae3e69fd016777517aa01056317f467ad09aff09be73c9731b0d2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #257: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;3760a7f37cf96218f29ae43732e513efd2b6f552ea4b6895464b9300000000c8975bd7157a8d363b309f1f444012b1a1d23096593133e71b4ca8b059cff37eaf7faa7a28b1c822baa241793f2abc930bd4c69840fe090f2aacc46786bf9196222927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #258: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;0da0a1d2851d33023834f2098c0880096b4320bea836cd9cbb6ff6c8000000005694a6f84b8f875c276afd2ebcfe4d61de9ec90305afb1357b95b3e0da43885e0dffad9ffd0b757d8051dec02ebdf70d8ee2dc5c7870c0823b6ccc7c679cbaa42927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #259: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;ffffffff293886d3086fd567aafd598f0fe975f735887194a764a231e82d289aa0c30e8026fdb2b4b4968a27d16a6d08f7098f1a98d21620d7454ba9790f1ba65e470453a8a399f15baf463f9deceb53acc5ca64459149688bd2760c654243392927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #260: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;7bffffffff2376d1e3c03445a072e24326acdc4ce127ec2e0e8d9ca99527e7b7614ea84acf736527dd73602cd4bb4eea1dfebebd5ad8aca52aa0228cf7b99a88737cc85f5f2d2f60d1b8183f3ed490e4de14368e96a9482c2a4dd193195c902f2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #261: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;a2b5ffffffffebb251b085377605a224bc80872602a6e467fd016807e97fa395bead6734ebe44b810d3fb2ea00b1732945377338febfd439a8d74dfbd0f942fa6bb18eae36616a7d3cad35919fd21a8af4bbe7a10f73b3e036a46b103ef56e2a2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #262: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;641227ffffffff6f1b96fa5f097fcf3cc1a3c256870d45a67b83d0967d4b20c0499625479e161dacd4db9d9ce64854c98d922cbf212703e9654fae182df9bad242c177cf37b8193a0131108d97819edd9439936028864ac195b64fca76d9d6932927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #263: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;958415d8ffffffffabad03e2fc662dc3ba203521177502298df56f36600e0f8b08f16b8093a8fb4d66a2c8065b541b3d31e3bfe694f6b89c50fb1aaa6ff6c9b29d6455e2d5d1779748573b611cb95d4a21f967410399b39b535ba3e5af81ca2e2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #264: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;f1d8de4858ffffffff1281093536f47fe13deb04e1fbe8fb954521b6975420f8be26231b6191658a19dd72ddb99ed8f8c579b6938d19bce8eed8dc2b338cb5f8e1d9a32ee56cffed37f0f22b2dcb57d5c943c14f79694a03b9c5e96952575c892927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #265: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;0927895f2802ffffffff10782dd14a3b32dc5d47c05ef6f1876b95c81fc31def15e76880898316b16204ac920a02d58045f36a229d4aa4f812638c455abe0443e74d357d3fcb5c8c5337bd6aba4178b455ca10e226e13f9638196506a19391232927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #266: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;60907984aa7e8effffffff4f332862a10a57c3063fb5a30624cf6a0c3ac80589352ecb53f8df2c503a45f9846fc28d1d31e6307d3ddbffc1132315cc07f16dad1348dfa9c482c558e1d05c5242ca1c39436726ecd28258b1899792887dd0a3c62927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #267: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;c6ff198484939170ffffffff0af42cda50f9a5f50636ea6942d6b9b8cd6ae1e24a40801a7e606ba78a0da9882ab23c7677b8642349ed3d652c5bfa5f2a9558fb3a49b64848d682ef7f605f2832f7384bdc24ed2925825bf8ea77dc59817257822927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #268: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;de030419345ca15c75ffffffff8074799b9e0956cc43135d16dfbe4d27d7e68deacc5e1a8304a74d2be412b078924b3bb3511bac855c05c9e5e9e44df3d61e967451cd8e18d6ed1885dd827714847f96ec4bb0ed4c36ce9808db8f714204f6d12927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #269: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;6f0e3eeaf42b28132b88fffffffff6c8665604d34acb19037e1ab78caaaac6ff2f7a5e9e5771d424f30f67fdab61e8ce4f8cd1214882adb65f7de94c31577052ac4e69808345809b44acb0b2bd889175fb75dd050c5a449ab9528f8f78daa10c2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #270: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;cdb549f773b3e62b3708d1ffffffffbe48f7c0591ddcae7d2cb222d1f8017ab9ffcda40f792ce4d93e7e0f0e95e1a2147dddd7f6487621c30a03d710b330021979938b55f8a17f7ed7ba9ade8f2065a1fa77618f0b67add8d58c422c2453a49a2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #271: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2c3f26f96a3ac0051df4989bffffffff9fd64886c1dc4f9924d8fd6f0edb048481f2359c4faba6b53d3e8c8c3fcc16a948350f7ab3a588b28c17603a431e39a8cd6f6a5cc3b55ead0ff695d06c6860b509e46d99fccefb9f7f9e101857f743002927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #272: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;ac18f8418c55a2502cb7d53f9affffffff5c31d89fda6a6b8476397c04edf411dfc8bf520445cbb8ee1596fb073ea283ea130251a6fdffa5c3f5f2aaf75ca808048e33efce147c9dd92823640e338e68bfd7d0dc7a4905b3a7ac711e577e90e72927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #273: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;4f9618f98e2d3a15b24094f72bb5ffffffffa2fd3e2893683e5a6ab8cf0ee610ad019f74c6941d20efda70b46c53db166503a0e393e932f688227688ba6a576293320eb7ca0710255346bdbb3102cdcf7964ef2e0988e712bc05efe16c1993452927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #274: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;422e82a3d56ed10a9cc21d31d37a25ffffffff67edf7c40204caae73ab0bc75aac8096842e8add68c34e78ce11dd71e4b54316bd3ebf7fffdeb7bd5a3ebc1883f5ca2f4f23d674502d4caf85d187215d36e3ce9f0ce219709f21a3aac003b7a82927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #275: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;7075d245ccc3281b6e7b329ff738fbb417a5ffffffffa0842d9890b5cf95d018677b2d3a59b18a5ff939b70ea002250889ddcd7b7b9d776854b4943693fb92f76b4ba856ade7677bf30307b21f3ccda35d2f63aee81efd0bab6972cc0795db552927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #276: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;3c80de54cd9226989443d593fa4fd6597e280ebeffffffffc1847eb76c217a95479e1ded14bcaed0379ba8e1b73d3115d84d31d4b7c30e1f05e1fc0d5957cfb0918f79e35b3d89487cf634a4f05b2e0c30857ca879f97c771e877027355b24432927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #277: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;de21754e29b85601980bef3d697ea2770ce891a8cdffffffffc7906aa794b39b43dfccd0edb9e280d9a58f01164d55c3d711e14b12ac5cf3b64840ead512a0a31dbe33fa8ba84533cd5c4934365b3442ca1174899b78ef9a3199f495843897722927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #278: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;8f65d92927cfb86a84dd59623fb531bb599e4d5f7289ffffffff2f1f2f57881c5b09ab637bd4caf0f4c7c7e4bca592fea20e9087c259d26a38bb4085f0bbff1145b7eb467b6748af618e9d80d6fdcd6aa24964e5a13f885bca8101de08eb0d752927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #279: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;6b63e9a74e092120160bea3877dace8a2cc7cd0e8426cbfffffffffafc8c3ca85e9b1c5a028070df5728c5c8af9b74e0667afa570a6cfa0114a5039ed15ee06fb1360907e2d9785ead362bb8d7bd661b6c29eeffd3c5037744edaeb9ad990c202927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #280: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;fc28259702a03845b6d75219444e8b43d094586e249c8699ffffffffe852512e0671a0a85c2b72d54a2fb0990e34538b4890050f5a5712f6d1a7a5fb8578f32edb1846bab6b7361479ab9c3285ca41291808f27fd5bd4fdac720e5854713694c2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #281: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;1273b4502ea4e3bccee044ee8e8db7f774ecbcd52e8ceb571757ffffffffe20a7673f8526748446477dbbb0590a45492c5d7d69859d301abbaedb35b2095103a3dc70ddf9c6b524d886bed9e6af02e0e4dec0d417a414fed3807ef4422913d7c2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #282: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;08fb565610a79baa0c566c66228d81814f8c53a15b96e602fb49ffffffffff6e7f085441070ecd2bb21285089ebb1aa6450d1a06c36d3ff39dfd657a796d12b5249712012029870a2459d18d47da9aa492a5e6cb4b2d8dafa9e4c5c54a2b9a8b2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #283: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;d59291cc2cf89f3087715fcb1aa4e79aa2403f748e97d7cd28ecaefeffffffff914c67fb61dd1e27c867398ea7322d5ab76df04bc5aa6683a8e0f30a5d287348fa07474031481dda4953e3ac1959ee8cea7e66ec412b38d6c96d28f6d37304ea2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #284: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e25ffffffff00000001000000000000000000000000fffffffffffffffffffffffcffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc63254ed705d16f80987e2d9b1a6957d29ce22febf7d10fa515153182415c8361baaca4b1fc105ee5ce80d514ec1238beae2037a6f83625593620d460819e8682160926&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #636: r too large&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e25ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc63254fffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc63254e3cd8d2f81d6953b0844c09d7b560d527cd2ef67056893eadafa52c8501387d59ee41fdb4d10402ce7a0c5e3b747adfa3a490b62a6b7719068903485c0bb6dc2d&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #637: r,s are large&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd909135bdb6799286170f5ead2de4f6511453fe50914f3df2de54a36383df8dd48240cd81edd91cb6936133508c3915100e81f332c4545d41189b481196851378e05b06e72d4a1bff80ea5db514aa2f93ea6dd6d9c0ae27b7837dc432f9ce89d9&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #638: r and s^-1 have a large Hamming weight&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd27b4577ca009376f71303fd5dd227dcef5deb773ad5f5a84360644669ca249a5b062947356748b0fc17f1704c65aa1dca6e1bfe6779756fa616d91eaad13df2c0b38c17f3d0672e7409cfc5992a99fff12b84a4f8432293b431113f1b2fb579d&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #639: r and s^-1 have a large Hamming weight&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e25ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6324d5555555550000000055555555555555553ef7a8e48d07df81a693439654210c707a736d8e326a9ca62bbe25a34ea4e3633b499a96afa7aaa3fcf3fd88f8e07edeb3e45879d8622b93e818443a686e869eeda7bf9ae46aa3eafcc48a5934864627&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #651: r and s^-1 are close to n&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257fffffff800000007fffffffffffffffde737d56d38bcf4279dce5617e3192a8555555550000000055555555555555553ef7a8e48d07df81a693439654210c700203736fcb198b15d8d7a0c80f66dddd15259240aa78d08aae67c467de04503434383438d5041ea9a387ee8e4d4e84b4471b160c6bcf2568b072f8f20e87a996&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #654: point at infinity during verify&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257fffffff800000007fffffffffffffffde737d56d38bcf4279dce5617e3192a97fffffff800000007fffffffffffffffde737d56d38bcf4279dce5617e3192a878d844dc7f16b73b1f2a39730da5d8cd99fe2e70a18482384e37dcd2bfea02e1ed6572e01eb7a8d113d02c666c45ef22d3b9a6a6dea99aa43a8183c26e75d336&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #655: edge case for signature malleability&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257fffffff800000007fffffffffffffffde737d56d38bcf4279dce5617e3192a97fffffff800000007fffffffffffffffde737d56d38bcf4279dce5617e3192a9dec6c8257dde94110eacc8c09d2e5789cc5beb81a958b02b4d62da9599a7401466fae1614174be63970b83f6524421067b06dd6f4e9c56baca4e344fdd690f1d&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #656: edge case for signature malleability&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e25555555550000000055555555555555553ef7a8e48d07df81a693439654210c70532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e25a17f5b75a35ed64623ca5cbf1f91951292db0c23f0c2ea24c3d0cad0988cabc083a7a618625c228940730b4fa3ee64faecbb2fc20fdde7c58b3a3f6300424dc6&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #657: u1 == 1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e25555555550000000055555555555555553ef7a8e48d07df81a693439654210c70acd155416a8b77f34089464733ff7cd39c400e9c69af7beb9eac5054ed2ec72c04ba0cba291a37db13f33bf90dab628c04ec8393a0200419e9eaa1ebcc9fb5c31f3a0a0e6823a49b625ad57b12a32d4047970fc3428f0f0049ecf4265dc12f62&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #658: u1 == n - 1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e25555555550000000055555555555555553ef7a8e48d07df81a693439654210c70555555550000000055555555555555553ef7a8e48d07df81a693439654210c70692b6c828e0feed63d8aeaa2b7322f9ccbe8723a1ed39f229f204a434b8900efa1f6f6abcb38ea3b8fde38b98c7c271f274af56a8c5628dc3329069ae4dd5716&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #659: u2 == 1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e25555555550000000055555555555555553ef7a8e48d07df81a693439654210c70aaaaaaaa00000000aaaaaaaaaaaaaaaa7def51c91a0fbf034d26872ca84218e100cefd9162d13e64cb93687a9cd8f9755ebb5a3ef7632f800f84871874ccef09543ecbeaf7e8044ef721be2fb5f549e4b8480d2587404ebf7dbbef2c54bc0cb1&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #660: u2 == n - 1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd710f8e3edc7c2d5a3fd23de844002bb949d9f794f6d5405f6d97c1bb03dd2bd2b975183b42551cf52f291d5c1921fd5e12f50c8c85a4beb9de03efa3f0f244862243018e6866df922dc313612020311ff21e242ce3fb15bc78c406b25ab43091&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #661: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffdedffbc270f722c243069a7e5f40335a61a58525c7b4db2e7a8e269274ffe4e1bc25f1d166f3e211cdf042a26f8abf6094d48b8d17191d74ed71714927446699965d06dd6a88abfa49e8b4c5da6bb922851969adf9604b5accfb52a114e77ccdb&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #662: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffda25adcae105ed7ff4f95d2344e24ee523314c3e178525d007904b68919ba4d538fe5e88243a76e41a004236218a3c3a2d6eee398a23c3a0b008d7f0164cbc0ca98a20d1bdcf573513c7cfd9b83c63e3a82d40127c897697c86b8cb387af7f240&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #663: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd2e4348c645707dce6760d773de3f3e87346924b2f64bd3dd0297e766b5805ebb02148256b530fbc470c7b341970b38243ecee6d5a840a37beca2efb37e8dff2cc0adbea0882482a7489ca703a399864ba987eeb6ddb738af53a83573473cb30d&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #664: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd348c673b07dce3920d773de3f3e87408869e916dbcf797d8f9684fb67753d1dca34db012ce6eda1e9c7375c5fcf3e54ed698e19615124273b3a621d021c76f8e777458d6f55a364c221e39e1205d5510bb4fbb7ddf08d8d8fdde13d1d6df7f14&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #665: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd6918ce760fb9c7241aee7bc7e7d0e8110d3d22db79ef2fb1f2d09f6ceea7a3b8b97af3fe78be15f2912b6271dd8a43badb6dd2a1b315b2ce7ae37b4e7778041d930d71ee1992d2466495c42102d08e81154c305307d1dcd52d0fa4c479b278e7&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #666: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd73b3c694391d8eadde3f3e874089464715ac20e4c126bbf6d864d648969f5b5a81e7198a3c3f23901cedc7a1d6eff6e9bf81108e6c35cd8559139af3135dbcbb9ef1568530291a8061b90c9f4285eefcba990d4570a4e3b7b737525b5d580034&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #667: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffdbb07ac7a86948c2c2989a16db1930ef1b89ce112595197656877e53c41457f28ab4d792ca121d1dba39cb9de645149c2ab573e8becc6ddff3cc9960f188ddf737f90ba23664153e93262ff73355415195858d7be1315a69456386de68285a3c8&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #668: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd27e4d82cb6c061dd9337c69bf9332ed3d198662d6f2299443f62c861187db648518412b69af43aae084476a68d59bbde51fbfa9e5be80563f587c9c2652f88ef2d3b90d25baa6bdb7b0c55e5240a3a98fbc24afed8523edec1c70503fc10f233&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #669: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffde7c5cf3aac2e88923b77850515fff6a12d13b356dfe9ec275c3dd81ae94609a4a08f14a644b9a935dffea4761ebaf592d1f66fe6cd373aa7f5d370af34f8352da54b5bc4025cf335900a914c2934ec2fec7a396d0a7affcad732a5741c7aaaf5&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #670: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffdc77838df91c1e953e016e10bddffea2317f9fee32bacfe553cede9e57a748f68ccf2296a6a89b62b90739d38af4ae3a20e9f45715b90044639241061e33f8f8caace0046491eeaa1c6e9a472b96d88f4af83e7ff1bb84438c7e058034412ae08&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #671: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd8ef071c02383d2a6c02dc217bbffd446730d0318b0425e2586220907f885f97f94b0fc1525bcabf82b1f34895e5819a06c02b23e04002276e165f962c86e3927be7c2ab4d0b25303204fb32a1f8292902792225e16a6d2dbfb29fbc89a9c3376&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #672: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd5668aaa0b545bbf9a044a32399ffbe69ce20074e34d7bdf5cf56282a769763965351f37e1de0c88c508527d89882d183ccdcf2efca407edb0627cadfd16de6ec44b4b57cdf960d32ebcc4c97847eed218425853b5b675eb781b766a1a1300349&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #673: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffdd12d6e56882f6c0027cae91a27127728f7fddf478fb4fdc2b65f40a60b0eb952748bbafc320e6735cb64019710a269c6c2b5d147bdc831325cb2fb276ac971a69d655e9a755bc9d800ad21ee3fd4d980d93a7a49a8c5ccd37005177578f51163&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #674: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd7fffffffaaaaaaaaffffffffffffffffe9a2538f37b28a2c513dee40fecbb71a14b3bbd75c5e1c0c36535a934d4ab85112410b3b90fa97a31c33038964fd85cc112f7d837f8f9c36b460d636c965a5f818f2b50c5d00fb3f9705561dd6631883&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #675: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffdb62f26b5f2a2b26f6de86d42ad8a13da3ab3cccd0459b201de009e526adf21f2d823533c04cd8edc6d6f950a8e08ade04a9bafa2f14a590356935671ae9305bf43178d1f88b6a57a96924c265f0ddb75b58312907b195acb59d7797303123775&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #676: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffdbb1d9ac949dd748cd02bbbe749bd351cd57b38bb61403d700686aa7b4c90851edb2b3408b3167d91030624c6328e8ce3ec108c105575c2f3d209b92e654bab69c34318139c50b0802c6e612f0fd3189d800df7c996d5d7b7c3d6be82836fa258&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #677: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd66755a00638cdaec1c732513ca0234ece52545dac11f816e818f725b4f60aaf209179ce7c59225392216453b2ac1e9d178c24837dfae26bc1dd7ab60638527425556b42e330289f3b826b2db7a86d19d45c2860a59f2be1ddcc3b691f95a9255&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #678: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd55a00c9fcdaebb6032513ca0234ecfffe98ebe492fdf02e48ca48e982beb366901959fb8deda56e5467b7e4b214ea4c2d0c2fb29d70ff19b6b1eccebd6568d7ed9dbd77a918297fd970bff01e1343f6925167db5a14d098a211c39cc3a413398&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #679: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffdab40193f9b5d76c064a27940469d9fffd31d7c925fbe05c919491d3057d66cd2567f1fdc387e5350c852b4e8f8ba9d6d947e1c5dd7ccc61a5938245dd6bcab3a9960bebaf919514f9535c22eaaf0b5812857970e26662267b1f3eb1011130a11&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #680: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffdca0234ebb5fdcb13ca0234ecffffffffcb0dadbbc7f549f8a26b4408d0dc86003499f974ff4ca6bbb2f51682fd5f51762f9dd6dd2855262660b36d46d3e4bec2f498fae2487807e220119152f0122476c64d4fa46ddce85c4546630f0d5c5e81&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #681: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffdbfffffff3ea3677e082b9310572620ae19933a9e65b285598711c77298815ad32c5c01662cf00c1929596257db13b26ecf30d0f3ec4b9f0351b0f27094473426e986a086060d086eee822ddd2fc744247a0154b57f7a69c51d9fdafa484e4ac7&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #682: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd266666663bbbbbbbe6666666666666665b37902e023fab7c8f055d86e5cc41f491d4cba813a04d86dbae94c23be6f52c15774183be7ba5b2d9f3cf010b160501900b8adfea6491019a9ac080d516025a541bf4b952b0ad7be4b1874b02fd544a&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #683: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffdbfffffff36db6db7a492492492492492146c573f4c6dfc8d08a443e258970b09ef7fd0a3a36386638330ecad41e1a3b302af36960831d0210c614b948e8aa124ef0d6d800e4047d6d3c1be0fdeaf11fcd8cab5ab59c730eb34116e35a8c7d098&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #684: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffdbfffffff2aaaaaab7fffffffffffffffc815d0e60b3e596ecb1ad3a27cfd49c4a521dab13cc9152d8ca77035a607fea06c55cc3ca5dbeb868cea92eafe93df2a7bfb9b28531996635e6a5ccaa2826a406ce1111bdb9c2e0ca36500418a2f43de&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #685: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd7fffffff55555555ffffffffffffffffd344a71e6f651458a27bdc81fd976e37474d58a4eec16e0d565f2187fe11d4e8e7a2683a12f38b4fc01d1237a81a10976e55f73bb7cdda46bdb67ef77f6fd2969df2b67920fb5945fde3a517a6ded4cd&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #686: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd3fffffff800000007fffffffffffffffde737d56d38bcf4279dce5617e3192aa692da5cd4309d9a6e5cb525c37da8fa0879f7b57208cdabbf47d223a5b23a62140e0daa78cfdd207a7389aaed61738b17fc5fc3e6a5ed3397d2902e9125e6ab4&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #687: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd5d8ecd64a4eeba466815ddf3a4de9a8e6abd9c5db0a01eb80343553da648428f85689b3e0775c7718a90279f14a8082cfcd4d1f1679274f4e9b8805c570a0670167fcc5ca734552e09afa3640f4a034e15b9b7ca661ec7ff70d3f240ebe705b1&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #688: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e256f2347cab7dd76858fe0555ac3bc99048c4aacafdfb6bcbe05ea6c42c4934569f21d907e3890916dc4fa1f4703c1e50d3f54ddf7383e44023a41de562aa18ed80158137755b901f797a90d4ca8887e023cb2ef63b2ba2c0d455edaef42cf237e2a964fc00d377a8592b8b61aafa7a4aaa7c7b9fd2b41d6e0e17bd1ba5677edcd&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #689: point duplication during verification&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e256f2347cab7dd76858fe0555ac3bc99048c4aacafdfb6bcbe05ea6c42c4934569f21d907e3890916dc4fa1f4703c1e50d3f54ddf7383e44023a41de562aa18ed80158137755b901f797a90d4ca8887e023cb2ef63b2ba2c0d455edaef42cf237ed569b03ef2c8857b6d4749e550585b5558384603d4be291f1e842e45a9881232&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #690: duplication bug&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e25555555550000000055555555555555553ef7a8e48d07df81a693439654210c703333333300000000333333333333333325c7cbbc549e52e763f1f55a327a3aa9664ce273320d918d8bdb2e61201b4549b36b7cdc54e33b84adb6f2c10aac831e49e68831f18bda2973ac3d76bfbc8c5ee1cceed2dd862e2dc7c915c736cef1f4&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #693: comparison with point at infinity &quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257cf27b188d034f7e8a52380304b51ac3c08969e277f21b35a60b48fc47669978555555550000000055555555555555553ef7a8e48d07df81a693439654210c70961691a5e960d07a301dbbad4d86247ec27d7089faeb3ddd1add395efff1e0fe7254622cc371866cdf990d2c5377790e37d1f1519817f09a231bd260a9e78aeb&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #694: extreme value for k and edgecase s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257cf27b188d034f7e8a52380304b51ac3c08969e277f21b35a60b48fc47669978b6db6db6249249254924924924924924625bd7a09bec4ca81bcdd9f8fd6b63cc5d283e13ce8ca60da868e3b0fb33e6b4f1074793274e2928250e71e2aca63e9c214dc74fa25371fb4d9e506d418ed9a1bfd6d0c8bb6591d3e0f44505a84886ce&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #695: extreme value for k and s^-1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257cf27b188d034f7e8a52380304b51ac3c08969e277f21b35a60b48fc47669978cccccccc00000000cccccccccccccccc971f2ef152794b9d8fc7d568c9e8eaa70fc351da038ae0803bd1d86514ae0462f9f8216551d9315aa9d297f792eef6a341c74eed786f2d33da35360ca7aa925e753f00d6077a1e9e5fc339d634019c73&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #696: extreme value for k and s^-1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257cf27b188d034f7e8a52380304b51ac3c08969e277f21b35a60b48fc476699783333333300000000333333333333333325c7cbbc549e52e763f1f55a327a3aaaa1e34c8f16d138673fee55c080547c2bfd4de7550065f638322bba9430ce4b60662be9bb512663aa4d7df8ab3f3b4181c5d44a7bdf42436620b7d8a6b81ac936&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #697: extreme value for k and s^-1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257cf27b188d034f7e8a52380304b51ac3c08969e277f21b35a60b48fc4766997849249248db6db6dbb6db6db6db6db6db5a8b230d0b2b51dcd7ebf0c9fef7c1857e1a8a8338d7fd8cf41d322a302d2078a87a23c7186150ed7cda6e52817c1bdfd0a9135a89d21ce821e29014b2898349254d748272b2d4eb8d59ee34c615377f&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #698: extreme value for k and s^-1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257cf27b188d034f7e8a52380304b51ac3c08969e277f21b35a60b48fc4766997816a4502e2781e11ac82cbc9d1edd8c981584d13e18411e2f6e0478c34416e3bb5c19fe227a61abc65c61ee7a018cc9571b2c6f663ea33583f76a686f64be078b7b4a0d734940f613d52bc48673b457c2cf78492490a5cc5606c0541d17b24ddb&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #699: extreme value for k&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e256b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296555555550000000055555555555555553ef7a8e48d07df81a693439654210c70db02d1f3421d600e9d9ef9e47419dba3208eed08c2d4189a5db63abeb2739666e0ed26967b9ada9ed7ffe480827f90a0d210d5fd8ec628e31715e6b24125512a&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #700: extreme value for k and edgecase s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e256b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296b6db6db6249249254924924924924924625bd7a09bec4ca81bcdd9f8fd6b63cc6222d1962655501893c29e441395b6c05711bd3ed5a0ef72cfab338b88229c4baaae079cb44a1af070362aaa520ee24cac2626423b0bf81af1c54311d8e2fd23&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #701: extreme value for k and s^-1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e256b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296cccccccc00000000cccccccccccccccc971f2ef152794b9d8fc7d568c9e8eaa74ccfa24c67f3def7fa81bc99c70bb0419c0952ba599f4c03361da184b04cdca5db76b797f7f41d9c729a2219478a7e629728df870800be8cf6ca7a0a82153bfa&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #702: extreme value for k and s^-1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e256b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c2963333333300000000333333333333333325c7cbbc549e52e763f1f55a327a3aaaea1c72c91034036bac71402b6e9ecc4af3dbde7a99dc574061e99fefff9d84dab7dd057e75b78ac6f56e34eb048f0a9d29d5d055408c90d02bc2ea918c18cb63&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #703: extreme value for k and s^-1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e256b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c29649249248db6db6dbb6db6db6db6db6db5a8b230d0b2b51dcd7ebf0c9fef7c185c2879a66d86cb20b820b7795da2da62b38924f7817d1cd350d936988e90e79bc5431a7268ff6931c7a759de024eff90bcb0177216db6fd1f3aaaa11fa3b6a083&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #704: extreme value for k and s^-1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e256b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c29616a4502e2781e11ac82cbc9d1edd8c981584d13e18411e2f6e0478c34416e3bbab1c0f273f74abc2b848c75006f2ef3c54c26df27711b06558f455079aee0ba3df510f2ecef6d9a05997c776f14ad6456c179f0a13af1771e4d6c37fa48b47f2&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #705: extreme value for k&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e25532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e25249249246db6db6ddb6db6db6db6db6dad4591868595a8ee6bf5f864ff7be0c26b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c2964fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #706: testing point duplication&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e25acd155416a8b77f34089464733ff7cd39c400e9c69af7beb9eac5054ed2ec72c249249246db6db6ddb6db6db6db6db6dad4591868595a8ee6bf5f864ff7be0c26b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c2964fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #707: testing point duplication&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e25532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e25249249246db6db6ddb6db6db6db6db6dad4591868595a8ee6bf5f864ff7be0c26b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296b01cbd1c01e58065711814b583f061e9d431cca994cea1313449bf97c840ae0a&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #708: testing point duplication&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e25acd155416a8b77f34089464733ff7cd39c400e9c69af7beb9eac5054ed2ec72c249249246db6db6ddb6db6db6db6db6dad4591868595a8ee6bf5f864ff7be0c26b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296b01cbd1c01e58065711814b583f061e9d431cca994cea1313449bf97c840ae0a&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #709: testing point duplication&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023a8ea150cb80125d7381c4c1f1da8e9de2711f9917060406a73d7904519e51388f3ab9fa68bd47973a73b2d40480c2ba50c22c9d76ec217257288293285449b8604aaec73635726f213fb8a9e64da3b8632e41495a944d0045b522eba7240fad587d9315798aaa3a5ba01775787ced05eaaf7b4e09fc81d6d1aa546e8365d525d&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #1210: pseudorandom signature&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e2530e782f964b2e2ff065a051bc7adc20615d8c43a1365713c88268822c253bcce5b16df652aa1ecb2dc8b46c515f9604e2e84cacfa7c6eec30428d2d3f4e08ed504aaec73635726f213fb8a9e64da3b8632e41495a944d0045b522eba7240fad587d9315798aaa3a5ba01775787ced05eaaf7b4e09fc81d6d1aa546e8365d525d&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #1211: pseudorandom signature&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855b292a619339f6e567a305c951c0dcbcc42d16e47f219f9e98e76e09d8770b34a0177e60492c5a8242f76f07bfe3661bde59ec2a17ce5bd2dab2abebdf89a62e204aaec73635726f213fb8a9e64da3b8632e41495a944d0045b522eba7240fad587d9315798aaa3a5ba01775787ced05eaaf7b4e09fc81d6d1aa546e8365d525d&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #1212: pseudorandom signature&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;de47c9b27eb8d300dbb5f2c353e632c393262cf06340c4fa7f1b40c4cbd36f90986e65933ef2ed4ee5aada139f52b70539aaf63f00a91f29c69178490d57fb713dafedfb8da6189d372308cbf1489bbbdabf0c0217d1c0ff0f701aaa7a694b9c04aaec73635726f213fb8a9e64da3b8632e41495a944d0045b522eba7240fad587d9315798aaa3a5ba01775787ced05eaaf7b4e09fc81d6d1aa546e8365d525d&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #1213: pseudorandom signature&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91d434e262a49eab7781e353a3565e482550dd0fd5defa013c7f29745eff3569f19b0c0a93f267fb6052fd8077be769c2b98953195d7bc10de844218305c6ba17a4f337ccfd67726a805e4f1600ae2849df3807eca117380239fbd816900000000ed9dea124cc8c396416411e988c30f427eb504af43a3146cd5df7ea60666d685&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #1303: x-coordinate of the public key has many trailing 0&#39;s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f910fe774355c04d060f76d79fd7a772e421463489221bf0a33add0be9b1979110b500dcba1c69a8fbd43fa4f57f743ce124ca8b91a1f325f3fac6181175df557374f337ccfd67726a805e4f1600ae2849df3807eca117380239fbd816900000000ed9dea124cc8c396416411e988c30f427eb504af43a3146cd5df7ea60666d685&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #1304: x-coordinate of the public key has many trailing 0&#39;s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91bb40bf217bed3fb3950c7d39f03d36dc8e3b2cd79693f125bfd06595ee1135e3541bf3532351ebb032710bdb6a1bf1bfc89a1e291ac692b3fa4780745bb556774f337ccfd67726a805e4f1600ae2849df3807eca117380239fbd816900000000ed9dea124cc8c396416411e988c30f427eb504af43a3146cd5df7ea60666d685&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #1305: x-coordinate of the public key has many trailing 0&#39;s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91664eb7ee6db84a34df3c86ea31389a5405badd5ca99231ff556d3e75a233e73a59f3c752e52eca46137642490a51560ce0badc678754b8f72e51a2901426a1bd3cf03d614d8939cfd499a07873fac281618f06b8ff87e8015c3f49726500493584fa174d791c72bf2ce3880a8960dd2a7c7a1338a82f85a9e59cdbde80000000&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #1306: y-coordinate of the public key has many trailing 0&#39;s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f914cd0429bbabd2827009d6fcd843d4ce39c3e42e2d1631fd001985a79d1fd8b439638bf12dd682f60be7ef1d0e0d98f08b7bca77a1a2b869ae466189d2acdabe33cf03d614d8939cfd499a07873fac281618f06b8ff87e8015c3f49726500493584fa174d791c72bf2ce3880a8960dd2a7c7a1338a82f85a9e59cdbde80000000&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #1307: y-coordinate of the public key has many trailing 0&#39;s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91e56c6ea2d1b017091c44d8b6cb62b9f460e3ce9aed5e5fd41e8added97c56c04a308ec31f281e955be20b457e463440b4fcf2b80258078207fc1378180f89b553cf03d614d8939cfd499a07873fac281618f06b8ff87e8015c3f49726500493584fa174d791c72bf2ce3880a8960dd2a7c7a1338a82f85a9e59cdbde80000000&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #1308: y-coordinate of the public key has many trailing 0&#39;s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f911158a08d291500b4cabed3346d891eee57c176356a2624fb011f8fbbf3466830228a8c486a736006e082325b85290c5bc91f378b75d487dda46798c18f2855193cf03d614d8939cfd499a07873fac281618f06b8ff87e8015c3f4972650049357b05e8b186e38d41d31c77f5769f22d58385ecc857d07a561a6324217fffffff&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #1309: y-coordinate of the public key has many trailing 1&#39;s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91b1db9289649f59410ea36b0c0fc8d6aa2687b29176939dd23e0dde56d309fa9d3e1535e4280559015b0dbd987366dcf43a6d1af5c23c7d584e1c3f48a12513363cf03d614d8939cfd499a07873fac281618f06b8ff87e8015c3f4972650049357b05e8b186e38d41d31c77f5769f22d58385ecc857d07a561a6324217fffffff&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #1310: y-coordinate of the public key has many trailing 1&#39;s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91b7b16e762286cb96446aa8d4e6e7578b0a341a79f2dd1a220ac6f0ca4e24ed86ddc60a700a139b04661c547d07bbb0721780146df799ccf55e55234ecb8f12bc3cf03d614d8939cfd499a07873fac281618f06b8ff87e8015c3f4972650049357b05e8b186e38d41d31c77f5769f22d58385ecc857d07a561a6324217fffffff&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #1311: y-coordinate of the public key has many trailing 1&#39;s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91d82a7c2717261187c8e00d8df963ff35d796edad36bc6e6bd1c91c670d9105b43dcabddaf8fcaa61f4603e7cbac0f3c0351ecd5988efb23f680d07debd1399292829c31faa2e400e344ed94bca3fcd0545956ebcfe8ad0f6dfa5ff8effffffffa01aafaf000e52585855afa7676ade284113099052df57e7eb3bd37ebeb9222e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #1312: x-coordinate of the public key has many trailing 1&#39;s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f915eb9c8845de68eb13d5befe719f462d77787802baff30ce96a5cba063254af782c026ae9be2e2a5e7ca0ff9bbd92fb6e44972186228ee9a62b87ddbe2ef66fb52829c31faa2e400e344ed94bca3fcd0545956ebcfe8ad0f6dfa5ff8effffffffa01aafaf000e52585855afa7676ade284113099052df57e7eb3bd37ebeb9222e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #1313: x-coordinate of the public key has many trailing 1&#39;s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f9196843dd03c22abd2f3b782b170239f90f277921becc117d0404a8e4e36230c28f2be378f526f74a543f67165976de9ed9a31214eb4d7e6db19e1ede123dd991d2829c31faa2e400e344ed94bca3fcd0545956ebcfe8ad0f6dfa5ff8effffffffa01aafaf000e52585855afa7676ade284113099052df57e7eb3bd37ebeb9222e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #1314: x-coordinate of the public key has many trailing 1&#39;s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91766456dce1857c906f9996af729339464d27e9d98edc2d0e3b760297067421f6402385ecadae0d8081dccaf5d19037ec4e55376eced699e93646bfbbf19d0b41fffffff948081e6a0458dd8f9e738f2665ff9059ad6aac0708318c4ca9a7a4f55a8abcba2dda8474311ee54149b973cae0c0fb89557ad0bf78e6529a1663bd73&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #1315: x-coordinate of the public key is large&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91c605c4b2edeab20419e6518a11b2dbc2b97ed8b07cced0b19c34f777de7b9fd9edf0f612c5f46e03c719647bc8af1b29b2cde2eda700fb1cff5e159d47326dbafffffff948081e6a0458dd8f9e738f2665ff9059ad6aac0708318c4ca9a7a4f55a8abcba2dda8474311ee54149b973cae0c0fb89557ad0bf78e6529a1663bd73&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #1316: x-coordinate of the public key is large&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91d48b68e6cabfe03cf6141c9ac54141f210e64485d9929ad7b732bfe3b7eb8a84feedae50c61bd00e19dc26f9b7e2265e4508c389109ad2f208f0772315b6c941fffffff948081e6a0458dd8f9e738f2665ff9059ad6aac0708318c4ca9a7a4f55a8abcba2dda8474311ee54149b973cae0c0fb89557ad0bf78e6529a1663bd73&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #1317: x-coordinate of the public key is large&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91b7c81457d4aeb6aa65957098569f0479710ad7f6595d5874c35a93d12a5dd4c7b7961a0b652878c2d568069a432ca18a1a9199f2ca574dad4b9e3a05c0a1cdb300000003fa15f963949d5f03a6f5c7f86f9e0015eeb23aebbff1173937ba748e1099872070e8e87c555fa13659cca5d7fadcfcb0023ea889548ca48af2ba7e71&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #1318: x-coordinate of the public key is small&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f916b01332ddb6edfa9a30a1321d5858e1ee3cf97e263e669f8de5e9652e76ff3f75939545fced457309a6a04ace2bd0f70139c8f7d86b02cb1cc58f9e69e96cd5a00000003fa15f963949d5f03a6f5c7f86f9e0015eeb23aebbff1173937ba748e1099872070e8e87c555fa13659cca5d7fadcfcb0023ea889548ca48af2ba7e71&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #1319: x-coordinate of the public key is small&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91efdb884720eaeadc349f9fc356b6c0344101cd2fd8436b7d0e6a4fb93f106361f24bee6ad5dc05f7613975473aadf3aacba9e77de7d69b6ce48cb60d8113385d00000003fa15f963949d5f03a6f5c7f86f9e0015eeb23aebbff1173937ba748e1099872070e8e87c555fa13659cca5d7fadcfcb0023ea889548ca48af2ba7e71&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #1320: x-coordinate of the public key is small&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f9131230428405560dcb88fb5a646836aea9b23a23dd973dcbe8014c87b8b20eb070f9344d6e812ce166646747694a41b0aaf97374e19f3c5fb8bd7ae3d9bd0beffbcbb2914c79f045eaa6ecbbc612816b3be5d2d6796707d8125e9f851c18af015000000001352bb4a0fa2ea4cceb9ab63dd684ade5a1127bcf300a698a7193bc2&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #1321: y-coordinate of the public key is small&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91caa797da65b320ab0d5c470cda0b36b294359c7db9841d679174db34c4855743cf543a62f23e212745391aaf7505f345123d2685ee3b941d3de6d9b36242e5a0bcbb2914c79f045eaa6ecbbc612816b3be5d2d6796707d8125e9f851c18af015000000001352bb4a0fa2ea4cceb9ab63dd684ade5a1127bcf300a698a7193bc2&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #1322: y-coordinate of the public key is small&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f917e5f0ab5d900d3d3d7867657e5d6d36519bc54084536e7d21c336ed8001859459450c07f201faec94b82dfb322e5ac676688294aad35aa72e727ff0b19b646aabcbb2914c79f045eaa6ecbbc612816b3be5d2d6796707d8125e9f851c18af015000000001352bb4a0fa2ea4cceb9ab63dd684ade5a1127bcf300a698a7193bc2&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #1323: y-coordinate of the public key is small&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91d7d70c581ae9e3f66dc6a480bf037ae23f8a1e4a2136fe4b03aa69f0ca25b35689c460f8a5a5c2bbba962c8a3ee833a413e85658e62a59e2af41d9127cc47224bcbb2914c79f045eaa6ecbbc612816b3be5d2d6796707d8125e9f851c18af015fffffffeecad44b6f05d15b33146549c2297b522a5eed8430cff596758e6c43d&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #1324: y-coordinate of the public key is large&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91341c1b9ff3c83dd5e0dfa0bf68bcdf4bb7aa20c625975e5eeee34bb396266b3472b69f061b750fd5121b22b11366fad549c634e77765a017902a67099e0a4469bcbb2914c79f045eaa6ecbbc612816b3be5d2d6796707d8125e9f851c18af015fffffffeecad44b6f05d15b33146549c2297b522a5eed8430cff596758e6c43d&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #1325: y-coordinate of the public key is large&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f9170bebe684cdcb5ca72a42f0d873879359bd1781a591809947628d313a3814f67aec03aca8f5587a4d535fa31027bbe9cc0e464b1c3577f4c2dcde6b2094798a9bcbb2914c79f045eaa6ecbbc612816b3be5d2d6796707d8125e9f851c18af015fffffffeecad44b6f05d15b33146549c2297b522a5eed8430cff596758e6c43d&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_test.json EcdsaVerify SHA-256 #1326: y-coordinate of the public key is large&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050232ba3a8be6b94d5ec80a6d9d1190a436effe50d85a1eee859b8cc6af9bd5c2e184cd60b855d442f5b3c7b11eb6c4e0ae7525fe710fab9aa7c77a67f79e6fadd762927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #1: signature malleability&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023d45c5740946b2a147f59262ee6f5bc90bd01ed280528b62b3aed5fc93f06f739b329f479a2bbd0a5c384ee1493b1f5186a87139cac5df4087c134b49156847db2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #3: Modified r or s, e.g. by adding or subtracting the order of the group&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023d45c5741946b2a137f59262ee6f5bc91001af27a5e1117a64733950642a3d1e8b329f479a2bbd0a5c384ee1493b1f5186a87139cac5df4087c134b49156847db2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #5: Modified r or s, e.g. by adding or subtracting the order of the group&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050232ba3a8be6b94d5ec80a6d9d1190a436effe50d85a1eee859b8cc6af9bd5c2e184cd60b865d442f5a3c7b11eb6c4e0ae79578ec6353a20bf783ecb4b6ea97b8252927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #8: Modified r or s, e.g. by adding or subtracting the order of the group&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #9: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000012927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #10: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050230000000000000000000000000000000000000000000000000000000000000000ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325512927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #11: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050230000000000000000000000000000000000000000000000000000000000000000ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325502927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #12: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050230000000000000000000000000000000000000000000000000000000000000000ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325522927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #13: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050230000000000000000000000000000000000000000000000000000000000000000ffffffff00000001000000000000000000000000ffffffffffffffffffffffff2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #14: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050230000000000000000000000000000000000000000000000000000000000000000ffffffff000000010000000000000000000000010000000000000000000000002927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #15: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000002927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #16: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000012927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #17: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050230000000000000000000000000000000000000000000000000000000000000001ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325512927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #18: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050230000000000000000000000000000000000000000000000000000000000000001ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325502927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #19: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050230000000000000000000000000000000000000000000000000000000000000001ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325522927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #20: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050230000000000000000000000000000000000000000000000000000000000000001ffffffff00000001000000000000000000000000ffffffffffffffffffffffff2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #21: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca6050230000000000000000000000000000000000000000000000000000000000000001ffffffff000000010000000000000000000000010000000000000000000000002927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #22: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc63255100000000000000000000000000000000000000000000000000000000000000002927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #23: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc63255100000000000000000000000000000000000000000000000000000000000000012927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #24: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325512927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #25: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325502927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #26: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325522927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #27: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551ffffffff00000001000000000000000000000000ffffffffffffffffffffffff2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #28: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551ffffffff000000010000000000000000000000010000000000000000000000002927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #29: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc63255000000000000000000000000000000000000000000000000000000000000000002927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #30: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc63255000000000000000000000000000000000000000000000000000000000000000012927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #31: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632550ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325512927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #32: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632550ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325502927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #33: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632550ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325522927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #34: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632550ffffffff00000001000000000000000000000000ffffffffffffffffffffffff2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #35: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632550ffffffff000000010000000000000000000000010000000000000000000000002927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #36: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc63255200000000000000000000000000000000000000000000000000000000000000002927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #37: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc63255200000000000000000000000000000000000000000000000000000000000000012927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #38: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632552ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325512927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #39: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632552ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325502927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #40: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632552ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325522927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #41: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632552ffffffff00000001000000000000000000000000ffffffffffffffffffffffff2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #42: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632552ffffffff000000010000000000000000000000010000000000000000000000002927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #43: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000001000000000000000000000000ffffffffffffffffffffffff00000000000000000000000000000000000000000000000000000000000000002927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #44: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000001000000000000000000000000ffffffffffffffffffffffff00000000000000000000000000000000000000000000000000000000000000012927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #45: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000001000000000000000000000000ffffffffffffffffffffffffffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325512927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #46: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000001000000000000000000000000ffffffffffffffffffffffffffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325502927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #47: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000001000000000000000000000000ffffffffffffffffffffffffffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325522927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #48: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000001000000000000000000000000ffffffffffffffffffffffffffffffff00000001000000000000000000000000ffffffffffffffffffffffff2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #49: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000001000000000000000000000000ffffffffffffffffffffffffffffffff000000010000000000000000000000010000000000000000000000002927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #50: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff0000000100000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000002927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #51: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff0000000100000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000012927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #52: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000001000000000000000000000001000000000000000000000000ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325512927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #53: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000001000000000000000000000001000000000000000000000000ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325502927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #54: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000001000000000000000000000001000000000000000000000000ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6325522927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #55: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000001000000000000000000000001000000000000000000000000ffffffff00000001000000000000000000000000ffffffffffffffffffffffff2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #56: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023ffffffff00000001000000000000000000000001000000000000000000000000ffffffff000000010000000000000000000000010000000000000000000000002927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #57: Signature with special case values for r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;70239dd877f7c944c422f44dea4ed1a52f2627416faf2f072fa50c772ed6f80764a1aab5000d0e804f3e2fc02bdee9be8ff312334e2ba16d11547c97711c898e6af015971cc30be6d1a206d4e013e0997772a2f91d73286ffd683b9bb2cf4f1b2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #58: Edge case for Shamir multiplication&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;00000000690ed426ccf17803ebe2bd0884bcd58a1bb5e7477ead3645f356e7a916aea964a2f6506d6f78c81c91fc7e8bded7d397738448de1e19a0ec580bf266252cd762130c6667cfe8b7bc47d27d78391e8e80c578d1cd38c3ff033be928e92927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #59: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;7300000000213f2a525c6035725235c2f696ad3ebb5ee47f140697ad25770d919cc98be2347d469bf476dfc26b9b733df2d26d6ef524af917c665baccb23c882093496459effe2d8d70727b82462f61d0ec1b7847929d10ea631dacb16b56c322927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #60: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;ddf2000000005e0be0635b245f0b97978afd25daadeb3edb4a0161c27fe0604573b3c90ecd390028058164524dde892703dce3dea0d53fa8093999f07ab8aa432f67b0b8e20636695bb7d8bf0a651c802ed25a395387b5f4188c0c4075c886342927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #61: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;67ab1900000000784769c4ecb9e164d6642b8499588b89855be1ec355d0841a0bfab3098252847b328fadf2f89b95c851a7f0eb390763378f37e90119d5ba3ddbdd64e234e832b1067c2d058ccb44d978195ccebb65c2aaf1e2da9b8b4987e3b2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #62: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;a2bf09460000000076d7dbeffe125eaf02095dff252ee905e296b6350fc311cf204a9784074b246d8bf8bf04a4ceb1c1f1c9aaab168b1596d17093c5cd21d2cd51cce41670636783dc06a759c8847868a406c2506fe17975582fe648d1d88b522927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #63: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;3554e827c700000000e1e75e624a06b3a0a353171160858129e15c544e4f0e65ed66dc34f551ac82f63d4aa4f81fe2cb0031a91d1314f835027bca0f1ceeaa0399ca123aa09b13cd194a422e18d5fda167623c3f6e5d4d6abb8953d67c0c48c72927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #64: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;9b6cd3b812610000000026941a0f0bb53255ea4c9fd0cb3426e3a54b9fc6965c060b700bef665c68899d44f2356a578d126b062023ccc3c056bf0f60a237012b8d186c027832965f4fcc78a3366ca95dedbb410cbef3f26d6be5d581c11d36102927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #65: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;883ae39f50bf0100000000e7561c26fc82a52baa51c71ca877162f93c4ae01869f6adfe8d5eb5b2c24d7aa7934b6cf29c93ea76cd313c9132bb0c8e38c96831db26a9c9e40e55ee0890c944cf271756c906a33e66b5bd15e051593883b5e99022927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #66: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;a1ce5d6e5ecaf28b0000000000fa7cd010540f420fb4ff7401fe9fce011d0ba6a1af03ca91677b673ad2f33615e56174a1abf6da168cebfa8868f4ba273f16b720aa73ffe48afa6435cd258b173d0c2377d69022e7d098d75caf24c8c5e06b1c2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #67: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;8ea5f645f373f580930000000038345397330012a8ee836c5494cdffd5ee8054fdc70602766f8eed11a6c99a71c973d5659355507b843da6e327a28c11893db93df5349688a085b137b1eacf456a9e9e0f6d15ec0078ca60a7f83f2b10d213502927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #68: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;660570d323e9f75fa734000000008792d65ce93eabb7d60d8d9c1bbdcb5ef305b516a314f2fce530d6537f6a6c49966c23456f63c643cf8e0dc738f7b876e675d39ffd033c92b6d717dd536fbc5efdf1967c4bd80954479ba66b0120cd16fff22927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #69: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;d0462673154cce587dde8800000000e98d35f1f45cf9c3bf46ada2de4c568c343b2cbf046eac45842ecb7984d475831582717bebb6492fd0a485c101e29ff0a84c9b7b47a98b0f82de512bc9313aaf51701099cac5f76e68c8595fc1c1d992582927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #70: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bd90640269a7822680cedfef000000000caef15a6171059ab83e7b4418d7278f30c87d35e636f540841f14af54e2f9edd79d0312cfa1ab656c3fb15bfde48dcf47c15a5a82d24b75c85a692bd6ecafeb71409ede23efd08e0db9abf6340677ed2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #71: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;33239a52d72f1311512e41222a00000000d2dcceb301c54b4beae8e284788a7338686ff0fda2cef6bc43b58cfe6647b9e2e8176d168dec3c68ff262113760f52067ec3b651f422669601662167fa8717e976e2db5e6a4cf7c2ddabb3fde9d67d2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #72: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;b8d64fbcd4a1c10f1365d4e6d95c000000007ee4a21a1cbe1dc84c2d941ffaf144a3e23bf314f2b344fc25c7f2de8b6af3e17d27f5ee844b225985ab6e2775cf2d48e223205e98041ddc87be532abed584f0411f5729500493c9cc3f4dd15e862927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #73: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;01603d3982bf77d7a3fef3183ed092000000003a227420db4088b20fe0e9d84a2ded5b7ec8e90e7bf11f967a3d95110c41b99db3b5aa8d330eb9d638781688e97d5792c53628155e1bfc46fb1a67e3088de049c328ae1f44ec69238a009808f92927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #74: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;9ea6994f1e0384c8599aa02e6cf66d9c000000004d89ef50b7e9eb0cfbff7363bdae7bcb580bf335efd3bc3d31870f923eaccafcd40ec2f605976f15137d8b8ff6dfa12f19e525270b0106eecfe257499f373a4fb318994f24838122ce7ec3c72927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #75: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;d03215a8401bcf16693979371a01068a4700000000e2fa5bf692bc670905b18c50f9c4f0cd6940e162720957ffff513799209b78596956d21ece251c2401f1c6d7033a0a787d338e889defaaabb106b95a4355e411a59c32aa5167dfab2447262927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #76: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;307bfaaffb650c889c84bf83f0300e5dc87e000000008408fd5f64b582e3bb14f612820687604fa01906066a378d67540982e29575d019aabe90924ead5c860d3f9367702dd7dd4f75ea98afd20e328a1a99f4857b316525328230ce294b0fef2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #77: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bab5c4f4df540d7b33324d36bb0c157551527c00000000e4af574bb4d54ea6b89505e407657d6e8bc93db5da7aa6f5081f61980c1949f56b0f2f507da5782a7ac60d31904e3669738ffbeccab6c3656c08e0ed5cb92b3cfa5e7f71784f9c50212927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #78: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;d4ba47f6ae28f274e4f58d8036f9c36ec2456f5b00000000c3b869197ef5e15ebbd16fbbb656b6d0d83e6a7787cd691b08735aed371732723e1c68a40404517d9d8e35dba96028b7787d91315be675877d2d097be5e8ee34560e3e7fd25c0f002927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #79: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;79fd19c7235ea212f29f1fa00984342afe0f10aafd00000000801e47f8c184e12ec9760122db98fd06ea76848d35a6da442d2ceef7559a30cf57c61e92df327e7ab271da90859479701fccf86e462ee3393fb6814c27b760c4963625c0a198782927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #80: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;8c291e8eeaa45adbaf9aba5c0583462d79cbeb7ac97300000000a37ea6700cda54e76b7683b6650baa6a7fc49b1c51eed9ba9dd463221f7a4f1005a89fe00c592ea076886c773eb937ec1cc8374b7915cfd11b1c1ae1166152f2f7806a31c8fd2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #81: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;0eaae8641084fa979803efbfb8140732f4cdcf66c3f78a000000003c278a6b215291deaf24659ffbbce6e3c26f6021097a74abdbb69be4fb10419c0c496c946665d6fcf336d27cc7cdb982bb4e4ecef5827f84742f29f10abf83469270a03dc32927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #82: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;e02716d01fb23a5a0068399bf01bab42ef17c6d96e13846c00000000afc0f89d207a3241812d75d947419dc58efb05e8003b33fc17eb50f9d15166a88479f107cdee749f2e492b213ce80b32d0574f62f1c5d70793cf55e382d5caadf75927672927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #83: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;9eb0bf583a1a6b9a194e9a16bc7dab2a9061768af89d00659a00000000fc7de16554e49f82a855204328ac94913bf01bbe84437a355a0a37c0dee3cf81aa7728aea00de2507ddaf5c94e1e126980d3df16250a2eaebc8be486effe7f22b4f9292927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #84: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;62aac98818b3b84a2c214f0d5e72ef286e1030cb53d9a82b690e00000000cd15a54c5062648339d2bff06f71c88216c26c6e19b4d80a8c602990ac82707efdfce99bbe7fcfafae3e69fd016777517aa01056317f467ad09aff09be73c9731b0d2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #85: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;3760a7f37cf96218f29ae43732e513efd2b6f552ea4b6895464b9300000000c8975bd7157a8d363b309f1f444012b1a1d23096593133e71b4ca8b059cff37eaf7faa7a28b1c822baa241793f2abc930bd4c69840fe090f2aacc46786bf9196222927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #86: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;0da0a1d2851d33023834f2098c0880096b4320bea836cd9cbb6ff6c8000000005694a6f84b8f875c276afd2ebcfe4d61de9ec90305afb1357b95b3e0da43885e0dffad9ffd0b757d8051dec02ebdf70d8ee2dc5c7870c0823b6ccc7c679cbaa42927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #87: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;ffffffff293886d3086fd567aafd598f0fe975f735887194a764a231e82d289aa0c30e8026fdb2b4b4968a27d16a6d08f7098f1a98d21620d7454ba9790f1ba65e470453a8a399f15baf463f9deceb53acc5ca64459149688bd2760c654243392927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #88: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;7bffffffff2376d1e3c03445a072e24326acdc4ce127ec2e0e8d9ca99527e7b7614ea84acf736527dd73602cd4bb4eea1dfebebd5ad8aca52aa0228cf7b99a88737cc85f5f2d2f60d1b8183f3ed490e4de14368e96a9482c2a4dd193195c902f2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #89: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;a2b5ffffffffebb251b085377605a224bc80872602a6e467fd016807e97fa395bead6734ebe44b810d3fb2ea00b1732945377338febfd439a8d74dfbd0f942fa6bb18eae36616a7d3cad35919fd21a8af4bbe7a10f73b3e036a46b103ef56e2a2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #90: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;641227ffffffff6f1b96fa5f097fcf3cc1a3c256870d45a67b83d0967d4b20c0499625479e161dacd4db9d9ce64854c98d922cbf212703e9654fae182df9bad242c177cf37b8193a0131108d97819edd9439936028864ac195b64fca76d9d6932927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #91: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;958415d8ffffffffabad03e2fc662dc3ba203521177502298df56f36600e0f8b08f16b8093a8fb4d66a2c8065b541b3d31e3bfe694f6b89c50fb1aaa6ff6c9b29d6455e2d5d1779748573b611cb95d4a21f967410399b39b535ba3e5af81ca2e2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #92: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;f1d8de4858ffffffff1281093536f47fe13deb04e1fbe8fb954521b6975420f8be26231b6191658a19dd72ddb99ed8f8c579b6938d19bce8eed8dc2b338cb5f8e1d9a32ee56cffed37f0f22b2dcb57d5c943c14f79694a03b9c5e96952575c892927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #93: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;0927895f2802ffffffff10782dd14a3b32dc5d47c05ef6f1876b95c81fc31def15e76880898316b16204ac920a02d58045f36a229d4aa4f812638c455abe0443e74d357d3fcb5c8c5337bd6aba4178b455ca10e226e13f9638196506a19391232927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #94: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;60907984aa7e8effffffff4f332862a10a57c3063fb5a30624cf6a0c3ac80589352ecb53f8df2c503a45f9846fc28d1d31e6307d3ddbffc1132315cc07f16dad1348dfa9c482c558e1d05c5242ca1c39436726ecd28258b1899792887dd0a3c62927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #95: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;c6ff198484939170ffffffff0af42cda50f9a5f50636ea6942d6b9b8cd6ae1e24a40801a7e606ba78a0da9882ab23c7677b8642349ed3d652c5bfa5f2a9558fb3a49b64848d682ef7f605f2832f7384bdc24ed2925825bf8ea77dc59817257822927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #96: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;de030419345ca15c75ffffffff8074799b9e0956cc43135d16dfbe4d27d7e68deacc5e1a8304a74d2be412b078924b3bb3511bac855c05c9e5e9e44df3d61e967451cd8e18d6ed1885dd827714847f96ec4bb0ed4c36ce9808db8f714204f6d12927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #97: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;6f0e3eeaf42b28132b88fffffffff6c8665604d34acb19037e1ab78caaaac6ff2f7a5e9e5771d424f30f67fdab61e8ce4f8cd1214882adb65f7de94c31577052ac4e69808345809b44acb0b2bd889175fb75dd050c5a449ab9528f8f78daa10c2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #98: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;cdb549f773b3e62b3708d1ffffffffbe48f7c0591ddcae7d2cb222d1f8017ab9ffcda40f792ce4d93e7e0f0e95e1a2147dddd7f6487621c30a03d710b330021979938b55f8a17f7ed7ba9ade8f2065a1fa77618f0b67add8d58c422c2453a49a2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #99: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2c3f26f96a3ac0051df4989bffffffff9fd64886c1dc4f9924d8fd6f0edb048481f2359c4faba6b53d3e8c8c3fcc16a948350f7ab3a588b28c17603a431e39a8cd6f6a5cc3b55ead0ff695d06c6860b509e46d99fccefb9f7f9e101857f743002927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #100: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;ac18f8418c55a2502cb7d53f9affffffff5c31d89fda6a6b8476397c04edf411dfc8bf520445cbb8ee1596fb073ea283ea130251a6fdffa5c3f5f2aaf75ca808048e33efce147c9dd92823640e338e68bfd7d0dc7a4905b3a7ac711e577e90e72927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #101: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;4f9618f98e2d3a15b24094f72bb5ffffffffa2fd3e2893683e5a6ab8cf0ee610ad019f74c6941d20efda70b46c53db166503a0e393e932f688227688ba6a576293320eb7ca0710255346bdbb3102cdcf7964ef2e0988e712bc05efe16c1993452927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #102: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;422e82a3d56ed10a9cc21d31d37a25ffffffff67edf7c40204caae73ab0bc75aac8096842e8add68c34e78ce11dd71e4b54316bd3ebf7fffdeb7bd5a3ebc1883f5ca2f4f23d674502d4caf85d187215d36e3ce9f0ce219709f21a3aac003b7a82927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #103: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;7075d245ccc3281b6e7b329ff738fbb417a5ffffffffa0842d9890b5cf95d018677b2d3a59b18a5ff939b70ea002250889ddcd7b7b9d776854b4943693fb92f76b4ba856ade7677bf30307b21f3ccda35d2f63aee81efd0bab6972cc0795db552927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #104: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;3c80de54cd9226989443d593fa4fd6597e280ebeffffffffc1847eb76c217a95479e1ded14bcaed0379ba8e1b73d3115d84d31d4b7c30e1f05e1fc0d5957cfb0918f79e35b3d89487cf634a4f05b2e0c30857ca879f97c771e877027355b24432927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #105: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;de21754e29b85601980bef3d697ea2770ce891a8cdffffffffc7906aa794b39b43dfccd0edb9e280d9a58f01164d55c3d711e14b12ac5cf3b64840ead512a0a31dbe33fa8ba84533cd5c4934365b3442ca1174899b78ef9a3199f495843897722927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #106: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;8f65d92927cfb86a84dd59623fb531bb599e4d5f7289ffffffff2f1f2f57881c5b09ab637bd4caf0f4c7c7e4bca592fea20e9087c259d26a38bb4085f0bbff1145b7eb467b6748af618e9d80d6fdcd6aa24964e5a13f885bca8101de08eb0d752927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #107: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;6b63e9a74e092120160bea3877dace8a2cc7cd0e8426cbfffffffffafc8c3ca85e9b1c5a028070df5728c5c8af9b74e0667afa570a6cfa0114a5039ed15ee06fb1360907e2d9785ead362bb8d7bd661b6c29eeffd3c5037744edaeb9ad990c202927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #108: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;fc28259702a03845b6d75219444e8b43d094586e249c8699ffffffffe852512e0671a0a85c2b72d54a2fb0990e34538b4890050f5a5712f6d1a7a5fb8578f32edb1846bab6b7361479ab9c3285ca41291808f27fd5bd4fdac720e5854713694c2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #109: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;1273b4502ea4e3bccee044ee8e8db7f774ecbcd52e8ceb571757ffffffffe20a7673f8526748446477dbbb0590a45492c5d7d69859d301abbaedb35b2095103a3dc70ddf9c6b524d886bed9e6af02e0e4dec0d417a414fed3807ef4422913d7c2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #110: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;08fb565610a79baa0c566c66228d81814f8c53a15b96e602fb49ffffffffff6e7f085441070ecd2bb21285089ebb1aa6450d1a06c36d3ff39dfd657a796d12b5249712012029870a2459d18d47da9aa492a5e6cb4b2d8dafa9e4c5c54a2b9a8b2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #111: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;d59291cc2cf89f3087715fcb1aa4e79aa2403f748e97d7cd28ecaefeffffffff914c67fb61dd1e27c867398ea7322d5ab76df04bc5aa6683a8e0f30a5d287348fa07474031481dda4953e3ac1959ee8cea7e66ec412b38d6c96d28f6d37304ea2927b10512bae3eddcfe467828128bad2903269919f7086069c8c4df6c732838c7787964eaac00e5921fb1498a60f4606766b3d9685001558d1a974e7341513e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #112: special case hash&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e25000000000000000000000000000000004319055358e8617b0c46353d039cdaabffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc63254ed705d16f80987e2d9b1a6957d29ce22febf7d10fa515153182415c8361baaca4b1fc105ee5ce80d514ec1238beae2037a6f83625593620d460819e8682160926&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #113: k*G has a large x-coordinate&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e25ffffffff00000001000000000000000000000000fffffffffffffffffffffffcffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc63254ed705d16f80987e2d9b1a6957d29ce22febf7d10fa515153182415c8361baaca4b1fc105ee5ce80d514ec1238beae2037a6f83625593620d460819e8682160926&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #114: r too large&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e25ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc63254fffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc63254e3cd8d2f81d6953b0844c09d7b560d527cd2ef67056893eadafa52c8501387d59ee41fdb4d10402ce7a0c5e3b747adfa3a490b62a6b7719068903485c0bb6dc2d&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #115: r,s are large&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd909135bdb6799286170f5ead2de4f6511453fe50914f3df2de54a36383df8dd48240cd81edd91cb6936133508c3915100e81f332c4545d41189b481196851378e05b06e72d4a1bff80ea5db514aa2f93ea6dd6d9c0ae27b7837dc432f9ce89d9&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #116: r and s^-1 have a large Hamming weight&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd27b4577ca009376f71303fd5dd227dcef5deb773ad5f5a84360644669ca249a5b062947356748b0fc17f1704c65aa1dca6e1bfe6779756fa616d91eaad13df2c0b38c17f3d0672e7409cfc5992a99fff12b84a4f8432293b431113f1b2fb579d&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #117: r and s^-1 have a large Hamming weight&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e25000000000000000000000000000000000000000000000000000000000000000500000000000000000000000000000000000000000000000000000000000000014a03ef9f92eb268cafa601072489a56380fa0dc43171d7712813b3a19a1eb5e53e213e28a608ce9a2f4a17fd830c6654018a79b3e0263d91a8ba90622df6f2f0&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #118: small r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e2500000000000000000000000000000000000000000000000000000000000000050000000000000000000000000000000000000000000000000000000000000003091194c1cba17f34e286b4833701606a41cef26177ada8850b601ea1f859e70127242fcec708828758403ce2fe501983a7984e6209f4d6b95db9ad77767f55eb&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #120: small r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e2500000000000000000000000000000000000000000000000000000000000000050000000000000000000000000000000000000000000000000000000000000005103c6ecceff59e71ea8f56fee3a4b2b148e81c2bdbdd39c195812c96dcfb41a72303a193dc591be150b883d770ec51ebb4ebce8b09042c2ecb16c448d8e57bf5&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #122: small r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e25000000000000000000000000000000000000000000000000000000000000000500000000000000000000000000000000000000000000000000000000000000063b66b829fe604638bcb2bfe8c22228be67390c20111bd2b451468927e87fb6eabc8e59c009361758b274ba2cad36b58fde485a3ed09dade76712fa9e9c4ac212&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #124: small r and s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e25ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc63255600000000000000000000000000000000000000000000000000000000000000063b66b829fe604638bcb2bfe8c22228be67390c20111bd2b451468927e87fb6eabc8e59c009361758b274ba2cad36b58fde485a3ed09dade76712fa9e9c4ac212&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #126: r is larger than n&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e250000000000000000000000000000000000000000000000000000000000000005ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc75fbd84ff2f6c24e4a33cd71c09fdcbc74a6233961b874b8c8e0eb94582092cbc50c3084fa9547afda5c66335f3f937d4c79afa120486b534139d59ae82d61ead26420&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #127: s is larger than n&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e2500000000000000000000000000000000000000000000000000000000000001008f1e3c7862c58b16bb76eddbb76eddbb516af4f63f2d74d76e0d28c9bb75ea8884b959080bb30859cd53c2fb973cf14d60cdaa8ee00587889b5bc657ac588175a02ce5c1e53cb196113c78b4cb8dc7d360e5ea7850b0f6650b0c45af2c3cd7ca&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #128: small r and s^-1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e25000000000000000000000000000000000000000000000000002d9b4d347952d6ef3043e7329581dbb3974497710ab11505ee1c87ff907beebadd195a0ffe6d7adf4083bd6ecbda5a77ae578e5d835fa7f74a07ebb91e0570e1ff32a563354e9925af80b09a167d9ef647df28e2d9acd0d4bc4f2deec5723818edaf9071e311f8&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #129: smallish r and s^-1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e25000000000000000000000000000000000000001033e67e37b32b445580bf4eff8b748b74000000008b748b748b748b7466e769ad4a16d3dcd87129b8e91d1b4dc2569a3c9bf8c1838ca821f7ba6f000cc8679d278f3736b414a34a7c956a03770387ea85bc4f28804b4a91c9b7d65bc6434c975806795ab7d441a4e9683aeb09&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #130: 100-bit r and small s^-1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e250000000000000000000000000000000000000000000000000000000000000100ef9f6ba4d97c09d03178fa20b4aaad83be3cf9cb824a879fec3270fc4b81ef5b4a9f7da2a6c359a16540c271774a6bf1c586357c978256f44a6496d80670968ac496e73a44563f8d56fbd7bb9e4e3ae304c86f2c508eb777b03924755beb40d4&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #131: small r and 100 bit s^-1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e2500000000000000000000000000000000000000062522bbd3ecbe7c39e93e7c25ef9f6ba4d97c09d03178fa20b4aaad83be3cf9cb824a879fec3270fc4b81ef5b874146432b3cd2c9e26204c0a34136996067d466dde4917a8ff23a8e95ca106b709b3d50976ef8b385a813bc35f3a20710bdc6edd465e6f43ac4866703a6608c&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #132: 100-bit r and s^-1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e25ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6324d5555555550000000055555555555555553ef7a8e48d07df81a693439654210c707a736d8e326a9ca62bbe25a34ea4e3633b499a96afa7aaa3fcf3fd88f8e07edeb3e45879d8622b93e818443a686e869eeda7bf9ae46aa3eafcc48a5934864627&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #133: r and s^-1 are close to n&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e25555555550000000055555555555555553ef7a8e48d07df81a693439654210c700000000000000000000000000000000000000000000000000000000000000001e84d9b232e971a43382630f99725e423ec1ecb41e55172e9c69748a03f0d5988618b15b427ad83363bd041ff75fac98ef2ee923714e7d1dfe31753793c7588d4&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #134: s == 1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e25555555550000000055555555555555553ef7a8e48d07df81a693439654210c700000000000000000000000000000000000000000000000000000000000000000e84d9b232e971a43382630f99725e423ec1ecb41e55172e9c69748a03f0d5988618b15b427ad83363bd041ff75fac98ef2ee923714e7d1dfe31753793c7588d4&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #135: s == 0&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257fffffff800000007fffffffffffffffde737d56d38bcf4279dce5617e3192a8555555550000000055555555555555553ef7a8e48d07df81a693439654210c700203736fcb198b15d8d7a0c80f66dddd15259240aa78d08aae67c467de04503434383438d5041ea9a387ee8e4d4e84b4471b160c6bcf2568b072f8f20e87a996&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #136: point at infinity during verify&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257fffffff800000007fffffffffffffffde737d56d38bcf4279dce5617e3192a97fffffff800000007fffffffffffffffde737d56d38bcf4279dce5617e3192a878d844dc7f16b73b1f2a39730da5d8cd99fe2e70a18482384e37dcd2bfea02e1ed6572e01eb7a8d113d02c666c45ef22d3b9a6a6dea99aa43a8183c26e75d336&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #137: edge case for signature malleability&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257fffffff800000007fffffffffffffffde737d56d38bcf4279dce5617e3192a97fffffff800000007fffffffffffffffde737d56d38bcf4279dce5617e3192a9dec6c8257dde94110eacc8c09d2e5789cc5beb81a958b02b4d62da9599a7401466fae1614174be63970b83f6524421067b06dd6f4e9c56baca4e344fdd690f1d&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #138: edge case for signature malleability&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e25555555550000000055555555555555553ef7a8e48d07df81a693439654210c70532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e25a17f5b75a35ed64623ca5cbf1f91951292db0c23f0c2ea24c3d0cad0988cabc083a7a618625c228940730b4fa3ee64faecbb2fc20fdde7c58b3a3f6300424dc6&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #139: u1 == 1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e25555555550000000055555555555555553ef7a8e48d07df81a693439654210c70acd155416a8b77f34089464733ff7cd39c400e9c69af7beb9eac5054ed2ec72c04ba0cba291a37db13f33bf90dab628c04ec8393a0200419e9eaa1ebcc9fb5c31f3a0a0e6823a49b625ad57b12a32d4047970fc3428f0f0049ecf4265dc12f62&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #140: u1 == n - 1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e25555555550000000055555555555555553ef7a8e48d07df81a693439654210c70555555550000000055555555555555553ef7a8e48d07df81a693439654210c70692b6c828e0feed63d8aeaa2b7322f9ccbe8723a1ed39f229f204a434b8900efa1f6f6abcb38ea3b8fde38b98c7c271f274af56a8c5628dc3329069ae4dd5716&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #141: u2 == 1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e25555555550000000055555555555555553ef7a8e48d07df81a693439654210c70aaaaaaaa00000000aaaaaaaaaaaaaaaa7def51c91a0fbf034d26872ca84218e100cefd9162d13e64cb93687a9cd8f9755ebb5a3ef7632f800f84871874ccef09543ecbeaf7e8044ef721be2fb5f549e4b8480d2587404ebf7dbbef2c54bc0cb1&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #142: u2 == n - 1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd710f8e3edc7c2d5a3fd23de844002bb949d9f794f6d5405f6d97c1bb03dd2bd2b975183b42551cf52f291d5c1921fd5e12f50c8c85a4beb9de03efa3f0f244862243018e6866df922dc313612020311ff21e242ce3fb15bc78c406b25ab43091&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #143: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffdedffbc270f722c243069a7e5f40335a61a58525c7b4db2e7a8e269274ffe4e1bc25f1d166f3e211cdf042a26f8abf6094d48b8d17191d74ed71714927446699965d06dd6a88abfa49e8b4c5da6bb922851969adf9604b5accfb52a114e77ccdb&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #144: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffda25adcae105ed7ff4f95d2344e24ee523314c3e178525d007904b68919ba4d538fe5e88243a76e41a004236218a3c3a2d6eee398a23c3a0b008d7f0164cbc0ca98a20d1bdcf573513c7cfd9b83c63e3a82d40127c897697c86b8cb387af7f240&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #145: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd2e4348c645707dce6760d773de3f3e87346924b2f64bd3dd0297e766b5805ebb02148256b530fbc470c7b341970b38243ecee6d5a840a37beca2efb37e8dff2cc0adbea0882482a7489ca703a399864ba987eeb6ddb738af53a83573473cb30d&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #146: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd348c673b07dce3920d773de3f3e87408869e916dbcf797d8f9684fb67753d1dca34db012ce6eda1e9c7375c5fcf3e54ed698e19615124273b3a621d021c76f8e777458d6f55a364c221e39e1205d5510bb4fbb7ddf08d8d8fdde13d1d6df7f14&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #147: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd6918ce760fb9c7241aee7bc7e7d0e8110d3d22db79ef2fb1f2d09f6ceea7a3b8b97af3fe78be15f2912b6271dd8a43badb6dd2a1b315b2ce7ae37b4e7778041d930d71ee1992d2466495c42102d08e81154c305307d1dcd52d0fa4c479b278e7&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #148: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd73b3c694391d8eadde3f3e874089464715ac20e4c126bbf6d864d648969f5b5a81e7198a3c3f23901cedc7a1d6eff6e9bf81108e6c35cd8559139af3135dbcbb9ef1568530291a8061b90c9f4285eefcba990d4570a4e3b7b737525b5d580034&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #149: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffdbb07ac7a86948c2c2989a16db1930ef1b89ce112595197656877e53c41457f28ab4d792ca121d1dba39cb9de645149c2ab573e8becc6ddff3cc9960f188ddf737f90ba23664153e93262ff73355415195858d7be1315a69456386de68285a3c8&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #150: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd27e4d82cb6c061dd9337c69bf9332ed3d198662d6f2299443f62c861187db648518412b69af43aae084476a68d59bbde51fbfa9e5be80563f587c9c2652f88ef2d3b90d25baa6bdb7b0c55e5240a3a98fbc24afed8523edec1c70503fc10f233&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #151: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffde7c5cf3aac2e88923b77850515fff6a12d13b356dfe9ec275c3dd81ae94609a4a08f14a644b9a935dffea4761ebaf592d1f66fe6cd373aa7f5d370af34f8352da54b5bc4025cf335900a914c2934ec2fec7a396d0a7affcad732a5741c7aaaf5&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #152: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffdc77838df91c1e953e016e10bddffea2317f9fee32bacfe553cede9e57a748f68ccf2296a6a89b62b90739d38af4ae3a20e9f45715b90044639241061e33f8f8caace0046491eeaa1c6e9a472b96d88f4af83e7ff1bb84438c7e058034412ae08&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #153: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd8ef071c02383d2a6c02dc217bbffd446730d0318b0425e2586220907f885f97f94b0fc1525bcabf82b1f34895e5819a06c02b23e04002276e165f962c86e3927be7c2ab4d0b25303204fb32a1f8292902792225e16a6d2dbfb29fbc89a9c3376&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #154: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd5668aaa0b545bbf9a044a32399ffbe69ce20074e34d7bdf5cf56282a769763965351f37e1de0c88c508527d89882d183ccdcf2efca407edb0627cadfd16de6ec44b4b57cdf960d32ebcc4c97847eed218425853b5b675eb781b766a1a1300349&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #155: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffdd12d6e56882f6c0027cae91a27127728f7fddf478fb4fdc2b65f40a60b0eb952748bbafc320e6735cb64019710a269c6c2b5d147bdc831325cb2fb276ac971a69d655e9a755bc9d800ad21ee3fd4d980d93a7a49a8c5ccd37005177578f51163&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #156: edge case for u1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd7fffffffaaaaaaaaffffffffffffffffe9a2538f37b28a2c513dee40fecbb71a14b3bbd75c5e1c0c36535a934d4ab85112410b3b90fa97a31c33038964fd85cc112f7d837f8f9c36b460d636c965a5f818f2b50c5d00fb3f9705561dd6631883&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #157: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffdb62f26b5f2a2b26f6de86d42ad8a13da3ab3cccd0459b201de009e526adf21f2d823533c04cd8edc6d6f950a8e08ade04a9bafa2f14a590356935671ae9305bf43178d1f88b6a57a96924c265f0ddb75b58312907b195acb59d7797303123775&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #158: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffdbb1d9ac949dd748cd02bbbe749bd351cd57b38bb61403d700686aa7b4c90851edb2b3408b3167d91030624c6328e8ce3ec108c105575c2f3d209b92e654bab69c34318139c50b0802c6e612f0fd3189d800df7c996d5d7b7c3d6be82836fa258&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #159: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd66755a00638cdaec1c732513ca0234ece52545dac11f816e818f725b4f60aaf209179ce7c59225392216453b2ac1e9d178c24837dfae26bc1dd7ab60638527425556b42e330289f3b826b2db7a86d19d45c2860a59f2be1ddcc3b691f95a9255&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #160: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd55a00c9fcdaebb6032513ca0234ecfffe98ebe492fdf02e48ca48e982beb366901959fb8deda56e5467b7e4b214ea4c2d0c2fb29d70ff19b6b1eccebd6568d7ed9dbd77a918297fd970bff01e1343f6925167db5a14d098a211c39cc3a413398&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #161: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffdab40193f9b5d76c064a27940469d9fffd31d7c925fbe05c919491d3057d66cd2567f1fdc387e5350c852b4e8f8ba9d6d947e1c5dd7ccc61a5938245dd6bcab3a9960bebaf919514f9535c22eaaf0b5812857970e26662267b1f3eb1011130a11&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #162: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffdca0234ebb5fdcb13ca0234ecffffffffcb0dadbbc7f549f8a26b4408d0dc86003499f974ff4ca6bbb2f51682fd5f51762f9dd6dd2855262660b36d46d3e4bec2f498fae2487807e220119152f0122476c64d4fa46ddce85c4546630f0d5c5e81&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #163: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffdbfffffff3ea3677e082b9310572620ae19933a9e65b285598711c77298815ad32c5c01662cf00c1929596257db13b26ecf30d0f3ec4b9f0351b0f27094473426e986a086060d086eee822ddd2fc744247a0154b57f7a69c51d9fdafa484e4ac7&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #164: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd266666663bbbbbbbe6666666666666665b37902e023fab7c8f055d86e5cc41f491d4cba813a04d86dbae94c23be6f52c15774183be7ba5b2d9f3cf010b160501900b8adfea6491019a9ac080d516025a541bf4b952b0ad7be4b1874b02fd544a&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #165: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffdbfffffff36db6db7a492492492492492146c573f4c6dfc8d08a443e258970b09ef7fd0a3a36386638330ecad41e1a3b302af36960831d0210c614b948e8aa124ef0d6d800e4047d6d3c1be0fdeaf11fcd8cab5ab59c730eb34116e35a8c7d098&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #166: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffdbfffffff2aaaaaab7fffffffffffffffc815d0e60b3e596ecb1ad3a27cfd49c4a521dab13cc9152d8ca77035a607fea06c55cc3ca5dbeb868cea92eafe93df2a7bfb9b28531996635e6a5ccaa2826a406ce1111bdb9c2e0ca36500418a2f43de&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #167: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd7fffffff55555555ffffffffffffffffd344a71e6f651458a27bdc81fd976e37474d58a4eec16e0d565f2187fe11d4e8e7a2683a12f38b4fc01d1237a81a10976e55f73bb7cdda46bdb67ef77f6fd2969df2b67920fb5945fde3a517a6ded4cd&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #168: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd3fffffff800000007fffffffffffffffde737d56d38bcf4279dce5617e3192aa692da5cd4309d9a6e5cb525c37da8fa0879f7b57208cdabbf47d223a5b23a62140e0daa78cfdd207a7389aaed61738b17fc5fc3e6a5ed3397d2902e9125e6ab4&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #169: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd5d8ecd64a4eeba466815ddf3a4de9a8e6abd9c5db0a01eb80343553da648428f85689b3e0775c7718a90279f14a8082cfcd4d1f1679274f4e9b8805c570a0670167fcc5ca734552e09afa3640f4a034e15b9b7ca661ec7ff70d3f240ebe705b1&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #170: edge case for u2&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e256f2347cab7dd76858fe0555ac3bc99048c4aacafdfb6bcbe05ea6c42c4934569f21d907e3890916dc4fa1f4703c1e50d3f54ddf7383e44023a41de562aa18ed80158137755b901f797a90d4ca8887e023cb2ef63b2ba2c0d455edaef42cf237e2a964fc00d377a8592b8b61aafa7a4aaa7c7b9fd2b41d6e0e17bd1ba5677edcd&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #171: point duplication during verification&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e256f2347cab7dd76858fe0555ac3bc99048c4aacafdfb6bcbe05ea6c42c4934569f21d907e3890916dc4fa1f4703c1e50d3f54ddf7383e44023a41de562aa18ed80158137755b901f797a90d4ca8887e023cb2ef63b2ba2c0d455edaef42cf237ed569b03ef2c8857b6d4749e550585b5558384603d4be291f1e842e45a9881232&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #172: duplication bug&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e250000000000000000000000000000000000000000000000000000000000000001555555550000000055555555555555553ef7a8e48d07df81a693439654210c7038a084ffccc4ae2f8204be2abca9fb8ad4ab283b2aa50f13b6bb2347adabc69ca699799b77b1cc6dad271e88b899c12931986e958e1f5cf5653dddf7389365e2&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #173: point with x-coordinate 0&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e25555555550000000055555555555555553ef7a8e48d07df81a693439654210c703333333300000000333333333333333325c7cbbc549e52e763f1f55a327a3aa9664ce273320d918d8bdb2e61201b4549b36b7cdc54e33b84adb6f2c10aac831e49e68831f18bda2973ac3d76bfbc8c5ee1cceed2dd862e2dc7c915c736cef1f4&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #175: comparison with point at infinity &quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257cf27b188d034f7e8a52380304b51ac3c08969e277f21b35a60b48fc47669978555555550000000055555555555555553ef7a8e48d07df81a693439654210c70961691a5e960d07a301dbbad4d86247ec27d7089faeb3ddd1add395efff1e0fe7254622cc371866cdf990d2c5377790e37d1f1519817f09a231bd260a9e78aeb&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #176: extreme value for k and edgecase s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257cf27b188d034f7e8a52380304b51ac3c08969e277f21b35a60b48fc47669978b6db6db6249249254924924924924924625bd7a09bec4ca81bcdd9f8fd6b63cc5d283e13ce8ca60da868e3b0fb33e6b4f1074793274e2928250e71e2aca63e9c214dc74fa25371fb4d9e506d418ed9a1bfd6d0c8bb6591d3e0f44505a84886ce&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #177: extreme value for k and s^-1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257cf27b188d034f7e8a52380304b51ac3c08969e277f21b35a60b48fc47669978cccccccc00000000cccccccccccccccc971f2ef152794b9d8fc7d568c9e8eaa70fc351da038ae0803bd1d86514ae0462f9f8216551d9315aa9d297f792eef6a341c74eed786f2d33da35360ca7aa925e753f00d6077a1e9e5fc339d634019c73&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #178: extreme value for k and s^-1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257cf27b188d034f7e8a52380304b51ac3c08969e277f21b35a60b48fc476699783333333300000000333333333333333325c7cbbc549e52e763f1f55a327a3aaaa1e34c8f16d138673fee55c080547c2bfd4de7550065f638322bba9430ce4b60662be9bb512663aa4d7df8ab3f3b4181c5d44a7bdf42436620b7d8a6b81ac936&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #179: extreme value for k and s^-1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257cf27b188d034f7e8a52380304b51ac3c08969e277f21b35a60b48fc4766997849249248db6db6dbb6db6db6db6db6db5a8b230d0b2b51dcd7ebf0c9fef7c1857e1a8a8338d7fd8cf41d322a302d2078a87a23c7186150ed7cda6e52817c1bdfd0a9135a89d21ce821e29014b2898349254d748272b2d4eb8d59ee34c615377f&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #180: extreme value for k and s^-1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e257cf27b188d034f7e8a52380304b51ac3c08969e277f21b35a60b48fc4766997816a4502e2781e11ac82cbc9d1edd8c981584d13e18411e2f6e0478c34416e3bb5c19fe227a61abc65c61ee7a018cc9571b2c6f663ea33583f76a686f64be078b7b4a0d734940f613d52bc48673b457c2cf78492490a5cc5606c0541d17b24ddb&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #181: extreme value for k&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e256b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296555555550000000055555555555555553ef7a8e48d07df81a693439654210c70db02d1f3421d600e9d9ef9e47419dba3208eed08c2d4189a5db63abeb2739666e0ed26967b9ada9ed7ffe480827f90a0d210d5fd8ec628e31715e6b24125512a&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #182: extreme value for k and edgecase s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e256b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296b6db6db6249249254924924924924924625bd7a09bec4ca81bcdd9f8fd6b63cc6222d1962655501893c29e441395b6c05711bd3ed5a0ef72cfab338b88229c4baaae079cb44a1af070362aaa520ee24cac2626423b0bf81af1c54311d8e2fd23&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #183: extreme value for k and s^-1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e256b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296cccccccc00000000cccccccccccccccc971f2ef152794b9d8fc7d568c9e8eaa74ccfa24c67f3def7fa81bc99c70bb0419c0952ba599f4c03361da184b04cdca5db76b797f7f41d9c729a2219478a7e629728df870800be8cf6ca7a0a82153bfa&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #184: extreme value for k and s^-1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e256b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c2963333333300000000333333333333333325c7cbbc549e52e763f1f55a327a3aaaea1c72c91034036bac71402b6e9ecc4af3dbde7a99dc574061e99fefff9d84dab7dd057e75b78ac6f56e34eb048f0a9d29d5d055408c90d02bc2ea918c18cb63&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #185: extreme value for k and s^-1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e256b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c29649249248db6db6dbb6db6db6db6db6db5a8b230d0b2b51dcd7ebf0c9fef7c185c2879a66d86cb20b820b7795da2da62b38924f7817d1cd350d936988e90e79bc5431a7268ff6931c7a759de024eff90bcb0177216db6fd1f3aaaa11fa3b6a083&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #186: extreme value for k and s^-1&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e256b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c29616a4502e2781e11ac82cbc9d1edd8c981584d13e18411e2f6e0478c34416e3bbab1c0f273f74abc2b848c75006f2ef3c54c26df27711b06558f455079aee0ba3df510f2ecef6d9a05997c776f14ad6456c179f0a13af1771e4d6c37fa48b47f2&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #187: extreme value for k&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e25532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e25249249246db6db6ddb6db6db6db6db6dad4591868595a8ee6bf5f864ff7be0c26b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c2964fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #188: testing point duplication&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e25acd155416a8b77f34089464733ff7cd39c400e9c69af7beb9eac5054ed2ec72c249249246db6db6ddb6db6db6db6db6dad4591868595a8ee6bf5f864ff7be0c26b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c2964fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #189: testing point duplication&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e25532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e25249249246db6db6ddb6db6db6db6db6dad4591868595a8ee6bf5f864ff7be0c26b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296b01cbd1c01e58065711814b583f061e9d431cca994cea1313449bf97c840ae0a&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #190: testing point duplication&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e25acd155416a8b77f34089464733ff7cd39c400e9c69af7beb9eac5054ed2ec72c249249246db6db6ddb6db6db6db6db6dad4591868595a8ee6bf5f864ff7be0c26b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296b01cbd1c01e58065711814b583f061e9d431cca994cea1313449bf97c840ae0a&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #191: testing point duplication&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;bb5a52f42f9c9261ed4361f59422a1e30036e7c32b270c8807a419feca605023a8ea150cb80125d7381c4c1f1da8e9de2711f9917060406a73d7904519e51388f3ab9fa68bd47973a73b2d40480c2ba50c22c9d76ec217257288293285449b8604aaec73635726f213fb8a9e64da3b8632e41495a944d0045b522eba7240fad587d9315798aaa3a5ba01775787ced05eaaf7b4e09fc81d6d1aa546e8365d525d&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #269: pseudorandom signature&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;532eaabd9574880dbf76b9b8cc00832c20a6ec113d682299550d7a6e0f345e2530e782f964b2e2ff065a051bc7adc20615d8c43a1365713c88268822c253bcce5b16df652aa1ecb2dc8b46c515f9604e2e84cacfa7c6eec30428d2d3f4e08ed504aaec73635726f213fb8a9e64da3b8632e41495a944d0045b522eba7240fad587d9315798aaa3a5ba01775787ced05eaaf7b4e09fc81d6d1aa546e8365d525d&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #270: pseudorandom signature&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855b292a619339f6e567a305c951c0dcbcc42d16e47f219f9e98e76e09d8770b34a0177e60492c5a8242f76f07bfe3661bde59ec2a17ce5bd2dab2abebdf89a62e204aaec73635726f213fb8a9e64da3b8632e41495a944d0045b522eba7240fad587d9315798aaa3a5ba01775787ced05eaaf7b4e09fc81d6d1aa546e8365d525d&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #271: pseudorandom signature&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;de47c9b27eb8d300dbb5f2c353e632c393262cf06340c4fa7f1b40c4cbd36f90986e65933ef2ed4ee5aada139f52b70539aaf63f00a91f29c69178490d57fb713dafedfb8da6189d372308cbf1489bbbdabf0c0217d1c0ff0f701aaa7a694b9c04aaec73635726f213fb8a9e64da3b8632e41495a944d0045b522eba7240fad587d9315798aaa3a5ba01775787ced05eaaf7b4e09fc81d6d1aa546e8365d525d&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #272: pseudorandom signature&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91d434e262a49eab7781e353a3565e482550dd0fd5defa013c7f29745eff3569f19b0c0a93f267fb6052fd8077be769c2b98953195d7bc10de844218305c6ba17a4f337ccfd67726a805e4f1600ae2849df3807eca117380239fbd816900000000ed9dea124cc8c396416411e988c30f427eb504af43a3146cd5df7ea60666d685&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #288: x-coordinate of the public key has many trailing 0&#39;s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f910fe774355c04d060f76d79fd7a772e421463489221bf0a33add0be9b1979110b500dcba1c69a8fbd43fa4f57f743ce124ca8b91a1f325f3fac6181175df557374f337ccfd67726a805e4f1600ae2849df3807eca117380239fbd816900000000ed9dea124cc8c396416411e988c30f427eb504af43a3146cd5df7ea60666d685&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #289: x-coordinate of the public key has many trailing 0&#39;s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91bb40bf217bed3fb3950c7d39f03d36dc8e3b2cd79693f125bfd06595ee1135e3541bf3532351ebb032710bdb6a1bf1bfc89a1e291ac692b3fa4780745bb556774f337ccfd67726a805e4f1600ae2849df3807eca117380239fbd816900000000ed9dea124cc8c396416411e988c30f427eb504af43a3146cd5df7ea60666d685&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #290: x-coordinate of the public key has many trailing 0&#39;s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91664eb7ee6db84a34df3c86ea31389a5405badd5ca99231ff556d3e75a233e73a59f3c752e52eca46137642490a51560ce0badc678754b8f72e51a2901426a1bd3cf03d614d8939cfd499a07873fac281618f06b8ff87e8015c3f49726500493584fa174d791c72bf2ce3880a8960dd2a7c7a1338a82f85a9e59cdbde80000000&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #291: y-coordinate of the public key has many trailing 0&#39;s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f914cd0429bbabd2827009d6fcd843d4ce39c3e42e2d1631fd001985a79d1fd8b439638bf12dd682f60be7ef1d0e0d98f08b7bca77a1a2b869ae466189d2acdabe33cf03d614d8939cfd499a07873fac281618f06b8ff87e8015c3f49726500493584fa174d791c72bf2ce3880a8960dd2a7c7a1338a82f85a9e59cdbde80000000&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #292: y-coordinate of the public key has many trailing 0&#39;s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91e56c6ea2d1b017091c44d8b6cb62b9f460e3ce9aed5e5fd41e8added97c56c04a308ec31f281e955be20b457e463440b4fcf2b80258078207fc1378180f89b553cf03d614d8939cfd499a07873fac281618f06b8ff87e8015c3f49726500493584fa174d791c72bf2ce3880a8960dd2a7c7a1338a82f85a9e59cdbde80000000&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #293: y-coordinate of the public key has many trailing 0&#39;s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f911158a08d291500b4cabed3346d891eee57c176356a2624fb011f8fbbf3466830228a8c486a736006e082325b85290c5bc91f378b75d487dda46798c18f2855193cf03d614d8939cfd499a07873fac281618f06b8ff87e8015c3f4972650049357b05e8b186e38d41d31c77f5769f22d58385ecc857d07a561a6324217fffffff&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #294: y-coordinate of the public key has many trailing 1&#39;s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91b1db9289649f59410ea36b0c0fc8d6aa2687b29176939dd23e0dde56d309fa9d3e1535e4280559015b0dbd987366dcf43a6d1af5c23c7d584e1c3f48a12513363cf03d614d8939cfd499a07873fac281618f06b8ff87e8015c3f4972650049357b05e8b186e38d41d31c77f5769f22d58385ecc857d07a561a6324217fffffff&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #295: y-coordinate of the public key has many trailing 1&#39;s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91b7b16e762286cb96446aa8d4e6e7578b0a341a79f2dd1a220ac6f0ca4e24ed86ddc60a700a139b04661c547d07bbb0721780146df799ccf55e55234ecb8f12bc3cf03d614d8939cfd499a07873fac281618f06b8ff87e8015c3f4972650049357b05e8b186e38d41d31c77f5769f22d58385ecc857d07a561a6324217fffffff&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #296: y-coordinate of the public key has many trailing 1&#39;s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91d82a7c2717261187c8e00d8df963ff35d796edad36bc6e6bd1c91c670d9105b43dcabddaf8fcaa61f4603e7cbac0f3c0351ecd5988efb23f680d07debd1399292829c31faa2e400e344ed94bca3fcd0545956ebcfe8ad0f6dfa5ff8effffffffa01aafaf000e52585855afa7676ade284113099052df57e7eb3bd37ebeb9222e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #297: x-coordinate of the public key has many trailing 1&#39;s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f915eb9c8845de68eb13d5befe719f462d77787802baff30ce96a5cba063254af782c026ae9be2e2a5e7ca0ff9bbd92fb6e44972186228ee9a62b87ddbe2ef66fb52829c31faa2e400e344ed94bca3fcd0545956ebcfe8ad0f6dfa5ff8effffffffa01aafaf000e52585855afa7676ade284113099052df57e7eb3bd37ebeb9222e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #298: x-coordinate of the public key has many trailing 1&#39;s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f9196843dd03c22abd2f3b782b170239f90f277921becc117d0404a8e4e36230c28f2be378f526f74a543f67165976de9ed9a31214eb4d7e6db19e1ede123dd991d2829c31faa2e400e344ed94bca3fcd0545956ebcfe8ad0f6dfa5ff8effffffffa01aafaf000e52585855afa7676ade284113099052df57e7eb3bd37ebeb9222e&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #299: x-coordinate of the public key has many trailing 1&#39;s&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91766456dce1857c906f9996af729339464d27e9d98edc2d0e3b760297067421f6402385ecadae0d8081dccaf5d19037ec4e55376eced699e93646bfbbf19d0b41fffffff948081e6a0458dd8f9e738f2665ff9059ad6aac0708318c4ca9a7a4f55a8abcba2dda8474311ee54149b973cae0c0fb89557ad0bf78e6529a1663bd73&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #300: x-coordinate of the public key is large&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91c605c4b2edeab20419e6518a11b2dbc2b97ed8b07cced0b19c34f777de7b9fd9edf0f612c5f46e03c719647bc8af1b29b2cde2eda700fb1cff5e159d47326dbafffffff948081e6a0458dd8f9e738f2665ff9059ad6aac0708318c4ca9a7a4f55a8abcba2dda8474311ee54149b973cae0c0fb89557ad0bf78e6529a1663bd73&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #301: x-coordinate of the public key is large&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91d48b68e6cabfe03cf6141c9ac54141f210e64485d9929ad7b732bfe3b7eb8a84feedae50c61bd00e19dc26f9b7e2265e4508c389109ad2f208f0772315b6c941fffffff948081e6a0458dd8f9e738f2665ff9059ad6aac0708318c4ca9a7a4f55a8abcba2dda8474311ee54149b973cae0c0fb89557ad0bf78e6529a1663bd73&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #302: x-coordinate of the public key is large&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91b7c81457d4aeb6aa65957098569f0479710ad7f6595d5874c35a93d12a5dd4c7b7961a0b652878c2d568069a432ca18a1a9199f2ca574dad4b9e3a05c0a1cdb300000003fa15f963949d5f03a6f5c7f86f9e0015eeb23aebbff1173937ba748e1099872070e8e87c555fa13659cca5d7fadcfcb0023ea889548ca48af2ba7e71&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #303: x-coordinate of the public key is small&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f916b01332ddb6edfa9a30a1321d5858e1ee3cf97e263e669f8de5e9652e76ff3f75939545fced457309a6a04ace2bd0f70139c8f7d86b02cb1cc58f9e69e96cd5a00000003fa15f963949d5f03a6f5c7f86f9e0015eeb23aebbff1173937ba748e1099872070e8e87c555fa13659cca5d7fadcfcb0023ea889548ca48af2ba7e71&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #304: x-coordinate of the public key is small&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91efdb884720eaeadc349f9fc356b6c0344101cd2fd8436b7d0e6a4fb93f106361f24bee6ad5dc05f7613975473aadf3aacba9e77de7d69b6ce48cb60d8113385d00000003fa15f963949d5f03a6f5c7f86f9e0015eeb23aebbff1173937ba748e1099872070e8e87c555fa13659cca5d7fadcfcb0023ea889548ca48af2ba7e71&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #305: x-coordinate of the public key is small&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f9131230428405560dcb88fb5a646836aea9b23a23dd973dcbe8014c87b8b20eb070f9344d6e812ce166646747694a41b0aaf97374e19f3c5fb8bd7ae3d9bd0beffbcbb2914c79f045eaa6ecbbc612816b3be5d2d6796707d8125e9f851c18af015000000001352bb4a0fa2ea4cceb9ab63dd684ade5a1127bcf300a698a7193bc2&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #306: y-coordinate of the public key is small&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91caa797da65b320ab0d5c470cda0b36b294359c7db9841d679174db34c4855743cf543a62f23e212745391aaf7505f345123d2685ee3b941d3de6d9b36242e5a0bcbb2914c79f045eaa6ecbbc612816b3be5d2d6796707d8125e9f851c18af015000000001352bb4a0fa2ea4cceb9ab63dd684ade5a1127bcf300a698a7193bc2&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #307: y-coordinate of the public key is small&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f917e5f0ab5d900d3d3d7867657e5d6d36519bc54084536e7d21c336ed8001859459450c07f201faec94b82dfb322e5ac676688294aad35aa72e727ff0b19b646aabcbb2914c79f045eaa6ecbbc612816b3be5d2d6796707d8125e9f851c18af015000000001352bb4a0fa2ea4cceb9ab63dd684ade5a1127bcf300a698a7193bc2&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #308: y-coordinate of the public key is small&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91d7d70c581ae9e3f66dc6a480bf037ae23f8a1e4a2136fe4b03aa69f0ca25b35689c460f8a5a5c2bbba962c8a3ee833a413e85658e62a59e2af41d9127cc47224bcbb2914c79f045eaa6ecbbc612816b3be5d2d6796707d8125e9f851c18af015fffffffeecad44b6f05d15b33146549c2297b522a5eed8430cff596758e6c43d&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #309: y-coordinate of the public key is large&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f91341c1b9ff3c83dd5e0dfa0bf68bcdf4bb7aa20c625975e5eeee34bb396266b3472b69f061b750fd5121b22b11366fad549c634e77765a017902a67099e0a4469bcbb2914c79f045eaa6ecbbc612816b3be5d2d6796707d8125e9f851c18af015fffffffeecad44b6f05d15b33146549c2297b522a5eed8430cff596758e6c43d&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #310: y-coordinate of the public key is large&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f9170bebe684cdcb5ca72a42f0d873879359bd1781a591809947628d313a3814f67aec03aca8f5587a4d535fa31027bbe9cc0e464b1c3577f4c2dcde6b2094798a9bcbb2914c79f045eaa6ecbbc612816b3be5d2d6796707d8125e9f851c18af015fffffffeecad44b6f05d15b33146549c2297b522a5eed8430cff596758e6c43d&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;0000000000000000000000000000000000000000000000000000000000000001&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;wycheproof&#47;ecdsa_webcrypto_test.json EcdsaP1363Verify SHA-256 #311: y-coordinate of the public key is large&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f9170bebe684cdcb5ca72a42f0d873879359bd1781a591809947628d313a3814f67aec03aca8f5587a4d535fa31027bbe9cc0e464b1c3577f4c2dcde6b2094798a90000000000000000000000000000000000000000000000000000000000000000fffffffeecad44b6f05d15b33146549c2297b522a5eed8430cff596758e6c43d&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;invalid public key x param errors&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f9170bebe684cdcb5ca72a42f0d873879359bd1781a591809947628d313a3814f67aec03aca8f5587a4d535fa31027bbe9cc0e464b1c3577f4c2dcde6b2094798a9bcbb2914c79f045eaa6ecbbc612816b3be5d2d6796707d8125e9f851c18af0150000000000000000000000000000000000000000000000000000000000000000&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;invalid public key y param errors&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  {</span>
<span class="term-fg32">+    &quot;Input&quot;: &quot;2f77668a9dfbf8d5848b9eeb4a7145ca94c6ed9236e4a773f6dcafa5132b2f9170bebe684cdcb5ca72a42f0d873879359bd1781a591809947628d313a3814f67aec03aca8f5587a4d535fa31027bbe9cc0e464b1c3577f4c2dcde6b2094798a900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000&quot;,</span>
<span class="term-fg32">+    &quot;Expected&quot;: &quot;&quot;,</span>
<span class="term-fg32">+    &quot;Gas&quot;: 3450,</span>
<span class="term-fg32">+    &quot;Name&quot;: &quot;reference point errors&quot;,</span>
<span class="term-fg32">+    &quot;NoBenchmark&quot;: false</span>
<span class="term-fg32">+  }</span>
<span class="term-fg32">+]</span>
<span class="term-fg32">\ No newline at end of file</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-muted" data-bs-toggle="collapse" href="#id-700a4a05a79523b76c5d106d" role="button"
                       aria-expanded="false" aria-controls="id-700a4a05a79523b76c5d106d">
                        <code>eth/downloader/userDepositData/10.105235063-114696812.gob</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/eth/downloader/userDepositData/10.105235063-114696812.gob" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <span class="text-secondary">(binary file)</span>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-700a4a05a79523b76c5d106d"><span class="term-fg1">diff --git go-ethereum&#47;eth&#47;downloader&#47;userDepositData&#47;10.105235063-114696812.gob op-geth&#47;eth&#47;downloader&#47;userDepositData&#47;10.105235063-114696812.gob</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..f26643825f272cf945fc71c953265bac6336f40a</span>
<span class="term-fg1">Binary files &#47;dev&#47;null and op-geth&#47;eth&#47;downloader&#47;userDepositData&#47;10.105235063-114696812.gob differ</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-muted" data-bs-toggle="collapse" href="#id-6cb4f29da709f9dafcf5a7d4" role="button"
                       aria-expanded="false" aria-controls="id-6cb4f29da709f9dafcf5a7d4">
                        <code>eth/downloader/userDepositData/291.0-4192087.gob</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/eth/downloader/userDepositData/291.0-4192087.gob" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <span class="text-secondary">(binary file)</span>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-6cb4f29da709f9dafcf5a7d4"><span class="term-fg1">diff --git go-ethereum&#47;eth&#47;downloader&#47;userDepositData&#47;291.0-4192087.gob op-geth&#47;eth&#47;downloader&#47;userDepositData&#47;291.0-4192087.gob</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..0a94e024c6638124ac5af95ef101ff7209516331</span>
<span class="term-fg1">Binary files &#47;dev&#47;null and op-geth&#47;eth&#47;downloader&#47;userDepositData&#47;291.0-4192087.gob differ</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-muted" data-bs-toggle="collapse" href="#id-cb37f03c95bde9aa09e6d97e" role="button"
                       aria-expanded="false" aria-controls="id-cb37f03c95bde9aa09e6d97e">
                        <code>eth/downloader/userDepositData/34443.0-2412409.gob</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/eth/downloader/userDepositData/34443.0-2412409.gob" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <span class="text-secondary">(binary file)</span>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-cb37f03c95bde9aa09e6d97e"><span class="term-fg1">diff --git go-ethereum&#47;eth&#47;downloader&#47;userDepositData&#47;34443.0-2412409.gob op-geth&#47;eth&#47;downloader&#47;userDepositData&#47;34443.0-2412409.gob</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..750e6669594db72e1ce3d5d779651a56e3166cb2</span>
<span class="term-fg1">Binary files &#47;dev&#47;null and op-geth&#47;eth&#47;downloader&#47;userDepositData&#47;34443.0-2412409.gob differ</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-muted" data-bs-toggle="collapse" href="#id-e71ef35a8a8f5b6ac1492e92" role="button"
                       aria-expanded="false" aria-controls="id-e71ef35a8a8f5b6ac1492e92">
                        <code>eth/downloader/userDepositData/420.6825766-17276566.gob</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/eth/downloader/userDepositData/420.6825766-17276566.gob" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <span class="text-secondary">(binary file)</span>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-e71ef35a8a8f5b6ac1492e92"><span class="term-fg1">diff --git go-ethereum&#47;eth&#47;downloader&#47;userDepositData&#47;420.6825766-17276566.gob op-geth&#47;eth&#47;downloader&#47;userDepositData&#47;420.6825766-17276566.gob</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..d17871da6e0a732ad24b8186136d3e18d6a53f91</span>
<span class="term-fg1">Binary files &#47;dev&#47;null and op-geth&#47;eth&#47;downloader&#47;userDepositData&#47;420.6825766-17276566.gob differ</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-muted" data-bs-toggle="collapse" href="#id-91158e51336d1a7111fa5512" role="button"
                       aria-expanded="false" aria-controls="id-91158e51336d1a7111fa5512">
                        <code>eth/downloader/userDepositData/7777777.0-9149281.gob</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/eth/downloader/userDepositData/7777777.0-9149281.gob" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <span class="text-secondary">(binary file)</span>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-91158e51336d1a7111fa5512"><span class="term-fg1">diff --git go-ethereum&#47;eth&#47;downloader&#47;userDepositData&#47;7777777.0-9149281.gob op-geth&#47;eth&#47;downloader&#47;userDepositData&#47;7777777.0-9149281.gob</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..ee63497b9c874cffc6435d680be8dc67958456c9</span>
<span class="term-fg1">Binary files &#47;dev&#47;null and op-geth&#47;eth&#47;downloader&#47;userDepositData&#47;7777777.0-9149281.gob differ</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-muted" data-bs-toggle="collapse" href="#id-f1a2dd4ea1ca8ebef7e4bef9" role="button"
                       aria-expanded="false" aria-controls="id-f1a2dd4ea1ca8ebef7e4bef9">
                        <code>eth/downloader/userDepositData/8453.0-9101527.gob</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/eth/downloader/userDepositData/8453.0-9101527.gob" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <span class="text-secondary">(binary file)</span>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-f1a2dd4ea1ca8ebef7e4bef9"><span class="term-fg1">diff --git go-ethereum&#47;eth&#47;downloader&#47;userDepositData&#47;8453.0-9101527.gob op-geth&#47;eth&#47;downloader&#47;userDepositData&#47;8453.0-9101527.gob</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..88f825e01ad52bbb543527b50d88ee5640728a2d</span>
<span class="term-fg1">Binary files &#47;dev&#47;null and op-geth&#47;eth&#47;downloader&#47;userDepositData&#47;8453.0-9101527.gob differ</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-muted" data-bs-toggle="collapse" href="#id-a604a9e82075c8c7ce50a394" role="button"
                       aria-expanded="false" aria-controls="id-a604a9e82075c8c7ce50a394">
                        <code>eth/tracers/internal/tracetest/testdata/call_tracer/deposit.json</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/eth/tracers/internal/tracetest/testdata/call_tracer/deposit.json" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-add-ignored">+51</span></div>
                            <div class="text-start"><span class="text-delete-ignored">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-a604a9e82075c8c7ce50a394"><span class="term-fg1">diff --git go-ethereum&#47;eth&#47;tracers&#47;internal&#47;tracetest&#47;testdata&#47;call_tracer&#47;deposit.json op-geth&#47;eth&#47;tracers&#47;internal&#47;tracetest&#47;testdata&#47;call_tracer&#47;deposit.json</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..b946a1e5c5a4eb2136531c09cf298c5590c0cb17</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ op-geth&#47;eth&#47;tracers&#47;internal&#47;tracetest&#47;testdata&#47;call_tracer&#47;deposit.json</span>
<span class="term-fg36">@@ -0,0 +1,52 @@</span>
<span class="term-fg32">+{</span>
<span class="term-fg32">+  &quot;context&quot;: {</span>
<span class="term-fg32">+    &quot;difficulty&quot;: &quot;3699098917&quot;,</span>
<span class="term-fg32">+    &quot;gasLimit&quot;: &quot;5258985&quot;,</span>
<span class="term-fg32">+    &quot;miner&quot;: &quot;0xd049bfd667cb46aa3ef5df0da3e57db3be39e511&quot;,</span>
<span class="term-fg32">+    &quot;number&quot;: &quot;2294631&quot;,</span>
<span class="term-fg32">+    &quot;timestamp&quot;: &quot;1513675366&quot;</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  &quot;genesis&quot;: {</span>
<span class="term-fg32">+    &quot;alloc&quot;: {</span>
<span class="term-fg32">+      &quot;0xBc339E628E6fe32C39E84392D087567B2743Ea35&quot;: {</span>
<span class="term-fg32">+        &quot;balance&quot;: &quot;0x99999999999999999&quot;</span>
<span class="term-fg32">+      }</span>
<span class="term-fg32">+    },</span>
<span class="term-fg32">+    &quot;config&quot;: {</span>
<span class="term-fg32">+      &quot;chainId&quot;: 3,</span>
<span class="term-fg32">+      &quot;daoForkSupport&quot;: true,</span>
<span class="term-fg32">+      &quot;eip150Hash&quot;: &quot;0x41941023680923e0fe4d74a34bdac8141f2540e3ae90623718e47d66d1ca4a2d&quot;,</span>
<span class="term-fg32">+      &quot;ethash&quot;: {},</span>
<span class="term-fg32">+      &quot;eip150Block&quot;: 0,</span>
<span class="term-fg32">+      &quot;eip155Block&quot;: 0,</span>
<span class="term-fg32">+      &quot;eip158Block&quot;: 0,</span>
<span class="term-fg32">+      &quot;byzantiumBlock&quot;: 0,</span>
<span class="term-fg32">+      &quot;constantinopleBlock&quot;: 0,</span>
<span class="term-fg32">+      &quot;petersburgBlock&quot;: 0,</span>
<span class="term-fg32">+      &quot;istanbulBlock&quot;: 0,</span>
<span class="term-fg32">+      &quot;berlinBlock&quot;: 0,</span>
<span class="term-fg32">+      &quot;londonBlock&quot;: 0</span>
<span class="term-fg32">+    },</span>
<span class="term-fg32">+    &quot;difficulty&quot;: &quot;3699098917&quot;,</span>
<span class="term-fg32">+    &quot;extraData&quot;: &quot;0x4554482e45544846414e532e4f52472d4641313738394444&quot;,</span>
<span class="term-fg32">+    &quot;gasLimit&quot;: &quot;5263953&quot;,</span>
<span class="term-fg32">+    &quot;hash&quot;: &quot;0x03a0f62a8106793dafcfae7b75fd2654322062d585a19cea568314d7205790dc&quot;,</span>
<span class="term-fg32">+    &quot;miner&quot;: &quot;0xbbf5029fd710d227630c8b7d338051b8e76d50b3&quot;,</span>
<span class="term-fg32">+    &quot;mixHash&quot;: &quot;0x15482cc64b7c00a947f5bf015dfc010db1a6a668c74df61974d6a7848c174408&quot;,</span>
<span class="term-fg32">+    &quot;nonce&quot;: &quot;0xd1bdb150f6fd170e&quot;,</span>
<span class="term-fg32">+    &quot;number&quot;: &quot;2294630&quot;,</span>
<span class="term-fg32">+    &quot;stateRoot&quot;: &quot;0x1ab1a534e84cc787cda1db21e0d5920ab06017948075b759166cfea7274657a1&quot;,</span>
<span class="term-fg32">+    &quot;timestamp&quot;: &quot;1513675347&quot;,</span>
<span class="term-fg32">+    &quot;totalDifficulty&quot;: &quot;7160543502214733&quot;</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  &quot;input&quot;: &quot;0x7ef85aa0b4f9f798a5fe956d1b79c3eff355febf9e1039a7440948845536982cb62aa03194bc339e628e6fe32c39e84392d087567b2743ea3594bc339e628e6fe32c39e84392d087567b2743ea3580871aa535d3d0c00083030d408000&quot;,</span>
<span class="term-fg32">+  &quot;result&quot;: {</span>
<span class="term-fg32">+    &quot;from&quot;:&quot;0xBc339E628E6fe32C39E84392D087567B2743Ea35&quot;,</span>
<span class="term-fg32">+    &quot;to&quot;: &quot;0xbc339e628e6fe32c39e84392d087567b2743ea35&quot;,</span>
<span class="term-fg32">+    &quot;gas&quot;:&quot;0x30d40&quot;,</span>
<span class="term-fg32">+    &quot;gasUsed&quot;:&quot;0x30d40&quot;,</span>
<span class="term-fg32">+    &quot;input&quot;:&quot;0x00&quot;,</span>
<span class="term-fg32">+    &quot;value&quot;: &quot;0x1aa535d3d0c000&quot;,</span>
<span class="term-fg32">+    &quot;type&quot;:&quot;CALL&quot;</span>
<span class="term-fg32">+  }</span>
<span class="term-fg32">+}</span>
<span class="term-fg32">\ No newline at end of file</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-muted" data-bs-toggle="collapse" href="#id-3f07906e66de5059435cd39d" role="button"
                       aria-expanded="false" aria-controls="id-3f07906e66de5059435cd39d">
                        <code>eth/tracers/internal/tracetest/testdata/call_tracer/failed_deposit.json</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/eth/tracers/internal/tracetest/testdata/call_tracer/failed_deposit.json" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-add-ignored">+47</span></div>
                            <div class="text-start"><span class="text-delete-ignored">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-3f07906e66de5059435cd39d"><span class="term-fg1">diff --git go-ethereum&#47;eth&#47;tracers&#47;internal&#47;tracetest&#47;testdata&#47;call_tracer&#47;failed_deposit.json op-geth&#47;eth&#47;tracers&#47;internal&#47;tracetest&#47;testdata&#47;call_tracer&#47;failed_deposit.json</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..2c43cdae0f732a4faae29e19cc8df11741d198fa</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ op-geth&#47;eth&#47;tracers&#47;internal&#47;tracetest&#47;testdata&#47;call_tracer&#47;failed_deposit.json</span>
<span class="term-fg36">@@ -0,0 +1,47 @@</span>
<span class="term-fg32">+{</span>
<span class="term-fg32">+  &quot;context&quot;: {</span>
<span class="term-fg32">+    &quot;difficulty&quot;: &quot;3699098917&quot;,</span>
<span class="term-fg32">+    &quot;gasLimit&quot;: &quot;5258985&quot;,</span>
<span class="term-fg32">+    &quot;miner&quot;: &quot;0xd049bfd667cb46aa3ef5df0da3e57db3be39e511&quot;,</span>
<span class="term-fg32">+    &quot;number&quot;: &quot;2294631&quot;,</span>
<span class="term-fg32">+    &quot;timestamp&quot;: &quot;1513675366&quot;</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  &quot;genesis&quot;: {</span>
<span class="term-fg32">+    &quot;alloc&quot;: {},</span>
<span class="term-fg32">+    &quot;config&quot;: {</span>
<span class="term-fg32">+      &quot;chainId&quot;: 3,</span>
<span class="term-fg32">+      &quot;daoForkSupport&quot;: true,</span>
<span class="term-fg32">+      &quot;eip150Hash&quot;: &quot;0x41941023680923e0fe4d74a34bdac8141f2540e3ae90623718e47d66d1ca4a2d&quot;,</span>
<span class="term-fg32">+      &quot;ethash&quot;: {},</span>
<span class="term-fg32">+      &quot;eip150Block&quot;: 0,</span>
<span class="term-fg32">+      &quot;eip155Block&quot;: 0,</span>
<span class="term-fg32">+      &quot;eip158Block&quot;: 0,</span>
<span class="term-fg32">+      &quot;byzantiumBlock&quot;: 0,</span>
<span class="term-fg32">+      &quot;constantinopleBlock&quot;: 0,</span>
<span class="term-fg32">+      &quot;petersburgBlock&quot;: 0,</span>
<span class="term-fg32">+      &quot;istanbulBlock&quot;: 0,</span>
<span class="term-fg32">+      &quot;berlinBlock&quot;: 0,</span>
<span class="term-fg32">+      &quot;londonBlock&quot;: 0</span>
<span class="term-fg32">+    },</span>
<span class="term-fg32">+    &quot;difficulty&quot;: &quot;3699098917&quot;,</span>
<span class="term-fg32">+    &quot;extraData&quot;: &quot;0x4554482e45544846414e532e4f52472d4641313738394444&quot;,</span>
<span class="term-fg32">+    &quot;gasLimit&quot;: &quot;5263953&quot;,</span>
<span class="term-fg32">+    &quot;hash&quot;: &quot;0x03a0f62a8106793dafcfae7b75fd2654322062d585a19cea568314d7205790dc&quot;,</span>
<span class="term-fg32">+    &quot;miner&quot;: &quot;0xbbf5029fd710d227630c8b7d338051b8e76d50b3&quot;,</span>
<span class="term-fg32">+    &quot;mixHash&quot;: &quot;0x15482cc64b7c00a947f5bf015dfc010db1a6a668c74df61974d6a7848c174408&quot;,</span>
<span class="term-fg32">+    &quot;nonce&quot;: &quot;0xd1bdb150f6fd170e&quot;,</span>
<span class="term-fg32">+    &quot;number&quot;: &quot;2294630&quot;,</span>
<span class="term-fg32">+    &quot;stateRoot&quot;: &quot;0x1ab1a534e84cc787cda1db21e0d5920ab06017948075b759166cfea7274657a1&quot;,</span>
<span class="term-fg32">+    &quot;timestamp&quot;: &quot;1513675347&quot;,</span>
<span class="term-fg32">+    &quot;totalDifficulty&quot;: &quot;7160543502214733&quot;</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  &quot;input&quot;: &quot;0x7ef85aa0b4f9f798a5fe956d1b79c3eff355febf9e1039a7440948845536982cb62aa03194bc339e628e6fe32c39e84392d087567b2743ea3594bc339e628e6fe32c39e84392d087567b2743ea3580871aa535d3d0c00083030d408000&quot;,</span>
<span class="term-fg32">+  &quot;result&quot;: {</span>
<span class="term-fg32">+    &quot;from&quot;:&quot;0x0000000000000000000000000000000000000000&quot;,</span>
<span class="term-fg32">+    &quot;gas&quot;:&quot;0x0&quot;,</span>
<span class="term-fg32">+    &quot;gasUsed&quot;:&quot;0x30d40&quot;,</span>
<span class="term-fg32">+    &quot;input&quot;:&quot;0x&quot;,</span>
<span class="term-fg32">+    &quot;error&quot;: &quot;failed deposit transaction&quot;,</span>
<span class="term-fg32">+    &quot;type&quot;:&quot;STOP&quot;</span>
<span class="term-fg32">+  }</span>
<span class="term-fg32">+}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-muted" data-bs-toggle="collapse" href="#id-8625f8479a917cd5720b76ed" role="button"
                       aria-expanded="false" aria-controls="id-8625f8479a917cd5720b76ed">
                        <code>eth/tracers/internal/tracetest/testdata/call_tracer_flat/deposit.json</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/eth/tracers/internal/tracetest/testdata/call_tracer_flat/deposit.json" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-add-ignored">+65</span></div>
                            <div class="text-start"><span class="text-delete-ignored">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-8625f8479a917cd5720b76ed"><span class="term-fg1">diff --git go-ethereum&#47;eth&#47;tracers&#47;internal&#47;tracetest&#47;testdata&#47;call_tracer_flat&#47;deposit.json op-geth&#47;eth&#47;tracers&#47;internal&#47;tracetest&#47;testdata&#47;call_tracer_flat&#47;deposit.json</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..56133befc7b7d0ba33f93912955a09a9e965224d</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ op-geth&#47;eth&#47;tracers&#47;internal&#47;tracetest&#47;testdata&#47;call_tracer_flat&#47;deposit.json</span>
<span class="term-fg36">@@ -0,0 +1,65 @@</span>
<span class="term-fg32">+{</span>
<span class="term-fg32">+  &quot;context&quot;: {</span>
<span class="term-fg32">+    &quot;difficulty&quot;: &quot;3699098917&quot;,</span>
<span class="term-fg32">+    &quot;gasLimit&quot;: &quot;5258985&quot;,</span>
<span class="term-fg32">+    &quot;miner&quot;: &quot;0xd049bfd667cb46aa3ef5df0da3e57db3be39e511&quot;,</span>
<span class="term-fg32">+    &quot;number&quot;: &quot;2294631&quot;,</span>
<span class="term-fg32">+    &quot;timestamp&quot;: &quot;1513675366&quot;</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  &quot;genesis&quot;: {</span>
<span class="term-fg32">+    &quot;alloc&quot;: {</span>
<span class="term-fg32">+      &quot;0xBc339E628E6fe32C39E84392D087567B2743Ea35&quot;: {</span>
<span class="term-fg32">+        &quot;balance&quot;: &quot;0x99999999999999999&quot;</span>
<span class="term-fg32">+      }</span>
<span class="term-fg32">+    },</span>
<span class="term-fg32">+    &quot;config&quot;: {</span>
<span class="term-fg32">+      &quot;chainId&quot;: 3,</span>
<span class="term-fg32">+      &quot;daoForkSupport&quot;: true,</span>
<span class="term-fg32">+      &quot;eip150Hash&quot;: &quot;0x41941023680923e0fe4d74a34bdac8141f2540e3ae90623718e47d66d1ca4a2d&quot;,</span>
<span class="term-fg32">+      &quot;ethash&quot;: {},</span>
<span class="term-fg32">+      &quot;eip150Block&quot;: 0,</span>
<span class="term-fg32">+      &quot;eip155Block&quot;: 0,</span>
<span class="term-fg32">+      &quot;eip158Block&quot;: 0,</span>
<span class="term-fg32">+      &quot;byzantiumBlock&quot;: 0,</span>
<span class="term-fg32">+      &quot;constantinopleBlock&quot;: 0,</span>
<span class="term-fg32">+      &quot;petersburgBlock&quot;: 0,</span>
<span class="term-fg32">+      &quot;istanbulBlock&quot;: 0,</span>
<span class="term-fg32">+      &quot;berlinBlock&quot;: 0,</span>
<span class="term-fg32">+      &quot;londonBlock&quot;: 0</span>
<span class="term-fg32">+    },</span>
<span class="term-fg32">+    &quot;difficulty&quot;: &quot;3699098917&quot;,</span>
<span class="term-fg32">+    &quot;extraData&quot;: &quot;0x4554482e45544846414e532e4f52472d4641313738394444&quot;,</span>
<span class="term-fg32">+    &quot;gasLimit&quot;: &quot;5263953&quot;,</span>
<span class="term-fg32">+    &quot;hash&quot;: &quot;0x03a0f62a8106793dafcfae7b75fd2654322062d585a19cea568314d7205790dc&quot;,</span>
<span class="term-fg32">+    &quot;miner&quot;: &quot;0xbbf5029fd710d227630c8b7d338051b8e76d50b3&quot;,</span>
<span class="term-fg32">+    &quot;mixHash&quot;: &quot;0x15482cc64b7c00a947f5bf015dfc010db1a6a668c74df61974d6a7848c174408&quot;,</span>
<span class="term-fg32">+    &quot;nonce&quot;: &quot;0xd1bdb150f6fd170e&quot;,</span>
<span class="term-fg32">+    &quot;number&quot;: &quot;2294630&quot;,</span>
<span class="term-fg32">+    &quot;stateRoot&quot;: &quot;0x1ab1a534e84cc787cda1db21e0d5920ab06017948075b759166cfea7274657a1&quot;,</span>
<span class="term-fg32">+    &quot;timestamp&quot;: &quot;1513675347&quot;,</span>
<span class="term-fg32">+    &quot;totalDifficulty&quot;: &quot;7160543502214733&quot;</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  &quot;input&quot;: &quot;0x7ef85aa0b4f9f798a5fe956d1b79c3eff355febf9e1039a7440948845536982cb62aa03194bc339e628e6fe32c39e84392d087567b2743ea3594bc339e628e6fe32c39e84392d087567b2743ea3580871aa535d3d0c00083030d408000&quot;,</span>
<span class="term-fg32">+  &quot;result&quot;: [{</span>
<span class="term-fg32">+    &quot;type&quot;: &quot;call&quot;,</span>
<span class="term-fg32">+    &quot;action&quot;: {</span>
<span class="term-fg32">+      &quot;author&quot;: &quot;0x0000000000000000000000000000000000000000&quot;,</span>
<span class="term-fg32">+      &quot;refundAddress&quot;: &quot;0x0000000000000000000000000000000000000000&quot;,</span>
<span class="term-fg32">+      &quot;from&quot;:&quot;0xBc339E628E6fe32C39E84392D087567B2743Ea35&quot;,</span>
<span class="term-fg32">+      &quot;to&quot;: &quot;0xbc339e628e6fe32c39e84392d087567b2743ea35&quot;,</span>
<span class="term-fg32">+      &quot;gas&quot;:&quot;0x30d40&quot;,</span>
<span class="term-fg32">+      &quot;gasUsed&quot;:&quot;0x30d40&quot;,</span>
<span class="term-fg32">+      &quot;input&quot;:&quot;0x00&quot;,</span>
<span class="term-fg32">+      &quot;value&quot;: &quot;0x1aa535d3d0c000&quot;,</span>
<span class="term-fg32">+      &quot;callType&quot;:&quot;call&quot;,</span>
<span class="term-fg32">+      &quot;address&quot;: &quot;0x0000000000000000000000000000000000000000&quot;,</span>
<span class="term-fg32">+      &quot;balance&quot;: &quot;0x0&quot;</span>
<span class="term-fg32">+    },</span>
<span class="term-fg32">+    &quot;result&quot;: {</span>
<span class="term-fg32">+      &quot;address&quot;: &quot;0x0000000000000000000000000000000000000000&quot;,</span>
<span class="term-fg32">+      &quot;gasUsed&quot;: &quot;0x30d40&quot;,</span>
<span class="term-fg32">+      &quot;output&quot;: &quot;0x&quot;</span>
<span class="term-fg32">+    },</span>
<span class="term-fg32">+    &quot;traceAddress&quot;: []</span>
<span class="term-fg32">+  }]</span>
<span class="term-fg32">+}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-muted" data-bs-toggle="collapse" href="#id-00f53e6739682cab887b817b" role="button"
                       aria-expanded="false" aria-controls="id-00f53e6739682cab887b817b">
                        <code>eth/tracers/internal/tracetest/testdata/call_tracer_flat/failed_deposit.json</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/eth/tracers/internal/tracetest/testdata/call_tracer_flat/failed_deposit.json" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-add-ignored">+59</span></div>
                            <div class="text-start"><span class="text-delete-ignored">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-00f53e6739682cab887b817b"><span class="term-fg1">diff --git go-ethereum&#47;eth&#47;tracers&#47;internal&#47;tracetest&#47;testdata&#47;call_tracer_flat&#47;failed_deposit.json op-geth&#47;eth&#47;tracers&#47;internal&#47;tracetest&#47;testdata&#47;call_tracer_flat&#47;failed_deposit.json</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..540cd53579b1f58a9f72da481d2f86a8572ee430</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ op-geth&#47;eth&#47;tracers&#47;internal&#47;tracetest&#47;testdata&#47;call_tracer_flat&#47;failed_deposit.json</span>
<span class="term-fg36">@@ -0,0 +1,59 @@</span>
<span class="term-fg32">+{</span>
<span class="term-fg32">+  &quot;context&quot;: {</span>
<span class="term-fg32">+    &quot;difficulty&quot;: &quot;3699098917&quot;,</span>
<span class="term-fg32">+    &quot;gasLimit&quot;: &quot;5258985&quot;,</span>
<span class="term-fg32">+    &quot;miner&quot;: &quot;0xd049bfd667cb46aa3ef5df0da3e57db3be39e511&quot;,</span>
<span class="term-fg32">+    &quot;number&quot;: &quot;2294631&quot;,</span>
<span class="term-fg32">+    &quot;timestamp&quot;: &quot;1513675366&quot;</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  &quot;genesis&quot;: {</span>
<span class="term-fg32">+    &quot;alloc&quot;: {},</span>
<span class="term-fg32">+    &quot;config&quot;: {</span>
<span class="term-fg32">+      &quot;chainId&quot;: 3,</span>
<span class="term-fg32">+      &quot;daoForkSupport&quot;: true,</span>
<span class="term-fg32">+      &quot;eip150Hash&quot;: &quot;0x41941023680923e0fe4d74a34bdac8141f2540e3ae90623718e47d66d1ca4a2d&quot;,</span>
<span class="term-fg32">+      &quot;ethash&quot;: {},</span>
<span class="term-fg32">+      &quot;eip150Block&quot;: 0,</span>
<span class="term-fg32">+      &quot;eip155Block&quot;: 0,</span>
<span class="term-fg32">+      &quot;eip158Block&quot;: 0,</span>
<span class="term-fg32">+      &quot;byzantiumBlock&quot;: 0,</span>
<span class="term-fg32">+      &quot;constantinopleBlock&quot;: 0,</span>
<span class="term-fg32">+      &quot;petersburgBlock&quot;: 0,</span>
<span class="term-fg32">+      &quot;istanbulBlock&quot;: 0,</span>
<span class="term-fg32">+      &quot;berlinBlock&quot;: 0,</span>
<span class="term-fg32">+      &quot;londonBlock&quot;: 0</span>
<span class="term-fg32">+    },</span>
<span class="term-fg32">+    &quot;difficulty&quot;: &quot;3699098917&quot;,</span>
<span class="term-fg32">+    &quot;extraData&quot;: &quot;0x4554482e45544846414e532e4f52472d4641313738394444&quot;,</span>
<span class="term-fg32">+    &quot;gasLimit&quot;: &quot;5263953&quot;,</span>
<span class="term-fg32">+    &quot;hash&quot;: &quot;0x03a0f62a8106793dafcfae7b75fd2654322062d585a19cea568314d7205790dc&quot;,</span>
<span class="term-fg32">+    &quot;miner&quot;: &quot;0xbbf5029fd710d227630c8b7d338051b8e76d50b3&quot;,</span>
<span class="term-fg32">+    &quot;mixHash&quot;: &quot;0x15482cc64b7c00a947f5bf015dfc010db1a6a668c74df61974d6a7848c174408&quot;,</span>
<span class="term-fg32">+    &quot;nonce&quot;: &quot;0xd1bdb150f6fd170e&quot;,</span>
<span class="term-fg32">+    &quot;number&quot;: &quot;2294630&quot;,</span>
<span class="term-fg32">+    &quot;stateRoot&quot;: &quot;0x1ab1a534e84cc787cda1db21e0d5920ab06017948075b759166cfea7274657a1&quot;,</span>
<span class="term-fg32">+    &quot;timestamp&quot;: &quot;1513675347&quot;,</span>
<span class="term-fg32">+    &quot;totalDifficulty&quot;: &quot;7160543502214733&quot;</span>
<span class="term-fg32">+  },</span>
<span class="term-fg32">+  &quot;input&quot;: &quot;0x7ef85aa0b4f9f798a5fe956d1b79c3eff355febf9e1039a7440948845536982cb62aa03194bc339e628e6fe32c39e84392d087567b2743ea3594bc339e628e6fe32c39e84392d087567b2743ea3580871aa535d3d0c00083030d408000&quot;,</span>
<span class="term-fg32">+  &quot;result&quot;: [</span>
<span class="term-fg32">+    {</span>
<span class="term-fg32">+      &quot;action&quot;: {</span>
<span class="term-fg32">+        &quot;callType&quot;: &quot;stop&quot;,</span>
<span class="term-fg32">+        &quot;from&quot;: &quot;0x0000000000000000000000000000000000000000&quot;,</span>
<span class="term-fg32">+        &quot;gas&quot;: &quot;0x0&quot;,</span>
<span class="term-fg32">+        &quot;input&quot;: &quot;0x&quot;,</span>
<span class="term-fg32">+        &quot;value&quot;: &quot;0x0&quot;</span>
<span class="term-fg32">+      },</span>
<span class="term-fg32">+      &quot;blockNumber&quot;: 0,</span>
<span class="term-fg32">+      &quot;error&quot;: &quot;failed deposit transaction&quot;,</span>
<span class="term-fg32">+      &quot;result&quot;: {</span>
<span class="term-fg32">+        &quot;gasUsed&quot;: &quot;0x0&quot;,</span>
<span class="term-fg32">+        &quot;output&quot;: &quot;0x&quot;</span>
<span class="term-fg32">+      },</span>
<span class="term-fg32">+      &quot;subtraces&quot;: 0,</span>
<span class="term-fg32">+      &quot;traceAddress&quot;: [],</span>
<span class="term-fg32">+      &quot;type&quot;: &quot;call&quot;</span>
<span class="term-fg32">+    }</span>
<span class="term-fg32">+  ]</span>
<span class="term-fg32">+}</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-muted" data-bs-toggle="collapse" href="#id-723025ec6b6c0b9a4975e393" role="button"
                       aria-expanded="false" aria-controls="id-723025ec6b6c0b9a4975e393">
                        <code>fork.yaml</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <span class="text-muted">(new)</span>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/fork.yaml" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-add-ignored">+292</span></div>
                            <div class="text-start"><span class="text-delete-ignored">-0</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-723025ec6b6c0b9a4975e393"><span class="term-fg1">diff --git go-ethereum&#47;fork.yaml op-geth&#47;fork.yaml</span>
<span class="term-fg1">new file mode 100644</span>
<span class="term-fg1">index 0000000000000000000000000000000000000000..63801ca37f310f494c6ccb75479addab487e0fb1</span>
<span class="term-fg1">--- &#47;dev&#47;null</span>
<span class="term-fg1">+++ op-geth&#47;fork.yaml</span>
<span class="term-fg36">@@ -0,0 +1,292 @@</span>
<span class="term-fg32">+title: &quot;op-geth - go-ethereum fork diff overview&quot;</span>
<span class="term-fg32">+footer: |</span>
<span class="term-fg32">+  Fork-diff overview of [`op-geth`](https:&#47;&#47;github.com&#47;ethereum-optimism&#47;op-geth), a fork of [`go-ethereum`](https:&#47;&#47;github.com&#47;ethereum&#47;go-ethereum).</span>
<span class="term-fg32">+  and execution-engine of the [OP-stack](https:&#47;&#47;github.com&#47;ethereum-optimism&#47;optimism).</span>
<span class="term-fg32">+base:</span>
<span class="term-fg32">+  name: go-ethereum</span>
<span class="term-fg32">+  url: https:&#47;&#47;github.com&#47;ethereum&#47;go-ethereum</span>
<span class="term-fg32">+  hash: aa55f5ea200dfd07618fdf658d9d2741c3b376a8 # v1.14.7</span>
<span class="term-fg32">+fork:</span>
<span class="term-fg32">+  name: op-geth</span>
<span class="term-fg32">+  url: https:&#47;&#47;github.com&#47;ethereum-optimism&#47;op-geth</span>
<span class="term-fg32">+  ref: refs&#47;heads&#47;optimism</span>
<span class="term-fg32">+def:</span>
<span class="term-fg32">+  title: &quot;op-geth&quot;</span>
<span class="term-fg32">+  description: |</span>
<span class="term-fg32">+    This is an overview of the changes in [`op-geth`](https:&#47;&#47;github.com&#47;ethereum-optimism&#47;op-geth),</span>
<span class="term-fg32">+    a fork of [`go-ethereum`](https:&#47;&#47;github.com&#47;ethereum&#47;go-ethereum), part of the OP-stack.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+    The OP-stack architecture is modular, following the Consensus&#47;Execution split of post-Merge Ethereum L1:</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+      - [`op-node`](https:&#47;&#47;github.com&#47;ethereum-optimism&#47;optimism&#47;tree&#47;develop&#47;op-node) implements most rollup-specific functionality as Consensus-Layer, similar to a L1 beacon-node. </span>
<span class="term-fg32">+      - [`op-geth`](https:&#47;&#47;github.com&#47;ethereum-optimism&#47;op-geth) implements the Execution-Layer, with **minimal changes** for a secure Ethereum-equivalent application environment.</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+    Related [op-stack specifications](https:&#47;&#47;github.com&#47;ethereum-optimism&#47;optimism&#47;tree&#47;develop&#47;specs):</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+    - [L2 Execution Engine spec](https:&#47;&#47;github.com&#47;ethereum-optimism&#47;optimism&#47;blob&#47;develop&#47;specs&#47;exec-engine.md)</span>
<span class="term-fg32">+    - [Deposit Transaction spec](https:&#47;&#47;github.com&#47;ethereum-optimism&#47;optimism&#47;blob&#47;develop&#47;specs&#47;deposits.md)</span>
<span class="term-fg32">+  sub:</span>
<span class="term-fg32">+    - title: &quot;Core modifications&quot;</span>
<span class="term-fg32">+      sub:</span>
<span class="term-fg32">+        - title: &quot;State-transition modifications&quot;</span>
<span class="term-fg32">+          description: &quot;&quot;</span>
<span class="term-fg32">+          sub:</span>
<span class="term-fg32">+            - title: &quot;Deposit Transaction type&quot;</span>
<span class="term-fg32">+              description: |</span>
<span class="term-fg32">+                The Bedrock upgrade introduces a `Deposit` transaction-type (`0x7E`) to enable both users and the</span>
<span class="term-fg32">+                rollup system itself to change the L2 state based on L1 events and system rules as</span>
<span class="term-fg32">+                [specified](https:&#47;&#47;github.com&#47;ethereum-optimism&#47;optimism&#47;blob&#47;develop&#47;specs&#47;deposits.md).</span>
<span class="term-fg32">+              globs:</span>
<span class="term-fg32">+                - &quot;core&#47;types&#47;deposit_tx.go&quot;</span>
<span class="term-fg32">+                - &quot;core&#47;types&#47;transaction_marshalling.go&quot;</span>
<span class="term-fg32">+                - &quot;core&#47;types&#47;transaction_signing.go&quot;</span>
<span class="term-fg32">+            - title: &quot;Transaction properties&quot;</span>
<span class="term-fg32">+              description: |</span>
<span class="term-fg32">+                The `Transaction` type now exposes the deposit-transaction and L1-cost properties required for the rollup.</span>
<span class="term-fg32">+              globs:</span>
<span class="term-fg32">+                - &quot;core&#47;types&#47;transaction.go&quot;</span>
<span class="term-fg32">+                - &quot;core&#47;types&#47;tx_access_list.go&quot;</span>
<span class="term-fg32">+                - &quot;core&#47;types&#47;tx_dynamic_fee.go&quot;</span>
<span class="term-fg32">+                - &quot;core&#47;types&#47;tx_legacy.go&quot;</span>
<span class="term-fg32">+                - &quot;core&#47;types&#47;tx_blob.go&quot;</span>
<span class="term-fg32">+            - title: &quot;L1 cost computation&quot;</span>
<span class="term-fg32">+              description: |</span>
<span class="term-fg32">+                Transactions must pay an additional L1 cost based on the amount of rollup-data-gas they consume,</span>
<span class="term-fg32">+                estimated based on gas-price-oracle information and encoded tx size.&quot;</span>
<span class="term-fg32">+              globs:</span>
<span class="term-fg32">+                - &quot;core&#47;vm&#47;evm.go&quot;</span>
<span class="term-fg32">+                - &quot;core&#47;evm.go&quot;</span>
<span class="term-fg32">+                - &quot;core&#47;types&#47;rollup_cost.go&quot;</span>
<span class="term-fg32">+                - &quot;core&#47;state_processor.go&quot;</span>
<span class="term-fg32">+                - &quot;core&#47;state_prefetcher.go&quot;</span>
<span class="term-fg32">+            - title: Transaction processing</span>
<span class="term-fg32">+              description: |</span>
<span class="term-fg32">+                Deposit transactions have special processing rules: gas is pre-paid on L1,</span>
<span class="term-fg32">+                and deposits with EVM-failure are included with rolled back changes (except mint).</span>
<span class="term-fg32">+                For regular transactions, at the end of the transition, the 1559 burn and L1 cost are routed to vaults.</span>
<span class="term-fg32">+              globs:</span>
<span class="term-fg32">+                - &quot;core&#47;state_transition.go&quot;</span>
<span class="term-fg32">+            - title: &quot;Core Error definitions&quot;</span>
<span class="term-fg32">+              globs:</span>
<span class="term-fg32">+                - &quot;core&#47;error.go&quot;</span>
<span class="term-fg32">+            - title: &quot;Gaslimit&quot;</span>
<span class="term-fg32">+              description: |</span>
<span class="term-fg32">+                The gaslimit is free to be set by the Engine API caller, instead of enforcing adjustments of the</span>
<span class="term-fg32">+                gaslimit in increments of 1&#47;1024 of the previous gaslimit.</span>
<span class="term-fg32">+                The gaslimit is changed (and limited) through the `SystemConfig` contract.</span>
<span class="term-fg32">+              globs:</span>
<span class="term-fg32">+                - &quot;consensus&#47;misc&#47;eip1559&#47;eip1559.go&quot;</span>
<span class="term-fg32">+            - title: &quot;Consensus tweaks&quot;</span>
<span class="term-fg32">+              description: |</span>
<span class="term-fg32">+                The Engine API is activated at the Merge transition, with a Total Terminal Difficulty (TTD).</span>
<span class="term-fg32">+                The rollup starts post-merge, and thus sets the TTD to 0.</span>
<span class="term-fg32">+                The TTD is always &quot;reached&quot; starting at the bedrock block.</span>
<span class="term-fg32">+              globs:</span>
<span class="term-fg32">+                - &quot;consensus&#47;beacon&#47;consensus.go&quot;</span>
<span class="term-fg32">+            - title: &quot;Legacy OP-mainnet &#47; OP-goerli header-verification support&quot;</span>
<span class="term-fg32">+              description: |</span>
<span class="term-fg32">+                Pre-Bedrock OP-mainnet and OP-Goerli had differently formatted block-headers, loosely compatible with the geth types (since it was based on Clique).</span>
<span class="term-fg32">+                However, due to differences like the extra-data length (97+ bytes), these legacy block-headers need special verification.</span>
<span class="term-fg32">+                The pre-merge &quot;consensus&quot; fallback is set to this custom but basic verifier, to accept these headers when syncing a pre-bedrock part of the chain,</span>
<span class="term-fg32">+                independent of any clique code or configuration (which may be removed from geth at a later point).</span>
<span class="term-fg32">+                All the custom verifier has to do is accept the headers, as the headers are already verified by block-hash through the reverse-header-sync.</span>
<span class="term-fg32">+              globs:</span>
<span class="term-fg32">+                - &quot;consensus&#47;beacon&#47;oplegacy.go&quot;</span>
<span class="term-fg32">+        - title: &quot;Engine API modifications&quot;</span>
<span class="term-fg32">+          description: |</span>
<span class="term-fg32">+            The Engine API is extended to insert transactions into the block and optionally exclude the tx-pool,</span>
<span class="term-fg32">+            to reproduce the exact block of the sequencer from just the inputs, as derived from L1 by the rollup-node.</span>
<span class="term-fg32">+            See [L2 execution engine specs](https:&#47;&#47;github.com&#47;ethereum-optimism&#47;optimism&#47;blob&#47;develop&#47;specs&#47;exec-engine.md).</span>
<span class="term-fg32">+          globs:</span>
<span class="term-fg32">+            - &quot;beacon&#47;engine&#47;types.go&quot;</span>
<span class="term-fg32">+            - &quot;beacon&#47;engine&#47;gen_blockparams.go&quot;</span>
<span class="term-fg32">+            - &quot;eth&#47;catalyst&#47;api.go&quot;</span>
<span class="term-fg32">+        - title: &quot;Block-building modifications&quot;</span>
<span class="term-fg32">+          description: |</span>
<span class="term-fg32">+            The block-building code (in the &quot;miner&quot; package because of Proof-Of-Work legacy of ethereum) implements the</span>
<span class="term-fg32">+            changes to support the transaction-inclusion, tx-pool toggle and gaslimit parameters of the Engine API.</span>
<span class="term-fg32">+          globs:</span>
<span class="term-fg32">+            - &quot;miner&#47;*&quot;</span>
<span class="term-fg32">+        - title: &quot;Tx-pool tx cost updates&quot;</span>
<span class="term-fg32">+          description: |</span>
<span class="term-fg32">+            Transaction queueing and inclusion needs to account for the L1 cost component.</span>
<span class="term-fg32">+          globs:</span>
<span class="term-fg32">+            - &quot;core&#47;txpool&#47;**&#47;*&quot;</span>
<span class="term-fg32">+            - &quot;core&#47;txpool&#47;legacypool&#47;*&quot;</span>
<span class="term-fg32">+        - title: &quot;RIP-7212&quot;</span>
<span class="term-fg32">+          description: &quot;&quot;</span>
<span class="term-fg32">+          globs:</span>
<span class="term-fg32">+            - &quot;core&#47;vm&#47;contracts.go&quot;</span>
<span class="term-fg32">+            - &quot;core&#47;vm&#47;interpreter.go&quot;</span>
<span class="term-fg32">+            - &quot;crypto&#47;secp256r1&#47;publickey.go&quot;</span>
<span class="term-fg32">+            - &quot;crypto&#47;secp256r1&#47;verifier.go&quot;</span>
<span class="term-fg32">+    - title: &quot;Chain Configuration&quot;</span>
<span class="term-fg32">+      sub:</span>
<span class="term-fg32">+        - title: &quot;Chain config&quot;</span>
<span class="term-fg32">+          description: |</span>
<span class="term-fg32">+            The rollup functionality is enabled with the `optimism` field in the chain config.</span>
<span class="term-fg32">+            The EIP-1559 parameters are configurable to adjust for faster more frequent and smaller blocks.</span>
<span class="term-fg32">+            The parameters can be overriden for testing.</span>
<span class="term-fg32">+          globs:</span>
<span class="term-fg32">+            - &quot;params&#47;config.go&quot;</span>
<span class="term-fg32">+            - &quot;params&#47;protocol_params.go&quot;</span>
<span class="term-fg32">+            - &quot;core&#47;genesis.go&quot;</span>
<span class="term-fg32">+        - title: &quot;Chain config cleanup&quot;</span>
<span class="term-fg32">+          description: |</span>
<span class="term-fg32">+            The optimism Goerli testnet used clique-config data to make geth internals accept blocks.</span>
<span class="term-fg32">+            Post-bedrock the beacon-consensus (i.e. follow Engine API) is now used, and the clique config is removed.</span>
<span class="term-fg32">+          globs:</span>
<span class="term-fg32">+            - &quot;core&#47;rawdb&#47;accessors_metadata.go&quot;</span>
<span class="term-fg32">+        - title: Genesis loading</span>
<span class="term-fg32">+          globs:</span>
<span class="term-fg32">+            - &quot;core&#47;gen_genesis.go&quot;</span>
<span class="term-fg32">+        - title: &quot;Superchain config&quot;</span>
<span class="term-fg32">+          description: Testing of the superchain configuration</span>
<span class="term-fg32">+          globs:</span>
<span class="term-fg32">+            - &quot;core&#47;superchain.go&quot;</span>
<span class="term-fg32">+            - &quot;params&#47;superchain.go&quot;</span>
<span class="term-fg32">+    - title: &quot;Node modifications&quot;</span>
<span class="term-fg32">+      description: Changes to the node configuration and services.</span>
<span class="term-fg32">+      sub:</span>
<span class="term-fg32">+        - title: &quot;CLI&quot;</span>
<span class="term-fg32">+          sub:</span>
<span class="term-fg32">+            - title: &quot;Flags&quot;</span>
<span class="term-fg32">+              description: |</span>
<span class="term-fg32">+                Flag changes:</span>
<span class="term-fg32">+                  - Transactions can be forwarded to an RPC for sequencing.</span>
<span class="term-fg32">+                  - Historical calls can be forwarded to a legacy node.</span>
<span class="term-fg32">+                  - The tx pool propagation can be enabled&#47;disabled.</span>
<span class="term-fg32">+                  - The Optimism bedrock fork activation can be changed for testing.</span>
<span class="term-fg32">+              globs:</span>
<span class="term-fg32">+                - &quot;cmd&#47;utils&#47;flags.go&quot;</span>
<span class="term-fg32">+                - &quot;cmd&#47;geth&#47;main.go&quot;</span>
<span class="term-fg32">+                - &quot;internal&#47;flags&#47;categories.go&quot;</span>
<span class="term-fg32">+                - &quot;cmd&#47;geth&#47;config.go&quot;</span>
<span class="term-fg32">+            - title: &quot;Versioning&quot;</span>
<span class="term-fg32">+              description: List the op-geth and upstream go-ethereum versions.</span>
<span class="term-fg32">+              globs:</span>
<span class="term-fg32">+                - &quot;cmd&#47;geth&#47;misccmd.go&quot;</span>
<span class="term-fg32">+                - &quot;params&#47;version.go&quot;</span>
<span class="term-fg32">+                - &quot;build&#47;ci.go&quot;</span>
<span class="term-fg32">+        - title: Node config</span>
<span class="term-fg32">+          globs:</span>
<span class="term-fg32">+            - &quot;eth&#47;ethconfig&#47;config.go&quot;</span>
<span class="term-fg32">+        - title: Tx gossip disable option</span>
<span class="term-fg32">+          globs:</span>
<span class="term-fg32">+            - &quot;eth&#47;handler.go&quot;</span>
<span class="term-fg32">+            - &quot;eth&#47;handler_eth.go&quot;</span>
<span class="term-fg32">+        - title: Warn on missing hardfork data</span>
<span class="term-fg32">+          globs:</span>
<span class="term-fg32">+            - &quot;core&#47;blockchain.go&quot;</span>
<span class="term-fg32">+        - title: Optional Engine API extensions</span>
<span class="term-fg32">+          globs:</span>
<span class="term-fg32">+            - &quot;eth&#47;catalyst&#47;superchain.go&quot;</span>
<span class="term-fg32">+        - title: Support legacy DBs when snap-syncing</span>
<span class="term-fg32">+          description: Snap-sync does not serve unprefixed code by default.</span>
<span class="term-fg32">+          globs:</span>
<span class="term-fg32">+            - &quot;core&#47;blockchain_reader.go&quot;</span>
<span class="term-fg32">+            - &quot;eth&#47;protocols&#47;snap&#47;handler.go&quot;</span>
<span class="term-fg32">+        - title: Historical data for Snap-sync</span>
<span class="term-fg32">+          description: Snap-sync has access to trusted Deposit Transaction Nonce Data.</span>
<span class="term-fg32">+          globs:</span>
<span class="term-fg32">+            - &quot;eth&#47;downloader&#47;downloader.go&quot;</span>
<span class="term-fg32">+            - &quot;eth&#47;downloader&#47;receiptreference.go&quot;</span>
<span class="term-fg32">+        - title: Discv5 node discovery</span>
<span class="term-fg32">+          description: Fix discv5 option to allow discv5 to be an active source for node-discovery.</span>
<span class="term-fg32">+          globs:</span>
<span class="term-fg32">+            - &quot;p2p&#47;server.go&quot;</span>
<span class="term-fg32">+        - title: Bootnodes</span>
<span class="term-fg32">+          description: Discovery bootnode addresses.</span>
<span class="term-fg32">+          globs:</span>
<span class="term-fg32">+            - &quot;params&#47;bootnodes.go&quot;</span>
<span class="term-fg32">+        - title: Generated TOML config update</span>
<span class="term-fg32">+          globs:</span>
<span class="term-fg32">+            - &quot;eth&#47;ethconfig&#47;gen_config.go&quot;</span>
<span class="term-fg32">+    - title: &quot;User API enhancements&quot;</span>
<span class="term-fg32">+      description: &quot;Encode the Deposit Tx properties, the L1 costs, and daisy-chain RPC-calls for pre-Bedrock historical data&quot;</span>
<span class="term-fg32">+      sub:</span>
<span class="term-fg32">+        - title: &quot;Receipts metadata&quot;</span>
<span class="term-fg32">+          description: |</span>
<span class="term-fg32">+            Pre-Bedrock L1-cost receipt data is loaded from the database if available, and post-Bedrock the L1-cost </span>
<span class="term-fg32">+            metadata is hydrated on-the-fly based on the L1 fee information in the corresponding block.</span>
<span class="term-fg32">+          globs:</span>
<span class="term-fg32">+            - &quot;core&#47;types&#47;receipt.go&quot;</span>
<span class="term-fg32">+            - &quot;core&#47;types&#47;gen_receipt_json.go&quot;</span>
<span class="term-fg32">+            - &quot;core&#47;rawdb&#47;accessors_chain.go&quot;</span>
<span class="term-fg32">+        - title: &quot;API Backend&quot;</span>
<span class="term-fg32">+          description: |</span>
<span class="term-fg32">+            Forward transactions to the sequencer if configured.</span>
<span class="term-fg32">+          globs:</span>
<span class="term-fg32">+            - &quot;eth&#47;api_backend.go&quot;</span>
<span class="term-fg32">+            - &quot;eth&#47;backend.go&quot;</span>
<span class="term-fg32">+            - &quot;internal&#47;ethapi&#47;backend.go&quot;</span>
<span class="term-fg32">+        - title: &quot;Apply L1 cost in API responses&quot;</span>
<span class="term-fg32">+          globs:</span>
<span class="term-fg32">+            - &quot;eth&#47;state_accessor.go&quot;</span>
<span class="term-fg32">+        - title: API frontend</span>
<span class="term-fg32">+          description: Format deposit and L1-cost data in transaction responses. Add `debug_chainConfig` API.</span>
<span class="term-fg32">+          globs:</span>
<span class="term-fg32">+            - &quot;internal&#47;ethapi&#47;api.go&quot;</span>
<span class="term-fg32">+            - &quot;rpc&#47;errors.go&quot;</span>
<span class="term-fg32">+        - title: Tracer RPC daisy-chain</span>
<span class="term-fg32">+          description: Forward pre-bedrock tracing calls to legacy node.</span>
<span class="term-fg32">+          globs:</span>
<span class="term-fg32">+            - &quot;eth&#47;tracers&#47;api.go&quot;</span>
<span class="term-fg32">+        - title: &quot;Daisy Chain tests&quot;</span>
<span class="term-fg32">+          ignore:</span>
<span class="term-fg32">+            - &quot;internal&#47;ethapi&#47;transaction_args_test.go&quot;</span>
<span class="term-fg32">+            - &quot;ethclient&#47;ethclient_test.go&quot;</span>
<span class="term-fg32">+            - &quot;eth&#47;tracers&#47;api_test.go&quot;</span>
<span class="term-fg32">+        - title: Debug API</span>
<span class="term-fg32">+          description: Fix Debug API block marshaling to include deposits</span>
<span class="term-fg32">+          globs:</span>
<span class="term-fg32">+            - &quot;eth&#47;api_debug.go&quot;</span>
<span class="term-fg32">+        - title: Eth gasprice suggestions</span>
<span class="term-fg32">+          description: gasprice suggestion adjustments to accommodate faster L2 blocks and lower fees.</span>
<span class="term-fg32">+          globs:</span>
<span class="term-fg32">+            - &quot;eth&#47;gasprice&#47;gasprice.go&quot;</span>
<span class="term-fg32">+            - &quot;eth&#47;gasprice&#47;optimism-gasprice.go&quot;</span>
<span class="term-fg32">+        - title: API testvector fix</span>
<span class="term-fg32">+          description: |</span>
<span class="term-fg32">+            Upstream test of broken behavior; in Optimism, a zero signature is valid (pre-bedrock for deposit-txs),</span>
<span class="term-fg32">+            and the chain ID formula on signature data must not be used, or an underflow happens.</span>
<span class="term-fg32">+          globs:</span>
<span class="term-fg32">+            - &quot;internal&#47;ethapi&#47;testdata&#47;eth_getBlockByNumber-tag-pending-fullTx.json&quot;</span>
<span class="term-fg32">+    - title: &quot;Geth extras&quot;</span>
<span class="term-fg32">+      description: Extend the tools available in geth to improve external testing and tooling.</span>
<span class="term-fg32">+      sub:</span>
<span class="term-fg32">+        - title: Simulated Backend</span>
<span class="term-fg32">+          globs:</span>
<span class="term-fg32">+            - &quot;accounts&#47;abi&#47;bind&#47;backends&#47;simulated.go&quot;</span>
<span class="term-fg32">+            - &quot;ethclient&#47;simulated&#47;backend.go&quot;</span>
<span class="term-fg32">+        - title: Live tracer update</span>
<span class="term-fg32">+          description: |</span>
<span class="term-fg32">+            Track L1-deposited native currency that is coming into the L2 supply.</span>
<span class="term-fg32">+            The balance delta is considered to be a &quot;withdrawal&quot; from L1,</span>
<span class="term-fg32">+            similar to a withdrawal of the Beacon-chain into the Ethereum L1 execution chain.</span>
<span class="term-fg32">+          globs:</span>
<span class="term-fg32">+            - &quot;eth&#47;tracers&#47;live&#47;supply.go&quot;</span>
<span class="term-fg32">+    - title: &quot;Hardware wallet support&quot;</span>
<span class="term-fg32">+      description: Extend Ledger wallet support for newer devices on Macos</span>
<span class="term-fg32">+      sub:</span>
<span class="term-fg32">+        - title: Fix Ledger discoverability</span>
<span class="term-fg32">+          # upstream PR: https:&#47;&#47;github.com&#47;ethereum&#47;go-ethereum&#47;pull&#47;28863&#47;</span>
<span class="term-fg32">+          globs:</span>
<span class="term-fg32">+            - &quot;accounts&#47;usbwallet&#47;hub.go&quot;</span>
<span class="term-fg32">+    - title: &quot;Testing&quot;</span>
<span class="term-fg32">+      description: Additional or modified tests, not already captured by the above diff</span>
<span class="term-fg32">+      ignore:</span>
<span class="term-fg32">+        - &quot;**&#47;*_test.go&quot;</span>
<span class="term-fg32">+</span>
<span class="term-fg32">+# ignored globally, does not count towards line count</span>
<span class="term-fg32">+ignore:</span>
<span class="term-fg32">+  - &quot;.circleci&#47;*&quot;</span>
<span class="term-fg32">+  - &quot;*.sum&quot;</span>
<span class="term-fg32">+  - &quot;go.mod&quot;</span>
<span class="term-fg32">+  - &quot;fork.yaml&quot;</span>
<span class="term-fg32">+  - &quot;Makefile&quot;</span>
<span class="term-fg32">+  - &quot;.golangci.yml&quot;</span>
<span class="term-fg32">+  - &quot;.github&#47;**&quot;</span>
<span class="term-fg32">+  - &quot;**&#47;*.gob&quot; # data asset, not code</span>
<span class="term-fg32">+  - &quot;core&#47;vm&#47;testdata&#47;precompiles&#47;p256Verify.json&quot; # data asset, not code</span>
<span class="term-fg32">+  - &quot;eth&#47;tracers&#47;internal&#47;tracetest&#47;testdata&#47;**&#47;*.json&quot;</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-muted" data-bs-toggle="collapse" href="#id-e923ed88693c255b3a8dcfd1" role="button"
                       aria-expanded="false" aria-controls="id-e923ed88693c255b3a8dcfd1">
                        <code>go.mod</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/go.mod" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/go.mod" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-add-ignored">+21</span></div>
                            <div class="text-start"><span class="text-delete-ignored">-15</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-e923ed88693c255b3a8dcfd1"><span class="term-fg1">diff --git go-ethereum&#47;go.mod op-geth&#47;go.mod</span>
<span class="term-fg1">index a757b6705d2399efb8bacdb0ac8b372ddbbd42bf..0e7ab41f6dd9fc1f9e2a7d0a7ff87adf397d1b8f 100644</span>
<span class="term-fg1">--- go-ethereum&#47;go.mod</span>
<span class="term-fg1">+++ op-geth&#47;go.mod</span>
<span class="term-fg36">@@ -2,6 +2,8 @@</span> module github.com&#47;ethereum&#47;go-ethereum
&nbsp;
 go 1.21
&nbsp;
<span class="term-fg32">+toolchain go1.21.6</span>
<span class="term-fg32">+</span>
 require (
 	github.com&#47;Azure&#47;azure-sdk-for-go&#47;sdk&#47;storage&#47;azblob v1.2.0
 	github.com&#47;Microsoft&#47;go-winio v0.6.2
<span class="term-fg36">@@ -13,14 +15,15 @@</span> 	github.com&#47;aws&#47;aws-sdk-go-v2&#47;service&#47;route53 v1.30.2
 	github.com&#47;btcsuite&#47;btcd&#47;btcec&#47;v2 v2.2.0
 	github.com&#47;cespare&#47;cp v0.1.0
 	github.com&#47;cloudflare&#47;cloudflare-go v0.79.0
<span class="term-fg31">-	github.com&#47;cockroachdb&#47;pebble v1.1.1</span>
<span class="term-fg32">+	github.com&#47;cockroachdb&#47;pebble v0.0.0-20231018212520-f6cde3fc2fa4</span>
 	github.com&#47;consensys&#47;gnark-crypto v0.12.1
 	github.com&#47;crate-crypto&#47;go-ipa v0.0.0-20240223125850-b1e8a79f509c
 	github.com&#47;crate-crypto&#47;go-kzg-4844 v1.0.0
<span class="term-fg31">-	github.com&#47;davecgh&#47;go-spew v1.1.1</span>
<span class="term-fg32">+	github.com&#47;davecgh&#47;go-spew v1.1.2-0.20180830191138-d8f796af33cc</span>
 	github.com&#47;deckarep&#47;golang-set&#47;v2 v2.6.0
 	github.com&#47;donovanhide&#47;eventsource v0.0.0-20210830082556-c59027999da0
<span class="term-fg31">-	github.com&#47;dop251&#47;goja v0.0.0-20230605162241-28ee0ee714f3</span>
<span class="term-fg32">+	github.com&#47;dop251&#47;goja v0.0.0-20230806174421-c933cf95e127</span>
<span class="term-fg32">+	github.com&#47;ethereum-optimism&#47;superchain-registry&#47;superchain v0.0.0-20240812010938-34a43d577f74</span>
 	github.com&#47;ethereum&#47;c-kzg-4844 v1.0.0
 	github.com&#47;ethereum&#47;go-verkle v0.1.1-0.20240306133620-7d920df305f0
 	github.com&#47;fatih&#47;color v1.16.0
<span class="term-fg36">@@ -67,22 +70,23 @@</span> 	github.com&#47;syndtr&#47;goleveldb v1.0.1-0.20210819022825-2ae1ddf74ef7
 	github.com&#47;tyler-smith&#47;go-bip39 v1.1.0
 	github.com&#47;urfave&#47;cli&#47;v2 v2.25.7
 	go.uber.org&#47;automaxprocs v1.5.2
<span class="term-fg31">-	golang.org&#47;x&#47;crypto v0.22.0</span>
<span class="term-fg32">+	golang.org&#47;x&#47;crypto v0.25.0</span>
 	golang.org&#47;x&#47;exp v0.0.0-20231110203233-9a3e6036ecaa
 	golang.org&#47;x&#47;sync v0.7.0
<span class="term-fg31">-	golang.org&#47;x&#47;sys v0.20.0</span>
<span class="term-fg31">-	golang.org&#47;x&#47;text v0.14.0</span>
<span class="term-fg32">+	golang.org&#47;x&#47;sys v0.22.0</span>
<span class="term-fg32">+	golang.org&#47;x&#47;text v0.16.0</span>
 	golang.org&#47;x&#47;time v0.5.0
<span class="term-fg31">-	golang.org&#47;x&#47;tools v0.20.0</span>
<span class="term-fg32">+	golang.org&#47;x&#47;tools v0.21.1-0.20240508182429-e35e4ccd0d2d</span>
 	google.golang.org&#47;protobuf v1.33.0
<span class="term-fg31">-	gopkg.in&#47;natefinch&#47;lumberjack.v2 v2.2.1</span>
<span class="term-fg32">+	gopkg.in&#47;natefinch&#47;lumberjack.v2 v2.0.0</span>
 	gopkg.in&#47;yaml.v3 v3.0.1
 )
&nbsp;
 require (
 	github.com&#47;Azure&#47;azure-sdk-for-go&#47;sdk&#47;azcore v1.7.0 &#47;&#47; indirect
 	github.com&#47;Azure&#47;azure-sdk-for-go&#47;sdk&#47;internal v1.3.0 &#47;&#47; indirect
<span class="term-fg31">-	github.com&#47;DataDog&#47;zstd v1.4.5 &#47;&#47; indirect</span>
<span class="term-fg32">+	github.com&#47;BurntSushi&#47;toml v1.4.0 &#47;&#47; indirect</span>
<span class="term-fg32">+	github.com&#47;DataDog&#47;zstd v1.5.6-0.20230824185856-869dae002e5e &#47;&#47; indirect</span>
 	github.com&#47;StackExchange&#47;wmi v1.2.1 &#47;&#47; indirect
 	github.com&#47;aws&#47;aws-sdk-go-v2&#47;feature&#47;ec2&#47;imds v1.13.13 &#47;&#47; indirect
 	github.com&#47;aws&#47;aws-sdk-go-v2&#47;internal&#47;configsources v1.1.43 &#47;&#47; indirect
<span class="term-fg36">@@ -97,7 +101,6 @@</span> 	github.com&#47;beorn7&#47;perks v1.0.1 &#47;&#47; indirect
 	github.com&#47;bits-and-blooms&#47;bitset v1.10.0 &#47;&#47; indirect
 	github.com&#47;cespare&#47;xxhash&#47;v2 v2.3.0 &#47;&#47; indirect
 	github.com&#47;cockroachdb&#47;errors v1.11.3 &#47;&#47; indirect
<span class="term-fg31">-	github.com&#47;cockroachdb&#47;fifo v0.0.0-20240606204812-0bbfbd93a7ce &#47;&#47; indirect</span>
 	github.com&#47;cockroachdb&#47;logtags v0.0.0-20230118201751-21c54148d20b &#47;&#47; indirect
 	github.com&#47;cockroachdb&#47;redact v1.1.5 &#47;&#47; indirect
 	github.com&#47;cockroachdb&#47;tokenbucket v0.0.0-20230807174530-cc333fc44b06 &#47;&#47; indirect
<span class="term-fg36">@@ -118,7 +121,7 @@</span> 	github.com&#47;hashicorp&#47;go-cleanhttp v0.5.2 &#47;&#47; indirect
 	github.com&#47;hashicorp&#47;go-retryablehttp v0.7.4 &#47;&#47; indirect
 	github.com&#47;influxdata&#47;line-protocol v0.0.0-20200327222509-2487e7298839 &#47;&#47; indirect
 	github.com&#47;jmespath&#47;go-jmespath v0.4.0 &#47;&#47; indirect
<span class="term-fg31">-	github.com&#47;klauspost&#47;compress v1.16.0 &#47;&#47; indirect</span>
<span class="term-fg32">+	github.com&#47;klauspost&#47;compress v1.16.7 &#47;&#47; indirect</span>
 	github.com&#47;klauspost&#47;cpuid&#47;v2 v2.0.9 &#47;&#47; indirect
 	github.com&#47;kr&#47;pretty v0.3.1 &#47;&#47; indirect
 	github.com&#47;kr&#47;text v0.2.0 &#47;&#47; indirect
<span class="term-fg36">@@ -131,19 +134,22 @@</span> 	github.com&#47;mmcloughlin&#47;addchain v0.4.0 &#47;&#47; indirect
 	github.com&#47;naoina&#47;go-stringutil v0.1.0 &#47;&#47; indirect
 	github.com&#47;opentracing&#47;opentracing-go v1.1.0 &#47;&#47; indirect
 	github.com&#47;pkg&#47;errors v0.9.1 &#47;&#47; indirect
<span class="term-fg31">-	github.com&#47;pmezard&#47;go-difflib v1.0.0 &#47;&#47; indirect</span>
<span class="term-fg32">+	github.com&#47;pmezard&#47;go-difflib v1.0.1-0.20181226105442-5d4384ee4fb2 &#47;&#47; indirect</span>
 	github.com&#47;prometheus&#47;client_golang v1.12.0 &#47;&#47; indirect
 	github.com&#47;prometheus&#47;client_model v0.2.1-0.20210607210712-147c58e9608a &#47;&#47; indirect
 	github.com&#47;prometheus&#47;common v0.32.1 &#47;&#47; indirect
 	github.com&#47;prometheus&#47;procfs v0.7.3 &#47;&#47; indirect
 	github.com&#47;rivo&#47;uniseg v0.2.0 &#47;&#47; indirect
<span class="term-fg31">-	github.com&#47;rogpeppe&#47;go-internal v1.9.0 &#47;&#47; indirect</span>
<span class="term-fg32">+	github.com&#47;rogpeppe&#47;go-internal v1.10.0 &#47;&#47; indirect</span>
 	github.com&#47;russross&#47;blackfriday&#47;v2 v2.1.0 &#47;&#47; indirect
<span class="term-fg32">+	github.com&#47;stretchr&#47;objx v0.5.2 &#47;&#47; indirect</span>
 	github.com&#47;tklauser&#47;go-sysconf v0.3.12 &#47;&#47; indirect
 	github.com&#47;tklauser&#47;numcpus v0.6.1 &#47;&#47; indirect
 	github.com&#47;xrash&#47;smetrics v0.0.0-20201216005158-039620a65673 &#47;&#47; indirect
<span class="term-fg31">-	golang.org&#47;x&#47;mod v0.17.0 &#47;&#47; indirect</span>
<span class="term-fg31">-	golang.org&#47;x&#47;net v0.24.0 &#47;&#47; indirect</span>
<span class="term-fg32">+	golang.org&#47;x&#47;mod v0.19.0 &#47;&#47; indirect</span>
<span class="term-fg32">+	golang.org&#47;x&#47;net v0.25.0 &#47;&#47; indirect</span>
 	gopkg.in&#47;yaml.v2 v2.4.0 &#47;&#47; indirect
 	rsc.io&#47;tmplfunc v0.0.3 &#47;&#47; indirect
 )
<span class="term-fg32">+</span>
<span class="term-fg32">+&#47;&#47;replace github.com&#47;ethereum-optimism&#47;superchain-registry&#47;superchain =&gt; ..&#47;superchain-registry&#47;superchain</span></div>
    </div>

            
                <div class="border-bottom"><div class="row">
            <div class="col-12 col-md-4 text-start pe-2">
                
                    <a class="text-muted" data-bs-toggle="collapse" href="#id-9d0dac0754dc1e22cc367d7b" role="button"
                       aria-expanded="false" aria-controls="id-9d0dac0754dc1e22cc367d7b">
                        <code>go.sum</code>
                    </a>
                
            </div>

            <div class="col-12 col-sm-8 col-md-4 text-start px-2">
                <div class="row">
                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum/go-ethereum/blob/aa55f5ea200dfd07618fdf658d9d2741c3b376a8/go.sum" target="_blank">go-ethereum <i class="bi bi-github"></i></a>
                        
                    </div>

                    <div class="col-6">
                        
                            <a href="https://github.com/ethereum-optimism/op-geth/blob/d057ae92441bb4bcc101762e9089954fdc0c2664/go.sum" target="_blank">op-geth <i class="bi bi-github"></i></a>
                        
                    </div>
                </div>
            </div>

            <div class="col-12 col-sm-4 ms-auto ps-2">
                
                    <div class="row line-stat">
                        
                            <div class="text-end"><span class="text-add-ignored">+36</span></div>
                            <div class="text-start"><span class="text-delete-ignored">-29</span></div>
                        
                    </div>
                
            </div>
        </div>
        <div class="collapse patch-content term-container" id="id-9d0dac0754dc1e22cc367d7b"><span class="term-fg1">diff --git go-ethereum&#47;go.sum op-geth&#47;go.sum</span>
<span class="term-fg1">index 826f0f674f5a3827ea767e7c7e9fbee3ee9d5e87..095dfd6210767e7154328588f0ad307c96b734a4 100644</span>
<span class="term-fg1">--- go-ethereum&#47;go.sum</span>
<span class="term-fg1">+++ op-geth&#47;go.sum</span>
<span class="term-fg36">@@ -44,9 +44,11 @@</span> github.com&#47;Azure&#47;azure-sdk-for-go&#47;sdk&#47;storage&#47;azblob v1.2.0&#47;go.mod h1:+6KLcKIVgxoBDMqMO&#47;Nvy7bZ9a0nbU3I1DtFQK3YvB4=
 github.com&#47;AzureAD&#47;microsoft-authentication-library-for-go v1.0.0 h1:OBhqkivkhkMqLPymWEppkm7vgPQY2XsHoEkaMQ0AdZY=
 github.com&#47;AzureAD&#47;microsoft-authentication-library-for-go v1.0.0&#47;go.mod h1:kgDmCTgBzIEPFElEF+FK0SdjAor06dRq2Go927dnQ6o=
 github.com&#47;BurntSushi&#47;toml v0.3.1&#47;go.mod h1:xHWCNGjB5oqiDr8zfno3MHue2Ht5sIBksp03qcyfWMU=
<span class="term-fg32">+github.com&#47;BurntSushi&#47;toml v1.4.0 h1:kuoIxZQy2WRRk1pttg9asf+WVv6tWQuBNVmK8+nqPr0=</span>
<span class="term-fg32">+github.com&#47;BurntSushi&#47;toml v1.4.0&#47;go.mod h1:ukJfTF&#47;6rtPPRCnwkur4qwRxa8vTRFBF0uk2lLoLwho=</span>
 github.com&#47;BurntSushi&#47;xgb v0.0.0-20160522181843-27f122750802&#47;go.mod h1:IVnqGOEym&#47;WlBOVXweHU+Q+&#47;VP0lqqI8lqeDx9IjBqo=
<span class="term-fg31">-github.com&#47;DataDog&#47;zstd v1.4.5 h1:EndNeuB0l9syBZhut0wns3gV1hL8zX8LIu6ZiVHWLIQ=</span>
<span class="term-fg31">-github.com&#47;DataDog&#47;zstd v1.4.5&#47;go.mod h1:1jcaCB&#47;ufaK+sKp1NBhlGmpz41jOoPQ35bpF36t7BBo=</span>
<span class="term-fg32">+github.com&#47;DataDog&#47;zstd v1.5.6-0.20230824185856-869dae002e5e h1:ZIWapoIRN1VqT8GR8jAwb1Ie9GyehWjVcGh32Y2MznE=</span>
<span class="term-fg32">+github.com&#47;DataDog&#47;zstd v1.5.6-0.20230824185856-869dae002e5e&#47;go.mod h1:g4AWEaM3yOg3HYfnJ3YIawPnVdXJh9QME85blwSAmyw=</span>
 github.com&#47;Microsoft&#47;go-winio v0.6.2 h1:F2VQgta7ecxGYO8k3ZZz3RS8fVIXVxONVUPlNERoyfY=
 github.com&#47;Microsoft&#47;go-winio v0.6.2&#47;go.mod h1:yd8OoFMLzJbo9gZq8j5qaps8bJ9aShtEA8Ipt1oGCvU=
 github.com&#47;StackExchange&#47;wmi v1.2.1 h1:VIkavFPXSjcnS+O8yTq7NI32k0R5Aj+v39y29VYDOSA=
<span class="term-fg36">@@ -118,12 +120,10 @@</span> github.com&#47;cockroachdb&#47;datadriven v1.0.3-0.20230413201302-be42291fc80f h1:otljaYPt5hWxV3MUfO5dFPFiOXg9CyG5&#47;kCfayTqsJ4=
 github.com&#47;cockroachdb&#47;datadriven v1.0.3-0.20230413201302-be42291fc80f&#47;go.mod h1:a9RdTaap04u637JoCzcUoIcDmvwSUtcUFtT&#47;C3kJlTU=
 github.com&#47;cockroachdb&#47;errors v1.11.3 h1:5bA+k2Y6r+oz&#47;6Z&#47;RFlNeVCesGARKuC6YymtcDrbC&#47;I=
 github.com&#47;cockroachdb&#47;errors v1.11.3&#47;go.mod h1:m4UIW4CDjx+R5cybPsNrRbreomiFqt8o1h1wUVazSd8=
<span class="term-fg31">-github.com&#47;cockroachdb&#47;fifo v0.0.0-20240606204812-0bbfbd93a7ce h1:giXvy4KSc&#47;6g&#47;esnpM7Geqxka4WSqI1SZc7sMJFd3y4=</span>
<span class="term-fg31">-github.com&#47;cockroachdb&#47;fifo v0.0.0-20240606204812-0bbfbd93a7ce&#47;go.mod h1:9&#47;y3cnZ5GKakj&#47;H4y9r9GTjCvAFta7KLgSHPJJYc52M=</span>
 github.com&#47;cockroachdb&#47;logtags v0.0.0-20230118201751-21c54148d20b h1:r6VH0faHjZeQy818SGhaone5OnYfxFR&#47;+AzdY3sf5aE=
 github.com&#47;cockroachdb&#47;logtags v0.0.0-20230118201751-21c54148d20b&#47;go.mod h1:Vz9DsVWQQhf3vs21MhPMZpMGSht7O&#47;2vFW2xusFUVOs=
<span class="term-fg31">-github.com&#47;cockroachdb&#47;pebble v1.1.1 h1:XnKU22oiCLy2Xn8vp1re67cXg4SAasg&#47;WDt1NtcRFaw=</span>
<span class="term-fg31">-github.com&#47;cockroachdb&#47;pebble v1.1.1&#47;go.mod h1:4exszw1r40423ZsmkG&#47;09AFEG83I0uDgfujJdbL6kYU=</span>
<span class="term-fg32">+github.com&#47;cockroachdb&#47;pebble v0.0.0-20231018212520-f6cde3fc2fa4 h1:PuHFhOUMnD62r80dN+Ik5qco2drekgsUSVdcHsvllec=</span>
<span class="term-fg32">+github.com&#47;cockroachdb&#47;pebble v0.0.0-20231018212520-f6cde3fc2fa4&#47;go.mod h1:sEHm5NOXxyiAoKWhoFxT8xMgd&#47;f3RA6qUqQ1BXKrh2E=</span>
 github.com&#47;cockroachdb&#47;redact v1.1.5 h1:u1PMllDkdFfPWaNGMyLD1+so+aq3uUItthCFqzwPJ30=
 github.com&#47;cockroachdb&#47;redact v1.1.5&#47;go.mod h1:BVNblN9mBWFyMyqK1k3AAiSxhvhfK2oOZZ2lK+dpvRg=
 github.com&#47;cockroachdb&#47;tokenbucket v0.0.0-20230807174530-cc333fc44b06 h1:zuQyyAKVxetITBuuhv3BI9cMrmStnpT18zmgmTxunpo=
<span class="term-fg36">@@ -141,8 +141,9 @@</span> github.com&#47;crate-crypto&#47;go-kzg-4844 v1.0.0&#47;go.mod h1:1kMhvPgI0Ky3yIa+9lFySEBUBXkYxeOi8ZF1sYioxhc=
 github.com&#47;creack&#47;pty v1.1.9&#47;go.mod h1:oKZEueFk5CKHvIhNR5MUki03XCEU+Q6VDXinZuGJ33E=
 github.com&#47;cyberdelia&#47;templates v0.0.0-20141128023046-ca7fffd4298c&#47;go.mod h1:GyV+0YP4qX0UQ7r2MoYZ+AvYDp12OF5yg4q8rGnyNh4=
 github.com&#47;davecgh&#47;go-spew v1.1.0&#47;go.mod h1:J7Y8YcW2NihsgmVo&#47;mv3lAwl&#47;skON4iLHjSsI+c5H38=
<span class="term-fg31">-github.com&#47;davecgh&#47;go-spew v1.1.1 h1:vj9j&#47;u1bqnvCEfJOwUhtlOARqs3+rkHYY13jYWTU97c=</span>
 github.com&#47;davecgh&#47;go-spew v1.1.1&#47;go.mod h1:J7Y8YcW2NihsgmVo&#47;mv3lAwl&#47;skON4iLHjSsI+c5H38=
<span class="term-fg32">+github.com&#47;davecgh&#47;go-spew v1.1.2-0.20180830191138-d8f796af33cc h1:U9qPSI2PIWSS1VwoXQT9A3Wy9MM3WgvqSxFWenqJduM=</span>
<span class="term-fg32">+github.com&#47;davecgh&#47;go-spew v1.1.2-0.20180830191138-d8f796af33cc&#47;go.mod h1:J7Y8YcW2NihsgmVo&#47;mv3lAwl&#47;skON4iLHjSsI+c5H38=</span>
 github.com&#47;deckarep&#47;golang-set&#47;v2 v2.6.0 h1:XfcQbWM1LlMB8BsJ8N9vW5ehnnPVIw0je80NsVHagjM=
 github.com&#47;deckarep&#47;golang-set&#47;v2 v2.6.0&#47;go.mod h1:VAky9rY&#47;yGXJOLEDv3OMci+7wtDpOF4IN+y82NBOac4=
 github.com&#47;decred&#47;dcrd&#47;crypto&#47;blake256 v1.0.0 h1:&#47;8DMNYp9SGi5f0w7uCm6d6M4OU2rGFK09Y2A4Xv7EE0=
<span class="term-fg36">@@ -160,14 +161,16 @@</span> github.com&#47;dnaeon&#47;go-vcr v1.2.0&#47;go.mod h1:R4UdLID7HZT3taECzJs4YgbbH6PIGXB6W&#47;sc5OLb6RQ=
 github.com&#47;donovanhide&#47;eventsource v0.0.0-20210830082556-c59027999da0 h1:C7t6eeMaEQVy6e8CarIhscYQlNmw5e3G36y7l7Y21Ao=
 github.com&#47;donovanhide&#47;eventsource v0.0.0-20210830082556-c59027999da0&#47;go.mod h1:56wL82FO0bfMU5RvfXoIwSOP2ggqqxT+tAfNEIyxuHw=
 github.com&#47;dop251&#47;goja v0.0.0-20211022113120-dc8c55024d06&#47;go.mod h1:R9ET47fwRVRPZnOGvHxxhuZcbrMCuiqOz3Rlrh4KSnk=
<span class="term-fg31">-github.com&#47;dop251&#47;goja v0.0.0-20230605162241-28ee0ee714f3 h1:+3HCtB74++ClLy8GgjUQYeC8R4ILzVcIe8+5edAJJnE=</span>
<span class="term-fg31">-github.com&#47;dop251&#47;goja v0.0.0-20230605162241-28ee0ee714f3&#47;go.mod h1:QMWlm50DNe14hD7t24KEqZuUdC9sOTy8W6XbCU1mlw4=</span>
<span class="term-fg32">+github.com&#47;dop251&#47;goja v0.0.0-20230806174421-c933cf95e127 h1:qwcF+vdFrvPSEUDSX5RVoRccG8a5DhOdWdQ4zN62zzo=</span>
<span class="term-fg32">+github.com&#47;dop251&#47;goja v0.0.0-20230806174421-c933cf95e127&#47;go.mod h1:QMWlm50DNe14hD7t24KEqZuUdC9sOTy8W6XbCU1mlw4=</span>
 github.com&#47;dop251&#47;goja_nodejs v0.0.0-20210225215109-d91c329300e7&#47;go.mod h1:hn7BA7c8pLvoGndExHudxTDKZ84Pyvv+90pbBjbTz0Y=
 github.com&#47;dop251&#47;goja_nodejs v0.0.0-20211022123610-8dd9abb0616d&#47;go.mod h1:DngW8aVqWbuLRMHItjPUyqdj+HWPvnQe8V8y1nDpIbM=
 github.com&#47;envoyproxy&#47;go-control-plane v0.9.0&#47;go.mod h1:YTl&#47;9mNaCwkRvm6d1a2C3ymFceY&#47;DCBVvsKhRF0iEA4=
 github.com&#47;envoyproxy&#47;go-control-plane v0.9.1-0.20191026205805-5f8ba28d4473&#47;go.mod h1:YTl&#47;9mNaCwkRvm6d1a2C3ymFceY&#47;DCBVvsKhRF0iEA4=
 github.com&#47;envoyproxy&#47;go-control-plane v0.9.4&#47;go.mod h1:6rpuAdCZL397s3pYoYcLgu1mIlRU8Am5FuJP05cCM98=
 github.com&#47;envoyproxy&#47;protoc-gen-validate v0.1.0&#47;go.mod h1:iSmxcyjqTsJpI2R4NaDN7+kN2VEUnK&#47;pcBlmesArF7c=
<span class="term-fg32">+github.com&#47;ethereum-optimism&#47;superchain-registry&#47;superchain v0.0.0-20240812010938-34a43d577f74 h1:HQZQalpPUXs9qnJgDmEDzpPO70Z1p8Le2l0bZ9eJjCk=</span>
<span class="term-fg32">+github.com&#47;ethereum-optimism&#47;superchain-registry&#47;superchain v0.0.0-20240812010938-34a43d577f74&#47;go.mod h1:zy9f3TNPS7pwW4msMitF83fp0Wf452tZ6+Fg6d4JyXM=</span>
 github.com&#47;ethereum&#47;c-kzg-4844 v1.0.0 h1:0X1LBXxaEtYD9xsyj9B9ctQEZIpnvVDeoBx8aHEwTNA=
 github.com&#47;ethereum&#47;c-kzg-4844 v1.0.0&#47;go.mod h1:VewdlzQmpT5QSrVhbBuGoCdFJkpaJlO1aQputP83wc0=
 github.com&#47;ethereum&#47;go-verkle v0.1.1-0.20240306133620-7d920df305f0 h1:KrE8I4reeVvf7C1tm8elRjj4BdscTYzz&#47;WAbYyf&#47;JI4=
<span class="term-fg36">@@ -267,8 +270,8 @@</span> github.com&#47;google&#47;go-cmp v0.5.2&#47;go.mod h1:v8dTdLbMG2kIc&#47;vJvl+f65V22dbkXbowE6jgT&#47;gNBxE=
 github.com&#47;google&#47;go-cmp v0.5.4&#47;go.mod h1:v8dTdLbMG2kIc&#47;vJvl+f65V22dbkXbowE6jgT&#47;gNBxE=
 github.com&#47;google&#47;go-cmp v0.5.5&#47;go.mod h1:v8dTdLbMG2kIc&#47;vJvl+f65V22dbkXbowE6jgT&#47;gNBxE=
 github.com&#47;google&#47;go-cmp v0.5.8&#47;go.mod h1:17dUlkBOakJ0+DkrSSNjCkIjxS6bF9zb3elmeNGIjoY=
<span class="term-fg31">-github.com&#47;google&#47;go-cmp v0.5.9 h1:O2Tfq5qg4qc4AmwVlvv0oLiVAGB7enBSJ2x2DqQFi38=</span>
<span class="term-fg31">-github.com&#47;google&#47;go-cmp v0.5.9&#47;go.mod h1:17dUlkBOakJ0+DkrSSNjCkIjxS6bF9zb3elmeNGIjoY=</span>
<span class="term-fg32">+github.com&#47;google&#47;go-cmp v0.6.0 h1:ofyhxvXcZhMsU5ulbFiLKl&#47;XBFqE1GSq7atu8tAmTRI=</span>
<span class="term-fg32">+github.com&#47;google&#47;go-cmp v0.6.0&#47;go.mod h1:17dUlkBOakJ0+DkrSSNjCkIjxS6bF9zb3elmeNGIjoY=</span>
 github.com&#47;google&#47;go-querystring v1.1.0 h1:AnCroh3fv4ZBgVIf1Iwtovgjaw&#47;GiKJo8M8yD&#47;fhyJ8=
 github.com&#47;google&#47;go-querystring v1.1.0&#47;go.mod h1:Kcdr2DB4koayq7X8pmAG4sNG59So17icRSOU623lUBU=
 github.com&#47;google&#47;gofuzz v1.0.0&#47;go.mod h1:dBl0BpW6vV&#47;+mYPU4Po3pmUjxk6FQPldtuIdl&#47;M65Eg=
<span class="term-fg36">@@ -349,8 +352,8 @@</span> github.com&#47;kilic&#47;bls12-381 v0.1.0 h1:encrdjqKMEvabVQ7qYOKu1OvhqpK4s47wDYtNiPtlp4=
 github.com&#47;kilic&#47;bls12-381 v0.1.0&#47;go.mod h1:vDTTHJONJ6G+P2R74EhnyotQDTliQDnFEwhdmfzw1ig=
 github.com&#47;kisielk&#47;errcheck v1.5.0&#47;go.mod h1:pFxgyoBC7bSaBwPgfKdkLd5X25qrDl4LWUI2bnpBCr8=
 github.com&#47;kisielk&#47;gotool v1.0.0&#47;go.mod h1:XhKaO+MFFWcvkIS&#47;tQcRk01m1F5IRFswLeQ+oQHNcck=
<span class="term-fg31">-github.com&#47;klauspost&#47;compress v1.16.0 h1:iULayQNOReoYUe+1qtKOqw9CwJv3aNQu8ivo7lw1HU4=</span>
<span class="term-fg31">-github.com&#47;klauspost&#47;compress v1.16.0&#47;go.mod h1:ntbaceVETuRiXiv4DpjP66DpAtAGkEQskQzEyD&#47;&#47;IeE=</span>
<span class="term-fg32">+github.com&#47;klauspost&#47;compress v1.16.7 h1:2mk3MPGNzKyxErAw8YaohYh69+pa4sIQSC0fPGCFR9I=</span>
<span class="term-fg32">+github.com&#47;klauspost&#47;compress v1.16.7&#47;go.mod h1:ntbaceVETuRiXiv4DpjP66DpAtAGkEQskQzEyD&#47;&#47;IeE=</span>
 github.com&#47;klauspost&#47;cpuid&#47;v2 v2.0.4&#47;go.mod h1:FInQzS24&#47;EEf25PyTYn52gqo7WaD8xa0213Md&#47;qVLRg=
 github.com&#47;klauspost&#47;cpuid&#47;v2 v2.0.9 h1:lgaqFMSdTdQYdZ04uHyN2d&#47;eKdOMyi2YLSvlQIBFYa4=
 github.com&#47;klauspost&#47;cpuid&#47;v2 v2.0.9&#47;go.mod h1:FInQzS24&#47;EEf25PyTYn52gqo7WaD8xa0213Md&#47;qVLRg=
<span class="term-fg36">@@ -437,8 +440,9 @@</span> github.com&#47;pkg&#47;errors v0.8.0&#47;go.mod h1:bwawxfHBFNV+L2hUp1rHADufV3IMtnDRdf1r5NINEl0=
 github.com&#47;pkg&#47;errors v0.8.1&#47;go.mod h1:bwawxfHBFNV+L2hUp1rHADufV3IMtnDRdf1r5NINEl0=
 github.com&#47;pkg&#47;errors v0.9.1 h1:FEBLx1zS214owpjy7qsBeixbURkuhQAwrK5UwLGTwt4=
 github.com&#47;pkg&#47;errors v0.9.1&#47;go.mod h1:bwawxfHBFNV+L2hUp1rHADufV3IMtnDRdf1r5NINEl0=
<span class="term-fg31">-github.com&#47;pmezard&#47;go-difflib v1.0.0 h1:4DBwDE0NGyQoBHbLQYPwSUPoCMWR5BEzIk&#47;f1lZbAQM=</span>
 github.com&#47;pmezard&#47;go-difflib v1.0.0&#47;go.mod h1:iKH77koFhYxTK1pcRnkKkqfTogsbg7gZNVY4sRDYZ&#47;4=
<span class="term-fg32">+github.com&#47;pmezard&#47;go-difflib v1.0.1-0.20181226105442-5d4384ee4fb2 h1:Jamvg5psRIccs7FGNTlIRMkT8wgtp5eCXdBlqhYGL6U=</span>
<span class="term-fg32">+github.com&#47;pmezard&#47;go-difflib v1.0.1-0.20181226105442-5d4384ee4fb2&#47;go.mod h1:iKH77koFhYxTK1pcRnkKkqfTogsbg7gZNVY4sRDYZ&#47;4=</span>
 github.com&#47;prashantv&#47;gostub v1.1.0 h1:BTyx3RfQjRHnUWaGF9oQos79AlQ5k8WNktv7VGvVH4g=
 github.com&#47;prashantv&#47;gostub v1.1.0&#47;go.mod h1:A5zLQHz7ieHGG7is6LLXLz7I8+3LZzsrV0P1IAHhP5U=
 github.com&#47;prometheus&#47;client_golang v0.9.1&#47;go.mod h1:7SWBe2y4D6OKWSNQJUaRYU&#47;AaXPKyh&#47;dDVn+NZz0KFw=
<span class="term-fg36">@@ -476,8 +480,9 @@</span> github.com&#47;rivo&#47;uniseg v0.2.0 h1:S1pD9weZBuJdFmowNwbpi7BJ8TNftyUImj&#47;0WQi72jY=
 github.com&#47;rivo&#47;uniseg v0.2.0&#47;go.mod h1:J6wj4VEh+S6ZtnVlnTBMWIodfgj8LQOQFoIToxlJtxc=
 github.com&#47;rogpeppe&#47;go-internal v1.3.0&#47;go.mod h1:M8bDsm7K2OlrFYOpmOWEs&#47;qY81heoFRclV5y23lUDJ4=
 github.com&#47;rogpeppe&#47;go-internal v1.6.1&#47;go.mod h1:xXDCJY+GAPziupqXw64V24skbSoqbTEfhy4qGm1nDQc=
<span class="term-fg31">-github.com&#47;rogpeppe&#47;go-internal v1.9.0 h1:73kH8U+JUqXU8lRuOHeVHaa&#47;SZPifC7BkcraZVejAe8=</span>
 github.com&#47;rogpeppe&#47;go-internal v1.9.0&#47;go.mod h1:WtVeX8xhTBvf0smdhujwtBcq4Qrzq&#47;fJaraNFVN+nFs=
<span class="term-fg32">+github.com&#47;rogpeppe&#47;go-internal v1.10.0 h1:TMyTOH3F&#47;DB16zRVcYyreMH6GnZZrwQVAoYjRBZyWFQ=</span>
<span class="term-fg32">+github.com&#47;rogpeppe&#47;go-internal v1.10.0&#47;go.mod h1:UQnix2H7Ngw&#47;k4C5ijL5+65zddjncjaFoBhdsK&#47;akog=</span>
 github.com&#47;rs&#47;cors v1.7.0 h1:+88SsELBHx5r+hZ8TCkggzSstaWNbDvThkVK8H6f9ik=
 github.com&#47;rs&#47;cors v1.7.0&#47;go.mod h1:gFx+x8UowdsKA9AchylcLynDq+nNFfI8FkUZdN&#47;jGCU=
 github.com&#47;russross&#47;blackfriday&#47;v2 v2.1.0 h1:JIOH55&#47;0cWyOuilr9&#47;qlrm0BSXldqnqwMsf35Ld67mk=
<span class="term-fg36">@@ -491,6 +496,8 @@</span> github.com&#47;status-im&#47;keycard-go v0.2.0 h1:QDLFswOQu1r5jsycloeQh3bVU8n&#47;NatHHaZobtDnDzA=
 github.com&#47;status-im&#47;keycard-go v0.2.0&#47;go.mod h1:wlp8ZLbsmrF6g6WjugPAx+IzoLrkdf9+mHxBEeo3Hbg=
 github.com&#47;stretchr&#47;objx v0.1.0&#47;go.mod h1:HFkY916IF+rwdDfMAkV7OtwuqBVzrE8GR6GFx+wExME=
 github.com&#47;stretchr&#47;objx v0.1.1&#47;go.mod h1:HFkY916IF+rwdDfMAkV7OtwuqBVzrE8GR6GFx+wExME=
<span class="term-fg32">+github.com&#47;stretchr&#47;objx v0.5.2 h1:xuMeJ0Sdp5ZMRXx&#47;aWO6RZxdr3beISkG5&#47;G&#47;aIRr3pY=</span>
<span class="term-fg32">+github.com&#47;stretchr&#47;objx v0.5.2&#47;go.mod h1:FRsXN1f5AsAjCGJKqEizvkpNtU+EGNCLh3NxZ&#47;8L+MA=</span>
 github.com&#47;stretchr&#47;testify v1.2.2&#47;go.mod h1:a8OnRcib4nhh0OaRAV+Yts87kKdq0PP7pXfy6kDkUVs=
 github.com&#47;stretchr&#47;testify v1.3.0&#47;go.mod h1:M5WIy9Dh21IEIfnGCwXGc5bZfKNJtfHm1UVUgZn+9EI=
 github.com&#47;stretchr&#47;testify v1.4.0&#47;go.mod h1:j7eGeouHqKxXV5pUuKE4zz7dFj8WfuZ+81PSLYec5m4=
<span class="term-fg36">@@ -536,8 +543,8 @@</span> golang.org&#47;x&#47;crypto v0.0.0-20200622213623-75b288015ac9&#47;go.mod h1:LzIPMQfyMNhhGPhUkYOs5KpL4U8rLKemX1yGLhDgUto=
 golang.org&#47;x&#47;crypto v0.0.0-20200820211705-5c72a883971a&#47;go.mod h1:LzIPMQfyMNhhGPhUkYOs5KpL4U8rLKemX1yGLhDgUto=
 golang.org&#47;x&#47;crypto v0.0.0-20201221181555-eec23a3978ad&#47;go.mod h1:jdWPYTVW3xRLrWPugEBEK3UY2ZEsg3UU495nc5E+M+I=
 golang.org&#47;x&#47;crypto v0.0.0-20210921155107-089bfa567519&#47;go.mod h1:GvvjBRRGRdwPK5ydBHafDWAxML&#47;pGHZbMvKqRZ5+Abc=
<span class="term-fg31">-golang.org&#47;x&#47;crypto v0.22.0 h1:g1v0xeRhjcugydODzvb3mEM9SQ0HGp9s&#47;nh3COQ&#47;C30=</span>
<span class="term-fg31">-golang.org&#47;x&#47;crypto v0.22.0&#47;go.mod h1:vr6Su+7cTlO45qkww3VDJlzDn0ctJvRgYbC2NvXHt+M=</span>
<span class="term-fg32">+golang.org&#47;x&#47;crypto v0.25.0 h1:ypSNr+bnYL2YhwoMt2zPxHFmbAN1KZs&#47;njMG3hxUp30=</span>
<span class="term-fg32">+golang.org&#47;x&#47;crypto v0.25.0&#47;go.mod h1:T+wALwcMOSE0kXgUAnPAHqTLW+XHgcELELW8VaDgm&#47;M=</span>
 golang.org&#47;x&#47;exp v0.0.0-20190121172915-509febef88a4&#47;go.mod h1:CJ0aWSM057203Lf6IL+f9T1iT9GByDxfZKAQTCR3kQA=
 golang.org&#47;x&#47;exp v0.0.0-20190306152737-a1d7652674e8&#47;go.mod h1:CJ0aWSM057203Lf6IL+f9T1iT9GByDxfZKAQTCR3kQA=
 golang.org&#47;x&#47;exp v0.0.0-20190510132918-efd6b22b2522&#47;go.mod h1:ZjyILWgesfNpC6sMxTJOJm9Kp84zZh5NQWvqDGG3Qr8=
<span class="term-fg36">@@ -571,8 +578,8 @@</span> golang.org&#47;x&#47;mod v0.1.1-0.20191107180719-034126e5016b&#47;go.mod h1:QqPTAvyqsEbceGzBzNggFXnrqF1CaUcvgkdR5Ot7KZg=
 golang.org&#47;x&#47;mod v0.2.0&#47;go.mod h1:s0Qsj1ACt9ePp&#47;hMypM3fl4fZqREWJwdYDEqhRiZZUA=
 golang.org&#47;x&#47;mod v0.3.0&#47;go.mod h1:s0Qsj1ACt9ePp&#47;hMypM3fl4fZqREWJwdYDEqhRiZZUA=
 golang.org&#47;x&#47;mod v0.6.0-dev.0.20220419223038-86c51ed26bb4&#47;go.mod h1:jJ57K6gSWd91VN4djpZkiMVwK6gcyfeH4XE8wZrZaV4=
<span class="term-fg31">-golang.org&#47;x&#47;mod v0.17.0 h1:zY54UmvipHiNd+pm+m0x9KhZ9hl1&#47;7QNMyxXbc6ICqA=</span>
<span class="term-fg31">-golang.org&#47;x&#47;mod v0.17.0&#47;go.mod h1:hTbmBsO62+eylJbnUtE2MGJUyE7QWk4xUqPFrRgJ+7c=</span>
<span class="term-fg32">+golang.org&#47;x&#47;mod v0.19.0 h1:fEdghXQSo20giMthA7cd28ZC+jts4amQ3YMXiP5oMQ8=</span>
<span class="term-fg32">+golang.org&#47;x&#47;mod v0.19.0&#47;go.mod h1:hTbmBsO62+eylJbnUtE2MGJUyE7QWk4xUqPFrRgJ+7c=</span>
 golang.org&#47;x&#47;net v0.0.0-20180724234803-3673e40ba225&#47;go.mod h1:mL1N&#47;T3taQHkDXs73rZJwtUhF3w3ftmwwsq0BUmARs4=
 golang.org&#47;x&#47;net v0.0.0-20180826012351-8a410e7b638d&#47;go.mod h1:mL1N&#47;T3taQHkDXs73rZJwtUhF3w3ftmwwsq0BUmARs4=
 golang.org&#47;x&#47;net v0.0.0-20180906233101-161cd47e91fd&#47;go.mod h1:mL1N&#47;T3taQHkDXs73rZJwtUhF3w3ftmwwsq0BUmARs4=
<span class="term-fg36">@@ -609,8 +616,8 @@</span> golang.org&#47;x&#47;net v0.0.0-20210119194325-5f4716e94777&#47;go.mod h1:m0MpNAwzfU5UDzcl9v0D8zg8gWTRqZa9RBIspLL5mdg=
 golang.org&#47;x&#47;net v0.0.0-20210226172049-e18ecbb05110&#47;go.mod h1:m0MpNAwzfU5UDzcl9v0D8zg8gWTRqZa9RBIspLL5mdg=
 golang.org&#47;x&#47;net v0.0.0-20210525063256-abc453219eb5&#47;go.mod h1:9nx3DQGgdP8bBQD5qxJ1jj9UTztislL4KSBs9R2vV5Y=
 golang.org&#47;x&#47;net v0.0.0-20220722155237-a158d28d115b&#47;go.mod h1:XRhObCWvk6IyKnWLug+ECip1KBveYUHfp+8e9klMJ9c=
<span class="term-fg31">-golang.org&#47;x&#47;net v0.24.0 h1:1PcaxkF854Fu3+lvBIx5SYn9wRlBzzcnHZSiaFFAb0w=</span>
<span class="term-fg31">-golang.org&#47;x&#47;net v0.24.0&#47;go.mod h1:2Q7sJY5mzlzWjKtYUEXSlBWCdyaioyXzRB2RtU8KVE8=</span>
<span class="term-fg32">+golang.org&#47;x&#47;net v0.25.0 h1:d&#47;OCCoBEUq33pjydKrGQhw7IlUPI2Oylr+8qLx49kac=</span>
<span class="term-fg32">+golang.org&#47;x&#47;net v0.25.0&#47;go.mod h1:JkAGAh7GEvH74S6FOH42FLoXpXbE&#47;aqXSrIQjXgsiwM=</span>
 golang.org&#47;x&#47;oauth2 v0.0.0-20180821212333-d2e6202438be&#47;go.mod h1:N&#47;0e6XlmueqKjAGxoOufVs8QHGRruUQn6yWY3a++T0U=
 golang.org&#47;x&#47;oauth2 v0.0.0-20190226205417-e64efc72b421&#47;go.mod h1:gOpvHmFTYa4IltrdGE7lF6nIHvwfUNPOp7c8zoXwtLw=
 golang.org&#47;x&#47;oauth2 v0.0.0-20190604053449-0f29369cfe45&#47;go.mod h1:gOpvHmFTYa4IltrdGE7lF6nIHvwfUNPOp7c8zoXwtLw=
<span class="term-fg36">@@ -692,8 +699,8 @@</span> golang.org&#47;x&#47;sys v0.6.0&#47;go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=
 golang.org&#47;x&#47;sys v0.8.0&#47;go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=
 golang.org&#47;x&#47;sys v0.11.0&#47;go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=
 golang.org&#47;x&#47;sys v0.14.0&#47;go.mod h1:&#47;VUhepiaJMQUp4+oa&#47;7Zr1D23ma6VTLIYjOOTFZPUcA=
<span class="term-fg31">-golang.org&#47;x&#47;sys v0.20.0 h1:Od9JTbYCk261bKm4M&#47;mw7AklTlFYIa0bIp9BgSm1S8Y=</span>
<span class="term-fg31">-golang.org&#47;x&#47;sys v0.20.0&#47;go.mod h1:&#47;VUhepiaJMQUp4+oa&#47;7Zr1D23ma6VTLIYjOOTFZPUcA=</span>
<span class="term-fg32">+golang.org&#47;x&#47;sys v0.22.0 h1:RI27ohtqKCnwULzJLqkv897zojh5&#47;DwS&#47;ENaMzUOaWI=</span>
<span class="term-fg32">+golang.org&#47;x&#47;sys v0.22.0&#47;go.mod h1:&#47;VUhepiaJMQUp4+oa&#47;7Zr1D23ma6VTLIYjOOTFZPUcA=</span>
 golang.org&#47;x&#47;term v0.0.0-20201117132131-f5c789dd3221&#47;go.mod h1:Nr5EML6q2oocZ2LXRh80K7BxOlk5&#47;8JxuGnuhpl+muw=
 golang.org&#47;x&#47;term v0.0.0-20201126162022-7de9c90e9dd1&#47;go.mod h1:bj7SfCRtBDWHUb9snDiAeCFNEtKQo2Wmx5Cou7ajbmo=
 golang.org&#47;x&#47;term v0.0.0-20210927222741-03fcf44c2211&#47;go.mod h1:jbD1KX2456YbFQfuXm&#47;mYQcufACuNUgVhRMnK&#47;tPxf8=
<span class="term-fg36">@@ -706,8 +713,8 @@</span> golang.org&#47;x&#47;text v0.3.5&#47;go.mod h1:5Zoc&#47;QRtKVWzQhOtBMvqHzDpF6irO9z98xDceosuGiQ=
 golang.org&#47;x&#47;text v0.3.6&#47;go.mod h1:5Zoc&#47;QRtKVWzQhOtBMvqHzDpF6irO9z98xDceosuGiQ=
 golang.org&#47;x&#47;text v0.3.7&#47;go.mod h1:u+2+&#47;6zg+i71rQMx5EYifcz6MCKuco9NR6JIITiCfzQ=
 golang.org&#47;x&#47;text v0.3.8&#47;go.mod h1:E6s5w1FMmriuDzIBO73fBruAKo1PCIq6d2Q6DHfQ8WQ=
<span class="term-fg31">-golang.org&#47;x&#47;text v0.14.0 h1:ScX5w1eTa3QqT8oi6+ziP7dTV1S2+ALU0bI+0zXKWiQ=</span>
<span class="term-fg31">-golang.org&#47;x&#47;text v0.14.0&#47;go.mod h1:18ZOQIKpY8NJVqYksKHtTdi31H5itFRjB5&#47;qKTNYzSU=</span>
<span class="term-fg32">+golang.org&#47;x&#47;text v0.16.0 h1:a94ExnEXNtEwYLGJSIUxnWoxoRz&#47;ZcCsV63ROupILh4=</span>
<span class="term-fg32">+golang.org&#47;x&#47;text v0.16.0&#47;go.mod h1:GhwF1Be+LQoKShO3cGOHzqOgRrGaYc9AvblQOmPVHnI=</span>
 golang.org&#47;x&#47;time v0.0.0-20181108054448-85acf8d2951c&#47;go.mod h1:tRJNPiyCQ0inRvYxbN9jk5I+vvW&#47;OXSQhTDSoE431IQ=
 golang.org&#47;x&#47;time v0.0.0-20190308202827-9d24e82272b4&#47;go.mod h1:tRJNPiyCQ0inRvYxbN9jk5I+vvW&#47;OXSQhTDSoE431IQ=
 golang.org&#47;x&#47;time v0.0.0-20191024005414-555d28b269f0&#47;go.mod h1:tRJNPiyCQ0inRvYxbN9jk5I+vvW&#47;OXSQhTDSoE431IQ=
<span class="term-fg36">@@ -758,8 +765,8 @@</span> golang.org&#47;x&#47;tools v0.0.0-20200804011535-6c149bb5ef0d&#47;go.mod h1:njjCfa9FT2d7l9Bc6FUM5FLjQPp3cFF28FI3qnDFljA=
 golang.org&#47;x&#47;tools v0.0.0-20200825202427-b303f430e36d&#47;go.mod h1:njjCfa9FT2d7l9Bc6FUM5FLjQPp3cFF28FI3qnDFljA=
 golang.org&#47;x&#47;tools v0.0.0-20210106214847-113979e3529a&#47;go.mod h1:emZCQorbCU4vsT4fOWvOPXz4eW1wZW4PmDk9uLelYpA=
 golang.org&#47;x&#47;tools v0.1.12&#47;go.mod h1:hNGJHUnrk76NpqgfD5Aqm5Crs+Hm0VOH&#47;i9J2+nxYbc=
<span class="term-fg31">-golang.org&#47;x&#47;tools v0.20.0 h1:hz&#47;CVckiOxybQvFw6h7b&#47;q80NTr9IUQb4s1IIzW7KNY=</span>
<span class="term-fg31">-golang.org&#47;x&#47;tools v0.20.0&#47;go.mod h1:WvitBU7JJf6A4jOdg4S1tviW9bhUxkgeCui&#47;0JHctQg=</span>
<span class="term-fg32">+golang.org&#47;x&#47;tools v0.21.1-0.20240508182429-e35e4ccd0d2d h1:vU5i&#47;LfpvrRCpgM&#47;VPfJLg5KjxD3E+hfT1SH+d9zLwg=</span>
<span class="term-fg32">+golang.org&#47;x&#47;tools v0.21.1-0.20240508182429-e35e4ccd0d2d&#47;go.mod h1:aiJjzUbINMkxbQROHiO6hDPo2LHcIPhhQsa9DLh0yGk=</span>
 golang.org&#47;x&#47;xerrors v0.0.0-20190717185122-a985d3407aa7&#47;go.mod h1:I&#47;5z698sn9Ka8TeJc9MKroUUfqBBauWjQqLJ2OPfmY0=
 golang.org&#47;x&#47;xerrors v0.0.0-20191011141410-1b5146add898&#47;go.mod h1:I&#47;5z698sn9Ka8TeJc9MKroUUfqBBauWjQqLJ2OPfmY0=
 golang.org&#47;x&#47;xerrors v0.0.0-20191204190536-9bdfabe68543&#47;go.mod h1:I&#47;5z698sn9Ka8TeJc9MKroUUfqBBauWjQqLJ2OPfmY0=
<span class="term-fg36">@@ -850,8 +857,8 @@</span> gopkg.in&#47;check.v1 v1.0.0-20201130134442-10cb98267c6c h1:Hei&#47;4ADfdWqJk1ZMxUNpqntNwaWcugrBjAiHlqqRiVk=
 gopkg.in&#47;check.v1 v1.0.0-20201130134442-10cb98267c6c&#47;go.mod h1:JHkPIbrfpd72SG&#47;EVd6muEfDQjcINNoR0C8j2r3qZ4Q=
 gopkg.in&#47;errgo.v2 v2.1.0&#47;go.mod h1:hNsd1EY+bozCKY1Ytp96fpM3vjJbqLJn88ws8XvfDNI=
 gopkg.in&#47;fsnotify.v1 v1.4.7&#47;go.mod h1:Tz8NjZHkW78fSQdbUxIjBTcgA1z1m8ZHf0WmKUhAMys=
<span class="term-fg31">-gopkg.in&#47;natefinch&#47;lumberjack.v2 v2.2.1 h1:bBRl1b0OH9s&#47;DuPhuXpNl+VtCaJXFZ5&#47;uEFST95x9zc=</span>
<span class="term-fg31">-gopkg.in&#47;natefinch&#47;lumberjack.v2 v2.2.1&#47;go.mod h1:YD8tP3GAjkrDg1eZH7EGmyESg&#47;lsYskCTPBJVb9jqSc=</span>
<span class="term-fg32">+gopkg.in&#47;natefinch&#47;lumberjack.v2 v2.0.0 h1:1Lc07Kr7qY4U2YPouBjpCLxpiyxIVoxqXgkXLknAOE8=</span>
<span class="term-fg32">+gopkg.in&#47;natefinch&#47;lumberjack.v2 v2.0.0&#47;go.mod h1:l0ndWWf7gzL7RNwBG7wST&#47;UCcT4T24xpD6X8LsfU&#47;+k=</span>
 gopkg.in&#47;tomb.v1 v1.0.0-20141024135613-dd632973f1e7 h1:uRGJdciOHaEIrze2W8Q3AKkepLTh2hOroT7a+7czfdQ=
 gopkg.in&#47;tomb.v1 v1.0.0-20141024135613-dd632973f1e7&#47;go.mod h1:dt&#47;ZhP58zS4L8KSrWDmTeBkI65Dw0HsyUHuEVlX15mw=
 gopkg.in&#47;yaml.v2 v2.2.1&#47;go.mod h1:hI93XBmqTisBFMUTm0b8Fm+jr3Dg1NNxqwp+5A1VGuI=</div>
    </div>

            
        </div>
        <div>
            
        </div>
    </div>
</div>

                
            </div>
        </main>
    </div>

    <footer class="col-xl-10 col-xxl-8 mx-auto px-3 pt-5 my-5 text-muted border-top">
        <p>Fork-diff overview of <a href="https://github.com/ethereum-optimism/op-geth"><code>op-geth</code></a>, a fork of <a href="https://github.com/ethereum/go-ethereum"><code>go-ethereum</code></a>.
and execution-engine of the <a href="https://github.com/ethereum-optimism/optimism">OP-stack</a>.</p>

    </footer>

    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js" integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.min.js" integrity="sha384-mQ93GR66B00ZXjt0YO5KlohRA5SY2XofN4zfuZxLkoj1gXtW8ANNCe9d5Y3eG5eD" crossorigin="anonymous"></script>
    <script type="text/javascript">
        const storedTheme = localStorage.getItem('theme')

        // Get the preferred theme from the user's OS
        const getPreferredTheme = () => {
            if (storedTheme) {
                return storedTheme
            }

            return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light'
        }

        // Set the bootstrap theme
        const setTheme = function (theme) {
            document.documentElement.setAttribute('data-bs-theme', theme)
            if (theme === 'dark') {
                document.getElementById('dark-mode-toggle').setAttribute('checked', true)
                document.getElementById('dark-mode-icon').classList.replace('bi-brightness-high-fill', 'bi-brightness-low')
            } else {
                document.getElementById('dark-mode-toggle').setAttribute('checked', false)
                document.getElementById('dark-mode-icon').classList.replace('bi-brightness-low', 'bi-brightness-high-fill')
            }
        }

        // Returns true if the current theme is dark
        const isDark = () => {
            return document.documentElement.getAttribute('data-bs-theme') === 'dark'
        }

        // Toggles dark mode
        const toggleDarkMode = () => {
            const newTheme = isDark() ? 'light' : 'dark'
            setTheme(newTheme)
            localStorage.setItem('theme', newTheme)
        }

        // Set the preferred theme on page load
        window.onload = () => {
            // Set preferred theme
            setTheme(getPreferredTheme());
            // Initialize tooltips
            const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
            const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
        }

        // Toggle dark mode when the toggle button is clicked
        addEventListener("click", (event) => {
            if (event.target.id === 'dark-mode-toggle') {
                toggleDarkMode();
                // De-focus the toggle
                document.activeElement.blur()
            }
        });
    </script>
</body>
</html>
